---
title: COleClientItem 类
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/06/2019
ms.locfileid: "70740883"
---
# <a name="coleclientitem-class"></a>COleClientItem 类

定义 OLE 项的容器接口。

## <a name="syntax"></a>语法

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|构造 `COleClientItem` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|打开操作的 OLE 项，然后执行指定的谓词。|
|[COleClientItem::ActivateAs](#activateas)|激活项作为另一种类型。|
|[COleClientItem::AttachDataObject](#attachdataobject)|访问 OLE 对象中的数据。|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|指示容器应用程序是否可以创建嵌入的对象。|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|指示容器应用程序是否可以创建链接对象。|
|[COleClientItem::CanPaste](#canpaste)|指示剪贴板是否包含可嵌入或静态的 OLE 项。|
|[COleClientItem::CanPasteLink](#canpastelink)|指示剪贴板是否包含可链接 OLE 项。|
|[COleClientItem::Close](#close)|关闭到服务器的链接，但不销毁 OLE 项。|
|[COleClientItem::ConvertTo](#convertto)|将项转换为另一种类型。|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|将 OLE 项复制到剪贴板。|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|创建现有项的副本。|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|从剪贴板创建嵌入项。|
|[COleClientItem::CreateFromData](#createfromdata)|从数据对象创建嵌入项。|
|[COleClientItem::CreateFromFile](#createfromfile)|从文件创建嵌入项。|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|从剪贴板创建链接项。|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|从数据对象创建链接项。|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|从文件创建链接项。|
|[COleClientItem::CreateNewItem](#createnewitem)|通过启动服务器应用程序来创建新的嵌入项。|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|从剪贴板创建静态项。|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|从数据对象创建一个静态项。|
|[COleClientItem::Deactivate](#deactivate)|停用项。|
|[COleClientItem::DeactivateUI](#deactivateui)|将容器应用程序的用户界面还原到其原始状态。|
|[COleClientItem::Delete](#delete)|如果 OLE 项是链接项，则将其删除或关闭。|
|[COleClientItem::DoDragDrop](#dodragdrop)|执行拖放操作。|
|[COleClientItem::DoVerb](#doverb)|执行指定的谓词。|
|[COleClientItem::Draw](#draw)|绘制 OLE 项。|
|[COleClientItem::GetActiveView](#getactiveview)|获取在其中激活项的视图。|
|[COleClientItem::GetCachedExtent](#getcachedextent)|返回 OLE 项的矩形的界限。|
|[COleClientItem::GetClassID](#getclassid)|获取当前项的类 ID。|
|[COleClientItem::GetClipboardData](#getclipboarddata)|通过调用`CopyToClipboard`成员函数，获取将放置在剪贴板上的数据。|
|[COleClientItem::GetDocument](#getdocument)|返回包含当前项的对象。`COleDocument`|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|获取用于呈现的项的当前视图。|
|[COleClientItem::GetExtent](#getextent)|返回 OLE 项的矩形的界限。|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|检索与特定 CLSID 的服务器关联的图标的句柄。|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|获取用于绘制项的图标的图元文件。|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|返回指向项的就地编辑窗口的指针。|
|[COleClientItem::GetItemState](#getitemstate)|获取项的当前状态。|
|[COleClientItem::GetLastStatus](#getlaststatus)|返回上一个 OLE 操作的状态。|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|返回链接项的更新模式（高级功能）。|
|[COleClientItem::GetType](#gettype)|返回 OLE 项的类型（嵌入、链接或静态）。|
|[COleClientItem::GetUserType](#getusertype)|获取一个字符串，该字符串描述项的类型。|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|如果项处于就地活动状态，则返回 TRUE。|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|如果链接项与源文档保持最新，则返回 TRUE。|
|[COleClientItem::IsModified](#ismodified)|如果项自上次保存后已被修改，则返回 TRUE。|
|[COleClientItem::IsOpen](#isopen)|如果项当前在服务器应用程序中处于打开状态，则返回 TRUE。|
|[COleClientItem::IsRunning](#isrunning)|如果项的服务器应用程序正在运行，则返回 TRUE。|
|[COleClientItem::OnActivate](#onactivate)|由框架调用以通知项它已激活。|
|[COleClientItem::OnActivateUI](#onactivateui)|由框架调用以通知项它已激活并且应显示其用户界面。|
|[COleClientItem::OnChange](#onchange)|当服务器更改 OLE 项时调用。 需要实现。|
|[COleClientItem::OnDeactivate](#ondeactivate)|当激活某项时由框架调用。|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|当服务器删除其就地用户界面时由框架调用。|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|由框架调用以获取要复制到剪贴板中的数据。|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|由框架调用以创建复合菜单。|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|由框架调用，以从复合菜单中删除容器的菜单。|
|[COleClientItem::OnSetMenu](#onsetmenu)|由框架调用以安装和移除复合菜单。|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|由框架调用以显示和隐藏控件条。|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|由框架调用以更新框架窗口的标题栏。|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|重新激活该项并撤消最后一个就地编辑操作。|
|[COleClientItem::Release](#release)|释放到 OLE 链接项的连接并在打开时将其关闭。 不会销毁客户端项。|
|[COleClientItem::Reload](#reload)|在调用`ActivateAs`后重新加载项。|
|[COleClientItem::Run](#run)|运行与项关联的应用程序。|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|设置要呈现的项的当前视图。|
|[COleClientItem::SetExtent](#setextent)|设置 OLE 项的边框。|
|[COleClientItem::SetHostNames](#sethostnames)|设置在编辑 OLE 项时服务器显示的名称。|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|缓存用于绘制项的图标的图元文件。|
|[COleClientItem::SetItemRects](#setitemrects)|设置项的边框。|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|设置链接项的更新模式（高级功能）。|
|[COleClientItem::SetPrintDevice](#setprintdevice)|为此客户端项设置打印目标设备。|
|[COleClientItem::UpdateLink](#updatelink)|更新项的表示缓存。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|由框架调用，用于确定是否允许就地激活。|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|当项的位置发生更改时由框架调用。|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|由框架调用，以在激活后撤消。|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|由框架调用以放弃该项的撤消状态信息。|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|由框架调用以获取项的剪辑矩形坐标。|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|由框架调用以获取该项相对于视图的位置。|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|当项就地激活时由框架调用。|
|[COleClientItem::OnScrollBy](#onscrollby)|由框架调用以将项滚动到视图中。|
|[COleClientItem::OnShowItem](#onshowitem)|由框架调用以显示 OLE 项。|

## <a name="remarks"></a>备注

OLE 项表示由服务器应用程序创建和维护的数据，可以将其 "无缝" 合并到文档中，使其看起来像是单个文档。 结果是由 OLE 项和一个包含文档组成的 "复合文档"。

OLE 项可以是嵌入的或链接的。 如果它是嵌入的，则其数据将作为复合文档的一部分进行存储。 如果已链接，则其数据将存储为服务器应用程序创建的单独文件的一部分，并且仅将指向该文件的链接存储在复合文档中。 所有 OLE 项都包含指定应调用以进行编辑的服务器应用程序的信息。

`COleClientItem`定义为响应来自服务器应用程序的请求而调用的多个可重写的函数;这些可重写通常充当通知。 这使服务器应用程序可以通知容器用户在编辑 OLE 项时所做的更改，或检索在编辑过程中所需的信息。

`COleClientItem`可以与[COleDocument](../../mfc/reference/coledocument-class.md)、 [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)或[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)类一起使用。 若要`COleClientItem`使用，请从中派生一个类，并实现[OnChange](#onchange)成员函数，该成员函数定义容器如何响应对该项所做的更改。 若要支持就地激活，请重写[OnGetItemPosition](#ongetitemposition)成员函数。 此函数提供有关 OLE 项的显示位置的信息。

有关使用容器接口的详细信息，请参阅文章[容器：实现容器](../../mfc/containers-implementing-a-container.md)和[激活](../../mfc/activation-cpp.md)。

> [!NOTE]
>  Windows SDK 将嵌入项和链接项称为 "对象"，并将项的类型表示为 "类"。 此引用使用术语 "item" 将 OLE 实体与相应C++的对象区分开来，并使用术语 "type" 将 ole 类别与C++类区分开来。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>要求

**标头：** afxole

##  <a name="activate"></a>COleClientItem：： Activate

调用此函数以执行指定的谓词而不是[DoVerb](#doverb) ，以便在引发异常时可以执行自己的处理。

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>参数

*nVerb*<br/>
指定要执行的谓词。 它可以是下列其中一项：

|值|含义|符号|
|-----------|-------------|------------|
|- 0|主谓词|OLEIVERB_PRIMARY|
|- 1|辅助谓词|（无）|
|- 1|显示要编辑的项|OLEIVERB_SHOW|
|- 2|在单独的窗口中编辑项|OLEIVERB_OPEN|
|- 3|隐藏项|OLEIVERB_HIDE|

-1 值通常是另一个谓词的别名。 如果不支持打开编辑，则-2 的效果与-1 相同。 有关其他值，请参阅 IOleObject： Windows SDK 中的[：:D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 。

*pView*<br/>
指向包含 OLE 项的容器视图窗口的指针;服务器应用程序使用此方法进行就地激活。 如果容器不支持就地激活，则此参数应为 NULL。

*lpMsg*<br/>
指向导致激活项的消息的指针。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，则此函数将导致执行相应`COleServerItem`对象的 [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) 成员函数。

如果主谓词是 Edit 并且在*nVerb*参数中指定了 zero，则启动服务器应用程序以允许编辑该 OLE 项。 如果容器应用程序支持就地激活，则可以就地执行编辑。 如果容器不支持就地激活（或指定了 Open 谓词），则将在单独的窗口中启动服务器，并可在该窗口中进行编辑。 通常，当容器应用程序的用户双击 OLE 项时， *nVerb*参数中主要谓词的值将决定用户可以执行的操作。 但是，如果服务器仅支持一个操作，它将执行该操作，而无论在*nVerb*参数中指定了哪个值。

有关详细信息，请参阅 IOleObject： Windows SDK 中的[：:D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 。

##  <a name="activateas"></a>COleClientItem：： ActivateAs

使用 OLE 的对象转换工具激活项，就像它是由*clsidNew*指定的类型的项。

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>参数

*lpszUserType*<br/>
指向表示目标用户类型（如 "Word 文档"）的字符串的指针。

*clsidOld*<br/>
对项的当前类 ID 的引用。 类 ID 应表示实际对象的类型（如存储），除非它是一个链接。 在这种情况下，它应是链接所引用的项的 CLSID。 [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)自动为项提供正确的类 ID。

*clsidNew*<br/>
对目标类 ID 的引用。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

[COleConvertDialog：:D oconvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)自动调用此方法。 通常不直接调用此方法。

##  <a name="attachdataobject"></a>COleClientItem：： AttachDataObject

调用此函数可初始化用于访问 OLE 项中的数据的[COleDataObject](../../mfc/reference/coledataobject-class.md) 。

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>参数

*rDataObject*<br/>
`COleDataObject`对对象的引用，该对象将进行初始化，以允许访问 OLE 项中的数据。

##  <a name="canactivate"></a>  COleClientItem::CanActivate

当用户请求就地激活 OLE 项时由框架调用;此函数的返回值决定是否允许就地激活。

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>返回值

如果允许就地激活，则为非零值;否则为0。

### <a name="remarks"></a>备注

如果容器具有有效的窗口，则默认实现允许就地激活。 重写此函数以实现用于接受或拒绝激活请求的特殊逻辑。 例如，如果 OLE 项太小或当前不可见，则可能拒绝激活请求。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceSite：： CanInPlaceActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) 。

##  <a name="cancreatefromdata"></a>COleClientItem：： CanCreateFromData

检查容器应用程序是否可以从给定`COleDataObject`的对象创建嵌入的对象。

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject](../../mfc/reference/coledataobject-class.md)对象的指针。

### <a name="return-value"></a>返回值

如果容器可以从`COleDataObject`对象创建嵌入的对象，则为非零; 否则为0。

### <a name="remarks"></a>备注

`COleDataObject`类用于在数据传输中通过拖放或从嵌入 OLE 项检索各种格式的数据。

容器可以使用此函数决定是启用还是禁用其编辑粘贴和编辑粘贴特殊命令。

有关详细信息，请参阅文章[数据对象和数据源（OLE）](../../mfc/data-objects-and-data-sources-ole.md)。

##  <a name="cancreatelinkfromdata"></a>COleClientItem：： CanCreateLinkFromData

检查容器应用程序是否可以从给定`COleDataObject`的对象创建链接的对象。

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject](../../mfc/reference/coledataobject-class.md)对象的指针。

### <a name="return-value"></a>返回值

如果容器可以从`COleDataObject`对象创建链接对象，则为非零值。

### <a name="remarks"></a>备注

`COleDataObject`类用于在数据传输中通过拖放或从嵌入 OLE 项检索各种格式的数据。

容器可以使用此函数决定是启用还是禁用其 "编辑" "选择性粘贴" 和 "编辑粘贴链接" 命令。

有关详细信息，请参阅文章[数据对象和数据源（OLE）](../../mfc/data-objects-and-data-sources-ole.md)。

##  <a name="canpaste"></a>COleClientItem：： CanPaste

调用此函数可查看是否可以从剪贴板中粘贴嵌入的 OLE 项。

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>返回值

如果嵌入的 OLE 项可以从剪贴板中粘贴，则为非零值;否则为0。

### <a name="remarks"></a>备注

有关详细信息，请参阅 Windows SDK 中的[OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard)和[OleQueryCreateFromData](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) 。

##  <a name="canpastelink"></a>COleClientItem：： CanPasteLink

调用此函数可查看是否可以从剪贴板中粘贴链接的 OLE 项。

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>返回值

如果可以从剪贴板中粘贴链接的 OLE 项，则为非零值;否则为0。

### <a name="remarks"></a>备注

有关详细信息，请参阅 Windows SDK 中的[OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard)和[OleQueryLinkFromData](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) 。

##  <a name="close"></a>  COleClientItem::Close

调用此函数可将 OLE 项的状态从 "正在运行" 更改为 "已加载" 状态，即，在内存中使用其处理程序加载，但服务器未运行。

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>参数

*dwCloseOption*<br/>
指定在 OLE 项返回到已加载状态时，该 OLE 项保存在什么情况下的标志。 它可以具有下列值之一：

- OLECLOSE_SAVEIFDIRTY 保存 OLE 项。

- OLECLOSE_NOSAVE 不保存 OLE 项。

- OLECLOSE_PROMPTSAVE 提示用户是否保存 OLE 项。

### <a name="remarks"></a>备注

此函数在 OLE 项未运行时不起作用。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：： Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) 。

##  <a name="coleclientitem"></a>COleClientItem：： COleClientItem

构造一个`COleClientItem`对象并将其添加到容器文档的文档项的集合中，这些文档项C++仅构造对象，而不执行任何 OLE 初始化。

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>参数

*pContainerDoc*<br/>
指向将包含此项的容器文档的指针。 这可以是任何[COleDocument](../../mfc/reference/coledocument-class.md)派生。

### <a name="remarks"></a>备注

如果传递 NULL 指针，则不会对容器文档进行加法。 必须显式调用[COleDocument：： AddItem](../../mfc/reference/coledocument-class.md#additem)。

在使用 OLE 项之前，必须先调用以下创建成员函数之一：

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

调用此成员函数以将项转换为*clsidNew*指定的类型。

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>参数

*clsidNew*<br/>
目标类型的类 ID。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

[COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)会自动调用此方法。 不需要直接调用它。

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

调用此函数可将 OLE 项复制到剪贴板。

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>参数

*bIncludeLink*<br/>
如果应将链接信息复制到剪贴板，允许粘贴链接的项，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

通常，在为 "编辑" 菜单中的 "复制" 或 "剪切" 命令写入消息处理程序时，调用此函数。 如果要实现 "复制" 或 "剪切" 命令，则必须在容器应用程序中实现项目选择。

有关详细信息，请参阅 Windows SDK 中的[OleSetClipboard](/windows/win32/api/ole2/nf-ole2-olesetclipboard) 。

##  <a name="createclonefrom"></a>COleClientItem：： CreateCloneFrom

调用此函数可创建指定 OLE 项的副本。

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>参数

*pSrcItem*<br/>
指向要复制的 OLE 项的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

副本与源项完全相同。 您可以使用此函数支持撤消操作。

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

调用此函数可从剪贴板的内容创建嵌入项。

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

通常，在 "编辑" 菜单上的 "粘贴" 命令的消息处理程序中调用此函数。 （如果[CanPaste](#canpaste)成员函数返回非零值，则该框架将启用 "粘贴" 命令。）

有关详细信息，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createfromdata"></a>COleClientItem：： CreateFromData

调用此函数可从`COleDataObject`对象创建嵌入项。

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject](../../mfc/reference/coledataobject-class.md)对象的指针。

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

数据传输操作（如从剪贴板或拖放操作中进行粘贴）提供`COleDataObject`的对象包含服务器应用程序提供的信息。 它通常用于重写[CView：： system.windows.uielement.ondrop](../../mfc/reference/cview-class.md#ondrop)。

有关详细信息，请参阅 Windows SDK 中的[OleCreateFromData](/windows/win32/api/ole2/nf-ole2-olecreatefromdata)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createfromfile"></a>COleClientItem：： CreateFromFile

调用此函数可从文件创建嵌入的 OLE 项。

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*lpszFileName*<br/>
一个指针，指向要从中创建 OLE 项的文件的名称。

*clsid*<br/>
留待将来使用。

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果选择了 "从文件创建" 按钮，则框架将从[COleInsertDialog：： CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)调用此函数。

有关详细信息，请参阅 Windows SDK 中的[OleCreateFromFile](/windows/win32/api/ole/nf-ole-olecreatefromfile)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

调用此函数可从剪贴板的内容创建链接项。

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

通常，在 "编辑" 菜单上的 "粘贴链接" 命令的消息处理程序中调用此函数。 （如果剪贴板包含可链接到的 OLE 项，则在[COleDocument](../../mfc/reference/coledocument-class.md)的默认实现中启用 "粘贴链接" 命令。）

有关详细信息，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createlinkfromdata"></a>COleClientItem：： CreateLinkFromData

调用此函数可从`COleDataObject`对象创建链接项。

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject](../../mfc/reference/coledataobject-class.md)对象的指针。

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

当用户指示应创建链接时，在删除操作期间调用此。 它还可用于处理编辑粘贴命令。 在选择了 Link 选项后`COleClientItem::CreateLinkFromClipboard` ，和中的框架将调用该方法[： COlePasteSpecialDialog：： CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) 。

有关详细信息，请参阅 Windows SDK 中的[OleCreateLinkFromData](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createlinkfromfile"></a>COleClientItem：： CreateLinkFromFile

调用此函数可从文件创建链接的 OLE 项。

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*lpszFileName*<br/>
一个指针，指向要从中创建 OLE 项的文件的名称。

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果选择了 "从文件创建" 按钮并且选中了 "链接" 复选框，则框架将调用此函数。 它从[COleInsertDialog：： CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)调用。

有关详细信息，请参阅 Windows SDK 中的[OleCreateLinkToFile](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

调用此函数可创建嵌入项;此函数启动允许用户创建 OLE 项的服务器应用程序。

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*clsid*<br/>
唯一标识要创建的 OLE 项类型的 ID。

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果选择 "新建" 按钮时，如果用户在 "插入对象" 对话框中选择 "确定"，框架将调用此函数。

有关详细信息，请参阅 Windows SDK 中的[OleCreate](/windows/win32/api/ole/nf-ole-olecreate)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

调用此函数可从剪贴板的内容创建静态项。

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

静态项包含表示数据，而不包含本机数据;因此无法对其进行编辑。 如果[CreateFromClipboard](#createfromclipboard)成员函数失败，通常会调用此函数。

有关详细信息，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="createstaticfromdata"></a>COleClientItem：： CreateStaticFromData

调用此函数可从`COleDataObject`对象创建静态项。

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject](../../mfc/reference/coledataobject-class.md)对象的指针。

*render*<br/>
指定服务器将如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender) 。

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
当*render*为 OLERENDER_FORMAT 或 OLERENDER_DRAW 时使用的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定超出*cfFormat*指定的剪贴板格式的其他格式信息时，才为此参数提供值。 如果省略此参数，则将对`FORMATETC`结构中的其他字段使用默认值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

静态项包含表示数据，而不包含本机数据;因此，不能对其进行编辑。 这基本上与[CreateStaticFromClipboard](#createstaticfromclipboard)相同，只是可以从任意`COleDataObject`剪贴板创建静态项，而不只是从剪贴板创建。

如果选择了 Static，则在[COlePasteSpecialDialog：： CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)中使用。

有关详细信息，请参阅 Windows SDK 中的[OleCreateStaticFromData](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata)、 [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) 。

##  <a name="deactivate"></a>  COleClientItem::Deactivate

调用此函数可停用 OLE 项并释放任何关联的资源。

```
void Deactivate();
```

### <a name="remarks"></a>备注

当用户在项目边界之外的工作区上单击鼠标时，通常会停用就地活动 OLE 项。 请注意，停用 OLE 项会放弃其撤消状态，从而无法调用[ReactivateAndUndo](#reactivateandundo)成员函数。

如果你的应用程序支持撤消，请`Deactivate`不要调用，而应调用[DeactivateUI](#deactivateui)。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceObject：： InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) 。

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

当用户停用就地激活的项时调用此函数。

```
void DeactivateUI();
```

### <a name="remarks"></a>备注

此函数将容器应用程序的用户界面还原到其原始状态，并隐藏为就地激活创建的任何菜单和其他控件。

此函数不会刷新项的撤消状态信息。 将保留该信息，以便以后可以使用[ReactivateAndUndo](#reactivateandundo)在服务器应用程序中执行撤消命令，以防在停用项目后立即选择容器的 "撤消" 命令。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceObject：： InPlaceDeactivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) 。

##  <a name="delete"></a>  COleClientItem::Delete

调用此函数可删除容器文档中的 OLE 项。

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>参数

*bAutoDelete*<br/>
指定是否要从文档中删除该项。

### <a name="remarks"></a>备注

此函数调用[Release](#release)成员函数，该函数反过来会删除项C++的对象，并从文档中永久删除 OLE 项。 如果 OLE 项是嵌入的，则该项的本机数据将被删除。 它始终关闭正在运行的服务器;因此，如果项是打开的链接，则此函数会将其关闭。

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

`DoDragDrop`调用成员函数以执行拖放操作。

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>参数

*lpItemRect*<br/>
在屏幕上以工作区坐标表示的项的矩形（像素）。

*ptOffset*<br/>
拖动时鼠标位置*lpItemRect*的偏移量。

*bIncludeLink*<br/>
如果应将链接数据复制到剪贴板，请将此值设置为 TRUE。 如果服务器应用程序不支持链接，则将其设置为 FALSE。

*dwEffects*<br/>
确定拖动源将在拖动操作中允许的效果。

*lpRectStartDrag*<br/>
一个指针，指向用于定义拖动实际起始位置的矩形。 有关更多信息，请参见下面的“备注”部分。

### <a name="return-value"></a>返回值

DROPEFFECT 值。 如果它是 DROPEFFECT_MOVE，则应删除原始数据。

### <a name="remarks"></a>备注

拖放操作不会立即启动。 它会一直等待，直到鼠标光标离开*lpRectStartDrag*指定的矩形，或直到经过指定的毫秒数。 如果*lpRectStartDrag*为 NULL，则该矩形的大小为一个像素。

延迟时间由注册表项设置指定。 可以通过调用[CWinApp：： WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)或[CWinApp：： WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint)来更改延迟时间。 如果未指定延迟时间，则使用默认值200毫秒。 拖动延迟时间按如下方式存储：

- Windows NT 拖动延迟时间存储在 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay. 中。

- Windows 3. x 拖动延迟时间存储在 WIN 中。INI 文件中。

- Windows 95/98 拖动延迟时间存储在 WIN 的缓存版本中.INI.

有关如何将拖动延迟信息存储在注册表或中的详细信息。INI 文件，请参阅 Windows SDK 中的[WriteProfileString](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) 。

##  <a name="doverb"></a>  COleClientItem::DoVerb

调用`DoVerb`以执行指定的谓词。

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>参数

*nVerb*<br/>
指定要执行的谓词。 它可以包括以下内容之一：

|值|含义|符号|
|-----------|-------------|------------|
|- 0|主谓词|OLEIVERB_PRIMARY|
|- 1|辅助谓词|（无）|
|- 1|显示要编辑的项|OLEIVERB_SHOW|
|- 2|在单独的窗口中编辑项|OLEIVERB_OPEN|
|- 3|隐藏项|OLEIVERB_HIDE|

-1 值通常是另一个谓词的别名。 如果不支持打开编辑，则-2 的效果与-1 相同。 有关其他值，请参阅 IOleObject： Windows SDK 中的[：:D overb](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) 。

*pView*<br/>
指向视图窗口的指针;服务器使用此方法进行就地激活。 如果容器应用程序不允许就地激活，则此参数应为 NULL。

*lpMsg*<br/>
指向导致激活项的消息的指针。

### <a name="return-value"></a>返回值

如果已成功执行谓词，则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数调用[Activate](#activate)成员函数来执行谓词。 它还会捕获异常，并向用户显示一个消息框（如果引发）。

如果主谓词是 Edit 并且在*nVerb*参数中指定了 zero，则启动服务器应用程序以允许编辑该 OLE 项。 如果容器应用程序支持就地激活，则可以就地执行编辑。 如果容器不支持就地激活（或指定了 Open 谓词），则将在单独的窗口中启动服务器，并可在该窗口中进行编辑。 通常，当容器应用程序的用户双击 OLE 项时， *nVerb*参数中主要谓词的值将决定用户可以执行的操作。 但是，如果服务器仅支持一个操作，它将执行该操作，而无论在*nVerb*参数中指定了哪个值。

##  <a name="draw"></a>  COleClientItem::Draw

调用此函数可使用指定的设备上下文将 OLE 项绘制到指定的边框中。

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>参数

*pDC*<br/>
指向用于绘制 OLE 项的[CDC](../../mfc/reference/cdc-class.md)对象的指针。

*lpBounds*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或结构的`RECT`指针，该对象或结构定义要在其中绘制 OLE 项的边框（在由设备上下文确定的逻辑单元中）。

*nDrawAspect*<br/>
指定 OLE 项的内容，即它的显示方式。 如果*nDrawAspect*为-1，则使用[SetDrawAspect](#setdrawaspect)设置的最后一个方面。 有关此标志可能值的详细信息，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

函数可以使用由的[OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)成员函数`COleServerItem`创建的 OLE 项的图元文件表示形式。

通常，用于屏幕显示，将屏幕设备上下文作为 pDC 传递。 `Draw` 在这种情况下，只需指定前两个参数。

*LpBounds*参数标识目标设备上下文中的矩形（相对于其当前映射模式）。 呈现可能涉及缩放图片，并且容器应用程序可使用它来施加一个在显示视图和最终打印图像之间进行缩放的视图。

有关详细信息，请参阅 Windows SDK 中的[IViewObject：:D raw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) 。

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

返回激活项的视图。

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>返回值

指向视图的指针;否则，如果不就地激活该项，则为 NULL。

##  <a name="getcachedextent"></a>COleClientItem：： GetCachedExtent

调用此函数可检索 OLE 项的大小。

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>参数

*lpSize*<br/>
指向`SIZE`结构的指针或将接收大小信息的[CSize](../../atl-mfc-shared/reference/csize-class.md)对象。

*nDrawAspect*<br/>
指定要检索其边界的 OLE 项的特性。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则为非零值;如果 OLE 项为空白，则为0。

### <a name="remarks"></a>备注

此函数提供与[GetExtent](#getextent)相同的信息。 但是，您可以调用`GetCachedExtent`来在处理其他 OLE 处理程序的过程中获取范围信息，如[OnChange](#onchange)。 维度以 MM_HIMETRIC 单位表示。

这是可能的`GetCachedExtent` ，因为使用[IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2)接口，而不是使用[IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject)接口来获取此项的范围。 COM 对象缓存上一次对 IViewObject 的调用中使用的范围信息[：:D raw。](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) `IViewObject2`

有关详细信息，请参阅 Windows SDK 中的[IViewObject2：： GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) 。

##  <a name="getclassid"></a>COleClientItem：： GetClassID

将项的类 ID 返回到*pClassID*指向的内存中。

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>参数

*pClassID*<br/>
指向要检索类 ID 的[CLSID](/windows/win32/com/clsid-key-hklm)类型的标识符的指针。 有关 CLSID 的信息，请参阅 Windows SDK。

### <a name="remarks"></a>备注

类 ID 是一个128位的数字，用于唯一标识编辑项的应用程序。

有关详细信息，请参阅 Windows SDK 中的[IPersist：： GetClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) 。

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

调用此函数可获取一个`COleDataSource`对象，该对象包含通过调用[CopyToClipboard](#copytoclipboard)成员函数而放置在剪贴板上的所有数据。

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>参数

*pDataSource*<br/>
指向将接收 OLE 项中包含的数据的[COleDataSource](../../mfc/reference/coledatasource-class.md)对象的指针。

*bIncludeLink*<br/>
如果应包含链接数据，则为 TRUE;否则为 FALSE。

*lpOffset*<br/>
鼠标光标相对于对象原点的偏移量（以像素为单位）。

*lpSize*<br/>
对象的大小（以像素为单位）。

### <a name="remarks"></a>备注

`GetClipboardData`称为[OnGetClipboardData](#ongetclipboarddata)的默认实现。 仅`OnGetClipboardData`当你除了提供的`CopyToClipboard`数据格式之外还需要提供数据格式时，重写。 `COleDataSource`在调用`CopyToClipboard`之前或之后将这些格式置于对象中，然后将该`COleDataSource`对象传递给[COleDataSource：： SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard)函数。 例如，如果想要将 OLE 项的容器文档中的该位置伴随在剪贴板上，则需要定义自己的格式以传递该信息，并将其放在`COleDataSource`调用`CopyToClipboard`之前。

##  <a name="getdocument"></a>COleClientItem：： GetDocument

调用此函数可获取指向包含 OLE 项的文档的指针。

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>返回值

指向包含 OLE 项的文档的指针。 如果项不是文档的一部分，则为 NULL。

### <a name="remarks"></a>备注

通过此指针，可以访问`COleDocument`作为参数`COleClientItem`传递给构造函数的对象。

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

`GetDrawAspect`调用成员函数以确定项的当前 "方面"。

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>返回值

DVASPECT 枚举中的一个值，其值列在[SetDrawAspect](#setdrawaspect)的引用中。

### <a name="remarks"></a>备注

特性指定项的呈现方式。

##  <a name="getextent"></a>COleClientItem：： GetExtent

调用此函数可检索 OLE 项的大小。

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>参数

*lpSize*<br/>
指向`SIZE`结构的指针`CSize`或将接收大小信息的对象。

*nDrawAspect*<br/>
指定要检索其边界的 OLE 项的特性。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则为非零值;如果 OLE 项为空白，则为0。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，则此函数将导致调用相应`COleServerItem`对象的 [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) 成员函数。 请注意，检索到的大小可能不同于[SetExtent](#setextent)成员函数最后设置的大小;指定的大小`SetExtent`被视为建议。 维度以 MM_HIMETRIC 单位表示。

> [!NOTE]
>  不要在处理`GetExtent` OLE 处理程序的过程中调用，如[OnChange](#onchange)。 改为调用[GetCachedExtent](#getcachedextent) 。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：： GetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) 。

##  <a name="geticonfromregistry"></a>COleClientItem：： GetIconFromRegistry

调用此成员函数以检索与特定 CLSID 服务器关联的图标资源的句柄。

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>参数

*clsid*<br/>
对与图标关联的服务器的 CLSID 的引用。

### <a name="return-value"></a>返回值

图标资源的有效句柄; 如果找不到服务器的图标或默认图标，则为 NULL。

### <a name="remarks"></a>备注

此成员函数将不会启动服务器或动态获取图标，即使服务器已经在运行。 相反，此成员函数将打开服务器的可执行文件映像，并检索与已注册的服务器关联的静态图标。

##  <a name="geticonicmetafile"></a>COleClientItem：： GetIconicMetafile

检索用于绘制项的图标的图元文件。

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>返回值

如果成功，则为图元文件的句柄;否则为 NULL。

### <a name="remarks"></a>备注

如果没有当前图标，则返回默认图标。 这由 MFC/OLE 对话框自动调用，通常不直接调用。

此函数还调用[SetIconicMetafile](#seticonicmetafile)来缓存图元文件以供以后使用。

##  <a name="getinplacewindow"></a>COleClientItem：： GetInPlaceWindow

`GetInPlaceWindow`调用成员函数以获取一个指针，该指针指向已打开该项进行就地编辑的窗口。

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>返回值

指向项的就地编辑窗口的指针;如果项不处于活动状态或其服务器不可用，则为 NULL。

### <a name="remarks"></a>备注

只应为就地活动的项调用此函数。

##  <a name="getitemstate"></a>COleClientItem：： GetItemState

调用此函数可获取 OLE 项的当前状态。

```
UINT GetItemState() const;
```

### <a name="return-value"></a>返回值

`openState` `loadedState` `emptyState` `activeUIState` `activeState`枚举的值，可以是下列值之一：、、、、。 `COleClientItem::ItemState` 有关这些状态的信息，请参阅文章[容器：客户端项状态](../../mfc/containers-client-item-states.md)。

### <a name="remarks"></a>备注

若要在 OLE 项的状态发生更改时得到通知，请使用[OnChange](#onchange)成员函数。

有关详细信息，请参阅文章[容器：客户端项状态](../../mfc/containers-client-item-states.md)。

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

返回上一个 OLE 操作的状态代码。

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>返回值

SCODE 值。

### <a name="remarks"></a>备注

对于返回布尔值 FALSE 或返回 NULL 的其他成员函数的成员函数， `GetLastStatus`返回更详细的失败信息。 请注意，大多数 OLE 成员函数会引发异常，导致更严重的错误。 有关 SCODE 的解释的特定信息取决于最后返回 SCODE 值的基础 OLE 调用。

有关 SCODE 的详细信息，请参阅 Windows SDK 文档中[的 COM 错误代码的结构](/windows/win32/com/structure-of-com-error-codes)。

##  <a name="getlinkupdateoptions"></a>COleClientItem：： GetLinkUpdateOptions

调用此函数可获取 OLE 项的链接更新选项的当前值。

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>返回值

以下值之一：

- OLEUPDATE_ALWAYS 更新链接项（如果可能）。 此选项支持 "链接" 对话框中的 "自动链接-更新" 单选按钮。

- OLEUPDATE_ONCALL 仅在来自容器应用程序的请求（调用[UpdateLink](#updatelink)成员函数时）更新链接项。 此选项支持 "链接" 对话框中的 "手动链接-更新" 单选按钮。

### <a name="remarks"></a>备注

这是一种高级操作。

此函数由[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)类自动调用。

有关详细信息，请参阅 Windows SDK 中的[IOleLink：： GetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) 。

##  <a name="gettype"></a>COleClientItem：： GetType

调用此函数可确定 OLE 项是嵌入的还是链接的，还是静态的。

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>返回值

具有以下值之一的无符号整数：

- OT_LINK OLE 项是一个链接。

- OT_EMBEDDED OLE 项是嵌入的。

- OT_STATIC OLE 项是静态的，也就是说，它只包含演示数据，而不包含本机数据，因此无法编辑。

##  <a name="getusertype"></a>COleClientItem：： GetUserType

调用此函数可获取用户可见的字符串，该字符串描述了 OLE 项的类型，例如 "Word 文档"。

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>参数

*nUserClassType*<br/>
一个值，该值指示描述 OLE 项类型的字符串所需的变量。 此值可以是以下值之一：

- USERCLASSTYPE_FULL 显示给用户的完整类型名称。

- USERCLASSTYPE_SHORT 在弹出菜单和 "编辑链接" 对话框中使用的短名称（最多15个字符）。

- USERCLASSTYPE_APPNAME 类的应用程序的名称。

*rString*<br/>
对[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象的引用，该对象描述 OLE 项的类型。

### <a name="remarks"></a>备注

这通常是系统注册数据库中的条目。

如果请求了完整的类型名称，但该名称不可用，则改用短名称。 如果在注册数据库中找不到 OLE 项类型的任何项，或者没有为 OLE 项类型注册的用户类型，则使用当前存储在 OLE 项中的用户类型。 如果该用户类型名称为空字符串，则使用 "未知对象"。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：： GetUserType](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) 。

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

调用此函数可查看 OLE 项是否处于就地活动状态。

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项是就地活动的，则为非零值;否则为0。

### <a name="remarks"></a>备注

根据是否正在就地编辑项，可以执行不同的逻辑。 函数检查当前项状态是否等于`activeState` `activeUIState`或。

##  <a name="islinkuptodate"></a>COleClientItem：： IsLinkUpToDate

调用此函数可查看 OLE 项是否是最新的。

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项是最新的，则为非零值;否则为0。

### <a name="remarks"></a>备注

如果链接项的源文档已更新，则链接项可能已过期。 包含其中的链接的嵌入项同样会过时。 函数对 OLE 项进行递归检查。 请注意，确定 OLE 项是否过期可能会像实际执行更新那样昂贵。

[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)实现会自动调用此方法。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：： IsUpToDate](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) 。

##  <a name="ismodified"></a>COleClientItem：： IsModified

调用此函数可查看 OLE 项是否已更新（自上次保存后已修改）。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项已更新，则为非零值;否则为0。

### <a name="remarks"></a>备注

有关详细信息，请参阅 Windows SDK 中的[IPersistStorage：： IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) 。

##  <a name="isopen"></a>COleClientItem：： IsOpen

调用此函数可查看 OLE 项是否已打开;也就是说，在单独的窗口中运行的服务器应用程序的实例中打开。

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项已打开，则为非零值;否则为0。

### <a name="remarks"></a>备注

它用于确定何时绘制带有阴影模式的对象。 打开的对象应在对象的顶部绘制阴影模式。 可以使用[CRectTracker](../../mfc/reference/crecttracker-class.md)对象来实现此目的。

##  <a name="isrunning"></a>COleClientItem：： IsRunning

调用此函数可查看 OLE 项是否正在运行;也就是说，项是否已加载并正在服务器应用程序中运行。

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项正在运行，则为非零值;否则为0。

### <a name="remarks"></a>备注

有关详细信息，请参阅 Windows SDK 中的[OleIsRunning](/windows/win32/api/ole2/nf-ole2-oleisrunning) 。

##  <a name="onactivate"></a>  COleClientItem::OnActivate

由框架调用，以通知该项刚刚激活。

```
virtual void OnActivate();
```

### <a name="remarks"></a>备注

请注意，将调用此函数以指示服务器正在运行，而不表示其用户界面已安装在容器应用程序中。 此时，该对象没有活动的用户界面（不是`activeUIState`）。 它没有安装其菜单或工具栏。 发生这种情况时，将调用[OnActivateUI](#onactivateui)成员函数。

默认实现使用 OLE_CHANGEDSTATE 作为参数调用[OnChange](#onchange)成员函数。 当项变为就地活动时，重写此函数以执行自定义处理。

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

当对象进入`OnActivateUI`活动 UI 状态时，框架会调用。

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>备注

对象现在已安装其工具栏和菜单。

默认实现会记住服务器的 HWND，以备以后`GetServerWindow`调用。

##  <a name="onchange"></a>COleClientItem：： OnChange

当用户修改、保存或关闭 OLE 项时由框架调用。

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>参数

*nCode*<br/>
服务器更改此项的原因。 它可以具有下列值之一：

- OLE_CHANGED OLE 项的外观已更改。

- OLE_SAVED 已保存 OLE 项。

- OLE_CLOSED OLE 项已关闭。

- OLE_CHANGED_STATE OLE 项从一种状态变为另一种状态。

*dwParam*<br/>
如果*nCode*为 OLE_SAVED 或 OLE_CLOSED，则不使用此参数。 如果*nCode*为 OLE_CHANGED，则此参数指定已更改的 OLE 项的特性。 有关可能的值，请参阅[COleClientItem：:D raw](#draw)的*dwParam*参数。 如果*nCode*为 OLE_CHANGED_STATE，则此参数是`COleClientItem::ItemState`一个枚举值，并描述所输入的状态。 它可以具有以下值之一： `emptyState`、 `loadedState`、 `openState`、 `activeState`或`activeUIState`。

### <a name="remarks"></a>备注

（如果使用 Microsoft 基础类库编写服务器应用程序，则调用此函数以响应`Notify` `COleServerDoc`或`COleServerItem`的成员函数。）如果*nCode*为 OLE_CHANGED 或 OLE_SAVED，则默认实现会将容器文档标记为已修改。

对于 OLE_CHANGED_STATE，从[GetItemState](#getitemstate)返回的当前状态仍为旧状态，这意味着在此状态更改之前当前状态。

重写此函数以响应 OLE 项的状态更改。 通常通过使项的显示区域无效来更新该项的外观。 在重写开始时调用基类实现。

##  <a name="onchangeitemposition"></a>COleClientItem：： OnChangeItemPosition

由框架调用，以通知容器 OLE 项的区在就地激活过程中发生了更改。

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>参数

*rectPos*<br/>
指示项相对于容器应用程序的工作区的位置。

### <a name="return-value"></a>返回值

如果成功更改项的位置，则为非零值;否则为0。

### <a name="remarks"></a>备注

默认实现确定 OLE 项的新可见矩形，并将[SetItemRects](#setitemrects)与新值一起调用。 默认实现计算该项的可见矩形，并将该信息传递给服务器。

重写此函数可将特殊规则应用于 resize/move 操作。 如果应用程序是用 MFC 编写的，则此调用结果是因为服务器调用了[COleServerDoc：： RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)。

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

当 OLE 项从就地活动状态（ `activeState`）转换为加载状态时由框架调用，这意味着在就地激活后将其停用。

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>备注

请注意，调用此函数以指示 OLE 项已关闭，而不是从容器应用程序中删除其用户界面。 发生这种情况时，将调用[OnDeactivateUI](#ondeactivateui)成员函数。

默认实现使用 OLE_CHANGEDSTATE 作为参数调用[OnChange](#onchange)成员函数。 当就地活动项停用时，重写此函数以执行自定义处理。 例如，如果你在容器应用程序中支持 "撤消" 命令，则可以重写此函数以放弃撤消状态，这表示在停用该项后，不能撤消对 OLE 项执行的最后一项操作。

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

当用户在就地激活 OLE 项后调用撤消命令时，由框架调用。

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>备注

默认实现将调用[DeactivateUI](#deactivateui)来停用服务器的用户界面。 如果要在容器应用程序中实现 "撤消" 命令，请重写此函数。 在重写中，调用函数的基类版本，然后撤消应用程序中执行的最后一个命令。

有关详细信息，请参阅 IOleInPlaceSite： Windows SDK 中的[：:D eactivateandundo](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) 。

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

当用户停用就地激活的项时调用。

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>参数

*bUndoable*<br/>
指定编辑更改是否可撤消。

### <a name="remarks"></a>备注

此函数将容器应用程序的用户界面还原到其原始状态，并隐藏为就地激活创建的任何菜单和其他控件。

如果*bUndoable*为 FALSE，则容器应禁用 "撤消" 命令，该命令实际上会丢弃容器的撤消状态，因为它指示服务器执行的最后一个操作是不可撤消的。

##  <a name="ondiscardundostate"></a>COleClientItem：： OnDiscardUndoState

当用户执行在编辑 OLE 项时放弃撤消状态的操作时，由框架调用。

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>备注

默认实现不执行任何操作。 如果要在容器应用程序中实现 "撤消" 命令，请重写此函数。 在替代中，放弃容器应用程序的撤消状态。

如果服务器是使用 Microsoft 基础类库编写的，则服务器可能会通过调用[COleServerDoc：:D iscardundostate](../../mfc/reference/coleserverdoc-class.md#discardundostate)来调用此函数。

有关详细信息，请参阅 IOleInPlaceSite： Windows SDK 中的[：:D iscardundostate](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) 。

##  <a name="ongetclipboarddata"></a>COleClientItem：： OnGetClipboardData

由框架调用，以获取一个`COleDataSource`对象，该对象包含通过调用[CopyToClipboard](#copytoclipboard)或[system.windows.dragdrop.dodragdrop](#dodragdrop)成员函数而放置在剪贴板上的所有数据。

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>参数

*bIncludeLink*<br/>
如果应将链接数据复制到剪贴板，请将此值设置为 TRUE。 如果服务器应用程序不支持链接，则将此值设置为 "FALSE"。

*lpOffset*<br/>
指向鼠标光标相对于对象原点的偏移量的指针（以像素为单位）。

*lpSize*<br/>
一个指针，指向对象的大小（以像素为单位）。

### <a name="return-value"></a>返回值

指向包含剪贴板数据的[COleDataSource](../../mfc/reference/coledatasource-class.md)对象的指针。

### <a name="remarks"></a>备注

此函数的默认实现将调用[GetClipboardData](#getclipboarddata)。

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

框架调用`OnGetClipRect`成员函数以获取正在就地编辑的项的剪辑矩形坐标。

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>参数

*rClipRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)类的对象的指针，它将保存项的剪辑矩形坐标。

### <a name="remarks"></a>备注

坐标以像素为单位，相对于容器应用程序窗口的工作区。

默认实现只返回项在其上处于活动状态的视图的客户端矩形。

##  <a name="ongetitemposition"></a>COleClientItem：： OnGetItemPosition

框架调用`OnGetItemPosition`成员函数以获取正在就地编辑的项的坐标。

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>参数

*rPosition*<br/>
对[CRect](../../atl-mfc-shared/reference/crect-class.md)对象的引用，该对象将包含项的位置坐标。

### <a name="remarks"></a>备注

坐标以像素为单位，相对于容器应用程序窗口的工作区。

此函数的默认实现不执行任何操作。 支持就地编辑的应用程序需要其实现。

##  <a name="ongetwindowcontext"></a>COleClientItem：： OnGetWindowContext

当项就地激活时由框架调用。

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>参数

*ppMainFrame*<br/>
指向主框架窗口的指针的指针。

*ppDocFrame*<br/>
指向文档框架窗口的指针的指针。

*lpFrameInfo*<br/>
指向将接收框架窗口信息的[OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)结构的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此函数用于检索有关 OLE 项的父窗口的信息。

如果容器为 MDI 应用程序，则默认实现将返回一个指向*ppMainFrame*中的[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)对象的指针，并返回一个指向*ppDocFrame*中的活动[CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)对象的指针。 如果容器是 SDI 应用程序，则默认实现将返回指向*ppMainFrame*中的[CFrameWnd](../../mfc/reference/cframewnd-class.md)对象的指针，并在*ppDocFrame*中返回 NULL。 默认实现还填写*lpFrameInfo*的成员。

仅当默认实现不适合你的应用程序时，重写此函数;例如，如果应用程序具有不同于 SDI 或 MDI 的用户界面模式。 这是一种高级的可重写。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceSite：： GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext)和[OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)结构。

##  <a name="oninsertmenus"></a>COleClientItem：： OnInsertMenus

在就地激活过程中由框架调用，用于将容器应用程序的菜单插入空菜单。

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>参数

*pMenuShared*<br/>
指向空菜单。

*lpMenuWidths*<br/>
指向一个包含六个长值的数组，该数组指示以下每个菜单组中有多少个菜单："文件"、"编辑"、"容器"、"对象"、"帮助"。 容器应用程序负责文件、容器和窗口菜单组，这些组对应于此数组的元素0、2和4。

### <a name="remarks"></a>备注

然后，将此菜单传递到服务器，该服务器插入其自己的菜单，从而创建一个复合菜单。 可以重复调用此函数来生成多个复合菜单。

默认实现会将就地容器菜单插入*pMenuShared* ;也就是说，"文件"、"容器" 和 "窗口" 菜单组。 [CDocTemplate：： SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo)用于设置此菜单资源。 默认实现还会根据菜单资源，将相应的值分配给*lpMenuWidths*中的元素0、2和4。 如果默认实现不适合您的应用程序，则重写此函数;例如，如果您的应用程序不使用文档模板将资源与文档类型相关联。 如果重写此函数，还应替代[OnSetMenu](#onsetmenu)和[OnRemoveMenus](#onremovemenus)。 这是一种高级的可重写。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceFrame：： InsertMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) 。

##  <a name="onremovemenus"></a>COleClientItem：： OnRemoveMenus

当就地激活结束时，由框架调用，以从指定的复合菜单中删除容器的菜单。

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>参数

*pMenuShared*<br/>
指向通过调用[OnInsertMenus](#oninsertmenus)成员函数构建的复合菜单。

### <a name="remarks"></a>备注

默认实现从*pMenuShared*中删除就地容器菜单，即 "文件"、"容器" 和 "窗口" 菜单组。 如果默认实现不适合您的应用程序，则重写此函数;例如，如果您的应用程序不使用文档模板将资源与文档类型相关联。 如果重写此函数，则可能还需要重写[OnInsertMenus](#oninsertmenus)和[OnSetMenu](#onsetmenu) 。 这是一种高级的可重写。

如果服务器重复调用`OnInsertMenus`，pMenuShared 上的子菜单可能由多个复合菜单共享。 因此，不应删除重写中的`OnRemoveMenus`任何子菜单; 只应分离它们。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceFrame：： RemoveMenus](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) 。

##  <a name="onscrollby"></a>COleClientItem：： OnScrollBy

由框架调用，用于滚动 OLE 项以响应来自服务器的请求。

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>参数

*sizeExtent*<br/>
指定在 x 和 y 方向上滚动的距离（以像素为单位）。

### <a name="return-value"></a>返回值

如果项目已滚动，则为非零值;如果未能滚动项，则为0。

### <a name="remarks"></a>备注

例如，如果 OLE 项在部分可见并且用户在执行就地编辑时移到可见区域外，则调用此函数以保持游标可见。 默认实现不执行任何操作。 重写此函数以按指定的量滚动项。 请注意，由于滚动导致 OLE 项的可见部分可以更改。 调用[SetItemRects](#setitemrects)更新项的可见矩形。

有关详细信息，请参阅[IOleInPlaceSite：： Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) in Windows SDK。

##  <a name="onsetmenu"></a>COleClientItem：： OnSetMenu

当就地激活开始和结束时，由框架调用两次;首次安装复合菜单和第二次（ *holemenu*等于 NULL）以删除它。

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>参数

*pMenuShared*<br/>
一个指针，指向通过调用[OnInsertMenus](#oninsertmenus)成员函数和`InsertMenu`函数构造的复合菜单。

*holemenu*<br/>
`OleCreateMenuDescriptor`函数返回的菜单描述符的句柄，或者为 NULL （如果要移除调度代码）。

*hwndActiveObject*<br/>
OLE 项的编辑窗口的句柄。 这是将从 OLE 接收编辑命令的窗口。

### <a name="remarks"></a>备注

默认实现将安装或删除复合菜单，然后调用[OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)函数来安装或删除调度代码。 如果默认实现不适合您的应用程序，请重写此函数。 如果重写此函数，则可能还需要重写[OnInsertMenus](#oninsertmenus)和[OnRemoveMenus](#onremovemenus) 。 这是一种高级的可重写。

有关详细信息，请参阅 Windows SDK 中的[OleCreateMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor)、 [OleSetMenuDescriptor](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)和[IOleInPlaceFrame：： SetMenu](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) 。

##  <a name="onshowcontrolbars"></a>COleClientItem：： OnShowControlBars

由框架调用以显示和隐藏容器应用程序的控件条。

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>参数

*pFrameWnd*<br/>
指向容器应用程序框架窗口的指针。 这可以是主框架窗口或 MDI 子窗口。

*bShow*<br/>
指定是否显示或隐藏控件条。

### <a name="return-value"></a>返回值

如果函数调用导致控件条状态发生更改，则为非零值;如果调用导致不发生更改，则为 0; 如果*pFrameWnd*未指向容器的框架窗口，则为0。

### <a name="remarks"></a>备注

如果控件条已处于 BShow 指定的状态，则此函数返回 0 *。* 例如，如果控制条隐藏并且*bShow*为 FALSE，则会发生这种情况。

默认实现将工具栏从顶级框架窗口中删除。

##  <a name="onshowitem"></a>COleClientItem：： OnShowItem

由框架调用以显示 OLE 项，使其在编辑过程中完全可见。

```
virtual void OnShowItem();
```

### <a name="remarks"></a>备注

当容器应用程序支持到嵌入项的链接时（即，如果已从[COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)派生文档类），则使用此方法。 此函数在就地激活期间调用，或者当 OLE 项为链接源并且用户要编辑它时调用。 默认实现激活容器文档中的第一个视图。 重写此函数以滚动文档，使 OLE 项可见。

##  <a name="onupdateframetitle"></a>COleClientItem：： OnUpdateFrameTitle

在就地激活过程中由框架调用以更新框架窗口的标题栏。

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>返回值

如果此函数成功更新了框架标题，则为非零; 否则为零。

### <a name="remarks"></a>备注

默认实现不会更改框架窗口标题。 如果需要为应用程序提供不同的框架标题，例如 " *docname*中的*服务器应用* - *项*" （如中的 "Microsoft Excel-在报表中使用电子表格"），请重写此函数。文档 "）。 这是一种高级的可重写。

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

调用此函数可重新激活 OLE 项，并撤消用户在就地编辑过程中执行的最后一个操作。

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果容器应用程序支持 undo 命令，则在停用 OLE 项后，如果用户选择 "撤消" 命令，则调用此函数。

如果服务器应用程序是用 Microsoft 基础类库编写的，则此函数会使服务器调用[COleServerDoc：： OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceObject：： ReactivateAndUndo](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) 。

##  <a name="release"></a>COleClientItem：： Release

调用此函数可清理 OLE 项使用的资源。

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>参数

*dwCloseOption*<br/>
指定在 OLE 项返回到已加载状态时，该 OLE 项保存在什么情况下的标志。 有关可能值的列表，请参阅[COleClientItem：： Close](#close)。

### <a name="remarks"></a>备注

`Release`由`COleClientItem`析构函数调用。

有关详细信息，请参阅 Windows SDK 中的[IUnknown：： Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) 。

##  <a name="reload"></a>COleClientItem：： Reload.sql

关闭并重新加载项。

```
BOOL Reload();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

通过调用`Reload` [ActivateAs](#activateas)将项激活为另一类型的项后调用该函数。

##  <a name="run"></a>COleClientItem：： Run

运行与此项关联的应用程序。

```
void Run();
```

### <a name="remarks"></a>备注

`Run`调用成员函数以在激活项之前启动服务器应用程序。 这是通过[Activate](#activate)和[DoVerb](#doverb)自动完成的，因此通常不需要调用此函数。 如果在执行[DoVerb](#doverb)之前需要运行服务器以设置项属性（如[SetExtent](#setextent)），请调用此函数。

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

`SetDrawAspect`调用成员函数以设置项的 "方面" 或视图。

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>参数

*nDrawAspect*<br/>
DVASPECT 枚举中的一个值。 此参数可以具有下列值之一：

- DVASPECT_CONTENT 项以这种方式表示，它可以在其容器中显示为嵌入的对象。

- DVASPECT_THUMBNAIL 项以 "缩略图" 表示形式呈现，以便可以在浏览工具中显示它。

- DVASPECT_ICON 项由图标表示。

- DVASPECT_DOCPRINT 项表示为使用 "文件" 菜单中的 "打印" 命令打印项。

### <a name="remarks"></a>备注

特性指定当使用该函数的*nDrawAspect*参数的默认值时，如何[绘制](#draw)该项。

此函数由 "更改" 图标（和直接调用 "更改图标" 对话框的其他对话框）自动调用，以在用户请求时启用图标显示方位。

##  <a name="setextent"></a>COleClientItem：： SetExtent

调用此函数可指定 OLE 项的可用空间量。

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>参数

*size*<br/>
包含大小信息的[CSize](../../atl-mfc-shared/reference/csize-class.md)对象。

*nDrawAspect*<br/>
指定要设置其边界的 OLE 项的特性。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，这将导致调用相应 `COleServerItem` 对象的 [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) 成员函数。 然后，OLE 项可以相应地调整其显示。 维度必须以 MM_HIMETRIC 单位表示。 当用户调整 OLE 项的大小或支持某种布局协商时，请调用此函数。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：： SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) 。

##  <a name="sethostnames"></a>COleClientItem：： SetHostNames

调用此函数可指定容器应用程序的名称和嵌入 OLE 项的容器名称。

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>参数

*lpszHost*<br/>
一个指针，指向容器应用程序的用户可见名称。

*lpszHostObj*<br/>
指向包含 OLE 项的容器的标识字符串的指针。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，则此函数将调用包含该 OLE 项的`COleServerDoc`文档的 [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) 成员函数。 在编辑 OLE 项时，将在窗口标题中使用此信息。 每次加载容器文档时，框架都会为文档中的所有 OLE 项调用此函数。 `SetHostNames`仅适用于嵌入项。 每次激活嵌入式 OLE 项进行编辑时都不需要调用此函数。

在加载对象时或以其他名称保存文件时，也会自动使用应用程序名称和文档名称自动调用此。 因此，通常不需要直接调用此函数。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：： SetHostNames](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) 。

##  <a name="seticonicmetafile"></a>COleClientItem：： SetIconicMetafile

缓存用于绘制项的图标的图元文件。

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>参数

*hMetaPict*<br/>
用于绘制项的图标的图元文件的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

使用[GetIconicMetafile](#geticonicmetafile)检索图元文件。

*HMetaPict*参数将被复制到该项中;因此， *hMetaPict*必须由调用方释放。

##  <a name="setitemrects"></a>COleClientItem：： SetItemRects

调用此函数可设置边框或 OLE 项的可见矩形。

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>参数

*lprcPosRect*<br/>
指向包含 OLE 项相对于其父窗口的边界的矩形的指针（以工作区坐标表示）。

*lprcClipRect*<br/>
指向包含 OLE 项相对于其父窗口的可见部分的边界的矩形的指针（以工作区坐标表示）。

### <a name="return-value"></a>返回值

如果成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数由[OnChangeItemPosition](#onchangeitemposition)成员函数的默认实现调用。 只要 OLE 项的位置或可见部分发生更改，就应调用此函数。 通常，这意味着从视图的[OnSize](../../mfc/reference/cwnd-class.md#onsize)和[OnScrollBy](../../mfc/reference/cview-class.md#onscrollby)成员函数调用它。

有关详细信息，请参阅 Windows SDK 中的[IOleInPlaceObject：： SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) 。

##  <a name="setlinkupdateoptions"></a>COleClientItem：： SetLinkUpdateOptions

调用此函数可为指定链接项的表示形式设置链接更新选项。

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>参数

*dwUpdateOpt*<br/>
此项的链接更新选项的值。 此值必须是下列值之一：

- OLEUPDATE_ALWAYS 更新链接项（如果可能）。 此选项支持 "链接" 对话框中的 "自动链接-更新" 单选按钮。

- OLEUPDATE_ONCALL 仅在来自容器应用程序的请求（调用[UpdateLink](#updatelink)成员函数时）更新链接项。 此选项支持 "链接" 对话框中的 "手动链接-更新" 单选按钮。

### <a name="remarks"></a>备注

通常，不应更改用户在 "链接" 对话框中选择的更新选项。

有关详细信息，请参阅 Windows SDK 中的[IOleLink：： SetUpdateOptions](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) 。

##  <a name="setprintdevice"></a>COleClientItem：： SetPrintDevice

调用此函数可更改此项的打印目标设备。

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>参数

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)数据结构的指针，该结构包含有关新的打印目标设备的信息。 可以为 NULL。

*ppd*<br/>
指向[PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga)数据结构的指针，该结构包含有关新的打印目标设备的信息。 可以为 NULL。

### <a name="return-value"></a>返回值

如果函数成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数更新项的打印目标设备，但不刷新显示缓存。 若要更新项目的表示缓存，请调用[UpdateLink](#updatelink)。

此函数的参数包含 OLE 系统用于标识目标设备的信息。 `PRINTDLG`结构包含 Windows 用于初始化常见 "打印" 对话框的信息。 用户关闭对话框后，Windows 将返回有关此结构中的用户选择的信息。 [CPrintDialog 对象](../../mfc/reference/cprintdialog-class.md)的`PRINTDLG`成员是结构。 `m_pd`

有关此结构的详细信息，请参阅 Windows SDK 中的[PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga) 。

有关详细信息，请参阅 Windows SDK 中的[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) 。

##  <a name="updatelink"></a>COleClientItem：： UpdateLink

调用此函数可立即更新 OLE 项的显示数据。

```
BOOL UpdateLink();
```

### <a name="return-value"></a>返回值

若成功，则为非零；否则为 0。

### <a name="remarks"></a>备注

对于链接项，函数将查找链接源以获取 OLE 项的新表示形式。 此过程可能需要运行一个或多个服务器应用程序，这可能需要很长时间。 对于嵌入项，函数以递归方式运行，并检查嵌入项是否包含可能已过期的链接并进行更新。 用户还可以使用 "链接" 对话框手动更新单个链接。

有关详细信息，请参阅 Windows SDK 中的[IOleLink：： Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) 。

## <a name="see-also"></a>请参阅

[MFC 示例 MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC 示例 OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem 类](../../mfc/reference/cdocitem-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem 类](../../mfc/reference/coleserveritem-class.md)
