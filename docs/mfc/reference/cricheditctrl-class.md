---
title: CRichEditCtrl 类
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 253b1958a93fea28fa2d1408bc8238a5eb0ca519
ms.sourcegitcommit: 46d24d6e70c03e05484923d9efc6ed5150e96a64
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/09/2019
ms.locfileid: "68916805"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl 类

提供 Rich Edit 控件功能。

## <a name="syntax"></a>语法

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|构造 `CRichEditCtrl` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CRichEditCtrl::CanPaste](#canpaste)|确定是否可以将剪贴板的内容粘贴到此 rich edit 控件中。|
|[CRichEditCtrl::CanRedo](#canredo)|确定控件的重做队列中是否有任何操作。|
|[CRichEditCtrl::CanUndo](#canundo)|确定编辑操作是否可以撤消。|
|[CRichEditCtrl::CharFromPos](#charfrompos)|检索有关编辑控件工作区中指定点最近的字符的信息。|
|[CRichEditCtrl::Clear](#clear)|清除当前选定内容。|
|[CRichEditCtrl::Copy](#copy)|将当前所选内容复制到剪贴板。|
|[CRichEditCtrl::Create](#create)|创建 Windows rich edit 控件并将其与此`CRichEditCtrl`对象相关联。|
|[CRichEditCtrl::CreateEx](#createex)|用指定的扩展 Windows 样式创建 Windows rich edit 控件, 并将其与此`CRichEditCtrl`对象相关联。|
|[CRichEditCtrl::Cut](#cut)|将当前所选内容剪切到剪贴板。|
|[CRichEditCtrl::DisplayBand](#displayband)|显示此`CRichEditCtrl`对象的一部分内容。|
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|重置 (清除) 此`CRichEditCtrl`对象的撤消标志。|
|[CRichEditCtrl::FindText](#findtext)|查找此`CRichEditCtrl`对象中的文本。|
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|查找指定字符位置前后的下一个单词分隔符, 或检索有关该位置的字符的信息。|
|[CRichEditCtrl::FormatRange](#formatrange)|格式化目标输出设备的文本范围。|
|[CRichEditCtrl::GetCharPos](#getcharpos)|确定给定字符在此`CRichEditCtrl`对象中的位置。|
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|检索此`CRichEditCtrl`对象中的当前默认字符格式设置特性。|
|[CRichEditCtrl::GetEventMask](#geteventmask)|检索此`CRichEditCtrl`对象的事件掩码。|
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|确定此`CRichEditCtrl`对象中最顶层的可见行。|
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|检索指向`IRichEditOle`此富编辑控件接口的指针。|
|[CRichEditCtrl::GetLimitText](#getlimittext)|获取用户可在此`CRichEditCtrl`对象中输入的文本量的限制。|
|[CRichEditCtrl::GetLine](#getline)|从此`CRichEditCtrl`对象中检索一行文本。|
|[CRichEditCtrl::GetLineCount](#getlinecount)|检索此`CRichEditCtrl`对象中的行数。|
|[CRichEditCtrl::GetModify](#getmodify)|确定此`CRichEditCtrl`对象的内容自上次保存后是否已更改。|
|[CRichEditCtrl::GetOptions](#getoptions)|检索 rich edit 控件选项。|
|[CRichEditCtrl::GetParaFormat](#getparaformat)|检索此`CRichEditCtrl`对象的当前选定内容中的段落格式特性。|
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|检索超文本编辑控件的当前标点字符。 此消息仅适用于亚洲语言版本的操作系统。|
|[CRichEditCtrl::GetRect](#getrect)|检索该`CRichEditCtrl`对象的格式设置矩形。|
|[CRichEditCtrl::GetRedoName](#getredoname)|检索控件的重做队列中的下一操作 (如果有) 的类型。|
|[CRichEditCtrl::GetSel](#getsel)|获取此`CRichEditCtrl`对象中当前所选内容的起始位置和结束位置。|
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|检索此`CRichEditCtrl`对象的当前选定内容中的字符格式设置特性。|
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|检索此`CRichEditCtrl`对象中当前选定内容的内容类型。|
|[CRichEditCtrl::GetSelText](#getseltext)|获取此`CRichEditCtrl`对象中当前选定内容的文本|
|[CRichEditCtrl::GetTextLength](#gettextlength)|检索此对象中文本`CRichEditCtrl`的长度 (以字符为字符)。 不包括终止 null 字符。|
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|检索 rich edit 视图中的字符数或字节数。 接受一系列标志, 用于指示在 rich edit 控件中确定文本长度的方法|
|[CRichEditCtrl::GetTextMode](#gettextmode)|检索 rich edit 控件的当前文本模式和撤消级别。|
|[CRichEditCtrl::GetTextRange](#gettextrange)|检索指定范围内的文本。|
|[CRichEditCtrl::GetUndoName](#getundoname)|检索下一个撤消操作的类型 (如果有)。|
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|检索超文本编辑控件的当前自动换行和断字选项。 此消息仅适用于亚洲语言版本的操作系统。|
|[CRichEditCtrl::HideSelection](#hideselection)|显示或隐藏当前选定内容。|
|[CRichEditCtrl::LimitText](#limittext)|限制用户可输入到`CRichEditCtrl`对象中的文本量。|
|[CRichEditCtrl::LineFromChar](#linefromchar)|确定包含给定字符的行。|
|[CRichEditCtrl::LineIndex](#lineindex)|检索此`CRichEditCtrl`对象中给定行的字符索引。|
|[CRichEditCtrl::LineLength](#linelength)|检索此`CRichEditCtrl`对象中给定行的长度。|
|[CRichEditCtrl::LineScroll](#linescroll)|滚动此`CRichEditCtrl`对象中的文本。|
|[CRichEditCtrl::Paste](#paste)|将剪贴板中的内容插入到此 rich edit 控件中。|
|[CRichEditCtrl::PasteSpecial](#pastespecial)|以指定的数据格式将剪贴板的内容插入到此 rich edit 控件中。|
|[CRichEditCtrl::PosFromChar](#posfromchar)|检索编辑控件中指定字符的工作区坐标。|
|[CRichEditCtrl::Redo](#redo)|重复执行控件的重做队列中的下一个操作。|
|[CRichEditCtrl::ReplaceSel](#replacesel)|将此`CRichEditCtrl`对象中的当前选定内容替换为指定的文本。|
|[CRichEditCtrl::RequestResize](#requestresize)|强制此`CRichEditCtrl`对象发送请求重设大小通知。|
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|指示自动 URL 检测在 rich edit 控件中是否处于活动状态。|
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|设置此`CRichEditCtrl`对象的背景色。|
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|设置此`CRichEditCtrl`对象中的当前默认字符格式设置特性。|
|[CRichEditCtrl::SetEventMask](#seteventmask)|为此`CRichEditCtrl`对象设置事件掩码。|
|[CRichEditCtrl::SetModify](#setmodify)|为此`CRichEditCtrl`对象设置或清除修改标志。|
|[CRichEditCtrl::SetOLECallback](#setolecallback)|设置此`IRichEditOleCallback`富编辑控件的 COM 对象。|
|[CRichEditCtrl::SetOptions](#setoptions)|设置此`CRichEditCtrl`对象的选项。|
|[CRichEditCtrl::SetParaFormat](#setparaformat)|设置此`CRichEditCtrl`对象中当前选定内容的段落格式特性。|
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|设置超文本编辑控件的标点字符。 此消息仅适用于亚洲语言版本的操作系统。|
|[CRichEditCtrl::SetReadOnly](#setreadonly)|设置此`CRichEditCtrl`对象的只读选项。|
|[CRichEditCtrl::SetRect](#setrect)|为此`CRichEditCtrl`对象设置格式矩形。|
|[CRichEditCtrl::SetSel](#setsel)|设置此`CRichEditCtrl`对象中的选定内容。|
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|设置此`CRichEditCtrl`对象中当前选定内容的字符格式设置特性。|
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|设置此`CRichEditCtrl`对象的目标输出设备。|
|[CRichEditCtrl::SetTextMode](#settextmode)|设置 rtf 编辑控件的文本模式或撤消级别。 如果控件包含文本, 则该消息将失败。|
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|设置可存储在撤消队列中的操作的最大数量。|
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|设置此`CRichEditCtrl`对象的当前单词中的字符格式设置特性。|
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|为 rich edit 控件设置换行和换行选项。 此消息仅适用于亚洲语言版本的操作系统。|
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|阻止控件将其他键入操作收集到当前的撤消操作中。 控件将下一个键入操作 (如果有) 存储在撤消队列中的新操作中。|
|[CRichEditCtrl::StreamIn](#streamin)|将输入流中的文本插入到`CRichEditCtrl`此对象中。|
|[CRichEditCtrl::StreamOut](#streamout)|将此`CRichEditCtrl`对象中的文本存储到输出流中。|
|[CRichEditCtrl::Undo](#undo)|反转最后一个编辑操作。|

## <a name="remarks"></a>备注

"Rich edit 控件" 是用户可在其中输入和编辑文本的窗口。 可以为文本分配字符和段落格式, 还可以包括嵌入的 OLE 对象。 Rich edit 控件提供了用于设置文本格式的编程接口。 但是，应用程序必须实现使用户可进行格式设置操作所需的任何用户界面组件。

此 windows 公共控件 (因而`CRichEditCtrl`类) 仅适用于在 windows 95/98 和 windows NT 版本3.51 及更高版本下运行的程序。 `CRichEditCtrl`类支持 Windows SDK 格式编辑控件的2.0 和3.0 版本。

> [!CAUTION]
>  如果在对话框中使用 rich edit 控件 (无论应用程序是 SDI、MDI 还是基于对话框), 则必须在对话框显示之前调用[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)一次。 调用此函数的一个典型位置位于程序的 `InitInstance` 成员函数中。 您无需在每次显示对话框时调用它，仅第一次需要。 如果您使用 `AfxInitRichEdit`，则不必调用 `CRichEditView`。

有关使用`CRichEditCtrl`的详细信息, 请参阅:

- [控件](../../mfc/controls-mfc.md)

- [使用 CRichEditCtrl](../../mfc/using-cricheditctrl.md)

有关在 MFC 应用程序中使用 rich edit 控件的示例, 请参阅[写字板](../../overview/visual-cpp-samples.md)示例应用程序。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>要求

**标头：** afxcmn.h

##  <a name="canpaste"></a>CRichEditCtrl:: CanPaste

确定 rich edit 控件是否可以粘贴指定的剪贴板格式。

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>参数

*nFormat*<br/>
要查询的剪贴板数据格式。 此参数可以是预定义的剪贴板格式之一, 也可以是[RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata)返回的值。

### <a name="return-value"></a>返回值

如果可以粘贴剪贴板格式, 则为非零值;否则为0。

### <a name="remarks"></a>备注

如果*nFormat*为 0, `CanPaste`将尝试当前剪贴板上的任何格式。

有关详细信息, 请参阅 Windows SDK 中的[EM_CANPASTE](/windows/desktop/Controls/em-canpaste)消息和[RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata)函数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

##  <a name="canredo"></a>CRichEditCtrl:: CanRedo

确定重做队列是否包含任何操作。

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>返回值

如果重做队列包含操作, 则为非零; 否则为0。

### <a name="remarks"></a>备注

若要在重做队列中发现操作的名称, 请调用[CRichEditCtrl:: GetRedoName](#getredoname)。 若要重做最新的撤消操作, 请调用[redo](#redo)。

有关详细信息, 请参阅 Windows SDK 中的[EM_CANREDO](/windows/desktop/Controls/em-canredo) 。

##  <a name="canundo"></a>CRichEditCtrl:: CanUndo

确定是否可以撤消最后一个编辑操作。

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>返回值

如果可以通过调用[Undo](#undo)成员函数撤消上一个编辑操作, 则为非零值;如果无法撤消, 则为0。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_CANUNDO](/windows/desktop/Controls/em-canundo) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

##  <a name="charfrompos"></a>CRichEditCtrl:: CharFromPos

检索有关参数*pt*指定点处的字符的信息。

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>参数

*pt*<br/>
一个[CPoint](../../atl-mfc-shared/reference/cpoint-class.md)对象, 它包含指定点的坐标。

### <a name="return-value"></a>返回值

最接近指定点的字符的从零开始的字符索引。 如果指定点超出控件中的最后一个字符, 则返回值指示控件中的最后一个字符。

### <a name="remarks"></a>备注

此成员函数适用于富编辑控件。 若要获取编辑控件的信息, 请调用[CEdit:: CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)。

有关详细信息, 请参阅 Windows SDK 中的[EM_CHARFROMPOS](/windows/desktop/Controls/em-charfrompos) 。

##  <a name="clear"></a>CRichEditCtrl:: Clear

删除 (清除) rich edit 控件中的当前选择 (如果有)。

```
void Clear();
```

### <a name="remarks"></a>备注

`Clear`可以通过调用[Undo](#undo)成员函数来撤消执行的删除操作。

若要删除当前所选内容并将删除的内容放到剪贴板上, 请调用[Cut](#cut)成员函数。

有关详细信息, 请参阅 Windows SDK 中的[WM_CLEAR](/windows/desktop/dataxchg/wm-clear) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

##  <a name="copy"></a>CRichEditCtrl:: Copy

将超文本编辑控件中的当前选定内容 (如果有) 复制到剪贴板。

```
void Copy();
```

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[WM_COPY](/windows/desktop/dataxchg/wm-copy) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

##  <a name="create"></a>CRichEditCtrl:: Create

创建 Windows rich edit 控件并将其与此`CRichEditCtrl`对象相关联。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
指定编辑控件的样式。 应用下面的 "**备注**" 部分中列出的窗口样式的组合, 并[编辑控件样式](/windows/desktop/Controls/edit-control-styles), 如 Windows SDK 中所述。

*rect*<br/>
指定编辑控件的大小和位置。 可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](/windows/desktop/api/windef/ns-windef-tagrect)结构。

*pParentWnd*<br/>
指定编辑控件的父窗口 (通常为[CDialog](../../mfc/reference/cdialog-class.md))。 它不能为 NULL。

*nID*<br/>
指定编辑控件的 ID。

### <a name="return-value"></a>返回值

如果初始化成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

可以通过`CRichEditCtrl`两个步骤构造对象。 首先, 调用[CRichEditCtrl](#cricheditctrl)构造函数, 然后调用`Create`, 它会创建 Windows 编辑控件并将其`CRichEditCtrl`附加到对象。

使用此函数创建 rich edit 控件时, 首先必须加载必要的公共控件库。 若要加载库, 请调用 global 函数[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit), 该函数将初始化公共控件库。 您只需要在`AfxInitRichEdit`进程中调用一次。

执行`Create`时, Windows 会将[WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)、 [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)和[WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)消息发送到编辑控件。

默认情况下, 将`CWnd`通过基类中的[OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate)、 [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)和[OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)成员函数来处理这些消息。 若要扩展默认消息处理, 请从`CRichEditCtrl`派生类, 将消息映射添加到新类, 并重写上述消息处理程序成员函数。 例如`OnCreate`, 重写, 以便为新类执行所需的初始化。

将以下[窗口样式](../../mfc/reference/styles-used-by-mfc.md#window-styles)应用于编辑控件。

- WS_CHILD。

- 通常, WS_VISIBLE。

- WS_DISABLED 极少。

- WS_GROUP 到分组控件。

- WS_TABSTOP, 以按 tab 键顺序包含编辑控件。

有关窗口样式的详细信息, 请参阅 Windows SDK 中的[CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

##  <a name="createex"></a>CRichEditCtrl:: CreateEx

创建一个控件 (子窗口) 并将`CRichEditCtrl`其与对象关联。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwExStyle*<br/>
指定正在创建的控件的扩展样式。 有关扩展 Windows 样式的列表, 请参阅 Windows SDK 中[CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa)的*dwExStyle*参数。

*dwStyle*<br/>
指定编辑控件的样式。 应用[创建](#create)和[编辑控件样式](/windows/desktop/Controls/edit-control-styles)的 "**备注**" 部分中列出的窗口样式的组合, 如 Windows SDK 中所述。

*rect*<br/>
对[矩形](/previous-versions/dd162897\(v=vs.85\))结构的引用, 该结构描述要创建的窗口的大小和位置 (以*pParentWnd*的工作区坐标表示)。

*pParentWnd*<br/>
指向作为控件的父级的窗口的指针。

*nID*<br/>
控件的子窗口 ID。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

使用`CreateEx`而不是来应用扩展的windows样式,由windows扩展样式指定的WS_EX_。`Create`

##  <a name="cricheditctrl"></a>CRichEditCtrl:: CRichEditCtrl

构造 `CRichEditCtrl` 对象。

```
CRichEditCtrl();
```

### <a name="remarks"></a>备注

使用[Create](#create)构造 Windows rich edit 控件。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

##  <a name="cut"></a>CRichEditCtrl:: Cut

删除 (剪切) rich edit 控件中的当前选定内容 (如果有), 并将删除的文本复制到剪贴板。

```
void Cut();
```

### <a name="remarks"></a>备注

`Cut`可以通过调用[Undo](#undo)成员函数来撤消执行的删除操作。

若要删除当前所选内容而不将删除的文本放入剪贴板, 请调用[Clear](#clear)成员函数。

有关详细信息, 请参阅 Windows SDK 中的[WM_CUT](/windows/desktop/dataxchg/wm-cut) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

##  <a name="displayband"></a>CRichEditCtrl::D isplayBand

显示富格编辑控件 (文本和 OLE 项) 的一部分内容, 如以前通过[FormatRange](#formatrange)进行了格式化。

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>参数

*pDisplayRect*<br/>
指向[RECT](/windows/desktop/api/windef/ns-windef-tagrect)或[CRect](../../atl-mfc-shared/reference/crect-class.md)对象的指针, 该对象指定要显示文本的设备区域。

### <a name="return-value"></a>返回值

如果格式化文本的显示成功, 则为非零; 否则为0。

### <a name="remarks"></a>备注

文本和 OLE 项将被剪裁到指针*pDisplayRect*指定的区域。

有关详细信息, 请参阅 Windows SDK 中的[EM_DISPLAYBAND](/windows/desktop/Controls/em-displayband) 。

### <a name="example"></a>示例

  请参阅[CRichEditCtrl:: FormatRange](#formatrange)的示例。

##  <a name="emptyundobuffer"></a>CRichEditCtrl:: EmptyUndoBuffer

重置 (清除) 此 rich edit 控件的撤消标志。

```
void EmptyUndoBuffer();
```

### <a name="remarks"></a>备注

控件现在无法撤消上次编辑操作。 如果可以撤消超文本编辑控件中的操作, 则会设置 undo 标志。

每当调用[CWnd](../../mfc/reference/cwnd-class.md)成员函数[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)时, 都会自动清除 undo 标志。

有关详细信息, 请参阅 Windows SDK 中的[EM_EMPTYUNDOBUFFER](/windows/desktop/Controls/em-emptyundobuffer) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

##  <a name="findtext"></a>CRichEditCtrl:: FindText

在 rich edit 控件内查找文本。

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>参数

*dwFlags*<br/>
有关可能值的列表, 请参阅 Windows SDK 中的[EM_FINDTEXTEXT](/windows/desktop/Controls/em-findtextex)中的*wParam* 。

*pFindText*<br/>
指向[FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-findtextexa)结构的指针, 该结构提供搜索参数并返回找到匹配项的范围。

### <a name="return-value"></a>返回值

下一个匹配项的从零开始的字符位置;如果没有更多匹配项, 则为-1。

### <a name="remarks"></a>备注

您可以通过在`FINDTEXTEX`结构中的[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-charrange)结构中设置适当的范围参数来向上或向下搜索。

有关详细信息, 请参阅 Windows SDK 中的[EM_FINDTEXTEX](/windows/desktop/Controls/em-findtextex)消息和[FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-findtextexa)结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

##  <a name="findwordbreak"></a>CRichEditCtrl:: FindWordBreak

查找*nStart*指定的位置之前或之后的下一个分行符。

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>参数

*nCode*<br/>
指示要执行的操作。 有关可能值的列表, 请参阅 Windows SDK 中 EM_FINDWORDBREAK 的参数*代码*说明。

*nStart*<br/>
从其开始的从零开始的字符位置。

### <a name="return-value"></a>返回值

基于参数*nCode*。 有关详细信息, 请参阅 Windows SDK 中的[EM_FINDWORDBREAK](/windows/desktop/Controls/em-findwordbreak) 。

### <a name="remarks"></a>备注

您可以使用此成员函数检索有关位于给定位置的字符的信息。

##  <a name="formatrange"></a>CRichEditCtrl:: FormatRange

设置特定设备的超文本编辑控件中的文本范围格式。

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>参数

*pfr*<br/>
指向[FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-formatrange)结构的指针, 该结构包含有关输出设备的信息。 NULL 表示可以释放 rich edit 控件中的缓存信息。

*bDisplay*<br/>
指示是否应呈现文本。 如果为 FALSE, 则仅度量文本。

### <a name="return-value"></a>返回值

位于区域中的最后一个字符的索引。

### <a name="remarks"></a>备注

通常, 此调用后跟对[DisplayBand](#displayband)的调用。

有关详细信息, 请参阅 Windows SDK 中的[EM_FORMATRANGE](/windows/desktop/Controls/em-formatrange)消息和[FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-formatrange)结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

##  <a name="getcharpos"></a>CRichEditCtrl:: GetCharPos

获取此`CRichEditCtrl`对象内给定字符的位置 (左上角)。

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>参数

*lChar*<br/>
字符的从零开始的索引。

### <a name="return-value"></a>返回值

由*lChar*指定的字符的左上角的位置。

### <a name="remarks"></a>备注

字符是通过提供其从零开始的索引值来指定的。 如果*lChar*大于此`CRichEditCtrl`对象中最后一个字符的索引, 则返回值指定紧随此`CRichEditCtrl`对象中最后一个字符的字符位置的坐标。

有关详细信息, 请参阅 Windows SDK 中的[EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) 。

##  <a name="getdefaultcharformat"></a>CRichEditCtrl:: GetDefaultCharFormat

获取此`CRichEditCtrl`对象的默认字符格式设置特性。

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中, 指向包含默认`CHARFORMAT`字符格式设置属性的结构的指针。

在第二个版本中, 是指向`CHARFORMAT2`结构的指针, 该结构是`CHARFORMAT`对结构的 Rich Edit 2.0 扩展, 其中包含默认字符格式设置特性。

### <a name="return-value"></a>返回值

Cf `dwMask`的数据成员。它指定了默认字符格式设置属性。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 EM_GETCHARFORMAT 消息和`CHARFORMAT` Windows SDK 中的和`CHARFORMAT2`结构。

### <a name="example"></a>示例

  请参阅[SetDefaultCharFormat](#setdefaultcharformat)的示例。

##  <a name="geteventmask"></a>CRichEditCtrl:: GetEventMask

获取此`CRichEditCtrl`对象的事件掩码。

```
long GetEventMask() const;
```

### <a name="return-value"></a>返回值

此`CRichEditCtrl`对象的事件掩码。

### <a name="remarks"></a>备注

事件掩码指定`CRichEditCtrl`对象发送到其父窗口的通知消息。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETEVENTMASK](/windows/desktop/Controls/em-geteventmask) 。

### <a name="example"></a>示例

  请参阅[CRichEditCtrl:: SetEventMask](#seteventmask)的示例。

##  <a name="getfirstvisibleline"></a>CRichEditCtrl:: GetFirstVisibleLine

确定此`CRichEditCtrl`对象中最顶层的可见行。

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>返回值

此`CRichEditCtrl`对象中最上方可见行的从零开始的索引。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_GETFIRSTVISIBLELINE](/windows/desktop/Controls/em-getfirstvisibleline) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

##  <a name="getiricheditole"></a>  CRichEditCtrl::GetIRichEditOle

访问此`IRichEditOle` `CRichEditCtrl`对象的接口。

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>返回值

指向[IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole)接口的指针, 该接口可用于访问此`CRichEditCtrl`对象的 OLE 功能;如果接口不可访问, 则为 NULL。

### <a name="remarks"></a>备注

使用此接口可以访问此`CRichEditCtrl`对象的 OLE 功能。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETOLEINTERFACE](/windows/desktop/Controls/em-getoleinterface) Message and [IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole) interface。

##  <a name="getlimittext"></a>CRichEditCtrl:: GetLimitText

获取此`CRichEditCtrl`对象的文本限制。

```
long GetLimitText() const;
```

### <a name="return-value"></a>返回值

此`CRichEditCtrl`对象的当前文本限制 (以字节为单位)。

### <a name="remarks"></a>备注

"文本限制" 是超文本编辑控件可以接受的最大文本量 (以字节为单位)。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETLIMITTEXT](/windows/desktop/Controls/em-getlimittext) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

##  <a name="getline"></a>CRichEditCtrl:: GetLine

从此`CRichEditCtrl`对象中检索一行文本。

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
要检索的行的从零开始的索引。

*lpszBuffer*<br/>
指向用于接收文本的缓冲区。 缓冲区的第一个字必须指定可复制到缓冲区中的最大字节数。

*nMaxLength*<br/>
可以复制到*lpszBuffer*中的最大字符数。 第二种形式`GetLine`将此值放入*lpszBuffer*指定的缓冲区的第一个字中。

### <a name="return-value"></a>返回值

复制到*lpszBuffer*中的字符数。

### <a name="remarks"></a>备注

复制的行不包含终止 null 字符。

> [!NOTE]
>  因为缓冲区的第一个词存储要复制的字符数, 请确保缓冲区的长度至少为4个字节。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETLINE](/windows/desktop/Controls/em-getline) 。

### <a name="example"></a>示例

  请参阅[GetLineCount](#getlinecount)的示例。

##  <a name="getlinecount"></a>CRichEditCtrl:: GetLineCount

检索`CRichEditCtrl`对象中的行数。

```
int GetLineCount() const;
```

### <a name="return-value"></a>返回值

此`CRichEditCtrl`对象中的行数。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_GETLINECOUNT](/windows/desktop/Controls/em-getlinecount) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

##  <a name="getmodify"></a>CRichEditCtrl:: GetModify

确定此`CRichEditCtrl`对象的内容是否已被修改。

```
BOOL GetModify() const;
```

### <a name="return-value"></a>返回值

如果此`CRichEditCtrl`对象中的文本已被修改, 则为非零; 否则为0。

### <a name="remarks"></a>备注

Windows 将维护一个内部标志, 该标志指示是否更改了 rich edit 控件的内容。 当编辑控件是第一次创建的, 并且还可以通过调用[SetModify](#setmodify)成员函数清除时, 此标志会被清除。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETMODIFY](/windows/desktop/Controls/em-getmodify) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

##  <a name="getoptions"></a>CRichEditCtrl:: GetOptions

检索当前为 rich edit 控件设置的选项。

```
UINT GetOptions() const;
```

### <a name="return-value"></a>返回值

当前选项标志值的组合。 有关这些值的列表, 请参阅[EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions)消息中的*用于*参数, 如 Windows SDK 中所述。

##  <a name="getparaformat"></a>CRichEditCtrl:: GetParaFormat

获取当前选定内容的段落格式特性。

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>参数

*pf*<br/>
在第一个版本中, 是指向[PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-paraformat)结构的指针, 用于保存当前所选内容的段落格式特性。

在第二个版本中, 是指向[PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2)结构的指针, 该结构是对`PARAFORMAT`结构的丰富编辑2.0 扩展, 它包含默认的字符格式设置特性。

### <a name="return-value"></a>返回值

`dwMask` *Pf*的数据成员。 它指定在当前选定内容中一致的段落格式特性。

### <a name="remarks"></a>备注

如果选择了多个段落, *pf*会接收选定段落的第一个段落。 返回值指定哪些属性在整个选定内容中是一致的。

有关详细信息, 请参阅[EM_GETPARAFORMAT](/windows/desktop/Controls/em-getparaformat)消息和`PARAFORMAT` Windows SDK 中`PARAFORMAT2`的和结构。

### <a name="example"></a>示例

  请参阅[CRichEditCtrl:: SetParaFormat](#setparaformat)的示例。

##  <a name="getpunctuation"></a>CRichEditCtrl:: GetPunctuation

获取 rich edit 控件中的当前标点符号字符。

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>参数

*fType*<br/>
标点符号类型标志, 如 Windows SDK 中[EM_GETPUNCTUATION](/windows/desktop/Controls/em-getpunctuation)的*fType*参数中所述。

*lpPunc*<br/>
指向[标点符号](/windows/desktop/api/richedit/ns-richedit-punctuation)结构的指针, 如 Windows SDK 中所述。

### <a name="return-value"></a>返回值

如果操作成功, 则为非零; 否则为0。

### <a name="remarks"></a>备注

此成员函数仅适用于亚洲语言版本的操作系统。

##  <a name="getrect"></a>CRichEditCtrl:: GetRect

检索该`CRichEditCtrl`对象的格式设置矩形。

```
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指向要接收此`CRichEditCtrl`对象的格式设置矩形的 [RECT](/windows/desktop/api/windef/ns-windef-tagrect) 的指针。

### <a name="remarks"></a>备注

格式设置矩形是文本的边框。 此值与`CRichEditCtrl`对象的大小无关。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETRECT](/windows/desktop/Controls/em-getrect) 。

### <a name="example"></a>示例

  请参阅[LimitText](#limittext)的示例。

##  <a name="getredoname"></a>CRichEditCtrl:: GetRedoName

检索重做队列中下一个可用操作的类型 (如果有)。

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>返回值

如果成功, `GetRedoName`则返回[UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-undonameid)枚举类型, 该类型指示控件的重做队列中的下一操作的类型。 如果重做队列为空, 或如果队列中的 "重做" 操作是未知类型, `GetRedoName`则返回0。

### <a name="remarks"></a>备注

可以撤消或重做的操作类型包括键入、删除、拖放、剪切和粘贴操作。 此信息可用于为撤消和重做操作提供扩展用户界面的应用程序, 例如 redoable 操作的下拉列表框。

##  <a name="getsel"></a>CRichEditCtrl:: GetSel

检索此`CRichEditCtrl`对象中当前选定内容的边界。

```
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>参数

*cr*<br/>
对[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-charrange)结构的引用, 用于接收当前所选内容的边界。

*nStartChar*<br/>
当前选定内容中第一个字符的从零开始的索引。

*nEndChar*<br/>
当前选定内容中最后一个字符的从零开始的索引。

### <a name="remarks"></a>备注

此函数的两种形式提供了获取选定内容的边界的替代方法。 这些形式的简要说明如下所示:

- **GetSel (** `cr` **)** 此窗体将`CHARRANGE`结构与其`cpMin`和`cpMax`成员一起使用以返回界限。

- **GetSel (** `nStartChar` **,** ) 此窗体返回参数 nStartChar 和 nEndChar 中的界限。 `nEndChar`

如果开头 (`cpMin`或*nStartChar*) 为 0, 结束 (`cpMax`或*nEndChar*) 为-1, 则选择内容包括所有内容。

有关详细信息, 请参阅 Windows SDK 中的[EM_EXGETSEL](/windows/desktop/Controls/em-exgetsel)消息和[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-charrange)结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

##  <a name="getselectioncharformat"></a>CRichEditCtrl:: GetSelectionCharFormat

获取当前选择的字符格式特性。

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中, 是指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构的指针, 该结构接收当前选定内容的字符格式设置特性。

在第二个版本中, 是指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构的指针, 该结构是用于接收当前选择`CHARFORMAT`的字符格式设置属性的结构的丰富编辑2.0 扩展。

### <a name="return-value"></a>返回值

Cf `dwMask`的数据成员。它指定在当前选定内容中一致的字符格式设置特性。

### <a name="remarks"></a>备注

*Cf*参数接收当前选定内容中第一个字符的属性。 返回值指定哪些属性在整个选定内容中是一致的。

有关详细信息, 请参阅[EM_GETCHARFORMAT](/windows/desktop/Controls/em-getcharformat)消息和`CHARFORMAT` Windows SDK 中`CHARFORMAT2`的和结构。

### <a name="example"></a>示例

  请参阅[SetSelectionCharFormat](#setselectioncharformat)的示例。

##  <a name="getselectiontype"></a>CRichEditCtrl:: GetSelectionType

确定此`CRichEditCtrl`对象中的选择类型。

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>返回值

指示当前所选内容的标志。 以下标志的组合:

- SEL_EMPTY 指示当前没有选定内容。

- SEL_TEXT 指示当前所选内容包含文本。

- SEL_OBJECT 指示当前所选内容至少包含一个 OLE 项。

- SEL_MULTICHAR 指示当前所选内容包含多个文本字符。

- SEL_MULTIOBJECT 指示当前所选内容包含多个 OLE 对象。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_SELECTIONTYPE](/windows/desktop/Controls/em-selectiontype) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

##  <a name="getseltext"></a>CRichEditCtrl:: GetSelText

从此`CRichEditCtrl`对象中的当前选定内容检索文本。

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>参数

*lpBuf*<br/>
指向缓冲区的指针, 该缓冲区用于接收当前选定内容中的文本。

### <a name="return-value"></a>返回值

取决于窗体:

- **GetSelText (** `lpBuf` **)** 复制到*lpBuf*中的字符数, 不包括 null 终止。

- **GetSelText ()** 包含当前所选内容的字符串。

### <a name="remarks"></a>备注

如果使用第一种形式**GetSelText (** `lpBuf` **)** , 则必须确保缓冲区的大小足以容纳它将接收的文本。 调用[GetSel](#getsel)以确定当前选择的字符数。

有关详细信息, 请参阅 Windows SDK 中的[EM_GETSELTEXT](/windows/desktop/Controls/em-getseltext) 。

### <a name="example"></a>示例

  请参阅[CRichEditCtrl:: GetSelectionType](#getselectiontype)的示例。

##  <a name="gettextlength"></a>CRichEditCtrl:: GetTextLength

检索此`CRichEditCtrl`对象中文本的长度 (以字符为长度), 不包括终止 null 字符。

```
long GetTextLength() const;
```

### <a name="return-value"></a>返回值

此对象中文本`CRichEditCtrl`的长度。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[WM_GETTEXTLENGTH](/windows/desktop/winmsg/wm-gettextlength) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

##  <a name="gettextlengthex"></a>CRichEditCtrl:: GetTextLengthEx

计算格式编辑控件中文本的长度。

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>参数

*dwFlags*<br/>
值, 用于指定确定文本长度时使用的方法。 此成员可以是 Windows SDK 中所述的 [GETTEXTLENGTHEX](/windows/desktop/api/richedit/ns-richedit-gettextlengthex) flags 成员中列出的一个或多个值。

*uCodePage*<br/>
用于转换的代码页 (对于 ANSI 代码页为 CP_ACP, 对于 Unicode 为 1200)。

### <a name="return-value"></a>返回值

编辑控件中的字符数或字节数。 如果*dwFlags*中设置了不兼容的标志, 此成员函数将返回 E_INVALIDARG。

### <a name="remarks"></a>备注

`GetTextLengthEx`提供确定文本长度的其他方法。 它支持丰富的编辑2.0 功能。 有关详细信息, 请参阅 Windows SDKfor 中的[丰富编辑控件](/windows/desktop/Controls/about-rich-edit-controls)。

##  <a name="gettextmode"></a>CRichEditCtrl:: GetTextMode

检索 rich edit 控件的当前文本模式和撤消级别。

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>返回值

[TEXTMODE](/windows/desktop/api/richedit/ne-richedit-tagtextmode)枚举类型的一组位标志, 如 Windows SDK 中所述。 标志指示控件的当前文本模式和撤消级别。

##  <a name="gettextrange"></a>CRichEditCtrl:: GetTextRange

获取指定范围内的字符。

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>参数

*nFirst*<br/>
紧跟在范围内第一个字符之前的字符位置索引。

*nLast*<br/>
紧跟在范围中最后一个字符之后的字符位置。

*refString*<br/>
对将接收文本的[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象的引用。

### <a name="return-value"></a>返回值

复制的字符数, 不包括终止 null 字符。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_GETTEXTRANGE](/windows/desktop/Controls/em-gettextrange) 。

`GetTextRange`支持丰富的编辑2.0 功能。 有关详细信息, 请参阅 Windows SDKfor 中的[丰富编辑控件](/windows/desktop/Controls/about-rich-edit-controls)。

##  <a name="getundoname"></a>CRichEditCtrl:: GetUndoName

检索撤消队列中下一个可用操作的类型 (如果有)。

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>返回值

如果撤消操作在控件的撤消队列中, `GetUndoName`则返回[UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-undonameid)枚举类型, 指示队列中下一操作的类型。 如果撤消队列为空, 或如果队列中的撤消操作为未知类型, `GetUndoName`则返回0。

### <a name="remarks"></a>备注

可以撤消或重做的操作类型包括键入、删除、拖放、剪切和粘贴操作。 此信息可用于为撤消和重做操作提供扩展用户界面的应用程序, 如可撤消的操作的下拉列表框。

##  <a name="getwordwrapmode"></a>CRichEditCtrl:: GetWordWrapMode

检索超文本编辑控件的当前自动换行和断字选项。

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>返回值

当前的 "自动换行" 和 "断字" 选项。 Windows SDK 中的[EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode)介绍了这些选项。

### <a name="remarks"></a>备注

此成员函数仅适用于亚洲语言版本的操作系统。

##  <a name="hideselection"></a>CRichEditCtrl:: HideSelection

更改所选内容的可见性。

```
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>参数

*bHide*<br/>
指示是显示还是隐藏所选内容, 为 TRUE 则隐藏选定内容。

*bPerm*<br/>
指示所选内容的此更改是否应为永久更改。

### <a name="remarks"></a>备注

当*bPerm*为 TRUE 时, 它会更改此`CRichEditCtrl`对象的 ECO_NOHIDESEL 选项。 有关此选项的简要说明, 请参阅[SetOptions](#setoptions)。 您可以使用此函数设置此`CRichEditCtrl`对象的所有选项。

有关详细信息, 请参阅 Windows SDK 中的[EM_HIDESELECTION](/windows/desktop/Controls/em-hideselection) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

##  <a name="limittext"></a>  CRichEditCtrl::LimitText

限制用户可输入到编辑控件中的文本的长度。

```
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>参数

*nChars*<br/>
指定用户可输入的文本的长度 (以字节为单位)。 如果此参数为 0 (默认值), 则文本长度设置为64K 字节。

### <a name="remarks"></a>备注

更改文本限制仅限制用户可输入的文本。 它不会影响编辑控件中已有的任何文本, 也不会影响中`CWnd`的[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)成员函数复制到编辑控件中的文本长度。 如果应用程序使用`SetWindowText`函数将更多的文本放入编辑控件中`LimitText`, 而不是调用中指定的, 则用户可以删除编辑控件中的任何文本。 但是, 文本限制会阻止用户将现有文本替换为新文本, 除非删除当前所选内容会导致文本小于文本限制。

> [!NOTE]
>  对于文本限制, 每个 OLE 项都作为单个字符计数。

有关详细信息, 请参阅 Windows SDK 中的[EM_EXLIMITTEXT](/windows/desktop/Controls/em-exlimittext) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

##  <a name="linefromchar"></a>CRichEditCtrl:: LineFromChar

检索包含指定字符索引的行的行号。

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
包含编辑控件文本中所需字符的从零开始的索引值, 或包含-1。 如果*nIndex*为-1, 则它指定当前行, 即包含插入符号的行。

### <a name="return-value"></a>返回值

包含由*nIndex*指定的字符索引的行的从零开始的行号。 如果*nIndex*为-1, 则返回包含所选内容的第一个字符的行号。 如果未选择任何内容, 则返回当前行号。

### <a name="remarks"></a>备注

字符索引是从超文本编辑控件开头的字符数。 对于字符计数, OLE 项作为单个字符计数。

有关详细信息, 请参阅 Windows SDK 中的[EM_EXLINEFROMCHAR](/windows/desktop/Controls/em-exlinefromchar) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

##  <a name="lineindex"></a>CRichEditCtrl:: LineIndex

检索此`CRichEditCtrl`对象内的行的字符索引。

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>参数

*nLine*<br/>
在编辑控件的文本中包含所需行的索引值, 或包含-1。 如果*n 第*为-1, 则它指定当前行, 即包含插入符号的行。

### <a name="return-value"></a>返回值

在*n 第*中指定的行的字符索引, 如果指定的行号大于编辑控件中的行数, 则为-1。

### <a name="remarks"></a>备注

字符索引是从超文本编辑控件开头到指定行的字符数。

有关详细信息, 请参阅 Windows SDK 中的[EM_LINEINDEX](/windows/desktop/controls/em-lineindex) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

##  <a name="linelength"></a>CRichEditCtrl:: LineLength

在 rich edit 控件中检索行的长度。

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>参数

*nLine*<br/>
指定要检索其长度的行中的字符的字符索引。 如果此参数为-1, 则返回当前行的长度 (包含脱字号的行), 而不是包含行中任何所选文本的长度。 为`LineLength`单行编辑控件调用时, 将忽略此参数。

### <a name="return-value"></a>返回值

为`LineLength`多行编辑控件调用时, 返回值为*n 第*指定的行的长度 (TCHAR)。  它不会在行的末尾包含回车符。 为`LineLength`单行编辑控件调用时, 返回值为编辑控件中文本的长度 (在 TCHAR 中)。 如果 N 第大于控件中的字符数, 则返回值为零。

### <a name="remarks"></a>备注

使用[LineIndex](#lineindex)成员函数检索此`CRichEditCtrl`对象内给定行号的字符索引。

有关详细信息, 请参阅 Windows SDK 中的[EM_LINELENGTH](/windows/desktop/Controls/em-linelength) 。

### <a name="example"></a>示例

  请参阅[LineIndex](#lineindex)的示例。

##  <a name="linescroll"></a>CRichEditCtrl:: LineScroll

滚动多行编辑控件的文本。

```
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>参数

*nLines*<br/>
指定垂直滚动的行数。

*nChars*<br/>
指定要水平滚动的字符位置数。 如果 rtf 编辑控件具有 ES_RIGHT 或 ES_CENTER 样式, 则将忽略此值。 在[Create](#create)中指定了[编辑样式](../../mfc/reference/styles-used-by-mfc.md#edit-styles)。

### <a name="remarks"></a>备注

编辑控件不会垂直滚动于编辑控件中的最后一行文本。 如果当前行加上*nLines*指定的行数超过了编辑控件中的总行数, 则将调整该值, 以便将编辑控件的最后一行滚动到编辑控件窗口的顶部。

`LineScroll`可用于水平滚动越过任意行的最后一个字符。

有关详细信息, 请参阅 Windows SDK 中的[EM_LINESCROLL](/windows/desktop/Controls/em-linescroll) 。

### <a name="example"></a>示例

  请参阅[GetFirstVisibleLine](#getfirstvisibleline)的示例。

##  <a name="paste"></a>CRichEditCtrl::P aste

将剪贴板中的数据插入到`CRichEditCtrl`插入点的位置, 插入符号的位置。

```
void Paste();
```

### <a name="remarks"></a>备注

仅当剪贴板包含可识别格式的数据时, 才插入数据。

有关详细信息, 请参阅 Windows SDK 中的[WM_PASTE](/windows/desktop/dataxchg/wm-paste) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

##  <a name="pastespecial"></a>CRichEditCtrl::P asteSpecial

将特定剪贴板格式的数据粘贴到此`CRichEditCtrl`对象中。

```
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>参数

*nClipFormat*<br/>
要粘贴到此`CRichEditCtrl`对象中的剪贴板格式。

*dvAspect*<br/>
从剪贴板检索数据的设备方位。

*hMF*<br/>
图元文件的句柄, 其中包含要粘贴的对象的图标视图。

### <a name="remarks"></a>备注

新材料将插入到插入点处, 插入符号的位置。

有关详细信息, 请参阅 Windows SDK 中的[EM_PASTESPECIAL](/windows/desktop/Controls/em-pastespecial) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

##  <a name="posfromchar"></a>CRichEditCtrl::P osFromChar

检索编辑控件中指定字符的工作区坐标。

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>参数

*nChar*<br/>
字符的从零开始的索引。

### <a name="return-value"></a>返回值

字符的位置, (x, y)。 对于单行编辑控件, y 坐标始终为零。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) 。

##  <a name="redo"></a>  CRichEditCtrl::Redo

重复执行控件的重做队列中的下一个操作。

```
BOOL Redo();
```

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

有关详细信息, 请参阅 Windows SDK 中的[EM_REDO](/windows/desktop/Controls/em-redo) 。

##  <a name="replacesel"></a>  CRichEditCtrl::ReplaceSel

将此`CRichEditCtrl`对象中的当前选定内容替换为指定的文本。

```
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>参数

*lpszNewText*<br/>
指向以 null 结尾的字符串的指针, 该字符串包含替换文本。

*bCanUndo*<br/>
若要指定此函数可以撤消, 请将此参数的值设置为 TRUE。 默认值是 FALSE。

### <a name="remarks"></a>备注

若要替换此`CRichEditCtrl`对象中的所有文本, 请使用[CWnd:: SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。

如果当前没有选定内容, 则将在插入点插入替换文本, 即当前的插入符号位置。

此函数将用现有字符格式设置插入的文本格式。 在替换整个文本范围 (通过在调用`SetSel` `ReplaceSel`之前调用 (0,-1)) 时, 有一个段落字符末尾保留上一段落的格式, 该格式由新插入的文本继承。

有关详细信息, 请参阅 Windows SDK 中的[EM_REPLACESEL](/windows/desktop/Controls/em-replacesel) 。

### <a name="example"></a>示例

  请参阅[LineIndex](#lineindex)的示例。

##  <a name="requestresize"></a>CRichEditCtrl:: RequestResize

强制此`CRichEditCtrl`对象将 EN_REQUESTRESIZE 通知消息发送到其父窗口。

```
void RequestResize();
```

### <a name="remarks"></a>备注

在[CWnd:: OnSize](../../mfc/reference/cwnd-class.md#onsize)处理无限`CRichEditCtrl`对象时, 此函数很有用。

有关详细信息, 请参阅有关 Windows SDK 中的[Rich Edit 控件](/windows/desktop/Controls/about-rich-edit-controls)的[EM_REQUESTRESIZE](/windows/desktop/Controls/em-requestresize)消息和**无限丰富的编辑控件**部分。

##  <a name="setautourldetect"></a>CRichEditCtrl:: SetAutoURLDetect

设置用于自动检测 URL 的 rich edit 控件。

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
指定是否将控件设置为自动检测 URL。 如果为 TRUE, 则启用它。 如果为 FALSE, 则禁用。

### <a name="return-value"></a>返回值

如果成功, 则为零; 否则为非零值。 例如, 消息可能因内存不足而失败。

### <a name="remarks"></a>备注

如果启用, 富编辑控件将扫描文本, 以确定它是否与标准 URL 格式匹配。 有关这些 URL 格式的列表, 请参阅 Windows SDK 中的[EM_AUTOURLDETECT](/windows/desktop/Controls/em-autourldetect) 。

> [!NOTE]
>  如果编辑控件`SetAutoURLDetect`对除 url 之外的文本使用 CFE_LINK 效果, 请不要将设置为 TRUE。 `SetAutoURLDetect`为 Url 启用此效果, 并对所有其他文本禁用此效果。 有关 CFE_LINK 效果的详细信息, 请参阅[EN_LINK](/windows/desktop/Controls/en-link) 。

##  <a name="setbackgroundcolor"></a>  CRichEditCtrl::SetBackgroundColor

设置此`CRichEditCtrl`对象的背景色。

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>参数

*bSysColor*<br/>
指示是否应将背景色设置为系统值。 如果此值为 TRUE, 则忽略*cr* 。

*cr*<br/>
请求的背景色。 仅当*bSysColor*为 FALSE 时使用。

### <a name="return-value"></a>返回值

此`CRichEditCtrl`对象的前一背景色。

### <a name="remarks"></a>备注

可以将背景色设置为系统值或指定的[COLORREF](/windows/desktop/gdi/colorref)值。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETBKGNDCOLOR](/windows/desktop/Controls/em-setbkgndcolor)消息和[COLORREF](/windows/desktop/gdi/colorref)结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

##  <a name="setdefaultcharformat"></a>CRichEditCtrl:: SetDefaultCharFormat

设置此`CRichEditCtrl`对象中新文本的字符格式设置特性。

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中, 指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构的指针, 该结构包含新的默认字符格式设置特性。

在第二个版本中, 指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构的指针, 该结构是对`CHARFORMAT`结构的一种丰富编辑2.0 扩展, 其中包含默认字符格式设置特性。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数只更改`dwMask` *cf*成员指定的属性。

有关详细信息, 请参阅[EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)消息和`CHARFORMAT` Windows SDK 中`CHARFORMAT2`的和结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

##  <a name="seteventmask"></a>CRichEditCtrl:: SetEventMask

为此`CRichEditCtrl`对象设置事件掩码。

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>参数

*dwEventMask*<br/>
此`CRichEditCtrl`对象的新事件掩码。

### <a name="return-value"></a>返回值

上一个事件掩码。

### <a name="remarks"></a>备注

事件掩码指定`CRichEditCtrl`对象发送到其父窗口的通知消息。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETEVENTMASK](/windows/desktop/Controls/em-seteventmask) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

##  <a name="setmodify"></a>CRichEditCtrl:: SetModify

设置或清除编辑控件的修改标志。

```
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>参数

*bModified*<br/>
如果值为 TRUE, 则表示文本已修改, 值为 FALSE 表示未修改该文本。 默认情况下, 已修改的标志设置为。

### <a name="remarks"></a>备注

修改后的标志指示编辑控件中的文本是否已被修改。 每当用户更改文本时, 将自动设置该设置。 可以通过[GetModify](#getmodify)成员函数检索其值。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETMODIFY](/windows/desktop/Controls/em-setmodify) 。

### <a name="example"></a>示例

  请参阅[GetModify](#getmodify)的示例。

##  <a name="setolecallback"></a>  CRichEditCtrl::SetOLECallback

为此`CRichEditCtrl`对象提供`IRichEditOleCallback`一个对象, 用于访问与 OLE 相关的资源和信息。

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>参数

*pCallback*<br/>
指向[IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback)对象的指针, 此`CRichEditCtrl`对象将使用该对象获取与 OLE 相关的资源和信息。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

此`CRichEditCtrl`对象将调用[IUnknown:: AddRef](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref)来递增*pCallback*指定的 COM 对象的使用计数。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETOLECALLBACK](/windows/desktop/Controls/em-setolecallback) Message and [IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback) interface。

##  <a name="setoptions"></a>CRichEditCtrl:: SetOptions

设置此`CRichEditCtrl`对象的选项。

```
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>参数

*wOp*<br/>
指示操作的类型。 以下值之一：

- ECOOP_SET 将选项设置为*dwFlags*指定的选项。

- ECOOP_OR 将当前的选项与*dwFlags*指定的选项组合在一起。

- ECOOP_AND 仅保留那些也由*dwFlags*指定的当前选项。

- ECOOP_XOR 逻辑异或当前选项与*dwFlags*指定的选项。

*dwFlags*<br/>
丰富的编辑选项。 标志值列在 "备注" 部分中。

### <a name="remarks"></a>备注

这些选项可以是下列值的组合:

- 双击时 ECO_AUTOWORDSELECTION 自动选择字词。

- 当用户在行尾键入字符时, ECO_AUTOVSCROLL 会自动将文本向右滚动10个字符。 当用户按 ENTER 键时, 控件将所有文本向上滚动到位置零。

- 当用户在最后一行按 ENTER 键时, ECO_AUTOHSCROLL 会自动将文本向上滚动一页。

- ECO_NOHIDESEL 对编辑控件的默认行为求反。 当控件失去输入焦点时, 默认行为会隐藏选定内容, 并在控件接收到输入焦点时显示选定内容。 如果您指定 ECO_NOHIDESEL, 则所选文本会反转, 即使控件没有焦点。

- ECO_READONLY 阻止用户在编辑控件中键入或编辑文本。

- ECO_WANTRETURN 指定当用户在对话框中的多行格式编辑控件中输入文本时按 ENTER 键时插入回车符。 如果未指定此样式, 则按 ENTER 键会将命令发送到 rich edit 控件的父窗口, 这会模拟单击父窗口的默认按钮 (例如, 对话框中的 "确定" 按钮)。 此样式对单行编辑控件没有影响。

- 当控件失去焦点时, ECO_SAVESEL 将保留选定内容。 默认情况下, 当控件重新获得焦点时, 将选择该控件的全部内容。

- ECO_VERTICAL 以垂直方向绘制文本和对象。 仅适用于亚洲语言。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

##  <a name="setparaformat"></a>CRichEditCtrl:: SetParaFormat

为此`CRichEditCtrl`对象中的当前选定内容设置段落格式特性。

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>参数

*pf*<br/>
在第一个版本中, 指向[PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-paraformat)结构的指针, 该结构包含新的默认段落格式特性。

在第二个版本中, 是指向[PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2)结构的指针, 该结构是对`PARAFORMAT`结构的丰富编辑2.0 扩展, 它包含默认的字符格式设置特性。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数只更改由`dwMask` *pf*的成员指定的属性。

有关详细信息, 请参阅[EM_SETPARAFORMAT](/windows/desktop/Controls/em-setparaformat)消息和`PARAFORMAT` Windows SDK 中`PARAFORMAT2`的和结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

##  <a name="setpunctuation"></a>CRichEditCtrl:: SetPunctuation

设置丰富编辑控件中的标点。

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>参数

*fType*<br/>
标点标志。 有关可能值的列表, 请参阅 Windows SDK 中[EM_SETPUNCTUATION](/windows/desktop/Controls/em-setpunctuation)的*fType*参数。

*lpPunc*<br/>
指向[标点符号](/windows/desktop/api/richedit/ns-richedit-punctuation)结构的指针, 如 Windows SDK 中所述。

### <a name="return-value"></a>返回值

如果成功, 则为非零; 否则为0。

### <a name="remarks"></a>备注

此成员函数仅适用于亚洲语言版本的操作系统。

##  <a name="setreadonly"></a>CRichEditCtrl:: SetReadOnly

更改此`CRichEditCtrl`对象的 ECO_READONLY 选项。

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>参数

*bReadOnly*<br/>
指示此`CRichEditCtrl`对象是否应为只读。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

有关此选项的简要说明, 请参阅[SetOptions](#setoptions)。 您可以使用此函数设置此`CRichEditCtrl`对象的所有选项。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETREADONLY](/windows/desktop/Controls/em-setreadonly) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

##  <a name="setrect"></a>CRichEditCtrl:: SetRect

为此`CRichEditCtrl`对象设置格式矩形。

```
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>参数

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指向[矩形](/windows/desktop/api/windef/ns-windef-tagrect)的指针, 该矩形指示格式设置矩形的新边界。

### <a name="remarks"></a>备注

格式设置矩形是文本的限制矩形。 限制矩形与富编辑控件窗口的大小无关。 首次`CRichEditCtrl`创建此对象时, 格式设置矩形的大小与窗口的工作区相同。 用于`SetRect`使格式设置矩形大于或小于富编辑窗口。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETRECT](/windows/desktop/Controls/em-setrect) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

##  <a name="setsel"></a>CRichEditCtrl:: SetSel

设置此`CRichEditCtrl`对象内的选择。

```
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>参数

*nStartChar*<br/>
所选内容的第一个字符的从零开始的索引。

*nEndChar*<br/>
选择的最后一个字符的从零开始的索引。

*cr*<br/>
[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-charrange)结构, 用于保存当前所选内容的边界。

### <a name="remarks"></a>备注

此函数的两种形式提供了用于设置所选内容边界的替代方法。 这些形式的简要说明如下所示:

- **SetSel (** `cr` **) 此**窗体将`cpMin` `cpMax`结构与其和成员一起使用来设置界限。 `CHARRANGE`

- **SetSel (** `nStartChar` **,** ) 此窗体使用参数 nStartChar 和 nEndChar 设置界限。 `nEndChar`

插入符号位于所选内容的末尾, 由 start`cpMin` (或*nStartChar*) 和结束 (`cpMax`或*nEndChar*) 索引的较大者指示。 此函数将滚动的`CRichEditCtrl`内容, 以便显示插入符号。

若要选择此`CRichEditCtrl`对象中的所有文本, 请调用`SetSel`开头索引为0、结束索引为-1 的。

有关详细信息, 请参阅 Windows SDK 中的[EM_EXSETSEL](/windows/desktop/Controls/em-exsetsel)消息和[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-charrange)结构。

### <a name="example"></a>示例

  请参阅[GetSel](#getsel)的示例。

##  <a name="setselectioncharformat"></a>CRichEditCtrl:: SetSelectionCharFormat

设置此`CRichEditCtrl`对象中当前选定内容的文本的字符格式设置特性。

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中, 是指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构的指针, 该结构包含当前选定内容的新字符格式特性。

在第二个版本中, 指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构的指针, 该结构是`CHARFORMAT`结构的丰富编辑2.0 扩展, 其中包含当前选定内容的新字符格式特性。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数只更改`dwMask` *cf*成员指定的属性。

有关详细信息, 请参阅 Windows SDK 中的`CHARFORMAT` [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat) `CHARFORMAT2`和和结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

##  <a name="settargetdevice"></a>CRichEditCtrl:: SetTargetDevice

设置此`CRichEditCtrl`对象中用于 WYSIWYG (所见即所得) 格式的目标设备和线条宽度。

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>参数

*hDC*<br/>
新目标设备的设备上下文的句柄。

*lLineWidth*<br/>
用于设置格式的线条宽度。

*dc*<br/>
新目标设备的[CDC](../../mfc/reference/cdc-class.md) 。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

如果此函数成功, 则富编辑控件拥有作为参数传递的设备上下文。 在这种情况下, 调用函数不应销毁设备上下文。

有关详细信息, 请参阅 Windows SDK 中的[EM_SETTARGETDEVICE](/windows/desktop/Controls/em-settargetdevice) 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

##  <a name="settextmode"></a>CRichEditCtrl:: SetTextMode

为 rich edit 控件设置文本模式或撤消和重做级别。

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>参数

*fMode*<br/>
为控件的文本模式和撤消级别参数指定新设置。 有关可能值的列表, 请参阅 Windows SDK 中[EM_SETTEXTMODE](/windows/desktop/Controls/em-settextmode)的 mode 参数。

### <a name="return-value"></a>返回值

如果成功, 则为零; 否则为非零值。

### <a name="remarks"></a>备注

有关文本模式的说明, 请参阅 Windows SDK 中的 EM_SETTEXTMODE。

如果控件包含文本, 此成员函数将失败。 若要确保控件为空, 请发送包含空字符串的[WM_SETTEXT](/windows/desktop/winmsg/wm-settext)消息。

##  <a name="setundolimit"></a>CRichEditCtrl:: SetUndoLimit

设置可存储在撤消队列中的操作的最大数量。

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>参数

*nLimit*<br/>
指定可存储在撤消队列中的操作的最大数量。 设置为0可禁用撤消。

### <a name="return-value"></a>返回值

Rich edit 控件的新的最大撤消操作数。

### <a name="remarks"></a>备注

默认情况下, 撤消队列中的最大操作数量为100。 如果增加此数目, 则必须有足够的可用内存来容纳新的数字。 为了获得更好的性能, 请将限制设置为可能的最小值。

##  <a name="setwordcharformat"></a>CRichEditCtrl:: SetWordCharFormat

为此`CRichEditCtrl`对象中当前选定的单词设置字符格式特性。

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中, 指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构的指针, 该结构包含当前选定的单词的新字符格式设置特性。

在第二个版本中, 是指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构的指针, 该结构是对`CHARFORMAT`结构的丰富编辑2.0 扩展, 其中包含当前选定的单词的新字符格式设置特性。

### <a name="return-value"></a>返回值

如果成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

此函数只更改`dwMask` *cf*成员指定的属性。

有关详细信息, 请参阅[EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)消息和`CHARFORMAT` Windows SDK 中`CHARFORMAT2`的和结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

##  <a name="setwordwrapmode"></a>CRichEditCtrl:: SetWordWrapMode

为 rich edit 控件设置换行和换行选项。

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>参数

*uFlags*<br/>
要设置为自动换行和断字的选项。 有关可能选项的列表, 请参阅 Windows SDK 中的[EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) 。

### <a name="return-value"></a>返回值

当前的自动换行和断字选项。

### <a name="remarks"></a>备注

此消息仅适用于亚洲语言版本的操作系统。

##  <a name="stopgrouptyping"></a>CRichEditCtrl:: StopGroupTyping

阻止控件将其他键入操作收集到当前的撤消操作中。

```
void StopGroupTyping();
```

### <a name="remarks"></a>备注

控件将下一个键入操作 (如果有) 存储在撤消队列中的新操作中。

有关详细信息, 请参阅 Windows SDK 中的[EM_STOPGROUPTYPING](/windows/desktop/Controls/em-stopgrouptyping) 。

##  <a name="streamin"></a>CRichEditCtrl:: StreamIn

将此`CRichEditCtrl`对象中的文本替换为指定输入流中的文本。

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>参数

*nFormat*<br/>
指定输入数据格式的标志。 有关详细信息，请参阅备注部分。

*es*<br/>
指定输入流的[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-editstream)结构。 有关详细信息，请参阅备注部分。

### <a name="return-value"></a>返回值

从输入流中读取的字符数。

### <a name="remarks"></a>备注

*NFormat*的值必须是下列值之一:

- SF_TEXT 指示仅读取文本。

- SF_RTF 指示读取文本和格式。

这些值中的任何一个可与 SFF_SELECTION 组合。 如果指定了 SFF_SELECTION, `StreamIn`则会将当前所选内容替换为输入流的内容。 如果未指定, `StreamIn`则替换此`CRichEditCtrl`对象的全部内容。

在参数 es 中, 指定用文本填充缓冲区的回调函数。 `EDITSTREAM` 此回调函数将重复调用, 直到输入流用尽。

有关详细信息, 请参阅 Windows SDK 中的[EM_STREAMIN](/windows/desktop/Controls/em-streamin)消息和[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-editstream)结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

##  <a name="streamout"></a>CRichEditCtrl:: StreamOut

将此`CRichEditCtrl`对象的内容写出到指定的输出流。

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>参数

*nFormat*<br/>
指定输出数据格式的标志。 有关详细信息，请参阅备注部分。

*es*<br/>
指定输出流的[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-editstream)结构。 有关详细信息，请参阅备注部分。

### <a name="return-value"></a>返回值

写入到输出流的字符数。

### <a name="remarks"></a>备注

*NFormat*的值必须是下列值之一:

- SF_TEXT 指示仅写入文本。

- SF_RTF 指示写入文本和格式。

- SF_RTFNOOBJS 指示写入文本和格式, 并将 OLE 项替换为空格。

- SF_TEXTIZED 指示写入文本和格式, 其中包含 OLE 项的文本表示形式。

这些值中的任何一个可与 SFF_SELECTION 组合。 如果指定了 SFF_SELECTION, `StreamOut`则将当前所选内容写出到输出流中。 如果未指定, `StreamOut`则写出此`CRichEditCtrl`对象的全部内容。

在参数 es 中, 指定用文本填充缓冲区的回调函数。 `EDITSTREAM` 此回调函数将重复调用, 直到输出流用尽。

有关详细信息, 请参阅 Windows SDK 中的[EM_STREAMOUT](/windows/desktop/Controls/em-streamout)消息和[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-editstream)结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

##  <a name="undo"></a>CRichEditCtrl:: Undo

撤消 rich edit 控件中的最后一个操作。

```
BOOL Undo();
```

### <a name="return-value"></a>返回值

如果撤消操作成功, 则为非零值;否则为0。

### <a name="remarks"></a>备注

撤消操作还可以撤消。 例如, 你可以在首次调用`Undo`时还原已删除的文本。 只要没有干预编辑操作, 就可以使用第二次调用`Undo`删除文本。

有关详细信息, 请参阅 Windows SDK 中的[EM_UNDO](/windows/desktop/Controls/em-undo) 。

### <a name="example"></a>示例

  请参阅[CanUndo](#canundo)的示例。

## <a name="see-also"></a>请参阅

[MFC 示例写字板](../../overview/visual-cpp-samples.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[CEdit 类](../../mfc/reference/cedit-class.md)<br/>
[CRichEditView 类](../../mfc/reference/cricheditview-class.md)
