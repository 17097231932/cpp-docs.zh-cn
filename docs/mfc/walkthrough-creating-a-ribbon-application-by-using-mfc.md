---
title: 演练：使用 MFC 创建功能区应用程序
ms.date: 04/25/2019
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: a45df5258a16885b50e11d4cca8ba99eb4b3d458
ms.sourcegitcommit: 283cb64fd7958a6b7fbf0cd8534de99ac8d408eb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "64558225"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>演练：使用 MFC 创建功能区应用程序

本演练演示如何使用**MFC 应用程序向导**创建默认情况下具有功能区的应用程序。 然后可以通过添加扩展功能区**自定义**具有的功能区类别**收藏夹**功能区面板中，并添加一些经常使用的面板的命令。

## <a name="prerequisites"></a>系统必备

本演练假定您已设置了 Visual Studio 以使用**常规开发设置**。 如果你使用不同的设置，在下面的说明中引用的用户界面 (UI) 元素的一些可能不显示。

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>创建带功能区的 MFC 应用程序

1. 使用**MFC 应用程序向导**创建具有功能区的 MFC 应用程序。 请参阅[演练：使用新的 MFC Shell 控件](walkthrough-using-the-new-mfc-shell-controls.md)有关如何打开你的 Visual Studio 版本的向导的说明。

1. 在中设置以下选项**MFC 应用程序向导**:

    1. 在中**应用程序类型**部分中，在**视觉样式和颜色**，选择**Office 2007 （蓝色主题）**。

    1. 在中**复合文档支持**部分中，请确保**None**处于选中状态。

    1. 在中**文档模板属性**部分中，在**文件扩展名**框中，键入文件扩展名的文档，此应用程序创建，例如， *mfcrbnapp*.

    1. 在中**数据库支持**部分 (仅 Visual Studio 2015)，请确保**None**处于选中状态。

    1. 在中**用户界面功能**部分中，请确保**使用功能区**处于选中状态。

    1. 默认情况下**MFC 应用程序向导**添加了对多个停靠窗格支持。 由于本演练仅介绍功能区，因此您可以从应用程序中删除这些选项。 在中**高级功能**部分中，清除所有选项。

1. 单击**完成**创建 MFC 应用程序。

1. 若要验证应用程序是否已成功创建，请生成并运行它。 若要在生成应用程序，**构建**菜单上，单击**生成解决方案**。 如果成功生成了应用程序，运行通过单击**开始调试**上**调试**菜单。

    向导会自动创建一个功能区，具有一个名为的功能区类别**主页**。 此功能区包含三个功能区面板，分别名为**剪贴板**，**视图**，并**窗口**。

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>将类别和面板添加到功能区

1. 若要打开该向导创建，在功能区资源**视图**菜单，依次指向**其他 Windows** ，然后单击**资源视图**。 在中**资源视图**，单击**功能区**，然后双击**IDR_RIBBON**。

1. 首先，向功能区添加自定义类别，通过双击**类别**中**工具箱**。

    标题的类别**Category1**创建。 默认情况下，该类别包含一个面板。

    右键单击**Category1** ，然后单击**属性**。 在中**属性**窗口中，更改**标题**到*自定义*。

    **Large Images**并**较小的图像**属性指定此类别中的功能区元素用作图标的位图。 由于创建自定义位图超出了本演练的范围，请重新使用该向导创建的位图。 小型位图为 16 x 16 像素。 对于小型图像，请使用由访问的位图`IDB_FILESMALL`资源 id。 大型位图为 32 x 32 像素。 对于大型图像，请使用由访问的位图`IDB_FILELARGE`资源 id。

    > [!NOTE]
    > 在每英寸像素数 (HDPI) 显示中，将自动使用图像的 HDPI 版本。

1. 接下来，自定义面板。 面板用于对逻辑上相关的项进行分组。 例如，在**主页**此应用程序的选项卡**剪切**，**复制**，以及**粘贴**命令都位于**剪贴板**面板。 若要自定义面板，右键单击**Panel1** ，然后单击**属性**。 在中**属性**窗口中，更改**标题**到*收藏夹*。

    您可以指定**图像索引**面板。 此数值用于指定如果功能区面板添加到显示的图标**快速访问工具栏**。 图标未显示在功能区面板。

1. 若要验证功能区类别和面板是否已成功创建，请预览此功能区控件。 上**功能区编辑器工具栏**，单击**测试功能区**按钮。 一个**自定义**选项卡和**收藏夹**面板应显示在功能区上。

### <a name="to-add-elements-to-the-ribbon-panels"></a>将元素添加到功能区面板

1. 若要将元素添加到上一个过程中创建的面板中，将控件从**功能区编辑器**一部分**工具箱**到设计视图中的面板。

1. 首先，添加**打印**按钮。 **打印**按钮都将具有包含子菜单**快速打印**命令将使用默认打印机的打印。 已为此应用程序定义所有这些命令。 它们位于应用程序菜单上。

    若要创建**打印**按钮，将 Button 工具拖动到面板。

    在中**属性**窗口中，更改**ID**属性设置为**ID_FILE_PRINT**，应已定义的。 更改**标题**到*打印*。 更改**图像索引**到*4*。

    若要创建**快速打印**菜单上，单击属性值列旁边**菜单项**，然后单击省略号 (**...**).在中**项编辑器**，单击未标记**添加**按钮以创建菜单项。 在中**属性**窗口中，更改**标题**到*快速打印*， **ID**到*ID_FILE_PRINT_DIRECT*，并**图像**到*5*。 图像属性指定**快速打印**中的图标`IDB_FILESMALL`位图资源。

1. 若要验证是否已将这些按钮添加到功能区面板，请生成并运行应用程序。 若要在生成应用程序，**构建**菜单上，单击**生成解决方案**。 如果成功生成了应用程序，通过单击运行该应用程序**开始调试**上**调试**菜单。 **打印**按钮和组合框上**收藏夹**面板上**自定义**应显示在功能区上的选项卡。

## <a name="next-steps"></a>后续步骤

[如何：自定义快速访问工具栏](../mfc/how-to-customize-the-quick-access-toolbar.md)

[如何：自定义应用程序按钮](../mfc/how-to-customize-the-application-button.md)

有关端到端示例，请参阅[示例 （MFC 功能包）](../overview/visual-cpp-samples.md)。

## <a name="see-also"></a>请参阅

[演练](../mfc/walkthroughs-mfc.md)<br/>
[示例 （MFC 功能包）](../overview/visual-cpp-samples.md)
