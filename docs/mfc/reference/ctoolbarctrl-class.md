---
title: CToolBarCtrl 类
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 6f15280943fce39bae4eebfb537f9a61d256d2e8
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78856412"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl 类

提供 Windows 工具栏公共控件的功能。

## <a name="syntax"></a>语法

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CToolBarCtrl：： CToolBarCtrl](#ctoolbarctrl)|构造 `CToolBarCtrl` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CToolBarCtrl：： AddBitmap](#addbitmap)|将一个或多个位图按钮图像添加到工具栏控件可用的按钮图像列表中。|
|[CToolBarCtrl：： AddButtons](#addbuttons)|将一个或多个按钮添加到工具栏控件。|
|[CToolBarCtrl：： AddString](#addstring)|将传递为资源 ID 的新字符串添加到工具栏的字符串内部列表中。|
|[CToolBarCtrl：： AddStrings](#addstrings)|将一个新字符串或字符串作为指向以 null 分隔字符串的缓冲区的指针传递到工具栏的内部字符串列表。|
|[CToolBarCtrl：： AutoSize](#autosize)|调整工具栏控件的大小。|
|[CToolBarCtrl：： ChangeBitmap](#changebitmap)|更改当前工具栏控件中的按钮的位图。|
|[CToolBarCtrl：： CheckButton](#checkbutton)|在工具栏控件中检查或清除给定按钮。|
|[CToolBarCtrl：： CommandToIndex](#commandtoindex)|检索与指定的命令标识符相关联的按钮的从零开始的索引。|
|[CToolBarCtrl：： Create](#create)|创建工具栏控件，并将其附加到 `CToolBarCtrl` 对象上。|
|[CToolBarCtrl：： CreateEx](#createex)|创建具有指定 Windows 扩展样式的工具栏控件，并将其附加到 `CToolBarCtrl` 的对象。|
|[CToolBarCtrl：：自定义](#customize)|显示 "自定义工具栏" 对话框。|
|[CToolBarCtrl：:D eleteButton](#deletebutton)|删除工具栏控件中的按钮。|
|[CToolBarCtrl：： EnableButton](#enablebutton)|启用或禁用工具栏控件中的指定按钮。|
|[CToolBarCtrl：： GetAnchorHighlight](#getanchorhighlight)|检索工具栏的定位点突出显示设置。|
|[CToolBarCtrl：： GetBitmap](#getbitmap)|检索与工具栏中的按钮关联的位图的索引。|
|[CToolBarCtrl：： GetBitmapFlags](#getbitmapflags)|获取与工具栏的位图关联的标志。|
|[CToolBarCtrl：： GetButton](#getbutton)|在工具栏控件中检索有关指定按钮的信息。|
|[CToolBarCtrl：： GetButtonCount](#getbuttoncount)|检索当前在工具栏控件中的按钮的计数。|
|[CToolBarCtrl：： GetButtonInfo](#getbuttoninfo)|检索工具栏中某个按钮的信息。|
|[CToolBarCtrl：： GetButtonSize](#getbuttonsize)|检索工具栏按钮当前的宽度和高度（以像素为单位）。|
|[CToolBarCtrl：： GetColorScheme](#getcolorscheme)|检索当前 toolbar 控件的配色方案。|
|[CToolBarCtrl：： GetDisabledImageList](#getdisabledimagelist)|检索工具栏控件用来显示禁用的按钮的图像列表。|
|[CToolBarCtrl：： GetDropTarget](#getdroptarget)|检索 toolbar 控件的[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)接口。|
|[CToolBarCtrl：： GetExtendedStyle](#getextendedstyle)|检索 toolbar 控件的扩展样式。|
|[CToolBarCtrl：： GetHotImageList](#gethotimagelist)|检索工具栏控件用来显示 "热" 按钮的图像列表。 当鼠标指针位于其上方时，热按钮将突出显示。|
|[CToolBarCtrl：： GetHotItem](#gethotitem)|检索工具栏中热项的索引。|
|[CToolBarCtrl：： GetImageList](#getimagelist)|检索工具栏控件用来显示处于默认状态的按钮的图像列表。|
|[CToolBarCtrl：： GetInsertMark](#getinsertmark)|检索工具栏的当前插入标记。|
|[CToolBarCtrl：： GetInsertMarkColor](#getinsertmarkcolor)|检索用于绘制工具栏插入标记的颜色。|
|[CToolBarCtrl：： GetItemRect](#getitemrect)|在工具栏控件中检索按钮的边框。|
|[CToolBarCtrl：： GetMaxSize](#getmaxsize)|检索工具栏中所有可见按钮和分隔符的总大小。|
|[CToolBarCtrl：： GetMaxTextRows](#getmaxtextrows)|检索工具栏按钮上显示的最大文本行数。|
|[CToolBarCtrl：： GetMetrics](#getmetrics)|检索 toolbar 控件的指标。|
|[CToolBarCtrl：： GetPadding](#getpadding)|检索当前 toolbar 控件的水平和垂直填充。|
|[CToolBarCtrl：： GetPressedImageList](#getpressedimagelist)|检索当前工具栏控件用来表示处于按下状态的按钮的图像列表。|
|[CToolBarCtrl：： GetRect](#getrect)|检索指定工具栏按钮的边框。|
|[CToolBarCtrl：： GetRows](#getrows)|检索工具栏中当前显示的按钮的行数。|
|[CToolBarCtrl：： GetState](#getstate)|在工具栏控件中检索有关指定按钮的状态的信息，例如是否启用、按下或选中该按钮。|
|[CToolBarCtrl：： GetString](#getstring)|检索工具栏字符串。|
|[CToolBarCtrl：： GetStyle](#getstyle)|检索当前用于 toolbar 控件的样式。|
|[CToolBarCtrl：： GetToolTips](#gettooltips)|检索与 toolbar 控件关联的工具提示控件（如果有）的句柄。|
|[CToolBarCtrl：： HideButton](#hidebutton)|在工具栏控件中隐藏或显示指定的按钮。|
|[CToolBarCtrl：： System.windows.media.visualtreehelper.hittest](#hittest)|确定点在工具栏控件中的位置。|
|[CToolBarCtrl：：不确定](#indeterminate)|设置或清除工具栏控件中指定按钮的不确定（灰色）状态。|
|[CToolBarCtrl：： InsertButton](#insertbutton)|在工具栏控件中插入按钮。|
|[CToolBarCtrl：： InsertMarkHitTest](#insertmarkhittest)|检索工具栏中某个点的插入标记信息。|
|[CToolBarCtrl：： IsButtonChecked](#isbuttonchecked)|指示是否选中了工具栏控件中的指定按钮。|
|[CToolBarCtrl：： IsButtonEnabled](#isbuttonenabled)|指示是否启用工具栏控件中的指定按钮。|
|[CToolBarCtrl：： IsButtonHidden](#isbuttonhidden)|指示工具栏控件中的指定按钮是否处于隐藏状态。|
|[CToolBarCtrl：： IsButtonHighlighted](#isbuttonhighlighted)|检查工具栏按钮的突出显示状态。|
|[CToolBarCtrl：： IsButtonIndeterminate](#isbuttonindeterminate)|指示工具栏控件中指定按钮的状态是否为 "不确定" （灰色）。|
|[CToolBarCtrl：： IsButtonPressed](#isbuttonpressed)|指示是否按下了工具栏控件中的指定按钮。|
|[CToolBarCtrl：： LoadImages](#loadimages)|将位图加载到工具栏控件的图像列表中。|
|[CToolBarCtrl：： MapAccelerator](#mapaccelerator)|将快捷键映射到工具栏按钮。|
|[CToolBarCtrl：： MarkButton](#markbutton)|设置工具栏控件中给定按钮的突出显示状态。|
|[CToolBarCtrl：： MoveButton](#movebutton)|将按钮从一个索引移动到另一个索引。|
|[CToolBarCtrl：:P ressButton](#pressbutton)|按下或释放工具栏控件中的指定按钮。|
|[CToolBarCtrl：： ReplaceBitmap](#replacebitmap)|将当前工具栏控件中的现有位图替换为新位图。|
|[CToolBarCtrl：： RestoreState](#restorestate)|还原 toolbar 控件的状态。|
|[CToolBarCtrl：： SaveState](#savestate)|保存 toolbar 控件的状态。|
|[CToolBarCtrl：： SetAnchorHighlight](#setanchorhighlight)|设置工具栏的定位点突出显示设置。|
|[CToolBarCtrl：： SetBitmapSize](#setbitmapsize)|设置要添加到工具栏控件的位图图像的大小。|
|[CToolBarCtrl：： SetButtonInfo](#setbuttoninfo)|设置工具栏中现有按钮的信息。|
|[CToolBarCtrl：： SetButtonSize](#setbuttonsize)|设置要添加到工具栏控件中的按钮的大小。|
|[CToolBarCtrl：： SetButtonStructSize](#setbuttonstructsize)|指定 `TBBUTTON` 结构的大小。|
|[CToolBarCtrl：： SetButtonWidth](#setbuttonwidth)|设置工具栏控件中的最小值和最大值按钮宽度。|
|[CToolBarCtrl：： SetCmdID](#setcmdid)|设置按下指定按钮时要发送给所有者窗口的命令标识符。|
|[CToolBarCtrl：： SetColorScheme](#setcolorscheme)|设置当前 toolbar 控件的配色方案。|
|[CToolBarCtrl：： SetDisabledImageList](#setdisabledimagelist)|设置工具栏控件将用于显示禁用的按钮的图像列表。|
|[CToolBarCtrl：： SetDrawTextFlags](#setdrawtextflags)|设置 Win32 函数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中的标志，该函数用于在指定的矩形中绘制文本，根据标志的设置方式进行设置。|
|[CToolBarCtrl：： SetExtendedStyle](#setextendedstyle)|设置工具栏控件的扩展样式。|
|[CToolBarCtrl：： SetHotImageList](#sethotimagelist)|设置工具栏控件将用于显示 "热" 按钮的图像列表。|
|[CToolBarCtrl：： SetHotItem](#sethotitem)|在工具栏中设置热项。|
|[CToolBarCtrl：： SetImageList](#setimagelist)|设置工具栏将用于显示处于默认状态的按钮的图像列表。|
|[CToolBarCtrl：： SetIndent](#setindent)|设置工具栏控件中第一个按钮的缩进。|
|[CToolBarCtrl：： SetInsertMark](#setinsertmark)|为工具栏设置当前插入标记。|
|[CToolBarCtrl：： SetInsertMarkColor](#setinsertmarkcolor)|设置用于绘制工具栏插入标记的颜色。|
|[CToolBarCtrl：： SetMaxTextRows](#setmaxtextrows)|设置工具栏按钮上显示的最大文本行数。|
|[CToolBarCtrl：： SetMetrics](#setmetrics)|设置工具栏控件的度量值。|
|[CToolBarCtrl：： SetOwner](#setowner)|设置窗口以接收来自 toolbar 控件的通知消息。|
|[CToolBarCtrl：： SetPadding](#setpadding)|设置当前 toolbar 控件的水平和垂直填充。|
|[CToolBarCtrl：： SetPressedImageList](#setpressedimagelist)|设置当前工具栏控件用来表示处于按下状态的按钮的图像列表。|
|[CToolBarCtrl：： SetRows](#setrows)|设置显示在工具栏中的按钮的行数。|
|[CToolBarCtrl：： SetState](#setstate)|在工具栏控件中设置指定按钮的状态。|
|[CToolBarCtrl：： System.windows.forms.control.setstyle](#setstyle)|设置工具栏控件的样式。|
|[CToolBarCtrl：： SetToolTips](#settooltips)|将工具提示控件与 toolbar 控件相关联。|
|[CToolBarCtrl：： SetWindowTheme](#setwindowtheme)|设置工具栏控件的视觉样式。|

## <a name="remarks"></a>备注

此控件（因此 `CToolBarCtrl` 类）仅适用于在 Windows 95/98 和 Windows NT 版本3.51 及更高版本下运行的程序。

Windows 工具栏公用控件是一个矩形子窗口，其中包含一个或多个按钮。 这些按钮可以显示位图图像和/或字符串。 当用户选择某个按钮时，它会将一个命令消息发送到工具栏的所有者窗口。 通常，工具栏中的按钮对应于应用程序菜单中的项;它们为用户提供了一种更直接的方式来访问应用程序的命令。

`CToolBarCtrl` 对象包含若干重要的内部数据结构：按钮图像位图的列表、图像列表、按钮标签字符串列表和 `TBBUTTON` 结构的列表，这些结构将图像和/或字符串与按钮的位置、样式、状态和命令 ID 相关联。 这些数据结构的每个元素均由从零开始的索引引用。 在可以使用 `CToolBarCtrl` 对象之前，必须设置这些数据结构。 字符串列表只能用于按钮标签;不能从工具栏检索字符串。

为了使用 `CToolBarCtrl` 对象，您通常将执行下列步骤：

1. 构造 `CToolBarCtrl` 对象。

1. 调用[create](#create)创建 Windows 工具栏公共控件并将其附加到 `CToolBarCtrl` 对象。 使用样式指示工具栏样式，如 TBSTYLE_TRANSPARENT 用于透明工具栏或支持下拉样式按钮的工具栏 TBSTYLE_DROPDOWN。

1. 确定工具栏上的按钮显示方式：

   - 若要对按钮使用位图图像，请通过调用[AddBitmap](#addbitmap)将按钮位图添加到工具栏中。

   - 若要使用按钮的图像列表中显示的图像，请通过调用[SetImageList](#setimagelist)、 [SetHotImageList](#sethotimagelist)或[SetDisabledImageList](#setdisabledimagelist)来指定图像列表。

   - 若要使用按钮的字符串标签，请通过调用[AddString](#addstring)和/或[AddStrings](#addstrings)将字符串添加到工具栏中。

1. 通过调用[AddButtons](#addbuttons)向工具栏添加按钮结构。

1. 如果在不是 `CFrameWnd`的所有者窗口中需要工具栏按钮的工具提示，则需要按照[处理工具提示通知](../../mfc/handling-tool-tip-notifications.md)中所述，在工具栏的所有者窗口中处理 TTN_NEEDTEXT 消息。 如果工具栏的父窗口派生自 `CFrameWnd`，则将显示工具提示，无需任何额外的工作，因为 `CFrameWnd` 提供默认处理程序。

1. 如果希望用户能够自定义工具栏，请在所有者窗口中处理自定义通知消息，如[处理自定义通知](../../mfc/handling-customization-notifications.md)中所述。

可以使用[SaveState](#savestate)将工具栏控件的当前状态保存在注册表中，并使用[RestoreState](#restorestate)来基于之前存储在注册表中的信息还原状态。 除了在应用程序的使用之间保存工具栏状态之外，应用程序通常会在用户开始自定义工具栏之前存储状态，以防用户以后要将工具栏还原到其原始状态。

## <a name="support-for-internet-explorer-version-40-and-later"></a>支持 Internet Explorer 版本4.0 及更高版本

为了支持 Internet Explorer 版本4.0 及更高版本中引入的功能，MFC 为 toolbar 控件提供了图像列表支持和透明和平面样式。

透明工具栏允许工具栏下的客户端通过显示。 若要创建透明工具栏，请同时使用 TBSTYLE_FLAT 和 TBSTYLE_TRANSPARENT 样式。 透明工具栏功能热跟踪;也就是说，当鼠标指针移到工具栏上的热按钮上时，按钮的外观会发生变化。 仅用 TBSTYLE_FLAT 样式创建的工具栏将包含不透明的按钮。

图像列表支持使控件对默认行为、热映像和已禁用图像的灵活性更高。 将[GetImageList](#getimagelist)、 [GetHotImageList](#gethotimagelist)和[GetDisabledImageList](#getdisabledimagelist)与透明工具栏结合使用，以根据图像的状态操作图像：

有关使用 `CToolBarCtrl`的详细信息，请参阅[控件](../../mfc/controls-mfc.md)和[使用 CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>要求

**标头：** afxcmn.h

##  <a name="addbitmap"></a>CToolBarCtrl：： AddBitmap

将一个或多个按钮图像添加到工具栏控件中存储的按钮图像的列表。

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>参数

*nNumButtons*<br/>
位图中按钮图像的数目。

*nBitmapID*<br/>
包含要添加的按钮图像的位图的资源标识符。

*pBitmap*<br/>
指向包含要添加的按钮图像的 `CBitmap` 对象的指针。

### <a name="return-value"></a>返回值

如果成功，则为第一个新图像的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

在将位图添加到工具栏之前，可以使用 Windows API [CreateMappedBitmap](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap)映射颜色。 如果将指针传递到 `CBitMap` 对象，则必须确保在销毁工具栏之前不会销毁位图。

##  <a name="addbuttons"></a>CToolBarCtrl：： AddButtons

将一个或多个按钮添加到工具栏控件。

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>参数

*nNumButtons*<br/>
要添加的按钮数。

*lpButtons*<br/>
包含要添加的按钮信息的 `TBBUTTON` 结构数组的地址。 数组中必须有与*nNumButtons*所指定的按钮相同数量的元素。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

*LpButtons*指针指向 `TBBUTTON` 结构的数组。 每个 `TBBUTTON` 结构将添加的按钮与按钮的样式、图像和/或字符串、命令 ID、状态和用户定义的数据相关联：

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

成员如下：

- `iBitmap`

   按钮图像的从零开始的索引，如果此按钮没有图像，则为-1。

- `idCommand`

   与按钮关联的命令标识符。 选择该按钮时，将在 WM_COMMAND 消息中发送此标识符。 如果 `fsStyle` 成员具有 TBSTYLE_SEP 值，则此成员必须为零。

- `fsState`

   按钮状态标志。 它可以是下列值的组合：

   - TBSTATE_CHECKED 按钮具有 TBSTYLE_CHECKED 样式，并且正在按下。

   - TBSTATE_ENABLED "按钮接受用户输入。 不具有此状态的按钮不接受用户输入并且灰显。

   - TBSTATE_HIDDEN 该按钮不可见，无法接收用户输入。

   - TBSTATE_INDETERMINATE 按钮灰显。

   - 正在按下按钮 TBSTATE_PRESSED。

   - TBSTATE_WRAP 按钮后跟一个换行符。 按钮还必须具有 TBSTATE_ENABLED 状态。

- `fsStyle`

   按钮样式。 它可以是下列值的组合：

   - TBSTYLE_BUTTON 创建标准的 "推送" 按钮。

   - TBSTYLE_CHECK 创建一个按钮，该按钮在每次用户单击时切换处于按下状态和 unpressed 状态。 此按钮处于按下状态时具有不同的背景色。

   - TBSTYLE_CHECKGROUP 创建一个保持按下状态的复选按钮，直至按下组中的另一个按钮。

   - TBSTYLE_GROUP 创建一个始终按下的按钮，直到按下组中的另一个按钮。

   - TBSTYLE_SEP 创建一个分隔符，在按钮组之间提供较小的间隔。 具有此样式的按钮不会接收用户输入。

- `dwData`

   用户定义的数据。

- `iString`

   要用作按钮标签的字符串的从零开始的索引，如果此按钮没有字符串，则为-1。

您提供的索引必须已使用[AddBitmap](#addbitmap)、 [AddString](#addstring)和/或[AddStrings](#addstrings)添加到 toolbar 控件列表中的图像和/或字符串。

##  <a name="addstring"></a>CToolBarCtrl：： AddString

将传递为资源 ID 的新字符串添加到工具栏的字符串内部列表中。

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>参数

*nStringID*<br/>
要添加到工具栏控件的字符串列表的字符串资源的资源标识符。

### <a name="return-value"></a>返回值

如果成功，则为添加的第一个新字符串的从零开始的索引;否则为-1。

##  <a name="addstrings"></a>CToolBarCtrl：： AddStrings

将新字符串或字符串添加到工具栏控件可用的字符串列表。

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>参数

*lpszStrings*<br/>
包含一个或多个要添加到工具栏的字符串列表的以 null 结尾的字符串的缓冲区的地址。 最后一个字符串必须以两个 null 字符结尾。

### <a name="return-value"></a>返回值

如果成功，则为添加的第一个新字符串的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

必须用空字符分隔缓冲区中的字符串。 必须确保最后一个字符串具有两个 null 终止符。 若要正确设置常量字符串的格式，你可以将其编写为：

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

或者：

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

不应将 `CString` 对象传递到此函数，因为在 `CString`中不能有多个 null 字符。

##  <a name="autosize"></a>CToolBarCtrl：： AutoSize

调整整个工具栏控件的大小。

```
void AutoSize();
```

### <a name="remarks"></a>备注

当父窗口的大小发生更改或工具栏大小发生更改时（例如，当您设置按钮、位图大小或添加字符串时），应调用此函数。

##  <a name="changebitmap"></a>CToolBarCtrl：： ChangeBitmap

更改当前工具栏控件中的按钮的位图。

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*idButton*|中要接收新位图的按钮的命令标识符。|
|*iBitmap*|中当前工具栏控件的图像列表中的图像的从零开始的索引。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果此方法成功，系统将在指定的按钮中显示指定的图像。

此方法发送 Windows SDK 中描述的[TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap)消息。

### <a name="example"></a>示例

下面的代码示例将**文件保存**按钮的位图更改为 "**关于**" 按钮的位图。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

##  <a name="checkbutton"></a>CToolBarCtrl：： CheckButton

在工具栏控件中检查或清除给定按钮。

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
要检查或清除的按钮的命令标识符。

*bCheck*<br/>
若要选中该按钮，则为 TRUE; 否则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

选中某个按钮后，该按钮将显示为按下状态。 如果要更改多个按钮状态，请考虑改为调用[SetState](#setstate) 。

##  <a name="commandtoindex"></a>CToolBarCtrl：： CommandToIndex

检索与指定的命令标识符相关联的按钮的从零开始的索引。

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
要查找其按钮索引的命令 ID。

### <a name="return-value"></a>返回值

与命令 ID 关联的按钮的从零开始的索引。

### <a name="remarks"></a>备注

##  <a name="create"></a>CToolBarCtrl：： Create

创建工具栏控件，并将其附加到 `CToolBarCtrl` 对象上。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
指定 toolbar 控件的样式。 工具栏必须始终具有 WS_CHILD 样式。 此外，还可以指定工具栏样式和窗口样式的任意组合，如 "**备注**" 中所述。

*rect*<br/>
根据需要指定工具栏控件的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](/previous-versions/dd162897\(v=vs.85\))结构。

*pParentWnd*<br/>
指定工具栏控件的父窗口。 值不得为 NULL。

*nID*<br/>
指定工具栏控件的 ID。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

可以通过两个步骤构造 `CToolBarCtrl`。 首先，调用构造函数，然后调用 `Create`，这将创建 toolbar 控件并将其附加到 `CToolBarCtrl` 对象。 将以下窗口样式应用到工具栏控件。

- 始终 WS_CHILD

- WS_VISIBLE 通常

- 很少 WS_DISABLED

有关窗口样式的说明，请参阅 Windows SDK 中的[CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) 。

根据需要应用[常用控件样式](/windows/win32/Controls/common-control-styles)的组合，如 Windows SDK 中所述。

将工具栏样式组合应用于控件或按钮本身。 样式在 Windows SDK 中的 "[工具栏" 控件和按钮样式](/windows/win32/Controls/toolbar-control-and-button-styles)中进行了介绍。

若要使用扩展工具栏样式，请在调用 `Create`后调用[SetExtendedStyle](#setextendedstyle) 。 若要创建具有扩展窗口样式的工具栏，请调用[CToolBarCtrl：： CreateEx](#createex)而不是 `Create`。

工具栏控件自动设置工具栏窗口的大小和位置。 高度基于工具栏中按钮的高度。 宽度与父窗口的工作区的宽度相同。 "CCS_TOP" 和 "CCS_BOTTOM" 样式确定工具栏是否位于工作区的顶部或底部。 默认情况下，工具栏具有 CCS_TOP 样式。

##  <a name="createex"></a>CToolBarCtrl：： CreateEx

创建一个控件（子窗口）并将其与 `CToolBarCtrl` 对象相关联。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwExStyle*<br/>
指定正在创建的控件的扩展样式。 有关扩展 Windows 样式的列表，请参阅 Windows SDK 中[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*参数。

*dwStyle*<br/>
指定 toolbar 控件的样式。 工具栏必须始终具有 WS_CHILD 样式。 此外，还可以指定工具栏样式和窗口样式的任意组合，如[Create](#create)的 "**备注**" 部分中所述。

*rect*<br/>
对[矩形](/previous-versions/dd162897\(v=vs.85\))结构的引用，该结构描述要创建的窗口的大小和位置（以*pParentWnd*的工作区坐标表示）。

*pParentWnd*<br/>
指向作为控件的父级的窗口的指针。

*nID*<br/>
控件的子窗口 ID。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

使用 `CreateEx` 而不是[Create](#create)来应用扩展的 windows 样式，该样式由 Windows 扩展样式指定的前言**WS_EX_** 开头。 `CreateEx` 使用*dwExStyle*指定的扩展 Windows 样式创建控件。 使用[SetExtendedStyle](#setextendedstyle)设置特定于控件的扩展样式。 例如，使用 `CreateEx` 将此类样式设置 WS_EX_CONTEXTHELP，但使用 `SetExtendedStyle` 将此类样式设置为 "TBSTYLE_EX_DRAWDDARROWS"。 有关详细信息，请参阅 Windows SDK 中[工具栏扩展样式](/windows/win32/Controls/toolbar-extended-styles)中所述的样式。

##  <a name="ctoolbarctrl"></a>CToolBarCtrl：： CToolBarCtrl

构造 `CToolBarCtrl` 对象。

```
CToolBarCtrl();
```

### <a name="remarks"></a>备注

必须调用[Create](#create)才能使工具栏可用。

##  <a name="customize"></a>CToolBarCtrl：：自定义

显示 "自定义工具栏" 对话框。

```
void Customize();
```

### <a name="remarks"></a>备注

此对话框允许用户通过添加和删除按钮自定义工具栏。 若要支持自定义功能，工具栏的父窗口必须按照[处理自定义通知](../../mfc/handling-customization-notifications.md)中所述处理自定义通知消息。 还必须使用 CCS_ADJUSTABLE 样式创建工具栏，如[CToolBarCtrl：： Create](#create)中所述。

##  <a name="deletebutton"></a>CToolBarCtrl：:D eleteButton

删除工具栏控件中的按钮。

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
要删除的按钮的从零开始的索引。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

##  <a name="enablebutton"></a>CToolBarCtrl：： EnableButton

启用或禁用工具栏控件中的指定按钮。

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
要启用或禁用的按钮的命令标识符。

*bEnable*<br/>
若要启用此按钮，则为 TRUE;若要禁用按钮，则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

启用某个按钮后，可以按下并选中它。 如果要更改多个按钮状态，请考虑改为调用[SetState](#setstate) 。

##  <a name="getanchorhighlight"></a>CToolBarCtrl：： GetAnchorHighlight

检索工具栏的定位点突出显示设置。

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>返回值

如果为非零，则启用锚点突出显示。 如果为0，则禁用定位点突出显示。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight)的行为，如 Windows SDK 中所述。

##  <a name="getbitmap"></a>CToolBarCtrl：： GetBitmap

检索与工具栏中的按钮关联的位图的索引。

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
要检索其位图索引的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果成功，则返回位图的索引; 否则返回零。

### <a name="remarks"></a>备注

实现 Windows SDK 中[TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap)的功能。

##  <a name="getbitmapflags"></a>CToolBarCtrl：： GetBitmapFlags

从工具栏中检索位图标志。

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>返回值

如果显示可以支持大的工具栏位图，则为具有 TBBF_LARGE 标志的 UINT，否则为 clear。

### <a name="remarks"></a>备注

你应在创建工具栏后，但在将位图添加到工具栏之前调用它。 返回值指示显示是否支持大位图。 如果显示支持大位图，并且你选择使用它，请先调用[SetBitmapSize](#setbitmapsize)和[SetButtonSize](#setbuttonsize) ，然后再使用[AddBitmap](#addbitmap)添加大位图。

##  <a name="getbutton"></a>CToolBarCtrl：： GetButton

在工具栏控件中检索有关指定按钮的信息。

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
要为其检索信息的按钮的从零开始的索引。

*lpButton*<br/>
用于接收按钮信息副本的 `TBBUTTON` 结构的地址。 有关 `TBBUTTON` 结构的信息，请参阅[CToolBarCtrl：： AddButtons](#addbuttons) 。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

##  <a name="getbuttoncount"></a>CToolBarCtrl：： GetButtonCount

检索当前在工具栏控件中的按钮的计数。

```
int GetButtonCount() const;
```

### <a name="return-value"></a>返回值

按钮的计数。

##  <a name="getbuttoninfo"></a>CToolBarCtrl：： GetButtonInfo

检索工具栏中某个按钮的信息。

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
按钮标识符。

*ptbbi*<br/>
指向[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)结构的指针，该结构接收按钮信息。

### <a name="return-value"></a>返回值

如果成功，则为按钮的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)的行为，如 Windows SDK 中所述。

##  <a name="getbuttonsize"></a>CToolBarCtrl：： GetButtonSize

获取工具栏按钮的大小。

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>返回值

一个 DWORD 值，其中分别包含 LOWORD 和 HIWORD 中的宽度和高度值。

##  <a name="getbuttontext"></a>CToolBarCtrl：： GetButtonText

检索当前 toolbar 控件上指定按钮的显示文本。

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*idButton*|中检索其显示文本的按钮的标识符。|

### <a name="return-value"></a>返回值

一个[CString](../../atl-mfc-shared/using-cstring.md) ，其中包含指定按钮的显示文本。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext)消息。

##  <a name="getcolorscheme"></a>CToolBarCtrl：： GetColorScheme

检索当前 toolbar 控件的配色方案。

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*lpColorScheme*|弄指向接收配色方案信息的[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)结构的指针。 此方法返回时，结构描述了 toolbar 控件的突出显示颜色和阴影颜色。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme)消息。

##  <a name="getdisabledimagelist"></a>CToolBarCtrl：： GetDisabledImageList

检索工具栏控件用来显示禁用的按钮的图像列表。

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>返回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)对象的指针; 如果未设置禁用的图像列表，则为 NULL。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)的行为，如 Windows SDK 中所述。 `GetDisabledImageList` 的 MFC 实现使用包含工具栏控件按钮图像的 `CImageList` 对象，而不是图像列表的句柄。

##  <a name="getdroptarget"></a>CToolBarCtrl：： GetDropTarget

检索 toolbar 控件的[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)接口。

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>参数

*ppDropTarget*<br/>
指向[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)接口指针的指针。 如果发生错误，则会在此地址中放置一个空指针。

### <a name="return-value"></a>返回值

返回一个 HRESULT 值，该值指示操作是成功还是失败。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETOBJECT](/windows/win32/Controls/tb-getobject)的行为，如 Windows SDK 中所述。

##  <a name="getextendedstyle"></a>CToolBarCtrl：： GetExtendedStyle

检索 toolbar 控件的扩展样式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>返回值

表示当前用于 toolbar 控件的扩展样式的 DWORD。 有关样式的列表，请参阅 Windows SDK 中的[工具栏扩展样式](/windows/win32/Controls/toolbar-extended-styles)。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)的行为，如 Windows SDK 中所述。

##  <a name="gethotimagelist"></a>CToolBarCtrl：： GetHotImageList

检索工具栏控件用来显示 "热" 按钮的图像列表。 当鼠标指针位于其上方时，热按钮将突出显示。

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>返回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)对象的指针; 如果未设置禁用的图像列表，则为 NULL。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist)的行为，如 Windows SDK 中所述。 当鼠标指针位于其上方时，热按钮将突出显示。

##  <a name="gethotitem"></a>CToolBarCtrl：： GetHotItem

检索工具栏中热项的索引。

```
int GetHotItem() const;
```

### <a name="return-value"></a>返回值

工具栏中热项的从零开始的索引。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)的行为，如 Windows SDK 中所述。

##  <a name="getimagelist"></a>CToolBarCtrl：： GetImageList

检索工具栏控件用来显示处于默认状态的按钮的图像列表。

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>返回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)对象的指针; 如果没有设置图像列表，则为 NULL。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETIMAGELIST](/windows/win32/Controls/tb-getimagelist)的行为，如 Windows SDK 中所述。

##  <a name="getinsertmark"></a>CToolBarCtrl：： GetInsertMark

检索工具栏的当前插入标记。

```
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>参数

*ptbim*<br/>
指向接收插入标记的[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)结构的指针。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)的行为，如 Windows SDK 中所述。

##  <a name="getinsertmarkcolor"></a>CToolBarCtrl：： GetInsertMarkColor

检索用于绘制工具栏插入标记的颜色。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>返回值

包含当前插入标记颜色的 COLORREF 值。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)的行为，如 Windows SDK 中所述。

##  <a name="getitemrect"></a>CToolBarCtrl：： GetItemRect

在工具栏控件中检索按钮的边框。

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
要为其检索信息的按钮的从零开始的索引。

*lpRect*<br/>
[矩形](/previous-versions/dd162897\(v=vs.85\))结构或接收边框坐标的[CRect](../../atl-mfc-shared/reference/crect-class.md)对象的地址。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

此函数不检索其状态设置为 TBSTATE_HIDDEN 的按钮的边框。

##  <a name="getmaxsize"></a>CToolBarCtrl：： GetMaxSize

检索工具栏中所有可见按钮和分隔符的总大小。

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>参数

*pSize*<br/>
指向接收项大小的[大小](/windows/win32/api/windef/ns-windef-size)结构的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)的行为，如 Windows SDK 中所述。

##  <a name="getmaxtextrows"></a>CToolBarCtrl：： GetMaxTextRows

检索工具栏按钮上显示的最大文本行数。

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>返回值

工具栏按钮上显示的最大文本行数。

##  <a name="getmetrics"></a>CToolBarCtrl：： GetMetrics

检索 `CToolBarCtrl` 对象的指标。

```
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>参数

*ptbm*<br/>
指向 `CToolBarCtrl` 对象的[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)结构的指针。

### <a name="remarks"></a>备注

此成员函数模拟[TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics)消息的功能，如 Windows SDK 中所述。

##  <a name="getpadding"></a>CToolBarCtrl：： GetPadding

检索当前 toolbar 控件的水平和垂直填充。

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*pnHorzPadding*|弄一个整数，接收工具栏控件的水平填充（以像素为单位）。|
|*pnVertPadding*|弄一个整数，接收工具栏控件的垂直填充（以像素为单位）。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_GETPADDING](/windows/win32/Controls/tb-getpadding)消息。

##  <a name="getpressedimagelist"></a>CToolBarCtrl：： GetPressedImageList

检索当前工具栏控件用来表示处于按下状态的按钮的图像列表。

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>返回值

一个指针，指向包含当前控件的图像列表的[CImageList](../../mfc/reference/cimagelist-class.md) ; 如果未设置此类图像列表，则为 NULL。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist)消息。

##  <a name="getrect"></a>CToolBarCtrl：： GetRect

检索指定工具栏按钮的边框。

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
按钮标识符。

*lpRect*<br/>
一个指针，指向用于接收边框信息的[RECT](/previous-versions/dd162897\(v=vs.85\))结构。

### <a name="return-value"></a>返回值

若成功，则为 TRUE；否则为 FALSE。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETRECT](/windows/win32/Controls/tb-getrect)的行为，如 Windows SDK 中所述。

##  <a name="getrows"></a>CToolBarCtrl：： GetRows

检索 toolbar 控件当前显示的按钮的行数。

```
int GetRows() const;
```

### <a name="return-value"></a>返回值

当前在工具栏上显示的按钮的行数。

### <a name="remarks"></a>备注

请注意，除非工具栏是用 TBSTYLE_WRAPABLE 样式创建的，否则行数将始终为1。

##  <a name="getstate"></a>CToolBarCtrl：： GetState

在工具栏控件中检索有关指定按钮的状态的信息，例如是否启用、按下或选中该按钮。

```
int GetState(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
要为其检索信息的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果成功，则为按钮状态信息; 否则为-1。 按钮状态信息可以是[CToolBarCtrl：： AddButtons](#addbuttons)中列出的值的组合。

### <a name="remarks"></a>备注

如果要检索多个按钮状态，则此函数特别有用。 若要仅检索一个状态，请使用以下成员函数之一： [IsButtonEnabled](#isbuttonenabled)、 [IsButtonChecked](#isbuttonchecked)、 [IsButtonPressed](#isbuttonpressed)、 [IsButtonHidden](#isbuttonhidden)或[IsButtonIndeterminate](#isbuttonindeterminate)。 但 `GetState` 成员函数是检测 TBSTATE_WRAP 按钮状态的唯一方法。

##  <a name="getstring"></a>CToolBarCtrl：： GetString

检索工具栏字符串。

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>参数

nString<br/>
字符串的索引。

*lpstrString*<br/>
指向用于返回字符串的缓冲区的指针。

*cchMaxLen*<br/>
缓冲区的长度（以字节为单位）。

*str*<br/>
字符串。

### <a name="return-value"></a>返回值

如果成功，则为-1; 如果为，则为-1。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_GETSTRING](/windows/win32/Controls/tb-getstring)的行为，如 Windows SDK 中所述。

##  <a name="getstyle"></a>CToolBarCtrl：： GetStyle

获取当前应用于工具栏控件的样式。

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>返回值

包含[toolbar 控件样式](/windows/win32/Controls/toolbar-control-and-button-styles)组合的 DWORD，如 Windows SDK 中所述。

##  <a name="gettooltips"></a>CToolBarCtrl：： GetToolTips

检索与 toolbar 控件关联的工具提示控件（如果有）的句柄。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>返回值

指向与此工具栏关联的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针; 如果工具栏没有关联的工具提示控件，则为 NULL。

### <a name="remarks"></a>备注

由于 toolbar 控件通常会创建和维护其自己的工具提示控件，因此大多数程序都不需要调用此函数。

##  <a name="hittest"></a>CToolBarCtrl：： System.windows.media.visualtreehelper.hittest

确定点在工具栏控件中的位置。

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>参数

*ppt*<br/>
指向[指向](/previous-versions/dd162805\(v=vs.85\))结构的指针，该结构包含在 `y` 成员中命中测试的 `x` 成员的 x 坐标和 y 坐标。 坐标相对于工具栏的工作区。

### <a name="return-value"></a>返回值

一个整数值，指示点在工具栏上的位置。 如果该值为零或正值，则此返回值为该点所在的 nonseparator 项的从零开始的索引。

如果返回值为负，则该点不在按钮中。 返回值的绝对值是分隔符项或最近的 nonseparator 项的索引。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_HITTEST](/windows/win32/Controls/tb-hittest)的行为，如 Windows SDK 中所述。

##  <a name="hidebutton"></a>CToolBarCtrl：： HideButton

在工具栏控件中隐藏或显示指定的按钮。

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
要隐藏或显示的按钮的命令标识符。

*bHide*<br/>
若要隐藏按钮，则为 TRUE; 否则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

如果要更改多个按钮状态，请考虑改为调用[SetState](#setstate) 。

##  <a name="indeterminate"></a>CToolBarCtrl：：不确定

设置或清除工具栏控件中指定按钮的不确定状态。

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
要设置或清除其状态不确定的按钮的命令标识符。

*bIndeterminate*<br/>
若要设置指定按钮的不确定状态，则为 TRUE，否则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

不确定的按钮显示为灰色，例如，当所选文本包含粗体字符和常规字符时，字处理器工具栏上的 "加粗" 按钮的显示方式。 如果要更改多个按钮状态，请考虑改为调用[SetState](#setstate) 。

##  <a name="insertbutton"></a>CToolBarCtrl：： InsertButton

在工具栏控件中插入按钮。

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
按钮的从零开始的索引。 此函数向此按钮的左侧插入新按钮。

*lpButton*<br/>
包含要插入的按钮信息的 `TBBUTTON` 结构的地址。 有关 `TBBUTTON` 结构的说明，请参阅[CToolBarCtrl：： AddButtons](#addbuttons) 。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

您提供的索引必须已使用[AddBitmap](#addbitmap)、 [AddString](#addstring)和/或[AddStrings](#addstrings)添加到 toolbar 控件列表中的图像和/或字符串。

##  <a name="insertmarkhittest"></a>CToolBarCtrl：： InsertMarkHitTest

检索工具栏中某个点的插入标记信息。

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>参数

*ppt*<br/>
指向一个[点](/previous-versions/dd162805\(v=vs.85\))结构的指针，该结构包含命中测试坐标（相对于工具栏的工作区）。

*ptbim*<br/>
指向接收插入标记信息的[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)结构的指针。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)的行为，如 Windows SDK 中所述。

##  <a name="isbuttonchecked"></a>CToolBarCtrl：： IsButtonChecked

确定是否选中了工具栏控件中的指定按钮。

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
工具栏中的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果选中此按钮，则为非零值;否则为零。

### <a name="remarks"></a>备注

如果要检索多个按钮状态，请考虑调用[GetState](#getstate) 。

##  <a name="isbuttonenabled"></a>CToolBarCtrl：： IsButtonEnabled

确定是否启用工具栏控件中的指定按钮。

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
工具栏中的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果启用此按钮，则为非零值;否则为零。

### <a name="remarks"></a>备注

如果要检索多个按钮状态，请考虑调用[GetState](#getstate) 。

##  <a name="isbuttonhidden"></a>CToolBarCtrl：： IsButtonHidden

确定工具栏控件中的指定按钮是否处于隐藏状态。

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
工具栏中的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果隐藏按钮，则为非零值;否则为零。

### <a name="remarks"></a>备注

如果要检索多个按钮状态，请考虑调用[GetState](#getstate) 。

##  <a name="isbuttonhighlighted"></a>CToolBarCtrl：： IsButtonHighlighted

检查工具栏按钮的突出显示状态。

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
中工具栏按钮的命令 ID。

### <a name="return-value"></a>返回值

如果突出显示该按钮，则为正整数; 如果不突出显示该按钮，则为 0; 如果出现错误，则为-1。

##  <a name="isbuttonindeterminate"></a>CToolBarCtrl：： IsButtonIndeterminate

确定工具栏控件中指定的按钮是否不确定。

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
中工具栏中的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果按钮不确定，则为正整数; 如果错误发生，则为零。

### <a name="remarks"></a>备注

不确定的按钮显示为灰色，例如，当所选文本同时包含粗体字符和常规字符时，字处理器工具栏上的 "加粗" 按钮的显示方式。 如果要检索多个按钮状态，请考虑调用[GetState](#getstate) 。

##  <a name="isbuttonpressed"></a>CToolBarCtrl：： IsButtonPressed

确定是否按下了工具栏控件中的指定按钮。

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>参数

*nID*<br/>
工具栏中的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果按下了按钮，则为非零; 否则为零。

### <a name="remarks"></a>备注

如果要检索多个按钮状态，请考虑调用[GetState](#getstate) 。

##  <a name="loadimages"></a>CToolBarCtrl：： LoadImages

将位图加载到工具栏控件的图像列表中。

```
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>参数

*iBitmapID*<br/>
包含要加载的图像的位图的 ID。 若要指定自己的位图资源，请将此参数设置为位图资源的 ID，并将*hInst*设置为 NULL。 位图资源将作为单个图像添加到图像列表。 可以通过将*hinst*设置为 HINST_COMMCTRL 并将此参数设置为以下 id 之一来添加标准的系统定义位图：

|位图 ID|说明|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|大大小的资源管理器位图|
|IDB_HIST_SMALL_COLOR|资源管理器小尺寸|
|IDB_STD_LARGE_COLOR|大小较大的标准位图|
|IDB_STD_SMALL_COLOR|小尺寸的标准位图|
|IDB_VIEW_LARGE_COLOR|大尺寸查看位图|
|IDB_VIEW_SMALL_COLOR|查看小尺寸的位图|

*hinst*<br/>
调用应用程序的程序实例句柄。 可以 HINST_COMMCTRL 此参数来加载标准图像列表。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)的行为，如 Windows SDK 中所述。

##  <a name="mapaccelerator"></a>CToolBarCtrl：： MapAccelerator

将快捷键映射到工具栏按钮。

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>参数

*chAccel*<br/>
要映射的快捷键。 此字符是按钮文本中带下划线的相同字符。

*pIDBtn*<br/>
指向 UINT 的指针，该指针接收与*chAccel*中指定的快捷键相对应的按钮的命令标识符。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator)的行为，如 Windows SDK 中所述。

##  <a name="markbutton"></a>CToolBarCtrl：： MarkButton

设置工具栏控件中给定按钮的突出显示状态。

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
按钮标识符。

*fHighlight*<br/>
指定要设置的突出显示状态。 默认情况下，为 TRUE。 如果设置为 FALSE，则按钮设置为其默认状态。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)的行为，如 Windows SDK 中所述。

##  <a name="movebutton"></a>CToolBarCtrl：： MoveButton

将按钮从一个索引移动到另一个索引。

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>参数

*nOldPos*<br/>
要移动的按钮的从零开始的索引。

*nNewPos*<br/>
按钮目标的从零开始的索引。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)的行为，如 Windows SDK 中所述。

##  <a name="pressbutton"></a>CToolBarCtrl：:P ressButton

按下或释放工具栏控件中的指定按钮。

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
中要按下或放开的按钮的命令标识符。

*bPress*<br/>
中如果按指定按钮，则为 TRUE;若要释放指定的按钮，则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果要更改多个按钮状态，请考虑改为调用[SetState](#setstate) 。

此方法发送 Windows SDK 中描述的[TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton)消息。

##  <a name="replacebitmap"></a>CToolBarCtrl：： ReplaceBitmap

将当前工具栏控件中的现有位图替换为新位图。

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*pReplaceBitmap*|中指向[TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap)结构的指针，该结构描述要替换的位图和新位图。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap)消息。

### <a name="example"></a>示例

下面的代码示例使用不同的位图替换标准工具栏的位图。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

##  <a name="restorestate"></a>CToolBarCtrl：： RestoreState

从参数指定的注册表中的位置还原 toolbar 控件的状态。

```
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>参数

*hKeyRoot*<br/>
标识注册表中当前打开的密钥或任何以下预定义的保留句柄值：

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
指向以 null 结尾的字符串，该字符串包含与值关联的子项的名称。 此参数可以为 null 或指向空字符串的指针。 如果参数为 NULL，则将值添加到由*hKeyRoot*参数标识的键。

*lpszValueName*<br/>
指向一个字符串，该字符串包含要检索的值的名称。 如果具有此名称的值不在该键中，则函数会将其添加到键。

##  <a name="savestate"></a>CToolBarCtrl：： SaveState

将 toolbar 控件的状态保存在参数指定的注册表中的位置。

```
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>参数

*hKeyRoot*<br/>
标识注册表中当前打开的密钥或任何以下预定义的保留句柄值：

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
指向以 null 结尾的字符串，该字符串包含与值关联的子项的名称。 此参数可以为 null 或指向空字符串的指针。 如果参数为 NULL，则将值添加到由*hKeyRoot*参数标识的键。

*lpszValueName*<br/>
指向一个字符串，该字符串包含要设置的值的名称。 如果具有此名称的值不在该键中，则函数会将其添加到键。

##  <a name="setanchorhighlight"></a>CToolBarCtrl：： SetAnchorHighlight

设置工具栏的定位点突出显示设置。

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>参数

*fAnchor*<br/>
中指定是否启用或禁用锚点突出显示。 如果此值为非零值，则将启用定位点突出显示。 如果此值为零，则将禁用定位点突出显示

### <a name="return-value"></a>返回值

上一个定位点设置。 如果启用突出显示，则此值为非零值。 如果未启用突出显示，则此值为零。

### <a name="remarks"></a>备注

此方法实现 Win32 消息[TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)的行为，如 Windows SDK 中所述。

##  <a name="setbitmapsize"></a>CToolBarCtrl：： SetBitmapSize

设置要添加到工具栏控件的实际位图图像的大小。

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>参数

size<br/>
位图图像的宽度和高度（以像素为单位）。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

只有在将任何位图添加到工具栏之前，才能调用此函数。 如果应用程序未显式设置位图大小，则默认为 16 x 15 像素。

##  <a name="setbuttoninfo"></a>CToolBarCtrl：： SetButtonInfo

设置工具栏中现有按钮的信息。

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>参数

*nID*<br/>
按钮标识符。

*ptbbi*<br/>
指向[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)结构的指针，该结构接收按钮信息。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo)的行为，如 Windows SDK 中所述。

##  <a name="setbuttonsize"></a>CToolBarCtrl：： SetButtonSize

在工具栏控件中设置按钮的大小。

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>参数

size<br/>
按钮的宽度和高度（以像素为单位）。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

按钮大小始终必须至少为其所包含的位图大小。 只有在将任何位图添加到工具栏之前，才能调用此函数。 如果应用程序未显式设置按钮大小，则默认为 24 x 22 像素。

### <a name="example"></a>示例

  请参阅[CToolBar：： GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)的示例。

##  <a name="setbuttonstructsize"></a>CToolBarCtrl：： SetButtonStructSize

指定 `TBBUTTON` 结构的大小。

```
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>参数

*nSize*<br/>
`TBBUTTON` 结构的大小（以字节为单位）。

### <a name="remarks"></a>备注

如果要在 `TBBUTTON` 结构中存储额外数据，则可以从 `TBBUTTON`派生新结构，添加所需的成员，或创建包含 `TBBUTTON` 结构作为其第一个成员的新结构。 然后，可以调用此函数来告知工具栏控制新结构的大小。

有关 `TBBUTTON` 结构的详细信息，请参阅[CToolBarCtrl：： AddButtons](#addbuttons) 。

##  <a name="setbuttonwidth"></a>CToolBarCtrl：： SetButtonWidth

设置工具栏控件中的最小值和最大值按钮宽度。

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>参数

*cxMin*<br/>
最小按钮宽度，以像素为单位。 工具栏按钮将永远不会比该值窄。

*cxMax*<br/>
最大按钮宽度，以像素为单位。 如果按钮文本太宽，控件将以省略号点显示它。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)的行为，如 Windows SDK 中所述。

##  <a name="setcmdid"></a>CToolBarCtrl：： SetCmdID

设置在按下指定按钮时将发送给所有者窗口的命令标识符。

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
要设置其命令 ID 的按钮的从零开始的索引。

*nID*<br/>
要将选定的按钮设置为的命令 ID。

### <a name="return-value"></a>返回值

如果成功，则返回非零值;否则为零。

##  <a name="setcolorscheme"></a>CToolBarCtrl：： SetColorScheme

设置当前 toolbar 控件的配色方案。

```
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*lpColorScheme*|中指向[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)结构的指针，该结构描述 toolbar 控件的突出显示颜色和阴影颜色。|

### <a name="remarks"></a>备注

如果设置了 Windows Vista 视觉对象主题，则此方法不起作用。

此方法发送 Windows SDK 中描述的[TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme)消息。

### <a name="example"></a>示例

下面的代码示例为当前 toolbar 控件设置配色方案。 此代码示例将每个工具按钮的左边缘和上边缘变为红色，并使右边缘和下边缘变为蓝色。 当用户按下按钮时，按钮的红边缘变为蓝色，蓝色边缘变为红色。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

##  <a name="setdisabledimagelist"></a>CToolBarCtrl：： SetDisabledImageList

设置工具栏控件将用于显示禁用的按钮的图像列表。

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>参数

*pImageList*<br/>
一个指向 `CImageList` 对象的指针，该对象包含 toolbar 控件用于显示禁用的按钮图像的图像。

### <a name="return-value"></a>返回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)对象的指针，该对象先前由 toolbar 控件用于显示禁用的按钮图像。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist)的行为，如 Windows SDK 中所述。 `SetDisabledImageList` 的 MFC 实现使用包含工具栏控件的禁用按钮图像的 `CImageList` 对象，而不是图像列表的句柄。

##  <a name="setdrawtextflags"></a>CToolBarCtrl：： SetDrawTextFlags

设置 Win32 函数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中的标志，该函数用于在指定的矩形中绘制文本，根据标志的设置方式进行设置。

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>参数

*dwMask*<br/>
Win32 函数[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中指定的一个或多个 DT_ 标志的组合，用于指示在绘制文本时将使用*dwDTFlags*中的哪些位。

*dwDTFlags*<br/>
在 Win32 函数 `DrawText`中指定的一个或多个 DT_ 标志的组合，用于指示如何绘制按钮文本。 绘制按钮文本时，此值会传递给 `DrawText`。

### <a name="return-value"></a>返回值

包含之前的文本绘制标志的 DWORD。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags)的行为，如 Windows SDK 中所述。 此成员函数在 Win32 函数 `DrawText`中设置标记，该函数在指定的矩形中绘制文本，并根据标志的设置方式进行设置。

##  <a name="setextendedstyle"></a>CToolBarCtrl：： SetExtendedStyle

设置工具栏控件的扩展样式。

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>参数

*dwExStyle*<br/>
一个值，该值指定新的扩展样式。 此参数可以是工具栏扩展样式的组合。

### <a name="return-value"></a>返回值

表示以前的扩展样式的 DWORD。 有关样式的列表，请参阅 Windows SDK 中的[工具栏扩展样式](/windows/win32/Controls/toolbar-extended-styles)。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)的行为，如 Windows SDK 中所述。

##  <a name="sethotimagelist"></a>CToolBarCtrl：： SetHotImageList

设置工具栏控件将用于显示 "热" 按钮的图像列表。

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>参数

*pImageList*<br/>
一个指向 `CImageList` 对象的指针，该对象包含 toolbar 控件用于显示热按钮图像的图像。

### <a name="return-value"></a>返回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)对象的指针，该对象先前由 toolbar 控件用于显示热按钮图像。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)的行为，如 Windows SDK 中所述。

`SetHotImageList` 的 MFC 实现使用包含工具栏控件的热按钮图像的 `CImageList` 对象，而不使用图像列表的句柄。 当指针位于其上方时，热按钮将突出显示。

##  <a name="sethotitem"></a>CToolBarCtrl：： SetHotItem

在工具栏中设置热项。

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>参数

*nHot*<br/>
将成为热项的从零开始的索引号。 如果此值为-1，则不会有任何项处于热状态。

### <a name="return-value"></a>返回值

上一个热项的索引; 如果没有热项，则为-1。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)的行为，如 Windows SDK 中所述。

##  <a name="setimagelist"></a>CToolBarCtrl：： SetImageList

设置工具栏将用于显示处于默认状态的按钮的图像列表。

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>参数

*pImageList*<br/>
一个指向 `CImageList` 对象的指针，该对象包含 toolbar 控件用于显示处于默认状态的按钮图像的图像。

### <a name="return-value"></a>返回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)对象的指针，该对象先前由 toolbar 控件用于显示处于默认状态的按钮图像。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)的行为，如 Windows SDK 中所述。

`SetImageList` 的 MFC 实现使用包含工具栏控件按钮图像的 `CImageList` 对象，而不是图像列表的句柄。

##  <a name="setindent"></a>CToolBarCtrl：： SetIndent

设置工具栏控件中第一个按钮的缩进。

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>参数

*iIndent*<br/>
指定缩进的值（以像素为单位）。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

##  <a name="setinsertmark"></a>CToolBarCtrl：： SetInsertMark

为工具栏设置当前插入标记。

```
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>参数

*ptbim*<br/>
指向[TBINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)结构的指针，该结构包含插入标记。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETINSERTMARK](/windows/win32/Controls/tb-setinsertmark)的行为，如 Windows SDK 中所述。

##  <a name="setinsertmarkcolor"></a>CToolBarCtrl：： SetInsertMarkColor

设置用于绘制工具栏插入标记的颜色。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>参数

*clrNew*<br/>
一个包含新插入标记颜色的 COLORREF 值。

### <a name="return-value"></a>返回值

一个包含前一插入标记颜色的 COLORREF 值。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor)的行为，如 Windows SDK 中所述。

##  <a name="setmaxtextrows"></a>CToolBarCtrl：： SetMaxTextRows

设置工具栏按钮上显示的最大文本行数。

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>参数

*iMaxRows*<br/>
要设置的最大行数。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

##  <a name="setmetrics"></a>CToolBarCtrl：： SetMetrics

设置 `CToolBarCtrl` 对象的度量值。

```
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>参数

*ptbm*<br/>
指向 `CToolBarCtrl` 对象的[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)结构的指针。

### <a name="remarks"></a>备注

此成员函数模拟[TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics)消息的功能，如 Windows SDK 中所述。

##  <a name="setowner"></a>CToolBarCtrl：： SetOwner

设置 toolbar 控件的所有者窗口。

```
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>参数

*pWnd*<br/>
指向 `CWnd` 或 `CWnd`派生对象的指针，该对象将成为 toolbar 控件的新所有者窗口。

### <a name="remarks"></a>备注

所有者窗口是从工具栏接收通知的窗口。

##  <a name="setpadding"></a>CToolBarCtrl：： SetPadding

设置当前 toolbar 控件的水平和垂直填充。

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*nHorzPadding*|中指定工具栏控件的水平填充（以像素为单位）。|
|*nVertPadding*|中指定工具栏控件的垂直填充（以像素为单位）。|

### <a name="return-value"></a>返回值

一个 DWORD 值，其低单词包含上一个水平填充值，其高位字包含上一个垂直填充值。 填充值以像素为单位进行度量。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_SETPADDING](/windows/win32/Controls/tb-setpadding)消息。

### <a name="example"></a>示例

下面的代码示例将当前工具栏控件的水平和垂直填充设置为20个像素。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

##  <a name="setpressedimagelist"></a>CToolBarCtrl：： SetPressedImageList

设置当前工具栏控件用来表示处于按下状态的按钮的图像列表。

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*iImageID*|中图像列表的从零开始的索引。 如果只使用一个图像列表，请将此参数设置为零。|
|*pImageList*|中指向包含新图像列表的[CImageList](../../mfc/reference/cimagelist-class.md)的指针。|

### <a name="return-value"></a>返回值

一个指针，指向包含当前控件的上一个图像列表的[CImageList](../../mfc/reference/cimagelist-class.md) ; 如果未设置此类图像列表，则为 NULL。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist)消息。

### <a name="example"></a>示例

下面的代码示例将按下的图像列表设置为与默认图像列表相同。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

##  <a name="setrows"></a>CToolBarCtrl：： SetRows

要求工具栏控件将自身大小调整为请求的行数。

```
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>参数

nRows<br/>
请求的行数。

*bLarger*<br/>
如果无法将工具栏调整为所需的行数，则指示是使用更多行还是更少的行。

*lpRect*<br/>
指向将接收工具栏的新边框的[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](/previous-versions/dd162897\(v=vs.85\))结构。

### <a name="remarks"></a>备注

如果工具栏无法将自身调整为所请求的数量或行数，则会将其自身调整到下一个较大或较小的有效大小，具体取决于*bLarger*的值。 如果*bLarger*为 TRUE，则新行数将大于请求的数目。 如果*bLarger*为 FALSE，则新行数将小于请求的数目。

如果按钮可以排列，则给定数量的行对工具栏有效，以便所有行都具有相同数目的按钮（或许是最后一行除外）。 例如，包含四个按钮的工具栏无法调整为三行大小，因为最后两行必须更短。 如果尝试将其设置为三行大小，则如果*bLarger*为 TRUE，则会获得四行，如果*bLarger*为 FALSE，则返回两行。

如果工具栏中有分隔符，则给定行数有效的规则将更复杂。 将计算布局，以便按钮组（组中第一个和最后一个按钮之前带有分隔符的按钮）永远不会在多行上分解，除非组无法容纳在一行上。

如果某个组不适合某个行，则下一组将从下一行开始，即使它适合于大组结束的行。 此规则的目的是使大组之间的隔离更为明显。 生成的垂直分隔符计为行。

另请注意，`SetRows` 成员函数将始终选择会生成最小工具栏大小的布局。 创建具有 TBSTYLE_WRAPABLE 样式的工具栏，然后调整控件大小，只需在控件的宽度后应用上面所述的方法。

只能为用 TBSTYLE_WRAPABLE 样式创建的工具栏调用此函数。

##  <a name="setstate"></a>CToolBarCtrl：： SetState

在工具栏控件中设置指定按钮的状态。

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>参数

*nID*<br/>
按钮的命令标识符。

*nState*<br/>
状态标志。 它可以是为[CToolBarCtrl：： AddButtons](#addbuttons)中的按钮状态列出的值的组合。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

如果要设置多个按钮状态，则此功能特别有用。 若要只设置一个状态，请使用以下成员函数之一： [EnableButton](#enablebutton)、 [CheckButton](#checkbutton)、 [HideButton](#hidebutton)、不[确定](#indeterminate)或[PressButton](#pressbutton)。

##  <a name="setstyle"></a>CToolBarCtrl：： System.windows.forms.control.setstyle

设置工具栏控件的样式。

```
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
包含[toolbar 控件样式](/windows/win32/Controls/toolbar-control-and-button-styles)组合的 DWORD，如 Windows SDK 中所述。

##  <a name="settooltips"></a>CToolBarCtrl：： SetToolTips

将工具提示控件与工具栏控件相关联。

```
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>参数

*pTip*<br/>
指向[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针。

##  <a name="setwindowtheme"></a>CToolBarCtrl：： SetWindowTheme

设置 `CToolBarCtrl` 对象的视觉样式。

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>参数

*pszSubAppName*<br/>
指向 Unicode 字符串的指针，该字符串包含要设置的工具栏视觉样式。

### <a name="return-value"></a>返回值

不使用返回值。

### <a name="remarks"></a>备注

此成员函数模拟[TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme)消息的功能，如 Windows SDK 中所述。

## <a name="see-also"></a>另请参阅

[MFC 示例 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC 示例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[CToolBar 类](../../mfc/reference/ctoolbar-class.md)
