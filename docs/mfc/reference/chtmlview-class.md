---
title: CHtmlView 类
ms.date: 11/04/2016
f1_keywords:
- CHtmlView
- AFXHTML/CHtmlView
- AFXHTML/CHtmlView::Create
- AFXHTML/CHtmlView::CreateControlSite
- AFXHTML/CHtmlView::ExecFormsCommand
- AFXHTML/CHtmlView::ExecWB
- AFXHTML/CHtmlView::GetAddressBar
- AFXHTML/CHtmlView::GetApplication
- AFXHTML/CHtmlView::GetBusy
- AFXHTML/CHtmlView::GetContainer
- AFXHTML/CHtmlView::GetFullName
- AFXHTML/CHtmlView::GetFullScreen
- AFXHTML/CHtmlView::GetHeight
- AFXHTML/CHtmlView::GetHtmlDocument
- AFXHTML/CHtmlView::GetLeft
- AFXHTML/CHtmlView::GetLocationName
- AFXHTML/CHtmlView::GetLocationURL
- AFXHTML/CHtmlView::GetMenuBar
- AFXHTML/CHtmlView::GetOffline
- AFXHTML/CHtmlView::GetParentBrowser
- AFXHTML/CHtmlView::GetProperty
- AFXHTML/CHtmlView::GetReadyState
- AFXHTML/CHtmlView::GetRegisterAsBrowser
- AFXHTML/CHtmlView::GetRegisterAsDropTarget
- AFXHTML/CHtmlView::GetSilent
- AFXHTML/CHtmlView::GetSource
- AFXHTML/CHtmlView::GetStatusBar
- AFXHTML/CHtmlView::GetTheaterMode
- AFXHTML/CHtmlView::GetToolBar
- AFXHTML/CHtmlView::GetTop
- AFXHTML/CHtmlView::GetTopLevelContainer
- AFXHTML/CHtmlView::GetType
- AFXHTML/CHtmlView::GetVisible
- AFXHTML/CHtmlView::GetWidth
- AFXHTML/CHtmlView::GoBack
- AFXHTML/CHtmlView::GoForward
- AFXHTML/CHtmlView::GoHome
- AFXHTML/CHtmlView::GoSearch
- AFXHTML/CHtmlView::LoadFromResource
- AFXHTML/CHtmlView::Navigate
- AFXHTML/CHtmlView::Navigate2
- AFXHTML/CHtmlView::OnBeforeNavigate2
- AFXHTML/CHtmlView::OnCommandStateChange
- AFXHTML/CHtmlView::OnDocumentComplete
- AFXHTML/CHtmlView::OnDocWindowActivate
- AFXHTML/CHtmlView::OnDownloadBegin
- AFXHTML/CHtmlView::OnDownloadComplete
- AFXHTML/CHtmlView::OnEnableModeless
- AFXHTML/CHtmlView::OnFilterDataObject
- AFXHTML/CHtmlView::OnFrameWindowActivate
- AFXHTML/CHtmlView::OnFullScreen
- AFXHTML/CHtmlView::OnGetDropTarget
- AFXHTML/CHtmlView::OnGetExternal
- AFXHTML/CHtmlView::OnGetHostInfo
- AFXHTML/CHtmlView::OnGetOptionKeyPath
- AFXHTML/CHtmlView::OnHideUI
- AFXHTML/CHtmlView::OnMenuBar
- AFXHTML/CHtmlView::OnNavigateComplete2
- AFXHTML/CHtmlView::OnNavigateError
- AFXHTML/CHtmlView::OnNewWindow2
- AFXHTML/CHtmlView::OnProgressChange
- AFXHTML/CHtmlView::OnPropertyChange
- AFXHTML/CHtmlView::OnQuit
- AFXHTML/CHtmlView::OnResizeBorder
- AFXHTML/CHtmlView::OnShowContextMenu
- AFXHTML/CHtmlView::OnShowUI
- AFXHTML/CHtmlView::OnStatusBar
- AFXHTML/CHtmlView::OnStatusTextChange
- AFXHTML/CHtmlView::OnTheaterMode
- AFXHTML/CHtmlView::OnTitleChange
- AFXHTML/CHtmlView::OnToolBar
- AFXHTML/CHtmlView::OnTranslateAccelerator
- AFXHTML/CHtmlView::OnTranslateUrl
- AFXHTML/CHtmlView::OnUpdateUI
- AFXHTML/CHtmlView::OnVisible
- AFXHTML/CHtmlView::PutProperty
- AFXHTML/CHtmlView::QueryFormsCommand
- AFXHTML/CHtmlView::QueryStatusWB
- AFXHTML/CHtmlView::Refresh
- AFXHTML/CHtmlView::Refresh2
- AFXHTML/CHtmlView::SetAddressBar
- AFXHTML/CHtmlView::SetFullScreen
- AFXHTML/CHtmlView::SetHeight
- AFXHTML/CHtmlView::SetLeft
- AFXHTML/CHtmlView::SetMenuBar
- AFXHTML/CHtmlView::SetOffline
- AFXHTML/CHtmlView::SetRegisterAsBrowser
- AFXHTML/CHtmlView::SetRegisterAsDropTarget
- AFXHTML/CHtmlView::SetSilent
- AFXHTML/CHtmlView::SetStatusBar
- AFXHTML/CHtmlView::SetTheaterMode
- AFXHTML/CHtmlView::SetToolBar
- AFXHTML/CHtmlView::SetTop
- AFXHTML/CHtmlView::SetVisible
- AFXHTML/CHtmlView::SetWidth
- AFXHTML/CHtmlView::Stop
helpviewer_keywords:
- CHtmlView [MFC], Create
- CHtmlView [MFC], CreateControlSite
- CHtmlView [MFC], ExecFormsCommand
- CHtmlView [MFC], ExecWB
- CHtmlView [MFC], GetAddressBar
- CHtmlView [MFC], GetApplication
- CHtmlView [MFC], GetBusy
- CHtmlView [MFC], GetContainer
- CHtmlView [MFC], GetFullName
- CHtmlView [MFC], GetFullScreen
- CHtmlView [MFC], GetHeight
- CHtmlView [MFC], GetHtmlDocument
- CHtmlView [MFC], GetLeft
- CHtmlView [MFC], GetLocationName
- CHtmlView [MFC], GetLocationURL
- CHtmlView [MFC], GetMenuBar
- CHtmlView [MFC], GetOffline
- CHtmlView [MFC], GetParentBrowser
- CHtmlView [MFC], GetProperty
- CHtmlView [MFC], GetReadyState
- CHtmlView [MFC], GetRegisterAsBrowser
- CHtmlView [MFC], GetRegisterAsDropTarget
- CHtmlView [MFC], GetSilent
- CHtmlView [MFC], GetSource
- CHtmlView [MFC], GetStatusBar
- CHtmlView [MFC], GetTheaterMode
- CHtmlView [MFC], GetToolBar
- CHtmlView [MFC], GetTop
- CHtmlView [MFC], GetTopLevelContainer
- CHtmlView [MFC], GetType
- CHtmlView [MFC], GetVisible
- CHtmlView [MFC], GetWidth
- CHtmlView [MFC], GoBack
- CHtmlView [MFC], GoForward
- CHtmlView [MFC], GoHome
- CHtmlView [MFC], GoSearch
- CHtmlView [MFC], LoadFromResource
- CHtmlView [MFC], Navigate
- CHtmlView [MFC], Navigate2
- CHtmlView [MFC], OnBeforeNavigate2
- CHtmlView [MFC], OnCommandStateChange
- CHtmlView [MFC], OnDocumentComplete
- CHtmlView [MFC], OnDocWindowActivate
- CHtmlView [MFC], OnDownloadBegin
- CHtmlView [MFC], OnDownloadComplete
- CHtmlView [MFC], OnEnableModeless
- CHtmlView [MFC], OnFilterDataObject
- CHtmlView [MFC], OnFrameWindowActivate
- CHtmlView [MFC], OnFullScreen
- CHtmlView [MFC], OnGetDropTarget
- CHtmlView [MFC], OnGetExternal
- CHtmlView [MFC], OnGetHostInfo
- CHtmlView [MFC], OnGetOptionKeyPath
- CHtmlView [MFC], OnHideUI
- CHtmlView [MFC], OnMenuBar
- CHtmlView [MFC], OnNavigateComplete2
- CHtmlView [MFC], OnNavigateError
- CHtmlView [MFC], OnNewWindow2
- CHtmlView [MFC], OnProgressChange
- CHtmlView [MFC], OnPropertyChange
- CHtmlView [MFC], OnQuit
- CHtmlView [MFC], OnResizeBorder
- CHtmlView [MFC], OnShowContextMenu
- CHtmlView [MFC], OnShowUI
- CHtmlView [MFC], OnStatusBar
- CHtmlView [MFC], OnStatusTextChange
- CHtmlView [MFC], OnTheaterMode
- CHtmlView [MFC], OnTitleChange
- CHtmlView [MFC], OnToolBar
- CHtmlView [MFC], OnTranslateAccelerator
- CHtmlView [MFC], OnTranslateUrl
- CHtmlView [MFC], OnUpdateUI
- CHtmlView [MFC], OnVisible
- CHtmlView [MFC], PutProperty
- CHtmlView [MFC], QueryFormsCommand
- CHtmlView [MFC], QueryStatusWB
- CHtmlView [MFC], Refresh
- CHtmlView [MFC], Refresh2
- CHtmlView [MFC], SetAddressBar
- CHtmlView [MFC], SetFullScreen
- CHtmlView [MFC], SetHeight
- CHtmlView [MFC], SetLeft
- CHtmlView [MFC], SetMenuBar
- CHtmlView [MFC], SetOffline
- CHtmlView [MFC], SetRegisterAsBrowser
- CHtmlView [MFC], SetRegisterAsDropTarget
- CHtmlView [MFC], SetSilent
- CHtmlView [MFC], SetStatusBar
- CHtmlView [MFC], SetTheaterMode
- CHtmlView [MFC], SetToolBar
- CHtmlView [MFC], SetTop
- CHtmlView [MFC], SetVisible
- CHtmlView [MFC], SetWidth
- CHtmlView [MFC], Stop
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
ms.openlocfilehash: 07f942e6582eb9fabe6001c4823ec9e2b1a83bf6
ms.sourcegitcommit: c1f646c8b72f330fa8cf5ddb0f8f261ba10d16f0
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/21/2019
ms.locfileid: "58328969"
---
# <a name="chtmlview-class"></a>CHtmlView 类

提供 MFC 文档/视图体系结构上下文中的 Web 浏览器控件功能。

## <a name="syntax"></a>语法

```
class CHtmlView : public CFormView
```

## <a name="members"></a>成员

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CHtmlView::Create](#create)|创建 WebBrowser 控件。|
|[CHtmlView::CreateControlSite](#createcontrolsite)|可重写，用于创建控件站点实例以承载窗体上的控件。|
|[CHtmlView::ExecFormsCommand](#execformscommand)|使用 `IOleCommandTarget::Exec` 方法执行指定的命令。|
|[CHtmlView::ExecWB](#execwb)|执行命令。|
|[CHtmlView::GetAddressBar](#getaddressbar)|确定 Internet Explorer 对象的地址栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::GetApplication](#getapplication)|检索一个应用程序对象，该对象表示包含 Internet Explorer 应用程序的当前实例的应用程序。|
|[CHtmlView::GetBusy](#getbusy)|检索一个值，该值指示下载或其他活动是否仍在进行中。|
|[CHtmlView::GetContainer](#getcontainer)|检索 WebBrowser 控件的容器。|
|[CHtmlView::GetFullName](#getfullname)|检索 web 浏览器中显示的资源的完整名称，包括路径。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::GetFullScreen](#getfullscreen)|指示 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。|
|[CHtmlView::GetHeight](#getheight)|检索 Internet Explorer 主窗口的高度。|
|[CHtmlView::GetHtmlDocument](#gethtmldocument)|检索活动的 HTML 文档。|
|[CHtmlView::GetLeft](#getleft)|检索 Internet Explorer 主窗口左边缘的屏幕坐标。|
|[CHtmlView::GetLocationName](#getlocationname)|检索 WebBrowser 当前正在显示的资源的名称。|
|[CHtmlView::GetLocationURL](#getlocationurl)|检索 WebBrowser 当前正在显示的资源的 URL。|
|[CHtmlView::GetMenuBar](#getmenubar)|检索一个值，该值确定菜单栏是否可见。|
|[CHtmlView::GetOffline](#getoffline)|检索一个值，该值确定控件是否处于脱机状态。|
|[CHtmlView::GetParentBrowser](#getparentbrowser)|检索指向 `IDispatch` 接口的指针。 有关更多信息，请参见 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。|
|[CHtmlView::GetProperty](#getproperty)|检索与给定对象关联的属性的当前值。|
|[CHtmlView::GetReadyState](#getreadystate)|检索 web 浏览器对象的就绪状态。|
|[CHtmlView::GetRegisterAsBrowser](#getregisterasbrowser)|指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。|
|[CHtmlView::GetRegisterAsDropTarget](#getregisterasdroptarget)|指示是否将 WebBrowser 控件注册为导航的放置目标。|
|[CHtmlView::GetSilent](#getsilent)|指示是否可以显示任何对话框。|
|[CHtmlView::GetSource](#getsource)|网页的 HTML 源代码。|
|[CHtmlView::GetStatusBar](#getstatusbar)|指示 Internet Explorer 的状态栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::GetTheaterMode](#gettheatermode)|指示 WebBrowser 控件是否处于影院模式。|
|[CHtmlView::GetToolBar](#gettoolbar)|检索一个值，该值确定工具栏是否可见。|
|[CHtmlView::GetTop](#gettop)|检索 Internet Explorer 主窗口顶部边缘的屏幕坐标。|
|[CHtmlView::GetTopLevelContainer](#gettoplevelcontainer)|检索一个值，该值指示当前对象是否为 WebBrowser 控件的顶级容器。|
|[CHtmlView::GetType](#gettype)|检索文档对象的类型名称。|
|[CHtmlView::GetVisible](#getvisible)|检索一个值，该值指示对象是可见还是隐藏。|
|[CHtmlView::GetWidth](#getwidth)|检索 Internet Explorer 主窗口的宽度。|
|[CHtmlView::GoBack](#goback)|导航至历史记录列表中的上一项。|
|[CHtmlView::GoForward](#goforward)|导航至历史记录列表中的下一项。|
|[CHtmlView::GoHome](#gohome)|导航至当前主页或起始页。|
|[CHtmlView::GoSearch](#gosearch)|导航至当前搜索页。|
|[CHtmlView::LoadFromResource](#loadfromresource)|加载 WebBrowser 控件中的资源。|
|[CHtmlView::Navigate](#navigate)|导航至由 URL 标识的资源。|
|[CHtmlView::Navigate2](#navigate2)|导航至由 URL 标识的资源或由完整路径标识的文件。|
|[CHtmlView::OnBeforeNavigate2](#onbeforenavigate2)|在给定 WebBrowser 中发生导航之前调用（在窗口或框架集元素上）|
|[CHtmlView::OnCommandStateChange](#oncommandstatechange)|调用以通知应用程序 Web 浏览器命令的启用状态已更改。|
|[CHtmlView::OnDocumentComplete](#ondocumentcomplete)|调用以通知应用程序文档已到达 READYSTATE_COMPLETE 状态。|
|[CHtmlView::OnDocWindowActivate](#ondocwindowactivate)|从 [IOleInPlaceActiveObject::OnDocWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)的 Internet Explorer 或 MSHTML 实现调用，该操作将在激活或停用容器文件窗口时通知活动的就地对象。|
|[CHtmlView::OnDownloadBegin](#ondownloadbegin)|调用以通知应用程序将开始导航操作|
|[CHtmlView::OnDownloadComplete](#ondownloadcomplete)|在导航操作完成、暂停或失败时调用。|
|[CHtmlView::OnEnableModeless](#onenablemodeless)|调用以在容器创建或销毁模式对话框时启用或禁用无模式对话框。|
|[CHtmlView::OnFilterDataObject](#onfilterdataobject)|由 Internet Explorer 或 MSHTML 对主机调用，以允许主机替换 Internet Explorer 或 MSHTML 的数据对象。|
|[CHtmlView::OnFrameWindowActivate](#onframewindowactivate)|从 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 调用以在容器的顶级框架窗口被激活或停用时通知对象。|
|[CHtmlView::OnFullScreen](#onfullscreen)|当 FullScreen 属性已更改时调用。|
|[CHtmlView::OnGetDropTarget](#ongetdroptarget)|当用作放置目标时由 Internet Explorer 或 MSHTML 调用以允许主机提供替代的 [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)。|
|[CHtmlView::OnGetExternal](#ongetexternal)|由 Internet Explorer 或 MSHTML 调用以获取主机的 `IDispatch` 接口。|
|[CHtmlView::OnGetHostInfo](#ongethostinfo)|检索 Internet Explorer 或 MSHTML 主机的用户界面功能。|
|[CHtmlView::OnGetOptionKeyPath](#ongetoptionkeypath)|返回 Internet Explorer 或 MSHTML 在其下存储用户首选项的注册表项。|
|[CHtmlView::OnHideUI](#onhideui)|当 Internet Explorer 或 MSHTML 删除其菜单和工具栏时调用。|
|[CHtmlView::OnMenuBar](#onmenubar)|当 MenuBar 属性已更改时调用。|
|[CHtmlView::OnNavigateComplete2](#onnavigatecomplete2)|完成到超链接的导航后调用（在窗口或框架集元素上）。|
|[CHtmlView::OnNavigateError](#onnavigateerror)|当导航到超链接失败时由框架调用。|
|[CHtmlView::OnNewWindow2](#onnewwindow2)|当要创建新窗口以显示资源时调用。|
|[CHtmlView::OnProgressChange](#onprogresschange)|调用以通知应用程序下载操作的进度已更新。|
|[CHtmlView::OnPropertyChange](#onpropertychange)|调用以通知应用程序 [PutProperty](#putproperty) 方法已更改一个属性的值。|
|[CHtmlView::OnQuit](#onquit)|调用以通知应用程序 Internet Explorer 应用程序已准备退出。 （仅适用于 Internet Explorer）|
|[CHtmlView::OnResizeBorder](#onresizeborder)|从 [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)的 Internet Explorer 或 MSHTML 实现调用，该操作警告对象需要重新调整其边框空间的大小。|
|[CHtmlView::OnShowContextMenu](#onshowcontextmenu)|当 Internet Explorer 或 MSHTML 将要显示其上下文菜单时，从其调用。|
|[CHtmlView::OnShowUI](#onshowui)|在 Internet Explorer 或 MSHTML 显示其菜单和工具栏之前调用。|
|[CHtmlView::OnStatusBar](#onstatusbar)|当 StatusBar 属性已更改时调用。|
|[CHtmlView::OnStatusTextChange](#onstatustextchange)|调用以通知应用程序与 WebBrowser 控件相关联的状态栏的文本已更改。|
|[CHtmlView::OnTheaterMode](#ontheatermode)|当 TheaterMode 属性已更改时调用。|
|[CHtmlView::OnTitleChange](#ontitlechange)|调用以通知应用程序 WebBrowser 控件中的文档的标题是否变为可用或是否更改。|
|[CHtmlView::OnToolBar](#ontoolbar)|当 ToolBar 属性已更改时调用。|
|[CHtmlView::OnTranslateAccelerator](#ontranslateaccelerator)|当调用 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/desktop/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 以处理来自容器消息队列的菜单快捷键消息时由 Internet Explorer 或 MSHTML 调用。|
|[CHtmlView::OnTranslateUrl](#ontranslateurl)|由 Internet Explorer 或 MSHTML 调用以允许主机有机会修改要加载的 URL。|
|[CHtmlView::OnUpdateUI](#onupdateui)|通知主机命令状态已更改。|
|[CHtmlView::OnVisible](#onvisible)|当应该显示/隐藏 WebBrowser 控件的窗口时调用。|
|[CHtmlView::PutProperty](#putproperty)|检索与给定对象关联的属性的值。|
|[CHtmlView::QueryFormsCommand](#queryformscommand)|查询由用户界面事件生成的一个或多个命令的状态。|
|[CHtmlView::QueryStatusWB](#querystatuswb)|查询正在由 WebBrowser 控件进行处理的命令的状态。|
|[CHtmlView::Refresh](#refresh)|重新加载当前文件。|
|[CHtmlView::Refresh2](#refresh2)|重新加载当前文件并选择性地阻止 `pragma:nocache` 标头被发送。|
|[CHtmlView::SetAddressBar](#setaddressbar)|显示 或隐藏 Internet Explorer 对象的地址栏。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::SetFullScreen](#setfullscreen)|设置一个值，用于确定 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::SetHeight](#setheight)|设置 Internet Explorer 主窗口的高度。|
|[CHtmlView::SetLeft](#setleft)|设置 Internet Explorer 主窗口的水平位置。|
|[CHtmlView::SetMenuBar](#setmenubar)|设置一个值，用以确定控件的菜单栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::SetOffline](#setoffline)|设置一个值，用以确定控件是否处于脱机状态。|
|[CHtmlView::SetRegisterAsBrowser](#setregisterasbrowser)|设置一个值，指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。|
|[CHtmlView::SetRegisterAsDropTarget](#setregisterasdroptarget)|设置一个值，指示是否将 WebBrowser 控件注册为导航的放置目标。|
|[CHtmlView::SetSilent](#setsilent)|设置一个值，用以确定控件是否将显示对话框。|
|[CHtmlView::SetStatusBar](#setstatusbar)|设置一个值，用以确定 Internet Explorer 的状态栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::SetTheaterMode](#settheatermode)|设置一个值，指示 WebBrowser 控件是否处于影院模式。|
|[CHtmlView::SetToolBar](#settoolbar)|设置一个值，用以确定控件的工具栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView::SetTop](#settop)|设置 Internet Explorer 主窗口的垂直位置。|
|[CHtmlView::SetVisible](#setvisible)|设置一个值，该值指示对象是可见还是隐藏。|
|[CHtmlView::SetWidth](#setwidth)|设置 Internet Explorer 主窗口的宽度。|
|[CHtmlView::Stop](#stop)|停止打开文件。|

## <a name="remarks"></a>备注

WebBrowser 控件是一个窗口，其中用户可以浏览万维网上的站点以及本地文件系统中和网络上的文件夹。 WebBrowser 控件支持超级链接、统一资源定位器 (URL) 导航，并维护历史记录列表。

## <a name="using-the-chtmlview-class-in-an-mfc-application"></a>在 MFC 应用程序中使用 CHtmlView 类

在标准 MFC 框架应用程序（基于 SDI 或 MDI）中，视图对象通常派生自专用的一组类。 这些类全部派生自 `CView`，它们提供 `CView`所没有提供的专用功能。

将 `CHtmlView` 作为应用程序的视图类的基础可向视图提供 WebBrowser 控件。 这将有效地使应用程序成为一个 Web 浏览器。 创建一个 Web 浏览器样式的应用程序的首选方法是使用 MFC 应用程序向导，并将 `CHtmlView` 指定为视图类。 有关在 MFC 应用程序内实现和使用 WebBrowser 控件的详细信息，请参阅 [创建 Web 浏览器样式的应用程序](../../mfc/reference/creating-a-web-browser-style-mfc-application.md)。

> [!NOTE]
>  WebBrowser ActiveX 控件（因此 `CHtmlView`）仅可用于在 Windows NT 4.0 版或更高版本（其中安装了 Internet Explorer 4.0 版或更高版本）下运行的程序。

`CHtmlView` 用于可访问 Web（和/或 HTML 文档）的应用程序。 以下 `CHtmlView` 成员函数仅适用于 Internet Explorer 应用程序。 这些函数将在 WebBrowser 控件上成功运行，但不会有明显的效果。

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## <a name="requirements"></a>要求

**标头：** afxhtml.h

##  <a name="create"></a>  CHtmlView::Create

调用此成员函数以创建在 web 浏览器控件或容器的 Internet Explorer 可执行文件。

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>参数

*lpszClassName*<br/>
指向以 null 结尾的字符串命名的 Windows 类。 类名可以是任何名称与注册[AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass)全局函数或`RegisterClass`Windows 函数。 如果为 NULL，将使用预定义的默认[CFrameWnd](../../mfc/reference/cframewnd-class.md)属性。

*lpszWindowName*<br/>
指向以 null 结尾的字符串的字符串表示窗口名称。

*dwStyle*<br/>
指定的窗口样式特性。 默认情况下，设置 WS_VISIBLE 和 WS_CHILD Windows 样式。

*rect*<br/>
对引用[RECT](/previous-versions/dd162897\(v=vs.85\))结构，它指定的大小和窗口的位置。 *RectDefault*值，则允许 Windows 指定大小和新窗口的位置。

*pParentWnd*<br/>
指向控件的父窗口的指针。

*nID*<br/>
视图的 ID 号。 默认情况下，设置为 AFX_IDW_PANE_FIRST。

*pContext*<br/>
一个指向[CCreateContext](../../mfc/reference/ccreatecontext-structure.md)。 默认情况下为 NULL。

##  <a name="createcontrolsite"></a>  CHtmlView::CreateControlSite

可重写，用于创建控件站点实例以承载窗体上的控件。

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### <a name="parameters"></a>参数

*pContainer*<br/>
一个指向[COleControlContainer](../../mfc/reference/colecontrolcontainer-class.md)对象，其中包含该控件。

*ppSite*<br/>
指针到指向[COleControlSite](../../mfc/reference/colecontrolsite-class.md)对象，以便该站点提供的控件。

*nID*<br/>
要承载的控件的标识符。

*clsid*<br/>
若要在托管控件的 CLSID

### <a name="return-value"></a>返回值

如果成功，则返回 TRUE FALSE 失败。

### <a name="remarks"></a>备注

您可以重写此成员函数以返回您自己控件站点类的实例。

##  <a name="execformscommand"></a>  CHtmlView::ExecFormsCommand

使用 `IOleCommandTarget::Exec` 方法执行指定的命令。

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### <a name="parameters"></a>参数

*dwCommandID*<br/>
要执行的命令。 此命令必须属于 CMDSETID3_Forms3 组。

*pVarIn*<br/>
指向`VARIANT`结构，它包含输入的参数。 可以为 NULL。

*pVarOut*<br/>
指向`VARIANT`接收命令输出的结构。 可以为 NULL。

### <a name="return-value"></a>返回值

标准的 HRESULT 值。 有关可能的值的完整列表，请参阅[IOleCommandTarget::Exec](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-exec) Windows SDK 中。

### <a name="remarks"></a>备注

`ExecFormsCommand` 实现的行为[IOleCommandTarget::Exec](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-exec)方法。

##  <a name="execwb"></a>  CHtmlView::ExecWB

调用此成员函数可在 web 浏览器或 Internet 资源管理器中执行命令。

```
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### <a name="parameters"></a>参数

*cmdID*<br/>
要执行的命令。

*cmdexecopt*<br/>
为执行该命令设置的选项。

*pvaIn*<br/>
一个用于指定命令的输入的参数的变量。

*pvaOut*<br/>
用于指定命令的输出参数变量。

### <a name="remarks"></a>备注

请参阅[IWebBrowser2::ExecWB](https://msdn.microsoft.com/library/aa752117.aspx) Windows SDK 中。

##  <a name="getaddressbar"></a>  CHtmlView::GetAddressBar

调用此成员函数以检索 Internet Explorer 地址栏中。

```
BOOL GetAddressBar() const;
```

### <a name="return-value"></a>返回值

在地址栏是否可见，则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="getapplication"></a>  CHtmlView::GetApplication

调用此成员函数以检索包含 WebBrowser 控件的应用程序支持的自动化对象。

```
LPDISPATCH GetApplication() const;
```

### <a name="return-value"></a>返回值

一个指向`IDispatch`活动文档对象的接口。 有关更多信息，请参见 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getbusy"></a>  CHtmlView::GetBusy

调用此成员函数以确定是否将 WebBrowser 控件处于导航或下载操作。

```
BOOL GetBusy() const;
```

### <a name="return-value"></a>返回值

如果 web 浏览器正忙; 非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getcontainer"></a>  CHtmlView::GetContainer

调用此成员函数以检索对象的计算结果为的容器的 web 浏览器。

```
LPDISPATCH GetContainer() const;
```

### <a name="return-value"></a>返回值

一个指向`IDispatch`活动文档对象的接口。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getfullname"></a>  CHtmlView::GetFullName

调用此成员函数以检索当前正在显示 Internet Explorer 的文件的完整路径。

```
CString GetFullName() const;
```

### <a name="return-value"></a>返回值

一个[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象，其中包含的路径和当前显示的文件的名称。 如果不存在任何路径和文件名，`GetFullName`返回一个空`CString`。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="getfullscreen"></a>  CHtmlView::GetFullScreen

调用此成员函数来确定是否在全屏幕模式下或在正常窗口模式下运行 web 浏览器控件。

```
BOOL GetFullScreen() const;
```

### <a name="return-value"></a>返回值

如果 web 浏览器在全屏幕模式，则非零值否则为零。

### <a name="remarks"></a>备注

在全屏幕模式下，Internet Explorer 主窗口最大化和隐藏状态栏、 工具栏、 菜单栏和标题栏。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getheight"></a>  CHtmlView::GetHeight

调用此成员函数可检索的高度，以像素为单位 WebBrowser 控件的框架窗口。

```
long GetHeight() const;
```

### <a name="return-value"></a>返回值

控件的框架窗口高度，以像素为单位。

##  <a name="gethtmldocument"></a>  CHtmlView::GetHtmlDocument

调用此成员函数以检索活动文档的 HTML 文档。

```
LPDISPATCH GetHtmlDocument() const;
```

### <a name="return-value"></a>返回值

一个指向`IDispatch`活动文档对象的接口。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getleft"></a>  CHtmlView::GetLeft

调用此成员函数以检索 WebBrowser 控件的内部左边的缘与其容器左边的缘之间的距离。

```
long GetLeft() const;
```

### <a name="return-value"></a>返回值

左边缘的距离，以像素为单位。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getlocationname"></a>  CHtmlView::GetLocationName

调用此成员函数以获取要在 webbrowser 控件中显示的资源的名称。

```
CString GetLocationName() const;
```

### <a name="return-value"></a>返回值

一个[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象，其中包含当前在 webbrowser 控件中显示的资源的名称。

### <a name="remarks"></a>备注

如果资源是在万维网上的 HTML 页面，名称为该页面的标题。 如果文件夹或网络或本地计算机上的文件，该资源，名称为的 UNC 或文件夹或文件的完整路径。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getlocationurl"></a>  CHtmlView::GetLocationURL

调用此成员函数以检索 WebBrowser 控件当前显示的资源的 URL。

```
CString GetLocationURL() const;
```

### <a name="return-value"></a>返回值

一个[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象，其中包含当前在 webbrowser 控件中显示的资源的 URL。

### <a name="remarks"></a>备注

如果文件夹或网络或本地计算机上的文件，该资源，名称为的 UNC 或文件夹或文件的完整路径。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getmenubar"></a>  CHtmlView::GetMenuBar

调用此成员函数可确定菜单栏是否可见。

```
BOOL GetMenuBar() const;
```

### <a name="return-value"></a>返回值

在菜单栏是否可见，则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getoffline"></a>  CHtmlView::GetOffline

调用此成员函数来确定是否脱机运行的 web 浏览器。

```
BOOL GetOffline() const;
```

### <a name="return-value"></a>返回值

Web 浏览器当前处于脱机状态; 如果非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getparentbrowser"></a>  CHtmlView::GetParentBrowser

调用此成员函数以检索指向 WebBrowser 控件的父对象的指针。

```
LPDISPATCH GetParentBrowser() const;
```

### <a name="return-value"></a>返回值

一个指向`IDispatch`WebBrowser 控件的父对象的接口。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getproperty"></a>  CHtmlView::GetProperty

调用此成员函数可获取当前与该控件关联的属性的值。

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>参数

*lpszProperty*<br/>
指向包含要检索的属性的字符串的指针。

*strValue*<br/>
对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象，它接收的属性的当前值。

### <a name="return-value"></a>返回值

在第一个版本中，非零，如果成功地完成。否则为零。 在第二个版本中， [COleVariant](../../mfc/reference/colevariant-class.md)对象。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getreadystate"></a>  CHtmlView::GetReadyState

调用此成员函数以检索 web 浏览器对象的就绪状态。

```
READYSTATE GetReadyState() const;
```

### <a name="return-value"></a>返回值

一个[READYSTATE](https://msdn.microsoft.com/library/aa768362.aspx)值，如 Windows SDK 中所述。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getregisterasbrowser"></a>  CHtmlView::GetRegisterAsBrowser

调用此成员函数以确定是否将 WebBrowser 对象注册为目标名称解析的顶级浏览器。

```
BOOL GetRegisterAsBrowser() const;
```

### <a name="return-value"></a>返回值

如果浏览器已注册的顶级浏览器; 为非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getregisterasdroptarget"></a>  CHtmlView::GetRegisterAsDropTarget

调用此成员函数以确定是否将 WebBrowser 控件注册为导航的放置目标。

```
BOOL GetRegisterAsDropTarget() const;
```

### <a name="return-value"></a>返回值

如果浏览器注册为放置目标; 非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getsilent"></a>  CHtmlView::GetSilent

调用此成员函数以确定是否可以在 web 浏览器控件中显示任何对话框。

```
BOOL GetSilent() const;
```

### <a name="return-value"></a>返回值

如果对话框不能从 web 浏览器控件中; 显示非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getsource"></a>  CHtmlView::GetSource

调用此成员函数以检索 web 页的 HTML 源代码。

```
BOOL GetSource(CString& strRef);
```

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="parameters"></a>参数

*refString*<br/>
一个[CString](../../atl-mfc-shared/reference/cstringt-class.md) ，将存放的源代码。

### <a name="remarks"></a>备注

此函数是与 Internet Explorer 中的"查看源文件"命令等效，只不过中返回的源代码`CString`。

##  <a name="getstatusbar"></a>  CHtmlView::GetStatusBar

调用此成员函数以确定是否将 WebBrowser 控件显示一个状态栏。

```
BOOL GetStatusBar() const;
```

### <a name="return-value"></a>返回值

如果可以显示状态栏，则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="gettheatermode"></a>  CHtmlView::GetTheaterMode

调用此成员函数以确定 web 浏览器是否处于影院模式。

```
BOOL GetTheaterMode() const;
```

### <a name="return-value"></a>返回值

Web 浏览器是否处于影院模式，则为非零值否则为零。

### <a name="remarks"></a>备注

影院模式 web 浏览器时，浏览器主窗口将填充整个屏幕，会出现带有导航工具的最小集一个工具栏，和状态栏显示在屏幕右上角中。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="gettoolbar"></a>  CHtmlView::GetToolBar

调用此成员函数以确定工具栏是否可见。

```
int GetToolBar() const;
```

### <a name="return-value"></a>返回值

一个值，该值指示工具栏是否可见。 如果工具栏可见，则非零值否则为零。

##  <a name="gettop"></a>  CHtmlView::GetTop

调用此成员函数以检索 WebBrowser 控件的主窗口上边缘的屏幕坐标。

```
long GetTop() const;
```

### <a name="return-value"></a>返回值

一个变量来接收主窗口上边缘的屏幕坐标的地址。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="gettoplevelcontainer"></a>  CHtmlView::GetTopLevelContainer

调用此成员函数以确定 Internet Explorer 是否为 WebBrowser 控件的顶级容器。

```
BOOL GetTopLevelContainer() const;
```

### <a name="return-value"></a>返回值

非零值的容器是顶级容器;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="gettype"></a>  CHtmlView::GetType

调用此成员函数以检索包含活动文档的类型名称。

```
CString GetType() const;
```

### <a name="return-value"></a>返回值

一个[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象，其中包含所包含的活动文档的类型名称。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getvisible"></a>  CHtmlView::GetVisible

调用此成员函数以确定包含的对象是否可见。

```
BOOL GetVisible() const;
```

### <a name="return-value"></a>返回值

如果对象是可见的则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="getwidth"></a>  CHtmlView::GetWidth

检索 Internet Explorer 主窗口的宽度。

```
long GetWidth() const;
```

### <a name="return-value"></a>返回值

当前窗口，以像素为单位的宽度。

##  <a name="goback"></a>  CHtmlView::GoBack

导航历史记录列表中的向后一个项。

```
void GoBack();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="goforward"></a>  CHtmlView::GoForward

导航历史记录列表中的正向一个项。

```
void GoForward();
```

##  <a name="gohome"></a>  CHtmlView::GoHome

导航到当前主页，或者启动“Internet Explorer Internet 选项”对话框或“Internet 属性”对话框（可从“控制面板”访问）中指定的网页。

```
void GoHome();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="gosearch"></a>  CHtmlView::GoSearch

导航到当前搜索页中 Internet Explorer Internet 选项对话框或 Internet 属性对话框中，指定从控制面板访问。

```
void GoSearch();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="loadfromresource"></a>  CHtmlView::LoadFromResource

调用此成员函数以指定的资源加载到 WebBrowser 控件。

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### <a name="parameters"></a>参数

*lpszResource*<br/>
指向包含要加载的资源名称的字符串的指针。

*nRes*<br/>
要加载包含资源的名称的缓冲区的 ID。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="navigate"></a>  CHtmlView::Navigate

调用此成员函数以导航至由 URL 标识的资源。

```
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### <a name="parameters"></a>参数

*URL*<br/>
包含要导航到的 URL 的调用方分配的字符串或要显示的文件的完整路径。

*dwFlags*<br/>
用于指定是否要将资源添加到历史记录列表、 是否读取或写入从缓存中，以及是否要在新窗口中显示该资源的变量的标志。 可以将变量定义的值的组合[BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))枚举。

*lpszTargetFrameName*<br/>
指向包含要在其中显示资源框架的名称的字符串的指针。

*lpszHeaders*<br/>
指向一个值，指定要向服务器发送的 HTTP 标头的指针。 这些标头添加到默认的 Internet Explorer 标头中。 标头可以指定为服务器传递到服务器或状态代码的数据类型的所需的操作等内容。 如果忽略此参数*URL*不是 HTTP URL。

*lpvPostData*<br/>
指向要使用 HTTP POST 事务发送的数据的指针。 例如，POST 事务用于发送 HTML 窗体收集数据。 如果此参数未指定发送的所有数据，`Navigate`发出 HTTP GET 的事务。 如果忽略此参数*URL*不是 HTTP URL。

*dwPostDataLen*<br/>
若要使用 HTTP POST 事务发送的数据。 例如，POST 事务用于发送 HTML 窗体收集数据。 如果此参数未指定发送的所有数据，`Navigate`发出 HTTP GET 的事务。 如果忽略此参数*URL*不是 HTTP URL。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="navigate2"></a>  CHtmlView::Navigate2

调用此成员函数以导航至由 URL 标识的资源或完整路径标识的文件。

```
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### <a name="parameters"></a>参数

*pIDL*<br/>
一个指向[ITEMIDLIST](/windows/desktop/api/shtypes/ns-shtypes-_itemidlist)结构。

*dwFlags*<br/>
用于指定是否要将资源添加到历史记录列表、 是否读取或写入从缓存中，以及是否要在新窗口中显示该资源的变量的标志。 可以将变量定义的值的组合[BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))枚举。

*lpszTargetFrameName*<br/>
指向包含要在其中显示资源框架的名称的字符串的指针。

*lpszURL*<br/>
指向包含 URL 的字符串的指针。

*lpvPostData*<br/>
若要使用 HTTP POST 事务发送的数据。 例如，POST 事务用于发送 HTML 窗体收集数据。 如果此参数未指定发送的所有数据，`Navigate2`发出 HTTP GET 的事务。 如果忽略此参数*URL*不是 HTTP 或 HTTPS URL。

*dwPostDataLen*<br/>
指向以字节为单位的数据的长度*lpvPostData*参数。

*lpszHeaders*<br/>
指向一个值，指定要向服务器发送的 HTTP 或 HTTPS 标头的指针。 这些标头添加到默认的 Internet Explorer 标头中。 标头可以指定为服务器传递到服务器或状态代码的数据类型的所需的操作等内容。 如果忽略此参数*URL*不是 HTTP 或 HTTPS URL。

*baPostedData*<br/>
对引用[CByteArray](../../mfc/reference/cbytearray-class.md)对象。

### <a name="remarks"></a>备注

此成员函数可能延长`Navigate`通过支持在桌面和我的电脑等特殊文件夹由参数表示上进行浏览的成员函数*pIDL*。

适用于 Internet Explorer 和 WebBrowser。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

##  <a name="onbeforenavigate2"></a>  CHtmlView::OnBeforeNavigate2

此成员函数由框架事件触发 web 浏览器中发生导航之前调用。

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### <a name="parameters"></a>参数

*lpszURL*<br/>
包含要导航到的 URL 的字符串指针。

*nFlags*<br/>
留待将来使用。

*lpszTargetFrameName*<br/>
一个字符串，包含在其中显示资源，或如果没有命名的框架为目标的资源，则为 NULL 的框架的名称。

*baPostedData*<br/>
对引用`CByteArray`对象，其中包含要发送到服务器，如果正在使用 HTTP POST 事务的数据。

*lpszHeaders*<br/>
指向包含附加 HTTP 标头将发送到服务器 (仅 HTTP Url) 的字符串的指针。 标头可以指定为服务器传递到服务器或状态代码的数据类型的所需的操作等内容。

*pbCancel*<br/>
指向取消标志的指针。 应用程序可以将此参数设置为非零值以取消导航的操作，或为零，使其可以继续操作。

##  <a name="oncommandstatechange"></a>  CHtmlView::OnCommandStateChange

由框架，以通知应用程序的 web 浏览器命令的启用的状态已更改调用此成员函数。

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### <a name="parameters"></a>参数

*nCommand*<br/>
命令的启用的状态已更改的标识符。

*bEnable*<br/>
已启用的状态。 如果该命令已启用，或者如果它处于禁用状态，则零，则此参数为非零值。

##  <a name="ondocumentcomplete"></a>  CHtmlView::OnDocumentComplete

由框架，以通知应用程序文档已到达 READYSTATE_COMPLETE 状态调用此成员函数。

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### <a name="parameters"></a>参数

*lpszURL*<br/>
指向字符串的计算结果为 URL、 UNC 文件名称，或导航到的 PIDL （的项标识符列表的指针）。

### <a name="remarks"></a>备注

不是每个帧将触发此事件，但将触发的每个帧[OnDownloadBegin](#ondownloadbegin)事件将激发相应`OnDocumentComplete`事件。

URL 指示*lpszURL*可以不同于在浏览器被告知要导航到，因为此 URL 是规范化和限定的 URL 的 URL。 例如，如果应用程序指定"www.microsoft.com"的调用中到的 URL [Navigate](#navigate)或[Navigate2](#navigate2)，通过传递 URL`OnNavigateComplete2`将为"<http://www.microsoft.com/>"。 此外，如果服务器具有定向到不同的 URL 的浏览器，重定向的 URL 将会反映在此处。

##  <a name="ondocwindowactivate"></a>  CHtmlView::OnDocWindowActivate

从 Internet Explorer 或 MSHTML 实现调用`IOleInPlaceActiveObject::OnDocWindowActivate`，这会激活或停用容器文件窗口时通知活动的就地对象。

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>参数

*fActivate*<br/>
指示文档窗口的状态。 如果此值不为零，正在激活窗口。 如果此值为零，窗口将被停用。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

重写`OnDocWindowActivate`来应对`OnDocWindowActivate`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::OnDocWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="ondownloadbegin"></a>  CHtmlView::OnDownloadBegin

若要开始下载文档的框架由调用此成员函数。

```
virtual void OnDownloadBegin();
```

### <a name="remarks"></a>备注

此事件触发后不久[OnBeforeNavigate2](#onbeforenavigate2)事件，除非取消的导航。 任何动画或需要显示容器的"忙"指示应连接到此事件。

##  <a name="ondownloadcomplete"></a>  CHtmlView::OnDownloadComplete

此成员函数调用由框架以指示导航操作完成、 已暂停或失败。

```
virtual void OnDownloadComplete();
```

##  <a name="onenablemodeless"></a>  CHtmlView::OnEnableModeless

当 Internet Explorer 或 MSHTML 显示模式 UI 时调用。

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### <a name="parameters"></a>参数

*fEnable*<br/>
指示是否启用或禁用主机的无模式对话框。 如果此值不为零，则会启用无模式对话框。 如果此值为零，将禁用无模式对话框。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

启用或禁用无模式对话框时容器创建或销毁模式对话框。 重写`OnEnableModeless`来应对`EnableModeless`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::EnableModeless](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onfilterdataobject"></a>  CHtmlView::OnFilterDataObject

由 Internet Explorer 或 MSHTML 对主机调用，以允许主机替换 Internet Explorer 或 MSHTML 的数据对象。

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
地址[IDataObject](/windows/desktop/api/objidl/nn-objidl-idataobject)由 Internet Explorer 或 MSHTML 提供的接口。

*ppDataObject*<br/>
接收地址`IDataObject`由宿主提供的接口指针。 即使该方法将失败，则始终应为 NULL，初始化该参数的内容。

### <a name="return-value"></a>返回值

如果数据对象被替换，则为 S_OK、 S_FALSE 如果数据对象不会被替换或如果发生错误的 OLE 定义的错误代码。

### <a name="remarks"></a>备注

重写`OnFilterDataObject`来应对`FilterDataObject`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::FilterDataObject](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onframewindowactivate"></a>  CHtmlView::OnFrameWindowActivate

从 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 调用以在容器的顶级框架窗口被激活或停用时通知对象。

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>参数

*fActivate*<br/>
指示容器的顶级框架窗口的状态。 如果此值不为零，正在激活窗口。 如果此值为零，窗口将被停用。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

重写`OnFrameWindowActivate`来应对`OnFrameWindowActivate`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::OnFrameWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onfullscreen"></a>  CHtmlView::OnFullScreen

由框架调用此成员函数时[全屏](https://msdn.microsoft.com/library/aa752119.aspx)属性已更改。

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### <a name="parameters"></a>参数

*bFullScreen*<br/>
如果 Internet 资源管理器处于全屏幕模式，则非零值否则为零。

##  <a name="ongetdroptarget"></a>  CHtmlView::OnGetDropTarget

当用作放置目标时由 Internet Explorer 或 MSHTML 调用以允许主机提供替代的 `IDropTarget`。

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### <a name="parameters"></a>参数

*pDropTarget*<br/>
[IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) Internet Explorer 或 MSHTML 提出建议使用。

*ppDropTarget*<br/>
地址`IDropTarget`，它接收`IDropTarget`宿主希望提供的接口指针。

### <a name="return-value"></a>返回值

请参阅[IDocHostUIHandler::GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) Windows SDK for 返回代码的列表中。

### <a name="remarks"></a>备注

重写`OnGetDropTarget`来应对`GetDropTarget`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="ongetexternal"></a>  CHtmlView::OnGetExternal

由 Internet Explorer 或 MSHTML 调用以获取主机的 `IDispatch` 接口。

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### <a name="parameters"></a>参数

*lppDispatch*<br/>
指向接收的地址的指针`IDispatch`主机应用程序的接口指针。 如果主机公开自动化接口，它可以提供 Internet Explorer 或 MSHTML 对通过此参数的引用。 即使该方法将失败，则始终应为 NULL，初始化该参数的内容。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

重写`OnGetExternal`来应对`GetExternal`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::GetExternal](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="ongethostinfo"></a>  CHtmlView::OnGetHostInfo

检索 Internet Explorer 或 MSHTML 主机的用户界面功能。

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### <a name="parameters"></a>参数

*pInfo*<br/>
地址[DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\))接收主机的 UI 功能的结构。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

重写`OnGetHostInfo`来应对`GetHostInfo`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::GetHostInfo](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="ongetoptionkeypath"></a>  CHtmlView::OnGetOptionKeyPath

调用此成员函数可获取 Internet Explorer 或 MSHTML 在其下存储用户首选项的注册表项。

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### <a name="parameters"></a>参数

*pchKey*<br/>
地址`LPOLESTR`接收主机存储其默认选项的位置的注册表子项的字符串。 此子项将在 HKEY_CURRENT_USER 键下。 使用此内存分配[CoTaskMemAlloc](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc)。 调用应用程序负责释放此内存使用[CoTaskMemFree](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree)。 即使该方法将失败，则始终应为 NULL 时，初始化此参数。

*dwReserved*<br/>
留待将来使用。 当前未使用。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或否则为 S_FALSE。 如果 S_FALSE、 Internet Explorer 或 MSHTML 将默认为自己的用户选项。

### <a name="remarks"></a>备注

重写`OnGetOptionKeyPath`来应对`GetOptionKeyPath`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::GetOptionKeyPath](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onhideui"></a>  CHtmlView::OnHideUI

当 Internet Explorer 或 MSHTML 删除其菜单和工具栏时，由框架调用此成员函数。

```
virtual HRESULT OnHideUI();
```

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

重写`OnHideUI`来应对`HideUI`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::HideUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onmenubar"></a>  CHtmlView::OnMenuBar

由框架调用此成员函数时[菜单栏](https://msdn.microsoft.com/library/aa752131.aspx)属性已更改。

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### <a name="parameters"></a>参数

*bMenuBar*<br/>
Internet 资源管理器菜单栏是否可见，则非零值否则为零。

##  <a name="onnavigatecomplete2"></a>  CHtmlView::OnNavigateComplete2

（在窗口或框架集元素上） 完成到超链接的导航后，由框架调用此成员函数。

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### <a name="parameters"></a>参数

*strURL*<br/>
字符串表达式的计算结果为 URL、 UNC 文件名称或导航到的 PIDL （的项标识符列表的指针）。

### <a name="remarks"></a>备注

URL 参数可以是在没有任何 URL 表示形式的命令行程序名称空间实体的情况下 PIDL。

请注意，在 URL 中包含*strURL*可以不同于在浏览器被告知要导航到，因为此 URL 是规范化和限定的 URL 的 URL。 例如，如果应用程序指定"www.microsoft.com"的调用中到的 URL [Navigate](#navigate)或[Navigate2](#navigate2)，通过传递 URL`OnNavigateComplete2`将为"<http://www.microsoft.com/>"。 此外，如果服务器具有定向到不同的 URL 的浏览器，重定向的 URL 将会反映在此处。

##  <a name="onnavigateerror"></a>  CHtmlView::OnNavigateError

当导航到超链接失败时由框架调用。

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### <a name="parameters"></a>参数

*lpszURL*<br/>
URL 为其导航失败。

*lpszFrame*<br/>
框架资源将会显示，或者，如果没有命名的帧的目标资源的名称。

*dwError*<br/>
错误状态代码，如果可用。 有关可能的 HRESULT 和 HTTP 状态代码的列表，请参阅[如何事件状态代码。](https://msdn.microsoft.com/library/aa768365.aspx)

*pbCancel*<br/>
指定是否取消导航到错误页或任何进一步的自动搜索。 如果 TRUE （默认值），请继续导航到错误页或自动搜索;如果为 FALSE，则取消导航到错误页或自动搜索。

### <a name="remarks"></a>备注

重写此方法以提供自定义导航的错误处理。

有关详细信息，请参阅[DWebBrowserEvents2::NavigateError](https://msdn.microsoft.com/library/aa768286.aspx)

##  <a name="onnewwindow2"></a>  CHtmlView::OnNewWindow2

当新窗口以显示资源创建时，由框架调用此成员函数。

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### <a name="parameters"></a>参数

*ppDisp*<br/>
（可选） 接收的接口指针指向的指针`IDispatch`新的 web 浏览器或 Internet Explorer 对象的接口指针。

*取消*<br/>
指向取消标志的指针。 应用程序可以将此参数设置为非零值以取消导航的操作，或为零，使其可以继续操作。

### <a name="remarks"></a>备注

此事件之前创建的 web 浏览器从一个新窗口。

##  <a name="onprogresschange"></a>  CHtmlView::OnProgressChange

此成员函数调用由框架以通知应用已更新的下载操作的进度。

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### <a name="parameters"></a>参数

*nProgress*<br/>
显示，则为-1 时进度已完成的总进度的量。

*nProgressMax*<br/>
最大的进度值。

### <a name="remarks"></a>备注

若要显示到目前为止下载的字节数，或若要更新进度指示器，容器可以使用此事件提供的信息。

##  <a name="onpropertychange"></a>  CHtmlView::OnPropertyChange

由框架以通知应用程序调用此成员函数的[PutProperty](#putproperty)已更改属性的值。

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>参数

*lpszProperty*<br/>
指向包含的属性名称的字符串的指针。

##  <a name="onquit"></a>  CHtmlView::OnQuit

由框架，以通知应用程序已准备退出 Internet Explorer 应用程序调用此成员函数。

```
virtual void OnQuit();
```

##  <a name="onresizeborder"></a>  CHtmlView::OnResizeBorder

从 [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)的 Internet Explorer 或 MSHTML 实现调用，该操作警告对象需要重新调整其边框空间的大小。

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### <a name="parameters"></a>参数

*prcBorder*<br/>
边框空间的新外部矩形。

*pUIWindow*<br/>
指向已更改其边框的框架或文档窗口对象的接口的指针。

*fFrameWindow*<br/>
如果框架窗口正在调用则为 TRUE [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)，否则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

重写`OnResizeBorder`来应对`ResizeBorder`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::ResizeBorder](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onshowcontextmenu"></a>  CHtmlView::OnShowContextMenu

当 Internet Explorer 或 MSHTML 将要显示其上下文菜单时，从其调用。

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### <a name="parameters"></a>参数

*dwID*<br/>
若要显示的上下文菜单的标识符。 请参阅`IDocHostUIHandler::ShowContextMenu`Windows SDK for 值的列表中。

*ppt*<br/>
在菜单的屏幕坐标。

*pcmdtReserved*<br/>
[IOleCommandTarget](/windows/desktop/api/docobj/nn-docobj-iolecommandtarget)接口用来查询命令状态和在此对象上执行命令。

*pdispReserved*<br/>
屏幕坐标处的对象的 IDispatch 接口。 这使宿主可以区分要提供更具体的上下文的特定对象。

### <a name="return-value"></a>返回值

请参阅[IDocHostUIHandler::ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) Windows SDK for 值的列表中。

### <a name="remarks"></a>备注

重写`OnShowContextMenu`来应对`ShowContextMenu`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onshowui"></a>  CHtmlView::OnShowUI

在 Internet Explorer 或 MSHTML 显示其菜单和工具栏之前调用。

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### <a name="parameters"></a>参数

*dwID*<br/>
留待将来使用。

*pActiveObject*<br/>
[IOleInPlaceActiveObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceactiveobject)当前处于活动状态的对象的接口。

*pCommandTarget*<br/>
[IOleCommandTarget](/windows/desktop/api/docobj/nn-docobj-iolecommandtarget)对象的接口。

*pFrame*<br/>
[IOleInPlaceFrame](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceframe)对象的接口。 这是所需的菜单和工具栏。

*pDoc*<br/>
[IOleInPlaceUIWindow](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceuiwindow)对象接口。 这是所需的工具栏。

### <a name="return-value"></a>返回值

请参阅[IDocHostUIHandler::ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) Windows SDK for 值的列表中。

### <a name="remarks"></a>备注

重写`OnShowUI`来应对`ShowUI`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onstatusbar"></a>  CHtmlView::OnStatusBar

由框架调用此成员函数时[StatusBar](https://msdn.microsoft.com/library/aa768270.aspx)属性已更改。

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### <a name="parameters"></a>参数

*bStatusBar*<br/>
如果 Internet Explorer 的状态栏是否可见，非零值则否则为零。

##  <a name="onstatustextchange"></a>  CHtmlView::OnStatusTextChange

由框架，以通知应用程序与 WebBrowser 控件相关联的状态栏的文本更改后调用此成员函数。

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
包含新的状态栏文本的字符串。

##  <a name="ontheatermode"></a>  CHtmlView::OnTheaterMode

由框架调用此成员函数时[TheaterMode](https://msdn.microsoft.com/library/aa768273.aspx)属性已更改。

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### <a name="parameters"></a>参数

*bTheaterMode*<br/>
Internet Explorer 是否处于影院模式，则为非零值否则为零。

##  <a name="ontitlechange"></a>  CHtmlView::OnTitleChange

此成员函数调用的框架，以便在 WebBrowser 控件中的文档的标题将变为可用时通知应用程序或更改。

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
新的文档标题。

### <a name="remarks"></a>备注

适用于 HTML、 标题可能会更改;虽然仍在下载 HTML，文档的 URL 设置为标题。 实际的标题 （如果有） 通过分析得到 HTML 后，标题会更改以反映实际的标题。

##  <a name="ontoolbar"></a>  CHtmlView::OnToolBar

由框架调用此成员函数时[工具栏](https://msdn.microsoft.com/library/aa768274.aspx)属性已更改。

```
virtual void OnToolBar(BOOL bToolBar);
```

### <a name="parameters"></a>参数

*bToolBar*<br/>
如果 Internet Explorer 工具栏可见，则非零则否则为零。

##  <a name="ontranslateaccelerator"></a>  CHtmlView::OnTranslateAccelerator

当调用 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/desktop/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 以处理来自容器消息队列的菜单快捷键消息时由 Internet Explorer 或 MSHTML 调用。

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### <a name="parameters"></a>参数

*lpMsg*<br/>
指向可能需要转换该消息。

*pguidCmdGroup*<br/>
命令组标识符。

*nCmdID*<br/>
命令标识符。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或否则为 S_FALSE。

### <a name="remarks"></a>备注

重写`OnTranslateAccelerator`来应对`TranslateAccelerator`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::TranslateAccelerator](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="ontranslateurl"></a>  CHtmlView::OnTranslateUrl

由 Internet Explorer 或 MSHTML 调用以允许主机有机会修改要加载的 URL。

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### <a name="parameters"></a>参数

*dwTranslate*<br/>
留待将来使用。

*pchURLIn*<br/>
提供由 Internet Explorer 或 MSHTML，表示要转换的 URL 的字符串的地址。

*ppchURLOut*<br/>
接收已翻译的 URL 地址的字符串指针的地址。 主机分配的缓冲区，使用任务内存分配器。 即使不会转换 URL 或该方法将失败，则始终应为 NULL，初始化此参数的内容。

### <a name="return-value"></a>返回值

`S_OK` 如果 URL 是转换，如果不转换 URL，S_FALSE 或 OLE 定义的错误代码如果出现错误。

### <a name="remarks"></a>备注

重写`OnTranslateUrl`来应对`TranslateUrl`从 Microsoft Web 浏览器控件的通知。 请参阅[IDocHostUIHandler::TranslateUrl](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) Windows SDK for 的详细信息中。

##  <a name="onupdateui"></a>  CHtmlView::OnUpdateUI

通知主机命令状态已更改。

```
virtual HRESULT OnUpdateUI();
```

### <a name="return-value"></a>返回值

如果成功，则为 S_OK 或 OLE 定义的错误代码，否则为。

### <a name="remarks"></a>备注

主机应更新工具栏按钮的状态。 无论从返回的值调用此方法`ShowUI`。 重写`OnUpdateUI`来应对`UpdateUI`从 Microsoft Web 浏览器控件的通知。

##  <a name="onvisible"></a>  CHtmlView::OnVisible

当 webbrowser 控件中的窗口应显示还是隐藏时，由框架调用此成员函数。

```
virtual void OnVisible(BOOL bVisible);
```

### <a name="parameters"></a>参数

*bVisible*<br/>
如果对象是可见的非零则否则为零。

### <a name="remarks"></a>备注

这允许对象控制主机窗口的行为的方式与 Internet Explorer 窗口的表现相同。

##  <a name="putproperty"></a>  CHtmlView::PutProperty

调用此成员函数可设置与给定对象关联的属性。

```
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### <a name="parameters"></a>参数

*lpszProperty*<br/>
包含要设置的属性的字符串。

*vtValue*<br/>
属性的新值为由*lpszProperty*。

*lpszPropertyName*<br/>
指向包含要设置的属性名称的字符串的指针。

*dValue*<br/>
属性的新值。

*lValue*<br/>
属性的新值。

*lpszValue*<br/>
指向包含该属性的新值的字符串的指针。

*nValue*<br/>
属性的新值。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="queryformscommand"></a>  CHtmlView::QueryFormsCommand

查询由用户界面事件生成的一个或多个命令的状态。

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### <a name="parameters"></a>参数

*dwCommandID*<br/>
对其进行查询的命令标识符。

*pbSupported*<br/>
指向布尔值，指定如果该命令 (由标识*dwCommandID*) 支持。 如果为 TRUE，则支持该命令;否则为 FALSE。

*pbEnabled*<br/>
指向布尔值，指定如果该命令 (由标识*dwCommandID*) 已启用。 如果为 TRUE，则支持该命令;否则为 FALSE。

*pbChecked*<br/>
指向布尔值，指定如果该命令 (由标识*dwCommandID*) 已选中。 如果为 TRUE，则支持该命令;否则为 FALSE。

### <a name="return-value"></a>返回值

标准的 HRESULT 值。 有关可能的值的完整列表，请参阅[IOleCommandTarget::QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus) Windows SDK 中。

### <a name="remarks"></a>备注

`QueryFormsCommand` 实现的行为[IOleCommandTarget::QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法。

##  <a name="querystatuswb"></a>  CHtmlView::QueryStatusWB

调用此成员函数以查询命令状态。

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### <a name="parameters"></a>参数

*cmdID*<br/>
[OLECMDID](/windows/desktop/api/docobj/ne-docobj-olecmdid)调用方需要状态信息的命令的值。

### <a name="return-value"></a>返回值

地址[OLECMDF](/windows/desktop/api/docobj/ne-docobj-olecmdf)接收命令的状态的值。

### <a name="remarks"></a>备注

`QueryStatusWB` 实现的行为[IOleCommandTarget::QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="refresh"></a>  CHtmlView::Refresh

重新加载 URL 或 web 浏览器当前正在显示的文件。

```
void Refresh();
```

### <a name="remarks"></a>备注

`Refresh` 不包含用于设置刷新级别的任何参数。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="refresh2"></a>  CHtmlView::Refresh2

重新加载当前显示 Internet Explorer 的文件。

```
void Refresh2(int nLevel);
```

### <a name="parameters"></a>参数

*nLevel*<br/>
指定刷新级别变量的地址。 可能的变量中定义[RefreshConstants](https://msdn.microsoft.com/library/aa768363.aspx)，Windows SDK 中。

### <a name="remarks"></a>备注

与不同[刷新](#refresh)，`Refresh2`包含一个参数，指定刷新级别。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setaddressbar"></a>  CHtmlView::SetAddressBar

调用此成员函数以显示或隐藏 Internet Explorer 对象的地址栏。

```
void SetAddressBar(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
非零值，显示地址栏;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="setfullscreen"></a>  CHtmlView::SetFullScreen

调用此成员函数将 Internet Explorer 设置为任何一种全屏幕或正常窗口模式。

```
void SetFullScreen(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
全屏幕模式，则为非零值否则为零。

### <a name="remarks"></a>备注

在全屏幕模式下，Internet Explorer 主窗口最大化和隐藏状态栏、 工具栏、 菜单栏和标题栏。

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="setheight"></a>  CHtmlView::SetHeight

调用此成员函数可设置 Internet Explorer 主窗口的高度。

```
void SetHeight(long nNewValue);
```

### <a name="parameters"></a>参数

*nNewValue*<br/>
以像素为单位，在主窗口的高度。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setleft"></a>  CHtmlView::SetLeft

设置 Internet Explorer 主窗口的水平位置。

```
void SetLeft(long nNewValue);
```

### <a name="parameters"></a>参数

*nNewValue*<br/>
主窗口的左边缘屏幕坐标。

##  <a name="setmenubar"></a>  CHtmlView::SetMenuBar

调用此成员函数以显示或隐藏 Internet Explorer 菜单栏。

```
void SetMenuBar(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
非零值，显示菜单栏。否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="setoffline"></a>  CHtmlView::SetOffline

调用此成员函数可设置一个值，该值指示 WebBrowser 控件当前在脱机模式下运行。

```
void SetOffline(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
非零值，从本地缓存; 读取否则为零。

### <a name="remarks"></a>备注

在脱机模式下，在浏览器中从本地缓存而不是源文档中读取 HTML 页面。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setregisterasbrowser"></a>  CHtmlView::SetRegisterAsBrowser

调用此成员函数可设置一个值，该值指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。

```
void SetRegisterAsBrowser(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
确定是否为顶级浏览器注册 Internet 资源管理器。 如果非零，web 浏览器注册为顶级浏览器;如果为零，它不是顶层浏览器。 默认值为 0。

### <a name="remarks"></a>备注

顶层浏览器是作为默认浏览器在注册表中设置浏览器。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setregisterasdroptarget"></a>  CHtmlView::SetRegisterAsDropTarget

调用此成员函数可设置一个值，该值指示是否将 WebBrowser 控件注册为导航的放置目标。

```
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
确定是否 WebBrowser 控件注册为导航的放置目标。 如果非零，将对象注册为放置目标;如果为零，它不是拖放目标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setsilent"></a>  CHtmlView::SetSilent

调用此成员函数可设置一个值，该值指示是否可以显示任何对话框。

```
void SetSilent(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
如果非零，将不会显示对话框;如果为零，将显示对话框。 默认值为 0。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setstatusbar"></a>  CHtmlView::SetStatusBar

调用此成员函数以显示状态栏。

```
void SetStatusBar(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
状态栏是否可见，则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="settheatermode"></a>  CHtmlView::SetTheaterMode

调用此成员函数可设置一个值，该值指示 WebBrowser 控件是否处于影院模式。

```
void SetTheaterMode(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
非零值，设置 WebBrowser 控件为影院模式;否则为零。 默认值为 0。

### <a name="remarks"></a>备注

影院模式 web 浏览器时，浏览器主窗口将填充整个屏幕，会出现带有导航工具的最小集一个工具栏，和状态栏显示在屏幕右上角中。

适用于 Internet Explorer 和 WebBrowser。

##  <a name="settoolbar"></a>  CHtmlView::SetToolBar

调用此成员函数以显示或隐藏 Internet Explorer 工具栏。

```
void SetToolBar(int nNewValue);
```

### <a name="parameters"></a>参数

*nNewValue*<br/>
指示是否显示工具栏。 如果工具栏将显示，则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果使用 WebBrowser 控件使用此调用，它将返回没有错误，但它将忽略此调用。

##  <a name="settop"></a>  CHtmlView::SetTop

调用此成员函数可设置 WebBrowser 控件的内部上边缘与其容器上的边缘之间的距离

```
void SetTop(long nNewValue);
```

### <a name="parameters"></a>参数

*nNewValue*<br/>
主窗口上边缘的屏幕坐标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setvisible"></a>  CHtmlView::SetVisible

调用此成员函数可设置 WebBrowser 控件的可见性状态。

```
void SetVisible(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*bNewValue*<br/>
如果控件可见，则非零值否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

##  <a name="setwidth"></a>  CHtmlView::SetWidth

设置 Internet Explorer 主窗口的宽度。

```
void SetWidth(long nNewValue);
```

### <a name="parameters"></a>参数

*nNewValue*<br/>
以像素为单位，Internet Explorer 主窗口的宽度。

##  <a name="stop"></a>  CHtmlView::Stop

调用此成员函数以取消所有挂起的导航或下载操作并停止所有动态页元素，如背景声音和动画。

```
void Stop();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="see-also"></a>请参阅

[MFC 示例 MFCIE](../../visual-cpp-samples.md)<br/>
[CFormView 类](../../mfc/reference/cformview-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/desktop/api/exdisp/nn-exdisp-iwebbrowser2)
