---
description: 了解详细信息： CMFCToolBar 类
title: CMFCToolBar 类
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: ff3015c695b02381693e4ddcc7410a94a748d863
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/11/2020
ms.locfileid: "97164037"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 类

`CMFCToolBar`类类似于[CToolBar 类](../../mfc/reference/ctoolbar-class.md)，但为用户界面功能提供额外支持。 其中包括平面工具栏、有热图的工具栏、大图标、页导航按钮、锁定的工具栏、Rebar 控件、图像下的文本、背景图像和选项卡式工具栏。 `CMFCToolBar` 类还包含内置支持，用户可对工具栏和菜单、工具栏和菜单之间的拖放、组合框按钮、编辑框按钮、颜色选取器和汇总按钮进行自定义。

有关更多详细信息，请参阅位于 Visual Studio 安装的 **VC \\ atlmfc \\ src \\ mfc** 文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|“属性”|描述|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|默认构造函数。|
|`CMFCToolBar::~CMFCToolBar`|析构函数。|

### <a name="public-methods"></a>公共方法

|“属性”|描述|
|----------|-----------------|
|[CMFCToolBar：： AddBasicCommand](#addbasiccommand)|将菜单命令添加到在用户打开菜单时始终显示的命令列表中。|
|[CMFCToolBar：： AddCommandUsage](#addcommandusage)|增加一个与给定命令关联的计数器。|
|[CMFCToolBar：： AddToolBarForImageCollection](#addtoolbarforimagecollection)|将用户界面资源中的映像添加到应用程序中的映像集合。|
|[CMFCToolBar：： AdjustLayout](#adjustlayout)|重新计算工具栏的大小和位置。  (重写 [CBasePane：： AdjustLayout](../../mfc/reference/cbasepane-class.md#adjustlayout)) 。|
|[CMFCToolBar：： AdjustSize](#adjustsize)|重新计算工具栏的大小。|
|[CMFCToolBar：： AllowChangeTextLabels](#allowchangetextlabels)|指定文本标签是否可显示在工具栏按钮上的 "图像" 下。|
|[CMFCToolBar：： AreTextLabels](#aretextlabels)|指定当前是否在工具栏按钮上显示图像下的文本标签。|
|[CMFCToolBar：： AutoGrayInactiveImages](#autograyinactiveimages)|启用或禁用自动生成非活动按钮图像。|
|[CMFCToolBar：： ButtonToIndex](#buttontoindex)|返回此工具栏中指定的 [CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md) 对象的索引。|
|[CMFCToolBar：： CalcFixedLayout](#calcfixedlayout)|计算工具栏的水平大小。  (重写 [CBasePane：： CalcFixedLayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout)。 ) |
|[CMFCToolBar：： CalcSize](#calcsize)|由框架作为布局计算过程的一部分进行调用。  (重写 [CPane：： CalcSize](../../mfc/reference/cpane-class.md#calcsize)。 ) |
|[CMFCToolBar：： CanHandleSiblings](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|
|[CMFCToolBar：： CleanUpImages](#cleanupimages)|释放分配给工具栏图像的系统资源。|
|[CMFCToolBar：： CleanUpLockedImages](#cleanuplockedimages)|释放为锁定的工具栏图像分配的系统资源。|
|[CMFCToolBar：： CanBeClosed](#canbeclosed)|指定用户是否可以关闭工具栏。  (重写 [CBasePane：： CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed)。 ) |
|[CMFCToolBar：： CanBeRestored](#canberestored)|确定系统是否可以在自定义后将工具栏还原到其原始状态。|
|[CMFCToolBar：： CanFocus](#canfocus)|指定窗格是否可以接收焦点。  (重写 [CBasePane：： CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)。 ) |
|[CMFCToolBar：： CanHandleSiblings](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|
|[CMFCToolBar：： CommandToIndex](#commandtoindex)|返回工具栏中具有指定命令 ID 的按钮的索引。|
|[CMFCToolBar：： Create](#create)|创建一个 `CMFCToolBar` 对象。|
|[CMFCToolBar：： CreateEx](#createex)|创建一个 `CMFCToolBar` 对象，该对象使用其他样式选项，如大图标。|
|[CMFCToolBar：:D eactivate](#deactivate)|停用工具栏。|
|[CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton)|启用或禁用显示在工具栏末尾的 " **添加或删除按钮** " 按钮。|
|[CMFCToolBar：： EnableDocking](#enabledocking)|允许将窗格停靠到主帧。  (重写 [CBasePane：： EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)。 ) |
|[CMFCToolBar：： EnableLargeIcons](#enablelargeicons)|启用或禁用工具栏按钮上的大图标。|
|[CMFCToolBar：： EnableQuickCustomization](#enablequickcustomization)|启用或禁用工具栏快速自定义，以便用户可以按 **Alt** 键并将按钮拖到新位置。|
|[CMFCToolBar：： EnableReflections](#enablereflections)|启用或禁用命令反射。|
|[CMFCToolBar：： EnableTextLabels](#enabletextlabels)|启用或禁用工具栏按钮图像下的文本标签。|
|[CMFCToolBar：： FromHandlePermanent](#fromhandlepermanent)|检索指向 `CMFCToolBar` 对象的指针，该对象包含给定的窗口句柄。|
|[CMFCToolBar：： GetAllButtons](#getallbuttons)|返回工具栏中按钮的只读列表。|
|[CMFCToolBar：： GetAllToolbars](#getalltoolbars)|返回应用程序中所有工具栏的只读列表。|
|[CMFCToolBar：： GetBasicCommands](#getbasiccommands)|返回在应用程序中定义的基本命令的只读列表。|
|[CMFCToolBar：： GetButton](#getbutton)|返回一个指向 `CMFCToolBarButton` 对象的指针，该对象具有指定的工具栏按钮索引。|
|[CMFCToolBar：： GetButtonInfo](#getbuttoninfo)|返回指定索引处的按钮的命令 ID、样式和图像索引。|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|返回工具栏上每个按钮的尺寸。|
|[CMFCToolBar：： GetButtonStyle](#getbuttonstyle)|返回位于指定索引处的工具栏按钮的当前样式。|
|[CMFCToolBar：： GetButtonText](#getbuttontext)|返回具有指定索引的按钮的文本标签。|
|[CMFCToolBar：： GetColdImages](#getcoldimages)|返回指向应用程序中冷工具栏按钮图像的集合的指针。|
|[CMFCToolBar：： GetColumnWidth](#getcolumnwidth)|返回工具栏按钮的宽度。|
|[CMFCToolBar：： GetCommandButtons](#getcommandbuttons)|返回一个按钮列表，其中包含应用程序中所有工具栏的指定命令 ID。|
|[CMFCToolBar：： GetCount](#getcount)|返回工具栏上的按钮和分隔符的数目。|
|[CMFCToolBar：： GetCustomizeButton](#getcustomizebutton)|检索指向 `CMFCCustomizeButton` 与工具栏关联的对象的指针。|
|[CMFCToolBar：： GetDefaultImage](#getdefaultimage)|返回具有指定命令 ID 的工具栏按钮的默认图像的索引。|
|[CMFCToolBar：： GetDisabledImages](#getdisabledimages)|返回一个指针，该指针指向用于应用程序中的已禁用工具栏按钮的图像集合。|
|[CMFCToolBar：： GetDisabledMenuImages](#getdisabledmenuimages)|返回一个指针，该指针指向用于在应用程序中禁用的菜单按钮的图像集合。|
|[CMFCToolBar：： GetDroppedDownMenu](#getdroppeddownmenu)|检索指向当前显示其子菜单的菜单按钮对象的指针。|
|[CMFCToolBar：： GetGrayDisabledButtons](#getgraydisabledbuttons)|指定 "已禁用" 按钮的图像是常规按钮图像的模糊版本，还是从禁用的按钮图像的集合中获取的。|
|[CMFCToolBar：： GetHighlightedButton](#gethighlightedbutton)|返回指向当前突出显示的工具栏按钮的指针。|
|[CMFCToolBar：： GetHotBorder](#gethotborder)|确定是否热跟踪工具栏按钮。|
|[CMFCToolBar：： GetHotTextColor](#gethottextcolor)|返回突出显示的工具栏按钮的文本颜色。|
|[CMFCToolBar：： GetHwndLastFocus](#gethwndlastfocus)|返回窗口的句柄，该窗口在工具栏执行之前具有输入焦点。|
|[CMFCToolBar：： GetIgnoreSetText](#getignoresettext)|指定是否忽略设置按钮标签调用。|
|[CMFCToolBar：： GetImageSize](#getimagesize)|返回工具栏按钮图像的当前大小。|
|[CMFCToolBar：： GetImages](#getimages)|返回指向应用程序中的默认按钮图像集合的指针。|
|[CMFCToolBar：： GetImagesOffset](#getimagesoffset)|返回用于在工具栏按钮图像的全局列表中查找此工具栏的工具栏按钮图像的索引偏移量。|
|[CMFCToolBar：： GetInvalidateItemRect](#getinvalidateitemrect)|检索必须为给定索引处的按钮重绘的工作区区域。|
|[CMFCToolBar：： GetItemID](#getitemid)|返回指定索引处的工具栏按钮的命令 ID。|
|[CMFCToolBar：： GetItemRect](#getitemrect)|返回指定索引处的按钮的边框。|
|[CMFCToolBar：： GetLargeColdImages](#getlargecoldimages)|返回一个指向应用程序中大冷工具栏按钮图像集合的指针。|
|[CMFCToolBar：： GetLargeDisabledImages](#getlargedisabledimages)|返回一个指针，该指针指向应用程序中的大型已禁用工具栏按钮图像的集合。|
|[CMFCToolBar：： GetLargeImages](#getlargeimages)|返回指向应用程序中大工具栏按钮图像集合的指针。|
|[CMFCToolBar：： GetLockedColdImages](#getlockedcoldimages)|返回一个指针，该指针指向工具栏中锁定的冷图像的集合。|
|[CMFCToolBar：： GetLockedDisabledImages](#getlockeddisabledimages)|返回指向工具栏中被锁定的已禁用图像的集合的指针。|
|[CMFCToolBar：： GetLockedImages](#getlockedimages)|返回一个指针，该指针指向工具栏中锁定的按钮图像的集合。|
|[CMFCToolBar：： GetLockedImageSize](#getlockedimagesize)|返回锁定的工具栏图像的默认大小。|
|[CMFCToolBar：： GetLockedMenuImages](#getlockedmenuimages)|返回指向工具栏中锁定的工具栏菜单图像的集合的指针。|
|[CMFCToolBar：： GetMenuButtonSize](#getmenubuttonsize)|返回应用程序中菜单按钮的大小。|
|[CMFCToolBar：： GetMenuImageSize](#getmenuimagesize)|返回应用程序中菜单按钮图像的大小。|
|[CMFCToolBar：： GetMenuImages](#getmenuimages)|返回指向应用程序中的菜单按钮图像集合的指针。|
|[CMFCToolBar：： GetOrigButtons](#getorigbuttons)|检索工具栏的非自定义按钮的集合。|
|[CMFCToolBar：： GetOrigResetButtons](#getorigresetbuttons)|检索工具栏的非自定义重置按钮的集合。|
|[CMFCToolBar：： GetResourceID](#getresourceid)|检索工具栏的资源 ID。|
|[CMFCToolBar：： GetRouteCommandsViaFrame](#getroutecommandsviaframe)|确定父框架或所有者将命令发送到工具栏的对象。|
|[CMFCToolBar：： GetRowHeight](#getrowheight)|返回工具栏按钮的高度。|
|[CMFCToolBar：： GetShowTooltips](#getshowtooltips)|指定是否为工具栏按钮显示工具提示。|
|[CMFCToolBar：： GetSiblingToolBar](#getsiblingtoolbar)|检索工具栏的同级。|
|[CMFCToolBar：： GetUserImages](#getuserimages)|返回一个指向应用程序中用户定义工具栏按钮图像的集合的指针。|
|[CMFCToolBar：： System.windows.media.visualtreehelper.hittest](#hittest)|返回位于指定位置的工具栏按钮的索引。|
|[CMFCToolBar：： InsertButton](#insertbutton)|将按钮插入到工具栏中。|
|[CMFCToolBar：： InsertSeparator](#insertseparator)|在工具栏中插入分隔符。|
|[CMFCToolBar：： InvalidateButton](#invalidatebutton)|使所提供的索引中存在的工具栏按钮的工作区失效。|
|[CMFCToolBar：： IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|确定用户是否可以通过使用 " **自定义** " 菜单选项来添加或移除工具栏按钮。|
|[CMFCToolBar：： IsAltCustomizeMode](#isaltcustomizemode)|指定是否使用 *快速自定义* 来拖动按钮。|
|[CMFCToolBar：： IsAutoGrayInactiveImages](#isautograyinactiveimages)|指定是否启用非突出显示 (非突出显示) 按钮图像的自动生成。|
|[CMFCToolBar：： IsBasicCommand](#isbasiccommand)|确定命令是否在基本命令列表中。|
|[CMFCToolBar：： IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|确定工具栏是否可以显示具有扩展边框的按钮。|
|[CMFCToolBar：： IsButtonHighlighted](#isbuttonhighlighted)|确定是否突出显示工具栏上的按钮。|
|[CMFCToolBar：： IsCommandPermitted](#iscommandpermitted)|确定是否允许命令。|
|[CMFCToolBar：： IsCommandRarelyUsed](#iscommandrarelyused)|确定是否很少使用命令 (参阅 [CMFCToolBar：： SetCommandUsageOptions](#setcommandusageoptions)) 。|
|[CMFCToolBar：： IsCustomizeMode](#iscustomizemode)|指定工具栏框架是否处于自定义模式。|
|[CMFCToolBar：： IsDragButton](#isdragbutton)|确定是否正在拖动工具栏按钮。|
|[CMFCToolBar：： IsExistCustomizeButton](#isexistcustomizebutton)|确定工具栏是否包含 " **自定义** " 按钮。|
|[CMFCToolBar：： IsFloating](#isfloating)|确定工具栏是否浮动。|
|[CMFCToolBar：： IsLargeIcons](#islargeicons)|指定应用程序中的工具栏当前是否显示大图标。|
|[CMFCToolBar：： IsLastCommandFromButton](#islastcommandfrombutton)|确定是否从指定工具栏按钮发送最近执行的命令。|
|[CMFCToolBar：： IsLocked](#islocked)|确定工具栏是否处于锁定状态。|
|[CMFCToolBar：： IsOneRowWithSibling](#isonerowwithsibling)|确定工具栏及其同级工具栏是否定位在同一行上。|
|[CMFCToolBar：： IsUserDefined](#isuserdefined)|指定工具栏是否为用户定义的。|
|[CMFCToolBar：： LoadBitmap](#loadbitmap)|从应用程序资源加载工具栏图像。|
|[CMFCToolBar：： LoadBitmapEx](#loadbitmapex)|从应用程序资源加载工具栏图像。 包括较大的图像。|
|[CMFCToolBar：： LoadParameters](#loadparameters)|从 Windows 注册表加载全局工具栏选项。|
|[CMFCToolBar：： LoadState](#loadstate)|从 Windows 注册表加载工具栏状态信息。  (重写 [CPane：： LoadState](../../mfc/reference/cpane-class.md#loadstate)。 ) |
|[CMFCToolBar：： LoadToolBar](#loadtoolbar)|从应用程序资源加载工具栏。|
|[CMFCToolBar：： LoadToolBarEx](#loadtoolbarex)|使用 helper 类从应用程序资源加载工具栏 `CMFCToolBarInfo` ，以使应用程序能够使用较大的图像。|
|[CMFCToolBar：： OnChangeHot](#onchangehot)|当用户选择工具栏上的按钮时由框架调用。|
|[CMFCToolBar：： OnFillBackground](#onfillbackground)|由 [CBasePane：:D opaint](../../mfc/reference/cbasepane-class.md#dopaint) 中的框架调用以填充工具栏背景。|
|[CMFCToolBar：： OnReset](#onreset)|将工具栏还原到其原始状态。|
|[CMFCToolBar：： OnSetAccData](#onsetaccdata)| (重写 [CBasePane：： OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata)。 ) |
|[CMFCToolBar：： OnSetDefaultButtonText](#onsetdefaultbuttontext)|将工具栏按钮的文本还原为其默认状态。|
|`CMFCToolBar::OnUpdateCmdUI`|内部使用。|
|[CMFCToolBar：： RemoveAllButtons](#removeallbuttons)|从工具栏中删除所有按钮。|
|[CMFCToolBar：： RemoveButton](#removebutton)|从工具栏中删除具有指定索引的按钮。|
|[CMFCToolBar：： RemoveStateFromRegistry](#removestatefromregistry)|从 Windows 注册表中删除工具栏的状态信息。|
|[CMFCToolBar：： ReplaceButton](#replacebutton)|使用另一个工具栏按钮替换工具栏按钮。|
|[CMFCToolBar：： ResetAll](#resetall)|将所有工具栏还原到其原始状态。|
|[CMFCToolBar：： ResetAllImages](#resetallimages)|清除应用程序中的所有工具栏图像集合。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|还原工具栏的原始状态。|
|[CMFCToolBar：： SaveState](#savestate)|为 Windows 注册表中的工具栏保存状态信息。  (重写 [CPane：： SaveState](../../mfc/reference/cpane-class.md#savestate)。 ) |
|`CMFCToolBar::Serialize`|（重写 `CBasePane::Serialize`。）|
|[CMFCToolBar：： SetBasicCommands](#setbasiccommands)|设置用户打开菜单时始终显示的命令的列表。|
|[CMFCToolBar：： SetButtonInfo](#setbuttoninfo)|设置工具栏按钮的命令 ID、样式和图像 ID。|
|[CMFCToolBar：： SetButtonStyle](#setbuttonstyle)|设置给定索引处的工具栏按钮的样式。|
|[CMFCToolBar：： SetButtonText](#setbuttontext)|设置工具栏按钮的文本标签。|
|[CMFCToolBar：： SetButtons](#setbuttons)|设置工具栏按钮。|
|[CMFCToolBar：： SetCommandUsageOptions](#setcommandusageoptions)|指定在应用程序的菜单中不显示很少使用的命令的时间。|
|[CMFCToolBar：： SetCustomizeMode](#setcustomizemode)|为应用程序中的所有工具栏启用或禁用自定义模式。|
|[CMFCToolBar：： SetGrayDisabledButtons](#setgraydisabledbuttons)|指定工具栏上的禁用按钮是否灰显，或者是否将已禁用的图像用于禁用的按钮。|
|[CMFCToolBar：： SetHeight](#setheight)|设置工具栏的高度。|
|[CMFCToolBar：： SetHotBorder](#sethotborder)|指定是否热跟踪工具栏按钮。|
|[CMFCToolBar：： SetHotTextColor](#sethottextcolor)|设置热工具栏按钮的文本颜色。|
|[CMFCToolBar：： SetLargeIcons](#setlargeicons)|指定工具栏按钮是否显示大图标。|
|[CMFCToolBar：： SetLockedSizes](#setlockedsizes)|设置工具栏上锁定按钮和锁定图像的大小。|
|[CMFCToolBar：： SetMenuSizes](#setmenusizes)|设置工具栏菜单按钮及其图像的大小。|
|[CMFCToolBar：： SetNonPermittedCommands](#setnonpermittedcommands)|设置用户无法执行的命令的列表。|
|[CMFCToolBar：： SetOneRowWithSibling](#setonerowwithsibling)|将工具栏及其同级定位在同一行上。|
|[CMFCToolBar：： SetPermament](#setpermament)|指定用户是否可以关闭工具栏。|
|[CMFCToolBar：： SetRouteCommandsViaFrame](#setroutecommandsviaframe)|指定父框架或所有者是否向工具栏发送命令。|
|[CMFCToolBar：： SetShowTooltips](#setshowtooltips)|指定框架是否显示工具提示。|
|[CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar)|指定工具栏的同级。|
|[CMFCToolBar：： SetSizes](#setsizes)|指定所有工具栏上的按钮和图像的大小。|
|[CMFCToolBar：： SetToolBarBtnText](#settoolbarbtntext)|指定工具栏上的按钮的属性。|
|[CMFCToolBar：： SetTwoRowsWithSibling](#settworowswithsibling)|将工具栏及其同级置于单独的行上。|
|[CMFCToolBar：： SetUserImages](#setuserimages)|在应用程序中设置用户定义图像的集合。|
|[CMFCToolBar：： StretchPane](#stretchpane)|垂直或水平拉伸工具栏。  (重写 [CBasePane：： StretchPane](../../mfc/reference/cbasepane-class.md#stretchpane)。 ) |
|[CMFCToolBar：： TranslateChar](#translatechar)|如果指定的键代码对应于有效的键盘快捷方式，则执行按钮命令。|
|[CMFCToolBar：： UpdateButton](#updatebutton)|更新指定按钮的状态。|
|[CMFCToolBar：： WrapToolBar](#wraptoolbar)|在给定维度中重新定位工具栏按钮。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCToolBar：： AllowShowOnList](#allowshowonlist)|确定工具栏是否显示在 "**自定义**" 对话框的 "**工具栏**" 窗格上的列表中。|
|[CMFCToolBar：： CalcMaxButtonHeight](#calcmaxbuttonheight)|计算工具栏中按钮的最大高度。|
|[CMFCToolBar：:D oPaint](#dopaint)|重新绘制工具栏。|
|[CMFCToolBar：:D rawButton](#drawbutton)|重新绘制工具栏按钮。|
|[CMFCToolBar：:D rawSeparator](#drawseparator)|在工具栏上重新绘制分隔符。|
|[CMFCToolBar：： OnUserToolTip](#onusertooltip)|当要显示按钮的工具提示时，由框架调用。|

### <a name="data-members"></a>数据成员

|名称|描述|
|----------|-----------------|
|[CMFCToolBar：： m_bDontScaleImages](#m_bdontscaleimages)|指定是否在高 DPI 模式下缩放或不缩放工具栏图像。|
|[CMFCToolBar：： m_dblLargeImageRatio](#m_dbllargeimageratio)|指定大型图像的维度 (高度或宽度) 与常规图像维度的比率。|

## <a name="remarks"></a>备注

若要将 `CMFCToolBar` 对象合并到应用程序中，请执行以下步骤：

1. 向 `CMFCToolBar` 主框架窗口添加对象。

1. 处理主框架窗口的 WM_CREATE 消息时，请调用 [CMFCToolBar：： create](#create) 或 [CMFCToolBar：： CreateEx](#createex) 来创建工具栏并指定其样式。

1. 调用 [CBasePane：： EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking) 以指定停靠样式。

若要插入特殊按钮，如组合框或下拉工具栏，请在父资源中保留虚拟按钮，并使用 [CMFCToolBar：： ReplaceButton](#replacebutton)替换运行时中的虚拟按钮。 有关详细信息，请参阅 [演练：将控件放置在工具栏上](../walkthrough-putting-controls-on-toolbars.md)。

`CMFCToolBar` MFC 库类的基类 [CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)、 [CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)和 [CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)。

## <a name="example"></a>示例

下面的示例演示了如何使用 `CMFCToolBar` 类中的各种方法。 该示例演示如何设置工具栏的窗口标签文本、设置边框、设置窗格样式，并启用出现在工具栏末尾的 " **添加或删除按钮** " 按钮。 此代码片段是 [IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>要求

**标头：** afxtoolbar

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

## <a name="cmfctoolbaraddbasiccommand"></a><a name="addbasiccommand"></a> CMFCToolBar：： AddBasicCommand

将菜单命令添加到在用户打开菜单时始终显示的命令列表中。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>parameters

*uiCmd*<br/>
中指定要添加的命令。

### <a name="remarks"></a>备注

打开菜单时，将始终显示基本命令。 当用户选择查看最近使用的命令时，此方法是有意义的。

使用 [CMFCToolBar：： SetBasicCommands](#setbasiccommands) 方法可设置用户打开菜单时始终显示的命令的列表。 使用 [CMFCToolBar：： GetBasicCommands](#getbasiccommands) 方法检索应用程序所使用的基本命令的列表。

## <a name="cmfctoolbaraddcommandusage"></a><a name="addcommandusage"></a> CMFCToolBar：： AddCommandUsage

增加一个与给定命令关联的计数器。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>parameters

*uiCommand*<br/>
中指定要递增的命令计数器。

### <a name="remarks"></a>备注

当用户选择菜单项时，框架会调用此方法。

框架使用命令计数器显示最近使用的菜单项。

此方法使用 [CMFCCmdUsageCount：： AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd) 方法递增命令计数器。

## <a name="cmfctoolbaraddtoolbarforimagecollection"></a><a name="addtoolbarforimagecollection"></a> CMFCToolBar：： AddToolBarForImageCollection

将用户界面资源中的映像添加到应用程序中的映像集合。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>parameters

*uiResID*<br/>
中包含要加载的图像的工具栏的资源 ID。

*uiBmpResID*<br/>
中带有工具栏图像的位图的资源 ID。

*uiColdResID*<br/>
中具有 "冷" 工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
中具有菜单图像的位图的资源 ID。

*uiDisabledResID*<br/>
中具有禁用工具栏图像的位图的资源 ID。

*uiMenuDisabledResID*<br/>
中具有禁用的菜单图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为 TRUE;如果 *uiResID* 或 *uiBmpResID* 未指定有效资源，或发生其他错误，则为 FALSE。

### <a name="remarks"></a>备注

调用此方法可加载带有工具栏图像的位图，并将其添加到工具栏图像的集合中。 此方法创建一个临时工具栏对象并调用 [CMFCToolBar：： LoadToolBar](#loadtoolbar)。

## <a name="cmfctoolbaradjustlayout"></a><a name="adjustlayout"></a> CMFCToolBar：： AdjustLayout

重新计算工具栏的大小和位置。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>备注

创建工具栏以重新计算其大小和位置时，调用此方法。

每次必须更改工具栏的布局时，框架都会调用此方法。 例如，当用户移动另一个控件栏、调整应用程序窗口的大小或自定义工具栏时，布局必须更改。

重写此方法可在派生自的类中提供自己的动态布局 `CMFCToolbar` 。

## <a name="cmfctoolbaradjustsize"></a><a name="adjustsize"></a> CMFCToolBar：： AdjustSize

重新计算工具栏的大小。

```cpp
void AdjustSize();
```

### <a name="remarks"></a>备注

此方法可确保工具栏适应父框架的边界。 如果工具栏没有父框架，则此方法不执行任何操作。

如果工具栏的父对象不是对象， [CMFCToolBar：： AdjustLayout](#adjustlayout) 方法会调用此方法来重新计算大小 `CMFCReBar` 。

## <a name="cmfctoolbarallowchangetextlabels"></a><a name="allowchangetextlabels"></a> CMFCToolBar：： AllowChangeTextLabels

指定文本标签是否可显示在工具栏按钮上的 "图像" 下。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>返回值

如果允许在图像下方显示文本标签，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

"自定义" 对话框调用此方法，以确定是否在所选工具栏的 "**工具栏**" 页上启用 "**显示文本标签**" 复选框。

默认实现返回 TRUE。

在从派生的对象中重写此方法 `CMFCToolBar` ，并在您不希望用户决定是否在图像下的工具栏按钮上显示文本标签时返回 FALSE。

## <a name="cmfctoolbarallowshowonlist"></a><a name="allowshowonlist"></a> CMFCToolBar：： AllowShowOnList

确定工具栏是否显示在 "**自定义**" 对话框的 "**工具栏**" 窗格上的工具栏列表中。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>返回值

如果工具栏对象可以显示在工具栏的 "自定义" 页上的列表框中，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法由框架调用，以确定 "工具栏自定义" 页上的列表是否应包括从派生的特定对象 `CMFCToolBar` 。

默认实现始终返回 TRUE。 当您不希望工具栏出现在 "自定义" 对话框的 "工具栏" 列表中时，请重写此方法。

## <a name="cmfctoolbararetextlabels"></a><a name="aretextlabels"></a> CMFCToolBar：： AreTextLabels

指定当前是否在工具栏按钮上显示图像下的文本标签。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>返回值

如果工具栏按钮在图像下方显示文本标签，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

使用 [CMFCToolBar：： EnableTextLabels](#enabletextlabels) 来指定是否显示文本。 默认值是 FALSE。 调用 [CMFCToolBar：： AllowChangeTextLabels](#allowchangetextlabels) 以指定用户是否可以在 "自定义" 对话框中更改此设置。

## <a name="cmfctoolbarautograyinactiveimages"></a><a name="autograyinactiveimages"></a> CMFCToolBar：： AutoGrayInactiveImages

启用或禁用自动生成非活动按钮图像。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>parameters

*bEnable*<br/>
中一个布尔值，指定是否对非活动图像进行模糊。 如果此参数为 TRUE，则非活动图像将灰显。 否则，非活动映像不会灰显。

*nGrayImagePercentage*<br/>
中指定非活动映像的亮度百分比。 如果 *bEnable* 为 FALSE，则忽略此值。

*bRedrawAllToolbars*<br/>
中一个布尔值，指定是否在应用程序中重绘所有工具栏。 如果此参数为 TRUE，则此方法将重绘所有工具栏。

### <a name="remarks"></a>备注

如果 *bEnable* 为 TRUE，则框架将使用 *nGrayImagePercentage* 从常规映像生成非活动映像。 否则，必须通过使用 [CMFCToolBar：： GetColdImages](#getcoldimages) 方法提供一组非活动映像。 默认情况下禁用此选项。

有关 *nGrayImagePercentage* 参数的详细信息，请参阅 [CMFCToolBarImages：： GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。

## <a name="cmfctoolbarbuttontoindex"></a><a name="buttontoindex"></a> CMFCToolBar：： ButtonToIndex

返回此工具栏中指定的 [CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md) 对象的索引。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向工具栏按钮对象的指针。

### <a name="return-value"></a>返回值

工具栏按钮内部列表中 *pButton* 的索引;如果指定的按钮不在此工具栏上，则为-1。

## <a name="cmfctoolbarcalcfixedlayout"></a><a name="calcfixedlayout"></a> CMFCToolBar：： CalcFixedLayout

计算工具栏的水平大小。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>parameters

*bStretch*<br/>
中如果为 TRUE，则将工具栏拉伸到父帧的大小。

*bHorz*<br/>
中如果要水平调整工具栏，则为 TRUE;若要垂直调整工具栏，则为 FALSE。

### <a name="return-value"></a>返回值

一个 `CSize` 指定工具栏大小的对象。

### <a name="remarks"></a>备注

此方法使用方法计算工具栏的大小 `CMFCToolBar::CalcLayout` 。 如果 *bStretch* 为 TRUE，则它将传递 *dwMode* 参数的 LM_STRETCH 标志。 如果 *bHorz* 为 TRUE，则它将传递 LM_HORZ 标志。

有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

## <a name="cmfctoolbarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a> CMFCToolBar：： CalcMaxButtonHeight

计算工具栏中按钮的最大高度。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>返回值

按钮的最大高度。

### <a name="remarks"></a>备注

此方法计算工具栏上所有工具栏按钮之间的最大高度。 高度可能因各种因素（如当前工具栏停靠状态）而有所不同。

在从派生的类中重写此方法 `CMFCToolBar` ，以提供您自己的高度计算。

## <a name="cmfctoolbarcalcsize"></a><a name="calcsize"></a> CMFCToolBar：： CalcSize

由框架作为布局计算过程的一部分进行调用。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>parameters

*bVertDock*<br/>
中若要指定工具栏垂直停靠，则为 TRUE;若为 FALSE，则指定工具栏水平停靠。

### <a name="return-value"></a>返回值

一个 `CSize` 对象，该对象指定工具栏上的按钮的总体大小。

### <a name="remarks"></a>备注

此方法考虑影响每个按钮的大小的属性，例如文本标签的区域和边框大小。

如果工具栏不包含任何按钮，此方法将通过使用 [CMFCToolBar：： GetButtonSize](#getbuttonsize) 方法返回单个按钮的保留大小。

## <a name="cmfctoolbarcanbeclosed"></a><a name="canbeclosed"></a> CMFCToolBar：： CanBeClosed

指定用户是否可以关闭工具栏。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>返回值

如果用户可以关闭工具栏，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

框架调用此方法来确定用户是否可以关闭工具栏。 如果该方法返回 TRUE，则该框架将启用工具栏的 "系统" 菜单中的 "SC_CLOSE" 命令，用户可以通过使用 "自定义" 对话框中的工具栏列表中的复选框来关闭工具栏。

默认实现返回 TRUE。 在从派生的类中重写此方法， `CMFCToolBar` 以使用户无法关闭的工具栏对象。

## <a name="cmfctoolbarcanberestored"></a><a name="canberestored"></a> CMFCToolBar：： CanBeRestored

确定系统是否可以在自定义后将工具栏还原到其原始状态。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>返回值

如果可从应用程序资源还原工具栏，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

框架调用此方法来确定工具栏在自定义后是否可以返回到其原始状态。 从应用程序资源加载原始状态。

如果 `CanBeRestored` 返回 TRUE，则 "自定义" 对话框的 " **工具栏** " 页将启用所选工具栏的 " **重置** " 按钮。

如果工具栏的原始资源 ID 为非零，则默认实现将返回 TRUE。 通常，只能还原用户定义的工具栏。

您可以重写 `CanBeRestored` 方法以自定义派生类中的此行为。

## <a name="cmfctoolbarcanfocus"></a><a name="canfocus"></a> CMFCToolBar：： CanFocus

指定窗格是否可以接收焦点。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>返回值

此方法返回 FALSE。

### <a name="remarks"></a>备注

此方法重写基类实现 [CBasePane：： CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)，因为 toolbar 对象无法接收焦点。

## <a name="cmfctoolbarcanhandlesiblings"></a><a name="canhandlesiblings"></a> CMFCToolBar：： CanHandleSiblings

确定工具栏和其同级是否定位在同一窗格上。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>返回值

如果工具栏具有同级并且工具栏及其同级位于同一个窗格上，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

内部 CMFCCustomizeButton：： CreatePopupMenu 方法调用此方法以确定如何显示 " **自定义** " 弹出菜单。 如果此方法返回 TRUE，则框架将在 "两行" 按钮上显示 " **在一行上显示按钮** " 或 " **显示按钮** "。

通常不需要使用此方法。 若要启用工具栏上显示的 " **自定义** " 按钮，请调用 [CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton) 方法。 若要启用 " **在一行上显示按钮** " 或 " **在两行上显示** 按钮" 按钮，请调用 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar)。

## <a name="cmfctoolbarcleanupimages"></a><a name="cleanupimages"></a> CMFCToolBar：： CleanUpImages

释放分配给工具栏图像的系统资源。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>备注

当应用程序关闭时，框架会调用此方法。

## <a name="cmfctoolbarcleanuplockedimages"></a><a name="cleanuplockedimages"></a> CMFCToolBar：： CleanUpLockedImages

释放为锁定的工具栏图像分配的系统资源。

```cpp
void CleanUpLockedImages();
```

### <a name="remarks"></a>备注

当应用程序的视觉样式发生更改时，调用此方法。 有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

## <a name="cmfctoolbarcommandtoindex"></a><a name="commandtoindex"></a> CMFCToolBar：： CommandToIndex

返回工具栏中具有指定命令 ID 的按钮的索引。

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>parameters

*nIDFind*<br/>
中指定命令 ID。

*iIndexFirst*<br/>
中指定要从其开始的初始索引。

### <a name="return-value"></a>返回值

如果方法成功，则为工具栏按钮的从零开始的索引;如果没有具有指定 ID 的按钮，则为-1。

### <a name="remarks"></a>备注

`CMFCToolBar`对象维护工具栏上的按钮的内部列表。 调用此函数可根据按钮的命令 ID 检索列表中的按钮的索引。

如果 *iIndex* 大于0，此方法将忽略工具栏上索引小于 *iIndex* 的任何按钮。

## <a name="cmfctoolbarcreate"></a><a name="create"></a> CMFCToolBar：： Create

创建一个 `CMFCToolBar` 对象。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>parameters

*pParentWnd*<br/>
中指向工具栏的父窗口的指针。

*dwStyle*<br/>
中工具栏样式。 有关样式列表，请参阅 Windows SDK 中的 [工具栏控件和按钮样式](/windows/win32/Controls/toolbar-control-and-button-styles) 。

*nID*<br/>
中工具栏的子窗口的 ID。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法创建一个控件栏并将其附加到工具栏。 它创建具有 TBSTYLE_FLAT 样式的控件条。 如果需要不同的控件栏样式，请调用 [CMFCToolBar：： CreateEx](#createex) 。

## <a name="cmfctoolbarcreateex"></a><a name="createex"></a> CMFCToolBar：： CreateEx

创建一个 `CMFCToolBar` 对象，该对象使用其他样式选项，如大图标。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>parameters

*pParentWnd*<br/>
中指向工具栏的父窗口的指针。

*dwCtrlStyle*<br/>
中用于创建嵌入控件条对象的其他样式。

*dwStyle*<br/>
中工具栏样式。 有关适当样式的列表，请参阅 [Toolbar 控件和按钮样式](/windows/win32/Controls/toolbar-control-and-button-styles) 。

*rcBorders*<br/>
中一个 `CRect` 对象，该对象指定工具栏窗口边框的宽度。

*nID*<br/>
中工具栏的子窗口的 ID。

### <a name="return-value"></a>返回值

如果此方法成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此方法创建一个控件栏并将其附加到工具栏。

如果要提供特定样式，请调用此方法，而不是 [CMFCToolBar：： Create](#create) 。 例如，将 *dwCtrlStyle* 设置为 TBSTYLE_FLAT |TBSTYLE_TRANSPARENT 创建一个工具栏，该工具栏与 Internet Explorer 4 使用的工具栏类似。

### <a name="example"></a>示例

下面的示例演示如何使用类的 `CreateEx` 方法 `CMFCToolBar` 。 此代码片段是 [IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbardeactivate"></a><a name="deactivate"></a> CMFCToolBar：:D eactivate

停用工具栏。

```
virtual void Deactivate();
```

### <a name="remarks"></a>备注

此方法通过删除突出显示的工具栏按钮中的焦点来停用工具栏。 当工具栏丢失焦点或销毁时，框架会调用此方法。

## <a name="cmfctoolbardopaint"></a><a name="dopaint"></a> CMFCToolBar：:D oPaint

重新绘制工具栏。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="remarks"></a>备注

当必须重新绘制工具栏的一部分时，框架会调用此方法。

重写此方法以自定义派生自的对象的外观 `CMFCToolBar` 。

## <a name="cmfctoolbardrawbutton"></a><a name="drawbutton"></a> CMFCToolBar：:D rawButton

重新绘制工具栏按钮。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*pButton*<br/>
中指向要绘制的按钮的指针。

*pImages*<br/>
中指向工具栏图像的指针。

*bHighlighted*<br/>
中如果按钮突出显示，则为 TRUE;否则为 FALSE。

*bDrawDisabledImages*<br/>
中如果 "禁用" 按钮灰显，则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果重画了按钮，则为 TRUE;如果隐藏按钮，则为 FALSE。

### <a name="remarks"></a>备注

当必须重新绘制工具栏按钮时， [CMFCToolBar：:D rawbutton](#drawbutton) 方法会调用此方法。

如果要自定义工具栏上按钮的外观，请重写此方法。

## <a name="cmfctoolbardrawseparator"></a><a name="drawseparator"></a> CMFCToolBar：:D rawSeparator

在工具栏上重新绘制分隔符。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*rect*<br/>
中绘制分隔符的位置的边框（以像素为单位）。

*bHorz*<br/>
中如果分隔符是水平的，则为 TRUE; 如果分隔符是垂直的，则为 FALSE。

### <a name="remarks"></a>备注

[CMFCToolBar：:D opaint](#dopaint) 为具有 TBBS_SEPARATOR 样式的每个 [CMFCToolBar：:D rawseparator](#drawseparator) 对象调用此方法，而不是对这些按钮调用 [CMFCToolBar：:D rawbutton](#drawbutton) 。

在从 [CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md) 派生的类中重写此方法，以自定义工具栏上分隔符的外观。 默认实现将调用 [CMFCVisualManager：： OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator) 来绘制其外观由当前可视化管理器确定的分隔符。

## <a name="cmfctoolbarenablecustomizebutton"></a><a name="enablecustomizebutton"></a> CMFCToolBar：： EnableCustomizeButton

启用或禁用显示在工具栏上的 "自定义" 按钮。

```cpp
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>parameters

*bEnable*<br/>
中启用或禁用 "自定义" 按钮。

*iCustomizeCmd*<br/>
中"自定义" 按钮的命令 ID。

*strCustomizeText*<br/>
中"自定义" 按钮的文本标签。

*uiCustomizeTextResId*<br/>
中自定义按钮标签的资源字符串 ID。

*bQuickCustomize*<br/>
中启用或禁用从按钮下拉的菜单上的 " **添加或删除按钮** " 选项。

### <a name="remarks"></a>备注

如果 *iCustomizeCmd* 为-1，则在工具栏区域中无法容纳多个工具栏按钮时，框架会显示 "自定义" 按钮。 按钮会显示一个双向左箭头或 v 形，这表示还有更多的按钮。

如果 *iCustomizeCmd* 指定有效的命令 ID，并且 *bEnable* 为 TRUE，则始终显示 "自定义" 按钮。 按钮有一个小向下箭头，并打开包含命令的菜单。 此命令使用由 *strCustomizeText* 指定的文本标签。 如果 *bQuickCustomize* 也为 TRUE，则菜单将显示 " **添加或删除按钮** " 选项。

在 *iCustomizeCmd* 指定的项之前，框架会动态地将工具栏区域中无法容纳的所有按钮添加到菜单中。 向下箭头旁边显示 v 形。

## <a name="cmfctoolbarenabledocking"></a><a name="enabledocking"></a> CMFCToolBar：： EnableDocking

允许将窗格停靠到主帧。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>parameters

*dwAlignment*<br/>
中指定要启用的停靠对齐方式。

### <a name="remarks"></a>备注

此方法通过将数据成员设置为 AFX_CBRS_FLOAT 来扩展基类实现， [CBasePane：： EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking) `CBasePane::m_dwControlBarStyle` 。 此方法随后将 *dwAlignment* 传递到基类实现。

## <a name="cmfctoolbarenablelargeicons"></a><a name="enablelargeicons"></a> CMFCToolBar：： EnableLargeIcons

启用或禁用工具栏按钮上的大图标。

```cpp
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>parameters

*bEnable*<br/>
中若要启用大图标，则为 TRUE，禁用大图标。

### <a name="remarks"></a>备注

默认情况下，将启用大图标。

## <a name="cmfctoolbarenablequickcustomization"></a><a name="enablequickcustomization"></a> CMFCToolBar：： EnableQuickCustomization

启用或禁用工具栏快速自定义，以便用户可以按 **Alt** 键并将按钮拖到新位置。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>parameters

*bEnable*<br/>
中若要启用快速自定义，则为 TRUE，禁用快速自定义。

## <a name="cmfctoolbarenablereflections"></a><a name="enablereflections"></a> CMFCToolBar：： EnableReflections

启用或禁用命令反射。

```cpp
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>parameters

*bEnable*<br/>
中若要启用命令反射，则为 TRUE;若要禁用命令反射，则为 FALSE。

### <a name="remarks"></a>备注

调用此方法可为包含嵌入控件的工具栏按钮（如组合框）启用命令反射。

有关命令反射的详细信息，请参阅 [TN062： Windows 控件的消息反射](../../mfc/tn062-message-reflection-for-windows-controls.md)。

## <a name="cmfctoolbarenabletextlabels"></a><a name="enabletextlabels"></a> CMFCToolBar：： EnableTextLabels

启用或禁用工具栏按钮图像下的文本标签。

```cpp
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>parameters

*bEnable*<br/>
如果在工具栏按钮图像下显示文本标签，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果启用文本标签，则工具栏上的所有按钮都将放大，以提供用于在图像下显示标签的空间。 "自定义" 对话框的 "**工具栏**" 页上有 "**显示文本标签**" 复选框。 当用户选择工具栏并选中此选项时，框架将 `EnableTextLabels` 为所选工具栏调用。 可以通过从[CMFCToolBar：： AllowChangeTextLabels](#allowchangetextlabels)返回 FALSE 来禁用派生自[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)的对象的复选框。

## <a name="cmfctoolbarfromhandlepermanent"></a><a name="fromhandlepermanent"></a> CMFCToolBar：： FromHandlePermanent

检索指向 `CMFCToolBar` 对象的指针，该对象包含给定的窗口句柄。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>parameters

*hwnd*<br/>
中要查找的窗口句柄。

### <a name="return-value"></a>返回值

指向 `CMFCToolBar` 对象的指针，该对象包含给定的窗口句柄，如果不存在相应的对象，则为 NULL `CMFCToolBar` 。

### <a name="remarks"></a>备注

此共享方法检查应用程序中的每个工具栏， `CMFCToolBar` 其中包含给定的窗口句柄。

## <a name="cmfctoolbargetallbuttons"></a><a name="getallbuttons"></a> CMFCToolBar：： GetAllButtons

返回工具栏中按钮的只读列表。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>返回值

对 [CObList 类](../../mfc/reference/coblist-class.md) 对象的常量引用，其中包含 [CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md) 对象的集合。

## <a name="cmfctoolbargetalltoolbars"></a><a name="getalltoolbars"></a> CMFCToolBar：： GetAllToolbars

返回应用程序中所有工具栏的只读列表。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>返回值

对包含对象集合的 [CObList 类](../../mfc/reference/coblist-class.md) 对象的常量引用 `CMFCToolBar` 。

## <a name="cmfctoolbargetbasiccommands"></a><a name="getbasiccommands"></a> CMFCToolBar：： GetBasicCommands

返回在应用程序中定义的基本命令的只读列表。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>返回值

对 [CList 类](../../mfc/reference/clist-class.md) 对象的 const 引用，其中包含基本命令的集合。

### <a name="remarks"></a>备注

通过调用 [CMFCToolBar：： AddBasicCommand](#addbasiccommand) 或 [CMFCToolBar：： SetBasicCommands](#setbasiccommands)添加基本命令。

## <a name="cmfctoolbargetbutton"></a><a name="getbutton"></a> CMFCToolBar：： GetButton

返回指向指定索引处的 [CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md) 对象的指针。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>parameters

*iIndex*<br/>
中指定要返回的按钮的索引。

### <a name="return-value"></a>返回值

指向工具栏按钮的指针（如果存在）;如果没有此类按钮，则为 NULL。

## <a name="cmfctoolbargetbuttoninfo"></a><a name="getbuttoninfo"></a> CMFCToolBar：： GetButtonInfo

返回指定索引处的按钮的命令 ID、样式和图像索引。

```cpp
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定工具栏上的按钮列表中按钮的索引。

*nID*<br/>
弄按钮的命令 ID。

*nStyle*<br/>
弄按钮的样式。

*iImage*<br/>
弄按钮的图像的索引。

### <a name="remarks"></a>备注

`GetButtonInfo`方法查找位于指定索引处的工具栏按钮，并检索该按钮的命令 ID、样式和图像索引。

如果指定索引处的按钮不存在，则在该方法返回时，框架会将 *nID* 和 *nStyle* 设置为0，并将 *iImage* 设置为-1。

## <a name="cmfctoolbargetbuttonsize"></a><a name="getbuttonsize"></a> CMFCToolBar：： GetButtonSize

返回工具栏上每个按钮的尺寸。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>返回值

一个 [CSize 类](../../atl-mfc-shared/reference/csize-class.md) 对象，该对象指定工具栏上每个按钮的尺寸。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： SetSizes](#setsizes) 或 [CMFCToolBar：： SetLockedSizes](#setlockedsizes) 来设置工具栏上每个按钮的尺寸。

## <a name="cmfctoolbargetbuttonstyle"></a><a name="getbuttonstyle"></a> CMFCToolBar：： GetButtonStyle

返回位于指定索引处的工具栏按钮的当前样式。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

一个值，该值指定工具栏按钮的样式。 . 有关可能样式的列表，请参阅 [ToolBar 控件样式](../../mfc/reference/toolbar-control-styles.md) 。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： SetButtonStyle](#setbuttonstyle) 以设置工具栏按钮的样式

## <a name="cmfctoolbargetbuttontext"></a><a name="getbuttontext"></a> CMFCToolBar：： GetButtonText

返回具有指定索引的按钮的文本标签。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中工具栏按钮的索引。

*rString*<br/>
弄工具栏按钮的标签文本。

### <a name="return-value"></a>返回值

工具栏按钮的标签文本。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： SetButtonText](#setbuttontext) 或 [CMFCToolBar：： SetToolBarBtnText](#settoolbarbtntext) 设置文本标签。

## <a name="cmfctoolbargetcoldimages"></a><a name="getcoldimages"></a> CMFCToolBar：： GetColdImages

返回指向应用程序中冷工具栏按钮图像的集合的指针。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>返回值

指向冷工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

冷映像是用户不与工具栏按钮交互时使用的图像。 调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 或 [CMFCToolBar：： LoadBitmap](#loadbitmap) 加载冷映像。

## <a name="cmfctoolbargetcolumnwidth"></a><a name="getcolumnwidth"></a> CMFCToolBar：： GetColumnWidth

返回工具栏按钮的宽度。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>返回值

一个值，该值指定工具栏按钮的宽度。

### <a name="remarks"></a>备注

框架调用此方法来计算工具栏布局。 在派生类中重写此方法，以便为工具栏指定不同的列宽。

## <a name="cmfctoolbargetcommandbuttons"></a><a name="getcommandbuttons"></a> CMFCToolBar：： GetCommandButtons

返回一个按钮列表，其中包含应用程序中所有工具栏的指定命令 ID。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>parameters

*uiCmd*<br/>
中按钮的命令 ID。

*listButtons*<br/>
弄对接收工具栏按钮列表的 [CObList 类](../../mfc/reference/coblist-class.md) 对象的引用。

### <a name="return-value"></a>返回值

具有指定命令 ID 的按钮数。

## <a name="cmfctoolbargetcount"></a><a name="getcount"></a> CMFCToolBar：： GetCount

返回工具栏上的按钮和分隔符的数目。

```
int GetCount() const;
```

### <a name="return-value"></a>返回值

工具栏上的按钮和分隔符的数目。

## <a name="cmfctoolbargetcustomizebutton"></a><a name="getcustomizebutton"></a> CMFCToolBar：： GetCustomizeButton

检索指向 `CMFCCustomizeButton` 与工具栏关联的对象的指针。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>返回值

指向 `CMFCCustomizeButton` 与工具栏关联的对象的指针。

### <a name="remarks"></a>备注

此方法检索显示在工具栏末尾的 " **自定义** " 按钮。 使用 [CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton) 方法向工具栏添加 " **自定义** " 按钮。

可以调用 [CMFCToolBar：： IsExistCustomizeButton](#isexistcustomizebutton) 方法来确定工具栏是否包含有效的 `CMFCCustomizeButton` 对象。

## <a name="cmfctoolbargetdefaultimage"></a><a name="getdefaultimage"></a> CMFCToolBar：： GetDefaultImage

返回具有指定命令 ID 的工具栏按钮的默认图像的索引。

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>parameters

*uiID*<br/>
中指定按钮的命令 ID。

### <a name="return-value"></a>返回值

共享的图像列表中的工具栏图像的索引。

### <a name="remarks"></a>备注

使用此共享方法可以检索具有指定命令 ID 的工具栏按钮的默认图像索引。 对于应用程序中的所有工具栏，返回值是到工具栏按钮图像的共享集合中的索引。 调用 [CMFCToolBar：： GetImages](#getimages) 方法以获取指向此集合的指针。

## <a name="cmfctoolbargetdisabledimages"></a><a name="getdisabledimages"></a> CMFCToolBar：： GetDisabledImages

返回一个指针，该指针指向用于应用程序中的已禁用工具栏按钮的图像集合。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>返回值

指向已禁用工具栏按钮图像的集合的指针。

### <a name="remarks"></a>备注

使用 [CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md) 和 [CMFCToolBar：： LoadBitmap](#loadbitmap) 方法加载禁用的工具栏按钮图像。

## <a name="cmfctoolbargetdisabledmenuimages"></a><a name="getdisabledmenuimages"></a> CMFCToolBar：： GetDisabledMenuImages

返回一个指针，该指针指向用于在应用程序中禁用的菜单按钮的图像集合。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>返回值

指向禁用的菜单图像的集合的指针。

### <a name="remarks"></a>备注

使用 [CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md) 方法加载已禁用的映像。

## <a name="cmfctoolbargetdroppeddownmenu"></a><a name="getdroppeddownmenu"></a> CMFCToolBar：： GetDroppedDownMenu

检索指向当前显示其子菜单的菜单按钮对象的指针。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>parameters

*pIndex*<br/>
弄接收工具栏按钮集合中的按钮的索引。

### <a name="return-value"></a>返回值

指向显示其子菜单的菜单按钮对象的指针; 如果没有菜单显示其子菜单，则为 NULL。

### <a name="remarks"></a>备注

如果此方法返回一个非 NULL 值，并且 *pIndex* 不为 null，则 *pIndex* 指向的值将设置为工具栏按钮集合中的菜单按钮的索引。

## <a name="cmfctoolbargetgraydisabledbuttons"></a><a name="getgraydisabledbuttons"></a> CMFCToolBar：： GetGrayDisabledButtons

指定 "已禁用" 按钮的图像是常规按钮图像的模糊版本，还是从禁用的按钮图像的集合中获取的。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>返回值

若要使禁用按钮的图像变暗，则为 TRUE;若为 FALSE，则从已禁用图像的集合中获取映像。

### <a name="remarks"></a>备注

使用 [CMFCToolBar：： SetGrayDisabledButtons](#setgraydisabledbuttons) 从已禁用图像的集合中的灰色图像和图像之间切换。

## <a name="cmfctoolbargethighlightedbutton"></a><a name="gethighlightedbutton"></a> CMFCToolBar：： GetHighlightedButton

返回指向当前突出显示的工具栏按钮的指针。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>返回值

指向工具栏按钮对象的指针;如果未突出显示按钮，则为 NULL。

### <a name="remarks"></a>备注

如果工具栏按钮具有键盘焦点，则突出显示该按钮。 如果在此应用程序中热跟踪了工具栏按钮，则还会突出显示工具栏按钮 (。有关详细信息，请参阅 [CMFCToolBar：： GetHotBorder](#gethotborder) 和 [CMFCToolBar：： SetHotBorder](#sethotborder)) 并且当没有任何工具栏按钮或菜单项具有键盘焦点时鼠标指向它。

## <a name="cmfctoolbargethotborder"></a><a name="gethotborder"></a> CMFCToolBar：： GetHotBorder

确定是否 *热跟踪* 工具栏按钮。 如果按钮是热跟踪的，则当鼠标移动到按钮上时，将突出显示该按钮。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>返回值

如果工具栏按钮被热跟踪，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下，将热跟踪工具栏按钮。

## <a name="cmfctoolbargethottextcolor"></a><a name="gethottextcolor"></a> CMFCToolBar：： GetHotTextColor

返回突出显示的工具栏按钮的文本颜色。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>返回值

一个 [COLORREF](/windows/win32/gdi/colorref) 值，该值表示当前突出显示的文本颜色。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： SetHotTextColor](#sethottextcolor) 为突出显示的工具栏按钮设置新的文本颜色。

## <a name="cmfctoolbargethwndlastfocus"></a><a name="gethwndlastfocus"></a> CMFCToolBar：： GetHwndLastFocus

返回窗口的句柄，该窗口在工具栏执行之前具有输入焦点。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>返回值

不是从 [CMFCBaseToolBar 类](../../mfc/reference/cmfcbasetoolbar-class.md)派生的窗口的句柄，它以前具有输入焦点;如果没有此类窗口，则为 NULL。

### <a name="remarks"></a>备注

当 `CMFCToolBar` 控件接收输入焦点时，它将存储一个失去焦点的窗口的句柄，以便以后可以还原。

## <a name="cmfctoolbargetignoresettext"></a><a name="getignoresettext"></a> CMFCToolBar：： GetIgnoreSetText

指定是否忽略设置按钮标签调用。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>返回值

如果忽略对设置按钮标签的调用，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbargetimages"></a><a name="getimages"></a> CMFCToolBar：： GetImages

返回指向应用程序中的默认按钮图像集合的指针。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>返回值

指向 [CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md) 对象的指针，该对象包含应用程序中所有工具栏的默认图像集合。

### <a name="remarks"></a>备注

此共享方法提供对应用程序的所有默认工具栏图像集合的访问。 调用 [CMFCToolBar：： LoadBitmap](#loadbitmap) 方法将图像添加到集合。

## <a name="cmfctoolbargetimagesize"></a><a name="getimagesize"></a> CMFCToolBar：： GetImageSize

返回工具栏按钮图像的当前大小。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>返回值

表示工具栏按钮图像当前大小的 [CSize 类](../../atl-mfc-shared/reference/csize-class.md) 对象。

## <a name="cmfctoolbargetimagesoffset"></a><a name="getimagesoffset"></a> CMFCToolBar：： GetImagesOffset

返回用于在工具栏按钮图像的全局列表中查找此工具栏的工具栏按钮图像的索引偏移量。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>返回值

工具栏图像的索引偏移量。

### <a name="remarks"></a>备注

所有工具栏默认图像均存储在全局 [CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md) 列表中。 工具栏中每个按钮的图像会连续存储在该列表中。 若要计算图像的索引，请将工具栏上的按钮索引添加到该工具栏按钮的图像列表的开头偏移位置。

调用 [CMFCToolBar：： ButtonToIndex](#buttontoindex) 以获取工具栏按钮的索引（给定指向按钮的指针）。

调用 [CMFCToolBar：： GetImages](#getimages) 以获取指向工具栏图像集合的指针。

## <a name="cmfctoolbargetinvalidateitemrect"></a><a name="getinvalidateitemrect"></a> CMFCToolBar：： GetInvalidateItemRect

检索必须为给定索引处的按钮重绘的工作区区域。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中要为其检索工作区的按钮的索引。

*lpRect*<br/>
弄指向用于接收工作区区域的 RECT 对象的指针。

### <a name="remarks"></a>备注

*LpRect* 参数不能为 NULL。 如果提供的索引处不存在任何按钮， *lpRect* 将收到一个初始化为零的 RECT 对象。

## <a name="cmfctoolbargetitemid"></a><a name="getitemid"></a> CMFCToolBar：： GetItemID

返回指定索引处的工具栏按钮的命令 ID。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

工具栏按钮的命令 ID;如果不存在具有指定索引的按钮，则为零。

## <a name="cmfctoolbargetitemrect"></a><a name="getitemrect"></a> CMFCToolBar：： GetItemRect

返回指定索引处的按钮的边框。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定工具栏按钮的索引。

*lpRect*<br/>
弄指向 `CRect` 对象的指针，该对象接收图像边框的坐标。

### <a name="remarks"></a>备注

`CRect`如果指定索引处的按钮不存在，则将 *lpRect* 点设置为0的对象。

### <a name="example"></a>示例

下面的示例演示如何使用类的 `GetItemRect` 方法 `CMFCToolBar` 。 此代码片段是 [IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

## <a name="cmfctoolbargetlargecoldimages"></a><a name="getlargecoldimages"></a> CMFCToolBar：： GetLargeColdImages

返回一个指向应用程序中大冷工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>返回值

指向大冷图像集合的指针。

### <a name="remarks"></a>备注

冷映像是用户不与工具栏按钮交互时使用的图像。 调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 以加载大冷映像。

## <a name="cmfctoolbargetlargedisabledimages"></a><a name="getlargedisabledimages"></a> CMFCToolBar：： GetLargeDisabledImages

返回一个指针，该指针指向应用程序中的大型已禁用工具栏按钮图像的集合。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>返回值

指向大型禁用工具栏按钮图像的集合的指针。

### <a name="remarks"></a>备注

大型图像是常规工具栏按钮图像的大型版本。 调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 或 [CMFCToolBar：： LoadBitmap](#loadbitmap) 加载大图像。

## <a name="cmfctoolbargetlargeimages"></a><a name="getlargeimages"></a> CMFCToolBar：： GetLargeImages

返回指向应用程序中大工具栏按钮图像集合的指针。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>返回值

指向大型工具栏按钮图像的集合的指针。

### <a name="remarks"></a>备注

大型图像是常规工具栏按钮图像的大型版本。 调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 以加载大图像。

## <a name="cmfctoolbargetlockedcoldimages"></a><a name="getlockedcoldimages"></a> CMFCToolBar：： GetLockedColdImages

返回一个指针，该指针指向工具栏中锁定的冷图像的集合。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>返回值

指向已锁定的冷图像集合的指针; 如果工具栏未锁定，则为 NULL。

### <a name="remarks"></a>备注

锁定的图像是框架在用户无法自定义工具栏时使用的常规工具栏按钮图像的版本。 冷映像是用户不与工具栏按钮交互时使用的图像。

如果工具栏未锁定，则此方法返回 NULL。 如果工具栏未锁定，则此方法还会在调试版本中生成断言失败。 有关锁定的工具栏的详细信息，请参阅 [CMFCToolBar：： IsLocked](#islocked)。

调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 方法加载锁定的冷映像。

## <a name="cmfctoolbargetlockeddisabledimages"></a><a name="getlockeddisabledimages"></a> CMFCToolBar：： GetLockedDisabledImages

返回指向工具栏中被锁定的已禁用图像的集合的指针。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>返回值

指向锁定的已禁用图像的集合的指针; 如果工具栏未锁定，则为 NULL。

### <a name="remarks"></a>备注

锁定的图像是框架在用户无法自定义工具栏时使用的常规工具栏按钮图像的版本。 禁用的图像是指在按钮具有 TBBS_DISABLED 样式时框架使用的图像。

如果工具栏未锁定，则此方法返回 NULL。 如果工具栏未锁定，则此方法还会在调试版本中生成断言失败。 有关锁定的工具栏的详细信息，请参阅 [CMFCToolBar：： IsLocked](#islocked)。

调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 方法加载锁定的禁用映像。

## <a name="cmfctoolbargetlockedimages"></a><a name="getlockedimages"></a> CMFCToolBar：： GetLockedImages

返回一个指针，该指针指向工具栏中锁定的按钮图像的集合。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>返回值

指向锁定的工具栏按钮图像的集合的指针; 如果工具栏未锁定，则为 NULL。

### <a name="remarks"></a>备注

锁定的图像是框架在用户无法自定义工具栏时使用的常规工具栏按钮图像的版本。

如果工具栏未锁定，则此方法返回 NULL。 如果工具栏未锁定，则此方法还会在调试版本中生成断言失败。 有关锁定的工具栏的详细信息，请参阅 [CMFCToolBar：： IsLocked](#islocked)。

## <a name="cmfctoolbargetlockedimagesize"></a><a name="getlockedimagesize"></a> CMFCToolBar：： GetLockedImageSize

返回锁定的工具栏图像的默认大小。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>返回值

一个 `CSize` 结构，它指定锁定的工具栏图像的大小， `CSize` 如果未锁定工具栏，则为空结构。

### <a name="remarks"></a>备注

锁定的图像是框架在用户无法自定义工具栏时使用的常规工具栏按钮图像的版本。

如果工具栏未锁定，则此方法返回 `CSize` 宽度为零的结构。 如果工具栏未锁定，则此方法还会在调试版本中生成断言失败。 有关锁定的工具栏的详细信息，请参阅 [CMFCToolBar：： IsLocked](#islocked)。

调用 [CMFCToolBar：： SetLockedSizes](#setlockedsizes) 方法来指定锁定的图像大小。

## <a name="cmfctoolbargetlockedmenuimages"></a><a name="getlockedmenuimages"></a> CMFCToolBar：： GetLockedMenuImages

返回指向工具栏中锁定的工具栏菜单图像的集合的指针。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>返回值

指向锁定的工具栏菜单图像的集合的指针; 如果工具栏未锁定，则为 NULL。

### <a name="remarks"></a>备注

锁定的图像是框架在用户无法自定义工具栏时使用的常规工具栏菜单图像的版本。

如果工具栏未锁定，则此方法返回 NULL。 如果工具栏未锁定，则此方法还会在调试版本中生成断言失败。 有关锁定的工具栏的详细信息，请参阅 [CMFCToolBar：： IsLocked](#islocked)。

调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 方法加载锁定的菜单图像。

## <a name="cmfctoolbargetmenubuttonsize"></a><a name="getmenubuttonsize"></a> CMFCToolBar：： GetMenuButtonSize

返回应用程序中菜单按钮的大小。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>返回值

一个 `CSize` 对象，它表示菜单按钮的大小（以像素为单位）。

### <a name="remarks"></a>备注

工具栏上的菜单按钮的大小作为全局变量维护，可以通过此静态方法进行检索。

调用 [CMFCToolBar：： SetMenuSizes](#setmenusizes) 以设置此全局变量。

## <a name="cmfctoolbargetmenuimages"></a><a name="getmenuimages"></a> CMFCToolBar：： GetMenuImages

返回指向应用程序中的菜单按钮图像集合的指针。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>返回值

指向菜单图像集合的指针。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex) 方法加载菜单图像。

调用 [CMFCToolBar：： SetMenuSizes](#setmenusizes) 方法来设置按钮及其图像的大小。

## <a name="cmfctoolbargetmenuimagesize"></a><a name="getmenuimagesize"></a> CMFCToolBar：： GetMenuImageSize

返回应用程序中菜单按钮图像的大小。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>返回值

一个 `CSize` 对象，表示菜单图像的大小。

### <a name="remarks"></a>备注

此方法返回工具栏菜单按钮上作为全局变量维护的图像的大小。 调用 [CMFCToolBar：： SetMenuSizes](#setmenusizes) 以设置此全局变量。

## <a name="cmfctoolbargetorigbuttons"></a><a name="getorigbuttons"></a> CMFCToolBar：： GetOrigButtons

检索工具栏的非自定义按钮的集合。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>返回值

对工具栏的非自定义按钮列表的引用。

### <a name="remarks"></a>备注

框架在用户自定义工具栏按钮之前创建它们的副本。 [CMFCToolBar：： SetButtons](#setbuttons)方法将提供的数组中每个按钮的副本添加到原始按钮的列表。 [CMFCToolBar：： RestoreOriginalState](#restoreoriginalstate)方法通过从资源文件加载来还原工具栏的原始状态。

若要设置您的工具栏的原始按钮列表，请调用 [CMFCToolBar：： SetOrigButtons](#setorigbuttons) 方法。

## <a name="cmfctoolbargetorigresetbuttons"></a><a name="getorigresetbuttons"></a> CMFCToolBar：： GetOrigResetButtons

检索工具栏的非自定义重置按钮的集合。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>返回值

对工具栏的非自定义重置按钮列表的引用。

### <a name="remarks"></a>备注

当用户在自定义模式中单击 " **重置** " 按钮时，框架使用此方法还原已从工具栏中删除的按钮。

在调用[CMFCToolBar：： OnReset](#onreset)方法后， [CMFCToolBar：： SetButtons](#setbuttons)方法会将每个工具栏按钮的副本添加到原始重置按钮列表。 您可以重写 [CMFCToolBar：： OnReset](#onreset) 方法，以便在用户按下 " **重置** " 按钮后自定义按钮的外观。

## <a name="cmfctoolbargetresourceid"></a><a name="getresourceid"></a> CMFCToolBar：： GetResourceID

检索工具栏的资源 ID。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>返回值

工具栏的资源 ID。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： LoadToolBarEx](#loadtoolbarex) 方法来设置工具栏的资源 ID。

## <a name="cmfctoolbargetroutecommandsviaframe"></a><a name="getroutecommandsviaframe"></a> CMFCToolBar：： GetRouteCommandsViaFrame

确定父框架或所有者将命令发送到工具栏的对象。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>返回值

如果父框架向工具栏发送命令，则为非零值;如果所有者将命令发送到工具栏，则为0。

### <a name="remarks"></a>备注

默认情况下，父框架向工具栏发送命令。 调用 [CMFCToolBar：： SetRouteCommandsViaFrame](#setroutecommandsviaframe) 以更改此行为。

如果此方法返回一个非零值，则可以使用方法检索指向父框架对象的指针 `CMFCToolBar::GetCommandTarget` 。 有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

## <a name="cmfctoolbargetrowheight"></a><a name="getrowheight"></a> CMFCToolBar：： GetRowHeight

返回工具栏按钮的高度。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>返回值

工具栏按钮的高度（以像素为单位）。

### <a name="remarks"></a>备注

框架调用此方法来计算工具栏布局。 在派生类中重写此方法，以指定工具栏的不同高度。

## <a name="cmfctoolbargetshowtooltips"></a><a name="getshowtooltips"></a> CMFCToolBar：： GetShowTooltips

指定是否为工具栏按钮显示工具提示。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>返回值

如果为工具栏按钮显示工具提示，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下，将显示工具提示。 可以通过调用 [CMFCToolBar：： SetShowTooltips](#setshowtooltips)来更改此静态标志。

## <a name="cmfctoolbargetsiblingtoolbar"></a><a name="getsiblingtoolbar"></a> CMFCToolBar：： GetSiblingToolBar

检索工具栏的同级。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>返回值

指向同级工具栏的指针。

### <a name="remarks"></a>备注

有关如何启用在 **一行上显示按钮** 并在 **两个行按钮上显示按钮** 的详细信息，请参阅 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar)。

## <a name="cmfctoolbargetuserimages"></a><a name="getuserimages"></a> CMFCToolBar：： GetUserImages

返回一个指向应用程序中用户定义工具栏按钮图像的集合的指针。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>返回值

指向应用程序中所有工具栏的用户定义工具栏按钮图像集合的指针。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： SetUserImages](#setuserimages) 方法以在应用程序中设置用户定义图像的集合。

## <a name="cmfctoolbarhittest"></a><a name="hittest"></a> CMFCToolBar：： System.windows.media.visualtreehelper.hittest

返回位于指定位置的工具栏按钮的索引。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>parameters

*情况*<br/>
中要测试的点，采用工作区坐标。

### <a name="return-value"></a>返回值

位于指定位置的按钮的索引; 或者，如果没有此类按钮或该按钮是分隔符，则为-1。

## <a name="cmfctoolbarinsertbutton"></a><a name="insertbutton"></a> CMFCToolBar：： InsertButton

将按钮插入到工具栏中。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>parameters

*鼠标*<br/>
中指定要插入的按钮。

*iInsertAt*<br/>
中指定在其上插入按钮的从零开始的位置。

### <a name="return-value"></a>返回值

按钮的插入位置; 如果发生错误，则为-1。

### <a name="remarks"></a>备注

如果 *iInsertAt* 为-1，则此方法会将按钮添加到工具栏按钮列表的末尾。

调用 [CMFCToolBar：： InsertSeparator](#insertseparator) 方法以在工具栏中插入分隔符。

## <a name="cmfctoolbarinsertseparator"></a><a name="insertseparator"></a> CMFCToolBar：： InsertSeparator

在工具栏中插入分隔符。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>parameters

*iInsertAt*<br/>
中指定插入分隔符的位置（从零开始）。 此参数必须大于0。

### <a name="return-value"></a>返回值

插入分隔符的位置; 如果发生错误，则为-1。

### <a name="remarks"></a>备注

调用此方法可在两个现有按钮之间插入分隔符。 如果 *iInsertAt* 为-1，则此方法将分隔符添加到工具栏按钮列表的末尾。

不能使用此方法将分隔符添加到空白工具栏。

调用 [CMFCToolBar：： InsertButton](#insertbutton) 方法将按钮插入到工具栏中。

## <a name="cmfctoolbarinvalidatebutton"></a><a name="invalidatebutton"></a> CMFCToolBar：： InvalidateButton

使所提供的索引中存在的工具栏按钮的工作区失效。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中工具栏中的按钮的从零开始的索引。

### <a name="return-value"></a>返回值

指向位于 `CMFCToolBarButton` 所提供索引处的对象的指针; 如果不存在这样的对象，则为 NULL。

### <a name="remarks"></a>备注

当框架更新与工具栏按钮关联的工作区时，框架会调用此方法。 它调用了 [CWnd：： InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect) 方法，其中包含 `CMFCToolBarButton` 提供的索引处存在的对象的客户端矩形。

## <a name="cmfctoolbarisaddremovequickcustomize"></a><a name="isaddremovequickcustomize"></a> CMFCToolBar：： IsAddRemoveQuickCustomize

确定用户是否可以通过使用 " **自定义** " 菜单选项来添加或移除工具栏按钮。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>返回值

如果用户可以使用 " **自定义** " 菜单选项修改工具栏，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisaltcustomizemode"></a><a name="isaltcustomizemode"></a> CMFCToolBar：： IsAltCustomizeMode

指定是否使用 *快速自定义* 来拖动按钮。 启用快速自定义后，用户可以按住 Alt 键并将按钮拖动到新位置。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>返回值

如果使用快速自定义拖动按钮，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisautograyinactiveimages"></a><a name="isautograyinactiveimages"></a> CMFCToolBar：： IsAutoGrayInactiveImages

指定是否启用非突出显示 (非突出显示) 按钮图像的自动生成。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>返回值

如果启用自动 dim 非活动图像的选项，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

可以通过调用 [CMFCToolBar：： AutoGrayInactiveImages](#autograyinactiveimages)启用或禁用非活动映像的自动变暗。

## <a name="cmfctoolbarisbasiccommand"></a><a name="isbasiccommand"></a> CMFCToolBar：： IsBasicCommand

确定命令是否在基本命令列表中。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>parameters

*uiCmd*<br/>
中指定要检查的命令。

### <a name="return-value"></a>返回值

如果指定的命令属于基本命令列表，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此静态方法确定由 *uiCmd* 指定的命令是否属于基本命令的全局列表。 可以通过调用 [CMFCToolBar：： AddBasicCommand](#addbasiccommand) 或 [CMFCToolBar：： SetBasicCommands](#setbasiccommands)来更改基本命令的列表。

## <a name="cmfctoolbarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a> CMFCToolBar：： IsButtonExtraSizeAvailable

确定工具栏是否可以显示具有扩展边框的按钮。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>返回值

如果栏可以显示具有额外边框大小的按钮，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果 toolbar 对象可以显示具有扩展边框的按钮，则它将返回 TRUE。 工具栏按钮在处理 [CMFCToolBarButton：： OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd) 通知时将调用此方法，并相应地设置其内部额外边框大小标志。 稍后可通过调用 [CMFCToolBarButton：： IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)检索此内部标志。

在从派生的类中重写此方法 `CMFCToolBar` ，如果您的栏可以显示带有额外边框大小的工具栏按钮，则返回 TRUE，否则返回 FALSE。 默认实现返回 TRUE。

## <a name="cmfctoolbarisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a> CMFCToolBar：： IsButtonHighlighted

确定是否突出显示指定的按钮。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>parameters

*iButton*<br/>
中指定工具栏按钮的索引。

### <a name="return-value"></a>返回值

如果突出显示指定的按钮，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbariscommandpermitted"></a><a name="iscommandpermitted"></a> CMFCToolBar：： IsCommandPermitted

确定是否允许命令。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>parameters

*uiCmd*<br/>
中指定要检查的命令。

### <a name="return-value"></a>返回值

如果允许指定的命令，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此静态方法确定由 *uiCmd* 指定的命令是否属于非允许的命令的全局列表。

可以通过调用 [CMFCToolBar：： SetNonPermittedCommands](#setnonpermittedcommands)来更改不允许的命令的列表。

## <a name="cmfctoolbariscommandrarelyused"></a><a name="iscommandrarelyused"></a> CMFCToolBar：： IsCommandRarelyUsed

确定是否很少使用某个命令。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>parameters

*uiCmd*<br/>
中指定要检查的命令。

### <a name="return-value"></a>返回值

如果指定的命令很少使用，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

`IsCommandRarelyUsed`当出现以下一种或多种情况时，此方法将返回 FALSE：

- 指定的命令属于基本命令列表

- 指定的命令是标准命令之一

- 框架处于自定义模式

- 基本命令列表为空

- 超过20% 的命令调用是对指定命令的调用。

## <a name="cmfctoolbariscustomizemode"></a><a name="iscustomizemode"></a> CMFCToolBar：： IsCustomizeMode

指定工具栏框架是否处于自定义模式。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>返回值

如果框架处于自定义模式，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

可以通过调用 [CMFCToolBar：： SetCustomizeMode](#setcustomizemode)切换自定义模式。

当用户调用自定义对话框 ( [CMFCToolBarsCustomizeDialog 类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)) 时，框架会更改模式。

## <a name="cmfctoolbarisdragbutton"></a><a name="isdragbutton"></a> CMFCToolBar：： IsDragButton

确定是否正在拖动工具栏按钮。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向工具栏按钮的指针。

### <a name="return-value"></a>返回值

如果正在拖动指定的按钮，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisexistcustomizebutton"></a><a name="isexistcustomizebutton"></a> CMFCToolBar：： IsExistCustomizeButton

确定工具栏是否包含 " **自定义** " 按钮。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>返回值

如果工具栏包含 " **自定义** " 按钮，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果此方法返回 TRUE，则 [CMFCToolBar：： GetCustomizeButton](#getcustomizebutton) 方法将返回一个指针，该指针指向出现在工具栏末尾的 " **自定义** " 按钮。

使用 [CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton) 方法向工具栏添加 " **自定义** " 按钮。

## <a name="cmfctoolbarisfloating"></a><a name="isfloating"></a> CMFCToolBar：： IsFloating

确定工具栏是否浮动。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>返回值

如果工具栏是浮动工具栏，则为 TRUE;否则为 FALSE。

## <a name="cmfctoolbarislargeicons"></a><a name="islargeicons"></a> CMFCToolBar：： IsLargeIcons

指定应用程序中的工具栏当前是否显示大图标。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>返回值

如果应用程序使用大图标，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

调用 [CMFCToolBar：： SetLargeIcons](#setlargeicons) 可在大图标和常规图标之间切换。

当用户在 "**自定义**" 对话框的 "**选项**" 页上切换 "**大图标**" 复选框时，框架会自动更改模式。

## <a name="cmfctoolbarislastcommandfrombutton"></a><a name="islastcommandfrombutton"></a> CMFCToolBar：： IsLastCommandFromButton

确定是否从指定工具栏按钮发送最近执行的命令。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向按钮的指针。

### <a name="return-value"></a>返回值

如果从 *pButton* 指定的按钮发送了最后一个命令，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法通过调用获取指向 [MSG 结构](/windows/win32/api/winuser/ns-winuser-msg) 的指针 `CWnd::GetCurrentMessage` 。 然后，它会将该按钮的 HWND 与 `MSG::lParam` 和 `MSG::hwnd` 成员进行比较，以确定该按钮是否是命令源。

## <a name="cmfctoolbarislocked"></a><a name="islocked"></a> CMFCToolBar：： IsLocked

确定工具栏是否处于锁定状态。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>返回值

如果工具栏被锁定，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果用户无法执行自定义任务（如重定位工具栏按钮），则此方法返回 TRUE。

锁定的工具栏使用单独的图像列表。 有关这些图像列表的详细信息，请参阅 [CMFCToolBar：： LoadBitmapEx](#loadbitmapex)。

## <a name="cmfctoolbarisonerowwithsibling"></a><a name="isonerowwithsibling"></a> CMFCToolBar：： IsOneRowWithSibling

确定工具栏及其同级工具栏是否定位在同一行上。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>返回值

如果工具栏及其同级位于同一行上，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

[CMFCCustomizeButton：： CreatePopupMenu](internal-classes.md)方法调用此方法以确定如何显示 "**自定义**" 弹出菜单。 如果此方法返回 TRUE，则框架将显示 " **在一行上显示按钮** " 按钮。 否则，框架将显示 **两行按钮上的 "显示按钮** "。

通常不需要使用此方法。 若要启用 " **在一行上显示按钮** " 或 " **在两行上显示** 按钮" 按钮，请调用 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar)。

## <a name="cmfctoolbarisresourcechanged"></a><a name="isresourcechanged"></a> CMFCToolBar：： IsResourceChanged

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarissibling"></a><a name="issibling"></a> CMFCToolBar：： IsSibling

```
BOOL IsSibling();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarisuserdefined"></a><a name="isuserdefined"></a> CMFCToolBar：： IsUserDefined

指定工具栏是否为用户定义的。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>返回值

如果工具栏是由用户创建的，则为 TRUE;否则为 FALSE。

## <a name="cmfctoolbarloadbitmap"></a><a name="loadbitmap"></a> CMFCToolBar：： LoadBitmap

从应用程序资源加载工具栏图像。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>parameters

*uiResID*<br/>
中引用热工具栏图像的位图的资源 ID。

*uiColdResID*<br/>
中用于引用冷工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
中引用常规菜单图像的位图的资源 ID。

*对方*<br/>
中若要锁定工具栏，则为 TRUE;否则为 FALSE。

*uiDisabledResID*<br/>
中引用禁用工具栏图像的位图的资源 ID。

*uiMenuDisabledResID*<br/>
中引用禁用的菜单图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

[CMFCToolBar::LoadToolBarEx](#loadtoolbarex) 方法调用此方法以加载与工具栏关联的图像。 重写此方法以执行图像资源的自定义加载。

调用 `LoadBitmapEx` 方法以在创建工具栏后加载其他图像。

## <a name="cmfctoolbarloadbitmapex"></a><a name="loadbitmapex"></a> CMFCToolBar：： LoadBitmapEx

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>parameters

中 *params*<br/>
中已 *阻止*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarloadlargeiconsstate"></a><a name="loadlargeiconsstate"></a> CMFCToolBar：： LoadLargeIconsState

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>parameters

中 *lpszProfileName*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarloadparameters"></a><a name="loadparameters"></a> CMFCToolBar：： LoadParameters

从 Windows 注册表加载全局工具栏选项。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>parameters

*lpszProfileName*<br/>
中指定 Windows 注册表项的相对路径。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

此方法加载全局参数（如菜单动画类型、菜单阴影样式）以及是否显示 Windows 注册表中的大图标。

在应用程序的初始化过程中， [CWinAppEx：： LoadState](../../mfc/reference/cwinappex-class.md#loadstate) 方法调用此方法。

## <a name="cmfctoolbarloadstate"></a><a name="loadstate"></a> CMFCToolBar：： LoadState

从 Windows 注册表加载工具栏状态信息。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>parameters

*lpszProfileName*<br/>
中指定 Windows 注册表项的相对路径。

*nIndex*<br/>
中指定工具栏的控件 ID。

*uiID*<br/>
中指定工具栏的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架在应用程序的初始化过程中调用此方法。 有关详细信息，请参阅 [CWinAppEx：： LoadState](../../mfc/reference/cwinappex-class.md#loadstate)。

## <a name="cmfctoolbarloadtoolbar"></a><a name="loadtoolbar"></a> CMFCToolBar：： LoadToolBar

从应用程序资源加载工具栏。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>parameters

*uiResID*<br/>
中工具栏的资源 ID。

*uiColdResID*<br/>
中用于引用冷工具栏图像的位图的资源 ID。

*uiMenuResID*<br/>
中引用常规菜单图像的位图的资源 ID。

*对方*<br/>
中一个布尔值，该值指定工具栏是否已锁定。 如果此参数为 *TRUE*，则工具栏处于锁定状态。 否则，工具栏未锁定。

*uiDisabledResID*<br/>
中引用禁用工具栏图像的位图的资源 ID。

*uiMenuDisabledResID*<br/>
中引用禁用的菜单图像的位图的资源 ID。

*uiHotResID*<br/>
中引用热工具栏图像的位图的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架在初始化期间调用此方法以加载与工具栏关联的图像。

### <a name="example"></a>示例

下面的示例演示如何使用 `LoadToolBar` 类中的方法 `CMFCToolBar` 。 此代码片段是 [IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbarloadtoolbarex"></a><a name="loadtoolbarex"></a> CMFCToolBar：： LoadToolBarEx

使用 helper 类从应用程序资源加载工具栏 `CMFCToolBarInfo` ，以使应用程序能够使用较大的图像。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>parameters

*uiToolbarResID*<br/>
中工具栏的资源 ID。

*params*<br/>
中对 `CMFCToolBarInfo` 对象的引用，该对象包含工具栏图像的资源 id。

*对方*<br/>
中一个布尔值，该值指定工具栏是否已锁定。 如果此参数为 TRUE，则工具栏处于锁定状态。 否则，工具栏未锁定。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

调用此方法以从应用程序资源加载工具栏图像。

## <a name="cmfctoolbarm_dbllargeimageratio"></a><a name="m_dbllargeimageratio"></a> CMFCToolBar：： m_dblLargeImageRatio

指定大型图像的维度 (高度或宽度) 与常规图像维度的比率。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>备注

默认比率为2。 您可以更改此值以放大或缩小大的工具栏图像。

如果未指定一组大图像，框架将使用此数据成员。 例如，如果只提供大小为16x16 的小图像集，并希望大图像的大小为24x24，则将此数据成员设置为1.5。

## <a name="cmfctoolbarnextmenu"></a><a name="nextmenu"></a> CMFCToolBar：： NextMenu

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronbeforeremovebutton"></a><a name="onbeforeremovebutton"></a> CMFCToolBar：： OnBeforeRemoveButton

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中用.

*dropEffect*<br/>
中用.

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronchangehot"></a><a name="onchangehot"></a> CMFCToolBar：： OnChangeHot

当用户选择工具栏上的按钮时由框架调用。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>parameters

*iHot*<br/>
中指定所选工具栏按钮的索引;如果未选择任何工具栏按钮，则为-1。

### <a name="remarks"></a>备注

重写此方法以处理用户在工具栏上选择了一个按钮的通知。

## <a name="cmfctoolbaronchangevisualmanager"></a><a name="onchangevisualmanager"></a> CMFCToolBar：： OnChangeVisualManager

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronfillbackground"></a><a name="onfillbackground"></a> CMFCToolBar：： OnFillBackground

由 [CBasePane：:D opaint](../../mfc/reference/cbasepane-class.md#dopaint) 中的框架调用以填充工具栏背景。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="remarks"></a>备注

[CMFCToolBar：](#dopaint) 当工具栏的背景已填充时，:D opaint 调用此方法。 默认实现不执行任何操作。

重写此方法可在派生类中绘制自定义背景。

## <a name="cmfctoolbaronglobalfontschanged"></a><a name="onglobalfontschanged"></a> CMFCToolBar：： OnGlobalFontsChanged

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronreset"></a><a name="onreset"></a> CMFCToolBar：： OnReset

将工具栏还原到其原始状态。

```
virtual void OnReset();
```

### <a name="remarks"></a>备注

重写此方法以处理有关工具栏重置的通知。

默认实现不执行任何操作。 `OnReset`在从派生的类中重写 `CMFCToolBar` 时，如果工具栏具有在工具栏返回到其原始状态时必须被替换的虚按钮，则为。

## <a name="cmfctoolbaronsetaccdata"></a><a name="onsetaccdata"></a> CMFCToolBar：： OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>parameters

中 *lVal*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a> CMFCToolBar：： OnSetDefaultButtonText

将工具栏按钮的文本还原为其默认状态。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向按钮，其文本正在设置。

### <a name="return-value"></a>返回值

已成功还原 TRUE ifthe 文本;否则为 FALSE。

### <a name="remarks"></a>备注

重写此方法可处理通知，提示工具栏文本的文本将更改为其默认值。

默认实现将从应用程序资源加载按钮的文本。

## <a name="cmfctoolbaronusertooltip"></a><a name="onusertooltip"></a> CMFCToolBar：： OnUserToolTip

当要显示按钮的工具提示时，由框架调用。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向要为其显示工具提示的工具栏按钮。

*strTTText*<br/>
弄对 `CString` 接收工具提示文本的对象的引用。

### <a name="return-value"></a>返回值

如果 *strTTText* 是用工具提示文本填充的，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

当要显示工具栏按钮的工具提示时，框架会调用此方法。 如果 `OnUserToolTip` 返回 TRUE，则框架将显示一个工具提示，其中包含 `OnUserToolTip` *strTTText* 中返回的文本。 否则，tooltip 包含按钮文本。

重写 `OnUserToolTip` 以自定义工具栏按钮的工具提示。 默认实现将调用 [CMFCToolBar：： OnUserToolTip](#onusertooltip) 以获取工具提示文本。

## <a name="cmfctoolbarprevmenu"></a><a name="prevmenu"></a> CMFCToolBar：:P revMenu

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarprocesscommand"></a><a name="processcommand"></a> CMFCToolBar：:P rocessCommand

向拥有工具栏的窗口发送 WM_COMMAND 消息。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向工具栏上的按钮的指针。

### <a name="return-value"></a>返回值

此方法应始终返回 TRUE。 MFC 在内部使用 FALSE 值。

### <a name="remarks"></a>备注

此方法通过调用 [CWnd：:P ostmessage](../../mfc/reference/cwnd-class.md#postmessage) 并传递指定按钮的命令 ID 作为 *wParam* 参数，将 WM_COMMAND 消息发布到拥有工具栏的窗口。

使用 [ON_COMMAND](message-map-macros-mfc.md#on_command) 宏将 WM_COMMAND 消息映射到成员函数。

## <a name="cmfctoolbarremoveallbuttons"></a><a name="removeallbuttons"></a> CMFCToolBar：： RemoveAllButtons

从工具栏中删除所有按钮和分隔符。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>备注

框架在重新创建或销毁工具栏时调用此方法。

## <a name="cmfctoolbarremovebutton"></a><a name="removebutton"></a> CMFCToolBar：： RemoveButton

从工具栏中删除具有指定索引的按钮。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>parameters

*iIndex*<br/>
中指定要删除的按钮的从零开始的索引。

### <a name="return-value"></a>返回值

如果该方法成功，则为 TRUE; 如果指定的索引无效或索引引用 " **自定义** " 按钮，则为 FALSE。

### <a name="remarks"></a>备注

此方法更新受删除按钮影响的其他工具栏属性。 例如，此方法从工具栏中删除不重要的分隔符，然后重新生成快捷方式表。

有关 " **自定义** " 按钮的详细信息，请参阅 [CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton)。

## <a name="cmfctoolbarremovestatefromregistry"></a><a name="removestatefromregistry"></a> CMFCToolBar：： RemoveStateFromRegistry

从 Windows 注册表中删除工具栏的状态信息。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>parameters

*lpszProfileName*<br/>
中指定状态信息所在的注册表项。

*nIndex*<br/>
中工具栏的控件 ID。

*uiID*<br/>
中工具栏的资源 ID。 如果此参数为-1，则此方法使用 [CWnd：： GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid) 方法检索资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

框架在删除用户定义的工具栏时调用此方法。

如果在 Windows 注册表中存储附加状态信息，则重写此方法。

## <a name="cmfctoolbarreplacebutton"></a><a name="replacebutton"></a> CMFCToolBar：： ReplaceButton

使用另一个工具栏按钮替换工具栏按钮。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>parameters

*uiCmd*<br/>
中要替换的按钮的命令 ID。

*鼠标*<br/>
中对要插入的的引用 `CMFCToolBarButton` 。

*滚*<br/>
中一个布尔值，指定是否替换具有 *uiCmd* 指定的命令 ID 的所有按钮。 如果此参数为 TRUE，则将替换具有指定的命令 ID 的所有按钮。 否则，将替换第一个按钮。

### <a name="return-value"></a>返回值

被替换的按钮数。 如果工具栏上不存在具有指定命令 ID 的按钮，则此方法返回0。

### <a name="remarks"></a>备注

如果要添加无法从资源加载的工具栏按钮，请调用此方法。 您可以在设计时创建一个占位符按钮，并在初始化工具栏时将该按钮替换为自定义按钮。 有关使用此方法的示例，请参阅 VisualStudioDemo 示例。

### <a name="example"></a>示例

下面的示例演示如何使用 `ReplaceButton` 类中的方法 `CMFCToolBar` 。 此代码片段是 [IE 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

## <a name="cmfctoolbarresetall"></a><a name="resetall"></a> CMFCToolBar：： ResetAll

将所有工具栏还原到其原始状态。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>备注

此方法对应用程序中可还原的每个工具栏调用 [CMFCToolBar：： RestoreOriginalState](#restoreoriginalstate) 方法。 它使用 [CMFCToolBar：： CanBeRestored](#canberestored) 方法来确定是否可以还原工具栏。

## <a name="cmfctoolbarresetallimages"></a><a name="resetallimages"></a> CMFCToolBar：： ResetAllImages

清除应用程序中的所有工具栏图像集合。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>备注

此方法清除由 [CMFCToolBar：： LoadToolBar](#loadtoolbar) 和 [CMFCToolBar：： LoadBitmap](#loadbitmap) 方法初始化的图像集合。

## <a name="cmfctoolbarresetimages"></a><a name="resetimages"></a> CMFCToolBar：： ResetImages

```
virtual void ResetImages();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarrestorefocus"></a><a name="restorefocus"></a> CMFCToolBar：： RestoreFocus

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a> CMFCToolBar：： RestoreOriginalState

还原工具栏的原始状态。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>返回值

如果该方法成功，则为 TRUE; 如果该方法失败或工具栏是用户定义的，则为 FALSE。

### <a name="remarks"></a>备注

此方法通过使用 [CMFCToolBar：： LoadToolBar](#loadtoolbar) 方法从资源文件加载工具栏。

当用户在自定义对话框的 "**工具栏**" 页上选择 "**全部重置**" 按钮时，框架会调用此方法。

## <a name="cmfctoolbarsaveparameters"></a><a name="saveparameters"></a> CMFCToolBar：： SaveParameters

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>parameters

中 *lpszProfileName*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsavestate"></a><a name="savestate"></a> CMFCToolBar：： SaveState

为 Windows 注册表中的工具栏保存状态信息。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>parameters

*lpszProfileName*<br/>
中指定 Windows 注册表项的相对路径。

*nIndex*<br/>
中工具栏的控件 ID。

*uiID*<br/>
中工具栏的资源 ID。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

在将应用程序状态保存到注册表时，框架会调用此方法。 有关详细信息，请参阅 [CWinAppEx：： SaveState](../../mfc/reference/cwinappex-class.md#savestate)。

## <a name="cmfctoolbarsetbasiccommands"></a><a name="setbasiccommands"></a> CMFCToolBar：： SetBasicCommands

设置用户打开菜单时始终显示的命令的列表。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>parameters

*lstCommands*<br/>
中对 `CList` 包含命令集合的对象的引用。

### <a name="remarks"></a>备注

打开菜单时，将始终显示基本命令。 当用户选择查看最近使用的命令时，此方法是有意义的。

使用 [CMFCToolBar：： AddBasicCommand](#addbasiccommand) 方法将命令添加到基本命令列表中。 使用 [CMFCToolBar：： GetBasicCommands](#getbasiccommands) 方法检索应用程序所使用的基本命令的列表。

有关使用此方法的示例，请参阅资源管理器示例。

## <a name="cmfctoolbarsetbuttoninfo"></a><a name="setbuttoninfo"></a> CMFCToolBar：： SetButtonInfo

设置工具栏按钮的命令 ID、样式和图像 ID。

```cpp
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中设置了其属性的按钮的从零开始的索引。

*nID*<br/>
中按钮的命令 ID。

*nStyle*<br/>
中按钮的样式。 有关可用工具栏按钮样式的列表，请参阅 [Toolbar 控件样式](../../mfc/reference/toolbar-control-styles.md) 。

*iImage*<br/>
中按钮的从零开始的图像索引 (即，工具栏图像集合中的索引) 。

### <a name="remarks"></a>备注

调用此方法可设置工具栏按钮的属性。

在调试版本中，如果 *nIndex* 指定的索引无效，此方法将生成断言失败。

调用 [CMFCToolBar：： SetButtonStyle](#setbuttonstyle) 方法以便仅设置按钮的样式。

## <a name="cmfctoolbarsetbuttons"></a><a name="setbuttons"></a> CMFCToolBar：： SetButtons

设置工具栏按钮。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>parameters

*lpIDArray*<br/>
中指向要插入的按钮的命令 Id 的数组的指针。

*nIDCount*<br/>
中 *LpIDArray* 中的项数。

*bRemapImages*<br/>
中一个布尔值，指定是否将现有按钮图像与插入的按钮相关联。 如果此参数为 TRUE，则图像将重新映射。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零；否则为零。

### <a name="remarks"></a>备注

调用此方法可从工具栏中删除现有按钮，并插入新按钮的集合。

此方法将 " **自定义** " 按钮添加到工具栏，并将 AFX_WM_RESETTOOLBAR 消息发送到工具栏的父窗口。 有关 " **自定义** " 按钮的详细信息，请参阅 [CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton)。

## <a name="cmfctoolbarsetbuttonstyle"></a><a name="setbuttonstyle"></a> CMFCToolBar：： SetButtonStyle

设置给定索引处的工具栏按钮的样式。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中要设置其样式的工具栏按钮的从零开始的索引。

*nStyle*<br/>
中按钮的样式。 有关可用工具栏按钮样式的列表，请参阅 [Toolbar 控件样式](../../mfc/reference/toolbar-control-styles.md) 。

### <a name="remarks"></a>备注

如果 *nStyle* 是 TBBS_DISABLED，则此方法会删除 TBBS_PRESSED 样式，因为用户不能单击禁用的按钮。

## <a name="cmfctoolbarsetbuttontext"></a><a name="setbuttontext"></a> CMFCToolBar：： SetButtonText

设置工具栏按钮的文本标签。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中工具栏按钮的索引。

*lpszText*<br/>
中工具栏按钮的文本标签。 必须为非 NULL。

### <a name="return-value"></a>返回值

如果该方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果提供的索引未引用有效的工具栏按钮，则此方法返回 FALSE。

## <a name="cmfctoolbarsetcommandusageoptions"></a><a name="setcommandusageoptions"></a> CMFCToolBar：： SetCommandUsageOptions

指定在应用程序的菜单中不显示很少使用的命令的时间。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>parameters

*nStartCount*<br/>
中指定在框架只显示基本和最近使用的命令之前，必须执行命令的次数。

*nMinUsagePercentage*<br/>
中必须执行命令以将其视为最近使用的命令的时间的百分比。

### <a name="return-value"></a>返回值

如果 *nMinUsagePercentage* 等于或大于100，则为 FALSE; 否则为 FALSE。否则为 TRUE。

### <a name="remarks"></a>备注

调用此方法以自定义框架用来确定基本和最近使用的菜单项显示方式的算法。 有关基本命令的详细信息，请参阅 [CMFCToolBar：： AddBasicCommand](#addbasiccommand)。

此类使用 `CMFCCmdUsageCount` 类跟踪命令的使用计数。 有关此类的详细信息，请参阅 [CMFCCmdUsageCount 类](../../mfc/reference/cmfccmdusagecount-class.md)。

## <a name="cmfctoolbarsetcustomizemode"></a><a name="setcustomizemode"></a> CMFCToolBar：： SetCustomizeMode

为应用程序中的所有工具栏启用或禁用自定义模式。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>parameters

*bSet*<br/>
中一个布尔值，指定是否启用或禁用自定义模式。 将此参数设置为 TRUE 可启用自定义模式，或设置为 FALSE 可禁用自定义模式。

### <a name="return-value"></a>返回值

如果调用此方法更改自定义模式，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法调整和重绘应用程序中的每个工具栏的布局。 调用 [CMFCToolBar：： IsCustomizeMode](#iscustomizemode) 方法来确定应用程序是否处于自定义模式。

## <a name="cmfctoolbarsetgraydisabledbuttons"></a><a name="setgraydisabledbuttons"></a> CMFCToolBar：： SetGrayDisabledButtons

指定工具栏上的不可用按钮是否灰显，或是否使用按钮不可用的图像。

```cpp
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>parameters

*bGrayDisabledButtons*<br/>
中一个布尔值，指定如何显示不可用按钮。 如果此参数为 TRUE，则该框架会将按钮变暗。 否则，框架将使用不能使用按钮的图像的集合。

### <a name="remarks"></a>备注

默认情况下，不可用按钮灰显。

## <a name="cmfctoolbarsetheight"></a><a name="setheight"></a> CMFCToolBar：： SetHeight

设置工具栏的高度。

```cpp
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>parameters

*cyHeight*<br/>
中工具栏的高度（以像素为单位）。

### <a name="remarks"></a>备注

此方法在设置了高度后重绘了工具栏。

## <a name="cmfctoolbarsethelpmode"></a><a name="sethelpmode"></a> CMFCToolBar：： SetHelpMode

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>parameters

中 *bOn*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsethot"></a><a name="sethot"></a> CMFCToolBar：： SetHot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>parameters

中 *pMenuButton*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsethotborder"></a><a name="sethotborder"></a> CMFCToolBar：： SetHotBorder

指定是否热跟踪工具栏按钮。

```cpp
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>parameters

*bShowHotBorder*<br/>
中一个布尔值，指定是否热跟踪工具栏按钮。 如果此参数为 TRUE，则工具栏会对其按钮进行热跟踪。 否则，工具栏不会对其按钮进行热跟踪。

### <a name="remarks"></a>备注

如果按钮是热跟踪的，则当鼠标移动到按钮上时，框架会突出显示该按钮。 默认情况下，每个工具栏都热跟踪其按钮。

调用 [CMFCToolBar：： GetHotBorder](#gethotborder) 方法来确定工具栏是否热跟踪其按钮。

## <a name="cmfctoolbarsethottextcolor"></a><a name="sethottextcolor"></a> CMFCToolBar：： SetHotTextColor

设置热工具栏按钮的文本颜色。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>parameters

*clrText*<br/>
中指定热跟踪工具栏按钮的文本颜色。

### <a name="remarks"></a>备注

有关热跟踪工具栏按钮的详细信息，请参阅 [CMFCToolBar：： GetHotBorder](#gethotborder) 和 [CMFCToolBar：： SetHotBorder](#sethotborder)。

## <a name="cmfctoolbarsetignoresettext"></a><a name="setignoresettext"></a> CMFCToolBar：： SetIgnoreSetText

```cpp
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>parameters

中 *bValue*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsetlargeicons"></a><a name="setlargeicons"></a> CMFCToolBar：： SetLargeIcons

指定工具栏按钮是否显示大图标。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>parameters

*bLargeIcons*<br/>
中一个布尔值，指定要使用的图标。 如果此参数为 TRUE，则框架显示大图标。 否则，框架将显示常规图标。

### <a name="remarks"></a>备注

当用户在 "**自定义**" 对话框的 "**选项**" 选项卡中更改 "**大图标**" 复选框的状态时，框架会调用此方法。 此方法会调整应用程序中所有工具栏的大小。

默认情况下，框架显示常规图标。

有关 " **自定义** " 对话框的详细信息，请参阅 [CMFCToolBarsCustomizeDialog 类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。

## <a name="cmfctoolbarsetlockedsizes"></a><a name="setlockedsizes"></a> CMFCToolBar：： SetLockedSizes

设置工具栏上锁定按钮和锁定图像的大小。

```cpp
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>parameters

*sizeButton*<br/>
中指定锁定的工具栏按钮的大小。

*sizeImage*<br/>
中指定锁定的工具栏图像的大小。

*bDontScale*<br/>
指定是否在高 DPI 模式下缩放或不锁定工具栏图像。

### <a name="remarks"></a>备注

锁定按钮的默认大小为23x22 像素。 锁定图像的默认大小为16x15 像素。

调用 [CMFCToolBar：： GetLockedImageSize](#getlockedimagesize) 方法来检索锁定图像的大小。 调用 [CMFCToolBar：： GetButtonSize](#getbuttonsize) 方法以检索锁定的工具栏按钮的大小。

## <a name="cmfctoolbarsetmaskmode"></a><a name="setmaskmode"></a> CMFCToolBar：： SetMaskMode

```cpp
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>parameters

中 *bMasked*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsetmenusizes"></a><a name="setmenusizes"></a> CMFCToolBar：： SetMenuSizes

设置工具栏菜单按钮及其图像的大小。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>parameters

*sizeButton*<br/>
中指定工具栏按钮的大小（以像素为单位）。

*sizeImage*<br/>
中指定工具栏图像的大小（以像素为单位）。

### <a name="remarks"></a>备注

默认情况下，菜单按钮及其图像的大小未定义。

调用 [CMFCToolBar：： GetMenuButtonSize](#getmenubuttonsize) 方法来确定菜单按钮的大小和 [CMFCToolBar：： GetMenuImageSize](#getmenuimagesize) 方法，以确定菜单按钮图像的大小。

有关使用此方法的示例，请参阅 IEDemo 和 MSMoneyDemo 示例。

## <a name="cmfctoolbarsetnonpermittedcommands"></a><a name="setnonpermittedcommands"></a> CMFCToolBar：： SetNonPermittedCommands

设置用户无法执行的命令的列表。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>parameters

*lstCommands*<br/>
中对 `CList` 对象的引用，该对象包含用户无法执行的命令。

### <a name="remarks"></a>备注

调用此方法可阻止用户选择某些命令。 例如，出于安全原因，你可能想要阻止用户选择某些命令。 有关使用此方法的示例，请参阅 MDITabsDemo 和 MenuSubSet 示例。

此方法清除前面列出的不允许的命令。 默认情况下，不允许的命令的列表为空。

## <a name="cmfctoolbarsetonerowwithsibling"></a><a name="setonerowwithsibling"></a> CMFCToolBar：： SetOneRowWithSibling

将工具栏及其同级定位在同一行上。

```cpp
void SetOneRowWithSibling();
```

### <a name="remarks"></a>备注

当用户单击 **一个行按钮上** 的 "显示" 按钮时，框架会调用此方法。

调用 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar) 方法，以启用 "在 **一行上显示按钮** " 或 " **在两行上显示** 按钮" 按钮。 如果调用此工具栏的 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar) ，则同级工具栏将移到此工具栏的行。 否则，此工具栏会移动到同级的行。

当用户单击 **两行按钮上的 "显示按钮**" 时，框架将调用 [CMFCToolBar：： SetTwoRowsWithSibling](#settworowswithsibling)方法。

## <a name="cmfctoolbarsetorigbuttons"></a><a name="setorigbuttons"></a> CMFCToolBar：： SetOrigButtons

```cpp
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>parameters

中 *lstOrigButtons*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarsetpermament"></a><a name="setpermament"></a> CMFCToolBar：： SetPermament

指定用户是否可以关闭工具栏。

```cpp
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>parameters

*bPermament*<br/>
中一个布尔值，指定用户是否可以关闭工具栏。 如果此参数为 TRUE，则用户不能关闭工具栏。 否则，用户可以关闭工具栏。

### <a name="remarks"></a>备注

默认情况下，用户可以关闭每个工具栏。

调用 [CMFCToolBar：： CanBeClosed](#canbeclosed) 方法以确定用户是否可以关闭工具栏。

## <a name="cmfctoolbarsetroutecommandsviaframe"></a><a name="setroutecommandsviaframe"></a> CMFCToolBar：： SetRouteCommandsViaFrame

指定父框架或所有者是否向工具栏发送命令。

```cpp
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>parameters

*bValue*<br/>
中如果此参数为 TRUE，则父框架向工具栏发送命令。 否则，所有者会将命令发送到工具栏。

### <a name="remarks"></a>备注

默认情况下，父框架向工具栏发送命令。 调用 [CMFCToolBar：： GetRouteCommandsViaFrame](#getroutecommandsviaframe) 方法以确定父框架或所有者是否向工具栏发送命令。

## <a name="cmfctoolbarsetshowtooltips"></a><a name="setshowtooltips"></a> CMFCToolBar：： SetShowTooltips

指定框架是否显示工具提示。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>parameters

*bValue*<br/>
中如果此参数为 TRUE，则框架将显示工具提示。 否则，框架将隐藏工具提示。

### <a name="remarks"></a>备注

默认情况下，框架显示工具提示。

调用 [CMFCToolBar：： GetShowTooltips](#getshowtooltips) 方法以确定框架是否显示工具提示。

## <a name="cmfctoolbarsetsiblingtoolbar"></a><a name="setsiblingtoolbar"></a> CMFCToolBar：： SetSiblingToolBar

指定工具栏的同级。

```cpp
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>parameters

*pBrotherToolbar*<br/>
中指向同级工具栏的指针。

### <a name="remarks"></a>备注

此方法启用在用户显示 "**自定义**" 弹出菜单时显示的 **两行** 按钮上的 "**在一行上显示按钮**" 或 "显示按钮"。 如果要使用户能够指定相关的工具栏是显示在同一行上还是出现在不同的行上，请调用此方法。

启用工具栏上显示的 " **自定义** " 按钮后，调用此方法。 若要启用 " **自定义** " 按钮，请调用 [CMFCToolBar：： EnableCustomizeButton](#enablecustomizebutton) 方法。

若要检索工具栏的同级，请调用 [CMFCToolBar：： GetSiblingToolBar](#getsiblingtoolbar)。

## <a name="cmfctoolbarsetsizes"></a><a name="setsizes"></a> CMFCToolBar：： SetSizes

指定所有工具栏上的按钮和图像的大小。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>parameters

*sizeButton*<br/>
中工具栏按钮的大小（以像素为单位）。

*sizeImage*<br/>
中工具栏按钮图像的大小（以像素为单位）。

### <a name="remarks"></a>备注

工具栏按钮的默认大小为23x22 像素。 工具栏按钮图像的默认大小为16x15 像素。

调用 [CMFCToolBar：： GetImageSize](#getimagesize) 方法以检索工具栏按钮图像的大小。 调用 [CMFCToolBar：： GetButtonSize](#getbuttonsize) 方法以检索工具栏按钮的大小。

## <a name="cmfctoolbarsettoolbarbtntext"></a><a name="settoolbarbtntext"></a> CMFCToolBar：： SetToolBarBtnText

指定工具栏上的按钮的属性。

```cpp
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>parameters

*nBtnIndex*<br/>
中工具栏按钮列表中工具栏按钮的从零开始的索引。

*szText*<br/>
中指定工具栏按钮的文本标签。

*bShowText*<br/>
中如果此参数为 TRUE，则框架将显示文本标签。 否则，框架将隐藏文本标签。

*bShowImage*<br/>
中如果此参数为 TRUE，则框架将显示工具栏按钮图像。 否则，框架将隐藏工具栏按钮图像。

### <a name="remarks"></a>备注

默认情况下，框架显示工具栏按钮的图像，但不显示工具栏按钮的文本标签。

在调试版本中，如果 *nBtnIndex* 未引用有效的工具栏按钮或工具栏按钮是分隔符，则此方法将生成断言失败。

## <a name="cmfctoolbarsettworowswithsibling"></a><a name="settworowswithsibling"></a> CMFCToolBar：： SetTwoRowsWithSibling

将工具栏及其同级置于单独的行上。

```cpp
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>备注

当用户单击 **两行按钮上的 "显示按钮** " 时，框架会调用此方法。

调用 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar) 方法，以启用 "在 **一行上显示按钮** " 或 " **在两行上显示** 按钮" 按钮。 如果调用此工具栏的 [CMFCToolBar：： SetSiblingToolBar](#setsiblingtoolbar) ，则同级工具栏会移到单独的行中。 否则，此工具栏将移到单独的行中。

当用户单击 "**在一行上显示按钮**" 按钮时，框架将调用 [CMFCToolBar：： SetOneRowWithSibling](#setonerowwithsibling)方法。

## <a name="cmfctoolbarsetuserimages"></a><a name="setuserimages"></a> CMFCToolBar：： SetUserImages

在应用程序中设置用户定义图像的集合。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>parameters

*pUserImages*<br/>
中指向用户定义图像集合的指针。

### <a name="return-value"></a>返回值

如果该方法成功，则为非零值;否则，如果指定的 `CMFCToolBarImages` 对象无效，或者其图像大小与工具栏的默认图像大小不同，则为0。

### <a name="remarks"></a>备注

框架使用用户定义的图像绘制用户自定义的工具栏按钮。 *PUserImages* 指定的图像列表在应用程序中的所有工具栏之间共享。

如果指定的 `CMFCToolBarImages` 对象无效，或者其图像大小与工具栏的默认图像大小不同，则此方法会在调试版本中生成断言失败。

OutlookDemo、ToolTipDemo 和 VisualStudioDemo 示例使用此方法设置用户定义图像的全局集合。 它们加载名为 UserImages.bmp 的文件，该文件位于应用程序的工作目录中。

调用 [CMFCToolBar：： GetUserImages](#getuserimages) 方法以在应用程序中检索用户定义图像的集合。

## <a name="cmfctoolbarstretchpane"></a><a name="stretchpane"></a> CMFCToolBar：： StretchPane

垂直或水平拉伸工具栏，如有必要，重新定位按钮。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>parameters

*nLength*<br/>
中用于拉伸窗格的量（以像素为单位）。

*bVert*<br/>
中如果为 TRUE，则垂直拉伸窗格。 如果为 FALSE，则水平拉伸窗格。

### <a name="return-value"></a>返回值

一个 `CSize` 对象，该对象指定工具栏工作区的大小。

### <a name="remarks"></a>备注

此方法调用 [CMFCToolBar：： WrapToolBar](#wraptoolbar) 以在拉伸工具栏内重新定位按钮。

返回值是通过调用 [CMFCToolBar：： CalcSize](#calcsize)来确定的。

## <a name="cmfctoolbartranslatechar"></a><a name="translatechar"></a> CMFCToolBar：： TranslateChar

如果指定的键代码对应于有效的键盘快捷方式，则执行按钮命令。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
中指定虚拟键代码。 有关标准虚拟键代码的列表，请参阅 Winuser。h

### <a name="return-value"></a>返回值

如果指定的键代码是不可打印的或不对应于有效的键盘快捷方式，则为 FALSE; 否则为 FALSE。如果指定的键代码与下拉菜单选项对应，则为 TRUE; 否则为。否则，CMFCToolBar 中的返回值 [：:P rocesscommand](#processcommand)。

### <a name="remarks"></a>备注

当键与 Alt 键一起按下时，框架会调用此方法。

## <a name="cmfctoolbarupdatebutton"></a><a name="updatebutton"></a> CMFCToolBar：： UpdateButton

更新指定按钮的状态。

```cpp
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中指定要更新的按钮的从零开始的索引。

### <a name="remarks"></a>备注

## <a name="cmfctoolbarwraptoolbar"></a><a name="wraptoolbar"></a> CMFCToolBar：： WrapToolBar

在给定维度中重新定位工具栏按钮。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>parameters

*nWidth*<br/>
中工具栏的最大宽度。

*nHeight*<br/>
中工具栏的最大高度。 如果工具栏是浮动的，则不使用。

*pDC*<br/>
中指向设备上下文的指针。 如果为 NULL，则使用工具栏的设备上下文。

*nColumnWidth*<br/>
中按钮宽度。 如果为-1，则使用当前宽度。

[in] *nRowHeight* 按钮高度。 如果为-1，则使用当前高度。

### <a name="return-value"></a>返回值

工具栏上的按钮的行数。

### <a name="remarks"></a>备注

此方法重新定位工具栏内的按钮，如有必要，将按钮包装到其他行。

## <a name="cmfctoolbarm_bdontscaleimages"></a><a name="m_bdontscaleimages"></a> CMFCToolBar：： m_bDontScaleImages

指定是否在高 DPI 模式下缩放工具栏图像。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>备注

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[演练：将控件置于工具栏上](../../mfc/walkthrough-putting-controls-on-toolbars.md)
