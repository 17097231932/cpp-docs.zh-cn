---
title: CMFC 功能按钮类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::AddSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::CanBeStretched
- AFXRIBBONBUTTON/CMFCRibbonButton::CleanUpSizes
- AFXRIBBONBUTTON/CMFCRibbonButton::ClosePopupMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawBottomText
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawImage
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawRibbonText
- AFXRIBBONBUTTON/CMFCRibbonButton::FindSubItemIndexByID
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCommandRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCompactSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIcon
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIntermediateSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenuRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetRegularSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::GetTextRowHeight
- AFXRIBBONBUTTON/CMFCRibbonButton::GetToolTipText
- AFXRIBBONBUTTON/CMFCRibbonButton::HasCompactMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasIntermediateMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasLargeMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsApplicationButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsCommandAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultPanelButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDrawTooltipImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuOnBottom
- AFXRIBBONBUTTON/CMFCRibbonButton::IsPopupDefaultMenuLook
- AFXRIBBONBUTTON/CMFCRibbonButton::IsRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsSingleLineText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnCalcTextSize
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDraw
- AFXRIBBONBUTTON/CMFCRibbonButton::OnFillBackground
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveAllSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::SetACCData
- AFXRIBBONBUTTON/CMFCRibbonButton::SetAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDescription
- AFXRIBBONBUTTON/CMFCRibbonButton::SetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::SetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetParentCategory
- AFXRIBBONBUTTON/CMFCRibbonButton::SetRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnClick
helpviewer_keywords:
- CMFCRibbonButton [MFC], CMFCRibbonButton
- CMFCRibbonButton [MFC], AddSubItem
- CMFCRibbonButton [MFC], CanBeStretched
- CMFCRibbonButton [MFC], CleanUpSizes
- CMFCRibbonButton [MFC], ClosePopupMenu
- CMFCRibbonButton [MFC], DrawBottomText
- CMFCRibbonButton [MFC], DrawImage
- CMFCRibbonButton [MFC], DrawRibbonText
- CMFCRibbonButton [MFC], FindSubItemIndexByID
- CMFCRibbonButton [MFC], GetCommandRect
- CMFCRibbonButton [MFC], GetCompactSize
- CMFCRibbonButton [MFC], GetIcon
- CMFCRibbonButton [MFC], GetImageIndex
- CMFCRibbonButton [MFC], GetImageSize
- CMFCRibbonButton [MFC], GetIntermediateSize
- CMFCRibbonButton [MFC], GetMenu
- CMFCRibbonButton [MFC], GetMenuRect
- CMFCRibbonButton [MFC], GetRegularSize
- CMFCRibbonButton [MFC], GetSubItems
- CMFCRibbonButton [MFC], GetTextRowHeight
- CMFCRibbonButton [MFC], GetToolTipText
- CMFCRibbonButton [MFC], HasCompactMode
- CMFCRibbonButton [MFC], HasIntermediateMode
- CMFCRibbonButton [MFC], HasLargeMode
- CMFCRibbonButton [MFC], HasMenu
- CMFCRibbonButton [MFC], IsAlwaysDrawBorder
- CMFCRibbonButton [MFC], IsAlwaysLargeImage
- CMFCRibbonButton [MFC], IsApplicationButton
- CMFCRibbonButton [MFC], IsCommandAreaHighlighted
- CMFCRibbonButton [MFC], IsDefaultCommand
- CMFCRibbonButton [MFC], IsDefaultPanelButton
- CMFCRibbonButton [MFC], IsDrawTooltipImage
- CMFCRibbonButton [MFC], IsLargeImage
- CMFCRibbonButton [MFC], IsMenuAreaHighlighted
- CMFCRibbonButton [MFC], IsMenuOnBottom
- CMFCRibbonButton [MFC], IsPopupDefaultMenuLook
- CMFCRibbonButton [MFC], IsRightAlignMenu
- CMFCRibbonButton [MFC], IsSingleLineText
- CMFCRibbonButton [MFC], OnCalcTextSize
- CMFCRibbonButton [MFC], OnDrawBorder
- CMFCRibbonButton [MFC], OnDraw
- CMFCRibbonButton [MFC], OnFillBackground
- CMFCRibbonButton [MFC], RemoveAllSubItems
- CMFCRibbonButton [MFC], RemoveSubItem
- CMFCRibbonButton [MFC], SetACCData
- CMFCRibbonButton [MFC], SetAlwaysLargeImage
- CMFCRibbonButton [MFC], SetDefaultCommand
- CMFCRibbonButton [MFC], SetDescription
- CMFCRibbonButton [MFC], SetImageIndex
- CMFCRibbonButton [MFC], SetMenu
- CMFCRibbonButton [MFC], SetParentCategory
- CMFCRibbonButton [MFC], SetRightAlignMenu
- CMFCRibbonButton [MFC], SetText
- CMFCRibbonButton [MFC], OnClick
ms.assetid: 732e941c-9504-4b83-a691-d18075965d53
ms.openlocfilehash: b0118b47fd1bb1db15916d7deffbaa32dcfc9df7
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375298"
---
# <a name="cmfcribbonbutton-class"></a>CMFC 功能按钮类

`CMFCRibbonButton` 类实现可放置在功能区栏元素（例如面板、快速访问工具栏和弹出菜单）上的按钮。

有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCRibbonButton : public CMFCRibbonBaseElement
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CMFC功能功能按钮：CMFC功能功能按钮](#cmfcribbonbutton)|构造一个功能区按钮对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFCRibbonButton::AddSubItem](#addsubitem)|将菜单项添加到与按钮相关联的弹出菜单。|
|[CMFCRibbonButton::CanBeStretched](#canbestretched)|（覆盖[CMFC 功能基础元素：：可以拉伸](../../mfc/reference/cmfcribbonbaseelement-class.md#canbestretched).）|
|[CMFCRibbonButton::CleanUpSizes](#cleanupsizes)|（覆盖[CMFC 功能基础元素：：清理调整大小](../../mfc/reference/cmfcribbonbaseelement-class.md#cleanupsizes)。|
|[CMFCRibbonButton::ClosePopupMenu](#closepopupmenu)|（覆盖[CMFC 功能基础元素：：闭合弹出菜单](../../mfc/reference/cmfcribbonbaseelement-class.md#closepopupmenu).）|
|[CMFCRibbonButton::DrawBottomText](#drawbottomtext)||
|[CMFCRibbonButton::DrawImage](#drawimage)|（覆盖[CMFC 功能基础元素：:D原始图像](../../mfc/reference/cmfcribbonbaseelement-class.md#drawimage).）|
|[CMFCRibbonButton::DrawRibbonText](#drawribbontext)||
|[CMFCRibbonButton::FindSubItemIndexByID](#findsubitemindexbyid)|返回与指定的命令 ID 相关联的弹出菜单项的索引。|
|[CMFC 功能按钮：：获取命令雷ct](#getcommandrect)||
|[CMFC 功能按钮：获取压缩尺寸](#getcompactsize)|返回功能区元素的压缩大小。 （覆盖[CMFC 功能基础元素：获取压缩大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getcompactsize).）|
|[CMFC功能按钮：GetIcon](#geticon)||
|[CMFC功能按钮：获取图像索引](#getimageindex)|返回与按钮相关联的图像的索引。|
|[CMFC 功能按钮：获取图像大小](#getimagesize)|返回功能区元素的图像大小。 （覆盖[CMFC 功能基础元素：获取图像大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getimagesize).）|
|[CMFC 功能按钮：获取中间大小](#getintermediatesize)|返回处于中间状态的功能区元素的大小。 （覆盖[CMFC 功能基础元素：获取中间大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getintermediatesize).）|
|[CMFC功能按钮：获取菜单](#getmenu)|将一个句柄返回给一个分配给功能区按钮的 Windows 菜单。|
|[CMFC功能按钮：：获取菜单](#getmenurect)||
|[CMFC 功能按钮：获取常规大小](#getregularsize)|返回功能区元素的常规大小。 （覆盖[CMFC 功能基础元素：获取常规大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getregularsize).）|
|[CMFC 功能按钮：获取子项目](#getsubitems)||
|[CMFCRibbonButton::GetTextRowHeight](#gettextrowheight)||
|[CMFC 功能按钮：获取工具提示文本](#gettooltiptext)|返回功能区元素的工具提示文本。 （覆盖[CMFC 功能基础元素：获取工具提示文本](../../mfc/reference/cmfcribbonbaseelement-class.md#gettooltiptext).）|
|[CMFCRibbonButton::HasCompactMode](#hascompactmode)|指定功能区元素是否有压缩模式。 （覆盖[CMFC 功能基础元素：：具有压缩模式](../../mfc/reference/cmfcribbonbaseelement-class.md#hascompactmode).）|
|[CMFCRibbonButton::HasIntermediateMode](#hasintermediatemode)|指定功能区元素是否有中间模式。 （覆盖[CMFC 功能基础元素：：具有中间模式](../../mfc/reference/cmfcribbonbaseelement-class.md#hasintermediatemode).）|
|[CMFCRibbonButton::HasLargeMode](#haslargemode)|确定功能区元素是否有大型模式。 （覆盖[CMFC 功能基础元素：：具有大模式](../../mfc/reference/cmfcribbonbaseelement-class.md#haslargemode).）|
|[CMFCRibbonButton::HasMenu](#hasmenu)|（覆盖[CMFC 功能基础元素：：哈斯梅因](../../mfc/reference/cmfcribbonbaseelement-class.md#hasmenu).）|
|[CMFCRibbonButton::IsAlwaysDrawBorder](#isalwaysdrawborder)||
|[CMFCRibbonButton::IsAlwaysLargeImage](#isalwayslargeimage)|（覆盖[CMFC 功能基础元素：：是始终较大的图像](../../mfc/reference/cmfcribbonbaseelement-class.md#isalwayslargeimage).）|
|[CMFCRibbonButton::IsApplicationButton](#isapplicationbutton)||
|[CMFCRibbonButton::IsCommandAreaHighlighted](#iscommandareahighlighted)||
|[CMFCRibbonButton::IsDefaultCommand](#isdefaultcommand)|确定是否已启用功能区按钮的默认命令。|
|[CMFCRibbonButton::IsDefaultPanelButton](#isdefaultpanelbutton)||
|[CMFCRibbonButton::IsDrawTooltipImage](#isdrawtooltipimage)||
|[CMFCRibbonButton::IsLargeImage](#islargeimage)||
|[CMFCRibbonButton::IsMenuAreaHighlighted](#ismenuareahighlighted)||
|[CMFCRibbonButton::IsMenuOnBottom](#ismenuonbottom)||
|[CMFCRibbonButton::IsPopupDefaultMenuLook](#ispopupdefaultmenulook)||
|[CMFCRibbonButton::IsRightAlignMenu](#isrightalignmenu)|确定菜单是否为右对齐。|
|[CMFCRibbonButton::IsSingleLineText](#issinglelinetext)||
|[CMFCRibbonButton::OnCalcTextSize](#oncalctextsize)|（覆盖[CMFC 功能基础元素：：在CalcTextSize](../../mfc/reference/cmfcribbonbaseelement-class.md#oncalctextsize)上。|
|[CMFCRibbonButton::OnDrawBorder](#ondrawborder)||
|[CMFCRibbonButton::OnDraw](#ondraw)|由框架调用以绘制功能区元素。 （覆盖[CMFC 功能基础元素：onDraw](../../mfc/reference/cmfcribbonbaseelement-class.md#ondraw).）|
|[CMFCRibbonButton::OnFillBackground](#onfillbackground)||
|[CMFCRibbonButton::RemoveAllSubItems](#removeallsubitems)|从弹出菜单中删除所有菜单项。|
|[CMFCRibbonButton::RemoveSubItem](#removesubitem)|从弹出菜单中删除一个菜单项。|
|[CMFCRibbonButton::SetACCData](#setaccdata)|（覆盖[CMFC 功能基础元素：设置ACC数据](../../mfc/reference/cmfcribbonbaseelement-class.md#setaccdata).）|
|[CMFCRibbonButton::SetAlwaysLargeImage](#setalwayslargeimage)|指定当用户折叠按钮时，按钮显示大图像还是小图像。|
|[CMFCRibbonButton::SetDefaultCommand](#setdefaultcommand)|启用功能区按钮的默认命令。|
|[CMFCRibbonButton::SetDescription](#setdescription)|设置功能区元素的说明。 （覆盖[CMFC 功能基础元素：设置描述](../../mfc/reference/cmfcribbonbaseelement-class.md#setdescription).）|
|[CMFCRibbonButton::SetImageIndex](#setimageindex)|将索引分配给按钮的图像。|
|[CMFCRibbonButton::SetMenu](#setmenu)|将弹出菜单分配给功能区按钮。|
|[CMFCRibbonButton::SetParentCategory](#setparentcategory)|（覆盖[CMFC 功能基础元素：设置父项](../../mfc/reference/cmfcribbonbaseelement-class.md#setparentcategory).）|
|[CMFCRibbonButton::SetRightAlignMenu](#setrightalignmenu)|使弹出菜单与按钮的右侧对齐。|
|[CMFCRibbonButton::SetText](#settext)|设置功能区元素的文本。 （覆盖[CMFC 功能基础元素：：设置文本](../../mfc/reference/cmfcribbonbaseelement-class.md#settext).）|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CMFCRibbonButton::OnClick](#onclick)|当用户单击按钮时，由框架调用。|

## <a name="example"></a>示例

下面的示例演示如何使用 `CMFCRibbonButton` 类中的各种方法。 该示例展示如何构造 `CMFCRibbonButton` 类的对象，将弹出菜单分配给功能区按钮，设置按钮的说明，从弹出菜单中删除一个菜单项，然后使弹出菜单与按钮的边缘右对齐。

[!code-cpp[NVC_MFC_RibbonApp#7](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_1.cpp)]

## <a name="remarks"></a>备注

要在应用程序中使用功能区按钮，请构造按钮对象并将其添加到相应的功能区[面板](../../mfc/reference/cmfcribbonpanel-class.md)中。

```cpp
CMFCRibbonPanel* pPanel = pCategory->AddPanel (
    _T("Clipboard"), // Panel name
    m_PanelIcons.ExtractIcon (0)); // Panel icon

// Create the first button ("Paste"):
CMFCRibbonButton* pPasteButton =
    new CMFCRibbonButton (ID_EDIT_PASTE, _T("Paste"), -1, 0);

// The third parameter (-1) disables small images for button.
// This button is always displayed with a large image
// Associate a pop-up menu with the "Paste" button:
pPasteButton->SetMenu (IDR_CONTEXT_MENU);

// Add buttons to the panel. These buttons have only small images.
pPanel->Add (new CMFCRibbonButton (ID_EDIT_CUT, _T("Cut"), 1));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_COPY, _T("Copy"), 2));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_PAINT, _T("Paint"), 9));
```

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

## <a name="requirements"></a>要求

**标头：** afxribbonbutton.h

## <a name="cmfcribbonbuttonaddsubitem"></a><a name="addsubitem"></a>CMFC 功能按钮：：添加子项

将菜单项添加到与按钮相关联的弹出菜单。

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1);
```

### <a name="parameters"></a>参数

*p 子项目*<br/>
[在]指定指向要添加的新元素的指针。

*nIndex*<br/>
[在]指定要将元素添加到按钮的菜单项数组的索引;-1 以在菜单项数组的末尾添加元素。

## <a name="cmfcribbonbuttoncanbestretched"></a><a name="canbestretched"></a>CMFC 功能按钮：：可拉伸

```
virtual BOOL CanBeStretched();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttoncleanupsizes"></a><a name="cleanupsizes"></a>CMFC 功能按钮：：清理放大缩小字体功能

```
virtual void CleanUpSizes();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonclosepopupmenu"></a><a name="closepopupmenu"></a>CMFC功能按钮：：关闭弹出菜单

```
virtual void ClosePopupMenu();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttoncmfcribbonbutton"></a><a name="cmfcribbonbutton"></a>CMFC功能功能按钮：CMFC功能功能按钮

构造一个功能区按钮对象。

```
CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex=-1,
    int nLargeImageIndex=-1,
    BOOL bAlwaysShowDescription=FALSE);

CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    HICON hIcon,
    BOOL bAlwaysShowDescription=FALSE,
    HICON hIconSmall=NULL,
    BOOL bAutoDestroyIcon=FALSE,
    BOOL bAlphaBlendIcon=FALSE);
```

### <a name="parameters"></a>参数

*nID*<br/>
[在]指定按钮的命令 ID。

*lpszText*<br/>
[在]指定按钮的文本标签。

*n 小图像索引*<br/>
[在]在父类别的图像列表中指定按钮小图像的零基索引。

*nLargeImageIndex*<br/>
[在]在父类别的图像列表中指定按钮大图像的零基索引。

*hIcon*<br/>
[在]指定应用程序用作按钮图像的图标的句柄。

### <a name="example"></a>示例

下面的示例演示如何构造`CMFCRibbonButton`对象。

[!code-cpp[NVC_MFC_RibbonApp#6](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_2.cpp)]

## <a name="cmfcribbonbuttondrawbottomtext"></a><a name="drawbottomtext"></a>CMFC功能框架按钮：:D原始文本

```
CSize DrawBottomText(
    CDC* pDC,
    BOOL bCalcOnly);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>
[在]*bCalcOnly*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttondrawimage"></a><a name="drawimage"></a>CMFC功能按钮：:D原始图像

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>
[在]*类型*<br/>
[在]*rectImage*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttondrawribbontext"></a><a name="drawribbontext"></a>CMFC功能框架按钮：:D原始剪彩文本

```
virtual int DrawRibbonText(
    CDC* pDC,
    const CString& strText,
    CRect rectText,
    UINT uiDTFlags,
    COLORREF clrText = (COLORREF)-1);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>
[在]*斯特文本*<br/>
[在]*整文*<br/>
[在]*uiDTFlags*<br/>
[在]*clrText*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonfindsubitemindexbyid"></a><a name="findsubitemindexbyid"></a>CMFC 功能按钮：：查找子项索引 ByID

返回与指定的命令 ID 相关联的弹出菜单项的索引。

```
int FindSubItemIndexByID(UINT uiID) const;
```

### <a name="parameters"></a>参数

*uiID*<br/>
[在]指定弹出菜单项的命令 ID。

### <a name="return-value"></a>返回值

与*uiID*关联的子项的零基索引。 -1 如果没有此类子项目。

## <a name="cmfcribbonbuttongetcommandrect"></a><a name="getcommandrect"></a>CMFC 功能按钮：：获取命令雷ct

```
CRect GetCommandRect() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongetcompactsize"></a><a name="getcompactsize"></a>CMFC 功能按钮：获取压缩尺寸

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongeticon"></a><a name="geticon"></a>CMFC功能按钮：GetIcon

```
HICON GetIcon(BOOL bLargeIcon = TRUE) const;
```

### <a name="parameters"></a>参数

[在]*bLargeIcon*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongetimageindex"></a><a name="getimageindex"></a>CMFC功能按钮：获取图像索引

返回与按钮相关联的图像的索引。

```
int GetImageIndex(BOOL bLargeImage) const;
```

### <a name="parameters"></a>参数

*bLargeImage*<br/>
[在]如果为 TRUE，则返回包含大图像的图像列表中的图像索引;如果为 TRUE，则返回包含大图像的图像索引。否则，将返回包含小图像的图像列表中的图像索引。

### <a name="return-value"></a>返回值

关联图像列表中按钮图像的索引。

## <a name="cmfcribbonbuttongetimagesize"></a><a name="getimagesize"></a>CMFC 功能按钮：获取图像大小

```
virtual CSize GetImageSize(RibbonImageType type) const;
```

### <a name="parameters"></a>参数

[在]*类型*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongetintermediatesize"></a><a name="getintermediatesize"></a>CMFC 功能按钮：获取中间大小

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongetmenu"></a><a name="getmenu"></a>CMFC功能按钮：获取菜单

将一个句柄返回给一个分配给功能区按钮的 Windows 菜单。

```
HMENU GetMenu() const;
```

### <a name="return-value"></a>返回值

分配给按钮的 Windows 菜单的句柄;如果没有分配菜单，则为 NULL。

## <a name="cmfcribbonbuttongetmenurect"></a><a name="getmenurect"></a>CMFC功能按钮：：获取菜单

```
CRect GetMenuRect() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongetregularsize"></a><a name="getregularsize"></a>CMFC 功能按钮：获取常规大小

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongetsubitems"></a><a name="getsubitems"></a>CMFC 功能按钮：获取子项目

```
const CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& GetSubItems() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongettextrowheight"></a><a name="gettextrowheight"></a>CMFC 功能按钮：：获取文本行高度

```
int GetTextRowHeight() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttongettooltiptext"></a><a name="gettooltiptext"></a>CMFC 功能按钮：获取工具提示文本

```
virtual CString GetToolTipText() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonhascompactmode"></a><a name="hascompactmode"></a>CMFC功能按钮：：具有压缩模式

```
virtual BOOL HasCompactMode() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonhasintermediatemode"></a><a name="hasintermediatemode"></a>CMFC 功能按钮：：具有中间模式

```
virtual BOOL HasIntermediateMode() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonhaslargemode"></a><a name="haslargemode"></a>CMFC 功能按钮：：具有大模式

```
virtual BOOL HasLargeMode() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonhasmenu"></a><a name="hasmenu"></a>CMFC功能按钮：：哈斯梅因

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonisalwaysdrawborder"></a><a name="isalwaysdrawborder"></a>CMFC 功能按钮：：始终绘制边框

```
virtual BOOL IsAlwaysDrawBorder() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonisalwayslargeimage"></a><a name="isalwayslargeimage"></a>CMFC 功能按钮：：始终显示大型图像

```
virtual BOOL IsAlwaysLargeImage() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonisapplicationbutton"></a><a name="isapplicationbutton"></a>CMFC功能按钮：：是应用按钮

```
virtual BOOL IsApplicationButton() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttoniscommandareahighlighted"></a><a name="iscommandareahighlighted"></a>CMFC 功能按钮：：是命令区域突出显示

```
virtual BOOL IsCommandAreaHighlighted() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonisdefaultcommand"></a><a name="isdefaultcommand"></a>CMFC 功能按钮：：默认命令

指定是否启用功能区按钮的默认命令。

```
BOOL IsDefaultCommand() const;
```

### <a name="return-value"></a>返回值

如果启用了功能区按钮的默认命令，则为 TRUE;否则。

## <a name="cmfcribbonbuttonisdefaultpanelbutton"></a><a name="isdefaultpanelbutton"></a>CMFC 功能按钮：：默认面板按钮

```
virtual BOOL IsDefaultPanelButton() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonisdrawtooltipimage"></a><a name="isdrawtooltipimage"></a>CMFC 功能按钮：：正在绘制工具提示图像

```
virtual BOOL IsDrawTooltipImage() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonislargeimage"></a><a name="islargeimage"></a>CMFC 功能按钮：：大图像

```
BOOL IsLargeImage() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonismenuareahighlighted"></a><a name="ismenuareahighlighted"></a>CMFC 功能按钮：：正菜单区域突出显示

```
virtual BOOL IsMenuAreaHighlighted() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonismenuonbottom"></a><a name="ismenuonbottom"></a>CMFC功能按钮：：ismenuonon

```
BOOL IsMenuOnBottom() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonispopupdefaultmenulook"></a><a name="ispopupdefaultmenulook"></a>CMFC 功能按钮：：是弹出默认菜单查看

```
virtual BOOL IsPopupDefaultMenuLook() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonisrightalignmenu"></a><a name="isrightalignmenu"></a>CMFC功能按钮：：右对齐菜单

指定菜单是否正确对齐。

```
BOOL IsRightAlignMenu() const;
```

### <a name="return-value"></a>返回值

如果菜单正确对齐，则为 TRUE;否则 FALSE。

## <a name="cmfcribbonbuttonissinglelinetext"></a><a name="issinglelinetext"></a>CMFC 功能按钮：：是单行文本

```
BOOL IsSingleLineText() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttononcalctextsize"></a><a name="oncalctextsize"></a>CMFC 功能按钮：：在文本大小上

```
virtual void OnCalcTextSize(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttononclick"></a><a name="onclick"></a>CMFC功能按钮：点击

当用户单击按钮时，由框架调用。

```
virtual void OnClick(CPoint point);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]指定鼠标单击的位置。

### <a name="remarks"></a>备注

如果要处理此事件，在派生类中重写此方法。

## <a name="cmfcribbonbuttonondraw"></a><a name="ondraw"></a>CMFC功能按钮：在画上

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonondrawborder"></a><a name="ondrawborder"></a>CMFC 功能按钮：：在绘制边框

```
virtual void OnDrawBorder(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttononfillbackground"></a><a name="onfillbackground"></a>CMFC 功能按钮：：打开填充背景

```
virtual COLORREF OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonremoveallsubitems"></a><a name="removeallsubitems"></a>CMFC 功能按钮：：删除所有子项目

从弹出菜单中删除所有菜单项。

```
void RemoveAllSubItems();
```

## <a name="cmfcribbonbuttonremovesubitem"></a><a name="removesubitem"></a>CMFC 功能按钮：：删除子项目

从弹出菜单中删除一个菜单项。

```
BOOL RemoveSubItem(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定要删除的菜单项的零基索引。

### <a name="return-value"></a>返回值

如果指定的项已成功删除，则为 TRUE;如果指定项已成功删除，则为 TRUE。否则，如果*nIndex*为负或超过弹出式菜单中的菜单项数，则 FALSE。

## <a name="cmfcribbonbuttonsetaccdata"></a><a name="setaccdata"></a>CMFC 功能按钮：：设置ACC数据

设置功能区按钮的辅助功能数据。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>参数

*p 父级*<br/>
功能区元素的父窗口。

*数据*<br/>
功能区元素的可访问性数据。

### <a name="return-value"></a>返回值

如果成功，则返回 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonsetalwayslargeimage"></a><a name="setalwayslargeimage"></a>CMFC 功能按钮：：设置始终较大的图像

指定当用户折叠按钮时，按钮显示大图像还是小图像。

```
void SetAlwaysLargeImage(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]如果为 TRUE，则该按钮将显示一个大图像。 否则，该按钮将显示一个小图像。

## <a name="cmfcribbonbuttonsetdefaultcommand"></a><a name="setdefaultcommand"></a>CMFC 功能按钮：：设置默认命令

启用功能区按钮的默认命令。

```
void SetDefaultCommand(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]如果为 TRUE，则按钮可以执行其默认命令。 如果 FALSE，则按钮无法执行其默认命令。

### <a name="remarks"></a>备注

*bSet*仅在按钮具有菜单时才相关。 如果*bSet*为 TRUE，则按钮可以执行其默认命令，并且仅当用户单击按钮右边缘的箭头时，才会显示分配的弹出菜单。 否则，按钮无法执行其默认命令，并且无论用户单击按钮的哪个区域，都会显示弹出菜单。

## <a name="cmfcribbonbuttonsetdescription"></a><a name="setdescription"></a>CMFC 功能按钮：：设置描述

```
virtual void SetDescription(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

[在]*lpszText*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonsetimageindex"></a><a name="setimageindex"></a>CMFC 功能按钮：：设置图像索引

将索引分配给按钮的图像。

```
void SetImageIndex(
    int nIndex,
    BOOL bLargeImage);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定图像索引。

*bLargeImage*<br/>
[在]如果为 TRUE，则指定的索引引用大型图像的列表。 否则，索引将引用小图像的列表。

## <a name="cmfcribbonbuttonsetmenu"></a><a name="setmenu"></a>CMFC功能按钮：：设置菜单

将弹出菜单分配给功能区按钮。

```
void SetMenu(
    HMENU hMenu,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);

void SetMenu(
    UINT uiMenuResID,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);
```

### <a name="parameters"></a>参数

*hMenu*<br/>
Windows 菜单的句柄。

*bIsDefault命令*<br/>
如果为 TRUE，则按钮可以执行其默认命令;如果为 TRUE，则按钮可以执行其默认命令。否则，该按钮将显示一个弹出式菜单。

*b 右对齐*<br/>
如果为 TRUE，则菜单是右对齐的。 否则，菜单将左对齐。

*uiMenuResID*<br/>
菜单资源 ID。

### <a name="remarks"></a>备注

当应用程序将菜单分配给按钮时，按钮的右侧将显示一个箭头。 如果*bIsDefault命令*为 TRUE，则菜单仅在用户单击箭头时才显示。 如果用户单击该按钮，则执行其默认命令。 如果*bIsDefault命令*为 FALSE，则菜单通过单击按钮上的任意位置显示。

## <a name="cmfcribbonbuttonsetparentcategory"></a><a name="setparentcategory"></a>CMFC 功能按钮：：设置父项类别

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### <a name="parameters"></a>参数

[在]*p 父级*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbuttonsetrightalignmenu"></a><a name="setrightalignmenu"></a>CMFC 功能按钮：：设置右对齐菜单

将弹出式菜单对齐到按钮的边缘。

```
void SetRightAlignMenu(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]如果为 TRUE，则菜单是右对齐的。 否则，菜单将左对齐

## <a name="cmfcribbonbuttonsettext"></a><a name="settext"></a>CMFC 功能按钮：：设置文本

```
virtual void SetText(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

[在]*lpszText*<br/>

### <a name="remarks"></a>备注

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)
