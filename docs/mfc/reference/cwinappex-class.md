---
title: CWinAppEx 类
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: b630a588d6c7ec81a22a9665deb0fa7517f90dc8
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/22/2020
ms.locfileid: "81750644"
---
# <a name="cwinappex-class"></a>CWinAppEx 类

`CWinAppEx`处理应用程序状态，将状态保存到注册表，从注册表加载状态，初始化应用程序管理器，并提供指向这些相同的应用程序管理器的链接。

有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CWinAppEx：CWinAppEx](#cwinappex)|构造 `CWinAppEx` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CWinAppEx：：清洁状态](#cleanstate)|从 Windows 注册表中删除有关应用程序的信息。|
|[CWinAppEx：：启用加载窗口放置](#enableloadwindowplacement)|指定应用程序是否将从注册表加载主框架窗口的初始大小和位置。|
|[CWinAppEx：：启用"离开菜单"](#enabletearoffmenus)|为应用程序启用分泪菜单。|
|[CWinAppEx：启用用户工具](#enableusertools)|使用户能够在应用程序中创建自定义菜单命令。|
|[CWinAppEx：退出实例](#exitinstance)|由框架从`Run`成员函数中调用以退出应用程序的此实例。 （覆盖[CWinApp：退出实例](../../mfc/reference/cwinapp-class.md#exitinstance).）|
|[CWinAppEx：获取 Binary](#getbinary)|读取与指定注册表值关联的二进制数据。|
|[CWinAppEx：获取上下文菜单管理器](#getcontextmenumanager)|返回指向全局[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象的指针。|
|[CWinAppEx：获取数据版本](#getdataversion)||
|[CWinAppEx：获取数据版本主要](#getdataversionmajor)|返回保存在 Windows 注册表中的应用程序的主要版本。|
|[CWinAppEx：获取数据版本次要](#getdataversionminor)|返回保存在 Windows 注册表中的应用程序的次要版本。|
|[CWinAppEx：Getint](#getint)|从注册表读取与指定值关联的数字数据。|
|[CWinAppEx：获取键盘管理器](#getkeyboardmanager)|返回指向全局[键盘管理器](../../mfc/reference/ckeyboardmanager-class.md)对象的指针。|
|[CWinAppEx：获取鼠标管理器](#getmousemanager)|返回指向全局[CMouseManager](../../mfc/reference/cmousemanager-class.md)对象的指针。|
|[CWinAppEx：获取对象](#getobject)|读取`CObject`与注册表中的指定值关联的派生数据。|
|[CWinAppEx：获取 RegSectionPath](#getregsectionpath)|返回作为注册表项路径的字符串。 此路径将所提供的相对路径与应用程序路径串联。|
|[CWinAppEx：获取注册库](#getregistrybase)|返回应用程序的注册表路径。|
|[CWinAppEx：获取截面二进制](#getsectionbinary)|从注册表读取与指定密钥和值关联的二进制数据。|
|[CWinAppEx：获取科科因](#getsectionint)|从与指定键和值关联的注册表中读取数字数据。|
|[CWinAppEx：获取节点对象](#getsectionobject)|从`CObject`注册表读取与指定密钥和值关联的数据。|
|[CWinAppEx：获取节串](#getsectionstring)|从注册表读取与指定键和值关联的字符串数据。|
|[CWinAppEx：获取壳牌管理器](#getshellmanager)|返回指向全局[CShellManager](../../mfc/reference/cshellmanager-class.md)对象的指针。|
|[CWinAppEx：GetString](#getstring)|从注册表读取与指定值关联的字符串数据。|
|[CWinAppEx：获取工具提示管理器](#gettooltipmanager)|返回指向全局[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)对象的指针。|
|[CWinAppEx：获取用户工具管理器](#getusertoolsmanager)|返回指向全局[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)对象的指针。|
|[CWinAppEx：：在it上下文菜单管理器](#initcontextmenumanager)|初始化 `CContextMenuManager` 对象。|
|[CWinAppEx：：Init键盘管理器](#initkeyboardmanager)|初始化 `CKeyboardManager` 对象。|
|[CWinAppEx：：InitMouse管理器](#initmousemanager)|初始化 `CMouseManager` 对象。|
|[CWinAppEx：：InitShell管理器](#initshellmanager)|初始化类`CShellManager`|
|[CWinAppEx：：InitTooltip管理器](#inittooltipmanager)|初始化 `CTooltipManager` 类。|
|[CWinAppEx：是资源智能更新](#isresourcesmartupdate)||
|[CWinAppEx：是否存在](#isstateexists)|指示指定的密钥是否位于注册表中。|
|[CWinAppEx：：加载状态](#loadstate)|从注册表加载应用程序状态。|
|[CWinAppEx：应用上下文帮助](#onappcontexthelp)|当用户请求 **"自定义"** 对话框的上下文帮助时，由框架调用。|
|[CWinAppEx：：OnView双击](#onviewdoubleclick)|当用户双击应用程序中的任何位置时调用用户定义的命令。|
|[CWinAppEx：在工作空间上](#onworkspaceidle)||
|[CWinAppEx：：保存状态](#savestate)|将应用程序框架的状态写入 Windows 注册表。|
|[CWinAppEx：：设置注册库](#setregistrybase)|设置默认注册表项的路径。 此键将作为所有后续注册表调用的根。|
|[CWinAppEx：：显示弹出菜单](#showpopupmenu)|显示弹出式菜单。|
|[CWinAppEx：：写入二进制](#writebinary)|将二进制数据写入指定的注册表值。|
|[CWinAppEx：：写入](#writeint)|将数字数据写入指定的注册表值。|
|[CWinAppEx：写入对象](#writeobject)|将派生自[CObject 类](../../mfc/reference/cobject-class.md)的数据写入指定的注册表值。|
|[CWinAppEx：：写节二进制](#writesectionbinary)|将二进制数据写入指定注册表项的值。|
|[CWinAppEx：：写科因](#writesectionint)|将数字数据写入指定注册表项的值。|
|[CWinAppEx：写节对象](#writesectionobject)|将数据派生自类`CObject`写入指定注册表项的值。|
|[CWinAppEx：：写节串](#writesectionstring)|将字符串数据写入指定注册表项的值。|
|[CWinAppEx：：写字符串](#writestring)|将字符串数据写入指定的注册表值。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CWinAppEx：：加载自定义状态](#loadcustomstate)|加载应用程序状态时由框架调用。|
|[CWinAppEx：：加载窗口放置](#loadwindowplacement)|当框架从注册表加载应用程序的大小和位置时，由它调用。 加载的数据包括应用程序上次关闭时主帧的大小和位置。|
|[CWinAppEx：：打开主框架](#onclosingmainframe)|当主框架窗口正在处理时，框架调用WM_CLOSE。|
|[CWinAppEx：:P重新加载状态](#preloadstate)|在加载应用程序状态之前由框架调用。|
|[CWinAppEx：:P重新保存状态](#presavestate)|在保存应用程序状态之前由框架调用。|
|[CWinAppEx：：重新加载窗口放置](#reloadwindowplacement)|从注册表重新加载提供的窗口的大小和位置|
|[CWinAppEx：：保存自定义状态](#savecustomstate)|框架在将应用程序状态写入注册表后调用它。|
|[CWinAppEx：：商店窗口放置](#storewindowplacement)|由框架调用，将主框架的大小和位置写入注册表。|

### <a name="data-members"></a>数据成员

|名称|说明|
|----------|-----------------|
|[CWinAppEx：m_bForceImageReset](#m_bforceimagereset)|指定在加载包含工具栏的框架窗口时，框架是否会重置所有工具栏图像。|

## <a name="remarks"></a>备注

MFC 框架提供的大部分功能取决于类`CWinAppEx`。 您可以通过以下两种方式`CWinAppEx`之一将类合并到应用程序中：

- 在主`CWinAppEx`线程中构造类。

- 从`CWinAppEx`派生主应用程序类。

合并`CWinAppEx`到应用程序中后，可以初始化任一个应用程序管理器。 在使用应用程序管理器之前，必须通过调用适当的初始化方法初始化它。 要获取指向特定管理器的指针，请调用关联的 get 方法。 该`CWinAppEx`类管理以下应用程序管理器[：CMouseManager 类](../../mfc/reference/cmousemanager-class.md)[、CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)类[、C键盘管理器类](../../mfc/reference/ckeyboardmanager-class.md)[、CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)和[CMenuTearoffManager 类](../../mfc/reference/cmenutearoffmanager-class.md)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>要求

**标题：** afxwinappex.h

## <a name="cwinappexcleanstate"></a><a name="cleanstate"></a>CWinAppEx：：清洁状态

从 Windows 注册表中删除有关应用程序的所有信息。

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>参数

*lpsz节名称*<br/>
[在]包含注册表项路径的字符串。

### <a name="return-value"></a>返回值

如果方法成功，则非零;否则 0。

### <a name="remarks"></a>备注

此方法从注册表的特定部分清除应用程序数据。 您可以使用参数*lpszSectionName*指定要清除的部分。 如果*lpszSectionName*为 NULL，则此方法将使用存储在对象中的`CWinAppEx`默认注册表路径。 要获取默认注册表路径，请使用[CWinAppEx：：获取注册库](#getregistrybase)。

## <a name="cwinappexcwinappex"></a><a name="cwinappex"></a>CWinAppEx：CWinAppEx

构造 `CWinAppEx` 对象。

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>参数

*b资源智能更新*<br/>
[在]一个布尔参数，用于指定工作区对象是否应检测和处理资源更新。

### <a name="remarks"></a>备注

该`CWinAppEx`类具有初始化方法，提供用于将应用程序信息保存和加载到注册表的功能，并控制全局应用程序设置。 它还使您能够使用全局管理器，如[键盘管理器类](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)。 每个应用程序只能有`CWinAppEx`一个类的实例。

## <a name="cwinappexenableloadwindowplacement"></a><a name="enableloadwindowplacement"></a>CWinAppEx：：启用加载窗口放置

指定应用程序是否将从注册表加载主框架窗口的初始大小和位置。

```cpp
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]指定应用程序是否从注册表加载主框架窗口的初始大小和位置。

### <a name="remarks"></a>备注

默认情况下，主帧的大小和位置与其他应用程序设置一起从注册表加载。 这发生在[CWinAppEx：：加载状态](#loadstate)。 如果不想从注册表加载初始窗口放置，请调用此方法，将*bEnable*设置为 FALSE。

## <a name="cwinappexenabletearoffmenus"></a><a name="enabletearoffmenus"></a>CWinAppEx：：启用"离开菜单"

创建并初始化[CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md)对象。

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>参数

*lpszRegEntry*<br/>
[在]包含注册表项路径的字符串。 应用程序使用此注册表项存储拆解菜单的信息。

*uiCmdFirst*<br/>
[在]第一个撕下菜单 ID。

*uiCmdLast*<br/>
[在]上次撕下菜单 ID。

### <a name="return-value"></a>返回值

如果成功创建`CMenuTearOffManager`和初始化，则为 TRUE;如果发生错误或已存在错误，`CMenuTearOffManager`则 FALSE。

### <a name="remarks"></a>备注

使用此功能在应用程序中启用分义菜单。 应从`InitInstance`调用此函数。

## <a name="cwinappexenableusertools"></a><a name="enableusertools"></a>CWinAppEx：启用用户工具

使用户能够创建自定义菜单命令，以减少应用程序中的击键。 此方法创建一个[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)对象。

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>参数

*uiCmdToolsDummy*<br/>
[在]框架用作用户工具菜单的命令 ID 的占位符的无符号整数。

*uiCmdFirst*<br/>
[在]第一个用户工具命令的命令 ID。

*uiCmdLast*<br/>
[在]最后一个用户工具命令的命令 ID。

*pToolRTC*<br/>
[在]对象用于创建新用户`CUserToolsManager`工具的类。

*uArgMenuID*<br/>
[在]参数菜单 ID。

*乌伊尼特迪尔梅尼*<br/>
[在]初始工具目录的菜单 ID。

### <a name="return-value"></a>返回值

如果方法创建并初始化对象，则为`CUserToolsManager`TRUE;如果方法创建并初始化对象，则为 TRUE。如果方法失败或对象已存在，`CUserToolsManager`则 FALSE。

### <a name="remarks"></a>备注

启用用户定义的工具时，框架将自动支持可在自定义期间扩展的动态菜单。 框架将每个新项目与外部命令关联。 当用户从 **"工具"** 菜单中选择适当的项时，框架将调用这些命令。

每次用户添加新项时，框架都会创建一个新对象。 新对象的类类型由*pToolRTC*定义。 *pToolRTC*类类型必须派生自[CUserTool 类](../../mfc/reference/cusertool-class.md)。

有关用户工具以及如何将它们合并到应用程序中的详细信息，请参阅[用户定义的工具](../../mfc/user-defined-tools.md)。

## <a name="cwinappexexitinstance"></a><a name="exitinstance"></a>CWinAppEx：退出实例

```
virtual int ExitInstance();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cwinappexgetbinary"></a><a name="getbinary"></a>CWinAppEx：获取 Binary

从指定的注册表项读取二进制数据。

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项名称的字符串。

*ppData*<br/>
[出]指向方法填充二进制数据的缓冲区的指针。

*p字节*<br/>
[出]指向无符号整数的指针，该方法用于写入读取的字节数。

### <a name="return-value"></a>返回值

如果成功，则为 TRUE;否则。

### <a name="remarks"></a>备注

此方法读取写入注册表的二进制数据。 要将数据写入注册表，请使用[CWinAppEx：：写入 Binary](#writebinary)和[CWinAppEx：：WriteCCBinary。](#writesectionbinary)

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetcontextmenumanager"></a><a name="getcontextmenumanager"></a>CWinAppEx：获取上下文菜单管理器

返回指向全局[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象的指针。

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>返回值

指向全局`CContextMenuManager`对象的指针。

### <a name="remarks"></a>备注

如果未初始化 CContextMenuManager 对象，则此函数在返回指针之前调用[CWinAppEx：：initContextMenuManager。](#initcontextmenumanager)

## <a name="cwinappexgetdataversion"></a><a name="getdataversion"></a>CWinAppEx：获取数据版本

```
int GetDataVersion() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cwinappexgetdataversionmajor"></a><a name="getdataversionmajor"></a>CWinAppEx：获取数据版本主要

返回调用[CWinAppEx：：：保存状态](#savestate)时保存在 Windows 注册表中的应用程序的主要版本。

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>返回值

包含主要版本号的整数值。

## <a name="cwinappexgetdataversionminor"></a><a name="getdataversionminor"></a>CWinAppEx：获取数据版本次要

返回调用[CWinAppEx：：：保存状态](#savestate)时保存在 Windows 注册表中的应用程序的次要版本。

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>返回值

包含次要版本号的整数值。

## <a name="cwinappexgetint"></a><a name="getint"></a>CWinAppEx：Getint

从指定的注册表项读取整数数据。

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项名称的字符串。

*n默认*<br/>
[在]如果指定的注册表项不存在，该方法返回的默认值。

### <a name="return-value"></a>返回值

如果方法成功，则注册表数据;否则*n 默认*。

### <a name="remarks"></a>备注

此方法从注册表读取整数数据。 如果没有与*lpszEntry*指示的注册表项关联的整数数据，则此方法将返回*nDefault*。 要将数据写入注册表，请使用[CWinAppEx：：WriteSectionint](#writesectionint)和[CWinAppEx：：WriteInt。](#writeint)

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetkeyboardmanager"></a><a name="getkeyboardmanager"></a>CWinAppEx：获取键盘管理器

返回指向全局[键盘管理器](../../mfc/reference/ckeyboardmanager-class.md)对象的指针。

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>返回值

指向全局`CKeyboardManager`对象的指针。

### <a name="remarks"></a>备注

如果未初始化键盘管理器，则此函数在返回指针之前调用[CWinAppEx：：Init键盘管理器](#initkeyboardmanager)。

## <a name="cwinappexgetmousemanager"></a><a name="getmousemanager"></a>CWinAppEx：获取鼠标管理器

返回指向全局[CMouseManager](../../mfc/reference/cmousemanager-class.md)对象的指针。

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>返回值

指向全局`CMouseManager`对象的指针。

### <a name="remarks"></a>备注

如果未初始化鼠标管理器，则此函数在返回指针之前调用[CWinAppEx：：InitMouseManager。](#initmousemanager)

## <a name="cwinappexgetobject"></a><a name="getobject"></a>CWinAppEx：获取对象

从注册表读取[CObject](../../mfc/reference/cobject-class.md)- dervied 数据。

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项的相对路径的字符串。

obj**<br/>
[出]对 的`CObject`引用。 该方法使用此引用来存储注册表数据。

### <a name="return-value"></a>返回值

如果方法成功，则非零;否则 0。

### <a name="remarks"></a>备注

此方法从 派生自`CObject`的注册表读取数据。 要将数据`CObject`写入注册表，请使用[CWinAppEx：：writeObject](#writeobject)或[CWinAppEx：：WriteSectionObject](#writesectionobject)。

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetregistrybase"></a><a name="getregistrybase"></a>CWinAppEx：获取注册库

检索应用程序的默认注册表路径。

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>返回值

包含默认注册表位置的路径的字符串。

### <a name="remarks"></a>备注

访问注册表的[CWinAppEx 类](../../mfc/reference/cwinappex-class.md)的所有方法都从默认位置开始。 使用此方法检索默认注册表位置的路径。 使用[CWinAppEx：：设置注册库](#setregistrybase)以更改默认注册表位置。

## <a name="cwinappexgetregsectionpath"></a><a name="getregsectionpath"></a>CWinAppEx：获取 RegSectionPath

创建并返回注册表项的绝对路径。

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>参数

*sz节添加*<br/>
[在]包含注册表项的相对路径的字符串。

### <a name="return-value"></a>返回值

包含`CString`注册表项的绝对路径的 。

### <a name="remarks"></a>备注

此方法通过将*szSectionAdd*中的相对路径追加到应用程序的默认注册表位置来定义注册表项的绝对路径。 要获取默认注册表项，请使用[CWinAppEx：：getRegistryBase](#getregistrybase)的方法。

## <a name="cwinappexgetsectionbinary"></a><a name="getsectionbinary"></a>CWinAppEx：获取截面二进制

从注册表读取二进制数据。

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
[在]包含要读取的值的字符串。

*ppData*<br/>
[出]指向方法存储数据的缓冲区的指针。

*p字节*<br/>
[出]指向无符号整数的指针。 该方法将*ppData*的大小写入此参数。

### <a name="return-value"></a>返回值

若成功，则为 TRUE；否则为 FALSE。

### <a name="remarks"></a>备注

此方法使用[CWinAppEx：：writeBinary](#writebinary)和[CWinAppEx：：WriteCWinAppEx：：WriteCCbinary）](#writesectionbinary)读取写入注册表的二进制数据。

*lpszSubSection 参数*不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetsectionint"></a><a name="getsectionint"></a>CWinAppEx：获取科科因

从注册表读取整数数据。

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
[在]包含要读取的值的字符串。

*n默认*<br/>
[在]如果指定值不存在，则返回的默认值。

### <a name="return-value"></a>返回值

存储在指定注册表值中的整数数据;n 如果数据不存在，*则默认为。*

### <a name="remarks"></a>备注

使用[CWinAppEx：：WriteInt](#writeint)和[CWinAppEx：writeSectionint](#writesectionint)的方法将整数数据写入注册表。

*lpszSubSection 参数*不是注册表项的绝对路径。 它是添加到应用程序的默认注册表项末尾的相对路径。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetsectionobject"></a><a name="getsectionobject"></a>CWinAppEx：获取节点对象

从注册表读取[CObject](../../mfc/reference/cobject-class.md)注册表数据。

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
[在]包含要读取的值的字符串。

obj**<br/>
[出]对 的`CObject`引用。 该方法使用它`CObject`来存储注册表数据。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此方法从注册表读取数据。 读取的数据是从`CObject`派生的类的数据或数据`CObject`。 要将数据`CObject`写入注册表，请使用[CWinAppEx：：writeObject](#writeobject)或[CWinAppEx：：WriteSectionObject](#writesectionobject)。

*lpszSubSection 参数*不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetsectionstring"></a><a name="getsectionstring"></a>CWinAppEx：获取节串

从注册表读取字符串数据。

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
[在]包含要读取的值的字符串。

*lpszDefault*<br/>
[在]如果指定值不存在，则返回的默认值。

### <a name="return-value"></a>返回值

如果数据存在，则存储在指定注册表值中的字符串数据;否则*lpszDefault*。

### <a name="remarks"></a>备注

此方法读取写入注册表的字符串数据。 使用[CWinAppEx：：WriteString](#writestring)和[CWinAppEx：write节字符串](#writesectionstring)写入注册表。

*lpszSubSection 参数*不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgetshellmanager"></a><a name="getshellmanager"></a>CWinAppEx：获取壳牌管理器

返回指向全局[CShellManager](../../mfc/reference/cshellmanager-class.md)对象的指针。

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>返回值

指向全局`CShellManager`对象的指针。

### <a name="remarks"></a>备注

如果未初始`CShellManager`化对象，此函数在返回指针之前调用[CWinAppEx：：InitShellManager。](#initshellmanager)

## <a name="cwinappexgetstring"></a><a name="getstring"></a>CWinAppEx：GetString

从指定的注册表项读取字符串数据。

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项名称的字符串

*lpzDefault*<br/>
[在]如果指定的注册表项不存在，该方法返回的默认值。

### <a name="return-value"></a>返回值

如果成功，存储在注册表中的字符串数据;*否则，lpszDefault。*

### <a name="remarks"></a>备注

此方法读取写入注册表的字符串数据。 要将数据写入注册表，请使用[CWinAppEx：：WriteString](#writestring)或[CWinAppEx：：Write节字符串](#writesectionstring)。

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexgettooltipmanager"></a><a name="gettooltipmanager"></a>CWinAppEx：获取工具提示管理器

返回指向全局[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)对象的指针。

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>返回值

指向全局`CTooltipManager`对象的指针。

### <a name="remarks"></a>备注

如果未初始`CTooltipManager`化对象，此函数在返回指针之前调用[CWinAppEx：：InitTooltipManager。](#inittooltipmanager)

## <a name="cwinappexgetusertoolsmanager"></a><a name="getusertoolsmanager"></a>CWinAppEx：获取用户工具管理器

返回指向全局[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)对象的指针。

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>返回值

指向全局对象的指针;`CUserToolsManager`指向全局对象的指针如果未为应用程序启用用户工具管理，则为 NULL。

### <a name="remarks"></a>备注

在检索指向对象的`CUserToolsManager`指针之前，必须通过调用[CWinAppEx：：启用UserTools](#enableusertools)来初始化管理器。

## <a name="cwinappexinitcontextmenumanager"></a><a name="initcontextmenumanager"></a>CWinAppEx：：在it上下文菜单管理器

初始化[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象。

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>返回值

如果方法创建 CContextMenuManager 对象，则非零;如果对象已`CContextMenuManager`存在，则为 0。

### <a name="remarks"></a>备注

如果您调用[CWinAppEx：：获取ContextMenuManager，](#getcontextmenumanager)该方法的默认实现调用`InitContextMenuManager`。

如果应用程序已具有上下文菜单管理器，并且调用`InitContextMenuManager`，则应用程序将出现[ASSERT](diagnostic-services.md#assert)失败。 因此，如果直接创建对象`InitContextMenuManager`，`CContextMenuManager`则不应调用。 如果不使用自定义`CContextMenuManager`，则应使用`GetContextMenuManager`来创建`CContextMenuManager`对象。

## <a name="cwinappexinitkeyboardmanager"></a><a name="initkeyboardmanager"></a>CWinAppEx：：Init键盘管理器

初始化[键盘管理器](../../mfc/reference/ckeyboardmanager-class.md)对象。

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>返回值

如果方法创建`CKeyboardManager`对象，则非零;如果对象已`CKeyboardManager`存在，则为 0。

### <a name="remarks"></a>备注

如果您调用[CWinAppEx：：获取键盘管理器](#getkeyboardmanager)，则该方法的默认实现调用`InitKeyboardManager`。

如果应用程序已具有键盘管理器，并且调用`InitKeyboardManager`，则应用程序将出现[ASSERT](diagnostic-services.md#assert)失败。 因此，如果直接创建对象`InitKeyboardManager`，`CKeyboardManager`则不应调用。 如果不使用自定义`CKeyboardManager`，则应使用`GetKeyboardManager`来创建`CKeyboardManager`对象。

## <a name="cwinappexinitmousemanager"></a><a name="initmousemanager"></a>CWinAppEx：：InitMouse管理器

初始化[CMouseManager](../../mfc/reference/cmousemanager-class.md)对象。

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>返回值

如果方法创建`CMouseManager`对象，则非零;如果对象已`CMouseManager`存在，则为 0。

### <a name="remarks"></a>备注

如果您调用[CWinAppEx：：GetMouseManager，](#getmousemanager)该方法的默认实现调用`InitMouseManager`。

如果应用程序已具有鼠标管理器，并且调用`InitMouseManager`，则应用程序将出现[ASSERT](diagnostic-services.md#assert)失败。 因此，如果直接创建`InitMouseManager`对象，`CMouseManager`则不应调用。 如果不使用自定义`CMouseManager`，则应使用`GetMouseManager`来创建`CMouseManager`对象。

## <a name="cwinappexinitshellmanager"></a><a name="initshellmanager"></a>CWinAppEx：：InitShell管理器

初始化[CShellManager](../../mfc/reference/cshellmanager-class.md)对象。

```
BOOL InitShellManager();
```

### <a name="return-value"></a>返回值

如果方法创建`CShellManager`对象，则非零;如果对象已`CShellManager`存在，则为 0。

### <a name="remarks"></a>备注

如果您调用[CWinAppEx：：getShellManager，](#getshellmanager)该方法的默认实现调用`InitShellManager`。

如果应用程序已具有 shell 管理器，并且调用`InitShellManager`，则应用程序将引发[ASSERT](diagnostic-services.md#assert)失败。 因此，如果直接创建`InitShellManager`对象，`CShellManager`请不要调用。 如果不使用自定义`CShellManager`，请使用`GetShellManager`创建`CShellManager`对象。

## <a name="cwinappexinittooltipmanager"></a><a name="inittooltipmanager"></a>CWinAppEx：：InitTooltip管理器

初始化[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)对象。

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>返回值

如果方法创建`CTooltipManager`对象，则非零;如果对象已`CTooltipManager`存在，则为 0。

### <a name="remarks"></a>备注

如果您调用[CWinAppEx：：getTooltipManager，](#gettooltipmanager)该方法的默认实现调用`InitTooltipManager`。

如果应用程序已有工具提示管理器，并且您调用`InitTooltipManager`，则应用程序将出现[ASSERT](diagnostic-services.md#assert)失败。 因此，如果直接创建对象`InitTooltipManager`，`CTooltipManager`则不应调用。 如果不使用自定义`CTooltipManager`，则应使用`GetTooltipManager`来创建`CTooltipManager`对象。

## <a name="cwinappexisresourcesmartupdate"></a><a name="isresourcesmartupdate"></a>CWinAppEx：是资源智能更新

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cwinappexisstateexists"></a><a name="isstateexists"></a>CWinAppEx：是否存在

指示指定的密钥是否位于注册表中。

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>参数

*lpsz节名称*<br/>
[在]包含注册表项路径的字符串。

### <a name="return-value"></a>返回值

如果密钥在注册表中，则非零;否则 0。

## <a name="cwinappexloadcustomstate"></a><a name="loadcustomstate"></a>CWinAppEx：：加载自定义状态

框架在从注册表加载应用程序的状态后调用此方法。

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>备注

如果要在应用程序从注册表加载状态后执行任何处理，请重写此方法。 默认情况下，此方法不执行任何操作。

为了从注册表加载自定义状态信息，必须首先使用[CWinAppEx：：：保存自定义状态保存](#savecustomstate)信息。

## <a name="cwinappexloadstate"></a><a name="loadstate"></a>CWinAppEx：：加载状态

从 Windows 注册表读取应用程序状态。

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>参数

*pFrame*<br/>
[在]指向帧窗口对象的指针。 该方法将注册表中的状态信息应用于此帧窗口。

*lpsz节名称*<br/>
[在]包含注册表项的相对路径的字符串。

*pFrameImpl*<br/>
[在]指向`CFrameImpl`对象的指针。 该方法将注册表中的状态信息应用于此帧窗口。

### <a name="return-value"></a>返回值

如果成功，则非零;0 否则。

### <a name="remarks"></a>备注

此方法加载应用程序的状态和帧窗口的任何状态信息。 帧窗口的加载信息应用于提供的帧窗口。 如果不提供帧窗口，则仅加载应用程序状态信息。 应用程序信息包括[CMouseManager 类](../../mfc/reference/cmousemanager-class.md)[、CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)[、C键盘管理器类](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)的状态。

调用`CFrameImpl::OnLoadFrame``LoadState`的默认实现。

*lpszSectionName*参数不是注册表项的绝对路径。 它是添加到应用程序的默认注册表项末尾的相对路径。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexloadwindowplacement"></a><a name="loadwindowplacement"></a>CWinAppEx：：加载窗口放置

当框架从注册表加载主框架窗口的大小和位置时，由框架调用。

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>参数

*rect正常位置*<br/>
[出]在主框架窗口处于还原位置时包含其坐标的矩形。

*nFlags*<br/>
[出]控制最小化窗口的位置以及操作系统在最小化窗口和还原窗口之间切换的方式的标志。

*nShowCmd*<br/>
[出]指定窗口的显示状态的整数。 有关可能值的详细信息，请参阅[CWnd：：ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

### <a name="return-value"></a>返回值

如果成功，则非零;0 否则。

### <a name="remarks"></a>备注

默认情况下，MFC 在应用程序启动时自动加载主框架窗口的上一个位置和状态。 有关此信息如何存储在注册表中的详细信息，请参阅[CWinAppEx：：存储窗口放置](#storewindowplacement)。

如果要加载有关主框架窗口的其他信息，则重写此方法。

## <a name="cwinappexm_bforceimagereset"></a><a name="m_bforceimagereset"></a>CWinAppEx：m_bForceImageReset

指定框架在重新加载包含工具栏的框架窗口时是否重置所有工具栏图像。

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>备注

数据`m_bForceImageReset`成员是受保护的变量。

## <a name="cwinappexonappcontexthelp"></a><a name="onappcontexthelp"></a>CWinAppEx：应用上下文帮助

当用户请求**自定义**对话框的上下文帮助时，框架将调用此方法。

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>参数

*pWndControl*<br/>
[在]指向窗口对象的指针，用户在调用上下文时帮助该窗口对象。

*dwHelpIDArray]**<br/>
[在]保留值。

### <a name="remarks"></a>备注

此方法当前保留以供将来使用。 默认实现不执行任何操作，并且框架当前不调用它。

## <a name="cwinappexonclosingmainframe"></a><a name="onclosingmainframe"></a>CWinAppEx：：打开主框架

当帧窗口正在处理WM_CLOSE时，框架调用此方法。

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>参数

*pFrameImpl*<br/>
[在]指向`CFrameImpl`对象的指针。

### <a name="remarks"></a>备注

此方法的默认实现保存*pFrameImpl*的状态。

## <a name="cwinappexonviewdoubleclick"></a><a name="onviewdoubleclick"></a>CWinAppEx：：OnView双击

调用用户定义的命令，当用户双击该视图中的任意位置时，该命令与视图关联。

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>参数

*pwnd*<br/>
[在]指向从[CView 类](../../mfc/reference/cview-class.md)派生的对象的指针。

*iViewId*<br/>
[在]视图 ID。

### <a name="return-value"></a>返回值

如果框架找到命令，则为 TRUE;如果框架找到命令，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

为了支持自定义鼠标行为，您必须在处理WM_LBUTTONDBLCLK消息时调用此函数。 此方法将执行与*iViewId*提供的视图 ID 关联的命令。 有关自定义鼠标行为的详细信息，请参阅[键盘和鼠标自定义](../../mfc/keyboard-and-mouse-customization.md)。

## <a name="cwinappexonworkspaceidle"></a><a name="onworkspaceidle"></a>CWinAppEx：在工作空间上

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>参数

[在]*CWnd&#38;*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cwinappexpreloadstate"></a><a name="preloadstate"></a>CWinAppEx：:P重新加载状态

框架在从注册表加载应用程序的状态之前立即调用此方法。

```
virtual void PreLoadState();
```

### <a name="remarks"></a>备注

如果要在框架加载应用程序状态之前立即执行任何处理，请重写此方法。

## <a name="cwinappexpresavestate"></a><a name="presavestate"></a>CWinAppEx：:P重新保存状态

框架在保存应用程序状态之前立即调用此方法。

```
virtual void PreSaveState();
```

### <a name="remarks"></a>备注

如果要在框架保存应用程序状态之前立即执行任何处理，请重写此方法。

## <a name="cwinappexreloadwindowplacement"></a><a name="reloadwindowplacement"></a>CWinAppEx：：重新加载窗口放置

从注册表重新加载窗口的大小和位置。

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>参数

*pFrame*<br/>
[在]指向框架窗口的指针。

### <a name="return-value"></a>返回值

如果方法成功，则非零;如果负载失败或没有要加载的数据，则为 0。

### <a name="remarks"></a>备注

使用函数[CWinAppEx：：存储窗口放置](#storewindowplacement)将窗口的大小和位置写入注册表。

## <a name="cwinappexsavecustomstate"></a><a name="savecustomstate"></a>CWinAppEx：：保存自定义状态

框架在将应用程序的状态保存到注册表后调用此方法。

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>备注

如果要在应用程序将状态保存到注册表后执行任何处理，请重写此方法。 默认情况下，此方法不执行任何操作。

## <a name="cwinappexsavestate"></a><a name="savestate"></a>CWinAppEx：：保存状态

将应用程序状态写入 Windows 注册表。

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>参数

*lpsz节名称*<br/>
[在]包含注册表项的相对路径的字符串。

*pFrameImpl*<br/>
[在]指向`CFrameImpl`对象的指针。 此框架将保存到 Windows 注册表。

*pFrame*<br/>
[在]指向帧窗口对象的指针。 此框架将保存到 Windows 注册表。

### <a name="return-value"></a>返回值

如果成功，则为 TRUE;否则。

### <a name="remarks"></a>备注

此方法保存应用程序的状态和提供帧窗口的任何状态信息。 如果不提供帧窗口，该方法将仅保存应用程序状态。 应用程序信息包括[CMouseManager 类](../../mfc/reference/cmousemanager-class.md)[、CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)[、C键盘管理器类](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)的状态。

*lpszSectionName*参数不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

## <a name="cwinappexsetregistrybase"></a><a name="setregistrybase"></a>CWinAppEx：：设置注册库

设置应用程序的默认注册表路径。

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>参数

*lpsz节名称*<br/>
[在]包含注册表项路径的字符串。

### <a name="return-value"></a>返回值

包含默认注册表位置的路径的字符串。

### <a name="remarks"></a>备注

访问注册表的[CWinAppEx 类](../../mfc/reference/cwinappex-class.md)的所有方法都从默认位置开始。 使用此方法更改该默认注册表位置。 使用[CWinAppEx：获取注册库](#getregistrybase)来检索默认注册表位置。

## <a name="cwinappexshowpopupmenu"></a><a name="showpopupmenu"></a>CWinAppEx：：显示弹出菜单

显示弹出式菜单。

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>参数

*uiMenuResId*<br/>
[在]菜单资源 ID。

*点*<br/>
[在]指定菜单在屏幕坐标中位置的[CPoint。](../../atl-mfc-shared/reference/cpoint-class.md)

*pwnd*<br/>
[在]指向具有弹出菜单的窗口的指针。

### <a name="return-value"></a>返回值

如果弹出菜单成功显示，则非零;0 否则。

### <a name="remarks"></a>备注

此方法显示与*uiMenuResId*关联的菜单。

要支持弹出式菜单，您必须具有[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)对象。 如果尚未初始化对象，`CContextMenuManager``ShowPopupMenu`将失败。

## <a name="cwinappexstorewindowplacement"></a><a name="storewindowplacement"></a>CWinAppEx：：商店窗口放置

由框架调用，将主框架窗口的大小和位置写入注册表。

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>参数

*nFlags*<br/>
[在]控制最小化窗口的位置以及操作系统在最小化窗口和还原窗口之间切换的方式的标志。

*nShowCmd*<br/>
[在]指定窗口的显示状态的整数。 有关可能值的详细信息，请参阅[CWnd：：ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

*rect正常位置*<br/>
[在]在主框架窗口处于还原状态时包含其坐标的矩形。

### <a name="return-value"></a>返回值

如果成功，则非零;0 否则。

### <a name="remarks"></a>备注

默认情况下，MFC 会在应用程序退出之前自动保存主框架窗口的位置和状态。 此信息存储在应用程序的默认注册表位置的"窗口放置"键下的 Windows 注册表中。 有关应用程序的默认注册表位置的详细信息，请参阅[CWinAppEx：：获取注册库](#getregistrybase)。

如果要存储有关主框架窗口的其他信息，则重写此方法。

## <a name="cwinappexwritebinary"></a><a name="writebinary"></a>CWinAppEx：：写入二进制

将二进制数据写入注册表。

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项名称的字符串。

*pData*<br/>
[在]要存储的数据。

*n 字节*<br/>
[在]*pData*的大小（以字节为单位）。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

如果*lpszentry*指定的键不存在，则此方法将创建它。

## <a name="cwinappexwriteint"></a><a name="writeint"></a>CWinAppEx：：写入

将数字数据写入注册表。

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项名称的字符串。

*n值*<br/>
[在]要存储的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

如果*lpszentry*指定的键不存在，则此方法将创建它。

## <a name="cwinappexwriteobject"></a><a name="writeobject"></a>CWinAppEx：写入对象

将派生自[CObject 类](../../mfc/reference/cobject-class.md)的数据写入注册表。

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含要设置的值的字符串。

obj**<br/>
[在]对`CObject`方法将存储的数据的引用。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

此方法将*obj*数据写入默认注册表项下的指定值。 使用[CWinAppEx：获取注册库](#getregistrybase)以确定当前的注册表项。

## <a name="cwinappexwritesectionbinary"></a><a name="writesectionbinary"></a>CWinAppEx：：写节二进制

将二进制数据写入注册表中的值。

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项名称的字符串

*lpszEntry*<br/>
[在]包含要设置的值的字符串。

*pData*<br/>
[在]要写入注册表的数据。

*n 字节*<br/>
[在]*pData*的大小（以字节为单位）。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszSubSection 参数*不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

如果*lpszentry*指定的键不存在，则此方法将创建它。

## <a name="cwinappexwritesectionint"></a><a name="writesectionint"></a>CWinAppEx：：写科因

将数字数据写入注册表。

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项的相对路径的字符串。

*lpszEntry*<br/>
[在]包含要设置的值的字符串。

*n值*<br/>
[在]要写入注册表的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszSubSection 参数*不是注册表项的绝对路径。 它是附加到应用程序的默认注册表项的相对路径。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

如果*lpszentry*指定的键不存在，则此方法将创建它。

## <a name="cwinappexwritesectionobject"></a><a name="writesectionobject"></a>CWinAppEx：写节对象

将派生自[CObject 类](../../mfc/reference/cobject-class.md)的数据写入特定的注册表值。

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项名称的字符串。

*lpszEntry*<br/>
[在]包含要设置的值的名称的字符串。

obj**<br/>
[在]要存储的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszSubSection 参数*不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：setRegistryBase](#setregistrybase)的方法。

如果*lpszEntry*指定的值在*lpszSubSection*指定的注册表项下不存在，则此方法将创建该值。

## <a name="cwinappexwritesectionstring"></a><a name="writesectionstring"></a>CWinAppEx：：写节串

将字符串数据写入注册表中的值。

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>参数

*lpsz 子节*<br/>
[在]包含注册表项名称的字符串。

*lpszEntry*<br/>
[在]包含要设置的值的字符串。

*lpszValue*<br/>
[在]要写入注册表的字符串数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszSubSection 参数*不是注册表项的绝对路径。 它是一个相对路径，追加到应用程序的默认注册表项的末尾。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：setRegistryBase](#setregistrybase)的方法。

如果*lpszEntry*指定的值在*lpszSubSection*下不存在，则此方法将创建它。

## <a name="cwinappexwritestring"></a><a name="writestring"></a>CWinAppEx：：写字符串

将字符串数据写入注册表。

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>参数

*lpszEntry*<br/>
[在]包含注册表项名称的字符串。

*lpszValue*<br/>
[在]要存储的数据。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

*lpszEntry*参数是位于应用程序的默认注册表项下的注册表项的名称。 要获取或设置默认注册表项，请使用[CWinAppEx：：获取注册库](#getregistrybase)和[CWinAppEx：：设置注册表项的方法](#setregistrybase)。

如果*lspzentry*指定的键不存在，则此方法将创建它。

## <a name="see-also"></a>请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CWinApp 类](../../mfc/reference/cwinapp-class.md)<br/>
[CMouseManager 类](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager 类](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[CKeyboardManager 类](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[CUserToolsManager 类](../../mfc/reference/cusertoolsmanager-class.md)
