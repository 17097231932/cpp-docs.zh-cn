---
description: 了解详细信息： CMFCRibbonCategory 类
title: CMFCRibbonCategory 类
ms.date: 11/19/2018
f1_keywords:
- CMFCRibbonCategory
- AFXRIBBONCATEGORY/CMFCRibbonCategory
- AFXRIBBONCATEGORY/CMFCRibbonCategory::CMFCRibbonCategory
- AFXRIBBONCATEGORY/CMFCRibbonCategory::AddHidden
- AFXRIBBONCATEGORY/CMFCRibbonCategory::AddPanel
- AFXRIBBONCATEGORY/CMFCRibbonCategory::CopyFrom
- AFXRIBBONCATEGORY/CMFCRibbonCategory::FindByData
- AFXRIBBONCATEGORY/CMFCRibbonCategory::FindByID
- AFXRIBBONCATEGORY/CMFCRibbonCategory::FindPanelWithElem
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetContextID
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetData
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetDroppedDown
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetElements
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetElementsByID
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetFirstVisibleElement
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetFocused
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetHighlighted
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetImageCount
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetImageSize
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetItemIDsList
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetLastVisibleElement
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetLargeImages
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetMaxHeight
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetName
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetPanel
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetPanelCount
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetPanelFromPoint
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetPanelIndex
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetParentButton
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetParentMenuBar
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetParentRibbonBar
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetRect
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetSmallImages
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetTabColor
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetTabRect
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetTextTopLine
- AFXRIBBONCATEGORY/CMFCRibbonCategory::GetVisibleElements
- AFXRIBBONCATEGORY/CMFCRibbonCategory::HighlightPanel
- AFXRIBBONCATEGORY/CMFCRibbonCategory::HitTest
- AFXRIBBONCATEGORY/CMFCRibbonCategory::HitTestEx
- AFXRIBBONCATEGORY/CMFCRibbonCategory::HitTestScrollButtons
- AFXRIBBONCATEGORY/CMFCRibbonCategory::IsActive
- AFXRIBBONCATEGORY/CMFCRibbonCategory::IsVisible
- AFXRIBBONCATEGORY/CMFCRibbonCategory::IsWindows7Look
- AFXRIBBONCATEGORY/CMFCRibbonCategory::NotifyControlCommand
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnCancelMode
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnDraw
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnDrawImage
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnDrawMenuBorder
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnKey
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnLButtonDown
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnLButtonUp
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnMouseMove
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnRTLChanged
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnScrollHorz
- AFXRIBBONCATEGORY/CMFCRibbonCategory::OnUpdateCmdUI
- AFXRIBBONCATEGORY/CMFCRibbonCategory::RecalcLayout
- AFXRIBBONCATEGORY/CMFCRibbonCategory::RemovePanel
- AFXRIBBONCATEGORY/CMFCRibbonCategory::ReposPanels
- AFXRIBBONCATEGORY/CMFCRibbonCategory::SetCollapseOrder
- AFXRIBBONCATEGORY/CMFCRibbonCategory::SetData
- AFXRIBBONCATEGORY/CMFCRibbonCategory::SetKeys
- AFXRIBBONCATEGORY/CMFCRibbonCategory::SetName
- AFXRIBBONCATEGORY/CMFCRibbonCategory::SetTabColor
helpviewer_keywords:
- CMFCRibbonCategory [MFC], CMFCRibbonCategory
- CMFCRibbonCategory [MFC], AddHidden
- CMFCRibbonCategory [MFC], AddPanel
- CMFCRibbonCategory [MFC], CopyFrom
- CMFCRibbonCategory [MFC], FindByData
- CMFCRibbonCategory [MFC], FindByID
- CMFCRibbonCategory [MFC], FindPanelWithElem
- CMFCRibbonCategory [MFC], GetContextID
- CMFCRibbonCategory [MFC], GetData
- CMFCRibbonCategory [MFC], GetDroppedDown
- CMFCRibbonCategory [MFC], GetElements
- CMFCRibbonCategory [MFC], GetElementsByID
- CMFCRibbonCategory [MFC], GetFirstVisibleElement
- CMFCRibbonCategory [MFC], GetFocused
- CMFCRibbonCategory [MFC], GetHighlighted
- CMFCRibbonCategory [MFC], GetImageCount
- CMFCRibbonCategory [MFC], GetImageSize
- CMFCRibbonCategory [MFC], GetItemIDsList
- CMFCRibbonCategory [MFC], GetLastVisibleElement
- CMFCRibbonCategory [MFC], GetLargeImages
- CMFCRibbonCategory [MFC], GetMaxHeight
- CMFCRibbonCategory [MFC], GetName
- CMFCRibbonCategory [MFC], GetPanel
- CMFCRibbonCategory [MFC], GetPanelCount
- CMFCRibbonCategory [MFC], GetPanelFromPoint
- CMFCRibbonCategory [MFC], GetPanelIndex
- CMFCRibbonCategory [MFC], GetParentButton
- CMFCRibbonCategory [MFC], GetParentMenuBar
- CMFCRibbonCategory [MFC], GetParentRibbonBar
- CMFCRibbonCategory [MFC], GetRect
- CMFCRibbonCategory [MFC], GetSmallImages
- CMFCRibbonCategory [MFC], GetTabColor
- CMFCRibbonCategory [MFC], GetTabRect
- CMFCRibbonCategory [MFC], GetTextTopLine
- CMFCRibbonCategory [MFC], GetVisibleElements
- CMFCRibbonCategory [MFC], HighlightPanel
- CMFCRibbonCategory [MFC], HitTest
- CMFCRibbonCategory [MFC], HitTestEx
- CMFCRibbonCategory [MFC], HitTestScrollButtons
- CMFCRibbonCategory [MFC], IsActive
- CMFCRibbonCategory [MFC], IsVisible
- CMFCRibbonCategory [MFC], IsWindows7Look
- CMFCRibbonCategory [MFC], NotifyControlCommand
- CMFCRibbonCategory [MFC], OnCancelMode
- CMFCRibbonCategory [MFC], OnDraw
- CMFCRibbonCategory [MFC], OnDrawImage
- CMFCRibbonCategory [MFC], OnDrawMenuBorder
- CMFCRibbonCategory [MFC], OnKey
- CMFCRibbonCategory [MFC], OnLButtonDown
- CMFCRibbonCategory [MFC], OnLButtonUp
- CMFCRibbonCategory [MFC], OnMouseMove
- CMFCRibbonCategory [MFC], OnRTLChanged
- CMFCRibbonCategory [MFC], OnScrollHorz
- CMFCRibbonCategory [MFC], OnUpdateCmdUI
- CMFCRibbonCategory [MFC], RecalcLayout
- CMFCRibbonCategory [MFC], RemovePanel
- CMFCRibbonCategory [MFC], ReposPanels
- CMFCRibbonCategory [MFC], SetCollapseOrder
- CMFCRibbonCategory [MFC], SetData
- CMFCRibbonCategory [MFC], SetKeys
- CMFCRibbonCategory [MFC], SetName
- CMFCRibbonCategory [MFC], SetTabColor
ms.assetid: 99ba25b6-d060-4fdd-bfab-3c46c22981bb
ms.openlocfilehash: e2bdadcc9d4361d650d481bd83faddc09bdd2add
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/11/2020
ms.locfileid: "97293802"
---
# <a name="cmfcribboncategory-class"></a>CMFCRibbonCategory 类

`CMFCRibbonCategory`类实现包含一组[功能区面板](../../mfc/reference/cmfcribbonpanel-class.md)的功能区选项卡。

## <a name="syntax"></a>语法

```
class CMFCRibbonCategory : public CObject
```

## <a name="members"></a>成员

### <a name="protected-constructors"></a>受保护的构造函数

|名称|描述|
|----------|-----------------|
|[CMFCRibbonCategory：： CMFCRibbonCategory](#cmfcribboncategory)|构造函数。|

### <a name="public-methods"></a>公共方法

|“属性”|描述|
|----------|-----------------|
|[CMFCRibbonCategory：： AddHidden](#addhidden)|将隐藏元素添加到功能区类别。|
|[CMFCRibbonCategory：： AddPanel](#addpanel)|将新面板添加到功能区类别。|
|[CMFCRibbonCategory：： CopyFrom](#copyfrom)||
|[CMFCRibbonCategory：： FindByData](#findbydata)||
|[CMFCRibbonCategory：： FindByID](#findbyid)||
|[CMFCRibbonCategory：： FindPanelWithElem](#findpanelwithelem)||
|[CMFCRibbonCategory：： GetContextID](#getcontextid)|返回功能区类别的上下文 ID。|
|[CMFCRibbonCategory：：](#getdata)|返回与功能区类别关联的用户定义数据。|
|[CMFCRibbonCategory：： GetDroppedDown](#getdroppeddown)||
|[CMFCRibbonCategory：： GetElements](#getelements)||
|[CMFCRibbonCategory：： GetElementsByID](#getelementsbyid)||
|[CMFCRibbonCategory：： GetFirstVisibleElement](#getfirstvisibleelement)|获取属于功能区类别的第一个可见元素。|
|[CMFCRibbonCategory：： GetFocused](#getfocused)|返回焦点元素。|
|[CMFCRibbonCategory：： GetHighlighted](#gethighlighted)|返回突出显示的元素。|
|[CMFCRibbonCategory：： GetImageCount](#getimagecount)||
|[CMFCRibbonCategory：： GetImageSize](#getimagesize)||
|[CMFCRibbonCategory：： GetItemIDsList](#getitemidslist)||
|[CMFCRibbonCategory：： GetLastVisibleElement](#getlastvisibleelement)|获取属于功能区类别的最后一个可见元素|
|[CMFCRibbonCategory：： GetLargeImages](#getlargeimages)|返回对功能区类别使用的大型图像列表的引用。|
|[CMFCRibbonCategory：： GetMaxHeight](#getmaxheight)||
|[CMFCRibbonCategory：： GetName](#getname)||
|[CMFCRibbonCategory：： GetPanel](#getpanel)|返回指向位于指定索引处的功能区面板的指针。|
|[CMFCRibbonCategory：： GetPanelCount](#getpanelcount)|返回功能区类别中的功能区面板的数目。|
|[CMFCRibbonCategory：： GetPanelFromPoint](#getpanelfrompoint)||
|[CMFCRibbonCategory：： GetPanelIndex](#getpanelindex)|返回指定功能区面板的索引。|
|[CMFCRibbonCategory::GetParentButton](#getparentbutton)||
|[CMFCRibbonCategory::GetParentMenuBar](#getparentmenubar)||
|[CMFCRibbonCategory：： GetParentRibbonBar](#getparentribbonbar)||
|[CMFCRibbonCategory：： GetRect](#getrect)||
|[CMFCRibbonCategory：： GetSmallImages](#getsmallimages)|返回对该类别所使用的小型图像列表的引用。|
|[CMFCRibbonCategory：： GetTabColor](#gettabcolor)|返回功能区类别选项卡的当前颜色。|
|[CMFCRibbonCategory：： GetTabRect](#gettabrect)||
|[CMFCRibbonCategory：： GetTextTopLine](#gettexttopline)||
|[CMFCRibbonCategory：： GetVisibleElements](#getvisibleelements)|获取属于功能区类别的所有可见元素。|
|[CMFCRibbonCategory：： HighlightPanel](#highlightpanel)||
|[CMFCRibbonCategory：： System.windows.media.visualtreehelper.hittest](#hittest)||
|[CMFCRibbonCategory：： HitTestEx](#hittestex)||
|[CMFCRibbonCategory::HitTestScrollButtons](#hittestscrollbuttons)||
|[CMFCRibbonCategory：： IsActive](#isactive)||
|[CMFCRibbonCategory：： IsVisible](#isvisible)|确定功能区类别是否可见。|
|[CMFCRibbonCategory：： IsWindows7Look](#iswindows7look)|指示父功能区是否具有 Windows 7 样式的外观 (小型矩形应用程序按钮) |
|[CMFCRibbonCategory::NotifyControlCommand](#notifycontrolcommand)||
|[CMFCRibbonCategory::OnCancelMode](#oncancelmode)||
|[CMFCRibbonCategory：： OnDraw](#ondraw)||
|[CMFCRibbonCategory：： OnDrawImage](#ondrawimage)||
|[CMFCRibbonCategory：： OnDrawMenuBorder](#ondrawmenuborder)||
|[CMFCRibbonCategory：： OnKey](#onkey)|当用户按下键盘按钮时由框架调用。|
|[CMFCRibbonCategory：： OnLButtonDown](#onlbuttondown)||
|[CMFCRibbonCategory：： OnLButtonUp](#onlbuttonup)||
|[CMFCRibbonCategory：： OnMouseMove](#onmousemove)||
|[CMFCRibbonCategory：： OnRTLChanged](#onrtlchanged)||
|[CMFCRibbonCategory：： OnScrollHorz](#onscrollhorz)||
|[CMFCRibbonCategory::OnUpdateCmdUI](#onupdatecmdui)||
|[CMFCRibbonCategory：： RecalcLayout](#recalclayout)||
|[CMFCRibbonCategory：： RemovePanel](#removepanel)||
|[CMFCRibbonCategory：： ReposPanels](#repospanels)||
|[CMFCRibbonCategory：： SetCollapseOrder](#setcollapseorder)|定义功能区类中存在的功能区面板的折叠顺序。|
|[CMFCRibbonCategory：： SetData](#setdata)|将用户定义的数据存储在功能区类别中。|
|[CMFCRibbonCategory：： SetKeys](#setkeys)|将 keytip 分配给功能区类别。|
|[CMFCRibbonCategory：： SetName](#setname)||
|[CMFCRibbonCategory：： SetTabColor](#settabcolor)|设置功能区类别的颜色。|

## <a name="remarks"></a>备注

通常，可以通过调用 [CMFCRibbonBar：： AddCategory](../../mfc/reference/cmfcribbonbar-class.md#addcategory)间接创建一个功能区类别，该功能会返回指向新创建的功能区类别的指针。 可以通过调用 [CMFCRibbonCategory：： AddPanel](#addpanel)将面板添加到类别中。

`CMFCRibbonTab`类绘制功能区类别。 它派生自 [CMFCRibbonBaseElement 类](../../mfc/reference/cmfcribbonbaseelement-class.md)。

下面的示例演示如何创建功能区类别，并向其添加面板。

```cpp
// Create a new ribbon category and get a pointer to it`
CMFCRibbonCategory* pCategory = m_wndRibbonBar.AddCategory
    (_T("&Write"),           // Category name
    IDB_WRITE,               // Category small images (16 x 16)
    IDB_WRITE_LARGE);        // Category large images (32 x 32)

// Add a panel to the new category
CMFCRibbonPanel* pPanel = pCategory->AddPanel (
    _T("Clipboard"),                // Panel name
    m_PanelIcons.ExtractIcon (0));  // Panel icon
```

下图显示了 RibbonApp 示例应用程序的 "主页" 类别的插图。

![RibbonApp 示例应用程序中的 Home 类别](../../mfc/reference/media/cmfcribboncategory.png "RibbonApp 示例应用程序中的 Home 类别")

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

`CMFCRibbonCategory`

## <a name="requirements"></a>要求

**标头：** afxribboncategory

## <a name="cmfcribboncategoryaddhidden"></a><a name="addhidden"></a> CMFCRibbonCategory：： AddHidden

将指定的功能区元素添加到自定义对话框上显示的功能区元素的数组中。

```cpp
void AddHidden(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>parameters

*pElem*<br/>
中指向功能区元素的指针。

### <a name="remarks"></a>备注

"自定义" 对话框上的功能区元素是可以添加到快速访问工具栏的命令。

## <a name="cmfcribboncategoryaddpanel"></a><a name="addpanel"></a> CMFCRibbonCategory：： AddPanel

创建功能区类别的功能区面板。

```
CMFCRibbonPanel* AddPanel(
    LPCTSTR lpszPanelName,
    HICON hIcon = 0,
    CRuntimeClass* pRTI = NULL);
```

### <a name="parameters"></a>parameters

*lpszPanelName*<br/>
中指向新功能区面板的名称的指针。

*hIcon*<br/>
中新功能区面板的默认图标的句柄。

*pRTI*<br/>
中指向自定义功能区面板的运行时类信息的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为指向新功能区面板的指针;否则为 NULL。

### <a name="remarks"></a>备注

若要创建自定义功能区面板，必须在 *pRTI* 中指定其运行时类信息。 自定义功能区面板类必须派生自 `CMFCRibbonPanel` 类。

当空间不足，无法显示功能区元素时，将显示功能区面板的默认图标。

### <a name="example"></a>示例

下面的示例演示如何使用 `AddPanel` 类中的方法 `CMFCRibbonCategory` 。

[!code-cpp[NVC_MFC_RibbonApp#10](../../mfc/reference/codesnippet/cpp/cmfcribboncategory-class_1.cpp)]

## <a name="cmfcribboncategorycmfcribboncategory"></a><a name="cmfcribboncategory"></a> CMFCRibbonCategory：： CMFCRibbonCategory

构造并初始化 [CMFCRibbonCategory](../../mfc/reference/cmfcribboncategory-class.md) 对象。

```
CMFCRibbonCategory(
    CMFCRibbonBar* pParenrRibbonBar,
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage = CSize(16,
    16),
    CSize sizeLargeImage = CSize(32,
    32));
```

### <a name="parameters"></a>parameters

*pParenrRibbonBar*<br/>
中指向功能区类别的父功能区栏的指针。

*lpszName*<br/>
中功能区类别的名称。

*uiSmallImagesResID*<br/>
中功能区类别中功能区元素使用的小图像的图像列表的资源 ID。

*uiLargeImagesResID*<br/>
中功能区类别中功能区元素使用的大型图像的图像列表的资源 ID。

*sizeSmallImage*<br/>
中功能区类别中功能区元素的小图像的默认大小。

*sizeLargeImage*<br/>
中功能区类别中功能区元素的大图像的默认大小。

## <a name="cmfcribboncategorycopyfrom"></a><a name="copyfrom"></a> CMFCRibbonCategory：： CopyFrom

将指定 [CMFCRibbonCategory](../../mfc/reference/cmfcribboncategory-class.md) 的状态复制到当前 [CMFCRibbonCategory](../../mfc/reference/cmfcribboncategory-class.md) 对象。

```
virtual void CopyFrom(CMFCRibbonCategory& src);
```

### <a name="parameters"></a>parameters

*src*<br/>
中源 `CMFCRibbonCategory` 对象。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryfindbydata"></a><a name="findbydata"></a> CMFCRibbonCategory：： FindByData

检索与指定的数据关联的功能区元素。

```
CMFCRibbonBaseElement* FindByData(
    DWORD_PTR dwData,
    BOOL bVisibleOnly = TRUE) const;
```

### <a name="parameters"></a>parameters

*dwData*<br/>
中与功能区元素关联的数据。

*bVisibleOnly*<br/>
中若要在搜索中包含快速访问功能区元素，则为 TRUE;若要在搜索中排除快速访问功能区元素，则为 FALSE。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryfindbyid"></a><a name="findbyid"></a> CMFCRibbonCategory：： FindByID

检索与指定的命令 ID 相关联的功能区元素。

```
CMFCRibbonBaseElement* FindByID(
    UINT uiCmdID,
    BOOL bVisibleOnly = TRUE) const;
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中与功能区元素关联的命令 ID。

*bVisibleOnly*<br/>
中若要在搜索中包含快速访问功能区元素，则为 TRUE;若要在搜索中排除快速访问功能区元素，则为 FALSE。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryfindpanelwithelem"></a><a name="findpanelwithelem"></a> CMFCRibbonCategory：： FindPanelWithElem

检索包含指定功能区元素的功能区面板。

```
CMFCRibbonPanel* FindPanelWithElem(const CMFCRibbonBaseElement* pElement);
```

### <a name="parameters"></a>parameters

*pElement*<br/>
中指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区面板的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetcontextid"></a><a name="getcontextid"></a> CMFCRibbonCategory：： GetContextID

检索功能区类别的上下文 ID。

```
UINT GetContextID() const;
```

### <a name="return-value"></a>返回值

功能区类别的上下文 ID。

### <a name="remarks"></a>备注

如果功能区类别不是上下文功能区类别，上下文 ID 为0。

## <a name="cmfcribboncategorygetdata"></a><a name="getdata"></a> CMFCRibbonCategory：：

检索与功能区类别关联的用户定义数据。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

与功能区类别关联的用户定义数据。

## <a name="cmfcribboncategorygetdroppeddown"></a><a name="getdroppeddown"></a> CMFCRibbonCategory：： GetDroppedDown

检索指向当前显示其弹出菜单的功能区元素的指针。

```
CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetelements"></a><a name="getelements"></a> CMFCRibbonCategory：： GetElements

检索功能区类别中的所有功能区元素。

```cpp
void GetElements(
    CArray <CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*arElements*<br/>
[in，out]对功能区元素的 [CArray](../../mfc/reference/carray-class.md) 的引用。

### <a name="remarks"></a>备注

为在快速访问工具栏上使用而设计的功能区元素包含在数组中。

## <a name="cmfcribboncategorygetelementsbyid"></a><a name="getelementsbyid"></a> CMFCRibbonCategory：： GetElementsByID

检索与指定的命令 ID 相关联的所有功能区元素。

```cpp
void GetElementsByID(
    UINT uiCmdID,
    CArray <CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中与功能区元素关联的命令 ID。

*arElements*<br/>
[in，out]对功能区元素的 [CArray](../../mfc/reference/carray-class.md) 的引用。

### <a name="remarks"></a>备注

为在快速访问工具栏上使用而设计的功能区元素包含在数组中。

## <a name="cmfcribboncategorygetfirstvisibleelement"></a><a name="getfirstvisibleelement"></a> CMFCRibbonCategory：： GetFirstVisibleElement

检索属于功能区类别的第一个可见元素。

```
CMFCRibbonBaseElement* GetFirstVisibleElement() const;
```

### <a name="return-value"></a>返回值

指向第一个可见元素的指针;如果类别不包含任何可见元素，则可以为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetfocused"></a><a name="getfocused"></a> CMFCRibbonCategory：： GetFocused

返回焦点元素。

```
CMFCRibbonBaseElement* GetFocused();
```

### <a name="return-value"></a>返回值

指向焦点元素或 NULL 的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygethighlighted"></a><a name="gethighlighted"></a> CMFCRibbonCategory：： GetHighlighted

返回突出显示的元素。

```
CMFCRibbonBaseElement* GetHighlighted();
```

### <a name="return-value"></a>返回值

指向突出显示的元素的指针; 如果没有突出显示任何元素，则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetimagecount"></a><a name="getimagecount"></a> CMFCRibbonCategory：： GetImageCount

检索包含在功能区类别中的指定图像列表中的图像数量。

```
int GetImageCount(BOOL bIsLargeImage) const;
```

### <a name="parameters"></a>parameters

*bIsLargeImage*<br/>
中对于大图像列表中的图像数量为 TRUE;对于小图像列表中的图像数量为 FALSE。

### <a name="return-value"></a>返回值

指定图像列表中的图像数量。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetimagesize"></a><a name="getimagesize"></a> CMFCRibbonCategory：： GetImageSize

检索包含在功能区类别中的指定图像列表中的图像的大小。

```
CSize GetImageSize(BOOL bIsLargeImage) const;
```

### <a name="parameters"></a>parameters

*bIsLargeImage*<br/>
中对于大图像大小，为 TRUE;对于小图像大小为 FALSE。

### <a name="return-value"></a>返回值

指定图像列表中的图像的大小。

### <a name="remarks"></a>备注

检索到的大小包含全局映像缩放系数。

## <a name="cmfcribboncategorygetitemidslist"></a><a name="getitemidslist"></a> CMFCRibbonCategory：： GetItemIDsList

检索功能区类别中包含的功能区元素的命令 Id。

```cpp
void GetItemIDsList(
    CList<UINT, UINT>& lstItems,
    BOOL bHiddenOnly = FALSE) const;
```

### <a name="parameters"></a>parameters

*lstItems*<br/>
弄功能区类别中的功能区元素的命令 Id 列表。

*bHiddenOnly*<br/>
中若要排除功能区面板上的功能区面板上显示的功能区元素，则为 TRUE;若要将所有功能区元素包含在功能区类别中，则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetlargeimages"></a><a name="getlargeimages"></a> CMFCRibbonCategory：： GetLargeImages

检索功能区类别中包含的大图像的列表。

```
CMFCToolBarImages& GetLargeImages();
```

### <a name="return-value"></a>返回值

功能区类别中包含的大图像的列表。

## <a name="cmfcribboncategorygetlastvisibleelement"></a><a name="getlastvisibleelement"></a> CMFCRibbonCategory：： GetLastVisibleElement

检索属于功能区类别的最后一个可见元素。

```
CMFCRibbonBaseElement* GetLastVisibleElement() const;
```

### <a name="return-value"></a>返回值

指向最后一个可见元素的指针;如果类别不包含任何可见元素，则可以为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetmaxheight"></a><a name="getmaxheight"></a> CMFCRibbonCategory：： GetMaxHeight

检索功能区类别中包含的功能区面板的最大高度。

```
int GetMaxHeight(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向功能区面板的设备上下文的指针。

### <a name="return-value"></a>返回值

功能区类别中包含的功能区面板的最大高度。

### <a name="remarks"></a>备注

检索到的值包括功能区面板的上边距和下边距的高度。

## <a name="cmfcribboncategorygetname"></a><a name="getname"></a> CMFCRibbonCategory：： GetName

检索功能区类别的名称。

```
LPCTSTR GetName() const;
```

### <a name="return-value"></a>返回值

功能区类别的名称。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetpanel"></a><a name="getpanel"></a> CMFCRibbonCategory：： GetPanel

返回指向位于指定索引处的功能区面板的指针。

```
CMFCRibbonPanel* GetPanel(int nIndex);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中功能区面板的从零开始的索引。

### <a name="return-value"></a>返回值

指向位于指定索引处的功能区面板的指针。

### <a name="remarks"></a>备注

如果 *nIndex* 超出范围，则会引发异常。

## <a name="cmfcribboncategorygetpanelcount"></a><a name="getpanelcount"></a> CMFCRibbonCategory：： GetPanelCount

返回功能区类别中的功能区面板的数目。

```
int GetPanelCount() const;
```

### <a name="return-value"></a>返回值

功能区类别中的功能区面板的数目。

## <a name="cmfcribboncategorygetpanelfrompoint"></a><a name="getpanelfrompoint"></a> CMFCRibbonCategory：： GetPanelFromPoint

检索指向功能区面板的指针（如果指定点位于该面板中）。

```
CMFCRibbonPanel* GetPanelFromPoint(CPoint point) const;
```

### <a name="parameters"></a>parameters

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区面板的指针;否则为 NULL。

### <a name="remarks"></a>备注

仅测试功能区类别中包含的功能区面板。

## <a name="cmfcribboncategorygetpanelindex"></a><a name="getpanelindex"></a> CMFCRibbonCategory：： GetPanelIndex

检索指定功能区面板的从零开始的索引。

```
int GetPanelIndex(const CMFCRibbonPanel* pPanel) const;
```

### <a name="parameters"></a>parameters

*pPanel*<br/>
中指向功能区面板的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为指定功能区面板的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

仅搜索功能区类别中包含的功能区面板。

## <a name="cmfcribboncategorygetparentbutton"></a><a name="getparentbutton"></a> CMFCRibbonCategory：： GetParentButton

检索功能区类别的父功能区元素。

```
CMFCRibbonBaseElement* GetParentButton() const;
```

### <a name="return-value"></a>返回值

返回指向父功能区元素的指针; 如果没有父元素，则返回 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetparentmenubar"></a><a name="getparentmenubar"></a> CMFCRibbonCategory：： GetParentMenuBar

返回指向对象的父菜单栏的指针 `CMFCRibbonCategory` 。

```
CMFCRibbonPanelMenuBar* GetParentMenuBar() const;
```

### <a name="return-value"></a>返回值

返回 `m_pParentMenuBar` 受保护成员的内容。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetparentribbonbar"></a><a name="getparentribbonbar"></a> CMFCRibbonCategory：： GetParentRibbonBar

检索功能区类别的父功能区栏。

```
CMFCRibbonBar* GetParentRibbonBar() const;
```

### <a name="return-value"></a>返回值

指向功能区类别的父功能区栏的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetrect"></a><a name="getrect"></a> CMFCRibbonCategory：： GetRect

检索功能区类别的显示矩形。

```
CRect GetRect() const;
```

### <a name="return-value"></a>返回值

功能区类别的显示矩形。

### <a name="remarks"></a>备注

功能区类别的显示矩形不包括 "类别" 选项卡。

## <a name="cmfcribboncategorygetsmallimages"></a><a name="getsmallimages"></a> CMFCRibbonCategory：： GetSmallImages

检索功能区类别中包含的小图像的列表。

```
CMFCToolBarImages& GetSmallImages();
```

### <a name="return-value"></a>返回值

功能区类别中包含的小图像的列表。

## <a name="cmfcribboncategorygettabcolor"></a><a name="gettabcolor"></a> CMFCRibbonCategory：： GetTabColor

返回功能区类别选项卡的当前颜色。

```
AFX_RibbonCategoryColor GetTabColor() const;
```

### <a name="return-value"></a>返回值

功能区类别选项卡的当前颜色。

### <a name="remarks"></a>备注

返回的值可以是下列枚举值之一：

- AFX_CategoryColor_Red

- AFX_CategoryColor_Orange

- AFX_CategoryColor_Yellow

- AFX_CategoryColor_Green

- AFX_CategoryColor_Blue

- AFX_CategoryColor_Indigo

- AFX_CategoryColor_Violet

## <a name="cmfcribboncategorygettabrect"></a><a name="gettabrect"></a> CMFCRibbonCategory：： GetTabRect

检索功能区类别选项卡的显示矩形。

```
CRect GetTabRect() const;
```

### <a name="return-value"></a>返回值

功能区类别选项卡的显示矩形。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygettexttopline"></a><a name="gettexttopline"></a> CMFCRibbonCategory：： GetTextTopLine

检索显示大图像的功能区类别中的功能区按钮上文本的垂直位置。

```
int GetTextTopLine() const;
```

### <a name="return-value"></a>返回值

显示大图像的功能区按钮上文本的垂直位置（以像素为单位）。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorygetvisibleelements"></a><a name="getvisibleelements"></a> CMFCRibbonCategory：： GetVisibleElements

检索属于功能区类别的所有可见元素。

```cpp
void GetVisibleElements(
    CArray <CMFCRibbonBaseElement*,
    CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*arElements*<br/>
所有可见元素的数组。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryhighlightpanel"></a><a name="highlightpanel"></a> CMFCRibbonCategory：： HighlightPanel

突出显示指定的功能区面板。

```
CMFCRibbonPanel* HighlightPanel(
    CMFCRibbonPanel* pHLPanel,
    CPoint point);
```

### <a name="parameters"></a>parameters

*pHLPanel*<br/>
中指向要突出显示的功能区面板的指针。

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="return-value"></a>返回值

指向前面突出显示的功能区面板的指针;否则，如果在调用此方法时没有突出显示功能区面板，则为 NULL。

### <a name="remarks"></a>备注

有关突出显示功能区面板的详细信息，请参阅 [CMFCRibbonPanel：：突出显示](../../mfc/reference/cmfcribbonpanel-class.md#highlight)。

## <a name="cmfcribboncategoryhittest"></a><a name="hittest"></a> CMFCRibbonCategory：： System.windows.media.visualtreehelper.hittest

检索指向功能区元素的指针（如果指定点位于该元素中）。

```
CMFCRibbonBaseElement* HitTest(
    CPoint point,
    BOOL bCheckPanelCaption = FALSE) const;
```

### <a name="parameters"></a>parameters

*情况*<br/>
中鼠标指针相对于窗口左上角的 x 和 y 坐标。

*bCheckPanelCaption*<br/>
中若要测试功能区面板标题，则为 TRUE;若要排除功能区面板标题，则为 FALSE。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

仅测试功能区类别中包含的功能区元素。

## <a name="cmfcribboncategoryhittestex"></a><a name="hittestex"></a> CMFCRibbonCategory：： HitTestEx

检索指定点所在的功能区元素的从零开始的索引。

```
int HitTestEx(CPoint point) const;
```

### <a name="parameters"></a>parameters

*情况*<br/>
中鼠标指针相对于窗口左上角的 x 和 y 坐标。

### <a name="return-value"></a>返回值

如果方法成功，则为功能区元素的从零开始的索引;否则为-1。

### <a name="remarks"></a>备注

仅测试功能区类别中包含的功能区元素。

## <a name="cmfcribboncategoryhittestscrollbuttons"></a><a name="hittestscrollbuttons"></a> CMFCRibbonCategory：： HitTestScrollButtons

如果某个点落在功能区类别的左或右滚动按钮内，将返回指向该按钮的指针。

```
CMFCRibbonBaseElement* HitTestScrollButtons(CPoint point) const;
```

### <a name="parameters"></a>parameters

*情况*<br/>
中要测试的点。

### <a name="return-value"></a>返回值

如果 *point* 位于功能区类别的左侧滚动按钮或右滚动按钮的边框内，则返回指向该按钮的指针，否则返回 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryisactive"></a><a name="isactive"></a> CMFCRibbonCategory：： IsActive

指示功能区类别是否是功能区栏上的活动类别。

```
BOOL IsActive() const;
```

### <a name="return-value"></a>返回值

如果功能区类别是活动类别，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

活动功能区类别显示其功能区面板。

## <a name="cmfcribboncategoryisvisible"></a><a name="isvisible"></a> CMFCRibbonCategory：： IsVisible

指示功能区类别是否可见。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>返回值

如果功能区类别可见，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

可见的功能区类别显示 "类别" 选项卡。

## <a name="cmfcribboncategoryiswindows7look"></a><a name="iswindows7look"></a> CMFCRibbonCategory：： IsWindows7Look

指示父功能区是否具有 Windows 7 外观 (小型矩形应用程序按钮) 。

```
BOOL IsWindows7Look() const;
```

### <a name="return-value"></a>返回值

如果父功能区具有 Windows 7 外观，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorynotifycontrolcommand"></a><a name="notifycontrolcommand"></a> CMFCRibbonCategory：： NotifyControlCommand

将 WM_NOTIFY 命令消息传递给 `CMFCRibbonPanel` 中的所有元素， `CMFCRibbonCategory` 直到处理该消息。

```
virtual BOOL NotifyControlCommand(
    BOOL bAccelerator,
    int nNotifyCode,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>parameters

*bAccelerator*<br/>
中如果此命令源自加速器，则为 TRUE; 否则为 FALSE。

*nNotifyCode*<br/>
中通知代码。

*wParam*<br/>
中消息的 WPARAM 字段。

*lParam*<br/>
中消息的 LPARAM 字段。

### <a name="return-value"></a>返回值

如果消息已处理，则返回 TRUE; 否则返回 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryoncancelmode"></a><a name="oncancelmode"></a> CMFCRibbonCategory：： OnCancelMode

在的所有元素中调用 cancel 模式 `CMFCRibbonPanel` `CMFCRibbonCategory` 。

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryondraw"></a><a name="ondraw"></a> CMFCRibbonCategory：： OnDraw

由框架调用，用于绘制功能区类别。

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向功能区类别的设备上下文的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryondrawimage"></a><a name="ondrawimage"></a> CMFCRibbonCategory：： OnDrawImage

由框架调用，用于在功能区类别上绘制指定的图像。

```
virtual BOOL OnDrawImage(
    CDC* pDC,
    CRect rect,
    CMFCRibbonBaseElement* pElement,
    BOOL bIsLargeImage,
    BOOL nImageIndex,
    BOOL bCenter);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向图像的设备上下文的指针。

*rect*<br/>
中图像的显示矩形。

*pElement*<br/>
中指向包含图像的功能区元素的指针。

*bIsLargeImage*<br/>
中如果图像大小较大，则为 TRUE;如果图像大小较小，则为 FALSE。

*nImageIndex*<br/>
中在功能区类别中包含的图像数组中图像的从零开始的索引。

*bCenter*<br/>
中若要使图像在显示矩形中居中，则为 TRUE;若为 FALSE，则在显示矩形的左上角绘制图像。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryondrawmenuborder"></a><a name="ondrawmenuborder"></a> CMFCRibbonCategory：： OnDrawMenuBorder

由框架调用，用于绘制弹出菜单的边框。

```
virtual void OnDrawMenuBorder(
    CDC* pDC,
    CMFCRibbonPanelMenuBar* pMenuBar);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中未使用此参数。

*pMenuBar*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以绘制弹出菜单的边框。

## <a name="cmfcribboncategoryonkey"></a><a name="onkey"></a> CMFCRibbonCategory：： OnKey

当用户按下键盘按钮时由框架调用。

```
virtual BOOL OnKey(UINT nChar);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
用户按下的键的虚拟键代码。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryonlbuttondown"></a><a name="onlbuttondown"></a> CMFCRibbonCategory：： OnLButtonDown

在用户按下鼠标左键时，由框架调用以检索指定点下的功能区元素。

```
virtual CMFCRibbonBaseElement* OnLButtonDown(CPoint point);
```

### <a name="parameters"></a>parameters

*情况*<br/>
中鼠标指针相对于窗口左上角的 x 和 y 坐标。

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryonlbuttonup"></a><a name="onlbuttonup"></a> CMFCRibbonCategory：： OnLButtonUp

当用户释放鼠标左键且指针位于功能区类别上方时由框架调用。

```
virtual void OnLButtonUp(CPoint point);
```

### <a name="parameters"></a>parameters

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryonmousemove"></a><a name="onmousemove"></a> CMFCRibbonCategory：： OnMouseMove

当指针在功能区栏上移动时由框架调用，以便更新功能区类别显示。

```
virtual void OnMouseMove(CPoint point);
```

### <a name="parameters"></a>parameters

*情况*<br/>
中指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryonrtlchanged"></a><a name="onrtlchanged"></a> CMFCRibbonCategory：： OnRTLChanged

当布局更改方向时由框架调用。

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>parameters

*bIsRTL*<br/>
中如果布局为从右向左，则为 TRUE; 否则为。如果从左到右布局布局，则为 FALSE。

### <a name="remarks"></a>备注

此方法调整功能区类别中包含的所有功能区面板和功能区元素的布局。

## <a name="cmfcribboncategoryonscrollhorz"></a><a name="onscrollhorz"></a> CMFCRibbonCategory：： OnScrollHorz

沿水平方向滚动功能区类别。

```
virtual BOOL OnScrollHorz(
    BOOL bScrollLeft,
    int nScrollOffset = 0);
```

### <a name="parameters"></a>parameters

*bScrollLeft*<br/>
中如果向左滚动，则为 TRUE;如果向右滚动，则为 FALSE。

*nScrollOffset*<br/>
中以像素为单位的滚动距离。

### <a name="return-value"></a>返回值

如果功能区类别在水平方向上移动，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryonupdatecmdui"></a><a name="onupdatecmdui"></a> CMFCRibbonCategory：： OnUpdateCmdUI

调用 `OnUpdateCmdUI` 的每个元素中的成员函数 `CMFCRibbonPanel` `CMFCRibbonCategory` ，以启用或禁用它们中的用户界面元素。

```
virtual void OnUpdateCmdUI(
    CMFCRibbonCmdUI* pCmdUI,
    CFrameWnd* pTarget,
    BOOL bDisableIfNoHndler);
```

### <a name="parameters"></a>parameters

*pCmdUI*<br/>
中指向 `CMFCRibbonCmdUI` 对象的指针，该对象指定要启用的用户界面元素以及要禁用哪些元素。

*pTarget*<br/>
中指向控制用户界面元素的启用或禁用的窗口的指针。

*bDisableIfNoHndler*<br/>
中如果消息映射中未定义任何处理程序，则为 TRUE; 否则为 false。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryrecalclayout"></a><a name="recalclayout"></a> CMFCRibbonCategory：： RecalcLayout

调整功能区类别上所有控件的布局。

```
virtual void RecalcLayout(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向功能区类别的设备上下文的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategoryremovepanel"></a><a name="removepanel"></a> CMFCRibbonCategory：： RemovePanel

从功能区类别中移除功能区面板。

```cpp
BOOL RemovePanel(
    int nIndex,
    BOOL bDelete = TRUE);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中要移除的面板的索引号。 通过调用 [CMFCRibbonCategory：： GetPanelIndex](#getpanelindex) 方法获取。

*bDelete*<br/>
中若要从内存中删除面板对象，则为 TRUE;若为 FALSE，则删除面板对象而不删除它。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;否则为 FALSE。

## <a name="cmfcribboncategoryrepospanels"></a><a name="repospanels"></a> CMFCRibbonCategory：： ReposPanels

调整功能区面板中包含的功能区面板上所有控件的布局。

```
virtual void ReposPanels(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中一个指针，指向功能区面板中包含的功能区面板的设备上下文。

### <a name="remarks"></a>备注

## <a name="cmfcribboncategorysetcollapseorder"></a><a name="setcollapseorder"></a> CMFCRibbonCategory：： SetCollapseOrder

定义功能区类别的功能区面板折叠的顺序。

```cpp
void SetCollapseOrder(const CArray<int,int>& arCollapseOrder);
```

### <a name="parameters"></a>parameters

*arCollapseOrder*<br/>
中指定折叠顺序。 该数组包含功能区面板的从零开始的索引。

### <a name="remarks"></a>备注

库定义了折叠顺序。 但是，您可以通过使用指定折叠顺序的索引列表提供类别来自定义此行为。

当类别检测到它必须折叠功能区面板时，它将查找指定列表中的下一个元素。 如果列表为空，或未指定足够的元素，则类别将使用内部算法。

例如，该类别具有三个功能区面板，可以进行多次折叠，直到所有面板都处于完全折叠状态。 可以设置以下折叠顺序：0，0，2，2。 在这种情况下，该类别将折叠面板0次（面板 2 2 次）。 索引为1的面板保持 uncollapsed。

### <a name="example"></a>示例

下面的示例演示如何使用 `SetCollapseOrder` 类中的方法 `CMFCRibbonCategory` 。 该示例演示如何为折叠顺序构造数组，以及如何将折叠顺序设置为功能区类别。

[!code-cpp[NVC_MFC_RibbonApp#13](../../mfc/reference/codesnippet/cpp/cmfcribboncategory-class_2.cpp)]

## <a name="cmfcribboncategorysetdata"></a><a name="setdata"></a> CMFCRibbonCategory：： SetData

设置要与功能区类别关联的用户定义数据。

```cpp
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>parameters

*dwData*<br/>
中用户定义数据。

## <a name="cmfcribboncategorysetkeys"></a><a name="setkeys"></a> CMFCRibbonCategory：： SetKeys

将 keytip 分配给功能区类别。

```cpp
void SetKeys(LPCTSTR lpszKeys);
```

### <a name="parameters"></a>parameters

*lpszKeys*<br/>
中Keytip 文本。

### <a name="remarks"></a>备注

当用户按下 Alt 键或 F10 键时，将显示键提示。

## <a name="cmfcribboncategorysetname"></a><a name="setname"></a> CMFCRibbonCategory：： SetName

将名称和 keytip 分配给功能区类别。

```cpp
void SetName(LPCTSTR lpszName);
```

### <a name="parameters"></a>parameters

*lpszName*<br/>
中功能区类别的名称和 keytip。

### <a name="remarks"></a>备注

若要设置功能区类别的 keytip，请将后跟 keytip 字符的行转义序列附加到 *lpszName*。

## <a name="cmfcribboncategorysettabcolor"></a><a name="settabcolor"></a> CMFCRibbonCategory：： SetTabColor

设置功能区类别的颜色。

```cpp
void SetTabColor(AFX_RibbonCategoryColor color);
```

### <a name="parameters"></a>parameters

*color*<br/>
中指定功能区类别的新颜色。

### <a name="remarks"></a>备注

Color 可以为下列值之一：

- AFX_CategoryColor_None

- AFX_CategoryColor_Red

- AFX_CategoryColor_Orange

- AFX_CategoryColor_Yellow

- AFX_CategoryColor_Green

- AFX_CategoryColor_Blue

- AFX_CategoryColor_Indigo

- AFX_CategoryColor_Violet

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[Classes](../../mfc/reference/mfc-classes.md)<br/>
[CObject 类](../../mfc/reference/cobject-class.md)
