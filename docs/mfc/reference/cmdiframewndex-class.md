---
title: CMDIFrameWndEx 类
ms.date: 11/04/2016
f1_keywords:
- CMDIFrameWndEx
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ActiveItemRecalcLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AddPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustClientArea
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustDockingLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AreMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CanCovertControlBarToMDIChild
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ControlBarToTabbedDocument
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateDocumentWindow
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateNewWindow
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPaneLeftOf
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableAutoHidePanes
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableDocking
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMainMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMode
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableLoadDockState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabbedGroups
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabsLastActiveActivation
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnablePaneMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableWindowsDialog
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetActivePopup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetDefaultResId
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabGroups
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabsContextMenuAllowedItems
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMenuBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetRibbonBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetTearOffBars
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetToolbarButtonToolTipText
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::InsertPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsFullScreen
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMDITabbedGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMemberOfMDITabGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMenuBarAvailable
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPointNearDockSite
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPrintPreview
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadMDIState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabMoveToNextGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabNewGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::NegotiateBorderSpace
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseDockingPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseMiniFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnClosePopupMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCmdMsg
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuImage
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuLogo
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnEraseMDIClientBackground
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMenuButtonToolHitTest
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMoveMiniFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSetPreviewMode
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowCustomizePane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowMDITabContextMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPanes
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPopupMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSizeMDIClient
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnTearOffMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnUpdateFrameMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::PaneFromPoint
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RecalcLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RemovePaneFromDockManager
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SaveMDIState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetPrintPreviewFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetupToolbarMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowFullScreen
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowWindowsDialog
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::TabbedDocumentToControlBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateCaption
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateMDITabbedBarsIcons
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::WinHelp
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bCanCovertControlBarToMDIChild
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bDisableSetRedraw
helpviewer_keywords:
- CMDIFrameWndEx [MFC], ActiveItemRecalcLayout
- CMDIFrameWndEx [MFC], AddPane
- CMDIFrameWndEx [MFC], AdjustClientArea
- CMDIFrameWndEx [MFC], AdjustDockingLayout
- CMDIFrameWndEx [MFC], AreMDITabs
- CMDIFrameWndEx [MFC], CanCovertControlBarToMDIChild
- CMDIFrameWndEx [MFC], ControlBarToTabbedDocument
- CMDIFrameWndEx [MFC], CreateDocumentWindow
- CMDIFrameWndEx [MFC], CreateNewWindow
- CMDIFrameWndEx [MFC], DockPane
- CMDIFrameWndEx [MFC], DockPaneLeftOf
- CMDIFrameWndEx [MFC], EnableAutoHidePanes
- CMDIFrameWndEx [MFC], EnableDocking
- CMDIFrameWndEx [MFC], EnableFullScreenMainMenu
- CMDIFrameWndEx [MFC], EnableFullScreenMode
- CMDIFrameWndEx [MFC], EnableLoadDockState
- CMDIFrameWndEx [MFC], EnableMDITabbedGroups
- CMDIFrameWndEx [MFC], EnableMDITabs
- CMDIFrameWndEx [MFC], EnableMDITabsLastActiveActivation
- CMDIFrameWndEx [MFC], EnablePaneMenu
- CMDIFrameWndEx [MFC], EnableWindowsDialog
- CMDIFrameWndEx [MFC], GetActivePopup
- CMDIFrameWndEx [MFC], GetPane
- CMDIFrameWndEx [MFC], GetDefaultResId
- CMDIFrameWndEx [MFC], GetMDITabGroups
- CMDIFrameWndEx [MFC], GetMDITabs
- CMDIFrameWndEx [MFC], GetMDITabsContextMenuAllowedItems
- CMDIFrameWndEx [MFC], GetMenuBar
- CMDIFrameWndEx [MFC], GetRibbonBar
- CMDIFrameWndEx [MFC], GetTearOffBars
- CMDIFrameWndEx [MFC], GetToolbarButtonToolTipText
- CMDIFrameWndEx [MFC], InsertPane
- CMDIFrameWndEx [MFC], IsFullScreen
- CMDIFrameWndEx [MFC], IsMDITabbedGroup
- CMDIFrameWndEx [MFC], IsMemberOfMDITabGroup
- CMDIFrameWndEx [MFC], IsMenuBarAvailable
- CMDIFrameWndEx [MFC], IsPointNearDockSite
- CMDIFrameWndEx [MFC], IsPrintPreview
- CMDIFrameWndEx [MFC], LoadFrame
- CMDIFrameWndEx [MFC], LoadMDIState
- CMDIFrameWndEx [MFC], MDITabMoveToNextGroup
- CMDIFrameWndEx [MFC], MDITabNewGroup
- CMDIFrameWndEx [MFC], NegotiateBorderSpace
- CMDIFrameWndEx [MFC], OnCloseDockingPane
- CMDIFrameWndEx [MFC], OnCloseMiniFrame
- CMDIFrameWndEx [MFC], OnClosePopupMenu
- CMDIFrameWndEx [MFC], OnCmdMsg
- CMDIFrameWndEx [MFC], OnDrawMenuImage
- CMDIFrameWndEx [MFC], OnDrawMenuLogo
- CMDIFrameWndEx [MFC], OnEraseMDIClientBackground
- CMDIFrameWndEx [MFC], OnMenuButtonToolHitTest
- CMDIFrameWndEx [MFC], OnMoveMiniFrame
- CMDIFrameWndEx [MFC], OnSetPreviewMode
- CMDIFrameWndEx [MFC], OnShowCustomizePane
- CMDIFrameWndEx [MFC], OnShowMDITabContextMenu
- CMDIFrameWndEx [MFC], OnShowPanes
- CMDIFrameWndEx [MFC], OnShowPopupMenu
- CMDIFrameWndEx [MFC], OnSizeMDIClient
- CMDIFrameWndEx [MFC], OnTearOffMenu
- CMDIFrameWndEx [MFC], OnUpdateFrameMenu
- CMDIFrameWndEx [MFC], PaneFromPoint
- CMDIFrameWndEx [MFC], RecalcLayout
- CMDIFrameWndEx [MFC], RemovePaneFromDockManager
- CMDIFrameWndEx [MFC], SaveMDIState
- CMDIFrameWndEx [MFC], SetPrintPreviewFrame
- CMDIFrameWndEx [MFC], SetupToolbarMenu
- CMDIFrameWndEx [MFC], ShowFullScreen
- CMDIFrameWndEx [MFC], ShowPane
- CMDIFrameWndEx [MFC], ShowWindowsDialog
- CMDIFrameWndEx [MFC], TabbedDocumentToControlBar
- CMDIFrameWndEx [MFC], UpdateCaption
- CMDIFrameWndEx [MFC], UpdateMDITabbedBarsIcons
- CMDIFrameWndEx [MFC], WinHelp
- CMDIFrameWndEx [MFC], m_bCanCovertControlBarToMDIChild
- CMDIFrameWndEx [MFC], m_bDisableSetRedraw
ms.assetid: dbcafcb3-9a7a-4f11-9dfe-ba57565c81d0
ms.openlocfilehash: dad7c72510c64f5e63586a204f8994f429e7f80f
ms.sourcegitcommit: 8fd49f8ac20457710ceb5403ca46fc73cb3f95f8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/01/2020
ms.locfileid: "85737447"
---
# <a name="cmdiframewndex-class"></a>CMDIFrameWndEx 类

扩展了[CMDIFrameWnd](../../mfc/reference/cframewnd-class.md)（Windows 多文档界面（MDI）框架窗口的功能。

## <a name="syntax"></a>语法

```
class CMDIFrameWndEx : public CMDIFrameWnd
```

## <a name="members"></a>成员

### <a name="public-methods"></a>公共方法

|“属性”|描述|
|----------|-----------------|
|[CMDIFrameWndEx：： ActiveItemRecalcLayout](#activeitemrecalclayout)|重新计算活动项的布局。|
|`CMDIFrameWndEx::AddDockSite`|未使用此方法。|
|[CMDIFrameWndEx：： AddPane](#addpane)|向停靠管理器注册窗格。|
|[CMDIFrameWndEx：： AdjustClientArea](#adjustclientarea)|缩小工作区以允许使用边框。|
|[CMDIFrameWndEx：： AdjustDockingLayout](#adjustdockinglayout)|重新计算所有停靠窗格的布局。|
|[CMDIFrameWndEx：： AreMDITabs](#aremditabs)|确定是否启用 MDI 选项卡功能或 MDI 选项卡式组功能。|
|[CMDIFrameWndEx：： CanCovertControlBarToMDIChild](#cancovertcontrolbartomdichild)|由框架调用，以确定框架窗口是否可以将停靠窗格转换为选项卡式文档。|
|[CMDIFrameWndEx：： ControlBarToTabbedDocument](#controlbartotabbeddocument)|将指定的停靠窗格转换为选项卡式文档。|
|[CMDIFrameWndEx：： CreateDocumentWindow](#createdocumentwindow)|创建子文档窗口。|
|[CMDIFrameWndEx：： CreateNewWindow](#createnewwindow)|由框架调用以创建新窗口。|
|`CMDIFrameWndEx::CreateObject`|由框架用于创建此类类型的动态实例。|
|[CMDIFrameWndEx：:D ockPane](#dockpane)|将指定的窗格停靠到框架窗口中。|
|[CMDIFrameWndEx：:D ockPaneLeftOf](#dockpaneleftof)|将一个窗格停靠到另一个窗格的左侧。|
|[CMDIFrameWndEx：： EnableAutoHidePanes](#enableautohidepanes)|当面板停靠在主框架窗口的指定边时，为其启用自动隐藏模式。|
|[CMDIFrameWndEx：： EnableDocking](#enabledocking)|允许停靠属于 MDI 框架窗口的窗格。|
|[CMDIFrameWndEx::EnableFullScreenMainMenu](#enablefullscreenmainmenu)|显示或隐藏全屏模式下的主菜单。|
|[CMDIFrameWndEx::EnableFullScreenMode](#enablefullscreenmode)|为框架窗口启用全屏模式。|
|[CMDIFrameWndEx::EnableLoadDockState](#enableloaddockstate)|启用或禁用停靠状态的加载。|
|[CMDIFrameWndEx：： EnableMDITabbedGroups](#enablemditabbedgroups)|启用或禁用 MDI 选项卡式组功能。|
|[CMDIFrameWndEx：： EnableMDITabs](#enablemditabs)|启用或禁用 MDI 选项卡功能。 启用后，框架窗口将显示每个 MDI 子窗口的选项卡。|
|[CMDIFrameWndEx：： EnableMDITabsLastActiveActivation](#enablemditabslastactiveactivation)|指定在用户关闭当前选项卡时是否应激活最后一个活动选项卡。|
|[CMDIFrameWndEx：： EnablePaneMenu](#enablepanemenu)|启用或禁用弹出窗口窗格菜单的自动创建和管理，其中显示了应用程序窗格的列表。  .|
|[CMDIFrameWndEx：： EnableWindowsDialog](#enablewindowsdialog)|插入其命令 ID 调用[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)对话框的菜单项。|
|[CMDIFrameWndEx：： GetActivePopup](#getactivepopup)|返回一个指向当前显示的弹出菜单的指针。|
|[CMDIFrameWndEx：： GetPane](#getpane)|返回一个指向具有指定控件 ID 的窗格的指针。|
|[CMDIFrameWndEx：： GetDefaultResId](#getdefaultresid)|返回 MDI 框架窗口的共享资源的 ID。|
|[CMDIFrameWndEx：： GetMDITabGroups](#getmditabgroups)|返回 MDI 选项卡式窗口的列表。|
|[CMDIFrameWndEx：： GetMDITabs](#getmditabs)|返回对带下划线的选项卡式窗口的引用。|
|[CMDIFrameWndEx：： GetMDITabsContextMenuAllowedItems](#getmditabscontextmenualloweditems)|返回在启用 MDI 选项卡式组功能时确定哪些上下文菜单项有效的标志组合。|
|[CMDIFrameWndEx：： GetMenuBar](#getmenubar)|返回一个指向附加到框架窗口的菜单栏对象的指针。|
|[CMDIFrameWndEx::GetRibbonBar](#getribbonbar)|检索框架的功能区栏控件。|
|[CMDIFrameWndEx：： GetTearOffBars](#gettearoffbars)|返回[CPane](../../mfc/reference/cpane-class.md)派生对象的列表，这些对象处于撕状态。|
|`CMDIFrameWndEx::GetThisClass`|由框架调用以获取指向与此类类型相关联的[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)对象的指针。|
|[CMDIFrameWndEx::GetToolbarButtonToolTipText](#gettoolbarbuttontooltiptext)|当应用程序显示工具栏按钮的工具提示时由框架调用。|
|[CMDIFrameWndEx：： InsertPane](#insertpane)|向停靠管理器注册指定窗格。|
|[CMDIFrameWndEx::IsFullScreen](#isfullscreen)|确定框架窗口是否处于全屏模式。|
|[CMDIFrameWndEx：： IsMDITabbedGroup](#ismditabbedgroup)|确定是否已启用 MDI 选项卡式组功能。|
|[CMDIFrameWndEx：： IsMemberOfMDITabGroup](#ismemberofmditabgroup)|确定指定的选项卡式窗口是否处于 MDI 选项卡式组中的窗口列表中。|
|[CMDIFrameWndEx：： IsMenuBarAvailable](#ismenubaravailable)|确定框架窗口是否包含菜单栏。|
|[CMDIFrameWndEx：： IsPointNearDockSite](#ispointneardocksite)|确定指定点是否在停靠站点附近。|
|[CMDIFrameWndEx::IsPrintPreview](#isprintpreview)|确定框架窗口是否处于打印预览模式。|
|[CMDIFrameWndEx：： LoadFrame](#loadframe)|从资源信息创建框架窗口。 （重写 `CMDIFrameWnd::LoadFrame`。）|
|[CMDIFrameWndEx：： LoadMDIState](#loadmdistate)|加载指定的 MDI 选项卡式组的布局和以前打开的文档的列表。|
|[CMDIFrameWndEx：： MDITabMoveToNextGroup](#mditabmovetonextgroup)|将活动选项卡从当前活动的选项卡式窗口移到下一个或上一个选项卡式组。|
|[CMDIFrameWndEx：： MDITabNewGroup](#mditabnewgroup)|创建一个新的选项卡式组，其中包含一个窗口。|
|[CMDIFrameWndEx：： NegotiateBorderSpace](#negotiateborderspace)|在 OLE 就地激活过程中，在框架窗口中协商边框空间。|
|[CMDIFrameWndEx：： OnCloseDockingPane](#onclosedockingpane)|当用户单击可停靠窗格上的 "**关闭**" 按钮时，由框架调用。|
|[CMDIFrameWndEx：： OnCloseMiniFrame](#oncloseminiframe)|当用户在浮动袖珍框架窗口上单击 "**关闭**" 按钮时，由框架调用。|
|[CMDIFrameWndEx：： OnClosePopupMenu](#onclosepopupmenu)|当活动的弹出菜单处理 WM_DESTROY 消息时由框架调用。|
|[CMDIFrameWndEx：： OnCmdMsg](#oncmdmsg)|由框架调用以路由和调度命令消息，并更新命令用户界面对象。|
|[CMDIFrameWndEx：： OnDrawMenuImage](#ondrawmenuimage)|当绘制与菜单项关联的图像时由框架调用。|
|[CMDIFrameWndEx：： OnDrawMenuLogo](#ondrawmenulogo)|当[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)处理 WM_PAINT 消息时由框架调用。|
|[CMDIFrameWndEx：： OnEraseMDIClientBackground](#onerasemdiclientbackground)|当 MDI 框架窗口处理 WM_ERASEBKGND 消息时由框架调用。|
|[CMDIFrameWndEx：： OnMenuButtonToolHitTest](#onmenubuttontoolhittest)|当[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)对象处理 WM_NCHITTEST 消息时由框架调用。|
|[CMDIFrameWndEx：： OnMoveMiniFrame](#onmoveminiframe)|由框架调用以移动微型框架窗口。|
|[CMDIFrameWndEx：： OnSetPreviewMode](#onsetpreviewmode)|设置应用程序的主框架窗口打印预览模式。 （重写 [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。）|
|[CMDIFrameWndEx：： OnShowCustomizePane](#onshowcustomizepane)|当激活快速自定义窗格时由框架调用。|
|[CMDIFrameWndEx：： OnShowMDITabContextMenu](#onshowmditabcontextmenu)|当上下文菜单应显示在某个选项卡上时由框架调用。 （仅对 MDI 选项卡式组有效。）|
|[CMDIFrameWndEx：： OnShowPanes](#onshowpanes)|由框架调用以显示或隐藏窗格。|
|[CMDIFrameWndEx：： OnShowPopupMenu](#onshowpopupmenu)|当激活弹出菜单时由框架调用。|
|[CMDIFrameWndEx::OnSizeMDIClient](#onsizemdiclient)|当客户端 MDI 窗口的大小正在更改时由框架调用。|
|[CMDIFrameWndEx：： OnTearOffMenu](#ontearoffmenu)|当激活带有拖曳栏的菜单时由框架调用。|
|[CMDIFrameWndEx：： OnUpdateFrameMenu](#onupdateframemenu)|由框架调用以更新框架菜单。 （重写 `CMDIFrameWnd::OnUpdateFrameMenu`。）|
|[CMDIFrameWndEx：:P aneFromPoint](#panefrompoint)|返回包含指定点的停靠窗格。|
|`CMDIFrameWndEx::PreTranslateMessage`|在将窗口消息调度到[TranslateMessage](/windows/win32/api/winuser/nf-winuser-translatemessage)和[DispatchMessage](/windows/win32/api/winuser/nf-winuser-dispatchmessage) Windows 函数之前，由[CWinApp](../../mfc/reference/cwinapp-class.md)类用于转换窗口消息。  （重写 `CMDIFrameWnd::PreTranslateMessage`。）|
|[CMDIFrameWndEx：： RecalcLayout](#recalclayout)|由框架调用以重新计算框架窗口的布局。 （重写[CFrameWnd：： RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。）|
|[CMDIFrameWndEx：： RemovePaneFromDockManager](#removepanefromdockmanager)|取消注册窗格，并将其从停靠管理器中删除。|
|[CMDIFrameWndEx：： SaveMDIState](#savemdistate)|保存 MDI 选项卡式组的当前布局和以前打开的文档的列表。|
|[CMDIFrameWndEx::SetPrintPreviewFrame](#setprintpreviewframe)|设置打印预览框架窗口。|
|[CMDIFrameWndEx：： SetupToolbarMenu](#setuptoolbarmenu)|通过搜索虚拟项并将其替换为指定的用户定义项修改工具栏对象。|
|[CMDIFrameWndEx::ShowFullScreen](#showfullscreen)|将主框架从常规模式切换到全屏模式。|
|[CMDIFrameWndEx：： ShowPane](#showpane)|显示或隐藏指定窗格。|
|[CMDIFrameWndEx：： ShowWindowsDialog](#showwindowsdialog)|创建[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)框并将其打开。|
|[CMDIFrameWndEx：： TabbedDocumentToControlBar](#tabbeddocumenttocontrolbar)|将指定的选项卡式文档转换为停靠窗格。|
|[CMDIFrameWndEx::UpdateCaption](#updatecaption)|由框架调用以更新窗口框架标题。|
|[CMDIFrameWndEx：： UpdateMDITabbedBarsIcons](#updatemditabbedbarsicons)|为每个 MDI 选项卡式窗格设置图标。|
|[CMDIFrameWndEx：： WinHelp](#winhelp)|由框架调用以启动 WinHelp 应用程序或上下文帮助。 （重写[CWnd：： WinHelp](../../mfc/reference/cwnd-class.md#winhelp)。）|

### <a name="data-members"></a>数据成员

|“属性”|描述|
|----------|-----------------|
|[CMDIFrameWndEx：： m_bCanCovertControlBarToMDIChild](#m_bcancovertcontrolbartomdichild)|确定停靠窗格是否可转换为 MDI 子窗口。|
|[CMDIFrameWndEx：： m_bDisableSetRedraw](#m_bdisablesetredraw)|启用或禁用 MDI 子窗口的重绘优化。|

## <a name="remarks"></a>备注

若要利用 MDI 应用程序中的扩展自定义功能，请从而不是派生应用程序的 MDI 框架窗口类 `CMDIFrameWndEx` `CMDIFrameWnd` 。

## <a name="example"></a>示例

下面的示例从派生一个类 `CMDIFrameWndEx` 。 此代码段来自于[DrawClient 示例： MFC 基于功能区的 OLE 对象绘图应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_DrawClient#1](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_1.h)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)

[CMDIFrameWndEx](../../mfc/reference/cmdiframewndex-class.md)

## <a name="requirements"></a>要求

**标头：** afxMDIFrameWndEx

## <a name="cmdiframewndexactiveitemrecalclayout"></a><a name="activeitemrecalclayout"></a>CMDIFrameWndEx：： ActiveItemRecalcLayout

重新计算活动项的布局。

```cpp
void ActiveItemRecalcLayout();
```

## <a name="cmdiframewndexaddpane"></a><a name="addpane"></a>CMDIFrameWndEx：： AddPane

向停靠管理器注册窗格。

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail=TRUE);
```

### <a name="parameters"></a>参数

*pControlBar*<br/>
中指向要注册的窗格的指针。

*bTail*<br/>
中指定是否将此窗格添加到列表的末尾。

### <a name="return-value"></a>返回值

如果成功注册窗格，则返回一个非零值。 如果窗格已注册到停靠管理器，则返回0。

### <a name="remarks"></a>备注

每个窗格都必须在[CDockingManager 类](../../mfc/reference/cdockingmanager-class.md)中注册，然后才能加入到停靠布局中。 使用此方法通知停靠管理器您要停靠特定窗格。 注册该窗格后，定位管理器会根据其对齐方式设置，并将其对齐到停靠管理器维护的窗格的列表中。

## <a name="cmdiframewndexadjustclientarea"></a><a name="adjustclientarea"></a>CMDIFrameWndEx：： AdjustClientArea

缩小工作区以允许使用边框。

```
virtual void AdjustClientArea();
```

## <a name="cmdiframewndexadjustdockinglayout"></a><a name="adjustdockinglayout"></a>CMDIFrameWndEx：： AdjustDockingLayout

重新计算所有停靠窗格的布局。

```
virtual void AdjustDockingLayout(HDWP hdwp=NULL);
```

### <a name="parameters"></a>参数

*hdwp*<br/>
中标识多窗口位置结构。 可以通过调用来获取此值 `BeginDeferWindowPos` 。

### <a name="remarks"></a>备注

调用此成员函数以重新计算停靠到框架窗口的所有窗格的布局。

## <a name="cmdiframewndexaremditabs"></a><a name="aremditabs"></a>CMDIFrameWndEx：： AreMDITabs

确定是否启用 MDI 选项卡功能或 MDI 选项卡式组功能。

```
BOOL AreMDITabs(int* pnMDITabsType=NULL) const;
```

### <a name="parameters"></a>参数

*pnMDITabsType*<br/>
弄指向整数变量的指针，该变量指示启用了哪些功能：

- 0：禁用所有功能。

- 1：启用 MDI 选项卡。

- 2：已启用 MDI 选项卡式组。

### <a name="return-value"></a>返回值

如果启用 MDI 选项卡或 MDI 选项卡式组，则返回 TRUE。

如果未启用上述任何功能，则返回 FALSE。

### <a name="remarks"></a>备注

使用此函数可确定是否为框架窗口启用 MDI 选项卡或 MDI 选项卡式组。 使用[CMDIFrameWndEx：： EnableMDITabs](#enablemditabs)可以启用或禁用 MDI 选项卡功能。

使用[CMDIFrameWndEx：： EnableMDITabbedGroups](#enablemditabbedgroups)可以启用或禁用 MDI 选项卡式组功能。

## <a name="cmdiframewndexcancovertcontrolbartomdichild"></a><a name="cancovertcontrolbartomdichild"></a>CMDIFrameWndEx：： CanCovertControlBarToMDIChild

由框架调用，以确定框架窗口是否可以将停靠窗格转换为选项卡式文档

```
virtual BOOL CanCovertControlBarToMDIChild();
```

### <a name="return-value"></a>返回值

如果框架窗口可以将停靠窗格转换为选项卡式文档，则返回 TRUE;否则，返回 FALSE。

### <a name="remarks"></a>备注

在派生类中重写此方法并返回 TRUE，以允许将停靠窗格转换为选项卡式文档。 或者，您可以将[CMDIFrameWndEx：： m_bCanCovertControlBarToMDIChild](#m_bcancovertcontrolbartomdichild)设置为 TRUE。

## <a name="cmdiframewndexcontrolbartotabbeddocument"></a><a name="controlbartotabbeddocument"></a>CMDIFrameWndEx：： ControlBarToTabbedDocument

将指定的停靠窗格转换为选项卡式文档。

```
virtual CMDIChildWndEx* ControlBarToTabbedDocument(CDockablePane* pBar);
```

### <a name="parameters"></a>参数

*pBar*<br/>
一个指针，指向要转换的停靠窗格。

### <a name="return-value"></a>返回值

返回一个指向包含停靠窗格的新 MDI 子窗口的指针。

### <a name="remarks"></a>备注

此方法将停靠窗格转换为选项卡式文档。 当你调用此方法时，框架会创建一个[CMDIChildWndEx 类](../../mfc/reference/cmdichildwndex-class.md)对象，从停靠管理器中删除停靠窗格，并将停靠窗格添加到新的 MDI 子窗口。 MDI 子窗口将调整停靠窗格的大小，以覆盖整个工作区

## <a name="cmdiframewndexcreatedocumentwindow"></a><a name="createdocumentwindow"></a>CMDIFrameWndEx：： CreateDocumentWindow

创建子文档窗口。

```
virtual CMDIChildWndEx* CreateDocumentWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### <a name="parameters"></a>参数

*lpcszDocName*<br/>
中包含文档标识符的文本字符串。 通常，它是文档文件的完整路径。

*pObj*<br/>
中指向用户定义的对象的指针。 例如，开发人员可以创建一个应用程序特定的数据结构，该结构描述文档并说明如何在启动时初始化该文档。

### <a name="return-value"></a>返回值

一个指向 `CMDIChildWndEx` 的指针。

### <a name="remarks"></a>备注

在加载以前保存在注册表中的文档列表时，框架会调用此方法。

重写此方法，以便在从注册表加载文档时创建文档。

### <a name="example"></a>示例

下面的示例演示如何 `CreateDocumentWindow` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

在此示例中， `g_strStartViewName` 可能是不是从磁盘文件实际加载的 "虚拟文档" （例如 "起始页"）的名称。 因此，我们需要特殊处理来处理这种情况。

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="cmdiframewndexcreatenewwindow"></a><a name="createnewwindow"></a>CMDIFrameWndEx：： CreateNewWindow

由框架调用以创建新窗口。

```
virtual CMDIChildWndEx* CreateNewWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### <a name="parameters"></a>参数

*lpcszDocName*<br/>
中文档名称。

*pObj*<br/>
中保留供将来使用。

### <a name="return-value"></a>返回值

指向新窗口的指针。

## <a name="cmdiframewndexdockpane"></a><a name="dockpane"></a>CMDIFrameWndEx：:D ockPane

将指定的窗格停靠到框架窗口中。

```cpp
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID=0,
    LPCRECT lpRect=NULL);
```

### <a name="parameters"></a>参数

*pBar*<br/>
中指向要停靠的窗格的指针。

*nDockBarID*<br/>
中指定要停靠到框架窗口的哪一侧。

*lpRect*<br/>
中不使用。

### <a name="remarks"></a>备注

此方法将指定的窗格停靠到在调用[CBasePane：： EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)和[CMDIFrameWndEx：： EnableDocking](#enabledocking)时指定的框架窗口的一侧。

### <a name="example"></a>示例

下面的示例演示 `DockPane` 方法的用法。 此代码段来自于[VisualStudioDemo 示例： MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#4](../../mfc/codesnippet/cpp/cmdiframewndex-class_3.cpp)]

## <a name="cmdiframewndexdockpaneleftof"></a><a name="dockpaneleftof"></a>CMDIFrameWndEx：:D ockPaneLeftOf

将一个窗格停靠到另一个窗格的左侧。

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>参数

*pBar*<br/>
中指向停靠窗格的指针。

*pLeftOf*<br/>
中指向充当停靠站点的窗格的指针。 .

### <a name="return-value"></a>返回值

如果操作成功，则返回 TRUE。 否则返回 FALSE。

### <a name="remarks"></a>备注

调用此方法以按预定义顺序停靠若干窗格对象。 此方法将*pBar*指定的窗格停靠在*pLeftOf*指定的窗格的左侧。

### <a name="example"></a>示例

下面的示例演示如何 `DockPaneLeftOf` 在 VisualStudioDemo 示例中使用该方法[： MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#5](../../mfc/codesnippet/cpp/cmdiframewndex-class_4.cpp)]

## <a name="cmdiframewndexenableautohidepanes"></a><a name="enableautohidepanes"></a>CMDIFrameWndEx：： EnableAutoHidePanes

当面板停靠在主框架窗口的指定边时，为其启用自动隐藏模式。

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>参数

*dwDockStyle*<br/>
中指定将启用的主框架窗口的边。 使用以下一个或多个标志。

- CBRS_ALIGN_LEFT

- CBRS_ALIGN_RIGHT

- CBRS_ALIGN_TOP

- CBRS_ALIGN_BOTTOM

### <a name="return-value"></a>返回值

调用此函数可在其停靠在主框架窗口的指定边时为其启用自动隐藏模式。

### <a name="example"></a>示例

下面的示例演示如何 `EnableAutoHidePanes` 在 VisualStudioDemo 示例中使用该方法[： MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#6](../../mfc/codesnippet/cpp/cmdiframewndex-class_5.cpp)]

### <a name="remarks"></a>备注

## <a name="cmdiframewndexenabledocking"></a><a name="enabledocking"></a>CMDIFrameWndEx：： EnableDocking

允许停靠属于 MDI 框架窗口的窗格。

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>参数

*dwDockStyle*<br/>
中指定要应用的停靠样式。

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

调用此函数可启用属于对象的窗格的停靠 `CMDIFrameWndEx` 。

### <a name="example"></a>示例

下面的示例演示如何 `EnableDocking` 在 VisualStudioDemo 示例中使用该方法[： MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#7](../../mfc/codesnippet/cpp/cmdiframewndex-class_6.cpp)]

## <a name="cmdiframewndexenablefullscreenmainmenu"></a><a name="enablefullscreenmainmenu"></a>CMDIFrameWndEx：： EnableFullScreenMainMenu

显示或隐藏全屏模式下的主菜单。

```cpp
void EnableFullScreenMainMenu(BOOL bEnableMenu);
```

### <a name="parameters"></a>参数

*bEnableMenu*<br/>
中若要在全屏模式下显示主菜单，则为 TRUE; 否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexenablefullscreenmode"></a><a name="enablefullscreenmode"></a>CMDIFrameWndEx：： EnableFullScreenMode

为框架窗口启用全屏模式。

```cpp
void EnableFullScreenMode(UINT uiFullScreenCmd);
```

### <a name="parameters"></a>参数

*uiFullScreenCmd*<br/>
中启用或禁用全屏模式的命令 ID。

### <a name="remarks"></a>备注

在全屏模式下，将隐藏所有停靠控件栏、工具栏和菜单，并调整活动视图的大小以占据全屏。启用全屏模式时，必须指定启用或禁用它的命令 ID。 可以 `EnableFullScreenMode` 从主框架的函数中调用 `OnCreate` 。 当框架窗口切换到全屏模式时，框架会创建一个浮动工具栏，其中包含一个按钮，该按钮具有指定的命令 ID。如果要在屏幕上保留主菜单，请调用[CMDIFrameWndEx：： EnableFullScreenMainMenu](#enablefullscreenmainmenu)。

## <a name="cmdiframewndexenableloaddockstate"></a><a name="enableloaddockstate"></a>CMDIFrameWndEx：： EnableLoadDockState

启用或禁用停靠状态的加载。

```cpp
void EnableLoadDockState(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要启用停靠状态的加载，则为 FALSE，禁用停靠状态的加载。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexenablemditabbedgroups"></a><a name="enablemditabbedgroups"></a>CMDIFrameWndEx：： EnableMDITabbedGroups

启用或禁用框架窗口的 MDI 选项卡式组功能。

```cpp
void EnableMDITabbedGroups(
    BOOL bEnable,
    const CMDITabInfo& params);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中如果为 TRUE，则启用 MDI 选项卡式组功能;如果为 FALSE，则禁用 MDI 选项卡式组功能。

*params*<br/>
中指定框架适用于在 MDI 客户端区域中创建的子窗口的参数。

### <a name="remarks"></a>备注

使用此方法可以启用或禁用 MDI 选项卡式组功能。 此功能允许 MDI 应用程序将子窗口显示为在 MDI 工作区中垂直或水平对齐的选项卡式窗口。 将用拆分器分隔选项卡式窗口组。 用户可以使用拆分器调整选项卡式组的大小。

- 用户可以：

- 拖动组间的各个选项卡。

- 将各个选项卡拖动到窗口的边缘，以创建新组。

- 使用快捷菜单移动选项卡或创建新组。

- 您的应用程序可以保存选项卡式窗口的当前布局以及当前打开的文档的列表。

如果在*bEnable*设置为 FALSE 的情况下调用此方法，则将忽略*params* 。

即使已启用 MDI 选项卡式组，也可以再次调用此方法来修改子窗口的设置。 调用方法，将*bEnable*设置为 TRUE，并修改 `CMDITabInfo` 由*params*参数指定的对象的成员。

有关如何使用 MDI 选项卡式组的详细信息，请参阅[Mdi 选项卡式组](../../mfc/mdi-tabbed-groups.md)。

### <a name="example"></a>示例

下面的示例演示如何 `EnableMDITabbedGroups` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#8](../../mfc/codesnippet/cpp/cmdiframewndex-class_7.cpp)]

## <a name="cmdiframewndexenablemditabs"></a><a name="enablemditabs"></a>CMDIFrameWndEx：： EnableMDITabs

为 MDI 框架窗口启用或禁用 MDI 选项卡功能。 启用后，框架窗口将显示每个 MDI 子窗口的选项卡。

```cpp
void EnableMDITabs(
    BOOL bEnable=TRUE,
    BOOL bIcons=TRUE,
    CMFCTabCtrl::Location tabLocation=CMFCTabCtrl::LOCATION_BOTTOM,
    BOOL bTabCloseButton=FALSE,
    CMFCTabCtrl::Style style=CMFCTabCtrl::STYLE_3D_SCROLLED,
    BOOL bTabCustomTooltips=FALSE,
    BOOL bActiveTabCloseButton=FALSE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
指定是否启用选项卡。

*bIcons*<br/>
指定图标是否应显示在选项卡上。

*tabLocation*<br/>
指定选项卡标签的位置。

*bTabCloseButton*<br/>
指定是否显示制表符关闭按钮。

style <br/>
指定选项卡的样式。 将 STYLE_3D_SCROLLED 用于常规选项卡或 Microsoft OneNote 选项卡 STYLE_3D_ONENOTE。

*bTabCustomTooltips*<br/>
指定是否启用自定义工具提示。

*bActiveTabCloseButton*<br/>
如果为 TRUE，则 "**关闭**" 按钮将显示在 "活动" 选项卡上，而不是在选项卡区域的右侧。

### <a name="remarks"></a>备注

调用此方法可为 MDI 框架窗口启用或禁用 MDI 选项卡功能。 启用后，所有子窗口都显示为选项卡。

选项卡标签可以位于帧的顶部或底部，具体取决于参数*tabLocation*的设置。 您可以指定 `CMFCTabCtrl::LOCATION_BOTTOM` （默认设置）或 `CMFCTabCtrl::LOCATION_TOP` 。

如果*bTabCustomTooltips*为 TRUE，则会向主框架窗口发送 AFX_WM_ON_GET_TAB_TOOLTIP 消息。 你的代码可以处理此消息，并为 framework 提供了用于 MDI 选项卡的自定义工具提示。

### <a name="example"></a>示例

下面的示例演示如何 `EnableMDITabs` 在[MDITabsDemo 示例中使用： MFC 选项卡式 MDI 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_MDITabsDemo#3](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_8.cpp)]

## <a name="cmdiframewndexenablemditabslastactiveactivation"></a><a name="enablemditabslastactiveactivation"></a>CMDIFrameWndEx：： EnableMDITabsLastActiveActivation

指定在用户关闭当前选项卡时是否应打开最后一个活动选项卡。

```cpp
void EnableMDITabsLastActiveActivation(BOOL bLastActiveTab=TRUE);
```

### <a name="parameters"></a>参数

*bLastActiveTab*<br/>
中如果为 TRUE，则启用上一个活动选项卡的激活。如果为 FALSE，则禁用上一个活动选项卡的激活。

### <a name="remarks"></a>备注

关闭活动选项卡时，有两种方法可以打开选项卡：

- 激活下一个选项卡。

- 激活以前活动的选项卡。

默认实现使用第一种方法。

使用 `EnableMDITabsLastActiveActivation` 启用选项卡激活的第二种方式。 它模拟 Windows 打开 MDI 子窗口的方式。

## <a name="cmdiframewndexenablepanemenu"></a><a name="enablepanemenu"></a>CMDIFrameWndEx：： EnablePaneMenu

启用或禁用弹出窗口窗格菜单的自动创建和管理，其中显示了应用程序窗格的列表。

```cpp
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly=FALSE,
    BOOL bViewMenuShowsToolbarsOnly=FALSE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中如果为 TRUE，则启用窗格菜单的自动处理;如果为 FALSE，则禁用自动处理。

*uiCustomizeCmd*<br/>
中"**自定义**" 菜单项的命令 ID。 此菜单项通常添加到窗格列表的末尾。

*strCustomizeLabel*<br/>
中要为 "**自定义**" 菜单项显示的文本（用于本地化）。

*uiViewToolbarsMenuEntryID*<br/>
中指定打开窗格菜单的工具栏菜单项的 ID。 通常，这是 "**视图**" 菜单的 "**工具栏**" 子菜单。

*bContextMenuShowsToolbarsOnly*<br/>
中如果为 TRUE，则窗格菜单仅显示工具栏列表。 如果为 FALSE，则菜单显示工具栏和停靠栏的列表。

*bViewMenuShowsToolbarsOnly*<br/>
中如果为 TRUE，则窗格菜单仅显示工具栏列表。 如果为 FALSE，则菜单显示工具栏和停靠栏的列表。

### <a name="remarks"></a>备注

弹出式窗格菜单将显示应用程序窗格的列表，并允许用户显示或隐藏单个窗格。

### <a name="example"></a>示例

下面的示例演示如何 `EnablePaneMenu` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#9](../../mfc/codesnippet/cpp/cmdiframewndex-class_9.cpp)]

## <a name="cmdiframewndexenablewindowsdialog"></a><a name="enablewindowsdialog"></a>CMDIFrameWndEx：： EnableWindowsDialog

插入其命令 ID 调用[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)对话框的菜单项。

```cpp
void EnableWindowsDialog(
    UINT uiMenuId,
    LPCTSTR lpszMenuText,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);

void EnableWindowsDialog(
    UINT uiMenuId,
    UINT uiMenuTextResId,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);
```

### <a name="parameters"></a>参数

*uiMenuId*<br/>
中指定菜单的资源 ID。

*lpszMenuText*<br/>
中指定项的文本。

*bShowHelpButton*<br/>
中指定是否在 "windows 管理" 对话框中显示 "**帮助**" 按钮。

*uiMenuTextResId*<br/>
中字符串资源标识符，其中包含项的文本字符串。

### <a name="remarks"></a>备注

使用此方法插入其命令调用 MDI 子窗口管理对话框（ [CMFCWindowsManagerDialog 类](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)）的菜单项。 新项将插入到由*uiMenuId*指定的菜单中。 `EnableWindowsDialog`处理 WM_CREATE 消息时调用。

### <a name="example"></a>示例

下面的示例演示如何 `EnableWindowsDialog` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#10](../../mfc/codesnippet/cpp/cmdiframewndex-class_10.cpp)]

## <a name="cmdiframewndexgetactivepopup"></a><a name="getactivepopup"></a>CMDIFrameWndEx：： GetActivePopup

返回一个指向当前显示的弹出菜单的指针。

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>返回值

指向活动弹出菜单的指针;如果没有活动的弹出菜单，则为 NULL。

### <a name="remarks"></a>备注

使用此函数获取指向当前显示的[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象的指针。

## <a name="cmdiframewndexgetdefaultresid"></a><a name="getdefaultresid"></a>CMDIFrameWndEx：： GetDefaultResId

返回 MDI 框架窗口的共享资源的 ID。

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>返回值

资源 ID 值。 如果框架窗口没有菜单栏，则为0。

### <a name="remarks"></a>备注

此方法返回由[CFrameWnd：： LoadFrame](../../mfc/reference/cframewnd-class.md#loadframe)加载 MDI 框架窗口时指定的资源 ID。

## <a name="cmdiframewndexgetmditabgroups"></a><a name="getmditabgroups"></a>CMDIFrameWndEx：： GetMDITabGroups

返回 MDI 选项卡式窗口的列表。

```
const CObList& GetMDITabGroups() const;
```

### <a name="return-value"></a>返回值

对[CObList 类](../../mfc/reference/coblist-class.md)对象的引用，该对象包含选项卡式窗口的列表。 请勿存储或修改列表。

### <a name="remarks"></a>备注

使用此方法访问选项卡式窗口的列表。 如果要更改或查询各个选项卡式窗口的某些参数，这会很有帮助。

## <a name="cmdiframewndexgetmditabs"></a><a name="getmditabs"></a>CMDIFrameWndEx：： GetMDITabs

返回对带下划线的选项卡式窗口的引用。

```
CMFCTabCtrl& GetMDITabs();
```

### <a name="return-value"></a>返回值

对带下划线的选项卡式窗口的引用。

## <a name="cmdiframewndexgetmditabscontextmenualloweditems"></a><a name="getmditabscontextmenualloweditems"></a>CMDIFrameWndEx：： GetMDITabsContextMenuAllowedItems

返回在启用 MDI 选项卡式组功能时确定哪些操作有效的标志组合。

```
DWORD GetMDITabsContextMenuAllowedItems();
```

### <a name="return-value"></a>返回值

以下标志的按位 "或" 组合：

- AFX_MDI_CREATE_VERT_GROUP-可以创建垂直选项卡组。

- AFX_MDI_CREATE_HORZ_GROUP-可以创建水平选项卡组。

- AFX_MDI_CAN_MOVE_PREV-可以将选项卡移到上一个选项卡组。

- AFX_MDI_CAN_MOVE_NEXT-可以将选项卡移到下一个选项卡组。

### <a name="remarks"></a>备注

启用 MDI 选项卡式组功能后，必须知道在特定窗口的选项卡上允许哪些操作。 此方法分析选项卡式窗口的当前布局，并返回可用于生成的标志的组合，例如快捷菜单。

当所有选项卡式窗口垂直对齐时，或在只有一个选项卡式窗口时，可以创建新的垂直选项卡组。

当所有选项卡式窗口水平对齐时，或在只有一个选项卡式窗口时，可以创建新的水平选项卡组。

仅当选项卡式窗口中有多个选项卡时，才能将选项卡移到上一个组。

仅当选项卡式窗口中有多个选项卡时，才能将选项卡移到下一组。

## <a name="cmdiframewndexgetmenubar"></a><a name="getmenubar"></a>CMDIFrameWndEx：： GetMenuBar

返回一个指向附加到框架窗口的菜单栏对象的指针。

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>返回值

指向菜单栏对象的指针。

## <a name="cmdiframewndexgetpane"></a><a name="getpane"></a>CMDIFrameWndEx：： GetPane

返回一个指向具有指定控件 ID 的窗格的指针。

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>参数

*nID*<br/>
中控件 ID。

### <a name="return-value"></a>返回值

指向具有指定控件 ID 的窗格的指针（如果存在）。 否则为 NULL。

## <a name="cmdiframewndexgetribbonbar"></a><a name="getribbonbar"></a>CMDIFrameWndEx：： GetRibbonBar

检索框架的功能区栏控件。

```
CMFCRibbonBar* GetRibbonBar();
```

### <a name="return-value"></a>返回值

指向帧的[CMFCRibbonBar 类](../../mfc/reference/cmfcribbonbar-class.md)的指针。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexgettearoffbars"></a><a name="gettearoffbars"></a>CMDIFrameWndEx：： GetTearOffBars

返回一个脱离菜单列表。

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>返回值

对[CObList 类](../../mfc/reference/coblist-class.md)对象的引用，该对象包含指向 `CPane` 派生对象的指针的集合，这些对象处于脱离状态。

### <a name="remarks"></a>备注

`CMDIFrameWndEx`维护一个脱离菜单的集合。 使用此方法可检索此列表的引用。

## <a name="cmdiframewndexgettoolbarbuttontooltiptext"></a><a name="gettoolbarbuttontooltiptext"></a>CMDIFrameWndEx：： GetToolbarButtonToolTipText

当应用程序显示工具栏按钮的工具提示时由框架调用。

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>参数

*pButton*<br/>
中指向工具栏按钮的指针。

*strTTText*<br/>
中要为按钮显示的工具提示文本。

### <a name="return-value"></a>返回值

如果显示了工具提示，则为 TRUE。 否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexinsertpane"></a><a name="insertpane"></a>CMDIFrameWndEx：： InsertPane

向停靠管理器注册指定窗格。

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter=TRUE);
```

### <a name="parameters"></a>参数

*pControlBar*<br/>
中指向要插入的窗格的指针。

*pTarget*<br/>
中一个指针，指向要在其之前或之后插入窗格的窗格。

*bAfter*<br/>
中如果为 TRUE，则在*pTarget*之后插入*pControlBar* 。 如果为 FALSE，则在*pTarget*之前插入*pControlBar* 。

### <a name="return-value"></a>返回值

如果该方法成功注册了窗格，则为 TRUE; 如果该窗格已注册到停靠管理器，则为 FALSE。

### <a name="remarks"></a>备注

使用此方法将*pControlBar*指定的窗格告知停靠管理器。 停靠管理器将根据窗格的对齐方式与停靠管理器的内部列表中的位置对齐此窗格。

## <a name="cmdiframewndexisfullscreen"></a><a name="isfullscreen"></a>CMDIFrameWndEx：： IsFullScreen

确定框架窗口是否处于全屏模式。

```
BOOL IsFullScreen() const;
```

### <a name="return-value"></a>返回值

如果框架窗口处于全屏模式，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

可以通过调用[CMDIFrameWndEx：： EnableFullScreenMode](#enablefullscreenmode)方法来设置全屏模式。

## <a name="cmdiframewndexismditabbedgroup"></a><a name="ismditabbedgroup"></a>CMDIFrameWndEx：： IsMDITabbedGroup

指定是否启用 MDI 选项卡式组功能。

```
BOOL IsMDITabbedGroup() const;
```

### <a name="return-value"></a>返回值

如果已启用 MDI 选项卡式组功能，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

若要确定是否已启用常规 MDI 选项卡或 MDI 选项卡式组功能，请使用[CMDIFrameWndEx：： AreMDITabs](#aremditabs)。

## <a name="cmdiframewndexismemberofmditabgroup"></a><a name="ismemberofmditabgroup"></a>CMDIFrameWndEx：： IsMemberOfMDITabGroup

确定指定的选项卡式窗口是否处于 MDI 选项卡式组中的窗口列表中。

```
BOOL IsMemberOfMDITabGroup(CWnd* pWnd);
```

### <a name="parameters"></a>参数

*pWnd*<br/>
中指向选项卡式窗口的指针。

### <a name="return-value"></a>返回值

如果指定的选项卡式窗口位于形成 MDI 选项卡式组的选项卡式窗口列表中，则为 TRUE。 否则为 FALSE。

## <a name="cmdiframewndexismenubaravailable"></a><a name="ismenubaravailable"></a>CMDIFrameWndEx：： IsMenuBarAvailable

确定框架窗口是否包含菜单栏。

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>返回值

如果指向菜单栏对象的指针不为 NULL，则为 TRUE;否则为 FALSE。

## <a name="cmdiframewndexispointneardocksite"></a><a name="ispointneardocksite"></a>CMDIFrameWndEx：： IsPointNearDockSite

确定指定点是否在停靠站点附近。

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>参数

*情况*<br/>
中屏幕坐标中的指定点。

*dwBarAlignment*<br/>
中指定点附近的边缘。 可能的值为 CBRS_ALIGN_LEFT、CBRS_ALIGN_RIGHT、CBRS_ALIGN_TOP 和 CBRS_ALIGN_BOTTOM

*bOuterEdge*<br/>
中如果点位于停靠站点的外边框附近，则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果点在停靠站点附近，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果该点位于停靠管理器的灵敏度集中，则该点位于停靠站点附近。 默认敏感度为15像素。

## <a name="cmdiframewndexisprintpreview"></a><a name="isprintpreview"></a>CMDIFrameWndEx：： IsPrintPreview

确定框架窗口是否处于打印预览模式。

```
BOOL IsPrintPreview();
```

### <a name="return-value"></a>返回值

如果框架窗口处于打印预览模式，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexloadframe"></a><a name="loadframe"></a>CMDIFrameWndEx：： LoadFrame

从资源信息创建框架窗口。

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>参数

*nIDResource*<br/>
中与框架窗口关联的共享资源的 ID。

*dwDefaultStyle*<br/>
中框架窗口的样式。

*pParentWnd*<br/>
中指向框架的父项的指针。

*pContext*<br/>
中指向[CCreateContext 结构](../../mfc/reference/ccreatecontext-structure.md)的指针。 此参数可以为 NULL。

### <a name="return-value"></a>返回值

如果该方法成功，则为 TRUE; 否则为 FALSE。

## <a name="cmdiframewndexloadmdistate"></a><a name="loadmdistate"></a>CMDIFrameWndEx：： LoadMDIState

加载指定的 MDI 选项卡式组的布局和以前打开的文档的列表。

```
virtual BOOL LoadMDIState(LPCTSTR lpszProfileName);
```

### <a name="parameters"></a>参数

*lpszProfileName*<br/>
中指定配置文件名称。

### <a name="return-value"></a>返回值

如果加载成功，则为 TRUE;如果加载失败或没有要加载的数据，则为 FALSE。

### <a name="remarks"></a>备注

若要加载或保存 MDI 选项卡和组的状态以及打开的文档的列表，请执行以下操作：

- 在关闭主框架时调用[CMDIFrameWndEx：： SaveMDIState](#savemdistate)

- 在创建主框架时调用[CMDIFrameWndEx：： LoadMDIState](#loadmdistate) 。 此调用的建议位置在第一次显示主框架之前。 在对 `CWinAppEx::EnableLoadWindowPlacement` `(FALSE);` `pMainFrame->LoadFrame (IDR_MAINFRAME);.` `CWinAppEx::ReloadWindowPlacement` `(pMainFrame);` 的调用后添加， `LoadMDIState` 以便在注册表中存储的位置显示主帧。

- `GetDocumentName` `CMDIChildWndEx` 如果你的应用程序显示未存储为文件的文档，则在派生的类中重写。 返回的字符串将作为文档标识符保存在注册表中。 [CMDIChildWndEx：： GetDocumentName](../../mfc/reference/cmdichildwndex-class.md#getdocumentname)的基实现返回从[CDocument：： GetPathName](../../mfc/reference/cdocument-class.md#getpathname)获取的值。

- 重写[CMDIFrameWndEx：： CreateDocumentWindow](#createdocumentwindow)以在从注册表加载文档时正确创建文档。 第一个参数是返回的字符串 `GetDocumentName` 。

### <a name="example"></a>示例

下面的示例演示如何 `LoadMDIState` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#11](../../mfc/codesnippet/cpp/cmdiframewndex-class_11.cpp)]

## <a name="cmdiframewndexmditabmovetonextgroup"></a><a name="mditabmovetonextgroup"></a>CMDIFrameWndEx：： MDITabMoveToNextGroup

将活动选项卡从当前活动的选项卡式窗口移到下一个或上一个选项卡式组。

```cpp
void MDITabMoveToNextGroup(BOOL bNext=TRUE);
```

### <a name="parameters"></a>参数

*bNext*<br/>
中如果为 TRUE，则将选项卡移到下一个选项卡式组。 如果为 FALSE，则将其移到上一个选项卡式组。

## <a name="cmdiframewndexmditabnewgroup"></a><a name="mditabnewgroup"></a>CMDIFrameWndEx：： MDITabNewGroup

创建一个新的选项卡式组，其中包含一个窗口。

```cpp
void MDITabNewGroup(BOOL bVert=TRUE);
```

### <a name="parameters"></a>参数

*bVert*<br/>
中指定新的组对齐方式。 如果为 TRUE，则新组垂直对齐。 如果为 FALSE，则新组水平对齐。

### <a name="remarks"></a>备注

使用此函数创建新的选项卡式窗口（新的选项卡式组），并向其添加第一个选项卡。

### <a name="example"></a>示例

下面的示例演示如何 `MDITabNewGroup` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#12](../../mfc/codesnippet/cpp/cmdiframewndex-class_12.cpp)]

## <a name="cmdiframewndexm_bcancovertcontrolbartomdichild"></a><a name="m_bcancovertcontrolbartomdichild"></a>CMDIFrameWndEx：： m_bCanCovertControlBarToMDIChild

指定停靠窗格是否可转换为 MDI 子窗口。

```
BOOL m_bCanCovertControlBarToMDIChild;
```

### <a name="remarks"></a>备注

指示停靠控件条能否转换为 MDI 子窗口。 如果此标志为 TRUE，则当用户选择**选项卡式文档**命令时，框架会自动处理转换。 标志是受保护的，你必须通过 `m_bCanCovertControlBarToMDIChild` 在派生类的构造函数中设置 `CMDIFrameWndEx` 或重写来显式启用此选项 `CanConvertControlBarToMDIChild` 。

默认值为 `FALSE`。

### <a name="example"></a>示例

下面的示例演示如何 `m_bCanCovertControlBarToMDIChild` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="cmdiframewndexm_bdisablesetredraw"></a><a name="m_bdisablesetredraw"></a>CMDIFrameWndEx：： m_bDisableSetRedraw

启用或禁用 MDI 子窗口的重绘优化。

```
AFX_IMPORT_DATA static BOOL m_bDisableSetRedraw;
```

### <a name="remarks"></a>备注

默认值为 TRUE。

如果要优化 MDI 子级的重绘，请将此标志设置为 FALSE。 在这种情况下， `SetRedraw (FALSE)` 当应用程序更改活动选项卡时，框架将为主框架调用。

此标志可能会导致不需要的效果（例如变为可见的后台应用程序）。 因此，建议您仅在 MDI 选项卡激活过程中出现明显闪烁时才更改默认值。

## <a name="cmdiframewndexnegotiateborderspace"></a><a name="negotiateborderspace"></a>CMDIFrameWndEx：： NegotiateBorderSpace

在 OLE 就地激活过程中，在框架窗口中协商边框空间。

```
virtual BOOL NegotiateBorderSpace(
    UINT nBorderCmd,
    LPRECT lpRectBorder);
```

### <a name="parameters"></a>参数

*nBorderCmd*<br/>
中包含枚举中的以下值之一 `CFrameWnd::BorderCmd` ：

- `borderGet` = 1

- `borderRequest` = 2

- `borderSet` = 3

*lpRectBorder*<br/>
[in，out]指向[RECT 结构](/windows/win32/api/windef/ns-windef-rect)或[CRect 类](../../atl-mfc-shared/reference/crect-class.md)对象的指针，该对象指定边框的坐标。

### <a name="return-value"></a>返回值

如果方法成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

此方法是 OLE 边框空间协商的实现。

## <a name="cmdiframewndexonclosedockingpane"></a><a name="onclosedockingpane"></a>CMDIFrameWndEx：： OnCloseDockingPane

当用户单击可停靠窗格上的 "**关闭**" 按钮时，由框架调用。

```
virtual BOOL OnCloseDockingPane(CDockablePane* pWnd);
```

### <a name="parameters"></a>参数

*pWnd*<br/>
中指向正在关闭的窗格的指针。

### <a name="return-value"></a>返回值

如果可以关闭停靠窗格，则为 TRUE。 否则为 FALSE。

### <a name="remarks"></a>备注

重写此方法以处理隐藏停靠窗格。 如果要阻止隐藏停靠窗格，则返回 FALSE。

默认实现不执行任何操作并返回 TRUE。

## <a name="cmdiframewndexoncloseminiframe"></a><a name="oncloseminiframe"></a>CMDIFrameWndEx：： OnCloseMiniFrame

当用户在浮动袖珍框架窗口上单击 "**关闭**" 按钮时，由框架调用。

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### <a name="parameters"></a>参数

*pWnd*<br/>
中指向待关闭袖珍框架窗口的指针。

### <a name="return-value"></a>返回值

如果可以关闭浮动袖珍框架窗口，则为 TRUE。 否则为 FALSE。

### <a name="remarks"></a>备注

重写此方法以处理浮动袖珍框架窗口的隐藏。 如果要阻止隐藏浮动袖珍框架窗口，则返回 FALSE。

默认实现不执行任何操作并返回 TRUE。

## <a name="cmdiframewndexonclosepopupmenu"></a><a name="onclosepopupmenu"></a>CMDIFrameWndEx：： OnClosePopupMenu

当活动的弹出菜单处理 WM_DESTROY 消息时由框架调用。

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>参数

*pMenuPopup*<br/>
中指向弹出菜单的指针。

### <a name="remarks"></a>备注

如果要处理[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象中的通知（当这些对象处理 WM_DESTROY 消息时），请重写此方法。

## <a name="cmdiframewndexoncmdmsg"></a><a name="oncmdmsg"></a>CMDIFrameWndEx：： OnCmdMsg

由框架调用以路由和调度命令消息，并更新命令用户界面对象。

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>参数

*nID*<br/>
中命令 ID。

*nCode*<br/>
中标识命令通知代码。 有关*nCode*的值的详细信息，请参阅[CCmdTarget：： OnCmdMsg](../../mfc/reference/ccmdtarget-class.md#oncmdmsg) 。

*pExtra*<br/>
中根据*nCode*的值使用。 有关*pExtra*的详细信息，请参阅[CCmdTarget：： OnCmdMsg](../../mfc/reference/ccmdtarget-class.md#oncmdmsg) 。

*pHandlerInfo*<br/>
[in，out]通常，此参数应为 NULL。如果不为 NULL，则 `OnCmdMsg` 填充 `pTarget` `pmf` *pHandlerInfo*结构的和成员，而不是分派命令。

### <a name="return-value"></a>返回值

如果处理消息，则为非零值;否则为0。

## <a name="cmdiframewndexondrawmenuimage"></a><a name="ondrawmenuimage"></a>CMDIFrameWndEx：： OnDrawMenuImage

当绘制与菜单项关联的图像时由框架调用。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>参数

*pDC*<br/>
中指向设备上下文的指针。

*pMenuButton*<br/>
中指向菜单按钮的指针。

*rectImage*<br/>
中图像的边框。

### <a name="return-value"></a>返回值

如果方法绘制图像，则为 TRUE。 默认实现返回 FALSE。

### <a name="remarks"></a>备注

如果要为属于由派生对象拥有的菜单栏的菜单项自定义图像呈现，请重写此方法 `CMDIFrameWndEx` 。 默认实现不执行任何操作。

## <a name="cmdiframewndexondrawmenulogo"></a><a name="ondrawmenulogo"></a>CMDIFrameWndEx：： OnDrawMenuLogo

当[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)处理 WM_PAINT 消息时由框架调用。

```
virtual void OnDrawMenuLogo(
    CDC*,
    CMFCPopupMenu*,
    const CRect&);
```

### <a name="remarks"></a>备注

重写此函数可在属于由派生的对象所拥有的菜单栏的弹出菜单上显示徽标 `CMDIFrameWndEx` 。 默认实现不执行任何操作。

## <a name="cmdiframewndexonerasemdiclientbackground"></a><a name="onerasemdiclientbackground"></a>CMDIFrameWndEx：： OnEraseMDIClientBackground

当 MDI 框架窗口处理 WM_ERASEBKGND 消息时由框架调用。

```
virtual BOOL OnEraseMDIClientBackground(CDC*);
```

### <a name="return-value"></a>返回值

如果应用程序处理消息并清除背景，则为 TRUE。

### <a name="remarks"></a>备注

如果要处理派生类中的 WM_ERASEBKGND 消息，请重写此成员函数 `CMDIFrameWndEx` 。

## <a name="cmdiframewndexonmenubuttontoolhittest"></a><a name="onmenubuttontoolhittest"></a>CMDIFrameWndEx：： OnMenuButtonToolHitTest

当[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)对象处理 WM_NCHITTEST 消息时由框架调用。

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>参数

*pButton*<br/>
中工具栏按钮。

*pTI*<br/>
弄指向[TOOLINFO](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)结构的指针。

### <a name="return-value"></a>返回值

如果应用程序填充*pTI*参数，则为 TRUE。 默认实现返回 FALSE。

### <a name="remarks"></a>备注

如果要将特定菜单项的相关信息提供给工具提示，请重写此方法。 默认实现不执行任何操作。

## <a name="cmdiframewndexonmoveminiframe"></a><a name="onmoveminiframe"></a>CMDIFrameWndEx：： OnMoveMiniFrame

由框架调用以移动微型框架窗口。

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>参数

*pFrame*<br/>
中指向袖珍框架窗口的指针。

### <a name="return-value"></a>返回值

如果该方法成功，则为 TRUE; 否则为 FALSE。

## <a name="cmdiframewndexonsetpreviewmode"></a><a name="onsetpreviewmode"></a>CMDIFrameWndEx：： OnSetPreviewMode

设置应用程序的主框架窗口打印预览模式。

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>参数

*bPreview*<br/>
中如果为 TRUE，则设置打印预览模式。 如果为 FALSE，则取消预览模式。

*pState*<br/>
中指向结构的指针 `CPrintPreviewState` 。

### <a name="remarks"></a>备注

此方法将重写[CFrameWnd：： OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。

## <a name="cmdiframewndexonshowcustomizepane"></a><a name="onshowcustomizepane"></a>CMDIFrameWndEx：： OnShowCustomizePane

当激活快速自定义窗格时由框架调用。

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>参数

*pMenuPane*<br/>
中指向 "快速自定义" 窗格的指针。

*uiToolbarID*<br/>
中要自定义的工具栏的控件 ID。

### <a name="return-value"></a>返回值

此方法始终返回 TRUE。

### <a name="remarks"></a>备注

"快速自定义" 窗格是用户单击工具栏上的 "**自定义**" 时打开的菜单。

在派生类中重写此方法，以在 "快速自定义" 窗格中进行更改。

## <a name="cmdiframewndexonshowmditabcontextmenu"></a><a name="onshowmditabcontextmenu"></a>CMDIFrameWndEx：： OnShowMDITabContextMenu

在快捷菜单显示在某个选项卡上之前由框架调用。 仅对 MDI 选项卡式组有效。

```
virtual BOOL OnShowMDITabContextMenu(
    CPoint point,
    DWORD dwAllowedItems,
    BOOL bTabDrop);
```

### <a name="parameters"></a>参数

*情况*<br/>
中菜单在屏幕坐标中的位置。

*dwAllowedItems*<br/>
中标志的按位 "或" 组合，用于指示当前选项卡允许哪些操作：

- AFX_MDI_CREATE_VERT_GROUP-可以创建垂直选项卡组。

- AFX_MDI_CREATE_HORZ_GROUP-可以创建水平选项卡组。

- AFX_MDI_CAN_MOVE_PREV-可以将选项卡移到上一个选项卡组。

- AFX_MDI_CAN_MOVE_NEXT-可以将选项卡移到下一个选项卡组。

- AFX_MDI_CAN_BE_DOCKED 将选项卡式文档切换为固定状态（仅适用于选项卡式文档）。

*bTabDrop*<br/>
中如果为 TRUE，则在将选项卡拖动到另一个选项卡式组上时显示菜单。 若为 FALSE，则将菜单显示为当前处于活动状态的选项卡上的快捷菜单。

### <a name="return-value"></a>返回值

在[CMDIFrameWndEx](../../mfc/reference/cmdiframewndex-class.md)派生的类中重写此方法。

### <a name="remarks"></a>备注

如果不进行处理 `OnShowMDITabContextMenu` ，将不会显示快捷菜单。 当启用 MDI 选项卡式组功能时， **MFC 应用程序向导**将生成此函数。

### <a name="example"></a>示例

下面的示例演示如何 `OnShowMDITabContextMenu` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#14](../../mfc/codesnippet/cpp/cmdiframewndex-class_13.cpp)]

## <a name="cmdiframewndexonshowpanes"></a><a name="onshowpanes"></a>CMDIFrameWndEx：： OnShowPanes

由框架调用以显示或隐藏窗格。

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>参数

*bShow*<br/>
中若要显示窗格，则为 TRUE，隐藏窗格。

### <a name="return-value"></a>返回值

如果调用此方法时窗格的状态发生更改，则为 TRUE; 如果窗格已经处于*bShow*指定的状态，则为 FALSE。 例如，如果窗格隐藏并且*bShow*为 false，则返回值为 false。

### <a name="remarks"></a>备注

默认实现将工具栏从顶级框架窗口中删除。

如果[CDockingManager：： m_bHideDockingBarsInContainerMode](../../mfc/reference/cdockingmanager-class.md#m_bhidedockingbarsincontainermode)为 TRUE （默认值），则所有停靠窗格都将隐藏。

## <a name="cmdiframewndexonshowpopupmenu"></a><a name="onshowpopupmenu"></a>CMDIFrameWndEx：： OnShowPopupMenu

当框架打开弹出菜单时由框架调用。

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu*);
```

### <a name="return-value"></a>返回值

如果要显示弹出菜单，则为 TRUE。 否则为 FALSE。 默认实现返回 TRUE。

### <a name="remarks"></a>备注

如果要在弹出菜单激活时实现特殊处理，请重写此方法。 例如，如果您想要将普通菜单项更改为彩色菜单按钮，请设置撕块等。

默认实现不执行任何操作。

## <a name="cmdiframewndexonsizemdiclient"></a><a name="onsizemdiclient"></a>CMDIFrameWndEx：： OnSizeMDIClient

当客户端 MDI 窗口的大小正在更改时由框架调用。

```
virtual void OnSizeMDIClient(
    const CRect& rectOld,
    const CRect& rectNew);
```

### <a name="parameters"></a>参数

*rectOld*<br/>
中MDI 客户端窗口的当前大小。

*rectNew*<br/>
中MDI 客户端窗口的新大小。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexontearoffmenu"></a><a name="ontearoffmenu"></a>CMDIFrameWndEx：： OnTearOffMenu

当激活带有拖曳栏的菜单时由框架调用。

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>参数

*pMenuPopup*<br/>
中指向弹出菜单的指针。

*pBar*<br/>
中指向被撕条的指针。

### <a name="return-value"></a>返回值

如果为 TRUE，则允许弹出菜单中包含可激活的栏;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

如果要为被撕条实现特殊设置，请重写此函数。 默认实现不执行任何操作。

## <a name="cmdiframewndexonupdateframemenu"></a><a name="onupdateframemenu"></a>CMDIFrameWndEx：： OnUpdateFrameMenu

由框架调用以更新框架菜单。

```
virtual void OnUpdateFrameMenu(HMENU hMenuAlt);
```

### <a name="parameters"></a>参数

*hMenuAlt*<br/>
中菜单的句柄。

## <a name="cmdiframewndexpanefrompoint"></a><a name="panefrompoint"></a>CMDIFrameWndEx：:P aneFromPoint

返回包含指定点的停靠窗格。

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>参数

*情况*<br/>
中点（以屏幕坐标表示）。

*nSensitivity*<br/>
中每个选中窗格的窗口矩形都按此值在所有方向放大。

*bExactBar*<br/>
中如果为 TRUE，则忽略*nSensitivity*参数。

*pRTCBarType*<br/>
中如果非 NULL，则方法只循环访问指定类型的窗格。

*dwAlignment*<br/>
弄如果找到了窗格，此参数将指定窗格的哪一侧靠近指定的点。

### <a name="return-value"></a>返回值

指向停靠窗格的指针; 如果没有控件包含*point*指定的点，则为 NULL。

### <a name="remarks"></a>备注

调用将重定向到[CDockingManager 类](../../mfc/reference/cdockingmanager-class.md)。 有关详细信息，请参阅[CDockingManager：： ControlBarFromPoint](../../mfc/reference/cdockingmanager-class.md#panefrompoint) 。

## <a name="cmdiframewndexrecalclayout"></a><a name="recalclayout"></a>CMDIFrameWndEx：： RecalcLayout

由框架调用以重新计算框架窗口的布局。

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>参数

*bNotify*<br/>
中确定框架窗口的活动就地项是否收到布局更改的通知。 如果为 TRUE，则通知该项;否则为 FALSE。

### <a name="remarks"></a>备注

此方法将重写[CFrameWnd：： RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。

## <a name="cmdiframewndexremovepanefromdockmanager"></a><a name="removepanefromdockmanager"></a>CMDIFrameWndEx：： RemovePaneFromDockManager

取消注册窗格，并将其从停靠管理器中删除。

```cpp
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>参数

*pControlBar*<br/>
中指向要删除的窗格的指针。

*bDestroy*<br/>
中若要销毁删除的窗格，则为 TRUE。 如果不销毁，则为 FALSE。

*bAdjustLayout*<br/>
中若要立即调整停靠布局，则为 TRUE。 如果为 FALSE，则只会在由于其他原因而发生重绘事件时（用户调整窗口的大小、拖动主框架等）进行调整。

*bAutoHide*<br/>
中若要从自动隐藏窗格的列表中删除窗格，则为 TRUE。 若要从常规窗格列表中删除该窗格，则为 FALSE。

*pBarReplacement*<br/>
中指向替换已删除窗格的窗格的指针。

### <a name="remarks"></a>备注

必须将每个窗格注册到停靠管理器，才能参与停靠布局。 使用[CMDIFrameWndEx：： AddPane](#addpane)或[CMDIFrameWndEx：： InsertPane](#insertpane)注册窗格。

当窗格不再是框架窗口的停靠布局的一部分时，可使用此方法。

## <a name="cmdiframewndexsavemdistate"></a><a name="savemdistate"></a>CMDIFrameWndEx：： SaveMDIState

保存 MDI 选项卡式组的当前布局和以前打开的文档的列表。

```
virtual BOOL SaveMDIState(LPCTSTR lpszProfileName);
```

### <a name="parameters"></a>参数

*lpszProfileName*<br/>
中指定配置文件名称。

### <a name="return-value"></a>返回值

如果保存成功，则为 TRUE;如果保存失败，则为 FALSE。

### <a name="remarks"></a>备注

若要加载或保存 MDI 选项卡和组的状态以及打开的文档的列表，请执行以下操作：

- 在 `SaveMDIState` 关闭主框架时调用

- 在创建主框架时调用[CMDIFrameWndEx：： LoadMDIState](#loadmdistate) 。 此调用的建议位置在第一次显示主框架之前。

- `CWinAppEx::EnableLoadWindowPlacement(FALSE);`之前调用`pMainFrame->LoadFrame (IDR_MAINFRAME);`

- 在 `CWinAppEx::ReloadWindowPlacement(pMainFrame)` 之后调用 `LoadMDIState` ，以在注册表中存储的位置显示主帧。

- `GetDocumentName` `CMDIChildWndEx` 如果你的应用程序显示未存储为文件的文档，则在派生的类中重写。 返回的字符串将作为文档标识符保存在注册表中。 有关详细信息，请参阅[CMDIChildWndEx：： GetDocumentName](../../mfc/reference/cmdichildwndex-class.md#getdocumentname)。

- 重写[CMDIFrameWndEx：： CreateDocumentWindow](#createdocumentwindow)以在从注册表加载文档时正确创建文档。 的参数为 `CreateDocumentWindow` 之前返回的字符串 `GetDocumentName` 。

### <a name="example"></a>示例

下面的示例演示如何 `SaveMDIState` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#15](../../mfc/codesnippet/cpp/cmdiframewndex-class_14.cpp)]

## <a name="cmdiframewndexsetprintpreviewframe"></a><a name="setprintpreviewframe"></a>CMDIFrameWndEx：： SetPrintPreviewFrame

设置打印预览框架窗口。

```cpp
void SetPrintPreviewFrame(CFrameWnd* pWnd);
```

### <a name="parameters"></a>参数

*pWnd*<br/>
中指向打印预览框架窗口的指针。

### <a name="remarks"></a>备注

## <a name="cmdiframewndexsetuptoolbarmenu"></a><a name="setuptoolbarmenu"></a>CMDIFrameWndEx：： SetupToolbarMenu

通过使用用户定义的项替换虚拟项来修改工具栏对象。

```cpp
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>参数

*下拉菜单*<br/>
中对要修改的[CMenu 类](../../mfc/reference/cmenu-class.md)对象的引用。

*uiViewUserToolbarCmdFirst*<br/>
中指定第一个用户定义的命令。

*uiViewUserToolbarCmdLast*<br/>
中指定最后一个用户定义的命令。

## <a name="cmdiframewndexshowfullscreen"></a><a name="showfullscreen"></a>CMDIFrameWndEx：： ShowFullScreen

将主框架从常规模式切换到全屏模式。

```cpp
void ShowFullScreen();
```

### <a name="remarks"></a>备注

## <a name="cmdiframewndexshowpane"></a><a name="showpane"></a>CMDIFrameWndEx：： ShowPane

显示或隐藏指定窗格。

```cpp
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>参数

*pBar*<br/>
中指向要显示或隐藏的窗格的指针。

*bShow*<br/>
中若要显示窗格，则为 TRUE。 若要隐藏窗格，则为 FALSE。

*bDelay*<br/>
中如果为 TRUE，则延迟停靠布局的重新计算。 若要立即重新计算停靠布局，则为 FALSE。

*bActivate*<br/>
中如果显示窗格应为活动状态，则为 TRUE。 若为 FALSE，则将窗格显示为非活动状态。

### <a name="remarks"></a>备注

调用此方法以显示或隐藏窗格。 请勿用于 `ShowWindow` 停靠窗格。

### <a name="example"></a>示例

下面的示例演示如何 `ShowPane` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#16](../../mfc/codesnippet/cpp/cmdiframewndex-class_15.cpp)]

## <a name="cmdiframewndexshowwindowsdialog"></a><a name="showwindowsdialog"></a>CMDIFrameWndEx：： ShowWindowsDialog

创建[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)框并将其打开。

```cpp
void ShowWindowsDialog();
```

### <a name="example"></a>示例

下面的示例演示如何 `ShowWindowsDialog` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#18](../../mfc/codesnippet/cpp/cmdiframewndex-class_16.cpp)]

## <a name="cmdiframewndextabbeddocumenttocontrolbar"></a><a name="tabbeddocumenttocontrolbar"></a>CMDIFrameWndEx：： TabbedDocumentToControlBar

将指定的选项卡式文档转换为停靠窗格。

```
virtual BOOL TabbedDocumentToControlBar(CMDIChildWndEx* pMDIChildWnd);
```

### <a name="parameters"></a>参数

*pMDIChildWnd*<br/>
指向包含停靠窗格的 MDI 子窗口的指针。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE; 否则为 FALSE。

### <a name="remarks"></a>备注

使用此方法可将选项卡式文档转换为停靠窗格。 必须使用[CMDIFrameWndEx：： ControlBarToTabbedDocument](#controlbartotabbeddocument)创建选项卡式文档。

### <a name="example"></a>示例

下面的示例演示如何 `TabbedDocumentToControlBar` 在[VisualStudioDemo 示例中使用 MFC Visual Studio 应用程序](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#19](../../mfc/codesnippet/cpp/cmdiframewndex-class_17.cpp)]

## <a name="cmdiframewndexupdatecaption"></a><a name="updatecaption"></a>CMDIFrameWndEx：： UpdateCaption

由框架调用以更新窗口框架标题。

```cpp
void UpdateCaption();
```

### <a name="remarks"></a>备注

## <a name="cmdiframewndexupdatemditabbedbarsicons"></a><a name="updatemditabbedbarsicons"></a>CMDIFrameWndEx：： UpdateMDITabbedBarsIcons

为每个 MDI 选项卡式窗格设置图标。

```cpp
void UpdateMDITabbedBarsIcons();
```

## <a name="cmdiframewndexwinhelp"></a><a name="winhelp"></a>CMDIFrameWndEx：： WinHelp

由框架调用以启动 WinHelp 应用程序或上下文帮助。

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>参数

*dwData*<br/>
中根据*nCmd*指定的帮助类型的要求指定数据。

*nCmd*<br/>
中指定请求的帮助的类型。 有关可能值的列表以及这些值如何影响*dwData*参数，请参阅 Windows SDK 中的[WinHelp 函数](/windows/win32/api/winuser/nf-winuser-winhelpw)。

### <a name="remarks"></a>备注

此方法重写 [CWnd::WinHelp](../../mfc/reference/cwnd-class.md#winhelp)。

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMDIFrameWnd](../../mfc/reference/cframewnd-class.md)<br/>
[CMDIChildWndEx 类](../../mfc/reference/cmdichildwndex-class.md)
