---
title: 演练：使用 MFC 创建功能区应用程序
ms.date: 09/09/2019
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: 41084a78287521610ba400deab32d1052c9217c1
ms.sourcegitcommit: 3caf5261b3ea80d9cf14038c116ba981d655cd13
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/11/2019
ms.locfileid: "70907397"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>演练：使用 MFC 创建功能区应用程序

此演练演示如何使用**MFC 应用程序向导**创建默认情况下具有功能区的应用程序。 然后，你可以通过添加具有 **"收藏夹**" 功能区的**自定义**功能区类别来展开功能区，然后在面板中添加一些经常使用的命令。

## <a name="prerequisites"></a>系统必备

本演练假定您已将 Visual Studio 设置为使用 "**常规开发设置**"。 如果使用的是其他设置，则可能不会显示以下说明中引用的某些用户界面（UI）元素。

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>创建带功能区的 MFC 应用程序

1. 使用**Mfc 应用程序向导**创建具有功能区的 mfc 应用程序。 请参阅[演练：使用新的 MFC Shell 控件](walkthrough-using-the-new-mfc-shell-controls.md)获取有关如何为你的 Visual Studio 版本打开向导的说明。

1. 在**MFC 应用程序向导**中设置以下选项：

    1. 在 "**应用程序类型**" 部分的 "**视觉样式和颜色**" 下，选择**Office 2007 （蓝色主题）** 。

    1. 在 "**复合文档支持**" 部分中，确保选择 "**无**"。

    1. 在 "**文档模板属性**" 部分的 "**文件扩展名**" 框中，键入此应用程序创建的文档的文件扩展名，例如*mfcrbnapp*。

    1. 在 "**数据库支持**" 部分（仅限 Visual Studio 2015）中，确保选择 "**无**"。

    1. 在 "**用户界面功能**" 部分中，确保选中 "**使用功能区**"。

    1. 默认情况下， **MFC 应用程序向导**添加了对多个停靠窗格的支持。 由于本演练仅介绍功能区，因此您可以从应用程序中删除这些选项。 在 "**高级功能**" 部分中，清除所有选项。

1. 单击 "**完成**" 创建 MFC 应用程序。

1. 若要验证应用程序是否已成功创建，请生成并运行它。 若要生成应用程序，请在 "**生成**" 菜单上单击 "**生成解决方案**"。 如果应用程序成功生成，则通过单击 "**调试**" 菜单上的 "**启动调试**" 来运行该应用程序。

    向导将自动创建一个功能区，其中包含一个名为**Home**的功能区类别。 此功能区包含三个功能区面板，分别为 "**剪贴板**"、"**视图**" 和 "**窗口**"。

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>将类别和面板添加到功能区

1. 若要打开向导创建的功能区资源，请在 "**视图**" 菜单上，指向 "**其他窗口**"，然后单击 "**资源视图**"。 在**资源视图**中，单击 "**功能区**"，然后双击 " **IDR_RIBBON**"。

1. 首先，通过双击工具箱中的 **"** **类别**" 向功能区添加一个自定义类别。

    创建了标题为**Category1**的类别。 默认情况下，该类别包含一个面板。

    右键单击 " **Category1** "，然后单击 "**属性**"。 在 "**属性**" 窗口中，将**标题**更改为 "*自定义*"。

    "**大型图像**" 和 "**小型图像**" 属性指定用作此类别中功能区元素的图标的位图。 由于创建自定义位图超出了本演练的范围，请重新使用该向导创建的位图。 小型位图为 16 x 16 像素。 对于小图像，请使用`IDB_FILESMALL`资源 ID 访问的位图。 大型位图为 32 x 32 像素。 对于较大的图像，请使用`IDB_FILELARGE`资源 ID 访问的位图。

    > [!NOTE]
    > 在每英寸像素数 (HDPI) 显示中，将自动使用图像的 HDPI 版本。

1. 接下来，自定义面板。 面板用于对逻辑上相关的项进行分组。 例如，在此应用程序的 "**主页**" 选项卡上，"**剪切**"、"**复制**" 和 "**粘贴**" 命令都位于**剪贴板**面板上。 若要自定义面板，请右键单击 " **Panel1** "，然后单击 "**属性**"。 在 "**属性**" 窗口中，将 *"* **标题**" 更改为收藏夹。

    您可以为面板指定**图像索引**。 此数字指定将功能区面板添加到**快速访问工具栏**时显示的图标。 此图标不会显示在功能区面板上。

1. 若要验证功能区类别和面板是否已成功创建，请预览此功能区控件。 在**功能区编辑器工具栏**上，单击 "**测试功能区**" 按钮。 功能区上应显示**自定义**选项卡和**收藏夹**面板。

### <a name="to-add-elements-to-the-ribbon-panels"></a>将元素添加到功能区面板

1. 若要将元素添加到在上一过程中创建的面板，请将控件从**工具箱**的 "**功能区编辑器**" 部分拖到 "设计" 视图中的面板。

1. 首先，添加 "**打印**" 按钮。 "**打印**" 按钮将包含一个子菜单，其中包含通过使用默认打印机打印的 "**快速打印**" 命令。 已为此应用程序定义所有这些命令。 它们位于 "应用程序" 菜单上。

    若要创建 "**打印**" 按钮，请将按钮工具拖到面板上。

    在 "**属性**" 窗口中，将 " **ID** " 属性更改为**ID_FILE_PRINT**，该属性应该已经定义。 将**标题**更改为*打印*。 将**图像索引**改为*4*。

    若要创建 "**快速打印**" 按钮，请单击 "**菜单项**" 旁边的 "属性值" 列，然后单击省略号（ **...** ）。在**项目编辑器**中，单击未标记的 "**添加**" 按钮创建菜单项。 在 "**属性**" 窗口中，将 "**标题**" 更改为 "*快速打印*"，将**ID**更改为*ID_FILE_PRINT_DIRECT*，将**图像**更改为*5* Image 属性指定`IDB_FILESMALL`位图资源中的 "**快速打印**" 图标。

1. 若要验证是否已将这些按钮添加到功能区面板，请生成并运行应用程序。 若要生成应用程序，请在 "**生成**" 菜单上单击 "**生成解决方案**"。 如果应用程序成功生成，则通过单击 "**调试**" 菜单上的 "**启动调试**" 来运行该应用程序。 应显示功能区上的 "**自定义**" 选项卡上的 "**收藏夹**" 面板上的 "**打印**" 按钮和组合框。

## <a name="next-steps"></a>后续步骤

[如何：自定义快速访问工具栏](../mfc/how-to-customize-the-quick-access-toolbar.md)

[如何：自定义应用程序按钮](../mfc/how-to-customize-the-application-button.md)

有关端到端示例，请参阅[示例（MFC 功能包）](../overview/visual-cpp-samples.md)。

## <a name="see-also"></a>请参阅

[演练](../mfc/walkthroughs-mfc.md)<br/>
[示例（MFC 功能包）](../overview/visual-cpp-samples.md)
