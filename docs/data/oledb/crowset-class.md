---
title: CRowset 类 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: reference
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAll
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
dev_langs:
- C++
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: d65f9c7c796724a77935693690ac73357867dab0
ms.sourcegitcommit: b217daee32d3413cf33753d9b4dc35a0022b1bfa
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/24/2018
ms.locfileid: "39233511"
---
# <a name="crowset-class"></a>CRowset 类
封装 OLE DB 行集对象和多个相关接口，并提供行集数据的操作方法。  
  
## <a name="syntax"></a>语法

```cpp
template <class TAccessor = CAccessorBase>  
class CRowset  
```  
  
#### <a name="parameters"></a>参数  
 *TAccessor*  
 一个访问器类。 默认值为 `CAccessorBase`。  
  
## <a name="requirements"></a>要求  
 **标头:** atldbcli.h  

## <a name="members"></a>成员  
  
### <a name="methods"></a>方法  
  
|||  
|-|-|  
|[AddRefRows](#addrefrows)|递增与当前行相关联的引用计数。|  
|[关闭](#close)|释放行和当前`IRowset`接口。|  
|[Compare](#compare)|比较两个创建一个书签，使用[IRowsetLocate::Compare](https://msdn.microsoft.com/library/ms709539.aspx)。|  
|[CRowset](#crowset)|创建一个新`CRowset`对象，并 （可选） 将其与`IRowset`作为参数提供的接口。|  
|[删除](#delete)|从行集使用删除的行[IRowsetChange:DeleteRows](https://msdn.microsoft.com/library/ms724362.aspx)。|  
|[FindNextRow](#findnextrow)|后指定的书签查找下一个匹配行。|  
|[GetApproximatePosition](#getapproximateposition)|返回对应于一个书签的行的近似位置。|  
|[GetData](#getdata)|从行的行集的副本检索数据。|  
|[GetDataHere](#getdatahere)|从指定的缓冲区中检索数据。|  
|[GetOriginalData](#getoriginaldata)|检索最近从提取或传输到数据源，忽略挂起的更改的数据。|  
|[GetRowStatus](#getrowstatus)|返回的所有行的状态。|  
|[插入](#insert)|创建并将插入新行使用[IRowsetChange:InsertRow](https://msdn.microsoft.com/library/ms716921.aspx)。|  
|[IsSameRow](#issamerow)|将指定的行与当前行进行比较。|  
|[MoveFirst](#movefirst)|将下一步提取位置重新定位到的初始位置。|  
|[MoveLast](#movelast)|将移动到最后一个记录。|  
|[MoveNext](#movenext)|从下一步的连续行或指定的数目的下一行之外的位置提取数据。|  
|[MovePrev](#moveprev)|移动到上一条记录。|  
|[MoveToBookmark](#movetobookmark)|从该书签提取用书签标记的行或指定的偏移量处的行。|  
|[MoveToRatio](#movetoratio)|提取从行集中的小数位置开始的行。|  
|[ReleaseRows](#releaserows)|调用[irowset:: Releaserows](https://msdn.microsoft.com/library/ms719771.aspx)释放当前的行句柄。|  
|[SetData](#setdata)|设置行使用的一个或多个列中数据值[IRowsetChange:SetData](https://msdn.microsoft.com/library/ms721232.aspx)。|  
|[撤消](#undo)|撤消自上次提取的行所做任何更改或[更新](../../data/oledb/crowset-update.md)。|  
|[更新](#update)|传输所有挂起的自上次提取或更新后对当前行所做的更改。|  
|[UpdateAll](#updateall)|将任何挂起的更改自上次提取或更新后对所有行进行传输。|  
  
## <a name="remarks"></a>备注  
 在 OLE DB 行集是通过该程序设置和检索数据的对象。  
  
 此类不是为了进行实例化传递，但作为模板参数`CTable`或`CCommand`(`CRowset`是默认值)。  

## <a name="addrefrows"></a> Crowset:: Addrefrows
调用[irowset:: Addrefrows](https://msdn.microsoft.com/library/ms719619.aspx)增加 （1) 的引用计数与相关联的当前行句柄。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT AddRefRows() throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法递增当前行句柄的引用计数。 调用[ReleaseRows](../../data/oledb/crowset-releaserows.md)要递减计数。 移动方法返回的行具有引用计数之一。  

## <a name="close"></a> Crowset:: Close
释放行和当前[IRowset](https://msdn.microsoft.com/library/ms720986.aspx)接口。  
  
### <a name="syntax"></a>语法  
  
```cpp
void Close() throw();  
  
```  
  
### <a name="remarks"></a>备注  
 此方法释放行集合中当前包含的所有行。  

## <a name="compare"></a> Crowset:: Compare
比较两个创建一个书签，使用[IRowsetLocate::Compare](https://msdn.microsoft.com/library/ms709539.aspx)。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,   
   const CBookmarkBase& bookmark2,   
   DBCOMPARE* pComparison) const throw();  
```  
  
#### <a name="parameters"></a>参数  
 *Bookmark1*  
 [in]要比较的第一个书签。  
  
 *Bookmark2*  
 [in]要比较的第二个书签。  
  
 *pComparison*  
 [out]指向比较的结果的指针。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetLocate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetLocate`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
 有关在使用者中使用书签的信息，请参阅[使用书签](../../data/oledb/using-bookmarks.md)。  

## <a name="crowset"></a> Crowset:: Crowset
创建一个新`CRowset`对象，并 （可选） 将其与[IRowset](https://msdn.microsoft.com/library/ms720986.aspx)作为参数提供的接口。  
  
### <a name="syntax"></a>语法  
  
```cpp
      CRowset();   

CRowset(IRowset* pRowset);  
```  
  
#### <a name="parameters"></a>参数  
 *pRowset*  
 [in] 指向将与此类关联的 `IRowset` 接口的指针。  

## <a name="delete"></a> Crowset:: Delete
调用[IRowsetChange::DeleteRows](https://msdn.microsoft.com/library/ms724362.aspx)从行集中删除当前行。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT Delete() const throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  

## <a name="findnextrow"></a> Crowset:: Findnextrow
后指定的书签查找下一个匹配行。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT FindNextRow(DBCOMPAREOP op,   
  BYTE* pData,   
   DBTYPE wType,   
   DBLENGTH nLength,   
   BYTE bPrecision,   
   BYTE bScale,   
   BOOL bSkipCurrent = TRUE,   
   CBookmarkBase* pBookmark = NULL) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *操作*  
 [in]要在比较行值中使用的操作。 值，请参阅[irowsetfind:: Findnextrow](https://msdn.microsoft.com/library/ms723091.aspx)。  
  
 *pData*  
 [in]指向要匹配的值的指针。  
  
 *wType*  
 [in]指示数据类型的缓冲区的值部分。 有关类型指示符的信息，请参阅[数据类型](https://msdn.microsoft.com/library/ms723969.aspx)中*OLE DB 程序员参考*Windows SDK 中。  
  
 *nLength*  
 [in]使用者数据结构分配数据值的长度 （字节）。 有关详细信息，请参阅的说明`cbMaxLen`中[DBBINDING 结构](https://msdn.microsoft.com/library/ms716845.aspx)中*OLE DB 程序员参考。*  
  
 *bPrecision*  
 [in]使用获取数据时的最大精度。 使用仅当*wType*是 DBTYPE_NUMERIC。 有关详细信息，请参阅[转换涉及 DBTYPE_NUMERIC 或 DBTYPE_DECIMAL](https://msdn.microsoft.com/library/ms719714.aspx)中*OLE DB 程序员参考*。  
  
 *bScale*  
 [in]获取数据时，使用小数位数。 使用仅当*wType* DBTYPE_NUMERIC 或 DBTYPE_DECIMAL。 有关详细信息，请参阅[转换涉及 DBTYPE_NUMERIC 或 DBTYPE_DECIMAL](https://msdn.microsoft.com/library/ms719714.aspx)中*OLE DB 程序员参考*。  
  
 *bSkipCurrent*  
 [in]从其开始搜索的书签的行数。  
  
 *pBookmark*  
 [in]要启动的搜索位置的书签。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetFind`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetFind`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
 有关在使用者中使用书签的信息，请参阅[使用书签](../../data/oledb/using-bookmarks.md)。  

## <a name="getapproximateposition"></a> Crowset:: Getapproximateposition
返回对应于一个书签的行的近似位置。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,   
   DBCOUNTITEM* pPosition,   
   DBCOUNTITEM* pcRows) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *pBookmark*  
 [in]指向一个书签，用于标识其位置是要查找的行的指针。 如果只是必需的行计数，则为 NULL。  
  
 *pPosition*  
 [out]指向位置的指针位置`GetApproximatePosition`返回的行的位置。 如果位置不需要为 NULL。  
  
 *pcRows*  
 [out]指向位置的指针位置`GetApproximatePosition`返回的总行数。 如果不需要的行计数，则为 NULL。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetScroll`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetScroll`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
 有关在使用者中使用书签的信息，请参阅[使用书签](../../data/oledb/using-bookmarks.md)。  

## <a name="getdata"></a> Crowset:: Getdata
从行的行集的副本检索数据。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT GetData() throw();   


HRESULT GetData(int nAccessor) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *nAccessor*  
 [in]要用于访问数据的访问器 （零偏移量） 索引号。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 如果指定不是在为自动访问器的取值函数[BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md)，使用此方法以显式获取数据，通过传递取值函数数量。  

## <a name="getdatahere"></a> Crowset:: Getdatahere
从当前行中检索数据并将其放到指定的缓冲区。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT GetDataHere(int nAccessor,   
  void* pBuffer) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *nAccessor*  
 [in]要用于访问数据的访问器的索引号。  
  
 *pBuffer*  
 [out]要将当前记录的数据放置到的缓冲区。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 有关如何使用此函数的示例，请参阅[MultiRead 的示例](../../visual-cpp-samples.md)。

## <a name="getoriginaldata"></a> Crowset:: Getoriginaldata
调用`IRowsetUpdate::GetOriginalData`检索最近从提取或传输到数据源的数据。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT GetOriginalData() throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法检索的数据从最近提取或传输到数据源;它不会检索基于挂起的更改的值。  
  
 此方法需要的可选接口`IRowsetUpdate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetUpdate`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。 

## <a name="getrowstatus"></a> Crowset:: Getrowstatus
返回的所有行的状态。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();  
```  
  
#### <a name="parameters"></a>参数  
 *pStatus*  
 [out]指向一个位置的其中`GetRowStatus`返回的状态值。 请参阅中的 OLE DB 程序员参考 DBPENDINGSTATUS。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetUpdate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetUpdate`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。   

## <a name="insert"></a> Crowset:: Insert
创建并初始化新行使用访问器中的数据。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT Insert(int nAccessor = 0,   
   bool bGetHRow = false) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *nAccessor*  
 [in]要用于插入数据的访问器的数目。  
  
 *bGetHRow*  
 [in]指示是否检索为插入的行的句柄。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetChange`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetChange`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
 如果一个或多个列不是可写，则插入可能会失败。 修改光标映射以更正此问题。  
  
### <a name="example"></a>示例  
 下面的示例演示如何通过行集访问数据源，然后将使用一个表中的行集的字符串。  
  
 首先，通过将一个新的 ATL 对象插入到你的项目中创建的表类。 例如，右键单击工作区窗格中的项目并选择**新的 ATL 对象**。 从**数据访问**类别中，选择**使用者**。 创建类型的使用者对象**表**。 (选择**表**直接从表中创建行集; 选择**命令**创建通过 SQL 命令的行集。)选择数据源，指定用来访问该数据源的表。 如果调用使用者对象**CCustomerTable**，然后，可实现您插入的代码，如下所示：  
  
 [!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]  

## <a name="issamerow"></a> Crowset:: Issamerow
将指定的行与当前行进行比较。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT IsSameRow(HROW hRow) const throw();  
```  
  
#### <a name="parameters"></a>参数  
 *hRow*  
 [in]要与当前行进行比较的行句柄。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。 则为 S_OK，指示行相同。 其他值，请参阅[IRowsetIndentity::IsSameRow](https://msdn.microsoft.com/library/ms719629.aspx)中*OLE DB 程序员参考*Windows SDK 中。  

## <a name="movefirst"></a> Crowset:: Movefirst
将光标移到初始位置，并检索初始行。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT MoveFirst() throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 调用[irowset:: Restartposition](https://msdn.microsoft.com/library/ms712877.aspx)来重新定位的初始位置 （行集创建时的下一步提取位置的位置） 的下一步提取位置，并检索初始行。  

## <a name="movelast"></a> Crowset:: Movelast
将光标移到最后一行。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT MoveLast() throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 调用[irowset:: Restartposition](https://msdn.microsoft.com/library/ms712877.aspx)若要重新定位的下一步提取位置到最后一个位置，并检索最后一行。  
  
 此方法要求您设置`DBPROP_CANSCROLLBACKWARDS`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。 (为提高性能，你可能还要设置`DBPROP_QUICKRESTART`为 VARIANT_TRUE。)  

## <a name="movenext"></a> Crowset:: Movenext
将光标移到下一条记录。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT MoveNext() throw();HRESULT MoveNext(LONG lSkip,   
   bool bForward= true) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *lSkip*  
 [in]正在提取前要跳过的行数。  
  
 *bForward*  
 [in]传递 **，则返回 true**要向前移动到下一条记录， **false**向后移动。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。 当已达到行集末尾时，返回 DB_S_ENDOFROWSET。  
  
### <a name="remarks"></a>备注  
 提取从下一步的连续行`CRowset`对象，记住的以前的位置。 （可选） 你可以选择跳过一些*lSkip*行或向后移动。  
  
 此方法要求你设置以下属性之前调用`Open`对表或包含行集的命令：  
  
-   `DBPROP_CANSCROLLBACKWARDS` 如果必须为 VARIANT_TRUE *lSkip* < 0  
  
-   `DBPROP_CANFETCHBACKWARDS` 如果必须为 VARIANT_TRUE *bForward* = false  
  
 否则为 (如果*lSkip* > = 0 和*bForward* = true)，不需要设置的任何其他属性。  

## <a name="moveprev"></a> Crowset:: Moveprev
将光标移到上一条记录。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT MovePrev() throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法要求您设置或者`DBPROP_CANFETCHBACKWARDS`或`DBPROP_CANSCROLLBACKWARDS`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。 

## <a name="movetobookmark"></a> Crowset:: Movetobookmark
提取标记的书签或指定的偏移量处的行的行 (*lSkip*) 从该书签。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,   
   LONG lSkip = 0) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *书签*  
 [in] 标记要从其提取数据的位置的书签。  
  
 *lSkip*  
 [in] 从书签到目标行的行数。 如果*lSkip*为零，则提取的第一行是书签的行。 如果*lSkip*为 1，提取的第一行是标有书签的行后的行。 如果*lSkip*为-1，提取的第一行是标有书签的行前的行。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetLocate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetLocate`为 VARIANT_TRUE 并将`DBPROP_CANFETCHBACKWARDS`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
 有关在使用者中使用书签的信息，请参阅[使用书签](../../data/oledb/using-bookmarks.md)。  
  
## <a name="movetoratio"></a> Crowset:: Movetoratio
提取从行集中的小数位置开始的行。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,   
   DBCOUNTITEM nDenominator,bool bForward = true) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *nNumerator*  
 [in]用于确定小数分子从中提取数据的位置。  
  
 *nDenominator*  
 [in]用于确定小数分母从中提取数据的位置。  
  
 *bForward*  
 [in]指示是否向前或向后移动。 默认值为转发。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 `MoveToRatio` 提取行根据大约为以下公式：  
  
 `(nNumerator *  RowsetSize ) / nDenominator`  
  
 其中`RowsetSize`是行集，以行为单位的大小。 此公式的准确性取决于特定的提供程序。 有关详细信息，请参阅[irowsetscroll::](https://msdn.microsoft.com/library/ms709602.aspx)。  
  
 此方法需要的可选接口`IRowsetScroll`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetScroll`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  

## <a name="releaserows"></a> Crowset:: Releaserows
调用[irowset:: Releaserows](https://msdn.microsoft.com/library/ms719771.aspx)释放当前的行句柄。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT ReleaseRows() throw();  
  
```  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  

## <a name="setdata"></a> Crowset:: Setdata
设置中的某行的一个或多个列的数据值。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT SetData() const throw();   


HRESULT SetData(int nAccessor) const throw();  
```  
  
#### <a name="parameters"></a>参数  
 *nAccessor*  
 [in]要用于访问数据的访问器的数目。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 有关`SetData`接受任何参数，所有访问器的窗体用于进行更新。 通常情况下调用`SetData`若要在行中的列中设置数据值，然后调用[更新](../../data/oledb/crowset-update.md)传输这些更改。  
  
 此方法需要的可选接口`IRowsetChange`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetChange`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
 如果一个或多个列不是可写，则可能会失败的设置操作。 修改光标映射以更正此问题。 
  
## <a name="undo"></a> Crowset:: Undo
撤消自上次提取的行所做任何更改或[更新](../../data/oledb/crowset-update.md)。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,   
   HROW* phRow = NULL,   
   DBROWSTATUS* pStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *pcRows*  
 [out]指向位置的指针位置`Undo`返回它曾尝试撤消如果所需的行数。  
  
 *phRow*  
 [out]指向位置的指针位置`Undo`返回到它尝试撤消如果所需的所有行的句柄数组。  
  
 *pStatus*  
 [out]指向位置的指针位置`Undo`返回的行状态值。 如果返回任何状态*pStatus*为 null。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 此方法需要的可选接口`IRowsetUpdate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetUpdate`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  

## <a name="update"></a> CRowset::Update
传输任何挂起的更改对当前行进行自上次提取或`Update`对其调用。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,   
   HROW* phRow = NULL,   
   DBROWSTATUS* pStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *pcRows*  
 [out]指向位置的指针位置`Update`返回它尝试更新，如果所需的行数。  
  
 *phRow*  
 [out]指向位置的指针位置`Update`返回它曾尝试更新行的句柄。 如果返回任何句柄*phRow*为 null。  
  
 *pStatus*  
 [out]指向位置的指针位置`Update`返回的行状态值。 如果返回任何状态*pStatus*为 null。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  
  
### <a name="remarks"></a>备注  
 将任何挂起的更改自上次提取或更新该行以来对当前行进行传输 (使用`Update`或[UpdateAll](../../data/oledb/crowset-updateall.md))。 通常情况下调用[SetData](../../data/oledb/crowset-setdata.md)若要设置行中的列中的数据值，然后调用`Update`传输这些更改。  
  
 此方法需要的可选接口`IRowsetUpdate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetUpdate`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  

## <a name="updateall"></a> CRowset::UpdateAll
传输任何挂起的更改对所有行进行自上次提取或`Update`对其调用。  
  
### <a name="syntax"></a>语法  
  
```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,   
   HROW** pphRow = NULL,   
   DBROWSTATUS** ppStatus = NULL) throw();  
```  
  
#### <a name="parameters"></a>参数  
 *pcRows*  
 [out]指向位置的指针位置`UpdateAll`返回它尝试更新，如果所需的行数。  
  
 *pphRow*  
 [out]指向在其中的内存的指针`UpdateAll`返回它曾尝试更新行的句柄。 如果返回任何句柄*pphRow*为 null。  
  
 *ppStatus*  
 [out]指向位置的指针位置`Update`返回的行状态值。 如果返回任何状态*ppStatus*为 null。  
  
### <a name="remarks"></a>备注  
 将任何挂起的更改，因为这些行上次提取或更新使用对所有行进行传输[更新](../../data/oledb/crowset-update.md)或`UpdateAll`。 `UpdateAll` 将更新已修改，而不考虑是否仍有句柄为其每一行 (请参阅*pphRow*) 或不。  
  
 例如，如果您使用`Insert`若要在行集中插入五个行，你可以调用`Update`五次或调用`UpdateAll`一次将其所有更新。  
  
 此方法需要的可选接口`IRowsetUpdate`，这可能不支持对所有提供程序; 如果这是这种情况，该方法将返回 E_NOINTERFACE。 您还必须设置`DBPROP_IRowsetUpdate`为 VARIANT_TRUE 之前调用`Open`命令，其中包含行集的表上。  
  
### <a name="return-value"></a>返回值  
 标准的 HRESULT。  

## <a name="see-also"></a>请参阅  
 [DBViewer 示例](../../visual-cpp-samples.md)   
 [MultiRead 的示例](../../visual-cpp-samples.md)   
 [MultiRead 的属性示例](../../visual-cpp-samples.md)   
 [OLE DB 使用者模板](../../data/oledb/ole-db-consumer-templates-cpp.md)   
 [OLE DB 使用者模板参考](../../data/oledb/ole-db-consumer-templates-reference.md)