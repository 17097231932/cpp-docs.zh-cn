---
title: CMFCToolBarMenu按钮类
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 418ef29657271010c3a12f0f15a12f45e5351aac
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376161"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenu按钮类

包含一个弹出菜单的工具栏按钮。
有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CMFCToolBarMenu按钮：CMFCToolBarMenu按钮](#cmfctoolbarmenubutton)|构造 `CMFCToolBarMenuButton` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFCToolBarMenu按钮：：与比较](#comparewith)|将此实例与提供`CMFCToolBarButton`的对象进行比较。 （覆盖[CMFC 工具栏按钮：：与 比较](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith)。|
|[CMFCToolBarMenu按钮：：抄袭](#copyfrom)|将另一个工具栏按钮的属性复制到当前按钮。 （覆盖[CMFCToolBar 按钮：：从](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)复制。）|
|[CMFCToolBarMenu按钮：：从Menu创建](#createfrommenu)|从 Windows 菜单句柄初始化工具栏菜单。|
|[CMFCToolBarMenu按钮：：创建菜单](#createmenu)|创建由工具栏菜单中的命令组成的 Windows 菜单。 将句柄返回到 Windows 菜单。|
|[CMFCToolBarMenu按钮：：创建弹出菜单](#createpopupmenu)|创建一个弹出式菜单对象 （ [CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)） 以显示工具栏菜单。|
|[CMFCToolBarMenu按钮：：启用快速定制](#enablequickcustomize)||
|[CMFCToolBarMenu按钮：获取命令](#getcommands)|提供对工具栏菜单中命令列表的只读访问权限。|
|[CMFCToolBarMenu按钮：：获取图像Rect](#getimagerect)|检索按钮图像的边界矩形。|
|[CMFCToolBarMenu按钮：：获取调色板](#getpaletterows)|当菜单处于调色板模式时，返回弹出式菜单中的行数。|
|[CMFCToolBarMenu按钮：：获取弹出菜单](#getpopupmenu)|返回指向与按钮关联的弹出菜单对象的指针。|
|[CMFCToolBarMenu按钮：：有按钮](#hasbutton)||
|[CMFCToolBarMenu按钮：：有热边框](#havehotborder)|确定当用户选择该按钮时是否显示按钮的边框。 （覆盖[CMFCToolBar 按钮：：有 Hot 边框](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).）|
|[CMFCToolBarMenu按钮：：是边框](#isborder)||
|[CMFCToolBarMenu按钮：：被点击的上菜单](#isclickedonmenu)||
|[CMFCToolBarMenu按钮：：已丢弃](#isdroppeddown)|确定是否显示弹出式菜单。|
|[CMFCToolBarMenu按钮：：空门允许](#isemptymenuallowed)|由框架调用以确定用户是否可以从所选菜单项打开子菜单。|
|[CMFCToolBarMenu按钮：：是排他性的](#isexclusive)|确定按钮是否处于独占模式，即即使用户将指针移到其他工具栏或按钮上，弹出式菜单是否仍然保持打开状态。|
|[CMFCToolBarMenu按钮：：isMenuPalette模式](#ismenupalettemode)|确定弹出式菜单是否处于调色板模式。|
|[CMFCToolBarMenu按钮：：是快速模式](#isquickmode)||
|[CMFCToolBarMenu按钮：：IstearoffMenu](#istearoffmenu)|确定弹出式菜单是否具有撕下栏。|
|[CMFCToolBarMenu按钮：：在之后创建弹出菜单](#onaftercreatepopupmenu)||
|[CMFCToolBarMenu按钮：：在拖动前打开](#onbeforedrag)|指定是否可以拖动按钮。 （覆盖[CMFCToolBar 按钮：：在拖动之前](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)。）|
|[CMFCToolBarMenu按钮：：在计算大小上](#oncalculatesize)|由框架调用，以计算指定设备上下文和停靠状态的按钮大小。 （覆盖[CMFC 工具栏按钮："正在计算大小](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize)"）|
|[CMFCToolBarMenu按钮：：打开取消模式](#oncancelmode)|由框架调用以处理[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)消息。 （覆盖[CMFC 工具栏按钮：打开取消模式](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode).）|
|[CMFCToolBarMenu按钮：：打开更改家长](#onchangeparentwnd)|将按钮插入到新工具栏时由框架调用。 （覆盖[CMFC 工具栏按钮：打开更改父项](cmfctoolbarbutton-class.md#onchangeparentwnd).）|
|[CMFCToolBarMenu按钮：：点击](#onclick)|当用户单击鼠标按钮时由框架调用。 （覆盖[CMFC 工具栏按钮：：单击](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).）|
|[CMFCToolBarMenu按钮：：点击菜单项](#onclickmenuitem)|当用户在弹出式菜单中选择项目时，由框架调用。|
|[CMFCToolBarMenu按钮：：在上下文帮助](#oncontexthelp)|当父工具栏处理WM_HELPHITTEST消息时，由框架调用。 （覆盖[CMFC 工具栏按钮：打开上下文帮助](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).）|
|[CMFCToolBarMenu按钮：：开拉](#ondraw)|框架调用使用指定的样式和选项绘制按钮。 （覆盖[CMFC 工具栏按钮：：OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).）|
|[CMFCToolBarmenu按钮：：在画上定制列表](#ondrawoncustomizelist)|由框架调用以在 **"自定义"** 对话框的 **"命令"** 窗格中绘制按钮。 （覆盖[CMFC 工具栏按钮：在"绘制"自定义列表](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).）|
|[CMFCToolBarMenu按钮：：打开弹出菜单](#openpopupmenu)|当用户打开弹出式菜单时由框架调用。|
|[CMFCToolBarMenu按钮：：重置图像到默认](#resetimagetodefault)|将与按钮关联的图像设置到默认值。 （覆盖[CMFC 工具栏按钮：重置图像默认值](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).）|
|[CMFCToolBarMenu按钮：：保存栏](#savebarstate)|保存工具栏按钮的状态。 （覆盖[CMFCToolBarButton：：保存栏](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).）|
|[CMFCToolBarMenu按钮：序列化](#serialize)|从存档中读取此对象或将其写入存档。 （覆盖[CMFCToolBarButton：序列化](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).）|
|[CMFCToolBarMenu按钮：：设置ACC数据](#setaccdata)|使用工具栏按钮中的`CAccessibilityData`辅助功能数据填充提供的对象。 （覆盖[CMFC 工具栏按钮：设置ACC数据](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).）|
|[CMFCToolBarMenu按钮：仅设置菜单](#setmenuonly)|指定按钮是否可以添加到工具栏。|
|[CMFCToolBarMenu按钮：：设置菜单调色板模式](#setmenupalettemode)|指定弹出式菜单是否处于调色板模式。|
|[CMFCToolBarMenu按钮：：设置消息](#setmessagewnd)||
|[CMFCToolBarMenu按钮：：SetRadio](#setradio)|强制工具栏菜单按钮显示指示其已选中的图标。|
|[CMFCToolBarMenu按钮：：设置关闭](#settearoff)|为弹出式菜单指定撕下条形标识。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CMFCToolBarMenu按钮：:D原始文档图标](#drawdocumenticon)|在菜单按钮上绘制一个图标。|

### <a name="data-members"></a>数据成员

|名称|说明|
|----------|-----------------|
|[CMFCToolBarMenu按钮：：m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|如果为 TRUE，则在绘制按钮时，框架始终调用[CFrameWndEx：onDrawMenuImage。](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)|

## <a name="remarks"></a>备注

可以`CMFCToolBarMenuButton`显示为菜单、具有子菜单的菜单项、执行命令或显示菜单的按钮或仅显示菜单的按钮。 通过指定与构造函数`CMFCToolbarMenuButton::CMFCToolbarMenuButton`中的按钮关联的参数（如图像、文本、菜单句柄和命令 ID）来确定菜单按钮的行为和外观。

从类派生的`CMFCToolbarMenuButton`自定义类必须使用[DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)宏。 [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)宏在应用程序关闭时生成错误。

## <a name="example"></a>示例

下面的示例演示如何配置`CMFCToolBarMenuButton`对象。 该代码演示如何指定下拉菜单处于调色板模式，并指定用户将菜单按钮从菜单栏中拖出时创建的撕下栏的 ID。 此代码片段属于 [Word Pad 示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>要求

**标头：** afxtoolbarmenubutton.h

## <a name="cmfctoolbarmenubuttoncmfctoolbarmenubutton"></a><a name="cmfctoolbarmenubutton"></a>CMFCToolBarMenu按钮：CMFCToolBarMenu按钮

构造 `CMFCToolBarMenuButton` 对象。

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>参数

*src*<br/>
[在]要复制到`CMFCToolBarMenuButton`此`CMFCToolBarMenuButton`对象的现有对象。

*uiID*<br/>
[在]用户单击按钮时要执行的命令的 ID;或 （UINT）-1 表示不直接执行命令的菜单按钮。

*hMenu*<br/>
[在]菜单的句柄;如果按钮没有菜单，则为 NULL。

*i图像*<br/>
[在]按钮的图像索引;或 -1 如果此按钮没有图标或使用*uiID*指定的命令的图标。 对于应用程序中的每个`CMFCToolBarImages`对象，索引都相同。

*lpszText*<br/>
[在]工具栏菜单按钮的文本。

*用户按钮*<br/>
[在]如果按钮显示用户定义的图像，则为 TRUE;如果按钮显示用户定义的图像，则为 TRUE。如果按钮显示与*uiID*指定的命令关联的预定义图像，则 FALSE。

### <a name="remarks"></a>备注

如果*uiID*是有效的命令 ID，则当用户单击该命令时，该按钮将执行该命令。 如果*hMenu*是有效的菜单句柄，则当按钮出现在工具栏或子菜单中时，该按钮会提供下拉菜单。 如果*uiID*和*hMenu*都有效，则该按钮是一个拆分按钮，该按钮的一部分将在用户单击该命令时执行该命令，而该按钮的一部分带有向下箭头，当用户单击菜单时，该按钮将下拉菜单。 但是，如果*hMenu*有效，则当按钮插入到菜单中时，用户将无法单击该按钮执行命令。

### <a name="example"></a>示例

下面的示例演示如何构造`CMFCToolBarMenuButton`类的对象。 此代码片段属于 [Word Pad 示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

## <a name="cmfctoolbarmenubuttoncomparewith"></a><a name="comparewith"></a>CMFCToolBarMenu按钮：：与比较

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>参数

[在]*其他*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttoncopyfrom"></a><a name="copyfrom"></a>CMFCToolBarMenu按钮：：抄袭

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>参数

[在]*斯尔克*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttoncreatefrommenu"></a><a name="createfrommenu"></a>CMFCToolBarMenu按钮：：从Menu创建

从 Windows 菜单句柄初始化工具栏菜单。

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>参数

*hMenu*<br/>
[在]菜单的句柄。

### <a name="remarks"></a>备注

工具栏菜单按钮可以显示下拉子菜单。

框架调用此方法从菜单初始化子菜单中的命令。

## <a name="cmfctoolbarmenubuttoncreatemenu"></a><a name="createmenu"></a>CMFCToolBarMenu按钮：：创建菜单

创建由工具栏菜单中的命令组成的菜单。 向菜单返回句柄。

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>返回值

如果成功，则对菜单的句柄。 如果与工具栏菜单按钮关联的命令列表为空，则为 NULL。

### <a name="remarks"></a>备注

可以在派生类中重写此方法，以自定义菜单的生成方式。

## <a name="cmfctoolbarmenubuttoncreatepopupmenu"></a><a name="createpopupmenu"></a>CMFCToolBarMenu按钮：：创建弹出菜单

创建要`CMFCPopupMenu`显示工具栏菜单的对象。

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>返回值

指向显示`CMFCPopupMenu`与工具栏菜单按钮关联的下拉菜单的对象的指针。

### <a name="remarks"></a>备注

框架调用此方法以准备显示与按钮关联的下拉菜单。

默认实现只是构造并返回一个新`CMFCPopupMenu`对象。 如果要使用派生类型的[CMFCPopupMenu 类](cmfcpopupmenu-class.md)或执行其他初始化，则重写此方法。

## <a name="cmfctoolbarmenubuttondrawdocumenticon"></a><a name="drawdocumenticon"></a>CMFCToolBarMenu按钮：:D原始文档图标

在菜单按钮上绘制文档图标。

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*rectImage*<br/>
[在]图像边界矩形的坐标。

*hIcon*<br/>
[在]图标的句柄。

### <a name="remarks"></a>备注

此方法采用文档图标并将其绘制在菜单按钮上，以*rectImage*指定的区域为中心。

## <a name="cmfctoolbarmenubuttonenablequickcustomize"></a><a name="enablequickcustomize"></a>CMFCToolBarMenu按钮：：启用快速定制

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonhasbutton"></a><a name="hasbutton"></a>CMFCToolBarMenu按钮：：有按钮

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonhavehotborder"></a><a name="havehotborder"></a>CMFCToolBarMenu按钮：：有热边框

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonisborder"></a><a name="isborder"></a>CMFCToolBarMenu按钮：：是边框

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonisclickedonmenu"></a><a name="isclickedonmenu"></a>CMFCToolBarMenu按钮：：被点击的上菜单

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonisquickmode"></a><a name="isquickmode"></a>CMFCToolBarMenu按钮：：是快速模式

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttongetcommands"></a><a name="getcommands"></a>CMFCToolBarMenu按钮：获取命令

提供对工具栏菜单中命令列表的只读访问权限。

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>返回值

对[COblist 类](../../mfc/reference/coblist-class.md)对象的引用，该对象包含[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象的集合。

### <a name="remarks"></a>备注

工具栏菜单按钮可以显示子菜单。 您可以在构造函数中的子菜单或[CMFCToolBarMenuButton 中提供命令列表：创建FromMenu](#createfrommenu)作为菜单 （HMENU） 的句柄。 菜单将转换为从[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)派生并存储在内部`CObList`对象中的对象列表。 您可以通过调用此方法访问此列表。

## <a name="cmfctoolbarmenubuttongetimagerect"></a><a name="getimagerect"></a>CMFCToolBarMenu按钮：：获取图像Rect

检索按钮图像的边界矩形。

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>参数

*rectImage*<br/>
[出]对接收图像边界`CRect`矩形坐标的对象的引用。

## <a name="cmfctoolbarmenubuttongetpaletterows"></a><a name="getpaletterows"></a>CMFCToolBarMenu按钮：：获取调色板

当菜单处于调色板模式时，返回下拉菜单中的行数。

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>返回值

调色板中的行数。

### <a name="remarks"></a>备注

当菜单按钮设置为调色板模式时，菜单项将显示在多个列中，只有有限的行数。 调用此方法以获取行数。 您可以使用[CMFCToolBarMenuButton：：setMenuPaletteMode](#setmenupalettemode)启用或禁用调色板模式并指定行数。

## <a name="cmfctoolbarmenubuttongetpopupmenu"></a><a name="getpopupmenu"></a>CMFCToolBarMenu按钮：：获取弹出菜单

返回指向表示按钮下拉菜单的[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象的指针。

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>返回值

指向[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象的指针，该对象是在框架绘制工具栏菜单按钮的子菜单时创建的;如果未显示子菜单，则为 NULL。

### <a name="remarks"></a>备注

当工具栏菜单按钮显示下拉菜单时，该按钮将创建一个[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象来表示菜单。 调用此方法以获取指向对象的`CMFCPopupMenu`指针。 不应存储返回的指针，因为它是暂时的，并且在用户关闭下拉菜单时无效。

## <a name="cmfctoolbarmenubuttonisdroppeddown"></a><a name="isdroppeddown"></a>CMFCToolBarMenu按钮：：已丢弃

指示当前是否显示弹出式菜单。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>返回值

如果工具栏菜单按钮显示其子菜单，则为 TRUE;否则 FALSE。

## <a name="cmfctoolbarmenubuttonisemptymenuallowed"></a><a name="isemptymenuallowed"></a>CMFCToolBarMenu按钮：：空门允许

指定菜单项是否显示空子菜单。

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>返回值

如果框架从当前选定的菜单项打开子菜单，即使子菜单为空，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

当用户尝试从当前选定的菜单项打开子菜单时，框架将调用此方法。 如果子菜单为空并`IsEmptyMenuAllowed`返回 FALSE，则子菜单将不会打开。

默认实现返回 FALSE。 重写此方法以自定义此行为。

## <a name="cmfctoolbarmenubuttonisexclusive"></a><a name="isexclusive"></a>CMFCToolBarMenu按钮：：是排他性的

指示按钮是否处于独占模式。

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>返回值

如果按钮在独占模式下工作，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

当用户打开按钮的弹出菜单，然后将鼠标指针移到另一个工具栏或菜单按钮上时，弹出菜单将关闭，除非该按钮处于独占模式。

默认实现始终返回 FALSE。 如果要打开独占模式，请覆盖派生类中的此方法。

## <a name="cmfctoolbarmenubuttonismenupalettemode"></a><a name="ismenupalettemode"></a>CMFCToolBarMenu按钮：：isMenuPalette模式

确定下拉菜单是否处于调色板模式。

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>返回值

如果启用了调色板模式，则为 TRUE，否则为 FALSE。

### <a name="remarks"></a>备注

当菜单按钮设置为调色板模式时，菜单项将显示在多个列中，只有有限的行数。 调用此方法以获取行数。 您可以通过调用[CMFCToolBarMenuButton：：SetMenuPalette模式](#setmenupalettemode)来启用或禁用调色板模式。

## <a name="cmfctoolbarmenubuttonistearoffmenu"></a><a name="istearoffmenu"></a>CMFCToolBarMenu按钮：：IstearoffMenu

指示下拉菜单是否具有撕下栏。

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>返回值

如果工具栏菜单按钮具有撕开栏，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

要启用分接功能并设置撕下栏 ID，请致电[CMFCToolBarMenuButton：：SetTearoff。](#settearoff)

## <a name="cmfctoolbarmenubuttonm_balwayscallownerdraw"></a><a name="m_balwayscallownerdraw"></a>CMFCToolBarMenu按钮：：m_bAlwaysCallOwnerDraw

指定框架是否始终在绘制按钮时调用[CFrameWndEx：onDrawMenuImage。](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>备注

当此成员变量设置为 TRUE 时，该按钮始终调用[CFrameWndEx：：OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)方法以在按钮上显示图像。 当`m_bAlwaysCallOwnerDraw`为 FALSE 时，如果图像已预定义，按钮本身将绘制图像。 否则，它将调用`OnDrawMenuImage`。

## <a name="cmfctoolbarmenubuttononaftercreatepopupmenu"></a><a name="onaftercreatepopupmenu"></a>CMFCToolBarMenu按钮：：在之后创建弹出菜单

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttononbeforedrag"></a><a name="onbeforedrag"></a>CMFCToolBarMenu按钮：：在拖动前打开

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttononcalculatesize"></a><a name="oncalculatesize"></a>CMFCToolBarMenu按钮：：在计算大小上

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>
[在]*大小 默认*<br/>
[在]*布霍兹*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttononcancelmode"></a><a name="oncancelmode"></a>CMFCToolBarMenu按钮：：打开取消模式

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a>CMFCToolBarMenu按钮：：打开更改家长

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>参数

[在]*pwnd 父级*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttononclick"></a><a name="onclick"></a>CMFCToolBarMenu按钮：：点击

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>参数

[在]*pwnd*<br/>
[在]*bDelay*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttononclickmenuitem"></a><a name="onclickmenuitem"></a>CMFCToolBarMenu按钮：：点击菜单项

当用户在下拉菜单中选择项目时，由框架调用。

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>返回值

如果框架应继续默认菜单项处理，则 FALSE;否则为 TRUE。 默认实现始终返回 FALSE。

### <a name="remarks"></a>备注

当用户单击菜单项时，框架将执行与该项关联的命令。

要自定义菜单项处理，请覆盖`OnClickMenuItem`从`CMFCToolBarMenuButton`类派生的类中。 您还必须覆盖[CFrameWndEx：：OnShowPopupMenu，](../../mfc/reference/cframewndex-class.md#onshowpopupmenu)并将需要特殊处理的菜单按钮替换为派生类的实例。

## <a name="cmfctoolbarmenubuttononcontexthelp"></a><a name="oncontexthelp"></a>CMFCToolBarMenu按钮：：在上下文帮助

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>参数

[在]*pwnd*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonondraw"></a><a name="ondraw"></a>CMFCToolBarMenu按钮：：开拉

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>
[在]*rect*<br/>
[在]*pImage*<br/>
[在]*布霍兹*<br/>
[在]*b 定制模式*<br/>
[在]*b 高光*<br/>
[在]*bDraw边框*<br/>
[在]*b格雷禁用按钮*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a>CMFCToolBarmenu按钮：：在画上定制列表

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>
[在]*rect*<br/>
[在]*b选定*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonopenpopupmenu"></a><a name="openpopupmenu"></a>CMFCToolBarMenu按钮：：打开弹出菜单

当用户打开工具栏菜单按钮的下拉菜单时，由框架调用。

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>参数

*pwnd*<br/>
[在]指定接收下拉菜单命令的窗口。 仅当工具栏菜单按钮具有父窗口时，它才能为 NULL。

### <a name="return-value"></a>返回值

成功创建并打开[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象时为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

当用户从工具栏菜单按钮打开下拉菜单时，框架将调用此功能。

## <a name="cmfctoolbarmenubuttonresetimagetodefault"></a><a name="resetimagetodefault"></a>CMFCToolBarMenu按钮：：重置图像到默认

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonsavebarstate"></a><a name="savebarstate"></a>CMFCToolBarMenu按钮：：保存栏

```
virtual void SaveBarState();
```

### <a name="remarks"></a>备注

当框架创建工具栏按钮作为拖放操作的结果时，它将调用此方法。 此方法调用顶级弹出式菜单的[CMFCPopupMenu：：保存状态](../../mfc/reference/cmfcpopupmenu-class.md#savestate)方法，这将导致弹出式菜单的父按钮重新创建其菜单。

## <a name="cmfctoolbarmenubuttonserialize"></a><a name="serialize"></a>CMFCToolBarMenu按钮：序列化

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>参数

[在]*阿尔*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonsetaccdata"></a><a name="setaccdata"></a>CMFCToolBarMenu按钮：：设置ACC数据

设置功能区元素的可访问性数据。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>参数

*p 父级*<br/>
功能区元素的父窗口。

*数据*<br/>
功能区元素的可访问性数据。

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法设置功能区元素的辅助功能数据，并始终返回 TRUE。 重写此方法以设置可访问性数据并返回一个指示成功或失败的值。

## <a name="cmfctoolbarmenubuttonsetmenuonly"></a><a name="setmenuonly"></a>CMFCToolBarMenu按钮：仅设置菜单

指定当按钮同时具有有效的命令 ID 和子菜单时，该按钮是作为菜单按钮还是拆分按钮绘制。

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>参数

*仅*<br/>
[在]TRUE 显示此按钮为菜单按钮时，它既具有有效的命令 ID 和子菜单，则 FALSE 将此按钮作为拆分按钮显示，当它同时具有有效的命令 ID 和子菜单时。

### <a name="remarks"></a>备注

通常，当工具栏菜单按钮同时具有子菜单和命令 ID 时，菜单似乎是一个拆分按钮，该按钮具有主按钮和附加的向下箭头按钮。 如果调用此方法，并且*bMenuOnly*为 TRUE，则该按钮将显示为单个菜单按钮，按钮中带有向下箭头。 当用户在任一模式下单击箭头时，子菜单将打开，当用户单击任一模式下按钮的非箭头部分时，框架将执行命令 。

## <a name="cmfctoolbarmenubuttonsetmenupalettemode"></a><a name="setmenupalettemode"></a>CMFCToolBarMenu按钮：：设置菜单调色板模式

指定下拉菜单是否处于调色板模式。

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>参数

*bMenuPalette模式*<br/>
[在]指定下拉菜单是否处于调色板模式。

*nPaletteRows*<br/>
[在]调色板中的行数。

### <a name="remarks"></a>备注

在调色板模式下，所有菜单项都显示为多列调色板。 使用*nPaletteRows*指定行数。

## <a name="cmfctoolbarmenubuttonsetmessagewnd"></a><a name="setmessagewnd"></a>CMFCToolBarMenu按钮：：设置消息

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>参数

[在]*pWnd消息*<br/>

### <a name="remarks"></a>备注

## <a name="cmfctoolbarmenubuttonsetradio"></a><a name="setradio"></a>CMFCToolBarMenu按钮：：SetRadio

设置工具栏菜单按钮，在选中时显示单选按钮样式图标。

```
virtual void SetRadio();
```

### <a name="remarks"></a>备注

选中菜单按钮时绘制时，它将调用[CMFCVisualManager：：OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck)以绘制复选标记图标。 默认情况下，`OnDrawMenuCheck`请求当前可视管理器在菜单按钮上绘制复选框样式复选框。 调用此方法后，当前可视管理器将改为在菜单按钮上绘制单选按钮样式复选标记。 无法撤消此更改。

当您调用此方法且菜单按钮当前正在显示时，它将刷新。

## <a name="cmfctoolbarmenubuttonsettearoff"></a><a name="settearoff"></a>CMFCToolBarMenu按钮：：设置关闭

指定下拉菜单的拆解栏的 ID。

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>参数

*uiBarID*<br/>
[在]指定新的拆解条 ID。

### <a name="remarks"></a>备注

调用此方法以指定用户从菜单栏中拖动菜单按钮时创建的撕掉栏的 ID。 如果*uiBarID*参数为 0，则用户无法撕下菜单按钮。

致电[CWinAppEx：启用TearOffMenus，](../../mfc/reference/cwinappex-class.md#enabletearoffmenus)以便在应用程序中启用分接菜单功能。

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFC工具栏按钮类](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar 类](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)
