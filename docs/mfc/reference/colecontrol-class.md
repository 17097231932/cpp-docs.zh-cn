---
title: "COleControl 类 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- OLE controls, MFC
- windowless controls, MFC
- windowless controls
- controls [MFC], OLE
- controls [MFC], windowless
- COleControl class
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: 7ef5621aaf940be3ebe2806971dfc65d06972a5a
ms.lasthandoff: 02/24/2017

---
# <a name="colecontrol-class"></a>COleControl 类
用于开发 OLE 控件的重要基类。  
  
## <a name="syntax"></a>语法  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|描述|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|创建一个 `COleControl` 对象。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|说明|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|检索当前控件的外观。|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|返回环境的 backcolor 属性的值。|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|按容器返回指定控件的名称。|  
|[COleControl::AmbientFont](#ambientfont)|返回环境的字体属性的值。|  
|[COleControl::AmbientForeColor](#ambientforecolor)|返回环境的前景色属性的值。|  
|[Colecontrol:: Ambientlocaleid](#ambientlocaleid)|返回容器的区域设置 id。|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|返回由容器所用的单位类型。|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|确定是否应显示抓取手柄。|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|确定是否应显示阴影。|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|返回指定的容器的文本对齐方式的类型。|  
|[COleControl::AmbientUIDead](#ambientuidead)|确定该控件应响应用户界面操作。|  
|[COleControl::AmbientUserMode](#ambientusermode)|确定该容器的模式。|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|通知容器绑定的属性已更改。|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|若要编辑的属性值的请求权限。|  
|[COleControl::ClientToParent](#clienttoparent)|将相对于控件的原点相对于其容器的原点的点到点转换。|  
|[COleControl::ClipCaretRect](#clipcaretrect)|如果由控件重叠，则调整插入符号移动矩形。|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|更改的一套助记符由控件处理后调用此函数。|  
|[COleControl::DisplayError](#displayerror)|对控件的用户显示常用的错误事件。|  
|[COleControl::DoClick](#doclick)|实现的股票`DoClick`方法。|  
|[COleControl::DoPropExchange](#dopropexchange)|序列化的属性`COleControl`对象。|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|重绘具有已通过 Windows 控件子类化的 OLE 控件。|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|控件支持简单框架。|  
|[COleControl::ExchangeExtent](#exchangeextent)|序列化该控件的宽度和高度。|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|序列化该控件的常用属性。|  
|[COleControl::ExchangeVersion](#exchangeversion)|序列化该控件的版本号。|  
|[COleControl::FireClick](#fireclick)|激发股票`Click`事件。|  
|[COleControl::FireDblClick](#firedblclick)|激发股票`DblClick`事件。|  
|[COleControl::FireError](#fireerror)|激发股票`Error`事件。|  
|[COleControl::FireEvent](#fireevent)|触发自定义事件。|  
|[COleControl::FireKeyDown](#firekeydown)|激发股票`KeyDown`事件。|  
|[COleControl::FireKeyPress](#firekeypress)|激发股票`KeyPress`事件。|  
|[COleControl::FireKeyUp](#firekeyup)|激发股票`KeyUp`事件。|  
|[COleControl::FireMouseDown](#firemousedown)|激发股票`MouseDown`事件。|  
|[COleControl::FireMouseMove](#firemousemove)|激发股票`MouseMove`事件。|  
|[COleControl::FireMouseUp](#firemouseup)|激发股票`MouseUp`事件。|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|引发该控件的就绪状态更改时发生的事件。|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|更改支持的控件的默认激活行为`IPointerInactive`接口。|  
|[COleControl::GetAmbientProperty](#getambientproperty)|返回指定的环境属性的值。|  
|[COleControl::GetAppearance](#getappearance)|返回股票的外观属性的值。|  
|[COleControl::GetBackColor](#getbackcolor)|返回股票的 BackColor 属性的值。|  
|[COleControl::GetBorderStyle](#getborderstyle)|返回股票的边框样式属性的值。|  
|[COleControl::GetCapture](#getcapture)|确定一个无窗口激活的控件对象是否具有鼠标捕获。|  
|[COleControl::GetClassID](#getclassid)|检索控件的 OLE 类 ID。|  
|[COleControl::GetClientOffset](#getclientoffset)|检索控件的矩形区域的左上的角和其工作区的左上的角之间的差异。|  
|[COleControl::GetClientRect](#getclientrect)|检索控件的工作区的大小。|  
|[COleControl::GetClientSite](#getclientsite)|将查询一个对象，用于指向其当前的客户端站点，在其容器内的指针。|  
|[COleControl::GetControlFlags](#getcontrolflags)|检索控件标志设置。|  
|[COleControl::GetControlSize](#getcontrolsize)|返回的位置和 OLE 控件的大小。|  
|[COleControl::GetDC](#getdc)|提供无窗口控件来获得其容器的设备上下文的方法。|  
|[COleControl::GetEnabled](#getenabled)|返回股票 Enabled 属性的值。|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|检索指向属于该容器的扩展的控件对象的指针。|  
|[COleControl::GetFocus](#getfocus)|确定是否在控件有焦点。|  
|[COleControl::GetFont](#getfont)|返回的堆栈 Font 属性的值。|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|返回的度量值`CFontHolder`对象。|  
|[COleControl::GetForeColor](#getforecolor)|返回股票的前景色属性的值。|  
|[COleControl::GetHwnd](#gethwnd)|返回股票 hWnd 属性的值。|  
|[COleControl::GetMessageString](#getmessagestring)|为菜单项提供状态栏文本。|  
|[Colecontrol:: Getnotsupported](#getnotsupported)|由用户控件的属性值将阻止访问。|  
|[COleControl::GetReadyState](#getreadystate)|返回控件的就绪状态。|  
|[COleControl::GetRectInContainer](#getrectincontainer)|返回相对于其容器的控件的矩形。|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|返回的度量的堆栈 Font 属性。|  
|[COleControl::GetText](#gettext)|返回常用的文本或 Caption 属性的值。|  
|[Colecontrol:: Getwindowlessdroptarget](#getwindowlessdroptarget)|重写以允许无窗口控件，从而显著作为目标的拖放操作。|  
|[COleControl::InitializeIIDs](#initializeiids)|通知将使用该控件的 Iid 的基类。|  
|[COleControl::InternalGetFont](#internalgetfont)|返回`CFontHolder`的堆栈 Font 属性的对象。|  
|[COleControl::InternalGetText](#internalgettext)|检索股票的标题或文本属性。|  
|[Colecontrol:: Internalsetreadystate](#internalsetreadystate)|设置控件的就绪状态，并触发就绪状态更改事件。|  
|[COleControl::InvalidateControl](#invalidatecontrol)|使显示的控件，从而导致重绘该区域无效。|  
|[COleControl::InvalidateRgn](#invalidatergn)|使容器窗口中的给定区域内的客户端区域无效。 可以使用重绘的区域中的无窗口控件。|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|允许 OLE 控件的专用的加载。|  
|[COleControl::IsModified](#ismodified)|确定是否已更改的控件状态。|  
|[Colecontrol:: Isoptimizeddraw](#isoptimizeddraw)|指示容器是否支持当前的绘制操作优化的绘图。|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|调用以确定是否控件子类化 Windows 控件。|  
|[COleControl::Load](#load)|重置所有以前的异步数据并启动新的加载该控件的异步属性。|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|确定是否由容器，可以停用您的控件。|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|环境属性更改时调用。|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|常用的外观属性更改时调用。|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|常用的 backcolor 属性更改时调用。|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|常用的边框样式属性更改时调用。|  
|[COleControl::OnClick](#onclick)|调用以触发常用 Click 事件。|  
|[COleControl::OnClose](#onclose)|向控件通知的`IOleControl::Close`已调用。|  
|[COleControl::OnDoVerb](#ondoverb)|在执行控制谓词后调用。|  
|[COleControl::OnDraw](#ondraw)|当请求控件重绘自身时调用。|  
|[Colecontrol:: Ondrawmetafile](#ondrawmetafile)|当请求控件重绘自身使用图元文件设备上下文由容器调用。|  
|[COleControl::OnEdit](#onedit)|由 OLE 控件的容器的用户界面激活。|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Stock Enabled 属性更改时调用。|  
|[COleControl::OnEnumVerbs](#onenumverbs)|要枚举控制谓词的容器由调用。|  
|[COleControl::OnEventAdvise](#oneventadvise)|当事件处理程序连接从另一控件时调用。|  
|[COleControl::OnFontChanged](#onfontchanged)|常用字体属性更改时调用。|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|常用的前景色属性更改时调用。|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|当冻结或解冻控件的事件时调用。|  
|[COleControl::OnGetColorSet](#ongetcolorset)|向控件通知的`IOleObject::GetColorSet`已调用。|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|提供对容器的助记键信息。|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|调用以获取一个字符串来表示属性值。|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|请求使用容器菜单将合并的控件的菜单句的柄。|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|重写以检索该控件的显示大小最接近的建议的大小和扩展盘区模式。|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|返回表示属性的可能值的字符串。|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|返回对应于预定义的字符串的值。|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|重写以检索 （可用来启用两次绘图） 的控件的显示区域的大小。|  
|[COleControl::OnGetViewRect](#ongetviewrect)|重写以将控件的大小转换为一个矩形的特定位置开始。|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|重写以检索有关控件的视图状态。|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|当控件处于停用的用户界面由容器调用。|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|重写以具有在鼠标指针调度处于非活动状态的控件的容器`WM_MOUSEMOVE`到控件的消息。|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|重写以具有在鼠标指针调度处于非活动状态的控件的容器`WM_SETCURSOR`到控件的消息。|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|在已激发股票的 KeyDown 事件之后调用。|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|在已激发股票的 KeyPress 事件之后调用。|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|在已激发股票的 KeyUp 事件之后调用。|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|指示要用于编辑属性的属性页。|  
|[COleControl::OnMnemonic](#onmnemonic)|当按下该控件的助记键时调用。|  
|[COleControl::OnProperties](#onproperties)|当调用该控件的"属性"谓词时调用。|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|控件的显示重叠给的定点是否重写查询。|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|控件的显示与给定的矩形中的任何点重叠是否重写查询。|  
|[COleControl::OnRenderData](#onrenderdata)|由框架用于检索指定的格式数据调用。|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|调用由框架来从指定的格式的文件中检索数据。|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|调用由框架从共用内存中指定的格式检索数据。|  
|[COleControl::OnResetState](#onresetstate)|将控件的属性重置为默认值。|  
|[Colecontrol:: Onsetclientsite](#onsetclientsite)|向控件通知的`IOleControl::SetClientSite`已调用。|  
|[COleControl::OnSetData](#onsetdata)|控件的数据替换为另一个值。|  
|[COleControl::OnSetExtent](#onsetextent)|控件的大小时发生更改后调用。|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|控件的维度具有更改之后调用。|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|当控件已经被 UI 激活时调用。|  
|[COleControl::OnTextChanged](#ontextchanged)|股票文本或 Caption 属性更改时调用。|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|无窗口控件的处理 （而不是鼠标和键盘消息） 的窗口消息。|  
|[COleControl::ParentToClient](#parenttoclient)|将相对于容器的原点相对于控件的原点的点到点转换。|  
|[COleControl::PostModalDialog](#postmodaldialog)|通知容器有模式对话框已关闭。|  
|[COleControl::PreModalDialog](#premodaldialog)|通知将会显示一个模式对话框的容器。|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|销毁并重新创建该控件的窗口。|  
|[COleControl::Refresh](#refresh)|强制重新绘制控件的外观。|  
|[COleControl::ReleaseCapture](#releasecapture)|释放鼠标捕获。|  
|[COleControl::ReleaseDC](#releasedc)|释放无窗口控件的容器的显示设备上下文。|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|重置控制窗口的父级。|  
|[COleControl::ResetStockProps](#resetstockprops)|初始化`COleControl`常用属性为其默认值。|  
|[COleControl::ResetVersion](#resetversion)|初始化为给定值的版本号。|  
|[COleControl::ScrollWindow](#scrollwindow)|允许无窗口控件滚动显示屏上其处于就地活动映像内的一个区域。|  
|[COleControl::SelectFontObject](#selectfontobject)|选择到设备上下文的自定义的字体属性。|  
|[COleControl::SelectStockFont](#selectstockfont)|选择到设备上下文的堆栈 Font 属性。|  
|[COleControl::SerializeExtent](#serializeextent)|序列化或初始化该控件的显示空间。|  
|[COleControl::SerializeStockProps](#serializestockprops)|序列化或初始化`COleControl`常用属性。|  
|[COleControl::SerializeVersion](#serializeversion)|序列化或初始化该控件的版本信息。|  
|[COleControl::SetAppearance](#setappearance)|设置常用的外观属性的值。|  
|[COleControl::SetBackColor](#setbackcolor)|设置常用的 backcolor 属性的值。|  
|[COleControl::SetBorderStyle](#setborderstyle)|设置常用的边框样式属性的值。|  
|[COleControl::SetCapture](#setcapture)|导致该控件的容器窗口控件的代表将占用鼠标捕获。|  
|[COleControl::SetControlSize](#setcontrolsize)|设置位置和 OLE 控件的大小。|  
|[COleControl::SetEnabled](#setenabled)|设置股票 Enabled 属性的值。|  
|[COleControl::SetFocus](#setfocus)|使控件的容器的窗口，才能拥有输入焦点的控件的代表。|  
|[COleControl::SetFont](#setfont)|设置常用字体属性的值。|  
|[COleControl::SetForeColor](#setforecolor)|设置常用的前景色属性的值。|  
|[COleControl::SetInitialSize](#setinitialsize)|设置 OLE 控件容器中第一次显示的大小。|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|控件的已修改的状态更改。|  
|[COleControl::SetNotPermitted](#setnotpermitted)|指示编辑请求已失败。|  
|[Colecontrol:: Setnotsupported](#setnotsupported)|可防止对控件的属性值由用户修改。|  
|[COleControl::SetRectInContainer](#setrectincontainer)|设置相对于其容器的控件的矩形。|  
|[COleControl::SetText](#settext)|设置常用的文本或 Caption 属性的值。|  
|[Colecontrol:: Throwerror](#throwerror)|OLE 控件中发生错误的信号。|  
|[COleControl::TransformCoords](#transformcoords)|转换坐标容器与控件之间的值。|  
|[COleControl::TranslateColor](#translatecolor)|将转换**OLE_COLOR**值赋给**COLORREF**值。|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|确定是否环境属性才可在下次加载的控件。|  
|[COleControl::WindowProc](#windowproc)|提供有关 Windows 过程`COleControl`对象。|  
  
### <a name="protected-methods"></a>受保护的方法  
  
|名称|说明|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|在控件的外观需要更新时由框架调用。|  
|[COleControl::DrawMetafile](#drawmetafile)|在使用图元文件设备上下文时由框架调用。|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|启用自动化方法调用。|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|调用由框架来初始化该控件所支持的数据格式的列表。|  
  
## <a name="remarks"></a>备注  
 派生自`CWnd`，此类继承了 Windows 窗口对象的所有功能以及其他功能特定于 OLE，如事件触发和支持方法和属性的能力。  
  
 OLE 控件可以插入到 OLE 容器应用程序和使用的事件触发和公开的方法和属性添加到容器的双向系统，与容器进行通信。 请注意，标准 OLE 容器仅支持 OLE 控件的基本功能。 他们不能支持 OLE 控件的扩展的功能。 事件被发送到控件中发生某些操作，由于容器时发生事件触发。 反过来，该容器与控件通信通过使用一组公开的方法和属性类似于成员函数和 c + + 类数据成员。 此方法允许开发人员可以控制该控件的外观和某些操作发生时通知给容器。  
  
## <a name="windowless-controls"></a>无窗口控件  
 OLE 控件可以是无窗口的使用处于就地活动状态。 无窗口控件具有明显的优点︰  
  
-   无窗口控件可以透明而非矩形  
  
-   无窗口控件减少的对象的实例大小和创建时间  
  
 控件不需要一个窗口。 窗口提供的服务可轻松地提供通过一个共享的窗口 （通常是容器的） 和一些调度代码。 拥有一个窗口是主要必要这么复杂对象上。  
  
 使用无窗口激活时，容器 （它具有一个窗口） 将负责提供服务，否则将由控件自己的窗口提供。 例如，如果您的控件需要查询键盘焦点、 查询鼠标捕获，或获取设备上下文，由容器管理这些操作。 `COleControl`[无窗口操作成员函数](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)调用这些操作在容器上的。  
  
 启用无窗口激活后，容器委托输入到控件的消息`IOleInPlaceObjectWindowless`接口 (扩展名为[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)无窗口支持)。 `COleControl`此接口的实现将相应地调整鼠标坐标后分发通过您的控件的消息映射，这些消息。 可以通过将对应的条目添加到消息映射来处理普通窗口消息之类的这些消息。  
  
 在无窗口控件中，您应该始终使用`COleControl`成员函数而不是相应`CWnd`成员函数或其相关的 Windows API 函数。  
  
 仅当它们变为活动状态，但对于活动处于非活动状态的转换所需的工作量将进入并过渡的速度出现故障时，OLE 控件对象还可以创建一个窗口。 有某些情况下这是一个问题︰ 作为示例，请考虑一个文本框中的网格。 当向上或向下通过列的指针，每个控件必须是就地激活，然后停用。 非活动/活动过渡的速度将直接影响滚动的速度。  
  
 开发 OLE 控件框架的详细信息，请参阅文章[MFC ActiveX 控件](../../mfc/mfc-activex-controls.md)和[概述︰ 创建 MFC ActiveX 控件程序](../../mfc/reference/mfc-activex-control-wizard.md)。 有关优化 OLE 控件，包括无窗口和闪烁控件，请参阅[MFC ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>要求  
 **标头︰** afxctl.h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 返回环境的 backcolor 属性的值。  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>返回值  
 容器的环境背景色属性，如果有当前值。 如果不支持该属性，则此函数将返回系统定义的 Windows 背景色。  
  
### <a name="remarks"></a>备注  
 环境的 backcolor 属性可供所有控件，并定义由容器。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 可以向用户显示的错误消息中使用该容器已分配给控件的名称。  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>返回值  
 OLE 控件的名称。 默认值为零长度字符串。  
  
### <a name="remarks"></a>备注  
 请注意该容器不需要支持此属性。  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 返回环境的字体属性的值。  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>返回值  
 指向容器的环境字体的调度接口的指针。 默认值是**NULL**。 返回是否不等于**NULL**，您有责任字体释放通过调用其[iunknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317)成员函数。  
  
### <a name="remarks"></a>备注  
 环境的字体属性是由容器定义并可供所有控件。请注意该容器不需要支持此属性。  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 返回环境的前景色属性的值。  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>返回值  
 容器的环境前景色属性，如果有当前值。 如果不支持，此函数将返回系统定义的 Windows 文本颜色。  
  
### <a name="remarks"></a>备注  
 环境前景色属性可供所有控件，并定义由容器。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientlocaleid"></a>Colecontrol:: Ambientlocaleid  
 返回容器的区域设置 id。  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>返回值  
 容器的 LocaleID 属性，如果任何值。 如果不支持此属性，则此函数将返回 0。  
  
### <a name="remarks"></a>备注  
 该控件可以使用 LocaleID 以适应特定的区域设置其用户界面。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 检索控件对象的当前外观设置。  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>返回值  
 该控件的外观︰  
  
- **0**平面外观  
  
- **1** 3D 外观  
  
### <a name="remarks"></a>备注  
 调用此函数可检索的当前值**DISPID_AMBIENT_APPEARANCE**的控件属性。  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 返回由容器所用的单位类型。  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>返回值  
 一个包含容器的环境的 ScaleUnits 字符串。 如果不支持此属性，则此函数将返回一个零长度的字符串。  
  
### <a name="remarks"></a>备注  
 容器的环境 ScaleUnits 属性可以用于显示位置或维度，用选定的单元，例如缇还是按厘米标记。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 确定该容器是否允许要为其自身活动时显示抓取手柄的控件。  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>返回值  
 如果应显示抓取手柄，则非零值否则为 0。 如果不支持此属性，则此函数返回非零值。  
  
### <a name="remarks"></a>备注  
 请注意该容器不需要支持此属性。  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 确定该容器是否允许该控件以将它显示与阴影模式时用户界面活动。  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>返回值  
 非零，如果应显示的阴影的模式。否则为 0。 如果不支持此属性，则此函数返回非零值。  
  
### <a name="remarks"></a>备注  
 请注意该容器不需要支持此属性。  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 确定首选通过控件容器的环境的文本对齐方式。  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>返回值  
 容器的环境的文本对齐属性的状态。 如果不支持此属性，则此函数将返回 0。  
  
 以下是有效的返回值的列表︰  
  
|返回值|含义|  
|------------------|-------------|  
|0|常规的对齐方式 （数字转换为左侧的右侧，文本）。|  
|1|左对齐|  
|2|居中|  
|3|右对齐|  
  
### <a name="remarks"></a>备注  
 此属性可供所有嵌入的控件，并定义由容器。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 确定容器是否想要对用户界面操作做出响应的控件。  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>返回值  
 非零，如果控件应响应用户界面操作;否则为 0。 如果不支持此属性，则此函数将返回 0。  
  
### <a name="remarks"></a>备注  
 例如，容器可能设置为**TRUE**在设计模式下。  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 确定是否容器是处于设计模式还是用户模式。  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>返回值  
 如果容器是在用户模式，则为非零值否则为 0 （在设计模式下）。 如果不支持此属性，则此函数将返回 TRUE。  
  
### <a name="remarks"></a>备注  
 例如，容器可能设置为**FALSE**在设计模式下。  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 绑定的属性值已更改的信号。  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件绑定属性的调度 ID。  
  
### <a name="remarks"></a>备注  
 这必须每次设置的属性更改，即使在其中通过属性不进行更改的情况下的值的方法调用。 请特别注意绑定映射到成员变量的属性。 任何时候，只要此类成员变量更改，`BoundPropertyChanged`必须调用。  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 请求权限从`IPropertyNotifySink`接口来更改该控件提供的绑定的属性值。  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件绑定属性的调度 ID。  
  
### <a name="return-value"></a>返回值  
 非零，如果允许更改;否则为 0。 默认值为非零值。  
  
### <a name="remarks"></a>备注  
 如果权限被拒绝，控件必须不允许属性更改的值。 这可以通过忽略或未通过试图更改的属性值的操作。  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 将转换的坐标`pPoint`成父坐标。  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 OLE 控件在容器内的范围的指针。 不是工作区但整个控件包括边框及滚动条的区域。  
  
 `pPoint`  
 指针，指向要转换为父 （容器） 的坐标的 OLE 客户端区域点。  
  
### <a name="remarks"></a>备注  
 在输入`pPoint`是相对于原点 OLE 控件 （左上角的控件的客户端区域） 的工作区。 在输出`pPoint`是相对于父级 （左上角的容器） 的源。  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 如果它完全或部分被重叠的、 不透明对象覆盖，调整插入符号移动矩形。  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 在输入一个指向[RECT](../../mfc/reference/rect-structure1.md)结构，其中包含要进行调整的插入符号区域。 在输出时，调整后的插入符号的区域中，或**NULL**如果插入符号矩形完全覆盖。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 插入符号是闪烁的行、 块或通常指示位置插入文本或图形的位图。  
  
 无窗口对象无法安全地显示插入符号，而不首先检查是否插入符号移动部分或完全隐藏通过重叠对象。 为了实现这一点，可以使用对象`ClipCaretRect`以获取插入符号调整 （简化） 以确保它适合的剪辑区域。  
  
 创建插入符号的对象应提交的插入符号矩形`ClipCaretRect`和插入符号使用调整后的矩形。 如果完全隐藏的插入符号，则此方法将返回**FALSE**和插入符号不应显示在所有这种情况下。  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 构造 `COleControl` 对象。  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>备注  
 一般情况下不直接调用此函数。 而是 OLE 控件通常由其类工厂创建。  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 已更改的支持的控件的助记键集时调用此函数。  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>备注  
 在收到此通知，控件的容器获取新的助记键集通过调用[IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730)。 请注意，容器则不需要对此通知做出响应。  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 由框架调用后 （除非该事件处理程序已禁止显示的错误） 已处理常用的错误事件。  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>参数  
 *scode*  
 要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件︰ 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `lpszDescription`  
 报告的错误的说明。  
  
 *lpszSource*  
 生成错误 （通常情况下，OLE 控件模块的名称） 的模块的名称。  
  
 `lpszHelpFile`  
 包含说明的错误的帮助文件的名称。  
  
 `nHelpID`  
 要报告的错误的帮助上下文 ID。  
  
### <a name="remarks"></a>备注  
 默认行为是︰ 显示消息框中包含的说明中包含的错误的`lpszDescription`。  
  
 重写此函数可自定义错误的显示方式。  
  
##  <a name="doclick"></a>COleControl::DoClick  
 模拟鼠标单击控件上的操作。  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>备注  
 可重写`COleControl::OnClick`将调用成员函数，和常用 Click 事件将触发，如果控件支持的。  
  
 此函数支持通过`COleControl`基类作为调用 DoClick 的常用方法。 有关详细信息，请参阅文章[ActiveX 控件︰ 方法](../../mfc/mfc-activex-controls-methods.md)。  
  
##  <a name="dopropexchange"></a>COleControl::DoPropExchange  
 由框架加载或存储从持久性存储区表示形式，如流或属性的一组控件时调用。  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 一个指向`CPropExchange`对象。 框架提供了此对象以建立属性交换上下文，包括其方向。  
  
### <a name="remarks"></a>备注  
 此函数通常会调用**PX_**系列函数加载或存储的 OLE 控件的特定用户定义属性。  
  
 如果控件向导用于创建 OLE 控件项目，此函数的重写的版本将序列化支持的常用属性`COleControl`为基类函数的调用`COleControl::DoPropExchange`。 当您将需要修改此函数可序列化新属性的 OLE 控件中添加用户定义的属性。 序列化的详细信息，请参阅文章[ActiveX 控件︰ 序列化](../../mfc/mfc-activex-controls-serializing.md)。  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 重绘具有已通过 Windows 控件子类化的 OLE 控件。  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 指向控件容器的设备上下文的指针。  
  
 `rcBounds`  
 控件将在其中绘制区域。  
  
### <a name="remarks"></a>备注  
 调用此函数可正确处理非活动的 OLE 控件的绘制。 如果 OLE 控件子类化 Windows 控件，并且应调用，只应使用此函数`OnDraw`控件的函数。  
  
 此函数和 Windows 控件子类化的详细信息，请参阅文章[ActiveX 控件︰ 子类化 Windows 控件](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)。  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 在控件的外观需要更新时由框架调用。  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 指向设备上下文的指针。  
  
 `rc`  
 要在中绘制的矩形区域。  
  
### <a name="remarks"></a>备注  
 此函数将直接调用可重写`OnDraw`函数。  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 在使用图元文件设备上下文时由框架调用。  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 图元文件设备上下文的指针。  
  
 `rc`  
 要在中绘制的矩形区域。  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 启用 OLE 控件的简单框架特性。  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>备注  
 这一特性允许控件以支持 visual 包含其他控件，但事实并非如此的 OLE 包容。 示例将具有多个控件内的组框。 这些控件不是 OLE 包含，但它们在同一组框中。  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 序列化或初始化该控件的作用域的状态 (在其尺寸**HIMETRIC**单位)。  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 一个指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象。 框架提供了此对象以建立属性交换上下文，包括其方向。  
  
### <a name="return-value"></a>返回值  
 如果该函数成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现正常情况下调用此函数`COleControl::DoPropExchange`。  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 序列化或初始化该控件的常用属性的状态。  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 一个指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象。 框架提供了此对象以建立属性交换上下文，包括其方向。  
  
### <a name="remarks"></a>备注  
 默认实现正常情况下调用此函数`COleControl::DoPropExchange`。  
  
##  <a name="exchangeversion"></a>COleControl::ExchangeVersion  
 序列化或初始化控件的版本信息的状态。  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 一个指向`CPropExchange`对象。 框架提供了此对象以建立属性交换上下文，包括其方向。  
  
 `dwVersionDefault`  
 该控件的当前版本号。  
  
 `bConvert`  
 指示是否应将持久性数据转换为新格式保存，或已加载的格式相同维护时。  
  
### <a name="return-value"></a>返回值  
 成功，则该函数的非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 通常，这将是第一个函数调用的控件的重写`COleControl::DoPropExchange`。 在加载时，此函数读取永久数据的版本号和设置的版本属性[CPropExchange](../../mfc/reference/cpropexchange-class.md)相应对象。 在保存时，此函数会写入持久性数据的版本号。  
  
 持久性和版本控制的详细信息，请参阅文章[ActiveX 控件︰ 序列化](../../mfc/mfc-activex-controls-serializing.md)。  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 活动控件上方单击鼠标时由框架调用。  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 对于自动触发 Click 事件发生，该控件的事件映射必须具有常用 Click 事件定义。  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 当鼠标位于双击活动控件时由框架调用。  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 用于自动触发的 DblClick 事件发生的该控件的事件映射必须具有定义的常用 DblClick 事件。  
  
##  <a name="fireerror"></a>COleControl::FireError  
 激发股票的错误事件。  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>参数  
 *scode*  
 要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件︰ 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `lpszDescription`  
 报告的错误的说明。  
  
 `nHelpID`  
 报告的错误的帮助 ID。  
  
### <a name="remarks"></a>备注  
 此事件提供了一种信令您的控件中发生错误，在您的代码中的适当位置。 与其他常用事件，如 Click 或 MouseMove 不同错误永远不会引发由框架中。  
  
 若要在属性获取函数、 属性集函数或自动化方法过程中发生的错误报告，请调用[colecontrol:: Throwerror](#throwerror)。  
  
 实现 OLE 控件的事件使用的股票错误`SCODE`值。 如果您的控件使用此事件，并旨在在 Visual Basic 4.0 一起使用，您将收到错误，因为`SCODE`Visual Basic 中不支持值。  
  
 若要解决此问题，手动更改`SCODE`中控件的参数。ODL 文件**长**。 此外，任何自定义事件、 方法或属性，它使用`SCODE`参数还会导致具有同样的问题。  
  
##  <a name="fireevent"></a>COleControl::FireEvent  
 激发您的控件与任意数量的可选参数，从用户定义的事件。  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 要激发的事件调度 ID。  
  
 `pbParams`  
 该事件的参数类型描述符。  
  
### <a name="remarks"></a>备注  
 通常应该不直接调用此函数。 而是将控件的类声明的事件映射节中调用事件触发函数。  
  
 `pbParams`参数是以空格分隔的列表**VTS_**。 其中一个或多个值（由空格（而不是逗号）分隔）指定函数的参数列表。 可能的值如下：  
  
|符号|参数类型|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  其他变体常量已定义对于所有的 variant 类型的值类型，除了**VTS_FONT**和**VTS_PICTURE**，它们提供了指向的变量数据常量的指针。 使用命名这些常量**VTS_P** `constantname`约定。 例如， **VTS_PCOLOR**是一个指向**VTS_COLOR**常量。  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 当控件处于活动状态的 UI，按下某个键时由框架调用。  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `pnChar`  
 为虚拟键代码值的按下的键的指针。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 用于自动触发的 KeyDown 事件发生的该控件的事件映射必须具有定义的常用 KeyDown 事件。  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 当按下某个键并将其发布自定义控件处于 UI 活动状态容器中时由框架调用。  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>参数  
 `pnChar`  
 指向所按的键的字符值的指针。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 该事件的接收方可能会修改`pnChar`，例如，将所有小写字符转换为大写。 如果你想要检查修改后的字符，重写`OnKeyPressEvent`。  
  
 用于自动触发的 KeyPress 事件发生的该控件的事件映射必须具有定义的常用 KeyPress 事件。  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 当自定义控件处于 UI 活动状态的容器内释放某个键时由框架调用。  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `pnChar`  
 指向已发布的项的虚拟键代码值的指针。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 用于自动触发的 KeyUp 事件发生的该控件的事件映射必须具有定义的常用 KeyUp 事件。  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 活动的自定义控件上按下鼠标按钮时由框架调用。  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>参数  
 `nButton`  
 已按下鼠标按钮的数字值。 它可以包含下列值之一︰  
  
- **LEFT_BUTTON**按下鼠标左键了。  
  
- **MIDDLE_BUTTON**按下鼠标按钮了。  
  
- **RIGHT_BUTTON**按下鼠标右键按钮了。  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
 *x*  
 游标时按下鼠标按钮了 x 坐标。 坐标是相对于控件窗口的左上角。  
  
 *y*  
 游标时按下鼠标按钮了 y 坐标。 坐标是相对于控件窗口的左上角。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 用于自动触发的 MouseDown 事件发生的该控件的事件映射必须具有定义的常用 MouseDown 事件。  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 当光标移到活动的自定义控件由框架调用。  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>参数  
 `nButton`  
 已按下鼠标按钮的数字值。 包含以下值的组合︰  
  
- **LEFT_BUTTON**操作期间按下鼠标左键了。  
  
- **MIDDLE_BUTTON**操作期间按下鼠标按钮了。  
  
- **RIGHT_BUTTON**操作期间按下鼠标右键按钮了。  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
 *x*  
 光标的 x 坐标。 坐标是相对于控件窗口的左上角。  
  
 *y*  
 光标的 y 坐标。 坐标是相对于控件窗口的左上角。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 用于自动触发的 MouseMove 事件发生的该控件的事件映射必须具有定义的常用 MouseMove 事件。  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 当在活动的自定义控件上释放鼠标按钮时由框架调用。  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>参数  
 `nButton`  
 释放鼠标按钮的数值。 它可以具有下列值之一︰  
  
- **LEFT_BUTTON**已松开了鼠标按钮。  
  
- **MIDDLE_BUTTON**已松开了鼠标按钮。  
  
- **RIGHT_BUTTON**已松开了鼠标右键按钮。  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
 *x*  
 游标释放鼠标按钮时的 x 坐标。 坐标是相对于控件窗口的左上角。  
  
 *y*  
 游标释放鼠标按钮时的 y 坐标。 坐标是相对于控件窗口的左上角。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，您确定何时引发该事件。  
  
 用于自动触发的 MouseUp 事件发生的该控件的事件映射必须具有定义的常用 MouseUp 事件。  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 一个与控件的就绪状态的当前值的事件的激发。  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>备注  
 就绪状态可以是下列值之一︰  
  
 **READYSTATE_UNINITIALIZED**  
 默认值初始化状态  
  
 **READYSTATE_LOADING**  
 控件当前正在加载它的属性  
  
 **READYSTATE_LOADED**  
 初始化控件  
  
 **READYSTATE_INTERACTIVE**  
 在控件有数据不足，无法进行交互，但不是所有异步数据尚未加载  
  
 `READYSTATE_COMPLETE`  
 控件具有其所有数据  
  
 使用[GetReadyState](#getreadystate)来确定控件的当前的准备情况。  
  
 [InternalSetReadyState](#internalsetreadystate)就绪状态更改为值提供，则调用`FireReadyStateChange`。  
  
##  <a name="getactivationpolicy"></a>COleControl::GetActivationPolicy  
 更改支持的控件的默认激活行为`IPointerInactive`接口。  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>返回值  
 中的标志组合**POINTERINACTIVE**枚举。 可能的标志为︰  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 该对象应该是就地激活时鼠标进入其鼠标移动操作过程。  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 当鼠标离开鼠标移动操作过程的对象，则应停用该对象。  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 该对象应该就地激活时在拖动过程将鼠标拖到它并删除操作。  
  
### <a name="remarks"></a>备注  
 当`IPointerInactive`启用接口，容器会将委托`WM_SETCURSOR`和`WM_MOUSEMOVE`发送到它的消息。 `COleControl`此接口的实现将相应地调整鼠标坐标后分发通过您的控件的消息映射，这些消息。  
  
 当容器接收`WM_SETCURSOR`或`WM_MOUSEMOVE`鼠标指针放在处于非活动状态的对象支持消息`IPointerInactive`，则应调用`GetActivationPolicy`上的接口和返回标志从**POINTERINACTIVE**枚举。  
  
 可以通过将对应的条目添加到消息映射来处理普通窗口消息，就像这些消息。 在您的处理程序，避免使用`m_hWnd`成员变量 （或使用它的任何成员函数） 而不必首先检查它的值是否非**NULL**。  
  
 任何对象用于执行多个设置将鼠标光标和/或触发鼠标移动事件，如同时提供特殊可视反馈，应返回**POINTERINACTIVE_ACTIVATEONENTRY**标志，并绘制仅在活动时的反馈。 如果该对象返回此标志，容器应立即将其在就地激活，然后将其转发相同的消息，将触发对调用`GetActivationPolicy`。  
  
 如果两个**POINTERINACTIVE_ACTIVATEONENTRY**和**POINTERINACTIVE_DEACTIVATEONLEAVE**又重新标志，则当鼠标悬停于对象时才会激活该对象。 如果只**POINTERINACTIVE_ACTIVATEONENTRY**返回标志，则当鼠标第一次进入该对象后，才会激活该对象。  
  
 您可能还要不活动的控件，从而显著作为目标的 OLE 拖放操作。 这要求用户将对象拖动到它上面，时刻激活控件，以便可以将该控件的窗口注册为放置目标。 若要使能够在拖动过程进行激活，返回**POINTERINACTIVE_ACTIVATEONDRAG**标志︰  
  
 [!code-cpp[NVC_MFCAxCtl #&1;](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 通过传递通知信息`GetActivationPolicy`容器不应缓存。 相反，每次鼠标进入非活动状态的对象时，应调用此方法。  
  
 如果不请求处于非活动状态的对象不是就地激活时鼠标进入它，它的容器应调度后续`WM_SETCURSOR`发送到通过调用此对象的消息[OnInactiveSetCursor](#oninactivesetcursor) ，只要将鼠标指针悬停在对象上保持。  
  
 启用`IPointerInactive`界面通常意味着所需控件，使其能够在任何时候处理鼠标消息。 不支持的容器中获取此行为，`IPointerInactive`接口，您将需要使控件始终激活时可见，这意味着该控件应具有**OLEMISC_ACTIVATEWHENVISIBLE**其各种标志中的标志。 但是，若要防止此标志从生效的容器中，支持`IPointerInactive`，您还可以指定**OLEMISC_IGNOREACTIVATEWHENVISIBLE**标志︰  
  
 [!code-cpp[NVC_MFCAxCtl #&10;](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl::GetAmbientProperty  
 获取容器的环境属性的值。  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>参数  
 *dwDispid*  
 所需的环境属性的调度 ID。  
  
 `vtProp`  
 指定要在中返回的值的类型的 variant 类型标记`pvProp`。  
  
 `pvProp`  
 指向将接收的属性值或返回值的变量的地址的指针。 This 指针的实际类型必须与指定的类型匹配`vtProp`。  
  
|vtProp|PvProp 的类型|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**短\***|  
|`VT_I4`|**长时间\***|  
|`VT_R4`|**float\***|  
|`VT_R8`|**双精度\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>返回值  
 如果支持环境的属性，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 如果您使用`GetAmbientProperty`若要检索的环境的 DisplayName 和 ScaleUnits 属性，请设置`vtProp`到`VT_BSTR`和`pvProp`到**CString\***。 如果要检索的环境的字体属性，设置`vtProp`到**VT_FONT**和`pvProp`到**LPFONTDISP\***。  
  
 请注意，已提供了函数的常见环境的属性，如[AmbientBackColor](#ambientbackcolor)和[AmbientFont](#ambientfont)。  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 实现控件的常用外观属性的 Get 函数。  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>返回值  
 返回的值指定为当前的外观设置**短**( `VT_I2`) 值，如果操作成功。 如果该控件的外观是平面和 1 控件的外观具有三维，则此值为零。  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 实现控件的常用的 backcolor 属性 Get 函数。  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>返回值  
 返回的值指定为当前的背景色**OLE_COLOR**值，如果操作成功。 此值可以转换为**COLORREF**值通过调用`TranslateColor`。  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 实现控件的常用 borderstyle 属性 Get 函数。  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>返回值  
 如果该控件具有普通边框; 则为 1如果该控件具有无边框，则为 0。  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 确定是否`COleControl`对象具有鼠标捕获。  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>返回值  
 如果该控件已激活并无窗口，将返回**这**如果控件当前具有鼠标捕获 （这是由该控件的容器），或**NULL**如果它不具有捕获。  
  
 否则，返回`CWnd`具有鼠标捕获的对象 (与相同`CWnd::GetCapture`)。  
  
### <a name="remarks"></a>备注  
 激活的无窗口控件接收到鼠标捕获时[SetCapture](#setcapture)调用。  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 由框架来检索该控件的 OLE 类 ID 调用。  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>参数  
 *则*  
 指针的位置的类 id。  
  
### <a name="return-value"></a>返回值  
 如果调用未成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 通常由[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)。  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 检索控件的矩形区域的左上的角和其工作区的左上的角之间的差异。  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>参数  
 *pdxOffset*  
 为 OLE 控件的客户端区域的水平偏移量的指针。  
  
 *pdyOffset*  
 为 OLE 控件的客户端区域的垂直偏移量的指针。  
  
### <a name="remarks"></a>备注  
 OLE 控件具有在其容器内的矩形区域。 该控件的客户端区域是不包括边框及滚动条的控件区域。 检索偏移量`GetClientOffset`是控件的矩形区域的左上的角和其工作区的左上的角的区别。 如果控件具有非客户端元素以外的标准边框和滚动条，重写该成员函数以指定偏移量。  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 检索控件的工作区的大小。  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向`RECT`结构，它包含无窗口控件的客户端区域的尺寸; 即，该控件的大小减去窗口边框、 框架、 滚动条，等等。 `lpRect`参数指示该控件的客户端矩形，而非其位置的大小。  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 将查询一个对象，用于指向其当前的客户端站点，在其容器内的指针。  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>返回值  
 指向控件的当前客户端站点中其容器的指针。  
  
### <a name="remarks"></a>备注  
 返回的指针指向的一个实例`IOleClientSite`。 `IOleClientSite`由容器实现的接口是其上下文的对象的视图︰ 其定位在文档中，它获取它的存储、 用户界面和其他资源的位置。  
  
##  <a name="getcontrolflags"></a>COleControl::GetControlFlags  
 检索控件标志设置。  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>返回值  
 ControlFlags 枚举中的标志且组合︰  
  
 `enum ControlFlags {`  
  
 `fastBeginPaint = 0x0001,`  
  
 `clipPaintDC = 0x0002,`  
  
 `pointerInactive = 0x0004,`  
  
 `noFlickerActivate = 0x0008,`  
  
 `windowlessActivate = 0x0010,`  
  
 `canOptimizeDraw = 0x0020,`  
  
 `};`  
  
### <a name="remarks"></a>备注  
 默认情况下，`GetControlFlags`返回`fastBeginPaint | clipPaintDC`。  
  
 `fastBeginPaint`  
 如果设置，请使用 begin 画图函数适合而不是 OLE 控件[BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API （默认设置）。  
  
 `clipPaintDC`  
 如果未设置，将禁用对调用`IntersectClipRect`所做的`COleControl`并获得小的速度优势。 如果使用无窗口激活，则该标志无效。  
  
 `pointerInactive`  
 如果设置，则提供鼠标交互，而您的控件处于非活动状态的通过启用`COleControl`的实现`IPointerInactive`接口，它默认处于禁用状态。  
  
 `noFlickerActivate`  
 如果设置，可以消除额外绘图操作和伴随的可视闪烁。 当您的控件绘制自身以相同的方式处于非活动和活动状态时使用。 如果使用无窗口激活，则该标志无效。  
  
 `windowlessActivate`  
 如果设置，则表示您的控件将使用无窗口激活。  
  
 `canOptimizeDraw`  
 如果设置，则指示该控件将执行优化的绘图，如果该容器支持它。  
  
 有关详细信息`GetControlFlags`和其他优化 OLE 控件，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 检索 OLE 控件窗口的大小。  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>参数  
 *pcx*  
 以像素为单位指定控件的宽度。  
  
 *pcy*  
 以像素为单位指定控件的高度。  
  
### <a name="remarks"></a>备注  
 请注意，用于控制 windows 的所有坐标都都相对于控件的左上角。  
  
##  <a name="getdc"></a>COleControl::GetDC  
 提供无窗口对象来获取 screen （或兼容） 设备上下文从其容器。  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>参数  
 *lprcRect*  
 无窗口控件的矩形的指针想要重绘该控件的工作区坐标中。 **NULL**意味着完整对象的扩展盘区。  
  
 `dwFlags`  
 图形设备上下文的属性。 选项包括︰  
  
- **OLEDC_NODRAW**指示该对象不会使用的设备上下文执行任何绘图，但只使获取有关显示设备的信息。 容器应只是将窗口的 DC，而不再进一步处理。  
  
- **OLEDC_PAINTBKGND**请求容器返回 DC 之前绘制背景。 一个对象应使用此标志，如果它正在请求 DC 重新绘制带有透明背景的区域。  
  
- **OLEDC_OFFSCREEN**通知对象想要呈现到屏幕外位图，然后复制到屏幕的容器。 如果绘制它即将执行的操作会生成大量的闪烁，对象应使用此标志。 容器可以自由地或不遵循此请求。 但是，如果未设置此标志，该容器必须退回屏幕 DC。 这样就可以执行直接屏幕操作，如显示所选内容的对象 (通过**异或**操作)。  
  
### <a name="return-value"></a>返回值  
 指向容器的显示设备上下文指针`CWnd`工作区如果成功，否则为返回值是**NULL**。 显示设备上下文可以在后续的 GDI 函数中，用于在容器的窗口的工作区中进行绘制。  
  
### <a name="remarks"></a>备注  
 [ReleaseDC](#releasedc)必须调用成员函数来绘制后释放上下文。 在调用时`GetDC`，对象将传递在想要在其自己的工作区坐标中绘制到的矩形。 `GetDC`将转换为容器客户端区域的坐标。 该对象应该不会请求所需的绘制矩形大于其自己的客户端区域矩形，可以通过检索它的大小[GetClientRect](#getclientrect)。 这可防止无意中绘制，也不应为对象。  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 实现控件的股票 Enabled 属性的 Get 函数。  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>返回值  
 如果启用该控件，则非零值否则为 0。  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 获取指向由表示使用扩展的一组属性的控件的容器维护的对象的指针。  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>返回值  
 一个指向容器的扩展控件对象。 如果没有可用的对象，则值是**NULL**。  
  
 此对象可能会通过操纵其`IDispatch`接口。 您还可以使用`QueryInterface`以获取对象提供的其他可用的接口。 但是，该对象不需要支持一组特定的接口。 请注意，依赖于容器的扩展的控件对象的特定功能限制的可移植性控件与其他任意容器。  
  
### <a name="remarks"></a>备注  
 调用此函数的函数负责释放时已完成，但该对象的指针。 请注意该容器不需要支持此对象。  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 确定是否`COleControl`对象具有焦点。  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>返回值  
 如果该控件已激活并无窗口，将返回**这**如果控件当前已经有键盘焦点 （这是由该控件的容器），或**NULL**如果不具有焦点。  
  
 否则，返回`CWnd`具有焦点的对象 (与相同`CWnd::GetFocus`)。  
  
### <a name="remarks"></a>备注  
 激活的无窗口控件获得焦点时[SetFocus](#setfocus)调用。  
  
##  <a name="getfont"></a>COleControl::GetFont  
 实现常用字体属性的 Get 函数。  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>返回值  
 指向控件的常用字体属性的字体调度接口的指针。  
  
### <a name="remarks"></a>备注  
 请注意，调用方必须释放对象时完成。 在控件实现中，使用`InternalGetFont`访问控件的股票 Font 对象。 在您的控件中使用字体的详细信息，请参阅文章[ActiveX 控件︰ 使用 ActiveX 控件中的字体](../../mfc/mfc-activex-controls-using-fonts.md)。  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 测量一次文本度量值的任何`CFontHolder`拥有该控件的对象。  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>参数  
 `lptm`  
 指向[TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132)结构。  
  
 `fontHolder`  
 引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象。  
  
### <a name="remarks"></a>备注  
 可以使用选择这种字体[COleControl::SelectFontObject](#selectfontobject)函数。 `GetFontTextMetrics`将初始化`TEXTMETRIC`指向结构`lptm`有效度量值有关的信息`fontHolder`的字体，如果成功，或用零填充该结构，如果未成功。 应使用此函数，而不是[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)何时绘制控件，因为控件，像任何嵌入 OLE 对象，可能需要以将自身渲染到图元文件。  
  
 `TEXTMETRIC`结构的默认字体是刷新时[SelectFontObject](#selectfontobject)调用函数。 应调用`GetFontTextMetrics`唯一后选择的堆栈 Font 属性，以确保它提供的信息是否有效。  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 实现常用的前景色属性的 Get 函数。  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>返回值  
 返回的值指定为当前的前景颜色**OLE_COLOR**值，如果操作成功。 此值可以转换为[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)值通过调用`TranslateColor`。  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 实现常用 hWnd 属性的 Get 函数。  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>返回值  
 OLE 控件的窗口句柄，如果有的话;否则为**NULL**。  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 由框架调用以获得一个短的字符串，描述由标识的菜单项的目的`nID`。  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>参数  
 `nID`  
 菜单项 id。  
  
 `rMessage`  
 对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)通过返回一个字符串对象。  
  
### <a name="remarks"></a>备注  
 这可以用于获取在状态栏中显示一条消息，在突出显示的菜单项。 默认实现将尝试加载由标识的字符串资源`nID`。  
  
##  <a name="getnotsupported"></a>Colecontrol:: Getnotsupported  
 由用户控件的属性值将阻止访问。  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>备注  
 调用此函数来代替任何属性的 Get 函数检索由该控件的用户的属性不支持的位置。 例如，可以是只写属性。  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 返回控件的准备工作状态。  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>返回值  
 准备就绪状态的控件，下列值之一︰  
  
 **READYSTATE_UNINITIALIZED**  
 默认值初始化状态  
  
 **READYSTATE_LOADING**  
 控件当前正在加载它的属性  
  
 **READYSTATE_LOADED**  
 初始化控件  
  
 **READYSTATE_INTERACTIVE**  
 在控件有数据不足，无法进行交互，但不是所有异步数据尚未加载  
  
 `READYSTATE_COMPLETE`  
 控件具有其所有数据  
  
### <a name="remarks"></a>备注  
 大多数简单控件永远不需要区分**LOADED**和`INTERACTIVE`。 但是，支持的数据路径属性的控件可能无法准备好进行交互，直到异步接收至少部分数据。 控件应尝试尽可能快地变为交互模式。  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 获取相对于容器，用设备单位表示控件的矩形的坐标。  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向控件的坐标将复制到其中的矩形结构的指针。  
  
### <a name="return-value"></a>返回值  
 非零，如果该控件是处于就地活动状态;否则为 0。  
  
### <a name="remarks"></a>备注  
 该矩形才有效，如果该控件是处于就地活动状态。  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 度量值的控件的常用字体属性，它可以使用选择的文本标准[SelectStockFont](#selectstockfont)函数。  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>参数  
 `lptm`  
 一个指向[TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132)结构。  
  
### <a name="remarks"></a>备注  
 `GetStockTextMetrics`函数将初始化`TEXTMETRIC`指向结构`lptm`带有效的度量值信息，如果成功或填充了零，如果未成功的结构。 使用此函数，而不是[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)何时绘制控件，因为控件，像任何嵌入 OLE 对象，可能需要以将自身渲染到图元文件。  
  
 `TEXTMETRIC`结构的默认字体是刷新时`SelectStockFont`调用函数。 仅选择股票的字体，以确保它提供的信息有效后，应调用此函数。  
  
##  <a name="gettext"></a>COleControl::GetText  
 实现常用的文本或 Caption 属性的 Get 函数。  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>返回值  
 控制文本字符串或如果不有任何字符串长度为零的字符串的当前值。  
  
> [!NOTE]
>  有关详细信息`BSTR`数据类型，请参阅[数据类型](../../mfc/reference/data-types-mfc.md)宏和全局函数部分中。  
  
### <a name="remarks"></a>备注  
 请注意，此函数的调用方必须调用`SysFreeString`对字符串返回为了免费资源。 在控件实现中，使用`InternalGetText`访问控件的常用文本或 Caption 属性。  
  
##  <a name="getwindowlessdroptarget"></a>Colecontrol:: Getwindowlessdroptarget  
 重写`GetWindowlessDropTarget`时您希望无窗口控件的目标的 ole 拖放操作。  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>返回值  
 指向对象的指针`IDropTarget`接口。 由于它不具有一个窗口，无窗口对象无法注册`IDropTarget`接口。 但是，若要参与拖放，无窗口对象可以仍然实现接口并返回在`GetWindowlessDropTarget`。  
  
### <a name="remarks"></a>备注  
 通常，这需要将该控件的窗口注册为放置目标。 但是，由于该控件没有自己的窗口，容器将用作其自己的窗口拖放目标。 该控件只需提供的实现`IDropTarget`接口向其容器可以委托调用在适当的时间。 例如:   
  
 [!code-cpp[NVC_MFCAxCtl #&2;](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 通知将使用该控件的 Iid 的基类。  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>参数  
 *piidPrimary*  
 指向控件的主要的调度接口的接口 ID 的指针。  
  
 *piidEvents*  
 指向控件的事件接口的接口 ID 的指针。  
  
### <a name="remarks"></a>备注  
 调用此函数在控件的构造函数来通知的接口 Id，将使用您的控件的基类。  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 访问您的控件的堆栈 Font 属性  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>返回值  
 对引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象，其中包含股票 Font 对象。  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 访问您的控件的常用文本或 Caption 属性。  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>返回值  
 对控件的文本字符串的引用。  
  
##  <a name="internalsetreadystate"></a>Colecontrol:: Internalsetreadystate  
 设置控件的准备工作状态。  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>参数  
 *lNewReadyState*  
 要设置该控件，下列值之一的准备工作状态︰  
  
 **READYSTATE_UNINITIALIZED**  
 默认值初始化状态  
  
 **READYSTATE_LOADING**  
 控件当前正在加载它的属性  
  
 **READYSTATE_LOADED**  
 初始化控件  
  
 **READYSTATE_INTERACTIVE**  
 在控件有数据不足，无法进行交互，但不是所有异步数据尚未加载  
  
 `READYSTATE_COMPLETE`  
 控件具有其所有数据  
  
### <a name="remarks"></a>备注  
 大多数简单控件永远不需要区分**LOADED**和`INTERACTIVE`。 但是，支持的数据路径属性的控件可能无法准备好进行交互，直到异步接收至少部分数据。 控件应尝试尽可能快地变为交互模式。  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 强制控件重绘自身。  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向要失效的控件区域的指针。  
  
 `bErase`  
 指定在更新区域内的背景是否处理更新区域时将被清除。  
  
### <a name="remarks"></a>备注  
 如果`lpRect`具有**NULL**值，将重新绘制整个控件。 如果`lpRect`不是**NULL**，这表示控件的矩形，它是无效的部分。 在其中控件没有窗口或当前未处于活动状态，该矩形将忽略，并且调用客户端站点的情况下[IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337)成员函数。 使用此函数，而不是`CWnd::InvalidateRect`或`InvalidateRect`。  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 使容器窗口中的给定区域内的客户端区域无效。  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `pRgn`  
 一个指向[CRgn](../../mfc/reference/crgn-class.md)对象，用于标识要使之无效，在包含窗口的工作区坐标中的 OLE 对象的显示区域。 如果此参数为**NULL**，范围是整个对象。  
  
 `bErase`  
 指定是否要删除无效的区域内的背景。 如果**TRUE**，后台将被删除。 如果**FALSE**，后台将保持不变。  
  
### <a name="remarks"></a>备注  
 这可以用于重绘容器内的无窗口控件。 无效的区域，以及所有其他区域中的更新区域中，做标记以绘制时进行下一步[WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213)发送消息。  
  
 如果`bErase`是**TRUE**更新区域的任何部分，在整个区域中，而不仅仅是在给定的部分中，背景将被删除。  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 允许 OLE 控件的专用的加载。  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>返回值  
 要转换成控件; 如果非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 当转换使用 VBX 的窗体控件添加到另一个使用 OLE 控件时，OLE 控件的特殊加载代码可能需要。 例如，如果您正在加载您的 OLE 控件的实例，则可能必须调用[PX_Font](persistence-of-ole-controls.md#px_font)中您`DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl #&3;](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 将 VBX 控件不具有一个 Font 对象; 但是，已单独保存每个字体属性。 在这种情况下，您将使用`IsConvertingVBX`来区分这两种情况︰  
  
 [!code-cpp[NVC_MFCAxCtl #&4;](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 另一种情况是如果您将 VBX 控件中保存专有的二进制数据 (在其**VBM_SAVEPROPERTY**消息处理程序)，并 OLE 控件将其二进制数据保存在另一种格式。 如果您希望您的 OLE 控件要具有将 VBX 控件向后兼容，无法读取使用的这两种旧的和新格式`IsConvertingVBX`函数进行区分是否将 VBX 控件或 OLE 控件正在加载了。  
  
 在控件的`DoPropExchange`函数，您可以检查此条件并如果为 true，执行加载代码特定于这种转换 （如前面的示例中）。 如果不转换该控件，您可以执行正常的负载代码。 此功能仅适用于将 VBX 对应项要转换的控件。  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 启用自动化方法调用。  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>返回值  
 非零，如果控件已经初始化;否则为 0。  
  
### <a name="remarks"></a>备注  
 框架的实现**idispatch:: Invoke**调用**IsInvokeAllowed**以确定给定函数 (由标识`dispid`) 可能会调用。 OLE 控件的默认行为是允许要调用仅当控件已经初始化; 自动化方法但是， **IsInvokeAllowed**是一个虚函数并且可能会被重写如有必要 （例如，当控件使用为自动化服务器）。 有关详细信息，请参阅知识库文章 Q166472，"如何︰ 使用 OLE 控件作为自动化服务器。" 知识库文章可在 MSDN 库的 Visual Studio 文档中或在[http://support.microsoft.com](http://support.microsoft.com/)。  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 确定控件的状态是否已被修改。  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>返回值  
 非零，如果自上次保存; 已被修改控件的状态否则为 0。  
  
### <a name="remarks"></a>备注  
 当属性值更改时，则修改控件的状态。  
  
##  <a name="isoptimizeddraw"></a>Colecontrol:: Isoptimizeddraw  
 确定容器是否支持当前的绘制操作优化的绘图。  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>返回值  
 **TRUE**容器支持优化绘制当前绘图操作; 否则为如果**FALSE**。  
  
### <a name="remarks"></a>备注  
 如果支持优化的绘图，然后控件需要时，选择旧对象 （钢笔、 画笔、 字体、 等） 到设备上下文完成绘图。  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 由框架来确定是否控件子类化 Windows 控件调用。  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>返回值  
 非零，如果该控件进行子类化;否则为 0。  
  
### <a name="remarks"></a>备注  
 必须重写此函数并返回**TRUE**如果您的 OLE 控件子类化 Windows 控件。  
  
##  <a name="load"></a>COleControl::Load  
 重置所有以前的数据以异步方式加载并启动新加载的控件的异步属性。  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>参数  
 *strNewPath*  
 指向包含引用的异步控件属性的绝对位置路径的字符串的指针。  
  
 *prop*  
 一个[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)实现异步控件属性的对象。  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 防止容器停用您的控件。  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>参数  
 `bLock`  
 **TRUE**处于就地活动状态的控件是否被锁定;**FALSE**是否要取消锁定它。  
  
### <a name="return-value"></a>返回值  
 如果锁定成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 请注意必须与该控件在完成后解锁成对每个控件的锁定。 您应该仅锁定您的控件短时间内，如触发事件时。  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 容器的环境属性已更改值时由框架调用。  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>参数  
 *dispID*  
 发生更改时，环境属性的调度 ID 或**DISPID_UNKNOWN**如果多个属性已更改。  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 当该股票的外观属性值发生更改时由框架调用。  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>备注  
 如果您希望通知时此属性更改后的，重写此函数。 默认实现调用`InvalidateControl`。  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 常用的 backcolor 属性值已更改时由框架调用。  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>备注  
 如果您希望通知时此属性更改后的，重写此函数。 默认实现调用`InvalidateControl`。  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 当该股票的边框样式属性值发生更改时由框架调用。  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`InvalidateControl`。  
  
 如果您希望通知时此属性更改后的，重写此函数。  
  
##  <a name="onclick"></a>COleControl::OnClick  
 已单击鼠标按钮或调用 DoClick 股票方法时由框架调用。  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>参数  
 *iButton*  
 鼠标按钮的索引。 可以具有下列值之一︰  
  
- **LEFT_BUTTON**单击鼠标左键。  
  
- **MIDDLE_BUTTON**单击了鼠标按钮。  
  
- **RIGHT_BUTTON**单击鼠标右键按钮。  
  
### <a name="remarks"></a>备注  
 默认实现调用`COleControl::FireClick`。  
  
 重写该成员函数以修改或扩展的默认处理。  
  
##  <a name="onclose"></a>COleControl::OnClose  
 在容器已调用该控件时由框架调用**IOleControl::Close**函数。  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>参数  
 `dwSaveOption`  
 该标志指示是否应在加载之前保存该对象。 有效值为：  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>备注  
 默认情况下，`OnClose`如果它已被修改，则保存控件对象和`dwSaveOption`是`OLECLOSE_SAVEIFDIRTY`或`OLECLOSE_PROMPTSAVE`。  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 当容器调用时由框架调用**IOleObject::DoVerb**成员函数。  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `iVerb`  
 要调用中控制谓词的索引。  
  
 `lpMsg`  
 导致要调用的谓词的 Windows 消息指向的指针。  
  
 `hWndParent`  
 该控件的父窗口句柄。 如果该谓词的执行将创建一个窗口 （或 windows）`hWndParent`应该用作父级。  
  
 `lpRect`  
 指向的坐标相对于容器，该控件，将复制到其中的 RECT 结构的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现使用`ON_OLEVERB`和`ON_STDOLEVERB`消息映射条目以确定正确的函数调用。  
  
 重写此函数可更改谓词的默认处理。  
  
##  <a name="ondraw"></a>COleControl::OnDraw  
 由框架使用指定的设备上下文的指定边界矩形中绘制 OLE 控件调用。  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 进行绘制的设备上下文。  
  
 `rcBounds`  
 该控件，包括边框矩形区域。  
  
 `rcInvalid`  
 是无效的控件的矩形区域。  
  
### <a name="remarks"></a>备注  
 `OnDraw`通常是为了屏幕显示，并传递作为屏幕设备上下文调用`pDC`。 `rcBounds`参数标识 （相对于其当前的映射模式） 的目标设备上下文中的矩形。 `rcInvalid`参数是无效的实际矩形。 在某些情况下，这将是较小的区域比`rcBounds`。  
  
##  <a name="ondrawmetafile"></a>Colecontrol:: Ondrawmetafile  
 由框架使用指定的图元文件设备上下文的指定边界矩形中绘制 OLE 控件调用。  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 进行绘制的设备上下文。  
  
 `rcBounds`  
 该控件，包括边框矩形区域。  
  
### <a name="remarks"></a>备注  
 默认实现调用[OnDraw](#ondraw)函数。  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 使控件，使其 UI 激活。  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpMsg`  
 调用此谓词的 Windows 消息指向的指针。  
  
 `hWndParent`  
 该控件的父窗口的句柄。  
  
 `lpRect`  
 指向用容器中控件的矩形的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 这具有相同的效果与调用控件的`OLEIVERB_UIACTIVATE`谓词。  
  
 此函数通常用作的处理程序函数`ON_OLEVERB`消息映射条目。 这使"Edit"谓词出现在控件的"对象"菜单。 例如:   
  
 [!code-cpp[NVC_MFCAxCtl #&5;](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 当库存 Enabled 属性值发生更改时由框架调用。  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>备注  
 如果您希望通知时此属性更改后的，重写此函数。 默认实现调用[InvalidateControl](#invalidatecontrol)。  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 当容器调用时由框架调用**ioleobject:: Enumverbs**成员函数。  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>参数  
 `ppenumOleVerb`  
 一个指向**IEnumOLEVERB**枚举控件的谓词的对象。  
  
### <a name="return-value"></a>返回值  
 非零，如果谓词才会有效。否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现枚举`ON_OLEVERB`的消息映射中的条目。  
  
 重写此函数可更改枚举谓词的默认方式。  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 连接到或来自 OLE 控件断开连接事件处理程序时由框架调用。  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>参数  
 `bAdvise`  
 **TRUE**指示事件处理程序已连接到控件。 **FALSE**表示从控件断开连接事件处理程序。  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 常用字体属性值已更改时由框架调用。  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`COleControl::InvalidateControl`。 如果该控件进行子类化 Windows 控件，也会发送的默认实现**WM_SETFONT**消息发送到控件的窗口。  
  
 如果您希望通知时此属性更改后的，重写此函数。  
  
### <a name="example"></a>示例  
 [!code-cpp[NVC_MFCAxCtl #&6;](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 常用的前景色属性值已更改时由框架调用。  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`InvalidateControl`。  
  
 如果您希望通知时此属性更改后的，重写此函数。  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 在容器调用由框架调用**IOleControl::FreezeEvents**。  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>参数  
 `bFreeze`  
 **TRUE**如果控件的事件处理即处于冻结; 否则为**FALSE**。  
  
### <a name="remarks"></a>备注  
 默认实现不执行任何操作。  
  
 重写此函数，如果冻结或解冻事件处理时需要其他行为。  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 当容器调用时由框架调用**IViewObject::GetColorSet**成员函数。  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>参数  
 `ptd`  
 指向以图片应呈现为其目标设备。 如果此值为**NULL**，图片应呈现为默认目标设备时，通常显示设备。  
  
 `hicTargetDev`  
 指定所指示的目标设备上的信息上下文`ptd`。 此参数可以是设备上下文中，但不一定。 If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  
  
 *ppColorSet*  
 指向的所用的颜色集应该复制到其中的位置的指针。 如果该函数不返回颜色集**NULL**返回。  
  
### <a name="return-value"></a>返回值  
 非零，如果未返回有效的颜色集;否则为 0。  
  
### <a name="remarks"></a>备注  
 容器将调用此函数可获取绘制 OLE 控件所需的所有颜色。 容器可以使用获取它需要设置整个调色板的颜色与结合使用的颜色集。 默认实现返回**FALSE**。  
  
 重写此函数可执行此请求任何特殊处理。  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 由框架调用，在控件的容器已请求有关控件的信息。  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>参数  
 `pControlInfo`  
 指向[CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734)填充的结构。  
  
### <a name="remarks"></a>备注  
 此信息包含主要由控件的助记键的说明。 默认实现填充`pControlInfo`与默认的信息。  
  
 如果您的控件需要处理助记键，重写此函数。  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 由框架调用以获取一个字符串，表示通过标识的属性的当前值`dispid`。  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `strValue`  
 对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)通过返回一个字符串对象。  
  
### <a name="return-value"></a>返回值  
 如果已在中返回一个字符串，则为非*strValue;*否则为 0。  
  
### <a name="remarks"></a>备注  
 如果您的控件具有其值不能直接转换为字符串属性，并且所需属性的值以显示容器提供属性浏览器中，重写此函数。  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 UI 激活以获取要合并到容器的现有菜单的菜单控件时由框架调用。  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>返回值  
 控件的菜单的句柄或**NULL**如果控件具有 none。 默认实现返回**NULL**。  
  
### <a name="remarks"></a>备注  
 合并 OLE 资源的详细信息，请参阅文章[菜单和资源 (OLE)](../../mfc/menus-and-resources-ole.md)。  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 由以响应容器的框架调用**IViewObjectEx::GetNaturalExtent**请求。  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 指定要如何表示该对象。 表示形式包括内容、 图标、 一个缩略图或打印的文档。 有效的值取自枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 *索引*  
 感兴趣的对象部分。 当前仅为-1 是有效的。  
  
 `ptd`  
 指向[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)结构定义应当为其返回对象的大小的目标设备。  
  
 `hicTargetDev`  
 指定所指示的目标设备的信息上下文`ptd`参数对象从其提取设备量度并测试设备的功能。 如果`ptd`是**NULL**，该对象应忽略中的值`hicTargetDev`参数。  
  
 *pExtentInfo*  
 指向**DVEXTENTINFO**结构，它指定大小调整数据。 **DVEXTENTINFO**结构是︰  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 结构成员`dwExtentMode`可以采用两个值之一︰  
  
- **DVEXTENT_CONTENT**查询该控件应该有多大以完全适合内容 （管理单元大小）  
  
- **DVEXTENT_INTEGRAL**在调整大小时，将建议的大小传递给控件  
  
 `psizel`  
 指向以调整大小由控件返回数据。 返回的大小调整数据设置为-1 表示的任何维度均不进行调整。  
  
### <a name="return-value"></a>返回值  
 非零，如果成功返回，或调整大小;否则为 0。  
  
### <a name="remarks"></a>备注  
 重写此函数可返回对象的显示大小接近中建议的大小和范围模式**DVEXTENTINFO**结构。 默认实现返回**FALSE** ，并不使任何调整大小。  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 由框架来获取一组预定义的字符串表示一个属性的可能值调用。  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `pStringArray`  
 一个字符串数组中用来填充返回的值。  
  
 `pCookieArray`  
 一个`DWORD`要使用返回值来填充数组。  
  
### <a name="return-value"></a>返回值  
 如果元素已添加到非零`pStringArray`和`pCookieArray`。  
  
### <a name="remarks"></a>备注  
 如果您的控件具有带的一组可以用字符串表示的可能值的属性，重写此函数。 每个元素添加到`pStringArray`，应添加到相应的"cookie"元素*pCookieArray。* 这些"cookie"值更高版本可以通过向框架传递`COleControl::OnGetPredefinedValue`函数。  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 由框架调用以获取对应于一个先前返回的重写的预定义字符串的值`COleControl::OnGetPredefinedStrings`。  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `dwCookie`  
 以前的重写由返回的 cookie 值`COleControl::OnGetPredefinedStrings`。  
  
 `lpvarOut`  
 指向**VARIANT**结构通过返回属性值。  
  
### <a name="return-value"></a>返回值  
 如果已在返回的值，则为非`lpvarOut`; 否则为 0。  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 由以响应容器的框架调用[IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032)请求。  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>参数  
 *dwDrawAspect*  
 `DWORD`描述窗体中，哪些方面时，对象的将用来显示。 有效的值取自枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 *索引*  
 感兴趣的对象部分。 当前仅为-1 是有效的。  
  
 `ptd`  
 指向[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)结构定义应当为其返回对象的大小的目标设备。  
  
 *lpsizel*  
 指向对象的大小的返回位置的位置。  
  
### <a name="return-value"></a>返回值  
 非零，如果成功地返回扩展盘区的信息;否则为 0。  
  
### <a name="remarks"></a>备注  
 如果您的控件使用两次绘图，并且其不透明和透明部件具有不同的维度，重写此函数。  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 由以响应容器的框架调用**IViewObjectEx::GetRect**请求。  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 `DWORD`描述窗体中，哪些方面时，对象的将用来显示。 有效的值取自枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**:  
  
- `DVASPECT_CONTENT`整个对象的绑定矩形。 在对象的来源和大小相等的范围内返回的左上角**GetViewExtent***。*  
  
- **DVASPECT_OPAQUE**具有一个不透明的矩形区域的对象返回该矩形。 其他失败。  
  
- **DVASPECT_TRANSPARENT**矩形涵盖所有透明或不规则的部分。  
  
 `pRect`  
 指向[RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907)结构，它指定应在其中绘制该对象的矩形。 此参数控制的定位和拉伸的对象。  
  
### <a name="return-value"></a>返回值  
 如果成功地返回的大小调整为该对象的矩形; 则为非否则为 0。  
  
### <a name="remarks"></a>备注  
 该对象的大小来转换`OnGetViewRect`到矩形 （默认为显示的左上的角） 的特定位置开始。 如果您的控件使用两次绘图，并且其不透明和透明部件具有不同的维度，重写此函数。  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 由以响应容器的框架调用**IViewObjectEx::GetViewStatus**请求。  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>返回值  
 值之一**VIEWSTATUS**枚举，如果成功; 否则为 0。 可能的值是以下任意组合︰  
  
 **VIEWSTATUS_OPAQUE**  
 对象是完全不透明的。 如果未设置此位，该对象包含透明部分。 以这部分仅适用于与内容相关的方面，不适用于`DVASPECT_ICON`或`DVASPECT_DOCPRINT`。  
  
 **VIEWSTATUS_SOLIDBKGND**  
 对象都有纯背景 （包含在一种纯色，而非画笔图案中）。 此位是有意义才**VIEWSTATUS_OPAQUE**设置，并且仅适用于与内容相关的方面，不适用于`DVASPECT_ICON`或`DVASPECT_DOCPRINT`。  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 对象支持**DVASPECT_OPAQUE**。 所有**IViewObjectEx**需要绘制的方面，如下图所可以用这一方面调用参数的方法。  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 对象支持**DVASPECT_TRANSPARENT**。 所有**IViewObjectEx**需要绘制的方面，如下图所可以用这一方面调用参数的方法。  
  
### <a name="remarks"></a>备注  
 如果您的控件使用两次绘图，重写此函数。 默认实现返回**VIEWSTATUS_OPAQUE**。  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 当控件处于停用的用户界面由框架调用。  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>备注  
 实现应隐藏所有工具栏显示`OnShowToolbars`。  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 将鼠标指针悬停在收到下的非活动对象的容器由调用`WM_MOUSEMOVE`消息。  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 边框所在的窗口工作区坐标中的对象。 在屏幕上的准确位置和大小告知对象时`WM_MOUSEMOVE`已接收到消息。  
  
 *x*  
 包含窗口工作区坐标中的鼠标位置的 x 坐标。  
  
 *y*  
 包含窗口工作区坐标中的鼠标位置的 y 坐标。  
  
 `dwKeyState`  
 标识在键盘上的键盘修改键的当前状态。 有效的值可以是任何标志的组合**MK_CONTROL**， **MK_SHIFT**， **MK_ALT**， **MK_BUTTON**， **MK_LBUTTON**， **MK_MBUTTON**，和**MK_RBUTTON**。  
  
### <a name="remarks"></a>备注  
 请注意，窗口工作区坐标 （像素） 用来传递鼠标光标位置。 这是通过实现还将相同的坐标系统中传递该对象的边框。  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 将鼠标指针悬停在收到下的非活动对象的容器由调用`WM_SETCURSOR`消息。  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 边框所在的窗口工作区坐标中的对象。 在屏幕上的准确位置和大小告知对象时`WM_SETCURSOR`已接收到消息。  
  
 *x*  
 包含窗口工作区坐标中的鼠标位置的 x 坐标。  
  
 *y*  
 包含窗口工作区坐标中的鼠标位置的 y 坐标。  
  
 *dwMouseMsg*  
 为其的鼠标消息的标识符`WM_SETCURSOR`发生。  
  
 *bSetAlways*  
 指定该对象指示必须设置光标。 如果**TRUE**，该对象必须设置游标; 如果**FALSE**，光标没有义务将光标放置，并应返回**S_FALSE**这种情况下。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 请注意，窗口工作区坐标 （像素） 用来传递鼠标光标位置。 这是通过实现还将相同的坐标系统中传递该对象的边框。  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 在处理常用的 KeyDown 事件后，由框架调用。  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `nChar`  
 按下的键虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果您的控件必须具有访问权限的密钥信息后触发的事件，重写此函数。  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 由框架调用后激发 KeyPress 事件的库存。  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>参数  
 `nChar`  
 包含所按的键的虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
### <a name="remarks"></a>备注  
 请注意，`nChar`值可能已被修改的容器。  
  
 如果您想要通知此事件发生后，重写此函数。  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 在处理常用的 KeyDown 事件后，由框架调用。  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `nChar`  
 按下的键虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果您的控件必须具有访问权限的密钥信息后触发的事件，重写此函数。  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 由框架后，若要获取实现编辑指定的属性的属性页的类 ID 调用。  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `lpclsid`  
 指向**CLSID**结构通过返回的类 ID。  
  
 *pbPageOptional*  
 返回是否指定的属性页的使用取决于您的指示符。  
  
### <a name="return-value"></a>返回值  
 如果已在返回的类 ID，则为非`lpclsid`; 否则为 0。  
  
### <a name="remarks"></a>备注  
 重写此函数可提供一个方法来调用从容器的属性浏览器控件的属性页。  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 该容器已检测到 OLE 控件的助记键已按下时，由框架调用。  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>参数  
 `pMsg`  
 一个指针，指向由助记键按键操作生成的 Windows 消息。  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 当容器调用控件的属性的谓词后由框架调用。  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpMsg`  
 调用此谓词的 Windows 消息指向的指针。  
  
 `hWndParent`  
 该控件的父窗口的句柄。  
  
 `lpRect`  
 指向用容器中控件的矩形的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现将显示模式属性对话框。  
  
 您可以使用此函数使您的控件的属性页的显示。 调用`OnProperties`函数，传递中控件的父项句柄`hWndParent`参数。 在此例中的值`lpMsg`和`lpRect`参数将被忽略。  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 由以响应容器的框架调用**IViewObjectEx::QueryHitPoint**请求。  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 指定如何表示的对象。 有效的值取自枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 `pRectBounds`  
 指向`RECT`结构，它指定 OLE 控件工作区的边框。  
  
 `ptlLoc`  
 指向**点**结构，它指定要检查的一次点击的点。 在 OLE 客户端区域坐标中指定的点。  
  
 `lCloseHint`  
 定义"关闭"到点检查一次点击的距离。  
  
 `pHitResult`  
 指针，指向命中查询的结果。 以下值之一：  
  
- **HITRESULT_OUTSIDE** `ptlLoc`是外部 OLE 对象，并不会关闭。  
  
- **HITRESULT_TRANSPARENT** *ptlLoc*的 OLE 对象，但不是靠近图像的边界之内。 例如，中间透明圆点可以**HITRESULT_TRANSPARENT**。  
  
- **HITRESULT_CLOSE** `ptlLoc`是内部或外部的 OLE 对象但不够接近要被视为内部的对象。 小型、 瘦应用程序、 或详细对象可以使用此值。 即使了边框之外的某个点时它可能仍然的对象的矩形是关闭 （这所需达到的小型对象）。  
  
- **HITRESULT_HIT** `ptlLoc`内对象的图像。  
  
### <a name="return-value"></a>返回值  
 非零，如果成功地返回命中的结果;否则为 0。 命中数是与 OLE 控件的显示区域重叠。  
  
### <a name="remarks"></a>备注  
 查询对象的显示矩形是否与给定的点重叠 （达到该点）。 `QueryHitPoint`可以重写以测试命中非矩形对象。  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 由以响应容器的框架调用**IViewObjectEx::QueryHitRect**请求。  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 指定要如何表示该对象。 有效的值取自枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 `pRectBounds`  
 指向`RECT`结构，它指定 OLE 控件工作区的边框。  
  
 *prcLoc*  
 指向`RECT`结构，它指定要检查的一次点击 （会与对象矩形重叠），相对于对象的左上角的矩形。  
  
 `lCloseHint`  
 未使用。  
  
 `pHitResult`  
 指针，指向命中查询的结果。 以下值之一：  
  
- **HITRESULT_OUTSIDE**的矩形中没有点命中的 OLE 对象。  
  
- **HITRESULT_HIT**的矩形中的至少一个点是在对象上的一次点击。  
  
### <a name="return-value"></a>返回值  
 非零，如果成功地返回命中的结果;否则为 0。  
  
### <a name="remarks"></a>备注  
 查询对象的显示矩形是否与给定的矩形中的任意点 （达到该矩形） 重叠。 `QueryHitRect`可以重写以测试命中非矩形对象。  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 由框架用于检索指定的格式数据调用。  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定所请求信息的格式。  
  
 `lpStgMedium`  
 指向[STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)是用来返回数据的结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 指定的格式是一个以前放置在控件对象使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成员函数的延迟的呈现。 此函数的默认实现调用`OnRenderFileData`或`OnRenderGlobalData`分别，如果提供的存储媒体文件或内存中。 如果请求的格式为`CF_METAFILEPICT`或将持久性属性设置格式，呈现适当的数据的默认实现，并返回非零值。 否则为它返回 0，且不执行任何操作。  
  
 如果*-> tymed lpStgMedium*是**TYMED_NULL**、 **STGMEDIUM**应分配并由指定填充*-> tymed lpFormatEtc*。 如果不是**TYMED_NULL**、 **STGMEDIUM**应填写的数据的位置。  
  
 重写此函数可提供您请求的格式和介质中的数据。 具体取决于您的数据，您可能想要改为重写此函数的其他版本之一。 如果您的数据较小且大小固定，重写`OnRenderGlobalData`。 如果您的数据在文件中，或在大小可变的重写`OnRenderFileData`。  
  
 有关详细信息，请参阅**FORMATETC**和**STGMEDIUM**中结构[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 由框架来检索指定格式的数据文件的存储介质时调用。  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定所请求信息的格式。  
  
 `pFile`  
 指向[CFile](../../mfc/reference/cfile-class.md)对象是用来呈现数据。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 指定的格式是一个以前放置在控件对象使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成员函数，延迟的呈现。 此函数的默认实现只是返回**FALSE**。  
  
 重写此函数可提供您请求的格式和介质中的数据。 具体取决于您的数据，您可能希望改为重写此函数的其他版本之一。 如果您想要处理多个存储媒介，重写`OnRenderData`。 如果您的数据在文件中，或在大小可变的重写`OnRenderFileData`。  
  
 有关详细信息，请参阅**FORMATETC**结构中[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 由框架来检索指定格式的数据在指定的存储介质全局内存时调用。  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定所请求信息的格式。  
  
 `phGlobal`  
 指向全局内存中数据是要返回的句柄。 如果尚未分配任何内存，此参数可以是**NULL**。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 指定的格式是一个以前放置在控件对象使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成员函数，延迟的呈现。 此函数的默认实现只是返回**FALSE**。  
  
 如果`phGlobal`是**NULL**，一个新`HGLOBAL`应分配并返回以`phGlobal`。 否则为`HGLOBAL`由指定`phGlobal`应使用数据填充。 数据量置于`HGLOBAL`不能超过内存块的当前大小。 此外，块不能重新分配给较大的大小。  
  
 重写此函数可提供您请求的格式和介质中的数据。 具体取决于您的数据，您可能想要改为重写此函数的其他版本之一。 如果您想要处理多个存储媒介，重写`OnRenderData`。 如果您的数据在文件中，或在大小可变的重写`OnRenderFileData`。  
  
 有关详细信息，请参阅**FORMATETC**结构中[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onresetstate"></a>COleControl::OnResetState  
 当控件的属性应设为其默认值由框架调用。  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用[DoPropExchange](#dopropexchange)，并传入`CPropExchange`导致要为其默认值设置的属性的对象。  
  
 控件编写人员可以在此插入初始化代码的 OLE 控件可重写。 当调用此函数[ipersiststream:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680568)或[ipersiststorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557)出现故障，或[IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234)或[IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194)调用，而不第一个调用**ipersiststream:: Load**或**ipersiststorage:: Load**。  
  
##  <a name="onsetclientsite"></a>Colecontrol:: Onsetclientsite  
 在容器已调用该控件时由框架调用**IOleControl::SetClientSite**函数。  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>备注  
 默认情况下，`OnSetClientSite`将检查是否加载数据路径属性，并且它们是，如果调用`DoDataPathPropExchange`。  
  
 重写此函数可执行该通知的任何特殊处理。 具体而言，此函数的重写应调用基类。  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 由该控件的数据替换为指定的数据连接的框架调用。  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定的数据格式。  
  
 `lpStgMedium`  
 指向[STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)结构中的数据位于其中。  
  
 `bRelease`  
 **TRUE**如果控件应释放存储介质中;**FALSE**如果控件不应释放存储介质。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 如果数据持久性属性中设置格式，则默认实现将进行相应修改控件的状态。 否则，默认实现没有任何影响。 如果`bRelease`是**TRUE**，然后调用**ReleaseStgMedium**进行; 否则为 not。  
  
 重写此函数可将控件的数据替换为指定的数据。  
  
 有关详细信息，请参阅**FORMATETC**和**STGMEDIUM**中结构[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 控件的大小时需要因调用而更改时由框架调用[IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330)。  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>参数  
 `lpSizeL`  
 一个指向**为原始大小**结构，它使用长整数来表示的宽度和高度的控件，以表示**HIMETRIC**单位。  
  
### <a name="return-value"></a>返回值  
 非零，如果已接受了大小更改;否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现将处理控件的扩展盘区的大小调整。 如果控件是处于就地活动状态，对容器的调用**OnPosRectChanged**然后进行。  
  
 重写此函数可更改您的控件的默认大小调整。  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 由框架调用以实现对调用[IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767)。  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>参数  
 *lpRectPos*  
 指向，该值指示控件的新位置和相对于容器的大小的 RECT 结构的指针。  
  
 `lpRectClip`  
 一个指向`RECT`结构，指示该控件是要剪裁的矩形区域。  
  
### <a name="return-value"></a>返回值  
 非零，如果重新定位已接受;否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现自动处理的调整和控制窗口的大小调整，并返回**TRUE**。  
  
 重写此函数来改变此函数的默认行为。  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 当控件已激活的用户界面时由框架调用。  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>备注  
 默认实现不执行任何操作。  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 常用的标题或文本属性值已更改时由框架调用。  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`InvalidateControl`。  
  
 如果您希望通知时此属性更改后的，重写此函数。  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 由以响应容器的框架调用**IOleInPlaceObjectWindowless::OnWindowMessage**请求。  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>参数  
 `msg`  
 所传递的 Windows 消息的标识符。  
  
 `wParam`  
 所传递的 Windows。 指定消息特定的附加信息。 此参数的内容取决于的值`msg`参数。  
  
 `lParam`  
 所传递的 Windows。 指定消息特定的附加信息。 此参数的内容取决于的值`msg`参数。  
  
 *plResult*  
 Windows 结果代码。 指定消息处理的结果，并取决于发送的消息。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 处理无窗口控件的窗口消息。 `COleControl``OnWindowlessMessage`应该用于不是鼠标消息和键盘消息的窗口消息。 `COleControl`提供了[SetCapture](#setcapture)和[SetFocus](#setfocus)专为无窗口的 OLE 对象中获得鼠标捕获和键盘焦点。  
  
 由于无窗口对象还没有一个窗口，他们需要一种机制以允许发送到它们的容器调度消息。 无窗口的 OLE 对象从其容器中获取消息通过`OnWindowMessage`方法`IOleInPlaceObjectWindowless`接口 (扩展名为[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)无窗口支持)。 `OnWindowMessage`不采用`HWND`参数。  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 将转换的坐标`pPoint`成工作区坐标。  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 OLE 控件在容器内的范围的指针。 不是工作区但整个控件包括边框及滚动条的区域。  
  
 `pPoint`  
 到父级 （容器） 的指针指向要转换为该控件的工作区的坐标。  
  
 `bHitTest`  
 指定命中测试有待完成的点。  
  
### <a name="return-value"></a>返回值  
 如果`bHitTest`是**FALSE**，返回**HTNOWHERE**。 如果`bHitTest`是**TRUE**，将返回父 （容器） 的点的位置奠定了 OLE 控件的工作区中，并且是以下鼠标之一命中测试值︰  
  
- **HTBORDER**没有大小调整边框的窗口边框中。  
  
- **HTBOTTOM**较低水平边框的窗口中。  
  
- **HTBOTTOMLEFT**窗口边框的左下角。  
  
- **HTBOTTOMRIGHT**窗口边框的右下角。  
  
- **HTCAPTION**标题栏区域中。  
  
- **HTCLIENT**工作区中。  
  
- **HTERROR**屏幕背景或窗口之间的分隔线 (与相同**HTNOWHERE**只不过**DefWndProc** Windows 函数生成系统提示音表示出现错误)。  
  
- **HTGROWBOX**大小框中。  
  
- **HTHSCROLL**水平滚动条中。  
  
- **HTLEFT**窗口的左边框中。  
  
- **HTMAXBUTTON**中最大化按钮。  
  
- **HTMENU**菜单区域中。  
  
- **HTMINBUTTON**中最小化按钮。  
  
- **HTNOWHERE**屏幕背景或窗口之间的分隔线。  
  
- **HTREDUCE**中最小化按钮。  
  
- **HTRIGHT**在窗口的右边框。  
  
- **HTSIZE**大小框中 (与相同**HTGROWBOX**)。  
  
- **HTSYSMENU**控制菜单中或在关闭按钮中的子窗口。  
  
- **HTTOP**窗口的上半水平边框中。  
  
- **HTTOPLEFT**窗口边框的左上角。  
  
- **HTTOPRIGHT**窗口边框的右上角中。  
  
- **HTTRANSPARENT**当前受另一个窗口的窗口中。  
  
- **HTVSCROLL**垂直滚动条中。  
  
- **HTZOOM**中最大化按钮。  
  
### <a name="remarks"></a>备注  
 在输入`pPoint`是相对于父级 （左上角的容器） 的源。 在输出`pPoint`是相对于原点 OLE 控件 （左上角的控件的客户端区域） 的工作区。  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 通知容器有模式对话框已关闭。  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>参数  
 `hWndParent`  
 模式对话框中的父窗口的句柄。  
  
### <a name="remarks"></a>备注  
 在显示任何模式对话框后调用此函数。 您必须调用此函数，以便容器可以启用被禁用的任何顶级窗口`PreModalDialog`。 此函数应通过调用配对`PreModalDialog`。  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 通知将会显示一个模式对话框的容器。  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>参数  
 `hWndParent`  
 模式对话框中的父窗口的句柄。  
  
### <a name="remarks"></a>备注  
 在显示任何模式对话框之前调用此函数。 您必须调用此函数，以便容器可以禁用所有顶层窗口。 显示了模式对话框后，必须调用`PostModalDialog`。  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 销毁并重新创建该控件的窗口。  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>备注  
 这可能是有必要，如果需要更改窗口的样式位。  
  
##  <a name="refresh"></a>COleControl::Refresh  
 强行 OLE 控件重绘。  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>备注  
 此函数支持通过`COleControl`基类作为调用刷新的常用方法。 这允许 OLE 控件的用户重绘窗体控件在特定时间。 此方法的详细信息，请参阅文章[ActiveX 控件︰ 方法](../../mfc/mfc-activex-controls-methods.md)。  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 释放鼠标捕获。  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 如果控件当前具有鼠标捕获，则释放捕获。 否则，此函数具有不起作用。  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 释放由其他应用程序释放使用的设备上下文的无窗口控件的容器的显示设备上下文。  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 标识要释放的容器设备上下文。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 应用程序必须调用`ReleaseDC`每次调用[GetDC](#getdc)。  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 设置控件的父级。  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>参数  
 *hWndOuter*  
 控制窗口的句柄。  
  
 `hWndParent`  
 新的父窗口的句柄。  
  
### <a name="remarks"></a>备注  
 调用此函数可重置控制窗口的父级。  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 初始化的状态`COleControl`常用属性为其默认值。  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>备注  
 属性是︰ 外观、 backcolor、 borderstyle、 标题、 Enabled、 字体、 前景色，hWnd 和文本。 常用属性的说明，请参阅[ActiveX 控件︰ 添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。  
  
 你可以通过使用提高控件的二进制初始化性能`ResetStockProps`和`ResetVersion`重写`COleControl::OnResetState`。 请参见下面的示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
### <a name="example"></a>示例  
 [!code-cpp[NVC_MFCAxCtl #&7;](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 初始化为指定值的版本号。  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>参数  
 `dwVersionDefault`  
 若要分配给控件的版本号。  
  
### <a name="remarks"></a>备注  
 你可以通过使用提高控件的二进制初始化性能`ResetVersion`和`ResetStockProps`重写`COleControl::OnResetState`。 参阅位于示例[ResetStockProps](#resetstockprops)。 有关优化初始化的详细信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 允许无窗口的 OLE 对象进行滚动它在屏幕上处于就地活动映像内的一个区域。  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>参数  
 `xAmount`  
 指定所需量，以设备为单位，水平滚动。 此参数必须是负值，以向左滚动。  
  
 `yAmount`  
 指定所需量，采用设备单位的垂直滚动。 此参数必须是负值可向上滚动。  
  
 `lpRect`  
 指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或指定要向下滚动，OLE 对象的客户端区域的部分中包含窗口的工作区坐标的 RECT 结构。 如果`lpRect`是**NULL**，滚动整个 OLE 对象的客户端区域。  
  
 `lpClipRect`  
 指向`CRect`对象或`RECT`结构，它指定到向剪辑矩形。 只有在该矩形内的像素的滚动量。 在矩形外的 bits 不会受到影响，即使它们位于`lpRect`矩形。 如果`lpClipRect`是**NULL**，不存在修剪执行滚动矩形上。  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 选择到设备上下文的一种字体。  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 指向设备上下文对象的指针。  
  
 `fontHolder`  
 引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象，表示要选择的字体。  
  
### <a name="return-value"></a>返回值  
 一个指向以前选定的字体。 当调用方已完成绘图使用所有操作都*fontHolder，*它应重新以前选定的字体选择通过将其传递以参数形式向[CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject)。  
  
##  <a name="selectstockfont"></a>COleControl::SelectStockFont  
 选择到设备上下文的堆栈 Font 属性。  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 将在其中选择字体的设备上下文。  
  
### <a name="return-value"></a>返回值  
 一个指向以前选定的`CFont`对象。 应使用[CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject)若要在完成时恢复到的设备上下文选择该字体。  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 序列化或初始化分配给该控件的显示空间的状态。  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>参数  
 `ar`  
 一个`CArchive`要面向或源自序列化对象。  
  
### <a name="remarks"></a>备注  
 你可以通过使用提高控件的二进制暂留性能`SerializeExtent`， `SerializeStockProps`，和`SerializeVersion`重写**COleControl::Serialize**。 请参见下面的示例。 有关优化初始化的详细信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
### <a name="example"></a>示例  
 [!code-cpp[NVC_MFCAxCtl #&8;](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 序列化或初始化的状态`COleControl`常用属性︰ 外观、 backcolor、 borderstyle、 标题、 已启用、 字体、 前景色和文本。  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>参数  
 `ar`  
 一个`CArchive`要面向或源自序列化对象。  
  
### <a name="remarks"></a>备注  
 常用属性的说明，请参阅[ActiveX 控件︰ 添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。  
  
 你可以通过使用提高控件的二进制暂留性能`SerializeStockProps`， `SerializeExtent`，和`SerializeVersion`重写**COleControl::Serialize**。 有关示例，请参阅处的代码[SerializeExtent](#serializeextent)。 有关优化初始化的详细信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 序列化或初始化控件的版本信息的状态。  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `ar`  
 一个`CArchive`要面向或源自序列化对象。  
  
 `dwVersionDefault`  
 该控件的当前版本号。  
  
 `bConvert`  
 指示永久性数据是否应该为最新格式保存，或保留在相同的格式必须时加载时转换。  
  
### <a name="return-value"></a>返回值  
 该控件的版本号。 如果加载指定的存档，`SerializeVersion`返回加载从该存档的版本。 否则，它将返回当前加载的版本。  
  
### <a name="remarks"></a>备注  
 你可以通过使用提高控件的二进制暂留性能`SerializeVersion`， `SerializeExtent`，和`SerializeStockProps`重写**COleControl::Serialize**。 有关示例，请参阅处的代码[SerializeExtent](#serializeextent)。 有关优化初始化的详细信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 设置控件的股票的外观属性值。  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>参数  
 *sAppearance*  
 一个**短**( `VT_I2`) 值要用于您的控件的外观。 值为零将控件的外观设置为平面和的值为 1 到三维物体设置控件的外观。  
  
### <a name="remarks"></a>备注  
 关于常用属性的详细信息，请参阅[ActiveX 控件︰ 属性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 设置控件的股票的 backcolor 属性值。  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>参数  
 *dwBackColor*  
 **OLE_COLOR**值要用于绘制控件的背景。  
  
### <a name="remarks"></a>备注  
 使用此属性和其他详细信息相关属性，请参阅文章[ActiveX 控件︰ 属性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 设置控件的股票的边框样式属性值。  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>参数  
 *sBorderStyle*  
 控件，则的新的边框样式0 表示无边框，而 1 表示正常的边框。  
  
### <a name="remarks"></a>备注  
 控制窗口将重新创建和`OnBorderStyleChanged`调用。  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 导致该控件的容器窗口控件的代表将占用鼠标捕获。  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>返回值  
 一个指向**CWnd**以前接收鼠标输入的窗口对象。  
  
### <a name="remarks"></a>备注  
 如果该控件已激活并无窗口，此函数将导致控件的容器窗口控件的代表将占用鼠标捕获。 否则，此函数将导致控件本身需要拥有鼠标捕获 (与相同`CWnd::SetCapture`)。  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 设置 OLE 控件窗口的大小，并通知更改控件所在位置的容器。  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>参数  
 `cx`  
 以像素为单位指定控件的新宽度。  
  
 `cy`  
 以像素为单位指定控件的新高度。  
  
### <a name="return-value"></a>返回值  
 如果调用成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 不应在控件的构造函数中使用此函数。  
  
 请注意，用于控制 windows 的所有坐标都都相对于控件的左上角。  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 设置常用控件的 Enabled 属性值。  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>参数  
 `bEnabled`  
 **TRUE**如果控件是已启用; 否则为**FALSE**。  
  
### <a name="remarks"></a>备注  
 设置此属性后**OnEnabledChange**调用。  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 使控件的容器的窗口，才能拥有输入焦点的控件的代表。  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>返回值  
 一个指向**CWnd**以前具有输入的焦点的窗口对象或**NULL**如果没有此类窗口。  
  
### <a name="remarks"></a>备注  
 如果该控件已激活并无窗口，此函数会导致该控件的容器窗口，才能拥有输入焦点的控件的代表。 输入的焦点将定向到容器的窗口的键盘输入，并在容器将调度到调用的 OLE 对象的所有后续的键盘消息`SetFocus`。 任何以前具有输入的焦点的窗口失去它。  
  
 如果控件不是无窗口的此函数会导致控件本身需要拥有输入焦点 (与相同`CWnd::SetFocus`)。  
  
##  <a name="setfont"></a>COleControl::SetFont  
 设置您的控件的堆栈 Font 属性。  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>参数  
 *pFontDisp*  
 指向一个字体的调度接口的指针。  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 设置控件的股票的前景色属性值。  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>参数  
 *dwForeColor*  
 **OLE_COLOR**值要用于绘制控件的前景色。  
  
### <a name="remarks"></a>备注  
 使用此属性和其他详细信息相关属性，请参阅文章[ActiveX 控件︰ 属性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 调用由框架来初始化该控件所支持的数据格式的列表。  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>备注  
 默认实现指定这两种格式︰`CF_METAFILEPICT`和设置的持久性属性。  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 设置 OLE 控件容器中第一次显示的大小。  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>参数  
 `cx`  
 以像素为单位的 OLE 控件的初始宽度。  
  
 `cy`  
 以像素为单位的 OLE 控件的初始高度。  
  
### <a name="remarks"></a>备注  
 调用此函数在构造函数来设置您的控件的初始大小。 以设备单位或像素为单位的初始大小。 建议在您的控件的构造函数中执行此调用。  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 控件的已修改的状态更改。  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `bModified`  
 该控件的新值的修改标志。 **TRUE**指示该控件的状态已被修改;**FALSE**指示控件的状态只是尚未保存。  
  
### <a name="remarks"></a>备注  
 调用此函数，当发生了更改会影响您的控件的持久状态。 例如，如果持久属性的值发生更改，调用此函数与`bModified` **TRUE**。  
  
##  <a name="setnotpermitted"></a>COleControl::SetNotPermitted  
 指示编辑请求已失败。  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>备注  
 调用此函数时`BoundPropertyRequestEdit`失败。 此函数将引发类型的异常**COleDispScodeException**以指示不允许使用 set 操作。  
  
##  <a name="setnotsupported"></a>Colecontrol:: Setnotsupported  
 可防止对控件的属性值由用户修改。  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>备注  
 调用此函数来代替任何属性的 Set 函数不支持的属性值由该控件的用户修改。 一个示例是一个属性，它只读的。  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 设置相对于容器，用设备单位表示控件的矩形的坐标。  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向包含该控件的新的坐标，相对于容器的矩形的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 如果控件处于打开状态，其大小将调整;否则为容器的**OnPosRectChanged**调用函数。  
  
##  <a name="settext"></a>COleControl::SetText  
 设置控件的股票 Caption 或 Text 属性的值。  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>参数  
 `pszText`  
 指向字符字符串的指针。  
  
### <a name="remarks"></a>备注  
 请注意，常用的标题和文本属性都映射到相同的值。 这意味着对这两个属性所做的任何更改将自动更改这两个属性。 一般情况下，股票标题或 Text 属性，但不要两者都应支持控件。  
  
##  <a name="throwerror"></a>Colecontrol:: Throwerror  
 用信号通知您的控件中的错误的匹配项。  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>参数  
 `sc`  
 要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件︰ 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `nDescriptionID`  
 字符串资源 ID 的异常来进行报告。  
  
 `nHelpID`  
 要报告主题帮助 ID。  
  
 `pszDescription`  
 包含要报告的异常的说明的字符串。  
  
### <a name="remarks"></a>备注  
 此函数应仅从调用 Get 或 Set 函数中的 OLE 属性或 OLE 自动化方法的实现。 如果您需要发出信号在其他情况下出现的错误，应触发常用的错误事件。  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 转换坐标之间的值**HIMETRIC**单位和容器的本机单位。  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>参数  
 *lpptlHimetric*  
 指向**POINTL**结构，它包含中的坐标**HIMETRIC**单位。  
  
 *lpptfContainer*  
 指向**POINTF**结构，它包含坐标以容器的单元大小。  
  
 `flags`  
 以下值的组合︰  
  
- **XFORMCOORDS_POSITION**容器中的位置。  
  
- **XFORMCOORDS_SIZE**容器中的大小。  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER**转换**HIMETRIC**容器的单位为单位。  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC**转换到的容器的单位**HIMETRIC**单位。  
  
### <a name="remarks"></a>备注  
 前两个标志， **XFORMCOORDS_POSITION**和**XFORMCOORDS_SIZE**，指示是否应作为一个位置或大小，处理坐标。 剩余的两个标志指示方向的转换。  
  
##  <a name="translatecolor"></a>COleControl::TranslateColor  
 将转换的颜色值**OLE_COLOR**数据类型设置为[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)数据类型。  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>参数  
 `clrColor`  
 一个**OLE_COLOR**数据类型。 有关详细信息，请参阅 Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353)函数。  
  
 `hpal`  
 可选的调色板; 句柄可以是**NULL**。  
  
### <a name="return-value"></a>返回值  
 定义实体的 RGB （红、 绿、 蓝色） 32 位颜色值的颜色最接近`clrColor`设备可以表示的值。  
  
### <a name="remarks"></a>备注  
 此函数可将转换为常用的前景色和背景色属性**COLORREF**所使用的类型[CDC](../../mfc/reference/cdc-class.md)成员函数。  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 确定您的控件是否应作为默认值中使用的环境属性的值时从其持久性状态随后加载它。  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>返回值  
 Nonzero 则指示将有效，则为环境属性否则环境属性将无效。  
  
### <a name="remarks"></a>备注  
 在某些容器中，您的控件可能没有访问权限对其环境属性在初始的重写中调用期间`COleControl::DoPropExchange`。 这种情况，如果该容器调用[IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730)或[ipersiststorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557)之前调用[IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (即，如果它不会遵循**OLEMISC_SETCLIENTSITEFIRST**状态位)。  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 提供有关 Windows 过程`COleControl`对象。  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>参数  
 `message`  
 指定要处理的 Windows 消息。  
  
 `wParam`  
 提供在处理消息时使用的其他信息。 参数值取决于消息。  
  
 `lParam`  
 提供在处理消息时使用的其他信息。 参数值取决于消息。  
  
### <a name="return-value"></a>返回值  
 调度该消息返回值。  
  
### <a name="remarks"></a>备注  
 调用此函数可将会在控件的消息映射的特定消息调度。  
  
## <a name="see-also"></a>另请参阅  
 [MFC 示例 CIRC3](../../visual-cpp-samples.md)   
 [MFC 示例 TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage 类](../../mfc/reference/colepropertypage-class.md)   
 [CWnd 类](../../mfc/reference/cwnd-class.md)   
 [层次结构图](../../mfc/hierarchy-chart.md)   
 [CFontHolder 类](../../mfc/reference/cfontholder-class.md)   
 [CPictureHolder 类](../../mfc/reference/cpictureholder-class.md)

