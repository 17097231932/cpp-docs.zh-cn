---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 2b6c11600010bc9f97ab8c3a531d33c92c94e442
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752121"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

提供 Windows 公共树视图控件的功能。

## <a name="syntax"></a>语法

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CTreeCtrl：：CTreeCtrl](#ctreectrl)|构造 `CTreeCtrl` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CTreeCtrl：：创建](#create)|创建树视图控件并将其附加到`CTreeCtrl`对象。|
|[CTreeCtrl：：创建拖动图像](#createdragimage)|为指定的树视图项创建拖动位图。|
|[CTreeCtrl：：创建Ex](#createex)|使用指定的 Windows 扩展样式创建树控件并将其附加到`CTreeCtrl`对象。|
|[CTreeCtrl：:DeleteAll项目](#deleteallitems)|删除树视图控件中的所有项。|
|[CTreeCtrl：:Delete项目](#deleteitem)|删除树视图控件中的新项。|
|[CTreeCtrl：：编辑标签](#editlabel)|就地编辑指定的树视图项。|
|[CTreeCtrl：：结束编辑标签现在](#endeditlabelnow)|取消当前树视图控件中树视图项标签的编辑操作。|
|[CTreeCtrl：：确保可见](#ensurevisible)|确保树视图项在其树视图控件中可见。|
|[CTreeCtrl：：展开](#expand)|展开或折叠指定树视图项的子项。|
|[CTreeCtrl：：GetBkColor](#getbkcolor)|检索控件的当前背景颜色。|
|[CTreeCtrl：获取检查](#getcheck)|检索树控件项的检查状态。|
|[CTreeCtrl：获取儿童项目](#getchilditem)|检索指定树视图项的子项。|
|[CTreeCtrl：：获取计数](#getcount)|检索与树视图控件关联的树项数。|
|[CTreeCtrl：：获取DropHilight项目](#getdrophilightitem)|检索拖放操作的目标。|
|[CTreeCtrl：获取编辑控制](#geteditcontrol)|检索用于编辑指定树视图项的编辑控件的句柄。|
|[CTreeCtrl：：获取扩展样式](#getextendedstyle)|检索当前树视图控件正在使用的扩展样式。|
|[CTreeCtrl：获取第一个可见项](#getfirstvisibleitem)|检索指定树视图项的第一个可见项。|
|[CTreeCtrl：获取图像列表](#getimagelist)|检索与树视图控件关联的图像列表的句柄。|
|[CTreectrl：获取缩进](#getindent)|从树视图项的父级检索树视图项的偏移量（以像素为单位）。|
|[CTreeCtrl：：获取插入标记颜色](#getinsertmarkcolor)|检索用于绘制树视图的插入标记的颜色。|
|[CTreeCtrl：获取项目](#getitem)|检索指定树视图项的属性。|
|[CTreeCtrl：获取项目数据](#getitemdata)|返回与项关联的特定于应用程序的值。|
|[CTreeCtrl：：获取项目扩展图像索引](#getitemexpandedimageindex)|检索图像的索引，当当前树视图控件的指定项处于展开状态时要显示。|
|[CTreeCtrl：：获取项目高度](#getitemheight)|检索树视图项的当前高度。|
|[CTreeCtrl：：获取项目图像](#getitemimage)|检索与项目关联的图像。|
|[CTreeCtrl：：获取项目部分重整](#getitempartrect)|检索当前树视图控件中指定项的指定部分的边界矩形。|
|[CTreeCtrl：：获取项目重新完成](#getitemrect)|检索树视图项的边界矩形。|
|[CTreeCtrl：：获取项目状态](#getitemstate)|返回项的状态。|
|[CTreeCtrl：：获取项目状态Ex](#getitemstateex)|检索当前树视图控件中指定项的扩展状态。|
|[CTreeCtrl：：获取项目文本](#getitemtext)|返回项的文本。|
|[CTreeCtrl：：获取最后可见的项目](#getlastvisibleitem)|检索当前树视图控件中的最后一个展开项。|
|[CTreeCtrl：：获取线彩](#getlinecolor)|检索树视图控件的当前线颜色。|
|[CTreeCtrl：：获取下一个项目](#getnextitem)|检索与指定关系匹配的下一个树视图项。|
|[CTreeCtrl：：获取下一个同级项目](#getnextsiblingitem)|检索指定树视图项的下一个同级。|
|[CTreeCtrl：：获取下一个可可见的项目](#getnextvisibleitem)|检索指定树视图项的下一个可见项。|
|[CTreeCtrl：获取父项](#getparentitem)|检索指定树视图项的父项。|
|[CTreeCtrl：：获取Prevsibling项目](#getprevsiblingitem)|检索指定树视图项的上一个同级。|
|[CTreeCtrl：：获取可明显项目](#getprevvisibleitem)|检索指定树视图项的上一个可见项。|
|[CTreeCtrl：获取根项目](#getrootitem)|检索指定树视图项的根。|
|[CTreeCtrl：：获取滚动时间](#getscrolltime)|检索树视图控件的最大滚动时间。|
|[CTreeCtrl：获取精选计数](#getselectedcount)|检索当前树视图控件中的选定项数。|
|[CTreeCtrl：获取选定项目](#getselecteditem)|检索当前选定的树视图项。|
|[CTreeCtrl：获取文本颜色](#gettextcolor)|检索控件的当前文本颜色。|
|[CTreeCtrl：获取工具提示](#gettooltips)|检索树视图控件使用的子 ToolTip 控件的句柄。|
|[CTreeCtrl：获取可见计数](#getvisiblecount)|检索与树视图控件关联的可见树项数。|
|[CTreeCtrl：hitTest](#hittest)|返回与对象相关的光标的`CTreeCtrl`当前位置。|
|[CTreeCtrl：：插入项目](#insertitem)|在树视图控件中插入新项目。|
|[CTreeCtrl：：项目哈斯儿童](#itemhaschildren)|如果指定的项具有子项，则返回非零。|
|[CTreectrl：mapAccIdtoitem](#mapaccidtoitem)|将指定的辅助功能标识符映射到当前树视图控件中的树视图项。|
|[CTreectrl：：映射项目到AccID](#mapitemtoaccid)|将指定的句柄映射到当前树视图控件中的树视图项到辅助功能标识符。|
|[CTreeCtrl：：选择](#select)|选择、滚动到视图或重绘指定的树视图项。|
|[CTreeCtrl：：选择DropTarget](#selectdroptarget)|将树项重新绘制为拖放操作的目标。|
|[CTreeCtrl：选择项目](#selectitem)|选择指定的树视图项。|
|[CTreeCtrl：：选择第一个可见](#selectsetfirstvisible)|选择指定的树视图项作为第一个可见项。|
|[CTreeCtrl：：设置自动滚动信息](#setautoscrollinfo)|设置当前树视图控件的自动滚动速率。|
|[CTreeCtrl：：SetBkColor](#setbkcolor)|设置控件的背景颜色。|
|[CTreeCtrl：：设置检查](#setcheck)|设置树控件项的检查状态。|
|[CTreeCtrl：：设置扩展样式](#setextendedstyle)|设置当前树视图控件的扩展样式。|
|[CTreeCtrl：：设置图像列表](#setimagelist)|设置与树视图控件关联的图像列表的句柄。|
|[CTreectrl：：setindent](#setindent)|从树视图项的父级设置树视图项的偏移量（以像素为单位）。|
|[CTreeCtrl：：设置插入标记](#setinsertmark)|在树视图控件中设置插入标记。|
|[CTreeCtrl：：设置插入标记颜色](#setinsertmarkcolor)|设置用于绘制树视图的插入标记的颜色。|
|[CTreeCtrl：设置项目](#setitem)|设置指定树视图项的属性。|
|[CTreeCtrl：：设置项目数据](#setitemdata)|设置与项关联的特定于应用程序的值。|
|[CTreeCtrl：：设置项目扩展图像索引](#setitemexpandedimageindex)|将图像的索引设置在当前树视图控件的指定项处于展开状态时显示。|
|[CTreeCtrl：：设置项目高度](#setitemheight)|设置树视图项的高度。|
|[CTreeCtrl：：设置项目图像](#setitemimage)|将图像与项目关联。|
|[CTreeCtrl：：设置项目状态](#setitemstate)|设置项的状态。|
|[CTreeCtrl：：设置项目状态Ex](#setitemstateex)|设置当前树视图控件中指定项的扩展状态。|
|[CTreeCtrl：：设置项目文本](#setitemtext)|设置项目的文本。|
|[CTreeCtrl：：设置线颜色](#setlinecolor)|设置树视图控件的当前线颜色。|
|[CTreeCtrl：：设置滚动时间](#setscrolltime)|设置树视图控件的最大滚动时间。|
|[CTreeCtrl：：设置文本颜色](#settextcolor)|设置控件的文本颜色。|
|[CTreeCtrl：：设置工具提示](#settooltips)|设置树视图控件的子工具提示控件。|
|[CTreeCtrl：：显示信息提示](#showinfotip)|在当前树视图控件中显示指定项的信息提示。|
|[CTreeCtrl：：排序儿童](#sortchildren)|对给定父项的子项进行排序。|
|[CTreeCtrl：：排序儿童CB](#sortchildrencb)|使用应用程序定义的排序函数对给定父项的子项进行排序。|

## <a name="remarks"></a>备注

"树视图控件"是显示项的分层列表的窗口，例如文档中的标题、索引中的条目或磁盘上的文件和目录。 每个项包含一个标签和一个可选位图图像，且每个项可以有一个与之关联的子项列表。 通过单击项，用户可以展开和折叠关联的子项列表。

此控件（因此类`CTreeCtrl`）仅适用于在 Windows 98 和 Windows NT 版本 4 及更高版本版本 4 下运行的程序。

有关 使用`CTreeCtrl`的详细信息，请参阅：

- [控件](../../mfc/controls-mfc.md)

- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)

- Windows SDK 中的[树视图控件引用](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>要求

**标头：** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a>CTreeCtrl：：创建

如果在对话框模板中指定树控件，或者如果您使用的[是 CTreeView，](../../mfc/reference/ctreeview-class.md)则在创建对话框或视图时会自动创建树控件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
指定树视图控件的样式。 应用["创建窗口](/windows/win32/api/winuser/nf-winuser-createwindoww)"中描述的窗口样式，以及 Windows SDK 中所述树[视图控件样式](/windows/win32/Controls/tree-view-control-window-styles)的任何组合。

*矩形*<br/>
指定树视图控件的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](/windows/win32/api/windef/ns-windef-rect)结构。

*pparentwnd*<br/>
指定树视图控件的父窗口（通常为`CDialog`。 值不得为 NULL。

*nID*<br/>
指定树视图控件的 ID。

### <a name="return-value"></a>返回值

初始化成功时非零;否则 0。

### <a name="remarks"></a>备注

如果要将树控件创建为其他窗口的子窗口，请使用`Create`成员函数。 如果使用 创建树控件`Create`，则除了其他树视图样式外，还必须将其WS_VISIBLE传递。

在两个步骤`CTreeCtrl`中构造 一个。 首先调用构造函数，然后调用`Create`，这将创建树视图控件并将其附加到`CTreeCtrl`对象。

要使用扩展窗口样式创建树控件，请调用[CreateEx](#createex) `Create`而不是 。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a>CTreeCtrl：：创建Ex

调用此函数以创建控件（子窗口），并将其与`CTreeCtrl`对象关联。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwExStyle*<br/>
指定要创建的控件的扩展样式。 有关扩展 Windows 样式的列表，请参阅 Windows SDK 中[创建 WindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*参数。

*dwStyle*<br/>
指定树视图控件的样式。 应用["创建窗口](/windows/win32/api/winuser/nf-winuser-createwindoww)"中描述的窗口样式，以及 Windows SDK 中所述树[视图控件样式](/windows/win32/Controls/tree-view-control-window-styles)的任何组合。

*矩形*<br/>
对[RECT](/windows/win32/api/windef/ns-windef-rect)结构的引用，描述要创建的窗口的大小和位置，在*pParentWnd*的客户端坐标中。

*pparentwnd*<br/>
指向控件的父窗口的指针。

*nID*<br/>
控件的子窗口 ID。

### <a name="return-value"></a>返回值

如果成功，则为非零，否则为 0。

### <a name="remarks"></a>备注

使用`CreateEx`而不是["创建](#create)"来应用扩展的 Windows 样式，该样式由 Windows 扩展样式前言**WS_EX_** 指定。

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a>CTreeCtrl：：创建拖动图像

调用此函数可为树视图控件中的给定项创建拖动位图，为位图创建图像列表，并将位图添加到图像列表中。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要拖动的树项的句柄。

### <a name="return-value"></a>返回值

指向向其添加拖动位图的图像列表（如果成功）;如果成功，则指向图像列表。否则 NULL。

### <a name="remarks"></a>备注

应用程序使用图像列表函数在拖动项目时显示图像。

该`CImageList`对象是永久性的，您必须在完成该对象后将其删除。 例如：

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a>CTreeCtrl：：CTreeCtrl

构造 `CTreeCtrl` 对象。

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a>CTreeCtrl：:DeleteAll项目

调用此函数以从树视图控件中删除所有项。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a>CTreeCtrl：:Delete项目

调用此函数以从树视图控件中删除项。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要删除的树项的句柄。 如果*hitem*具有TVI_ROOT值，则所有项都将从树视图控件中删除。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a>CTreeCtrl：：编辑标签

调用此函数开始就地编辑指定项目的文本。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要编辑的树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则指向用于编辑`CEdit`项目文本的对象的指针;如果成功，则指向用于编辑项目文本的对象。否则 NULL。

### <a name="remarks"></a>备注

编辑是通过将项目的文本替换为包含文本的单行编辑控件来完成的。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a>CTreeCtrl：：结束编辑标签现在

完成当前树视图控件中树视图项标签的编辑操作。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*f 取消而不保存*|[在]TRUE 在结束编辑操作之前放弃对树视图项的更改，或者 FALSE 在结束操作之前保存对树视图项的更改。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

此方法发送[TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow)消息，这在 Windows SDK 中介绍。

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a>CTreeCtrl：：确保可见

调用此函数以确保树视图项可见。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
使树项可见的句柄。

### <a name="return-value"></a>返回值

如果系统滚动树视图控件中的项，则返回 TRUE，以确保指定的项可见。 否则，返回值为 FALSE。

### <a name="remarks"></a>备注

如有必要，该函数将展开父项或滚动树视图控件，以便该项可见。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a>CTreeCtrl：：展开

调用此函数以展开或折叠与给定父项关联的子项列表（如果有）。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要展开的树项的句柄。

*n代码*<br/>
指示要执行的操作类型的标志。 此标志可以具有以下值之一：

- TVE_COLLAPSE折叠列表。

- TVE_COLLAPSERESET折叠列表并删除子项。 TVIS_EXPANDEDONCE状态标志重置。 此标志必须与TVE_COLLAPSE标志一起使用。

- TVE_EXPAND展开列表。

- TVE_TOGGLE如果列表当前已展开或展开列表（如果当前已折叠）。"折叠"。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：确保可见](#ensurevisible)。

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a>CTreeCtrl：：GetBkColor

此成员函数实现 Win32 消息[的行为TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)，如 Windows SDK 中所述。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>返回值

表示控件的当前窗口背景颜色的 COLORREF 值。 如果此值为 -1，则控件使用系统窗口颜色。 在这种情况下，可以使用`::GetSysColor(COLOR_WINDOW)`来获取控件正在使用的当前系统颜色。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：设置文本颜色](#settextcolor)。

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a>CTreeCtrl：获取检查

调用此成员函数以检索项的检查状态。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
接收状态信息的 HTREEITEM。

### <a name="return-value"></a>返回值

如果检查树控件项，则非零;否则 0。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：SetCheck](#setcheck)。

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a>CTreeCtrl：获取儿童项目

调用此函数以检索是*hItem*指定的项的子项的树视图项。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

子项的句柄（如果成功）;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a>CTreeCtrl：：获取计数

调用此函数以检索树视图控件中的项计数。

```
UINT GetCount() const;
```

### <a name="return-value"></a>返回值

树视图控件中的项数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a>CTreeCtrl：：获取DropHilight项目

调用此函数以检索拖放操作的目标项。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>返回值

项目句柄在成功时丢弃;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a>CTreeCtrl：获取编辑控制

调用此函数以检索用于编辑树视图项文本的编辑控件的句柄。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>返回值

指向编辑控件的指针，用于编辑项目文本（如果成功）;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a>CTreeCtrl：：获取扩展样式

检索当前树视图控件正在使用的扩展样式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>返回值

包含当前树视图控件扩展样式的位组合 （OR） 的值。 有关详细信息，请参阅[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)。

### <a name="remarks"></a>备注

此方法发送[TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle)消息，这在 Windows SDK 中介绍。

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a>CTreeCtrl：获取第一个可见项

调用此函数以检索树视图控件的第一个可见项。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>返回值

第一个可见项的句柄;否则 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：SetCheck](#setcheck)。

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a>CTreeCtrl：获取图像列表

调用此函数以检索与树视图控件关联的正常图像列表或状态图像列表的句柄。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>参数

*n图像列表*<br/>
要检索的图像列表的类型。 图像列表可以是以下值之一：

- TVSIL_NORMAL检索正常图像列表，其中包含树视图项的选定图像和非选定图像。

- TVSIL_STATE检索状态图像列表，其中包含处于用户定义状态的树视图项的图像。

### <a name="return-value"></a>返回值

如果成功，指向控件的图像列表的指针;否则 NULL。

### <a name="remarks"></a>备注

树视图控件中的每个项都可以具有与其关联的一对位映射图像。 选择项目时显示一个图像，另一个图像在未选中项目时显示。 例如，项目在选择时可能会显示打开的文件夹，在未选中时显示关闭的文件夹。

有关图像列表的详细信息，请参阅[CImageList](../../mfc/reference/cimagelist-class.md)类。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a>CTreectrl：获取缩进

调用此函数以检索子项相对于其父项缩进的金额（以像素为单位）。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>返回值

以像素为单位测得的缩进量。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CTreeCtrl：：获取插入标记颜色

此成员函数实现 Win32 消息[TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>返回值

包含当前插入标记颜色的 COLORREF 值。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a>CTreeCtrl：获取项目

调用此函数以检索指定的树视图项的属性。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>参数

*pItem*<br/>
指向[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构的指针，如 Windows SDK 中所述。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

  请参阅[CTreeCtrl：:Delete 项目）的示例](#deleteitem)。

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a>CTreeCtrl：获取项目数据

调用此函数以检索与指定项关联的特定于应用程序的值。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其数据的项的句柄。

### <a name="return-value"></a>返回值

与*hItem*指定的项关联的指针大小的应用程序特定值。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a>CTreeCtrl：：获取项目扩展图像索引

检索图像的索引，当当前树视图控件的指定项处于展开状态时要显示。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]处理树视图控件项。|

### <a name="return-value"></a>返回值

指定项处于展开状态时要显示的图像索引。

### <a name="remarks"></a>备注

此方法发送[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)消息，这在 Windows SDK 中介绍。 此消息返回描述树视图控件项的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构，然后此方法从该结构检索`iExpandedImage`成员。

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a>CTreeCtrl：：获取项目高度

此成员函数实现 Win32 消息[的行为TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)，如 Windows SDK 中所述。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>返回值

项目的高度（以像素为单位）。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a>CTreeCtrl：：获取项目图像

树视图控件中的每个项都可以具有与其关联的一对位映射图像。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其映像的项的句柄。

*n图像*<br/>
在树视图控件的图像列表中接收项图像索引的整数。

*n选定图像*<br/>
在树视图控件的图像列表中接收项选定图像的索引的整数。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

图像显示在项目标签的左侧。 选择项目时显示一个图像，另一个图像在未选中项目时显示。 例如，项目在选择时可能会显示打开的文件夹，在未选中时显示关闭的文件夹。

调用此函数以在树视图控件的图像列表中检索项目图像及其所选图像的索引。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a>CTreeCtrl：：获取项目部分重整

检索当前树视图控件中指定项的指定部分的边界矩形。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]处理树视图控件项。|
|*n部分*|[在]零件的标识符。 必须设置为TVGIPR_BUTTON。|
|*lpRect*|[出]指向[RECT](/windows/win32/api/windef/ns-windef-rect)结构的指针。 如果此方法成功，则结构将接收*hItem*和*nPart*指定的零件的矩形坐标。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

每个树控件项都受图形矩形的约束。 每当单击该矩形中的点时，该项即表示*为命中*。 此方法返回最大的矩形，这样当单击矩形中的点时，将命中*hItem*参数标识的项。

此方法发送 TVM_GETITEMPARTRECT 消息，这在 Windows SDK 中介绍。 有关详细信息，请参阅[TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)宏。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例使用辅助功能标识符和[CTreeCtrl：mapAccIdToItem](#mapaccidtoitem)方法检索根树视图项的句柄。 然后，该示例使用句柄和[CTreeCtrl：：getItemPartrect](#getitempartrect)方法在该项目周围绘制一个 3D 矩形。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。 我们使用[CTreeCtrl：mapItemToAccID](#mapitemtoaccid)方法将根树视图项与辅助功能标识符相关联。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a>CTreeCtrl：：获取项目重新完成

调用此函数以检索*hItem*的边界矩形，并确定它是否可见。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树视图控件项的句柄。

*lpRect*<br/>
指向接收边界矩形的[RECT](/windows/win32/api/windef/ns-windef-rect)结构的指针。 坐标相对于树视图控件的左上角。

*仅文本*<br/>
如果此参数是非零，则边界矩形仅包括项的文本。 否则，它包括项在树视图控件中占用的整行。

### <a name="return-value"></a>返回值

如果项可见，则非零 *，lpRect*中包含边界矩形。 否则，0 与*lpRect*未初始化。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a>CTreeCtrl：：获取项目状态

返回*hItem*指定的项的状态。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其状态的项的句柄。

*nStateMask*<br/>
指示要检索的一个或多个状态的蒙版。 有关*nStateMask*的可能值的详细信息，请参阅 Windows SDK`state`中`stateMask` [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构 和 成员的讨论。

### <a name="return-value"></a>返回值

一种 UINT，它保存 nState Mask 指定的值的位或值。 有关可能值的信息，请参阅[CTreeCtrl：：getItem](#getitem)。 要查找特定状态的值，应执行状态值和返回值的位和操作，如以下示例所示。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a>CTreeCtrl：：获取项目状态Ex

检索当前树视图控件中指定项的扩展状态。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]处理树视图控件项。|

### <a name="return-value"></a>返回值

项的扩展状态。 有关详细信息，请参阅`uStateEx`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的成员。

### <a name="remarks"></a>备注

此方法发送[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)消息，这在 Windows SDK 中介绍。 此消息返回描述树视图控件项的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构，此方法从该结构检索`uStateEx`成员。

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a>CTreeCtrl：：获取项目文本

返回*hItem*指定的项的文本。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其文本的项的句柄。

### <a name="return-value"></a>返回值

包含`CString`项文本的对象。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取下一个项目](#getnextitem)。

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a>CTreeCtrl：：获取最后可见的项目

检索当前树视图控件中的最后一个未展开的节点项。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>返回值

如果该方法成功，则对最后一个未展开的节点项的句柄;否则，NULL。

### <a name="remarks"></a>备注

此方法发送[TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem)消息，这在 Windows SDK 中介绍。 有关详细信息，请参阅该消息*的标志*参数中的TVGN_LASTVISIBLE标志。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 在下一个示例中，使用其中一个或多个变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例检索最后一个未展开的树视图节点项的句柄，然后围绕该项目绘制一个 3D 矩形。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a>CTreeCtrl：：获取线彩

此成员函数实现 Win32 消息[TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>返回值

当前线颜色。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a>CTreeCtrl：：获取下一个项目

调用此函数以检索具有指定关系（由*nCode*参数指示）的树视图项到*hItem*。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

*n代码*<br/>
指示与*hItem*的关系类型的标志。 此标志可以是以下值之一：

- TVGN_CARET检索当前选定的项。

- TVGN_CHILD检索*hItem*参数指定的项的第一个子项。

- TVGN_DROPHILITE检索拖放操作的目标项。

- TVGN_FIRSTVISIBLE检索第一个可见项。

- TVGN_LASTVISIBLE检索树中的最后一个展开项。 这不会检索树视图窗口中可见的最后一个项。

- TVGN_NEXT检索下一个同级项。

- TVGN_NEXTVISIBLE检索指定项后面的下一个可见项。

- TVGN_PARENT检索指定项的父项。

- TVGN_PREVIOUS检索上一个同级项。

- TVGN_PREVIOUSVISIBLE检索指定项之前的第一个可见项。

- TVGN_ROOT检索指定项为部件的根项的第一个子项。

### <a name="return-value"></a>返回值

下一项的句柄（如果成功）;否则 NULL。

### <a name="remarks"></a>备注

如果正在检索的项是树的根节点，则此功能将返回 NULL。 例如，如果在树视图根节点的第一级子节点上使用带有TVGN_PARENT标志的此消息，则消息将返回 NULL。

### <a name="example"></a>示例

有关`GetNextItem`在循环中使用的示例，请参阅[CTreeCtrl：:DeleteItem](#deleteitem)。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a>CTreeCtrl：：获取下一个同级项目

调用此函数以检索*hItem*的下一个同级。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

下一个同级项的句柄;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a>CTreeCtrl：：获取下一个可可见的项目

调用此函数以检索*hItem*的下一个可见项。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

下一个可见项的句柄;否则 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：SetCheck](#setcheck)。

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a>CTreeCtrl：获取父项

调用此函数以检索*hItem*的父项 。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

父项的句柄;否则 NULL。

### <a name="remarks"></a>备注

如果指定项的父项是树的根节点，则此功能将返回 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：确保可见](#ensurevisible)。

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a>CTreeCtrl：：获取Prevsibling项目

调用此函数以检索*hItem*的上一个同级。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

上一个同级的句柄;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a>CTreeCtrl：：获取可明显项目

调用此函数以检索*hItem*的上一个可见项。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

上一个可见项的句柄;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a>CTreeCtrl：获取根项目

调用此函数以检索树视图控件的根项。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>返回值

根项的句柄;否则 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：编辑标签](#editlabel)。

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a>CTreeCtrl：：获取滚动时间

调用此成员函数以检索树视图控件的最大滚动时间。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>返回值

最大滚动时间（以毫秒为单位）。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)的行为，如 Windows SDK 中所述。

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a>CTreeCtrl：获取精选计数

检索当前树视图控件中的选定项数。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>返回值

所选项的数量。

### <a name="remarks"></a>备注

此方法发送[TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount)消息，这在 Windows SDK 中介绍。

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a>CTreeCtrl：获取选定项目

调用此函数以检索树视图控件的当前选定项。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>返回值

所选项的句柄;否则 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a>CTreeCtrl：获取文本颜色

此成员函数实现 Win32 消息[TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>返回值

表示当前文本颜色的 COLORREF 值。 如果此值为 -1，则控件将使用文本颜色的系统颜色。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：设置文本颜色](#settextcolor)。

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a>CTreeCtrl：获取工具提示

此成员函数实现 Win32 消息[TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)的行为，如 Windows SDK 中所述。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>返回值

指向树控件使用的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针。 如果["创建](#create)成员"函数使用样式TVS_NOTOOLTIPS，则不使用工具提示，并且返回 NULL。

### <a name="remarks"></a>备注

的`GetToolTips`MFC 实现返回`CToolTipCtrl`由树控件使用的对象，而不是工具提示控件的句柄。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a>CTreeCtrl：获取可见计数

调用此函数以检索树视图控件中可见项的计数。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>返回值

树视图控件中的可见项数;否则 - 1。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：SetCheck](#setcheck)。

## <a name="ctreectrlhittest"></a><a name="hittest"></a>CTreeCtrl：hitTest

调用此函数以确定指定点相对于树视图控件的工作区的位置。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>参数

*pt*<br/>
要测试的点的客户端坐标。

*pFlags*<br/>
指向接收命中测试结果信息的整数的指针。 它可以是"备注"部分中`flags`成员下列出的一个或多个值。

*pHitTestInfo*<br/>
包含命中测试位置并接收命中测试结果信息的[TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)结构的地址。

### <a name="return-value"></a>返回值

如果没有任何项占用该点，则占用指定点的树视图项的句柄或 NULL。

### <a name="remarks"></a>备注

调用此函数时 *，pt*参数指定要测试的点的坐标。 如果没有项目占用该点，则函数返回指定点处的项句柄或 NULL。 此外 *，pFlags*参数包含指示指定点位置的值。 可能的值包括：

|||
|-|-|
|“值”|含义|
|TVHT_ABOVE|在工作区上方。|
|TVHT_BELOW|在工作区下方。|
|TVHT_NOWHERE|在工作区中，但位于最后一个项的下方。|
|TVHT_ONITEM|在与项目关联的位图或标签上。|
|TVHT_ONITEMBUTTON|在与项目关联的按钮上。|
|TVHT_ONITEMICON|在与项目关联的位图上。|
|TVHT_ONITEMINDENT|在与项关联的缩进中。|
|TVHT_ONITEMLABEL|在与项目关联的标签（字符串）上。|
|TVHT_ONITEMRIGHT|在项目右侧的区域。|
|TVHT_ONITEMSTATEICON|在处于用户定义状态的树视图项的状态图标上。|
|TVHT_TOLEFT|在工作区的左侧。|
|TVHT_TORIGHT|在工作区的右侧。|
|||

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a>CTreeCtrl：：插入项目

调用此函数以在树视图控件中插入新项。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>参数

*lpInsertstruct*<br/>
指向 的指针`TVINSERTSTRUCT`，用于指定要插入的树视图项的属性。

*nMask*<br/>
指定要设置的属性的整数。 请参阅`TVITEM`Windows SDK 中的结构。

*lpszItem*<br/>
包含项文本的字符串的地址。

*n图像*<br/>
树视图控件的图像列表中项图像的索引。

*n选定图像*<br/>
树视图控件的图像列表中项目所选图像的索引。

*n州*<br/>
指定项状态的值。 有关适当状态的列表，请参阅 Windows SDK 中的树视图控件项状态。

*nStateMask*<br/>
指定要设置哪些状态。 请参阅`TVITEM`Windows SDK 中的结构。

*lParam*<br/>
与项关联的指针大小的应用程序特定值。

*h 家长*<br/>
插入项的父项的句柄。

*h插入后*<br/>
要插入新项目的项的句柄。

### <a name="return-value"></a>返回值

如果成功，处理新项目;否则 NULL。

### <a name="remarks"></a>备注

该示例显示在插入树控件项时可能需要使用函数的每个版本的情况。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a>CTreeCtrl：：项目哈斯儿童

使用此函数可以确定*hItem*指定的树项是否具有子项。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果*hItem*指定的树项具有子项，则非零;0，如果没有。

### <a name="remarks"></a>备注

如果是这样，则可以使用[CTreeCtrl：：getChildItem](#getchilditem)检索这些子项。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取选定项目](#getselecteditem)。

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a>CTreectrl：mapAccIdtoitem

将指定的辅助功能标识符映射到当前树视图控件中的树视图项的句柄。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*uAccId*|[在]树视图项中元素的辅助功能标识符。|

### <a name="return-value"></a>返回值

对应于*uAccId*参数的树`HTREEITEM`视图项 （ ） 的句柄。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的*hItem*成员。

### <a name="remarks"></a>备注

辅助功能是帮助残障人士使用计算机的应用程序。 `IAccessible`接口使用辅助功能标识符在窗口中唯一指定元素。 有关辅助功能标识符的详细信息，在[Microsoft 开发人员网络](https://go.microsoft.com/fwlink/p/?linkid=56322)中搜索"关于活动辅助功能支持"主题。

此方法发送[TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem)消息，这在 Windows SDK 中介绍。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例使用辅助功能标识符和[CTreeCtrl：mapAccIdToItem](#mapaccidtoitem)方法检索根树视图项的句柄。 该示例使用句柄和[CTreeCtrl：：GetItemPartrect](#getitempartrect)方法在该项目周围绘制一个 3D 矩形。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。 我们使用[CTreeCtrl：mapItemToAccID](#mapitemtoaccid)方法将根树视图项与辅助功能标识符相关联。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a>CTreectrl：：映射项目到AccID

将当前树视图控件中的树视图项的指定句柄映射到辅助功能标识符。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]控件中的树视图项的句柄。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的*hItem*成员。|

### <a name="return-value"></a>返回值

对应于*hItem*参数的辅助功能标识符。

### <a name="remarks"></a>备注

辅助功能是帮助残障人士使用计算机的应用程序。 `IAccessible`接口使用辅助功能标识符在窗口中唯一指定元素。 有关辅助功能标识符的详细信息，在[Microsoft 开发人员网络](https://go.microsoft.com/fwlink/p/?linkid=56322)中搜索"关于活动辅助功能支持"主题。

此方法发送[TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid)消息，这在 Windows SDK 中介绍。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例获取树视图控件项的标识号。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。 此代码示例获取根国家/区域节点的唯一标识号。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a>CTreeCtrl：：选择

调用此函数以选择给定的树视图项、将项目滚动到视图中，或重绘用于指示拖放操作目标的样式中的项。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

*n代码*<br/>
要执行的操作类型。 此参数可以是以下值之一：

- TVGN_CARET 将所选内容设置到给定项。

- TVGN_DROPHILITE重绘用于指示拖放操作目标的样式中的给定项。

- TVGN_FIRSTVISIBLE垂直滚动树视图，以便给定项是第一个可见项。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果*nCode*包含该值TVGN_CARET，则父窗口将接收TVN_SELCHANGING并TVN_SELCHANGED通知消息。 此外，如果指定的项是折叠父项的子项，则父项的子项列表将展开以显示指定的项。 在这种情况下，父窗口接收TVN_ITEMEXPANDING和TVN_ITEMEXPANDED通知消息。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：hitTest](#hittest)。

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a>CTreeCtrl：：选择DropTarget

调用此函数以重绘用于指示拖放操作目标的样式中的项。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a>CTreeCtrl：选择项目

调用此函数以选择给定的树视图项。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果*hItem*为 NULL，则此函数不选择任何项目。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a>CTreeCtrl：：选择第一个可见

调用此函数垂直滚动树视图，以便给定项是第一个可见项。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置为第一个可见项的树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

函数向窗口发送一条消息，其中带有TVM_SELECTITEM和TVGN_FIRSTVISIBLE消息参数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a>CTreeCtrl：：设置自动滚动信息

设置当前树视图控件的自动滚动速率。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*uPixelsPerSec*|[在]每秒要滚动的像素数。|
|*u 更新时间*|[在]控件更新之间的时间间隔。|

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

自动滚动参数用于滚动到查看当前不可见的项目。 树视图控件必须具有TVS_EX_AUTOHSCROLL扩展样式，这在[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)中描述。

此方法发送[TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo)消息，这在 Windows SDK 中介绍。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例设置当前树视图控件的自动滚动行为。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。 我们特意使树视图控件变窄，以便它必须自动滚动以显示具有焦点的树项。 代码示例将树视图控件设置为每 5 秒自动滚动 30 像素，直到树项处于视图中。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a>CTreeCtrl：：SetBkColor

此成员函数实现 Win32 消息[TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>参数

*Clr*<br/>
包含新背景颜色的 COLORREF 值。 如果此值为 -1，则控件将恢复为使用背景颜色的系统颜色。

### <a name="return-value"></a>返回值

表示当前文本颜色的 COLORREF 值。 如果此值为 -1，则控件将使用文本颜色的系统颜色。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：设置文本颜色](#settextcolor)。

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a>CTreeCtrl：：设置检查

调用此成员函数以设置树控件项的检查状态。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>参数

*hItem*<br/>
接收检查状态更改的 HTREEITEM。

*f检查*<br/>
指示是要检查树控件项还是取消选中。 默认情况下，`SetCheck`将要检查的项设置。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

当树控件项选中时 *（fCheck*设置为 TRUE），该项将显示一个相邻的复选标记。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>示例

要使用复选框，请在填充树控件之前设置TVS_CHECKBOXES。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a>CTreeCtrl：：设置扩展样式

设置当前树视图控件的扩展样式。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*dwExMask*|[在]指定当前树视图控件中哪些样式受此方法影响的位掩码。 如果此参数为零，则忽略该参数，并将*dwExStyles*参数的值分配给树视图控件。<br /><br /> 指定[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)中描述的样式的零或位组合 （OR）。|
|*dwExStyles*|[在]指定要设置或清除的当前树视图控件中的样式的位掩码。<br /><br /> 要设置样式的组合，请指定[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)中描述的样式的位组合 （OR）。 要清除一组样式，请指定零。|

### <a name="return-value"></a>返回值

包含上一个扩展控件样式的值。

### <a name="remarks"></a>备注

此方法清除*dwExMask*参数中指定的样式，然后设置*dwExStyles*参数中指定的样式。 只有对应于*dwExMask*中的位的扩展样式才会更改。

此方法发送[TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle)消息，这在 Windows SDK 中介绍。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例将TVS_EX_AUTOHSCROLL扩展样式添加到当前树视图控件。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。 我们特意使树视图控件变窄，以便它必须自动滚动以显示具有焦点的树项。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a>CTreeCtrl：：设置图像列表

调用此函数可设置树视图控件的正常图像或状态图像列表，并使用新图像重新绘制控件。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>参数

*pImageList*<br/>
指向要分配的图像列表的指针。 如果*pImageList*为 NULL，则所有图像都将从树视图控件中删除。

*n图像列表类型*<br/>
要设置的图像列表的类型。 图像列表可以是以下值之一：

- TVSIL_NORMAL 设置正常图像列表，其中包含树视图项的选定图像和非选定图像。 必须使用此状态来叠加图像。

- TVSIL_STATE 设置状态图像列表，其中包含处于用户定义状态的树视图项的图像。

### <a name="return-value"></a>返回值

指向上一个图像列表（如果有）;如果指向上一个图像列表（如果有）;否则 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取图像列表](#getimagelist)。

## <a name="ctreectrlsetindent"></a><a name="setindent"></a>CTreectrl：：setindent

调用此函数可设置树视图控件的缩进宽度，并重绘控件以反映新宽度。

```cpp
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>参数

*n 因登特*<br/>
缩进的宽度（以像素为单位）。 如果*nIndent*小于系统定义的最小宽度，则新宽度将设置为系统定义的最小宽度。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取缩进](#getindent)。

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a>CTreeCtrl：：设置插入标记

此成员函数实现 Win32 消息[TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)的行为，如 Windows SDK 中所述。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>参数

*hItem*<br/>
HTREEITEM，用于指定插入标记将放置在哪个项目上。 如果此参数为 NULL，则插入标记将被删除。

*f 后*<br/>
BOOL 值，用于指定插入标记是放置在指定项之前还是之后。 如果此参数为非零，则插入标记将放在项之后。 如果此参数为零，则插入标记将放置在项之前。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CTreeCtrl：：设置插入标记颜色

此成员函数实现 Win32 消息[TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>参数

*clrNew*<br/>
包含新插入标记颜色的 COLORREF 值。

### <a name="return-value"></a>返回值

包含上一个插入标记颜色的 COLORREF 值。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取 InsertMarkColor](#getinsertmarkcolor)。

## <a name="ctreectrlsetitem"></a><a name="setitem"></a>CTreeCtrl：设置项目

调用此函数以设置指定的树视图项的属性。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>参数

*pItem*<br/>
指向包含新项目属性的[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构的指针，如 Windows SDK 中所述。

*hItem*<br/>
要设置其属性的项的句柄。 请参阅`hItem`Windows SDK`TVITEM`中的结构成员。

*nMask*<br/>
指定要设置的属性的整数。 请参阅`TVITEM`结构`mask`的成员。

*lpszItem*<br/>
包含项文本的字符串的地址。

*n图像*<br/>
树视图控件的图像列表中项图像的索引。 请参阅`TVITEM`结构`iImage`的成员。

*n选定图像*<br/>
树视图控件的图像列表中项目所选图像的索引。 请参阅`TVITEM`结构`iSelectedImage`的成员。

*n州*<br/>
指定项状态的值。 请参阅`TVITEM`结构`State`的成员。

*nStateMask*<br/>
指定要设置哪些状态。 请参阅`TVITEM`结构`stateMask`的成员。

*lParam*<br/>
与项关联的指针大小的应用程序特定值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

在结构`TVITEM`中，`hItem`成员标识项，`mask`成员指定要设置的属性。

如果`mask`成员或*nMask*参数指定TVIF_TEXT值，`pszText`则成员或*lpszItem*是 null 终止字符串的地址，并且`cchTextMax`该成员将被忽略。 如果`mask`（或*nMask*） 指定TVIF_STATE`stateMask`值，则成员或*nStateMask*参数指定要更改的`state`项状态，并且成员或*nState*参数包含这些状态的值。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a>CTreeCtrl：：设置项目数据

调用此函数以设置与指定项关联的特定于应用程序的值。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其数据的项的句柄。

*dwData*<br/>
与*hItem*指定的项关联的指针大小的应用程序特定值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a>CTreeCtrl：：设置项目扩展图像索引

将图像的索引设置在当前树视图控件的指定项处于展开状态时显示。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]处理树视图控件项。|
|*i 扩展图像*|[在]指定项处于展开状态时要显示的图像索引。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

此方法发送[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)消息，这在 Windows SDK 中介绍。 此方法将*itvImage*参数分配给`iExpandedImage`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的成员，然后在消息中使用该结构。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例是一个微不足道的测试，用于确定[CTreeCtrl：：getItem 扩展图像索引](#getitemexpandedimageindex)方法是否返回[CTreeCtrl：：SetItem 扩展图像索引](#setitemexpandedimageindex)方法设置的值。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a>CTreeCtrl：：设置项目高度

此成员函数实现 Win32 消息[TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)的行为，如 Windows SDK 中所述。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>参数

*赛高地*<br/>
指定树视图中每个项目的新高度（以像素为单位）。 如果此参数小于图像的高度，则它将设置为图像的高度。 如果此参数不是偶数，它将向下舍入到最接近的偶数值。 如果此参数为 -1，则控件将恢复为使用其默认项高度。

### <a name="return-value"></a>返回值

项的上一个高度（以像素为单位）。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取项目高度](#getitemheight)。

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a>CTreeCtrl：：设置项目图像

将图像与项目关联。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置其图像的项的句柄。

*n图像*<br/>
树视图控件的图像列表中项图像的索引。

*n选定图像*<br/>
树视图控件的图像列表中项目所选图像的索引。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

树视图控件中的每个项都可以具有与其关联的一对位映射图像。 图像显示在项目标签的左侧。 选择项目时显示一个图像，另一个图像在未选中项目时显示。 例如，项目在选择时可能会显示打开的文件夹，在未选中时显示关闭的文件夹。

调用此函数以在树视图控件的图像列表中设置项目图像及其所选图像的索引。

有关图像的详细信息，请参阅[CImageList](../../mfc/reference/cimagelist-class.md)。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取项目图像](#getitemimage)。

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a>CTreeCtrl：：设置项目状态

设置*hItem*指定的项的状态。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置其状态的项的句柄。

*n州*<br/>
指定项目的新状态。

*nStateMask*<br/>
指定要更改哪些状态。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

有关状态的信息，请参阅[CTreeCtrl：：获取项目](#getitem)。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取项目状态](#getitemstate)。

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a>CTreeCtrl：：设置项目状态Ex

设置当前树视图控件中指定项的扩展状态。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]处理树视图控件项。|
|*uStateEx*|[在]项的扩展状态。 有关详细信息，请参阅`uStateEx`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的成员。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

此方法发送[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)消息，这在 Windows SDK 中介绍。 此方法将*uStateEx*参数分配给`uStateEx`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的成员，然后在消息中使用该结构。

### <a name="example"></a>示例

以下代码示例定义用于访问当前树视图`m_treeCtrl`控件的变量 。 代码示例还定义了无符号整数和几个 HTREEITEM 变量。 这些变量在下一个示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

以下代码示例将树视图项设置为禁用状态。 在代码示例的早期版本（未显示）中，我们创建了一个树视图，该视图包括美国的根国家/区域节点、宾夕法尼亚州和华盛顿州的子节点以及这些州城市的树项。 此代码示例将宾夕法尼亚州节点设为禁用状态。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a>CTreeCtrl：：设置项目文本

设置*hItem*指定的项的文本。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置其文本的项的句柄。

*lpszItem*<br/>
包含项目新文本的字符串的地址

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a>CTreeCtrl：：设置线颜色

调用此成员函数以设置树视图控件的当前线颜色。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>参数

*clrNew*<br/>
新线颜色。

### <a name="return-value"></a>返回值

上一行颜色。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)的行为，如 Windows SDK 中所述。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a>CTreeCtrl：：设置滚动时间

调用此成员函数以设置树视图控件的最大滚动时间。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>参数

*uScrollTime*<br/>
新的最大滚动时间（以毫秒为单位）。 如果此值小于 100，则该值将四舍五入为 100。

### <a name="return-value"></a>返回值

上一个最大滚动时间（以毫秒为单位）。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)的行为，如 Windows SDK 中所述。

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a>CTreeCtrl：：设置文本颜色

此成员函数实现 Win32 消息[TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)的行为，如 Windows SDK 中所述。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>参数

*Clr*<br/>
包含新文本颜色的 COLORREF 值。 如果此参数为 -1，则控件将恢复为使用文本颜色的系统颜色。

### <a name="return-value"></a>返回值

表示上一个文本颜色的 COLORREF 值。 如果此值为 -1，则控件使用文本颜色的系统颜色。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a>CTreeCtrl：：设置工具提示

此成员函数实现 Win32 消息[TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)的行为，如 Windows SDK 中所述。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>参数

*pwndTip*<br/>
指向树控件将使用的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针。

### <a name="return-value"></a>返回值

指向包含控件以前使用的工具提示的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针，如果以前未使用工具提示，则指向 NULL。

### <a name="remarks"></a>备注

要使用工具提示，请指示创建`CTreeCtrl`对象时TVS_NOTOOLTIPS样式。

### <a name="example"></a>示例

  请参阅[CTreeCtrl 的示例：：获取工具提示](#gettooltips)。

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a>CTreeCtrl：：显示信息提示

在当前树视图控件中显示指定项的信息提示。

```cpp
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*hItem*|[在]控件中树视图项的句柄。 有关详细信息，请参阅`hItem`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的成员。|

### <a name="remarks"></a>备注

有关工具提示和信息提示之间的差异的详细信息，请搜索[Microsoft 开发人员网络](https://go.microsoft.com/fwlink/p/?linkid=56322)上的"工具提示和信息提示"主题。

此方法发送[TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip)消息，这在 Windows SDK 中介绍。

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a>CTreeCtrl：：排序儿童

调用此函数以字母顺序对树视图控件中给定父项的子项进行排序。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要排序子项的父项的句柄。 如果*hItem*为 NULL，则排序将从树根进行。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

`SortChildren`不会通过树再诅咒;只有*hItem*的直系子级才会排序。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a>CTreeCtrl：：排序儿童CB

调用此函数，使用比较项的应用程序定义的回调函数对树视图项进行排序。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>参数

*pSort*<br/>
指向[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)结构的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果第一个项应位于`lpfnCompare`第二个项之前，则结构的比较函数 （） 必须返回负值;如果第一个项应遵循第二个项，则返回负值;如果两个项等效，则返回 0。

*lParam1*和*lParam2*参数对应于要`lParam`比较的两个项目的[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构的成员。 *lParamSort*参数对应于`lParam``TV_SORTCB`结构的成员。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>另请参阅

[MFC 样品 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[CImageList 类](../../mfc/reference/cimagelist-class.md)
