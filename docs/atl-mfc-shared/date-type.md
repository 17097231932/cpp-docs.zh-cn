---
description: 了解详细信息：日期类型
title: 日期类型
ms.date: 11/04/2016
f1_keywords:
- DATE
helpviewer_keywords:
- Date data type, implementing
- Date data type
- DATE type
- Date data type, about Date data type
- MFC, date and time
- hour values representation
ms.assetid: 695853ed-b614-4575-b793-b8c287372038
ms.openlocfilehash: 6a0fd8f02abe5fd3ecb3695fd2715bfb3a573028
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/11/2020
ms.locfileid: "97167014"
---
# <a name="date-type"></a>日期类型

日期类型是使用8字节浮点数字实现的。 天数以从30年12月30日 30 1899 开始的整数增量表示，从0开始。 小时值以数字的小数部分的绝对值表示。 下表说明了几个日期及其日期类型的等效日期：

|日期和时间|表示形式|
|-------------------|--------------------|
|1899年12月30日午夜|0.00|
|1900年1月1日午夜|2.00|
|1900年1月4日午夜|5.00|
|4月1900，上午6点|5.25|
|4月1900，中午|5.50|
|4月1900，晚上9点|5.875|

日期日期类型以及 `COleDateTime` 类将日期和时间表示为传统数字行。 `COleDateTime`类包含若干处理日期值的方法，包括与其他通用日期格式相互转换。

使用自动化中的这些日期和时间格式时，应注意以下几点：

- 在本地时间指定日期;当使用不同时区中的日期时，必须手动执行同步。

- 日期类型不会考虑夏时制。

- 日期时间线对于小于 0 (12 1899 月30日前) 之前的日期值将变为不连续。 这是因为 date 值的整数部分被视为已签名，而小数部分被视为无符号。 换句话说，date 值的整数部分可以是正数或负数，而 date 值的小数部分将始终添加到整个逻辑日期。 下表说明了几个示例：

|日期和时间|表示形式|
|-------------------|--------------------|
|27年 1899 12 月27日午夜|-3.00|
|28年12月1899，中午|-2.50|
|28年 12 1899 月28日午夜|-2.00|
|1899年12月29日午夜|-1.00|
|1899年12月30日下午6点|-0.75|
|1899年12月30日，中午|-0.50|
|30年12月1899，上午6点|-0.25|
|1899年12月30日午夜|0.00|
|30年12月1899，上午6点|0.25|
|1899年12月30日，中午|0.50|
|1899年12月30日下午6点|0.75|
|1899年12月31日午夜|1.00|
|1900年1月1日午夜|2.00|
|1月1日下午1900|2.50|
|2月1900日午夜|3.00|

> [!CAUTION]
> 请注意，因为 6:00 AM 始终由小值0.25 表示，而不考虑表示 day 的整数是否为正数 (12 月30日之后 1899) 或负) 1899 (，因此，简单的浮点比较会 *错误地将* 表示低于6:00 的日期的任何日期排序为早于，表示当天的 12/30/1899 am。

有关与日期和类型相关的问题的详细信息， `COleDateTime` 请参阅 [COleDateTime 类](../atl-mfc-shared/reference/coledatetime-class.md) 和 [日期和时间：自动化支持](./date-and-time.md)。

## <a name="see-also"></a>请参阅

[日期和时间](../atl-mfc-shared/date-and-time.md)<br/>
[COleDateTime 类](../atl-mfc-shared/reference/coledatetime-class.md)
