---
title: MFC 应用程序向导的数据库支持
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: 94ed75ffd59294d5beb076ef4d66e57ef763f10e
ms.sourcegitcommit: 00e26915924869cd7eb3c971a7d0604388abd316
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/10/2019
ms.locfileid: "65525456"
---
# <a name="database-support-mfc-application-wizard"></a>MFC 应用程序向导的数据库支持

此页提供了选项，允许您指定数据库的级别为你的项目支持 （加上数据源，如有必要）。

- **数据库支持**

   设置为你的项目的数据库支持的级别。

   |选项|描述|
   |------------|-----------------|
   |**无**|提供了不支持数据库。 这是默认选项。|
   |**仅头文件**|为应用程序提供基本级别的数据库支持。 如果选择下的 ODBC 支持**客户端类型**，MFC 应用程序向导包括在项目中的标头文件 AFXDB。H. 添加链接库，但它不会创建任何数据库特定的类。 您可以更高版本创建记录集，并使用它们来检查和更新记录。 如果选择 OLE DB 支持下的**客户端类型**，将包含以下标头文件：ATLBASE。H AFXOLEDB。H ATLPLUS。H|
   |**不支持文件的数据库视图**|包括数据库标头文件、 链接库、 记录集和记录集。 (仅适用于应用程序与**文档/视图体系结构支持**中选择选项[应用程序类型](../../mfc/reference/application-type-mfc-application-wizard.md)页。)此选项将包括文档支持，但没有序列化支持。 如果您选择包含的数据库视图，必须指定数据源。|
   |**提供文件支持的数据库视图**|包括数据库标头文件、 链接库、 记录集和记录集。 (仅适用于应用程序与**文档/视图体系结构支持**中选择选项**应用程序类型**页。)此选项支持文档序列化，您可以使用，例如，若要更新用户配置文件。 数据库应用程序通常运行在每个记录的基础上而不是每个文件中的基础，因此不需要序列化。 但是，可以序列化的特殊用法。 如果您选择包含的数据库视图，必须指定数据源。|

   > [!NOTE]
   > 下**数据库支持**，如果您选择上述任何**数据库不支持文件的视图**或**数据库支持文件的视图**，视图类的派生不同，具体于在你**客户端类型**选择，按如下所示：

   - 如果选择**ODBC**下**客户端类型**，然后在应用程序的视图类派生自[CRecordView](../../mfc/reference/crecordview-class.md)。 此类相关联[CRecordset](../../mfc/reference/crecordset-class.md)-派生的类，MFC 应用程序向导还为你创建。 此选项可以使用记录视图来查看和更新其记录集中记录的基于窗体的应用程序。

   - 如果选择**OLE DB**下**客户端类型**，然后查看类派生自[COleDBRecordView](../../mfc/reference/coledbrecordview-class.md)，并与之关联[CTable](../../data/oledb/ctable-class.md)或[CCommand](../../data/oledb/ccommand-class.md)-派生的类。

- **客户端类型**

   指示项目是否使用 OLE DB 或 ODBC 类。

   |选项|描述|
   |------------|-----------------|
   |**OLE DB**|选中此选项后，单击**数据源**按钮将调用**数据链接属性**向导来帮助您创建的 OLE DB 数据源的连接。|
   |**ODBC**|选中此选项后，单击**数据源**按钮将调用**选择数据源**向导来帮助您创建到 ODBC 数据源的连接。|

- **数据源**

   > [!NOTE]
   > ATL OLE DB 使用者向导和 MFC ODBC 使用者向导不提供在 Visual Studio 2019 及更高版本。 您仍然可以手动添加功能。 有关详细信息，请参阅[创建无需使用者使用向导](../../data/oledb/creating-a-consumer-without-using-a-wizard.md)。

   单击**数据源**按钮，设置使用指定的驱动程序或提供程序和数据库的数据源。 如果选择了中的 OLE DB**客户端类型**选项，此按钮将显示**数据链接属性**对话框。 如果选择了中的 ODBC**客户端类型**选项，则此按钮提供**选择数据源**对话框。 仅当你选择要包括在你的应用程序中的数据库视图，则此选项不可用。

   |选项|描述|
   |------------|-----------------|
   |**数据链接属性**(OLE DB)|建立指定的数据源使用指定的 OLE DB 提供程序。 必须指定 OLE DB 访问接口、 数据、 数据源、 登录 ID 和 （可选） 密码的位置。 有关此对话框的详细信息，请参阅**数据源**中[ATL OLE DB 使用者向导](../../atl/reference/atl-ole-db-consumer-wizard.md)。|
   |**选择数据源**(ODBC)|建立指定的数据源使用指定的 ODBC 驱动程序。 必须选择数据源名称来选择数据源的表。 该向导将表中的所有列都绑定到的成员变量`CRecordset`-派生的类。 有关此对话框的详细信息，请参阅**数据源**中[MFC ODBC 使用者向导](../../mfc/reference/mfc-odbc-consumer-wizard.md)。|

- **生成特性化的数据库类**

   适用于 OLE DB 客户端。 指定是否在生成的项目中的数据库类使用属性。

- **绑定所有列**

   适用于 ODBC 客户端。 指定是否绑定中所选表的所有列。 如果选中此框，绑定所有列;如果不选择此框，没有列被绑定，并且必须手动在记录集类中绑定。

- **Type**

   适用于 ODBC 客户端。 指定记录集是动态集或快照下, 表中所述。

   |选项|描述|
   |------------|-----------------|
   |**动态集**|指定记录集是动态集。 动态集是查询的提供了为查询的数据库的数据的索引的视图的结果。 动态集缓存仅的原始数据的整数索引并提供了一个性能因此获得通过快照。 直接向每个记录的索引点找到作为查询结果，并指示是否删除一条记录。 查询记录中还有权访问更新的信息。|
   |**快照**|指定记录集是快照。 快照是将查询的结果，并且是时间点上的数据库。 作为查询结果中找到的所有记录会都缓存，因此你看不到对原始记录的任何更改。|

## <a name="see-also"></a>请参阅

[MFC 应用程序向导](../../mfc/reference/mfc-application-wizard.md)
