---
title: CMFCPopupMenu 类
ms.date: 10/18/2018
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
ms.openlocfilehash: 2f61c5aea825d85043ad273c640c4aabd38ebbb5
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/15/2019
ms.locfileid: "69505132"
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu 类

实现 Windows 弹出菜单功能，并通过添加可拖曳菜单和工具提示等功能进行扩展。
有关更多详细信息, 请参阅位于 Visual Studio 安装的**VC\\atlmfc\\src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## <a name="members"></a>成员

### <a name="protected-constructors"></a>受保护的构造函数

|name|描述|
|----------|-----------------|
|[CMFCPopupMenu:: CMFCPopupMenu](#cmfcpopupmenu)|构造 `CMFCPopupMenu` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|设置是否允许弹出菜单显示用户定义的工具的空项。|
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||
|[CMFCPopupMenu::CheckArea](#checkarea)|确定点相对于弹出菜单的位置。|
|[CMFCPopupMenu::CloseMenu](#closemenu)||
|[CMFCPopupMenu::Create](#create)|创建一个弹出菜单, 并将其附加到`CMFCPopupMenu`对象。|
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|初始化弹出菜单的徽标。|
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|启用菜单声音。|
|[CMFCPopupMenu::EnableResize](#enableresize)||
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|返回当前处于活动状态的菜单。|
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|返回弹出菜单的动画速度。|
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|返回弹出菜单动画的当前类型。|
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|指示在显示弹出菜单时是否将焦点返回到菜单栏中。|
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||
|[CMFCPopupMenu::GetHMenu](#gethmenu)|返回附加菜单资源的句柄。|
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|返回嵌入到弹出菜单中的[CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) 。|
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|返回指向指定索引处的菜单项的指针。|
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|返回弹出菜单中的项数。|
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|返回一个指针, 该指针指向框架路由弹出菜单消息的窗口。|
|[CMFCPopupMenu::GetParentArea](#getparentarea)||
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|返回指向父工具栏按钮的指针。|
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|返回指向父弹出菜单的指针。|
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|返回指向父工具栏的指针。|
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||
|[CMFCPopupMenu::GetSelItem](#getselitem)|返回指向当前选定菜单命令的指针。|
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||
|[CMFCPopupMenu:: HideRarelyUsedCommands](#hiderarelyusedcommands)|指示弹出菜单是否可以隐藏很少使用的命令。|
|[CMFCPopupMenu::InCommand](#incommand)||
|[CMFCPopupMenu::InsertItem](#insertitem)|在弹出菜单中的指定位置插入一个新项。|
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|在弹出菜单中的指定位置插入一个分隔符。|
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|指示弹出菜单是否作为**QuickCustomizePane**运行。|
|[CMFCPopupMenu::IsEscClose](#isescclose)||
|[CMFCPopupMenu::IsIdle](#isidle)|指示弹出菜单当前是否处于空闲状态。|
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|确定关联的[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)是否处于 QuickCustomize 模式。|
|[CMFCPopupMenu::IsResizeble](#isresizeble)||
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|指示菜单是右对齐还是左对齐。|
|[CMFCPopupMenu:: IsScrollable](#isscrollable)||
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|指示当用户从弹出菜单中选择一个命令时, 框架是否通知父框架。|
|[CMFCPopupMenu::IsShown](#isshown)|指示弹出菜单当前是否可见。|
|[CMFCPopupMenu::MoveTo](#moveto)||
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|（重写 `CFrameWnd::OnCmdMsg`。）|
|[CMFCPopupMenu::PostCommand](#postcommand)||
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|（重写 `CFrameWnd::PreTranslateMessage`。）|
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|当打开或关闭标准控件条或调整框架窗口大小时, 由框架调用。 (重写[CFrameWnd:: RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。)|
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|清除弹出菜单中的所有项。|
|[CMFCPopupMenu::RemoveItem](#removeitem)|从弹出菜单中删除指定项。|
|[CMFCPopupMenu::SaveState](#savestate)||
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|设置弹出菜单的动画速度。|
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|设置弹出菜单的动画类型。|
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|设置弹出菜单的默认命令。|
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|强制输入焦点在弹出菜单显示时返回到菜单栏。|
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|当弹出菜单出现在主框架之外时, 强制框架绘制菜单阴影。|
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|设置弹出菜单的最大宽度。|
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|设置弹出菜单的菜单对齐方式。|
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|设置一个标志, 该标志控制在用户选择命令时弹出菜单是否通知其父框架。|
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|强制弹出菜单显示所有命令。|
|[CMFCPopupMenu::TriggerResize](#triggerresize)||
|[CMFCPopupMenu::UpdateAllShadows](#updateallshadows)|更新所有打开的弹出菜单的阴影。|
|[CMFCPopupMenu::UpdateShadow](#updateshadow)|更新弹出菜单的阴影。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||

### <a name="remarks"></a>备注

通常, MFC 会自动创建弹出菜单。 如果要手动创建`CMFCPopupMenu`对象, 请在堆上分配一个对象, 然后调用[CMFCPopupMenu:: create](#create)。

## <a name="example"></a>示例

下面的示例演示如何配置弹出菜单对象。 该示例演示如何设置弹出菜单的徽标和声音、设置动画速度和类型、在弹出菜单出现在主框架外时绘制菜单阴影、设置最大宽度, 以及设置弹出菜单的右菜单对齐方式。 此代码片段是[自定义页面示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## <a name="requirements"></a>要求

**标头:** afxpopupmenu

##  <a name="activatepopupmenu"></a>CMFCPopupMenu:: ActivatePopupMenu

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### <a name="parameters"></a>参数

[in] *pTopFrame*<br/>
[in] *pPopupMenu*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="alwaysshowemptytoolsentry"></a>CMFCPopupMenu:: AlwaysShowEmptyToolsEntry

设置是否允许弹出菜单显示用户定义的工具的空项。

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### <a name="parameters"></a>参数

*bShow*<br/>
中如果弹出菜单可以显示空项, 则为 TRUE;否则为 FALSE。

##  <a name="areallcommandsshown"></a>CMFCPopupMenu:: AreAllCommandsShown

```
BOOL AreAllCommandsShown() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="checkarea"></a>CMFCPopupMenu:: CheckArea

确定点相对于弹出菜单的位置。

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### <a name="parameters"></a>参数

*ptScreen*<br/>
中屏幕坐标中的点。

### <a name="return-value"></a>返回值

指示点相对于弹出菜单的位置的 MENUAREA_TYPE 参数。

### <a name="remarks"></a>备注

MENUAREA_TYPE 参数可以具有下列值之一。

- 外部*ptScreen*不在弹出菜单的外部。

- 徽标- *ptScreen*在徽标区域上。

- TEAROFF_CAPTION- *ptScreen*超出了撕分隔的标题。

- SHADOW_BOTTOM- *ptScreen*位于弹出菜单的底部阴影。

- SHADOW_RIGHT- *ptScreen*位于弹出菜单的右阴影。

- *PtScreen*命令。

##  <a name="closemenu"></a>CMFCPopupMenu:: CloseMenu

```
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### <a name="parameters"></a>参数

[in] *bSetFocusToBar*<br/>

### <a name="remarks"></a>备注

##  <a name="cmfcpopupmenu"></a>CMFCPopupMenu:: CMFCPopupMenu

构造[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)对象。

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### <a name="parameters"></a>参数

*pCustPage*<br/>
中指向自定义页的指针。

*lpszTitle*<br/>
中包含菜单标题的字符串。

### <a name="remarks"></a>备注

此方法为`CMFCPopupMenu`分配资源。 若要创建弹出菜单项, 请调用[CMFCPopupMenu:: create](#create)。

##  <a name="create"></a>CMFCPopupMenu:: Create

创建一个弹出菜单, 并将其附加到[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)对象。

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### <a name="parameters"></a>参数

*pWndParent*<br/>
中的父窗口`CMFCPopupMenu`。

*x*<br/>
中弹出菜单位置的水平屏幕坐标

*y*<br/>
中弹出菜单位置的垂直屏幕坐标。

*hMenu*<br/>
中菜单资源的句柄。

*bLocked*<br/>
中布尔型参数, 指示菜单是否可自定义。 FALSE 指示弹出菜单可自定义。

*bOwnMessage*<br/>
中布尔型参数, 指示框架如何路由菜单消息。 有关更多详细信息, 请参阅 "备注" 部分。

### <a name="return-value"></a>返回值

如果方法成功, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

如果*bOwnMessage*为 TRUE, 则框架将所有菜单消息路由到*pWndParent*。 如果*bOwnMessage*为 TRUE, 则*pWndParent*不能为 NULL。 如果*bOwnMessage*为 FALSE, 则框架将菜单消息路由到父弹出菜单。

### <a name="example"></a>示例

下面的示例演示如何使用`Create` `CMFCPopuMenu`类的方法。 此代码片段是[自定义页面示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

##  <a name="createtearoffbar"></a>CMFCPopupMenu:: CreateTearOffBar

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>参数

[in] *pWndMain*<br/>
中*uiID*<br/>
[in] *lpszName*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="defaultmouseclickonclose"></a>CMFCPopupMenu::D efaultMouseClickOnClose

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="enablemenulogo"></a>CMFCPopupMenu:: EnableMenuLogo

初始化弹出菜单的徽标。

```
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### <a name="parameters"></a>参数

*iLogoSize*<br/>
中徽标的大小 (以像素为单位)。

*nLogoLocation*<br/>
中指示徽标位置的枚举数据类型。

### <a name="remarks"></a>备注

若要显示徽标, 请在主框架窗口中实现方法[CFrameWndEx:: OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo) 。

*NLogoLocation*的可能值为 MENU_LOGO_LEFT、MENU_LOGO_RIGHT、MENU_LOGO_TOP 和 MENU_LOGO_BOTTOM。

##  <a name="enablemenusound"></a>CMFCPopupMenu:: EnableMenuSound

启用菜单声音。

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要启用声音, 则为 TRUE; 否则为 FALSE。

### <a name="remarks"></a>备注

如果启用声音, 则当用户打开弹出菜单或选择菜单命令时, 框架将调用[PlaySound](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound)方法。 默认情况下, 此功能处于启用状态。

##  <a name="enableresize"></a>CMFCPopupMenu:: EnableResize

```
void EnableResize(CSize sizeMinResize);
```

### <a name="parameters"></a>参数

中*sizeMinResize*<br/>

### <a name="remarks"></a>备注

##  <a name="enablescrolling"></a>CMFCPopupMenu:: EnableScrolling

```
void EnableScrolling(BOOL = TRUE);
```

### <a name="parameters"></a>参数

中*BOOL*<br/>

### <a name="remarks"></a>备注

##  <a name="enablevertresize"></a>CMFCPopupMenu:: EnableVertResize

```
void EnableVertResize(int nMinResize);
```

### <a name="parameters"></a>参数

中*nMinResize*<br/>

### <a name="remarks"></a>备注

##  <a name="findsubitembycommand"></a>CMFCPopupMenu:: FindSubItemByCommand

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### <a name="parameters"></a>参数

中*uiCmd*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getactivemenu"></a>CMFCPopupMenu:: GetActiveMenu

返回当前处于活动状态的菜单。

```
static CMFCPopupMenu* GetActiveMenu();
```

### <a name="return-value"></a>返回值

指向活动弹出菜单的指针; 如果没有弹出菜单当前处于活动状态, 则为 NULL。

### <a name="remarks"></a>备注

每个应用程序最多可以有一个活动的弹出菜单。

##  <a name="getanimationspeed"></a>CMFCPopupMenu:: GetAnimationSpeed

返回弹出菜单的动画速度。

```
static UINT GetAnimationSpeed();
```

### <a name="return-value"></a>返回值

一个整数, 指示弹出菜单动画完成所用的时间 (以毫秒为单位)。

### <a name="remarks"></a>备注

动画速度是一个全局值。 使用[CMFCPopupMenu:: SetAnimationSpeed](#setanimationspeed)可更改弹出菜单的动画速度。

##  <a name="getanimationtype"></a>CMFCPopupMenu:: GetAnimationType

返回弹出动画的当前类型。

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### <a name="parameters"></a>参数

*bNoSystem*<br/>
中指示此方法是否检查全局值的布尔参数。 如果希望此方法返回[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)的此实例的动画样式, 则为 FALSE。

### <a name="return-value"></a>返回值

描述动画类型的枚举值。

### <a name="remarks"></a>备注

弹出菜单的动画样式对于您的应用程序是全局性的。 使用[CMFCPopupMenu:: SetAnimationType](#setanimationtype)设置动画样式。

下表列出了可能的动画类型。

|||
|-|-|
|NO_ANIMATION|弹出菜单不会进行动画处理并立即显示出来。  |
|展开|该框架从左上角到右下角显示弹出菜单。  |
|第|弹出菜单从上到下移动。  |
|淡化|弹出菜单首先显示透明, 并逐渐 solidifies。  |

##  <a name="getdropdirection"></a>CMFCPopupMenu:: GetDropDirection

```
DROP_DIRECTION GetDropDirection() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getforcemenufocus"></a>CMFCPopupMenu:: GetForceMenuFocus

指示在显示弹出菜单时是否将焦点返回到菜单栏中。

```
static BOOL GetForceMenuFocus();
```

### <a name="return-value"></a>返回值

如果在显示弹出菜单时将输入焦点返回到菜单栏, 则为 TRUE;如果弹出菜单保留焦点, 则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, 应用程序不会将焦点返回到菜单栏。 若要更改此设置, 请使用[CMFCPopupMenu:: SetForceMenuFocus](#setforcemenufocus)。

##  <a name="getforceshadow"></a>CMFCPopupMenu:: GetForceShadow

```
static BOOL __stdcall GetForceShadow();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="gethmenu"></a>CMFCPopupMenu:: GetHMenu

返回附加菜单资源的句柄。

```
HMENU GetHMenu();
```

##  <a name="getmenubar"></a>CMFCPopupMenu:: GetMenuBar

返回嵌入到弹出菜单中的[CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md) 。

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### <a name="return-value"></a>返回值

指向嵌入`CMFCPopupMenuBar`的的指针。

### <a name="remarks"></a>备注

弹出菜单具有嵌入`CMFCPopupMenuBar`的对象。 如果使用的是其他嵌入类, 则必须在派生类中重写此方法。

##  <a name="getmenuitem"></a>CMFCPopupMenu:: GetMenuItem

返回指向指定索引处的菜单项的指针。

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### <a name="parameters"></a>参数

*iIndex*<br/>
中菜单项的从零开始的索引。

### <a name="return-value"></a>返回值

指向菜单项的指针。 如果索引无效, 则为 NULL。

### <a name="remarks"></a>备注

菜单项由[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)表示。 调用此方法时, 它将返回一个指向相应`CMFCToolBarMenuButton`的的指针。

##  <a name="getmenuitemcount"></a>CMFCPopupMenu:: GetMenuItemCount

返回弹出菜单中的项数。

```
int GetMenuItemCount() const;
```

### <a name="return-value"></a>返回值

菜单中的项数。

##  <a name="getmessagewnd"></a>CMFCPopupMenu:: GetMessageWnd

返回一个指针, 该指针指向框架路由弹出菜单消息的窗口。

```
CWnd* GetMessageWnd() const;
```

### <a name="return-value"></a>返回值

指向接收弹出菜单消息的窗口的指针;如果没有窗口, 则为 NULL。

### <a name="remarks"></a>备注

使用方法[CMFCPopupMenu:: create](#create)创建弹出菜单时, 可以指定接收菜单消息的窗口。

##  <a name="getparentarea"></a>CMFCPopupMenu:: GetParentArea

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### <a name="parameters"></a>参数

[in] *rectParentBtn*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getparentbutton"></a>CMFCPopupMenu:: GetParentButton

返回指向父工具栏按钮的指针。

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### <a name="return-value"></a>返回值

指向父工具栏按钮的指针。 如果弹出菜单没有父工具栏按钮, 则为 NULL。

### <a name="remarks"></a>备注

`CMFCPopupMenu`可以与菜单上的按钮相关联。 在此方案中, 当用户选择父工具栏按钮时, 将显示弹出菜单。

如果弹出菜单是快捷菜单, 它将没有父工具栏按钮。

##  <a name="getparentpopupmenu"></a>CMFCPopupMenu:: GetParentPopupMenu

返回指向父弹出菜单的指针。

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### <a name="return-value"></a>返回值

指向父`CMFCPopupMenu`对象的指针;如果没有父弹出菜单, 则为 NULL。

### <a name="remarks"></a>备注

只有当弹出式菜单是子菜单时`CMFCPopupMenu` , 它才有父对象。

##  <a name="getparentribbonelement"></a>CMFCPopupMenu:: GetParentRibbonElement

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getparenttoolbar"></a>CMFCPopupMenu:: GetParentToolBar

返回指向父工具栏的指针。

```
CMFCToolBar* GetParentToolBar() const;
```

### <a name="return-value"></a>返回值

指向父工具栏的指针。 如果弹出菜单没有父工具栏, 则为 NULL。

### <a name="remarks"></a>备注

`CMFCPopupMenu`如果是快捷菜单, 则它没有父工具栏。

##  <a name="getquickcustomizetype"></a>CMFCPopupMenu:: GetQuickCustomizeType

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getselitem"></a>CMFCPopupMenu:: GetSelItem

返回指向当前选定菜单命令的指针。

```
CMFCToolBarMenuButton* GetSelItem();
```

### <a name="return-value"></a>返回值

指向当前选定菜单命令的指针;如果未选择任何项, 则为 NULL。

### <a name="remarks"></a>备注

弹出菜单上的菜单命令由[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)或从`CMFCToolBarMenuButton`派生的类表示。

##  <a name="hasbeenresized"></a>CMFCPopupMenu:: HasBeenResized

```
BOOL HasBeenResized() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="hiderarelyusedcommands"></a>CMFCPopupMenu:: HideRarelyUsedCommands

指示弹出菜单是否可以隐藏很少使用的命令。

```
BOOL HideRarelyUsedCommands() const;
```

### <a name="return-value"></a>返回值

如果弹出菜单可以隐藏很少使用的命令, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法仅指定弹出菜单是否可以隐藏很少使用的命令, 而不指定启用该配置的情况。 如果弹出菜单具有父按钮并且父窗口是从[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)派生的, 则弹出菜单可以隐藏很少使用的命令。 使用[CMFCMenuBar:: SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus)启用此功能, 并使用[CMFCMenuBar:: IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus)来确定当前是否启用了此功能。 您必须为父窗口调用这两种方法。

##  <a name="incommand"></a>CMFCPopupMenu:: InCommand

```
virtual BOOL InCommand();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="insertitem"></a>CMFCPopupMenu:: InsertItem

在弹出菜单中的指定位置插入一个新项。

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### <a name="parameters"></a>参数

*鼠标*<br/>
中对要添加的菜单项的引用。

*iInsertAt*<br/>
中新项的从零开始的索引。 如果*iInsertAt*为-1, 则将该项添加到菜单的末尾。

### <a name="return-value"></a>返回值

插入项的位置的从零开始的索引。 如果该方法失败, 则为-1。

### <a name="remarks"></a>备注

如果为*iInsertAt*提供了无效的值 (例如, 大于弹出菜单上当前的项数), 则此方法将失败。

##  <a name="insertseparator"></a>CMFCPopupMenu:: InsertSeparator

在弹出菜单中的指定位置插入一个分隔符。

```
int InsertSeparator(int iInsertAt = -1);
```

### <a name="parameters"></a>参数

*iInsertAt*<br/>
中此方法将插入分隔符的位置的从零开始的索引。

### <a name="return-value"></a>返回值

插入分隔符的位置的从零开始的索引。 如果此方法失败, 则为-1。

### <a name="remarks"></a>备注

对于*iInsertAt* , 值为-1 表示此方法将分隔符添加到弹出菜单的末尾。

如果*iInsertAt*是无效的值, 则此方法将失败。

##  <a name="isalwaysclose"></a>CMFCPopupMenu:: IsAlwaysClose

```
virtual BOOL IsAlwaysClose() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isalwaysshowemptytoolsentry"></a>CMFCPopupMenu:: IsAlwaysShowEmptyToolsEntry

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="iscustomizepane"></a>CMFCPopupMenu:: IsCustomizePane

指示弹出菜单是否作为**QuickCustomizePane**运行。

```
BOOL IsCustomizePane();
```

### <a name="return-value"></a>返回值

如果弹出窗口是**QuckCustomizePane**, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

使用**QuickCustomizePane**可使用户直接自定义弹出菜单。 **QuickCustomizePane**是`CMFCPopupMenu`当用户单击工具栏按钮直接编辑它时显示的。

应用程序应在[CMDIFrameWndEx:: OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane)期间调用此方法。

##  <a name="isescclose"></a>CMFCPopupMenu:: IsEscClose

```
BOOL IsEscClose();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isidle"></a>CMFCPopupMenu:: IsIdle

指示弹出菜单当前是否处于空闲状态。

```
virtual BOOL IsIdle() const;
```

### <a name="return-value"></a>返回值

如果弹出菜单处于空闲模式, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, 如果显示动画完成并且用户未滚动弹出菜单, 则弹出菜单处于空闲模式。

##  <a name="ismenusound"></a>CMFCPopupMenu:: IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isquickcustomize"></a>CMFCPopupMenu:: IsQuickCustomize

确定关联的[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)是否处于 QuickCustomize 模式。

```
BOOL IsQuickCustomize();
```

### <a name="return-value"></a>返回值

如果关联的菜单按钮处于 QuickCustomize 模式下, 则为 TRUE;否则为 FALSE。 如果弹出菜单`CMFCToolBarMenuButton`与无关, 则此方法也会返回 FALSE。

### <a name="remarks"></a>备注

在 QuickCustomize 模式中, 用户可以选择工具栏上的按钮直接自定义按钮。

##  <a name="isresizeble"></a>CMFCPopupMenu:: IsResizeble

```
BOOL IsResizeble() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isrightalign"></a>CMFCPopupMenu:: IsRightAlign

指示菜单是右对齐还是左对齐。

```
BOOL IsRightAlign() const;
```

### <a name="return-value"></a>返回值

如果菜单右对齐, 则为 TRUE; 否则为。如果菜单左对齐, 则为 FALSE。

### <a name="remarks"></a>备注

可以使用[CMFCPopupMenu:: SetRightAlign](#setrightalign)设置菜单对齐方式。 默认情况下, 弹出菜单使用左对齐。

菜单对齐不是全局设置, 可以在弹出菜单之间变化。

##  <a name="isscrollable"></a>CMFCPopupMenu:: IsScrollable

```
BOOL IsScrollable() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="issendmenuselectmsg"></a>CMFCPopupMenu:: IsSendMenuSelectMsg

指示当用户从弹出菜单中选择一个命令时, 框架是否通知父框架。

```
static BOOL IsSendMenuSelectMsg();
```

### <a name="return-value"></a>返回值

如果框架通知父框架, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

当使用的选择菜单命令时, 框架通过向父框架发送 WM_MENUSELECT 消息来通知父框架。

##  <a name="isshown"></a>CMFCPopupMenu:: IsShown

指示弹出菜单当前是否可见。

```
BOOL IsShown() const;
```

### <a name="return-value"></a>返回值

如果弹出菜单可见, 则为 TRUE;否则为 FALSE。

##  <a name="moveto"></a>CMFCPopupMenu:: MoveTo

```
void MoveTo(const CPoint& pt);
```

### <a name="parameters"></a>参数

[in] *pt*<br/>

### <a name="remarks"></a>备注

##  <a name="onchangehot"></a>CMFCPopupMenu:: OnChangeHot

```
virtual void OnChangeHot(int nHot);
```

### <a name="parameters"></a>参数

中*nHot*<br/>

### <a name="remarks"></a>备注

##  <a name="onchooseitem"></a>CMFCPopupMenu:: OnChooseItem

```
virtual void OnChooseItem(UINT uidCmdID);
```

### <a name="parameters"></a>参数

[in] *uidCmdID*<br/>

### <a name="remarks"></a>备注

##  <a name="oncmdmsg"></a>CMFCPopupMenu:: OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>参数

中*nID*<br/>
中*nCode*<br/>
中*pExtra*<br/>
[in] *pHandlerInfo*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="postcommand"></a>CMFCPopupMenu::P ostCommand

```
BOOL PostCommand(UINT uiCommandID);
```

### <a name="parameters"></a>参数

中*uiCommandID*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="pretranslatemessage"></a>CMFCPopupMenu::P reTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>参数

中*pMsg*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="recalclayout"></a>CMFCPopupMenu:: RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>参数

中*bNotify*<br/>

### <a name="remarks"></a>备注

##  <a name="removeallitems"></a>  CMFCPopupMenu::RemoveAllItems

清除弹出菜单中的所有项。

```
void RemoveAllItems();
```

##  <a name="removeitem"></a>CMFCPopupMenu:: RemoveItem

从弹出菜单中删除指定项。

```
BOOL RemoveItem(int iIndex);
```

### <a name="parameters"></a>参数

*iIndex*<br/>
中要删除的项的从零开始的索引。

### <a name="return-value"></a>返回值

如果方法成功, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法自动排列受项目删除影响的任何分隔符。 有关框架如何重排分隔符的详细信息, 请参阅[CMFCToolBar:: RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton)。

##  <a name="savestate"></a>CMFCPopupMenu:: SaveState

```
virtual void SaveState();
```

### <a name="remarks"></a>备注

##  <a name="setanimationspeed"></a>CMFCPopupMenu:: SetAnimationSpeed

设置弹出菜单的动画速度。

```
static void SetAnimationSpeed(UINT nElapse);
```

### <a name="parameters"></a>参数

*nElapse*<br/>
中新动画的速度 (以毫秒为单位)。

### <a name="remarks"></a>备注

动画速度是全局值, 会影响应用程序中的所有弹出菜单。 此值指定弹出菜单的动画完成所用的时间。

默认情况下, 此参数设置为30毫秒。 *NElapse*的有效值范围为0到200。

##  <a name="setanimationtype"></a>CMFCPopupMenu:: SetAnimationType

设置此弹出菜单的动画类型。

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### <a name="parameters"></a>参数

*type*<br/>
中指定动画类型的枚举数据类型。

### <a name="remarks"></a>备注

有关*类型*的有效值的列表, 请参阅[CMFCPopupMenu:: GetAnimationType](#getanimationtype) 。

##  <a name="setautodestroy"></a>CMFCPopupMenu:: SetAutoDestroy

```
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### <a name="parameters"></a>参数

中*bAutoDestroy*<br/>

### <a name="remarks"></a>备注

##  <a name="setdefaultitem"></a>CMFCPopupMenu:: SetDefaultItem

设置弹出菜单的默认命令。

```
void SetDefaultItem(UINT uiCmd);
```

### <a name="parameters"></a>参数

*uiCmd*<br/>
中新默认命令的菜单命令 ID。

### <a name="remarks"></a>备注

弹出菜单中的默认命令是在弹出菜单显示时所选择的命令。

##  <a name="setforcemenufocus"></a>CMFCPopupMenu:: SetForceMenuFocus

强制输入焦点在弹出菜单显示时返回到菜单栏。

```
static void SetForceMenuFocus(BOOL bValue);
```

### <a name="parameters"></a>参数

*bValue*<br/>
中如果希望框架在显示弹出菜单时强制将输入焦点移到菜单栏, 则为 TRUE。 如果希望弹出菜单保留焦点, 则为 FALSE。

### <a name="remarks"></a>备注

此方法为应用程序中的所有弹出菜单设置全局标志。 默认情况下, 不启用此功能。

##  <a name="setforceshadow"></a>CMFCPopupMenu:: SetForceShadow

当弹出菜单出现在主框架之外时, 强制框架绘制菜单阴影。

```
static void SetForceShadow(BOOL bValue);
```

### <a name="parameters"></a>参数

*bValue*<br/>
中如果希望框架绘制菜单阴影, 则为 TRUE; 否则为 FALSE。

### <a name="remarks"></a>备注

调用此方法时, 它会在你的应用程序中设置全局标志。 此标志影响应用程序中的所有弹出菜单。

##  <a name="setmaxwidth"></a>CMFCPopupMenu:: SetMaxWidth

设置弹出菜单的最大宽度。

```
void SetMaxWidth(int iMaxWidth);
```

### <a name="parameters"></a>参数

*iMaxWidth*<br/>
中弹出菜单的最大宽度 (以像素为单位)。

### <a name="remarks"></a>备注

如果与某个菜单命令相关联的文本将不能适应最大宽度, 则该文本将被截断, 并且不适合的部分将替换为三个点。

##  <a name="setmessagewnd"></a>CMFCPopupMenu:: SetMessageWnd

```
void SetMessageWnd(CWnd* pMsgWnd);
```

### <a name="parameters"></a>参数

中*pMsgWnd*<br/>

### <a name="remarks"></a>备注

##  <a name="setparentribbonelement"></a>CMFCPopupMenu:: SetParentRibbonElement

```
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>参数

中*pElem*<br/>

### <a name="remarks"></a>备注

##  <a name="setquickcustomizetype"></a>CMFCPopupMenu:: SetQuickCustomizeType

```
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### <a name="parameters"></a>参数

中*类型*<br/>

### <a name="remarks"></a>备注

##  <a name="setquickmode"></a>CMFCPopupMenu:: SetQuickMode

```
void SetQuickMode();
```

### <a name="remarks"></a>备注

##  <a name="setrightalign"></a>CMFCPopupMenu:: SetRightAlign

设置弹出菜单的菜单对齐方式。

```
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### <a name="parameters"></a>参数

*bRightAlign*<br/>
中指示菜单对齐方式的布尔值。 TRUE 表示右对齐, FALSE 表示左对齐。

### <a name="remarks"></a>备注

默认情况下, 所有弹出菜单都是左对齐菜单。

##  <a name="setsendmenuselectmsg"></a>CMFCPopupMenu:: SetSendMenuSelectMsg

设置一个标志, 该标志控制在用户选择命令时弹出菜单是否通知其父框架。

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
中如果弹出菜单通知其父框架, 则为 TRUE; 否则为 FALSE。

### <a name="remarks"></a>备注

这是应用程序中的所有弹出菜单的全局选项。 如果启用, 弹出菜单将在用户选择命令时向父框架发送 WM_MENUSELECT 消息。

##  <a name="showallcommands"></a>CMFCPopupMenu:: ShowAllCommands

强制弹出菜单显示所有命令。

```
void ShowAllCommands();
```

### <a name="remarks"></a>备注

这不是全局设置, 仅影响当前的弹出菜单。

##  <a name="triggerresize"></a>CMFCPopupMenu:: TriggerResize

```
void TriggerResize();
```

### <a name="remarks"></a>备注

##  <a name="updateallshadows"></a>CMFCPopupMenu:: UpdateAllShadows

更新所有打开的弹出菜单的阴影。

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>参数

*lprectScreen*<br/>
中在屏幕坐标中指定要更新的区域的矩形。

### <a name="remarks"></a>备注

当弹出菜单显示在具有动态内容的动画控件或其他窗口上时, 此方法非常有用。

##  <a name="updateshadow"></a>CMFCPopupMenu:: UpdateShadow

更新弹出菜单的阴影。

```
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>参数

*lprectScreen*<br/>
中以屏幕坐标表示的矩形, 指定要更新的区域的边界。

### <a name="remarks"></a>备注

当具有阴影的弹出菜单与动画图像重叠时, 调用此方法。

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)
