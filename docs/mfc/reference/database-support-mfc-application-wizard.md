---
title: MFC 应用程序向导的数据库支持
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: c13d56d2fee45e130aba81168188bec6d8828d51
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365879"
---
# <a name="database-support-mfc-application-wizard"></a>MFC 应用程序向导的数据库支持

此页提供了允许您为项目指定数据库支持级别（如有必要，包括数据源）的选项。

- **数据库支持**

   设置项目的数据库支持级别。

   |选项|说明|
   |------------|-----------------|
   |**无**|不提供数据库支持。 这是默认选项。|
   |**仅标题文件**|为应用程序提供基本级别的数据库支持。 如果在**客户端类型**下选择 ODBC 支持，MFC 应用程序向导将标题文件 AFXDB 包括在项目中。H。 它添加链接库，但不会创建任何特定于数据库的类。 您可以稍后创建记录集，并使用它们来检查和更新记录。 如果在**客户端类型**下选择 OLE DB 支持，则包括以下标头文件：ATLBASE。H AFXOLEDB。H ATLPLUS。H|
   |**没有文件支持的数据库视图**|包括数据库标头文件、链接库、记录视图和记录集。 （仅适用于在["应用程序类型"](../../mfc/reference/application-type-mfc-application-wizard.md)页中选择**的文档/视图体系结构支持**选项的应用程序。此选项包括文档支持，但不支持序列化。 如果选择包括数据库视图，则必须指定数据源。|
   |**支持文件的数据库视图**|包括数据库标头文件、链接库、记录视图和记录集。 （仅适用于在 **"应用程序类型"** 页中选择**的文档/视图体系结构支持**选项的应用程序。此选项支持文档序列化，例如，您可以使用该序列化来更新用户配置文件文件。 数据库应用程序通常以每记录为基础，而不是基于每个文件运行，因此不需要序列化。 但是，您可能有序列化的特殊用途。 如果选择包括数据库视图，则必须指定数据源。|

   > [!NOTE]
   > 在 **"数据库支持**"下，如果选择**没有文件支持的数据库视图**或**具有文件支持的数据库视图**，则视图类派生会因**客户端类型**选择而异，如下所示：

  - 如果在**客户端类型**下选择**ODBC，** 则应用程序的视图类派生自[CRecordView](../../mfc/reference/crecordview-class.md)。 此类与[CRecordset](../../mfc/reference/crecordset-class.md)派生类相关联，MFC 应用程序向导还会为您创建该类。 此选项提供了一个基于窗体的应用程序，其中记录视图用于通过其记录集查看和更新记录。

  - 如果在**客户端类型**下选择**OLE DB，** 则视图类派生自[COleDBRecordView](../../mfc/reference/coledbrecordview-class.md)，并且它与[CTable](../../data/oledb/ctable-class.md)或[CCommand](../../data/oledb/ccommand-class.md)派生类相关联。

- **客户端类型**

   指示项目是使用 OLE DB 还是 ODBC 类。

   |选项|说明|
   |------------|-----------------|
   |**OLE DB**|选择此选项后，单击 **"数据源**"按钮将调用 **"数据链接属性**"向导，以帮助您创建与 OLE 数据库数据源的连接。|
   |**ODBC**|选择此选项后，单击 **"数据源**"按钮将调用 **"选择数据源**"向导，以帮助您创建到 ODBC 数据源的连接。|

- **数据源**

   > [!NOTE]
   > ATL OLE DB 消费者向导和 MFC ODBC 使用者向导在 Visual Studio 2019 及更高版本中不可用。 但仍可以手动添加此功能。 有关详细信息，请参阅[不使用向导创建使用者](../../data/oledb/creating-a-consumer-without-using-a-wizard.md)。

   单击 **"数据源**"按钮可使用指定的驱动程序或提供程序和数据库设置数据源。 如果在 **"客户端类型"** 选项中选择 OLE DB，则此按钮将显示 **"数据链接属性**"对话框。 如果在 **"客户端类型"** 选项中选择 ODBC，则此按钮提供 **"选择数据源**"对话框。 仅当选择在应用程序中包含数据库视图时，此选项才可用。

   |选项|说明|
   |------------|-----------------|
   |**数据链路属性**（OLE DB）|使用指定的 OLE DB 提供程序建立指定的数据源。 您必须指定 OLE DB 提供程序、数据的位置、数据源、登录 ID 和（可选）密码。 有关此对话框的详细信息，请参阅[ATL OLE DB 消费者向导](../../atl/reference/atl-ole-db-consumer-wizard.md)中的**数据源**。|
   |**选择数据源**（ODBC）|使用指定的 ODBC 驱动程序建立指定的数据源。 您必须选择数据源名称才能为数据源选择表。 向导将表的所有列绑定到`CRecordset`派生类的成员变量。 有关此对话框的详细信息，请参阅[MFC ODBC 消费者向导](../../mfc/reference/mfc-odbc-consumer-wizard.md)中的**数据源**。|

- **生成属性化数据库类**

   仅适用于 OLE DB 客户端。 指定生成的项目中的数据库类是否使用属性。

- **绑定所有列**

   仅适用于 ODBC 客户端。 指定是否绑定所选表中的所有列。 如果选择此框，则绑定所有列;如果选择此框，则为所有列绑定。如果不选择此框，则不会绑定任何列，并且必须在记录集类中手动绑定它们。

- **Type**

   仅适用于 ODBC 客户端。 指定记录集是动态集还是快照，如下表所述。

   |选项|说明|
   |------------|-----------------|
   |**动态集**|指定记录集是动态集。 动态集是查询的结果，该查询向查询数据库的数据提供索引视图。 动态集仅缓存原始数据的整体索引，因此比快照提供性能提升。 索引直接指向查询结果找到的每个记录，并指示是否删除了记录。 您还可以访问查询记录中的更新信息。|
   |**快照**|指定记录集是快照。 快照是查询的结果，是某个时间点对数据库的视图。 查询结果找到的所有记录都将被缓存，因此您看不到对原始记录的任何更改。|

## <a name="see-also"></a>另请参阅

[MFC 应用程序向导](../../mfc/reference/mfc-application-wizard.md)
