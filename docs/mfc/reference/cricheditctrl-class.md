---
title: CRichEditCtrl 类
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 5517efca66744c43eeccd3fb91b97a6fedc8180e
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/01/2019
ms.locfileid: "58779269"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl 类

提供 Rich Edit 控件功能。

## <a name="syntax"></a>语法

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|构造 `CRichEditCtrl` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CRichEditCtrl::CanPaste](#canpaste)|确定是否可以将剪贴板的内容粘贴到此 rich edit 控件。|
|[CRichEditCtrl::CanRedo](#canredo)|确定是否在控件的重做队列中的任何操作。|
|[CRichEditCtrl::CanUndo](#canundo)|确定是否可撤消的编辑操作。|
|[CRichEditCtrl::CharFromPos](#charfrompos)|检索有关与编辑控件的工作区中的指定点最接近的字符的信息。|
|[CRichEditCtrl::Clear](#clear)|清除当前所选内容。|
|[CRichEditCtrl::Copy](#copy)|将当前所选内容复制到剪贴板。|
|[CRichEditCtrl::Create](#create)|创建 Windows rich edit 控件，并将其与此相关联`CRichEditCtrl`对象。|
|[CRichEditCtrl::CreateEx](#createex)|创建 Windows rich edit 控件具有指定扩展 Windows 样式并将其关联与此`CRichEditCtrl`对象。|
|[CRichEditCtrl::Cut](#cut)|剪切到剪贴板当前所选内容。|
|[CRichEditCtrl::DisplayBand](#displayband)|显示此内容的部分`CRichEditCtrl`对象。|
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|重置 （清除） 的撤消标志`CRichEditCtrl`对象。|
|[CRichEditCtrl::FindText](#findtext)|查找在此文本`CRichEditCtrl`对象。|
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|查找下一个单词断点之前或之后的指定的字符位置，或检索该位置处字符的信息。|
|[CRichEditCtrl::FormatRange](#formatrange)|设置的目标输出设备的文本范围的格式。|
|[CRichEditCtrl::GetCharPos](#getcharpos)|确定给定字符在此位置`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|检索当前的默认字符格式设置特性在此`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetEventMask](#geteventmask)|检索此事件掩码`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|确定在此最顶层的可见行`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|检索指向的`IRichEditOle`此 rich edit 控件的接口。|
|[CRichEditCtrl::GetLimitText](#getlimittext)|获取用户可以向此输入的文本量的限制`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetLine](#getline)|检索文本行从此`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetLineCount](#getlinecount)|检索此中的行数`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetModify](#getmodify)|确定此内容`CRichEditCtrl`对象自上次保存以来已更改。|
|[CRichEditCtrl::GetOptions](#getoptions)|检索格式文本编辑控件选项。|
|[CRichEditCtrl::GetParaFormat](#getparaformat)|检索段落格式设置当前选定内容中此特性`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|检索格式文本编辑控件的当前标点字符。 此消息是操作系统的仅在亚洲语言版本中可用。|
|[CRichEditCtrl::GetRect](#getrect)|检索此格式化矩形`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetRedoName](#getredoname)|如果任何在控件的重做队列中检索的下一步操作的类型。|
|[CRichEditCtrl::GetSel](#getsel)|获取起始和结束位置的当前选定内容中这`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|检索格式设置当前选定内容中此特性的字符`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|检索当前选定内容中此内容类型`CRichEditCtrl`对象。|
|[CRichEditCtrl::GetSelText](#getseltext)|在此获取当前选择的文本`CRichEditCtrl`对象|
|[CRichEditCtrl::GetTextLength](#gettextlength)|检索的文本，以字符为单位，在此长度`CRichEditCtrl`对象。 不包括终止 null 字符。|
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|检索字符或 rich edit 视图中的字节的数。 接受标志以指示确定格式文本编辑控件中的文本的长度的方法的列表|
|[CRichEditCtrl::GetTextMode](#gettextmode)|检索格式文本编辑控件的当前文本模式和撤消级别。|
|[CRichEditCtrl::GetTextRange](#gettextrange)|检索指定的范围的文本。|
|[CRichEditCtrl::GetUndoName](#getundoname)|如果任何，检索下一步的撤消操作的类型。|
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|检索当前的自动换行和 rich edit 控件的 word 换行选项。 此消息是操作系统的仅在亚洲语言版本中可用。|
|[CRichEditCtrl::HideSelection](#hideselection)|显示或隐藏当前所选内容。|
|[CRichEditCtrl::LimitText](#limittext)|限制用户可以向输入的文本量`CRichEditCtrl`对象。|
|[CRichEditCtrl::LineFromChar](#linefromchar)|确定哪一行包含给定的字符。|
|[CRichEditCtrl::LineIndex](#lineindex)|检索在给定行的字符索引`CRichEditCtrl`对象。|
|[CRichEditCtrl::LineLength](#linelength)|检索在给定行的长度`CRichEditCtrl`对象。|
|[CRichEditCtrl::LineScroll](#linescroll)|在此文本滚动`CRichEditCtrl`对象。|
|[CRichEditCtrl::Paste](#paste)|将剪贴板的内容插入到此 rich edit 控件。|
|[CRichEditCtrl::PasteSpecial](#pastespecial)|将剪贴板的内容插入到此 rich edit 控件中指定的数据格式。|
|[CRichEditCtrl::PosFromChar](#posfromchar)|检索指定的字符的编辑控件中的客户端区域坐标。|
|[CRichEditCtrl::Redo](#redo)|重做控件的重做队列中的下一步操作。|
|[CRichEditCtrl::ReplaceSel](#replacesel)|将替换当前选定内容中这`CRichEditCtrl`具有指定文本的对象。|
|[CRichEditCtrl::RequestResize](#requestresize)|这将强制`CRichEditCtrl`要发送的请求重设大小通知对象。|
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|指示自动 URL 检测是否在 rich edit 控件中处于活动状态。|
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|在此设置的背景色`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|设置当前的默认字符格式设置特性在此`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetEventMask](#seteventmask)|设置此事件掩码`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetModify](#setmodify)|设置或清除修改标志`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetOLECallback](#setolecallback)|集`IRichEditOleCallback`此 rich edit 控件的 COM 对象。|
|[CRichEditCtrl::SetOptions](#setoptions)|设置此选项`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetParaFormat](#setparaformat)|设置段落格式设置当前选定内容中此特性`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|设置格式文本编辑控件的标点字符。 此消息是操作系统的仅在亚洲语言版本中可用。|
|[CRichEditCtrl::SetReadOnly](#setreadonly)|设置此只读选项`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetRect](#setrect)|设置此格式化矩形`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetSel](#setsel)|在此设置选择`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|设置字符格式设置当前选定内容中此特性`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|设置此目标输出设备`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetTextMode](#settextmode)|设置格式文本编辑控件的文本模式或撤消级别。 如果控件包含文本，该消息将失败。|
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|设置可以存储在撤消队列中的操作的最大数目。|
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|设置字符格式设置属性当前单词中这`CRichEditCtrl`对象。|
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|丰富的自动换行和断字选项集的编辑控件。 此消息是操作系统的仅在亚洲语言版本中可用。|
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|停止附加到当前的撤消操作键入操作收集控件。 如果有，到撤消队列中的新操作，该控件将存储的下一步的类型化操作。|
|[CRichEditCtrl::StreamIn](#streamin)|将从输入流的文本插入到此`CRichEditCtrl`对象。|
|[CRichEditCtrl::StreamOut](#streamout)|将从该文本存储`CRichEditCtrl`到输出流对象。|
|[CRichEditCtrl::Undo](#undo)|反转最后一次编辑操作。|

## <a name="remarks"></a>备注

"格式文本编辑控件"是一个窗口，用户可以输入和编辑文本。 文本字符和段落格式设置，可以分配，并且可以包含嵌入的 OLE 对象。 Rich edit 控件提供用于设置文本格式的编程接口。 但是，应用程序必须实现使用户可进行格式设置操作所需的任何用户界面组件。

此 Windows 公共控件 (并因此`CRichEditCtrl`类) 仅适用于在 Windows 95/98 和 Windows NT 版本 3.51 下运行的程序和更高版本。 `CRichEditCtrl`类支持版本 2.0 和 3.0 的 Windows SDK rich edit 控件。

> [!CAUTION]
>  如果在对话框中使用格式文本编辑控件 (无论是否在应用程序是 SDI、 MDI 还是基于对话框的)，必须调用[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)框显示对话框之前后。 调用此函数的一个典型位置位于程序的 `InitInstance` 成员函数中。 您无需在每次显示对话框时调用它，仅第一次需要。 如果您使用 `AfxInitRichEdit`，则不必调用 `CRichEditView`。

有关详细信息使用`CRichEditCtrl`，请参阅：

- [控件](../../mfc/controls-mfc.md)

- [使用 CRichEditCtrl](../../mfc/using-cricheditctrl.md)

在 MFC 应用程序中使用格式文本编辑控件的示例，请参阅[写字板](../../overview/visual-cpp-samples.md)示例应用程序。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>要求

**标头：** afxcmn.h

##  <a name="canpaste"></a>  CRichEditCtrl::CanPaste

确定格式文本编辑控件可以粘贴指定的剪贴板格式。

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>参数

*nFormat*<br/>
查询剪贴板数据格式。 此参数可以是预定义的剪贴板格式或返回的值之一[RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata)。

### <a name="return-value"></a>返回值

如果可以粘贴剪贴板格式; 非零值否则为 0。

### <a name="remarks"></a>备注

如果*nFormat*为 0，`CanPaste`将尝试剪贴板中当前的任何格式。

有关详细信息，请参阅[EM_CANPASTE](/windows/desktop/Controls/em-canpaste)消息并[RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata) Windows SDK 中的函数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

##  <a name="canredo"></a>  CRichEditCtrl::CanRedo

确定是否重做队列包含的任何操作。

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>返回值

如果重做队列包含的操作，否则为 0，非零值。

### <a name="remarks"></a>备注

若要了解重做队列中的操作的名称，调用[CRichEditCtrl::GetRedoName](#getredoname)。 若要重做最新的撤消操作，请调用[重做](#redo)。

有关详细信息，请参阅[EM_CANREDO](/windows/desktop/Controls/em-canredo) Windows SDK 中。

##  <a name="canundo"></a>  CRichEditCtrl::CanUndo

确定是否可撤消的上一个编辑操作。

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>返回值

如果可以通过调用撤消上一个编辑操作的非零[撤消](#undo)成员函数; 如果无法撤消，则为 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_CANUNDO](/windows/desktop/Controls/em-canundo) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

##  <a name="charfrompos"></a>  CRichEditCtrl::CharFromPos

检索有关由参数指定点处的字符的信息*pt*。

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>参数

*pt*<br/>
一个[CPoint](../../atl-mfc-shared/reference/cpoint-class.md)对象，其中包含指定点的坐标。

### <a name="return-value"></a>返回值

最接近指定点的字符从零开始的字符索引。 如果指定的点不在控件中的最后一个字符，则返回值指示在控件中的最后一个字符。

### <a name="remarks"></a>备注

此成员函数适用于 rich edit 控件。 若要获取的编辑控件的信息，请调用[CEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)。

有关详细信息，请参阅[EM_CHARFROMPOS](/windows/desktop/Controls/em-charfrompos) Windows SDK 中。

##  <a name="clear"></a>  CRichEditCtrl::Clear

删除 （清除） 中当前选定内容 （如果有） 丰富的编辑控件。

```
void Clear();
```

### <a name="remarks"></a>备注

删除由`Clear`可以通过调用撤消[撤消](#undo)成员函数。

若要删除当前所选内容并放置到剪贴板上已删除的内容，请调用[剪切](#cut)成员函数。

有关详细信息，请参阅[WM_CLEAR](/windows/desktop/dataxchg/wm-clear) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

##  <a name="copy"></a>  CRichEditCtrl::Copy

将复制当前所选内容 （如果有） 在 rich edit 控件到剪贴板。

```
void Copy();
```

### <a name="remarks"></a>备注

有关详细信息，请参阅[WM_COPY](/windows/desktop/dataxchg/wm-copy) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

##  <a name="create"></a>  CRichEditCtrl::Create

创建 Windows rich edit 控件，并将其与此相关联`CRichEditCtrl`对象。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
指定编辑控件的样式。 应用中列出的窗口样式的组合**备注**以下部分，并[编辑控件样式](/windows/desktop/Controls/edit-control-styles)Windows SDK 中所述。

*rect*<br/>
指定编辑控件的大小和位置。 可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](/windows/desktop/api/windef/ns-windef-tagrect)结构。

*pParentWnd*<br/>
指定编辑控件的父窗口 (通常[CDialog](../../mfc/reference/cdialog-class.md))。 它不能为 NULL。

*nID*<br/>
指定编辑控件的 id。

### <a name="return-value"></a>返回值

如果初始化成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

构造`CRichEditCtrl`两个步骤中的对象。 首先，调用[CRichEditCtrl](#cricheditctrl)构造函数，然后调用`Create`，它创建 Windows 编辑控件并将其附加到`CRichEditCtrl`对象。

使用此函数创建 rich edit 控件，首先，必须加载必要的公共控件库。 若要加载的库，调用全局函数[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)，这反过来初始化公共控件库。 您需要调用`AfxInitRichEdit`仅一次是在你的过程。

当`Create`执行时，Windows 将发送[WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)， [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)， [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)，并且[WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)在编辑控件的消息。

默认情况下处理这些消息[OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate)， [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize)， [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)，以及[OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)成员函数在`CWnd`基类。 若要扩展的默认消息处理，从派生类`CRichEditCtrl`、 将消息映射添加到新的类，并重写上面的消息处理程序成员函数。 重写`OnCreate`，例如，若要执行的新类所需的初始化。

将以下内容应用[的窗口样式](../../mfc/reference/styles-used-by-mfc.md#window-styles)到编辑控件。

- 始终 WS_CHILD。

- 通常 WS_VISIBLE。

- WS_DISABLED 很少。

- WS_GROUP 到组控件。

- WS_TABSTOP 到按 tab 键顺序包括编辑控件。

窗口样式的详细信息，请参阅[CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

##  <a name="createex"></a>  CRichEditCtrl::CreateEx

创建控件 （子窗口），并将其与`CRichEditCtrl`对象。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwExStyle*<br/>
指定要创建的控件的扩展的样式。 扩展 Windows 样式的列表，请参阅*dwExStyle*参数[CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) Windows SDK 中。

*dwStyle*<br/>
指定编辑控件的样式。 应用中列出的窗口样式的组合**备注**一部分[创建](#create)并[编辑控件样式](/windows/desktop/Controls/edit-control-styles)Windows SDK 中所述。

*rect*<br/>
对引用[RECT](/previous-versions/dd162897\(v=vs.85\))结构的结构描述的大小和窗口的工作区中创建的位置*pParentWnd*。

*pParentWnd*<br/>
指向控件的父级的窗口的指针。

*nID*<br/>
控件的子窗口 id。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

使用`CreateEx`而不是`Create`若要将应用扩展的 Windows 样式，指定的 Windows 扩展的样式加**WS_EX_**。

##  <a name="cricheditctrl"></a>  CRichEditCtrl::CRichEditCtrl

构造 `CRichEditCtrl` 对象。

```
CRichEditCtrl();
```

### <a name="remarks"></a>备注

使用[创建](#create)构造 Windows rich edit 控件。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

##  <a name="cut"></a>  CRichEditCtrl::Cut

删除 （剪切） 中当前选定内容 （如果有） 丰富的编辑控件并将已删除的文本复制到剪贴板。

```
void Cut();
```

### <a name="remarks"></a>备注

删除由`Cut`可以通过调用撤消[撤消](#undo)成员函数。

若要删除当前所选内容，而无需将已删除的文本放入剪贴板，请调用[清除](#clear)成员函数。

有关详细信息，请参阅[WM_CUT](/windows/desktop/dataxchg/wm-cut) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

##  <a name="displayband"></a>  CRichEditCtrl::DisplayBand

显示以前格式化的 rich edit 控件 （文本和 OLE 项） 的内容的一部分[FormatRange](#formatrange)。

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>参数

*pDisplayRect*<br/>
指向[RECT](/windows/desktop/api/windef/ns-windef-tagrect)或[CRect](../../atl-mfc-shared/reference/crect-class.md)对象，它指定要显示的文本的设备的区域。

### <a name="return-value"></a>返回值

如果带格式的文本显示成功，否则为 0，非零值。

### <a name="remarks"></a>备注

文本和 OLE 项剪辑到指定的指针的区域*pDisplayRect*。

有关详细信息，请参阅[EM_DISPLAYBAND](/windows/desktop/Controls/em-displayband) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[CRichEditCtrl::FormatRange](#formatrange)。

##  <a name="emptyundobuffer"></a>  CRichEditCtrl::EmptyUndoBuffer

重置 （清除） 此 rich edit 控件的撤消标志。

```
void EmptyUndoBuffer();
```

### <a name="remarks"></a>备注

该控件现在将不能撤消上一编辑操作。 每当 rich edit 控件中的某个操作可撤消设置还原标志。

每次调用，则将自动清除撤消标志[CWnd](../../mfc/reference/cwnd-class.md)成员函数[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。

有关详细信息，请参阅[EM_EMPTYUNDOBUFFER](/windows/desktop/Controls/em-emptyundobuffer) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

##  <a name="findtext"></a>  CRichEditCtrl::FindText

查找格式文本编辑控件中的文本。

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>参数

*dwFlags*<br/>
有关可能的值的列表，请参阅*wParam*中[EM_FINDTEXTEXT](/windows/desktop/Controls/em-findtextex) Windows SDK 中。

*pFindText*<br/>
指向[FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-_findtextexa)结构为参数提供用于搜索并返回已找到的匹配项的范围。

### <a name="return-value"></a>返回值

从零开始的字符位置的下一个匹配项;-如果没有更多匹配项，则为 1。

### <a name="remarks"></a>备注

您可以搜索其中之一向上或向下中设置适当的范围参数[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange)结构中`FINDTEXTEX`结构。

有关详细信息，请参阅[EM_FINDTEXTEX](/windows/desktop/Controls/em-findtextex)消息并[FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-_findtextexa) Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

##  <a name="findwordbreak"></a>  CRichEditCtrl::FindWordBreak

之前或之后指定的位置查找下一步断*n 开始*。

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>参数

*nCode*<br/>
指示要执行的操作。 有关可能的值的列表，请参阅参数的说明*代码*中 EM_FINDWORDBREAK Windows SDK 中。

*nStart*<br/>
从其开始的从零开始的字符位置。

### <a name="return-value"></a>返回值

基于参数*nCode*。 有关详细信息，请参阅[EM_FINDWORDBREAK](/windows/desktop/Controls/em-findwordbreak) Windows SDK 中。

### <a name="remarks"></a>备注

此成员函数可用于检索有关给定位置处的字符的信息。

##  <a name="formatrange"></a>  CRichEditCtrl::FormatRange

设置的特定设备的格式文本编辑控件中的文本范围的格式。

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>参数

*pfr*<br/>
指向[FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-_formatrange)结构，其中包含有关输出设备的信息。 NULL 指示可以释放 rich edit 控件中的缓存的信息。

*bDisplay*<br/>
指示是否应呈现的文本。 如果为 FALSE，则只需度量文本。

### <a name="return-value"></a>返回值

适合区域加 1 中的最后一个字符的索引。

### <a name="remarks"></a>备注

通常情况下，此调用对的调用后面[DisplayBand](#displayband)。

有关详细信息，请参阅[EM_FORMATRANGE](/windows/desktop/Controls/em-formatrange)消息并[FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-_formatrange) Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

##  <a name="getcharpos"></a>  CRichEditCtrl::GetCharPos

获取在此给定的字符的位置 （左上角）`CRichEditCtrl`对象。

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>参数

*lChar*<br/>
从零开始的字符索引。

### <a name="return-value"></a>返回值

指定的字符在左上角的位置*lChar*。

### <a name="remarks"></a>备注

通过提供的从零开始的索引值指定的字符。 如果*lChar*大于此中的最后一个字符的索引`CRichEditCtrl`对象，返回值在此指定的刚超出最后一个字符的字符位置的坐标`CRichEditCtrl`对象。

有关详细信息，请参阅[EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) Windows SDK 中。

##  <a name="getdefaultcharformat"></a>  CRichEditCtrl::GetDefaultCharFormat

获取格式设置此属性的默认字符`CRichEditCtrl`对象。

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中，一个指向`CHARFORMAT`持有的默认字符格式设置属性的结构。

在第二个版本中，一个指向`CHARFORMAT2`结构，它是 Rich Edit 2.0 扩展到`CHARFORMAT`存放的默认字符格式设置属性的结构。

### <a name="return-value"></a>返回值

`dwMask`的数据成员*cf*。它指定的默认字符格式设置属性。

### <a name="remarks"></a>备注

有关详细信息，请参阅 EM_GETCHARFORMAT 消息并`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

  有关示例，请参阅[SetDefaultCharFormat](#setdefaultcharformat)。

##  <a name="geteventmask"></a>  CRichEditCtrl::GetEventMask

获取此事件掩码`CRichEditCtrl`对象。

```
long GetEventMask() const;
```

### <a name="return-value"></a>返回值

此事件掩码`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

事件掩码指定的通知消息`CRichEditCtrl`对象发送到其父窗口。

有关详细信息，请参阅[EM_GETEVENTMASK](/windows/desktop/Controls/em-geteventmask) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[CRichEditCtrl::SetEventMask](#seteventmask)。

##  <a name="getfirstvisibleline"></a>  CRichEditCtrl::GetFirstVisibleLine

确定在此最顶层的可见行`CRichEditCtrl`对象。

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>返回值

在此的最高可见行的从零开始索引`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_GETFIRSTVISIBLELINE](/windows/desktop/Controls/em-getfirstvisibleline) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

##  <a name="getiricheditole"></a>  CRichEditCtrl::GetIRichEditOle

访问`IRichEditOle`为此接口`CRichEditCtrl`对象。

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>返回值

指向[IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole)界面，可用于访问此`CRichEditCtrl`对象的 OLE 功能;如果该接口不是可访问，则为 NULL。

### <a name="remarks"></a>备注

使用此接口来访问此`CRichEditCtrl`对象的 OLE 功能。

有关详细信息，请参阅[EM_GETOLEINTERFACE](/windows/desktop/Controls/em-getoleinterface)消息并[IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole) Windows SDK 中的接口。

##  <a name="getlimittext"></a>  CRichEditCtrl::GetLimitText

获取此文本限制`CRichEditCtrl`对象。

```
long GetLimitText() const;
```

### <a name="return-value"></a>返回值

当前文本限制，以字节为单位，此`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

文本限制是文本，以字节为单位，最长可接受格式文本编辑控件。

有关详细信息，请参阅[EM_GETLIMITTEXT](/windows/desktop/Controls/em-getlimittext) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

##  <a name="getline"></a>  CRichEditCtrl::GetLine

检索文本行从此`CRichEditCtrl`对象。

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
若要检索的行的从零开始索引。

*lpszBuffer*<br/>
指向用于接收文本的缓冲区。 缓冲区的第一个单词必须指定的最大可以复制到缓冲区的字节数。

*nMaxLength*<br/>
可以复制到的字符最大数量*lpszBuffer*。 第二个窗体`GetLine`将此值放置到指定的缓冲区的第一个单词*lpszBuffer*。

### <a name="return-value"></a>返回值

复制到的字符数*lpszBuffer*。

### <a name="remarks"></a>备注

复制的行不包含终止 null 字符。

> [!NOTE]
>  因为缓冲区的第一个单词将存储要复制的字符数，请确保你缓冲区至少 4 个字节。

有关详细信息，请参阅[EM_GETLINE](/windows/desktop/Controls/em-getline) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[GetLineCount](#getlinecount)。

##  <a name="getlinecount"></a>  CRichEditCtrl::GetLineCount

检索中的行数`CRichEditCtrl`对象。

```
int GetLineCount() const;
```

### <a name="return-value"></a>返回值

在此的行数`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_GETLINECOUNT](/windows/desktop/Controls/em-getlinecount) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

##  <a name="getmodify"></a>  CRichEditCtrl::GetModify

确定此内容`CRichEditCtrl`对象已被修改。

```
BOOL GetModify() const;
```

### <a name="return-value"></a>返回值

如果非零值的文本的`CRichEditCtrl`已修改对象; 否则为 0。

### <a name="remarks"></a>备注

Windows 维护，该值指示是否已更改的 rich edit 控件内容的内部标志。 当编辑控件首次创建，并且还可以通过调用清除时清除此标志[SetModify](#setmodify)成员函数。

有关详细信息，请参阅[EM_GETMODIFY](/windows/desktop/Controls/em-getmodify) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

##  <a name="getoptions"></a>  CRichEditCtrl::GetOptions

检索当前设置为格式文本编辑控件的选项。

```
UINT GetOptions() const;
```

### <a name="return-value"></a>返回值

当前的选项标志值的组合。 有关这些值的列表，请参阅*fOptions*中的参数[EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions)消息，如 Windows SDK 中所述。

##  <a name="getparaformat"></a>  CRichEditCtrl::GetParaFormat

获取段落格式设置的当前所选内容的属性。

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>参数

*pf*<br/>
在第一个版本中，一个指向[PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-_paraformat)结构，用于保存段落格式设置的当前所选内容的属性。

在第二个版本中，一个指向[PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2)结构，它是 Rich Edit 2.0 扩展到`PARAFORMAT`存放的默认字符格式设置属性的结构。

### <a name="return-value"></a>返回值

`dwMask`的数据成员*pf*。 它指定段落格式设置当前选择中一致的属性。

### <a name="remarks"></a>备注

如果选择多个段落，则*pf*接收第一个所选段落的属性。 返回的值指定哪些属性是在所选内容保持一致。

有关详细信息，请参阅[EM_GETPARAFORMAT](/windows/desktop/Controls/em-getparaformat)消息并`PARAFORMAT`和`PARAFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

  有关示例，请参阅[CRichEditCtrl::SetParaFormat](#setparaformat)。

##  <a name="getpunctuation"></a>  CRichEditCtrl::GetPunctuation

在 rich edit 控件中获取当前的标点字符。

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>参数

*fType*<br/>
标点类型标志，如中所述*fType*的参数[EM_GETPUNCTUATION](/windows/desktop/Controls/em-getpunctuation) Windows SDK 中。

*lpPunc*<br/>
一个指向[标点](/windows/desktop/api/richedit/ns-richedit-_punctuation)结构，如 Windows SDK 中所述。

### <a name="return-value"></a>返回值

如果操作成功，否则为 0，非零值。

### <a name="remarks"></a>备注

此成员函数是仅在操作系统亚洲语言版本中提供的。

##  <a name="getrect"></a>  CRichEditCtrl::GetRect

检索此格式化矩形`CRichEditCtrl`对象。

```
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>参数

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指针，指向[RECT](/windows/desktop/api/windef/ns-windef-tagrect)若要接收的格式设置的矩形`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

格式化矩形是文本的边框。 此值的大小无关`CRichEditCtrl`对象。

有关详细信息，请参阅[EM_GETRECT](/windows/desktop/Controls/em-getrect) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[LimitText](#limittext)。

##  <a name="getredoname"></a>  CRichEditCtrl::GetRedoName

如果有，请检索重做队列中的下一个可用操作的类型。

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>返回值

如果成功，`GetRedoName`将返回[UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-_undonameid)枚举类型，该值指示控件的重做队列中的下一步操作的类型。 如果重做队列为空，或在队列中的重做操作是未知类型，`GetRedoName`返回 0。

### <a name="remarks"></a>备注

可以撤消或重做操作的类型包括键入、 删除、 拖放、 剪切和粘贴操作。 此信息也可用于为撤消和重做操作，例如下拉列表框的 redoable 操作提供扩展的用户界面的应用程序。

##  <a name="getsel"></a>  CRichEditCtrl::GetSel

检索在此当前所选内容的边界`CRichEditCtrl`对象。

```
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>参数

*cr*<br/>
引用[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange)结构，以接收当前所选内容的边界。

*nStartChar*<br/>
当前选定内容中的第一个字符的从零开始索引。

*nEndChar*<br/>
当前选定内容中的最后一个字符的从零开始索引。

### <a name="remarks"></a>备注

此函数的两种形式提供了备用方法来获取所选内容的边界。 请按照这些窗体的简要说明：

- **GetSel (** `cr` **)** 此窗体使用`CHARRANGE`结构，其`cpMin`和`cpMax`成员返回界限。

- **GetSel (** `nStartChar` **，** `nEndChar` **)** 这种形式的参数中返回的边界*nStartChar*和*nEndChar*.

如果所选内容都将包括所有内容开头 (`cpMin`或*nStartChar*) 是 0 和结束 (`cpMax`或*nEndChar*) 为-1。

有关详细信息，请参阅[EM_EXGETSEL](/windows/desktop/Controls/em-exgetsel)消息并[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

##  <a name="getselectioncharformat"></a>  CRichEditCtrl::GetSelectionCharFormat

获取字符格式设置的当前所选内容的属性。

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中，一个指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构，以接收的字符格式设置的当前所选内容的属性。

在第二个版本中，一个指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构，它是 Rich Edit 2.0 扩展到`CHARFORMAT`结构，以接收的字符格式设置的当前所选内容的属性。

### <a name="return-value"></a>返回值

`dwMask`的数据成员*cf*。它指定的字符格式设置当前选择中一致的属性。

### <a name="remarks"></a>备注

*Cf*参数当前选定内容中接收的第一个字符的属性。 返回的值指定哪些属性是在所选内容保持一致。

有关详细信息，请参阅[EM_GETCHARFORMAT](/windows/desktop/Controls/em-getcharformat)消息并`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

  有关示例，请参阅[SetSelectionCharFormat](#setselectioncharformat)。

##  <a name="getselectiontype"></a>  CRichEditCtrl::GetSelectionType

确定在此所选内容类型`CRichEditCtrl`对象。

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>返回值

标志，该值指示当前所选内容的内容。 以下标志的组合：

- SEL_EMPTY 指示当前没有选定内容。

- SEL_TEXT 指示当前所选内容包含文本。

- SEL_OBJECT 指示当前所选内容包含至少一个 OLE 项。

- SEL_MULTICHAR 指示当前所选内容包含多个字符的文本。

- SEL_MULTIOBJECT 指示当前所选内容包含多个 OLE 对象。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_SELECTIONTYPE](/windows/desktop/Controls/em-selectiontype) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

##  <a name="getseltext"></a>  CRichEditCtrl::GetSelText

从在当前所选内容中检索文本`CRichEditCtrl`对象。

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>参数

*lpBuf*<br/>
指向用于接收当前选定内容中的文本的缓冲区的指针。

### <a name="return-value"></a>返回值

取决于窗体：

- **GetSelText (** `lpBuf` **)** 复制到的字符数*lpBuf*，不包括 null 终止。

- **GetSelText （)** 包含当前所选内容的字符串。

### <a name="remarks"></a>备注

如果使用第一个窗体**GetSelText (** `lpBuf` **)**，您必须确保缓冲区足够大，它将接收的文本。 调用[GetSel](#getsel)来确定当前所选内容中的字符数。

有关详细信息，请参阅[EM_GETSELTEXT](/windows/desktop/Controls/em-getseltext) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[CRichEditCtrl::GetSelectionType](#getselectiontype)。

##  <a name="gettextlength"></a>  CRichEditCtrl::GetTextLength

检索的文本，以字符为单位，在此长度`CRichEditCtrl`对象，不包括终止 null 字符。

```
long GetTextLength() const;
```

### <a name="return-value"></a>返回值

在此文本的长度`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

有关详细信息，请参阅[WM_GETTEXTLENGTH](/windows/desktop/winmsg/wm-gettextlength) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

##  <a name="gettextlengthex"></a>  CRichEditCtrl::GetTextLengthEx

计算 rich edit 控件中的文本的长度。

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>参数

*dwFlags*<br/>
值，该值指定要在确定文本长度时使用的方法。 此成员可以是一个或多个值中的标志成员列出[GETTEXTLENGTHEX](/windows/desktop/api/richedit/ns-richedit-_gettextlengthex) Windows SDK 中所述。

*uCodePage*<br/>
翻译 (CP_ACP ANSI 代码页，对 Unicode 的 1200年) 的代码页。

### <a name="return-value"></a>返回值

字符或编辑控件中的字节数。 如果中的设置不兼容的标志*dwFlags*，此成员函数将返回 E_INVALIDARG。

### <a name="remarks"></a>备注

`GetTextLengthEx` 提供了其他方法，来确定文本的长度。 它支持的 Rich Edit 2.0 功能。 请参阅[有关 Rich Edit 控件](/windows/desktop/Controls/about-rich-edit-controls)Windows SDKfor 中的详细信息。

##  <a name="gettextmode"></a>  CRichEditCtrl::GetTextMode

检索格式文本编辑控件的当前文本模式和撤消级别。

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>返回值

一组位标志从[TEXTMODE](/windows/desktop/api/richedit/ne-richedit-tagtextmode)枚举类型，如 Windows SDK 中所述。 标志指示当前文本模式和撤消的控制级别。

##  <a name="gettextrange"></a>  CRichEditCtrl::GetTextRange

获取指定的范围的字符。

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>参数

*nFirst*<br/>
范围中前面紧邻的第一个字符的字符位置索引。

*nLast*<br/>
范围中的最后一个字符之后紧跟的字符位置。

*refString*<br/>
对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)将收到短信的对象。

### <a name="return-value"></a>返回值

复制，不包括终止 null 字符的字符数。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_GETTEXTRANGE](/windows/desktop/Controls/em-gettextrange) Windows SDK 中。

`GetTextRange` 支持的 Rich Edit 2.0 功能。 请参阅[有关 Rich Edit 控件](/windows/desktop/Controls/about-rich-edit-controls)Windows SDKfor 中的详细信息。

##  <a name="getundoname"></a>  CRichEditCtrl::GetUndoName

如果有，请检索撤消队列中的下一个可用操作的类型。

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>返回值

如果撤消操作在控件的撤消队列`GetUndoName`将返回[UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-_undonameid)枚举类型，该值指示队列中的下一步操作的类型。 如果撤消队列为空，或队列中的撤消操作是未知类型，`GetUndoName`返回 0。

### <a name="remarks"></a>备注

可以撤消或重做操作的类型包括键入、 删除、 拖放、 剪切和粘贴操作。 此信息也可用于提供撤消和重做操作，例如下拉列表框可撤消的操作的扩展的用户界面的应用程序。

##  <a name="getwordwrapmode"></a>  CRichEditCtrl::GetWordWrapMode

检索当前的自动换行和 rich edit 控件的 word 换行选项。

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>返回值

当前自动换行和断字选项。 这些选项所述[EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) Windows SDK 中。

### <a name="remarks"></a>备注

此成员函数是操作系统的仅适用于亚洲语言版本。

##  <a name="hideselection"></a>  CRichEditCtrl::HideSelection

更改所选内容的可见性。

```
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>参数

*bHide*<br/>
指示是否应显示或隐藏，为 TRUE，则隐藏选定内容所选内容。

*bPerm*<br/>
指示是否在将所选内容的可见性此更改应为永久。

### <a name="remarks"></a>备注

当*bPerm*为 TRUE 时，它会更改此 ECO_NOHIDESEL 选项`CRichEditCtrl`对象。 有关此选项的简要说明，请参阅[SetOptions](#setoptions)。 可以使用此函数来设置此的所有选项`CRichEditCtrl`对象。

有关详细信息，请参阅[EM_HIDESELECTION](/windows/desktop/Controls/em-hideselection) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

##  <a name="limittext"></a>  CRichEditCtrl::LimitText

限制用户可以向一个编辑控件中输入文本的长度。

```
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>参数

*nChars*<br/>
指定的用户可以输入的文本的长度 （以字节为单位）。 如果此参数为 0 （默认值），文本长度设置为 64k 字节。

### <a name="remarks"></a>备注

更改文本限制将限制用户可以输入文本。 它不会影响任何文本中已有的编辑控件，也不会影响复制到由编辑控件的文本的长度[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)成员函数在`CWnd`。 如果应用程序使用`SetWindowText`函数以将更多的文本放入一个编辑控件比对的调用中指定`LimitText`，用户可以删除任何编辑控件中的文本。 但是，文本限制将阻止用户的现有文本替换为新文本，除非删除当前所选内容会导致文本以低于文本限制。

> [!NOTE]
>  表示文本限制，每个 OLE 项作为单个字符计数。

有关详细信息，请参阅[EM_EXLIMITTEXT](/windows/desktop/Controls/em-exlimittext) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

##  <a name="linefromchar"></a>  CRichEditCtrl::LineFromChar

检索包含指定的字符索引的行的行号。

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
包含的从零开始的索引值的文本编辑控件中所需字符或包含-1。 如果*nIndex*为-1，它指定当前行，即，包含脱字号的行。

### <a name="return-value"></a>返回值

包含由指定的字符索引的行的从零开始的行号*nIndex*。 如果*nIndex*为-1，返回包含所选内容的第一个字符的行数。 如果不未做任何选择，则返回当前行号。

### <a name="remarks"></a>备注

字符索引是从 rich edit 控件的开头的字符数。 适用于字符计数，OLE 项计为单个字符。

有关详细信息，请参阅[EM_EXLINEFROMCHAR](/windows/desktop/Controls/em-exlinefromchar) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

##  <a name="lineindex"></a>  CRichEditCtrl::LineIndex

检索在此行的字符索引`CRichEditCtrl`对象。

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>参数

*nLine*<br/>
包含在文本编辑控件中所需的行的索引值或包含-1。 如果*n 行*为-1，它指定当前行，即，包含脱字号的行。

### <a name="return-value"></a>返回值

在指定的行的字符索引*n 行*或指定的行号更高版本则为-1，然后在编辑控件中的行数。

### <a name="remarks"></a>备注

字符索引是从 rich edit 控件的开头到指定的行的字符数。

有关详细信息，请参阅[EM_LINEINDEX](https://msdn.microsoft.com/library/windows/desktop/bb761611) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

##  <a name="linelength"></a>  CRichEditCtrl::LineLength

检索 rich edit 控件中的行的长度。

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>参数

*nLine*<br/>
指定其长度是要检索的行中的一个字符的字符索引。 如果此参数为-1，则返回当前行 （包含脱字号的行） 的长度，不包括任何长度在所选的行中的文本。 当`LineLength`称为对于单行编辑控件，则忽略此参数。

### <a name="return-value"></a>返回值

当`LineLength`称为多行编辑控件，则返回值的长度 （以 TCHAR) 是由指定的行的*n 行*。  它不包括位于行末尾处的回车字符。 当`LineLength`称为对于单行编辑控件，返回值的长度 （以 TCHAR) 是编辑控件中的文本。 如果 n 行大于控件中的字符数，则返回值为零。

### <a name="remarks"></a>备注

使用[LineIndex](#lineindex)成员函数来检索给定的行号在此的字符索引`CRichEditCtrl`对象。

有关详细信息，请参阅[EM_LINELENGTH](/windows/desktop/Controls/em-linelength) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[LineIndex](#lineindex)。

##  <a name="linescroll"></a>  CRichEditCtrl::LineScroll

将多行编辑控件的文本滚动。

```
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>参数

*nLines*<br/>
指定垂直滚动行的数。

*nChars*<br/>
指定水平滚动的字符位置的数。 如果文本编辑控件具有 ES_RIGHT 或 ES_CENTER 样式，将忽略此值。 [编辑样式](../../mfc/reference/styles-used-by-mfc.md#edit-styles)中指定[创建](#create)。

### <a name="remarks"></a>备注

编辑控件不垂直滚动过去的文本编辑控件中的最后一行。 如果当前行以及由指定的行数*nLines*超过编辑控件中的总行数，以便编辑控件的最后一行滚动到编辑控件窗口的顶部调整值。

`LineScroll` 可用于水平滚动过去的任意行的最后一个字符。

有关详细信息，请参阅[EM_LINESCROLL](/windows/desktop/Controls/em-linescroll) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[GetFirstVisibleLine](#getfirstvisibleline)。

##  <a name="paste"></a>  CRichEditCtrl::Paste

将数据插入从剪贴板粘贴到`CRichEditCtrl`在插入点，将插入符号的位置。

```
void Paste();
```

### <a name="remarks"></a>备注

仅当剪贴板包含可识别的格式的数据插入数据。

有关详细信息，请参阅[WM_PASTE](/windows/desktop/dataxchg/wm-paste) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

##  <a name="pastespecial"></a>  CRichEditCtrl::PasteSpecial

将特定剪贴板格式的数据粘贴到此`CRichEditCtrl`对象。

```
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>参数

*nClipFormat*<br/>
剪贴板格式，将粘贴到此`CRichEditCtrl`对象。

*dvAspect*<br/>
对于要从剪贴板检索的数据的设备方面。

*hMF*<br/>
包含要粘贴的对象的图标视图的图元文件的句柄。

### <a name="remarks"></a>备注

在插入点，将插入符号的位置插入新材料。

有关详细信息，请参阅[EM_PASTESPECIAL](/windows/desktop/Controls/em-pastespecial) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

##  <a name="posfromchar"></a>  CRichEditCtrl::PosFromChar

检索指定的字符的编辑控件中的客户端区域坐标。

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>参数

*nChar*<br/>
字符的从零开始的索引。

### <a name="return-value"></a>返回值

字符，（x，y） 的位置。 对于单行编辑控件，y 坐标值始终为零。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) Windows SDK 中。

##  <a name="redo"></a>  CRichEditCtrl::Redo

重做控件的重做队列中的下一步操作。

```
BOOL Redo();
```

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[EM_REDO](/windows/desktop/Controls/em-redo) Windows SDK 中。

##  <a name="replacesel"></a>  CRichEditCtrl::ReplaceSel

将替换当前选定内容中这`CRichEditCtrl`对象使用指定的文本。

```
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>参数

*lpszNewText*<br/>
指向包含替换文本的以 null 结尾的字符串指针。

*bCanUndo*<br/>
若要指定此函数可撤消，设置此参数的值为 TRUE。 默认值是 FALSE。

### <a name="remarks"></a>备注

若要替换中的所有文本`CRichEditCtrl`对象，请使用[CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。

如果当前没有选定内容，在插入点，即，当前插入符号位置插入替换文本。

使用现有的字符格式设置，此函数将设置格式插入的文本。 替换整个文本范围时 (通过调用`SetSel`（0，-1） 之前调用`ReplaceSel`)，则会保留上一个段落格式设置，这在继承的新插入的文本的段落字符的结尾。

有关详细信息，请参阅[EM_REPLACESEL](/windows/desktop/Controls/em-replacesel) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[LineIndex](#lineindex)。

##  <a name="requestresize"></a>  CRichEditCtrl::RequestResize

这将强制`CRichEditCtrl`EN_REQUESTRESIZE 通知消息发送到其父窗口的对象。

```
void RequestResize();
```

### <a name="remarks"></a>备注

此函数很有用期间[CWnd::OnSize](../../mfc/reference/cwnd-class.md#onsize)处理无界限`CRichEditCtrl`对象。

有关详细信息，请参阅[EM_REQUESTRESIZE](/windows/desktop/Controls/em-requestresize)消息并**无界限 Rich Edit 控件**一部分[有关 Rich Edit 控件](/windows/desktop/Controls/about-rich-edit-controls)Windows SDK 中。

##  <a name="setautourldetect"></a>  CRichEditCtrl::SetAutoURLDetect

设置为自动检测 URL 的格式文本编辑控件。

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
指定是否将控件设置为自动检测 URL。 如果为 TRUE，则启用它。 如果为 FALSE，则禁用它。

### <a name="return-value"></a>返回值

如果成功，否则为非零值为零。 例如，消息可能会由于内存不足而失败。

### <a name="remarks"></a>备注

如果启用，rich edit 控件将扫描以确定其是否符合标准的 URL 格式的文本。 有关这些 URL 格式的列表，请参阅[EM_AUTOURLDETECT](/windows/desktop/Controls/em-autourldetect) Windows SDK 中。

> [!NOTE]
>  未设置`SetAutoURLDetect`为 true; 如果您编辑的控件使用 CFE_LINK 效果的文本而不是 Url。 `SetAutoURLDetect` 为 Url 启用这种效果并禁用所有其他文本。 请参阅[EN_LINK](/windows/desktop/Controls/en-link)有关 CFE_LINK 效果的详细信息。

##  <a name="setbackgroundcolor"></a>  CRichEditCtrl::SetBackgroundColor

此设置的背景色`CRichEditCtrl`对象。

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>参数

*bSysColor*<br/>
指示是否应为系统的值设置的背景色。 如果此值为 TRUE， *cr*将被忽略。

*cr*<br/>
请求的背景色。 使用仅当*bSysColor*为 FALSE。

### <a name="return-value"></a>返回值

为此以前的背景颜色`CRichEditCtrl`对象。

### <a name="remarks"></a>备注

可以设置的背景色，为系统值或与指定[COLORREF](/windows/desktop/gdi/colorref)值。

有关详细信息，请参阅[EM_SETBKGNDCOLOR](/windows/desktop/Controls/em-setbkgndcolor)消息并[COLORREF](/windows/desktop/gdi/colorref) Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

##  <a name="setdefaultcharformat"></a>  CRichEditCtrl::SetDefaultCharFormat

设置字符格式设置在此新文本的特性`CRichEditCtrl`对象。

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中，一个指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构，它包含新的默认字符格式设置属性。

在第二个版本中，一个指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构，它是 Rich Edit 2.0 扩展到`CHARFORMAT`包含的默认字符格式设置属性的结构。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

指定的属性`dwMask`的成员*cf*更改此函数。

有关详细信息，请参阅[EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)消息并`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

##  <a name="seteventmask"></a>  CRichEditCtrl::SetEventMask

设置此事件掩码`CRichEditCtrl`对象。

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>参数

*dwEventMask*<br/>
为此新的事件掩码`CRichEditCtrl`对象。

### <a name="return-value"></a>返回值

上一事件掩码中。

### <a name="remarks"></a>备注

事件掩码指定的通知消息`CRichEditCtrl`对象发送到其父窗口。

有关详细信息，请参阅[EM_SETEVENTMASK](/windows/desktop/Controls/em-seteventmask) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

##  <a name="setmodify"></a>  CRichEditCtrl::SetModify

设置或清除编辑控件的已修改的标志。

```
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>参数

*bModified*<br/>
值为 TRUE 指示已修改的文本，值为 FALSE 指示它未被修改。 默认情况下，设置已修改的标志。

### <a name="remarks"></a>备注

修改的标志指示已修改的文本编辑控件中。 它将自动设置的每当用户更改的文本。 可以检索其值与[GetModify](#getmodify)成员函数。

有关详细信息，请参阅[EM_SETMODIFY](/windows/desktop/Controls/em-setmodify) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[GetModify](#getmodify)。

##  <a name="setolecallback"></a>  CRichEditCtrl::SetOLECallback

提供这`CRichEditCtrl`对象`IRichEditOleCallback`对象，用于访问 OLE 相关资源和信息。

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>参数

*pCallback*<br/>
指向[IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback)对象，此`CRichEditCtrl`对象将用来获取 OLE 相关资源和信息。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

这`CRichEditCtrl`对象将调用[iunknown:: Addref](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref)来增加由指定的 COM 对象的使用情况计数*pCallback*。

有关详细信息，请参阅[EM_SETOLECALLBACK](/windows/desktop/Controls/em-setolecallback)消息并[IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback) Windows SDK 中的接口。

##  <a name="setoptions"></a>  CRichEditCtrl::SetOptions

设置此选项`CRichEditCtrl`对象。

```
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>参数

*wOp*<br/>
指示操作的类型。 以下值之一：

- ECOOP_SET 将选项设置为所指定的*dwFlags*。

- ECOOP_OR 结合使用所指定的选项的当前*dwFlags*。

- ECOOP_AND 保留仅那些当前选项，还指定通过*dwFlags*。

- ECOOP_XOR 逻辑异或与所指定的当前选项*dwFlags*。

*dwFlags*<br/>
格式文本编辑选项。 在备注部分中列出了标志值。

### <a name="remarks"></a>备注

选项可以是以下值的组合：

- 双击 ECO_AUTOWORDSELECTION 自动选择上的字词。

- ECO_AUTOVSCROLL 自动使文本滚动到右按 10 个字符时用户在行尾键入字符。 当用户按 ENTER 键时，控件滚动回位置零的所有文本。

- 在用户的最后一行按 ENTER 键时，自动 ECO_AUTOHSCROLL 滚动一页的文本。

- ECO_NOHIDESEL 求反的编辑控件的默认行为。 当控件失去输入的焦点并显示所选内容时该控件接收输入的焦点时，默认行为将隐藏所选内容。 如果指定 ECO_NOHIDESEL，均反转所选的文本，即使控件没有焦点。

- ECO_READONLY 可防止用户键入或编辑文本编辑控件中。

- ECO_WANTRETURN 指定丰富的多个行中输入文本时，在用户按 ENTER 键时插入回车符后，编辑控件在对话框中。 如果未指定此样式，按 ENTER 键将命令发送到 rich edit 控件的父窗口中，模拟单击父窗口的默认按钮 （例如，在对话框中的确定按钮）。 此样式有一个单行编辑控件没有影响。

- 在控件失去焦点时，ECO_SAVESEL 保留所选内容。 默认情况下重新获得焦点时选择该控件的全部内容。

- ECO_VERTICAL 绘制文本和垂直方向中的对象。 适用于仅亚洲语言。

有关详细信息，请参阅[EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

##  <a name="setparaformat"></a>  CRichEditCtrl::SetParaFormat

设置段落格式设置当前选定内容中此特性`CRichEditCtrl`对象。

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>参数

*pf*<br/>
在第一个版本中，一个指向[PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-_paraformat)结构，它包含新的默认段落格式设置属性。

在第二个版本中，一个指向[PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2)结构，它是 Rich Edit 2.0 扩展到`PARAFORMAT`存放的默认字符格式设置属性的结构。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

指定的属性`dwMask`的成员*pf*更改此函数。

有关详细信息，请参阅[EM_SETPARAFORMAT](/windows/desktop/Controls/em-setparaformat)消息并`PARAFORMAT`和`PARAFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

##  <a name="setpunctuation"></a>  CRichEditCtrl::SetPunctuation

在 rich edit 控件中设置标点。

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>参数

*fType*<br/>
表示标点的标志。 有关可能的值的列表，请参阅*fType*参数[EM_SETPUNCTUATION](/windows/desktop/Controls/em-setpunctuation) Windows SDK 中。

*lpPunc*<br/>
一个指向[标点](/windows/desktop/api/richedit/ns-richedit-_punctuation)结构，如 Windows SDK 中所述。

### <a name="return-value"></a>返回值

非零，如果成功，否则为 0。

### <a name="remarks"></a>备注

此成员函数是可用于仅亚洲语言版本的操作系统。

##  <a name="setreadonly"></a>  CRichEditCtrl::SetReadOnly

更改此 ECO_READONLY 选项`CRichEditCtrl`对象。

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>参数

*bReadOnly*<br/>
指示如果此`CRichEditCtrl`对象应为只读。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

有关此选项的简要说明，请参阅[SetOptions](#setoptions)。 可以使用此函数来设置此的所有选项`CRichEditCtrl`对象。

有关详细信息，请参阅[EM_SETREADONLY](/windows/desktop/Controls/em-setreadonly) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

##  <a name="setrect"></a>  CRichEditCtrl::SetRect

设置此格式化矩形`CRichEditCtrl`对象。

```
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>参数

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指针，指向[RECT](/windows/desktop/api/windef/ns-windef-tagrect) ，该值指示格式化矩形的新边界。

### <a name="remarks"></a>备注

格式化矩形是文本限定的矩形。 限制矩形是大小的独立于格式文本编辑控件窗口。 当此`CRichEditCtrl`首次创建对象、 格式化矩形是窗口的客户端区域的大小相同。 使用`SetRect`格式设置矩形设为大于或小于丰富编辑窗口。

有关详细信息，请参阅[EM_SETRECT](/windows/desktop/Controls/em-setrect) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

##  <a name="setsel"></a>  CRichEditCtrl::SetSel

设置在此选择`CRichEditCtrl`对象。

```
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>参数

*nStartChar*<br/>
将所选内容的第一个字符的从零开始索引。

*nEndChar*<br/>
将所选内容的最后一个字符的从零开始索引。

*cr*<br/>
[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange)结构，其中包含当前所选内容的边界。

### <a name="remarks"></a>备注

此函数的两种形式提供了备用方法来设置所选内容的边界。 请按照这些窗体的简要说明：

- **SetSel (** `cr` **)** 此窗体使用`CHARRANGE`结构，其`cpMin`和`cpMax`若要设置的成员。

- **SetSel (** `nStartChar` **，** `nEndChar` **)** 此窗体使用的参数*nStartChar*和*nEndChar*若要设置。

插入点放在由开始中的较大指示所选内容的末尾 (`cpMin`或*nStartChar*) 和结束 (`cpMax`或*nEndChar*) 索引。 此函数的内容滚动`CRichEditCtrl`，以便将插入符号是否可见。

若要在此选择所有文本`CRichEditCtrl`对象，请调用`SetSel`与 0 和结束索引为-1 的起始索引。

有关详细信息，请参阅[EM_EXSETSEL](/windows/desktop/Controls/em-exsetsel)消息并[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) Windows SDK 中的结构。

### <a name="example"></a>示例

  有关示例，请参阅[GetSel](#getsel)。

##  <a name="setselectioncharformat"></a>  CRichEditCtrl::SetSelectionCharFormat

设置字符格式设置在此当前选定内容中的文本特性`CRichEditCtrl`对象。

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中，一个指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构，它包含的字符格式设置属性的当前所选内容。

在第二个版本中，一个指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构，它是 Rich Edit 2.0 扩展到`CHARFORMAT`结构，其中包含新的字符格式设置为当前所选内容的属性。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

指定的属性`dwMask`的成员*cf*更改此函数。

有关详细信息，请参阅[EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)并`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

##  <a name="settargetdevice"></a>  CRichEditCtrl::SetTargetDevice

设置用于所见即所得的目标设备和线条宽度 （所见即所得） 在此格式设置`CRichEditCtrl`对象。

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>参数

*hDC*<br/>
新的目标设备的设备上下文的句柄。

*lLineWidth*<br/>
要用于设置格式的线条宽度。

*dc*<br/>
[CDC](../../mfc/reference/cdc-class.md)为新的目标设备。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

如果此函数成功，rich edit 控件拥有设备上下文作为参数传递。 在这种情况下，调用的函数不应销毁设备上下文。

有关详细信息，请参阅[EM_SETTARGETDEVICE](/windows/desktop/Controls/em-settargetdevice) Windows SDK 中。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

##  <a name="settextmode"></a>  CRichEditCtrl::SetTextMode

设置格式文本编辑控件的文本模式或撤消和重做级别。

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>参数

*fMode*<br/>
指定控件的文本模式和撤消级别的参数的新设置。 有关可能的值的列表，请参阅的模式参数[EM_SETTEXTMODE](/windows/desktop/Controls/em-settextmode) Windows SDK 中。

### <a name="return-value"></a>返回值

如果成功，否则为非零值为零。

### <a name="remarks"></a>备注

文本模式的说明，请参阅 Windows SDK 中的 EM_SETTEXTMODE。

如果控件包含文本，此成员函数将失败。 若要确保控件为空，将发送[WM_SETTEXT](/windows/desktop/winmsg/wm-settext)用空字符串的消息。

##  <a name="setundolimit"></a>  CRichEditCtrl::SetUndoLimit

设置可以存储在撤消队列中的操作的最大数目。

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>参数

*nLimit*<br/>
指定可以存储在撤消队列中的操作的最大数目。 设置为 0 可以禁用撤消。

### <a name="return-value"></a>返回值

新的最大数目的撤消操作的丰富的编辑控件。

### <a name="remarks"></a>备注

默认情况下，撤消队列中的操作的最大数目为 100。 如果增大此数字时，必须有足够的可用内存来容纳新数。 为了提高性能，限制设置为最小可能值。

##  <a name="setwordcharformat"></a>  CRichEditCtrl::SetWordCharFormat

设置字符格式设置属性的当前所选字`CRichEditCtrl`对象。

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>参数

*cf*<br/>
在第一个版本中，一个指向[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)结构，它包含的字符格式设置属性的当前选定的单词。

在第二个版本中，一个指向[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)结构，它是 Rich Edit 2.0 扩展到`CHARFORMAT`结构，其中包含新的字符格式设置属性的当前选定的单词。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

指定的属性`dwMask`的成员*cf*更改此函数。

有关详细信息，请参阅[EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)消息并`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

##  <a name="setwordwrapmode"></a>  CRichEditCtrl::SetWordWrapMode

丰富的自动换行和断字选项集的编辑控件。

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>参数

*uFlags*<br/>
要设置的自动换行和断字的选项。 有关可能的选项的列表，请参阅[EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) Windows SDK 中。

### <a name="return-value"></a>返回值

当前的自动换行和断字功能选项。

### <a name="remarks"></a>备注

此消息是操作系统的仅在亚洲语言版本中可用。

##  <a name="stopgrouptyping"></a>  CRichEditCtrl::StopGroupTyping

停止附加到当前的撤消操作键入操作收集控件。

```
void StopGroupTyping();
```

### <a name="remarks"></a>备注

如果有，到撤消队列中的新操作，该控件将存储的下一步的类型化操作。

有关详细信息，请参阅[EM_STOPGROUPTYPING](/windows/desktop/Controls/em-stopgrouptyping) Windows SDK 中。

##  <a name="streamin"></a>  CRichEditCtrl::StreamIn

替换此文本`CRichEditCtrl`对象中指定的输入流的文本。

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>参数

*nFormat*<br/>
指定的输入的数据格式的标志。 有关详细信息，请参阅备注部分。

*es*<br/>
[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream)结构，它指定输入的流。 有关详细信息，请参阅备注部分。

### <a name="return-value"></a>返回值

从输入流读取的字符数。

### <a name="remarks"></a>备注

值*nFormat*必须是以下值之一：

- SF_TEXT 指示读取纯文本。

- SF_RTF 指示读取文本和格式设置。

这些值可以使用 SFF_SELECTION 组合。 如果指定 SFF_SELECTION，`StreamIn`替换当前选定内容的输入流的内容。 如果未指定，`StreamIn`替换的整个内容`CRichEditCtrl`对象。

在中`EDITSTREAM`参数*es*，指定缓冲区填充文本的回调函数。 此回调函数是重复，调用，直到用完的输入的流。

有关详细信息，请参阅[EM_STREAMIN](/windows/desktop/Controls/em-streamin)消息并[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

##  <a name="streamout"></a>  CRichEditCtrl::StreamOut

写出的此内容`CRichEditCtrl`到指定的输出流。

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>参数

*nFormat*<br/>
指定输出数据格式的标志。 有关详细信息，请参阅备注部分。

*es*<br/>
[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream)结构，它指定输出流。 有关详细信息，请参阅备注部分。

### <a name="return-value"></a>返回值

写入到输出流的字符数。

### <a name="remarks"></a>备注

值*nFormat*必须是以下值之一：

- SF_TEXT 指示编写纯文本。

- SF_RTF 指示写入文本和格式设置。

- SF_RTFNOOBJS 指示写入文本和格式设置，OLE 项替换为空格。

- SF_TEXTIZED 指示写入文本和格式设置，以文本形式表示的 OLE 项。

这些值可以使用 SFF_SELECTION 组合。 如果指定 SFF_SELECTION，`StreamOut`写出到输出流中当前所选内容。 如果未指定，`StreamOut`写出的全部内容`CRichEditCtrl`对象。

在中`EDITSTREAM`参数*es*，指定在其中填入文本缓冲区的回调函数。 此回调函数是重复，调用，直到用完的输出流。

有关详细信息，请参阅[EM_STREAMOUT](/windows/desktop/Controls/em-streamout)消息并[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) Windows SDK 中的结构。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

##  <a name="undo"></a>  CRichEditCtrl::Undo

撤消在 rich edit 控件中的最后一个操作。

```
BOOL Undo();
```

### <a name="return-value"></a>返回值

如果撤消操作成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

撤消操作还可以撤消。 例如，可以还原已删除的文本与首次调用`Undo`。 只要没有干预编辑操作，可以删除再次通过第二个调用文本`Undo`。

有关详细信息，请参阅[EM_UNDO](/windows/desktop/Controls/em-undo) Windows SDK 中。

### <a name="example"></a>示例

  有关示例，请参阅[CanUndo](#canundo)。

## <a name="see-also"></a>请参阅

[MFC 示例写字板](../../overview/visual-cpp-samples.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[CEdit 类](../../mfc/reference/cedit-class.md)<br/>
[CRichEditView 类](../../mfc/reference/cricheditview-class.md)
