---
description: 了解有关数据库支持的详细信息，MFC 应用程序向导
title: MFC 应用程序向导的数据库支持
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: 4c6f980155e980c772b5ee78f83c80a236998b91
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/11/2020
ms.locfileid: "97220300"
---
# <a name="database-support-mfc-application-wizard"></a>MFC 应用程序向导的数据库支持

此页提供了一些选项，可用于指定 (和数据源的数据库支持级别（如有必要) 到项目中）。

- **数据库支持**

   设置项目的数据库支持级别。

   |选项|说明|
   |------------|-----------------|
   |无|不提供数据库支持。 这是默认选项。|
   |**仅头文件**|为应用程序提供基本的数据库支持级别。 如果选择 " **客户端类型**" 下的 "ODBC 支持"，则 MFC 应用程序向导将在项目中包含头文件 AFXDB。 它添加了链接库，但不创建任何特定于数据库的类。 稍后可以创建记录集，并使用它们来检查和更新记录。 如果选择 " **客户端类型**" 下的 "OLE DB 支持"，则包括以下标头文件： atlbase.h。H AFXOLEDB。H ATLPLUS。高|
   |**不支持文件的数据库视图**|包括数据库头文件、链接库、记录视图和记录集。  (仅适用于在 "[应用程序类型](../../mfc/reference/application-type-mfc-application-wizard.md)" 页中选择了 "**文档/视图体系结构支持**" 选项的应用程序。 ) 此选项包含文档支持，但不支持序列化。 如果选择包含数据库视图，则必须指定数据源。|
   |**具有文件支持的数据库视图**|包括数据库头文件、链接库、记录视图和记录集。  (仅适用于在 "**应用程序类型**" 页中选择了 "**文档/视图体系结构支持**" 选项的应用程序。 ) 此选项支持文档序列化，例如，可以使用它来更新用户配置文件。 数据库应用程序通常基于每个记录运行，而不是基于每个文件运行，因此不需要序列化。 不过，您可能有一个用于序列化的特殊用途。 如果选择包含数据库视图，则必须指定数据源。|

   > [!NOTE]
   > 在 " **数据库支持**" 下，如果选择 "不支持文件 **支持的数据库视图** " 或 " **具有文件支持的数据库视图**"，则视图类派生将有所不同，具体取决于你的 **客户端类型** 选择，如下所示：

  - 如果在 "**客户端类型**" 下选择 " **ODBC** "，则应用程序的视图类派生自 [CRecordView](../../mfc/reference/crecordview-class.md)。 此类与 [CRecordset](../../mfc/reference/crecordset-class.md)派生的类相关联，MFC 应用程序向导也会为你创建此类。 此选项提供基于窗体的应用程序，在该应用程序中，记录视图用于通过其记录集查看和更新记录。

  - 如果在 "**客户端类型**" 下选择 **OLE DB** ，则该视图类派生自 [COleDBRecordView](../../mfc/reference/coledbrecordview-class.md)，并与 [CTable](../../data/oledb/ctable-class.md)或 [CCommand](../../data/oledb/ccommand-class.md)派生的类相关联。

- **客户端类型**

   指示你的项目是使用 OLE DB 类还是 ODBC 类。

   |选项|描述|
   |------------|-----------------|
   |**OLE DB**|选中此选项后，单击 " **数据源** " 按钮将调用 **数据链接属性** 向导，以帮助您创建与 OLE DB 数据源的连接。|
   |**ODBC**|选中此选项后，单击 " **数据源** " 按钮将调用 " **选择数据源** " 向导来帮助您创建与 ODBC 数据源的连接。|

- **数据源**

   > [!NOTE]
   > ATL OLE DB 使用者向导和 MFC ODBC 使用者向导在 Visual Studio 2019 和更高版本中不可用。 但仍可以手动添加此功能。 有关详细信息，请参阅[不使用向导创建使用者](../../data/oledb/creating-a-consumer-without-using-a-wizard.md)。

   单击 " **数据源** " 按钮以使用指定的驱动程序或提供程序和数据库设置数据源。 如果在 " **客户端类型** " 选项中选择 "OLE DB"，此按钮将显示 " **数据链接属性** " 对话框。 如果在 " **客户端类型** " 选项中选择了 "ODBC"，则此按钮将提供 " **选择数据源** " 对话框。 仅当您选择在应用程序中包括数据库视图时，此选项才可用。

   |选项|描述|
   |------------|-----------------|
   |**数据链接属性** (OLE DB) |使用指定的 OLE DB 提供程序建立指定的数据源。 您必须指定 OLE DB 提供程序、数据位置、数据源、登录 ID 和 () 密码（可选）。 有关此对话框的详细信息，请参阅 [ATL OLE DB 使用者向导](../../atl/reference/atl-ole-db-consumer-wizard.md)中的 **数据源**。|
   | (ODBC) **选择数据源**|使用指定的 ODBC 驱动程序建立指定的数据源。 您必须选择一个数据源名称以选择数据源的表。 向导将表的所有列绑定到派生类的成员变量 `CRecordset` 。 有关此对话框的详细信息，请参阅 [MFC ODBC 使用者向导](../../mfc/reference/mfc-odbc-consumer-wizard.md)中的 **数据源**。|

- **生成特性化数据库类**

   仅适用于 OLE DB 客户端。 指定生成的项目中的数据库类是否使用特性。

- **绑定所有列**

   仅适用于 ODBC 客户端。 指定是否绑定所选表中的所有列。 如果选择此框，则绑定所有列;如果不选择此框，则不会绑定任何列，必须在 recordset 类中手动绑定列。

- **类型**

   仅适用于 ODBC 客户端。 指定记录集是动态集还是快照，如下表所述。

   |选项|描述|
   |------------|-----------------|
   |**动态集**|指定记录集为动态集。 动态集是查询的结果，它提供查询数据库的数据的索引视图。 动态集仅缓存原始数据的整数索引，从而为快照提供性能提升。 索引将直接指向作为查询结果找到的每个记录，并指示是否删除记录。 您还可以访问所查询记录中的已更新信息。|
   |**快照**|指定记录集为快照。 快照是查询的结果，在一个时间点就是数据库的一个视图。 将缓存作为查询结果发现的所有记录，因此看不到对原始记录所做的任何更改。|

## <a name="see-also"></a>请参阅

[MFC 应用程序向导](../../mfc/reference/mfc-application-wizard.md)
