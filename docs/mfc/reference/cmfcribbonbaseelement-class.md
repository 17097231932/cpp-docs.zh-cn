---
description: 了解详细信息： CMFCRibbonBaseElement 类
title: CMFCRibbonBaseElement 类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonBaseElement
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::AddToKeyList
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::AddToListBox
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeAddedToQuickAccessToolBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeCompacted
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeStretched
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CanBeStretchedHorizontally
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CleanUpSizes
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::ClosePopupMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::CopyFrom
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::DestroyCtrl
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::DrawImage
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::Find
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::FindByData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::FindByID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::FindByOriginal
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetCompactSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetDescription
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetDroppedDown
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetElements
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetElementsByID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetHighlighted
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetImageSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetIntermediateSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetKeys
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetKeyTipRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetKeyTipSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetLocationInGroup
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetMenuKeys
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetNotifyID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetOriginal
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentCategory
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentPanel
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentRibbonBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetParentWnd
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetPressed
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetQuickAccessToolBarID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetRegularSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetToolTipText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::GetTopLevelRibbonBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasCompactMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasFocus
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasIntermediateMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasLargeMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HasMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::HitTest
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsAlignByColumn
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsAlwaysLargeImage
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsAutoRepeatMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsChecked
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsCompactMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsDefaultMenuLook
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsDisabled
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsDroppedDown
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsFocused
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsGalleryIcon
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsHighlighted
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsIntermediateMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsLargeMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsMenuMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsPressed
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsQATMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsSeparator
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsShowGroupBorder
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsShowTooltipOnBottom
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsTabStop
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsTextAlwaysOnRight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsVisible
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::IsWholeRowHeight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::NotifyCommand
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::NotifyHighlightListItem
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnAddToQAToolbar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnAfterChangeRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnAutoRepeat
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnCalcTextSize
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnChangeMenuHighlight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDraw
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDrawKeyTip
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDrawMenuImage
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnDrawOnList
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnKey
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnMenuKey
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnRTLChanged
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnShow
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnShowPopupMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::PostMenuCommand
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::Redraw
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetACCData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetCompactMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetData
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetDefaultMenuLook
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetDescription
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetID
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetInitialMode
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetKeys
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetOriginal
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetParentCategory
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetParentMenu
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetParentRibbonBar
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetRect
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetTextAlwaysOnRight
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetToolTipText
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::SetVisible
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::StretchHorizontally
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::StretchToWholeRow
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::UpdateTooltipInfo
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnProcessKey
- AFXBASERIBBONELEMENT/CMFCRibbonBaseElement::OnSetFocus
helpviewer_keywords:
- CMFCRibbonBaseElement [MFC], AddToKeyList
- CMFCRibbonBaseElement [MFC], AddToListBox
- CMFCRibbonBaseElement [MFC], CanBeAddedToQuickAccessToolBar
- CMFCRibbonBaseElement [MFC], CanBeCompacted
- CMFCRibbonBaseElement [MFC], CanBeStretched
- CMFCRibbonBaseElement [MFC], CanBeStretchedHorizontally
- CMFCRibbonBaseElement [MFC], CleanUpSizes
- CMFCRibbonBaseElement [MFC], ClosePopupMenu
- CMFCRibbonBaseElement [MFC], CopyFrom
- CMFCRibbonBaseElement [MFC], DestroyCtrl
- CMFCRibbonBaseElement [MFC], DrawImage
- CMFCRibbonBaseElement [MFC], Find
- CMFCRibbonBaseElement [MFC], FindByData
- CMFCRibbonBaseElement [MFC], FindByID
- CMFCRibbonBaseElement [MFC], FindByOriginal
- CMFCRibbonBaseElement [MFC], GetCompactSize
- CMFCRibbonBaseElement [MFC], GetData
- CMFCRibbonBaseElement [MFC], GetDescription
- CMFCRibbonBaseElement [MFC], GetDroppedDown
- CMFCRibbonBaseElement [MFC], GetElements
- CMFCRibbonBaseElement [MFC], GetElementsByID
- CMFCRibbonBaseElement [MFC], GetHighlighted
- CMFCRibbonBaseElement [MFC], GetID
- CMFCRibbonBaseElement [MFC], GetImageSize
- CMFCRibbonBaseElement [MFC], GetIntermediateSize
- CMFCRibbonBaseElement [MFC], GetKeys
- CMFCRibbonBaseElement [MFC], GetKeyTipRect
- CMFCRibbonBaseElement [MFC], GetKeyTipSize
- CMFCRibbonBaseElement [MFC], GetLocationInGroup
- CMFCRibbonBaseElement [MFC], GetMenuKeys
- CMFCRibbonBaseElement [MFC], GetNotifyID
- CMFCRibbonBaseElement [MFC], GetOriginal
- CMFCRibbonBaseElement [MFC], GetParentCategory
- CMFCRibbonBaseElement [MFC], GetParentPanel
- CMFCRibbonBaseElement [MFC], GetParentRibbonBar
- CMFCRibbonBaseElement [MFC], GetParentWnd
- CMFCRibbonBaseElement [MFC], GetPressed
- CMFCRibbonBaseElement [MFC], GetQuickAccessToolBarID
- CMFCRibbonBaseElement [MFC], GetRect
- CMFCRibbonBaseElement [MFC], GetRegularSize
- CMFCRibbonBaseElement [MFC], GetSize
- CMFCRibbonBaseElement [MFC], GetText
- CMFCRibbonBaseElement [MFC], GetToolTipText
- CMFCRibbonBaseElement [MFC], GetTopLevelRibbonBar
- CMFCRibbonBaseElement [MFC], HasCompactMode
- CMFCRibbonBaseElement [MFC], HasFocus
- CMFCRibbonBaseElement [MFC], HasIntermediateMode
- CMFCRibbonBaseElement [MFC], HasLargeMode
- CMFCRibbonBaseElement [MFC], HasMenu
- CMFCRibbonBaseElement [MFC], HitTest
- CMFCRibbonBaseElement [MFC], IsAlignByColumn
- CMFCRibbonBaseElement [MFC], IsAlwaysLargeImage
- CMFCRibbonBaseElement [MFC], IsAutoRepeatMode
- CMFCRibbonBaseElement [MFC], IsChecked
- CMFCRibbonBaseElement [MFC], IsCompactMode
- CMFCRibbonBaseElement [MFC], IsDefaultMenuLook
- CMFCRibbonBaseElement [MFC], IsDisabled
- CMFCRibbonBaseElement [MFC], IsDroppedDown
- CMFCRibbonBaseElement [MFC], IsFocused
- CMFCRibbonBaseElement [MFC], IsGalleryIcon
- CMFCRibbonBaseElement [MFC], IsHighlighted
- CMFCRibbonBaseElement [MFC], IsIntermediateMode
- CMFCRibbonBaseElement [MFC], IsLargeMode
- CMFCRibbonBaseElement [MFC], IsMenuMode
- CMFCRibbonBaseElement [MFC], IsPressed
- CMFCRibbonBaseElement [MFC], IsQATMode
- CMFCRibbonBaseElement [MFC], IsSeparator
- CMFCRibbonBaseElement [MFC], IsShowGroupBorder
- CMFCRibbonBaseElement [MFC], IsShowTooltipOnBottom
- CMFCRibbonBaseElement [MFC], IsTabStop
- CMFCRibbonBaseElement [MFC], IsTextAlwaysOnRight
- CMFCRibbonBaseElement [MFC], IsVisible
- CMFCRibbonBaseElement [MFC], IsWholeRowHeight
- CMFCRibbonBaseElement [MFC], NotifyCommand
- CMFCRibbonBaseElement [MFC], NotifyHighlightListItem
- CMFCRibbonBaseElement [MFC], OnAddToQAToolbar
- CMFCRibbonBaseElement [MFC], OnAfterChangeRect
- CMFCRibbonBaseElement [MFC], OnAutoRepeat
- CMFCRibbonBaseElement [MFC], OnCalcTextSize
- CMFCRibbonBaseElement [MFC], OnChangeMenuHighlight
- CMFCRibbonBaseElement [MFC], OnDraw
- CMFCRibbonBaseElement [MFC], OnDrawKeyTip
- CMFCRibbonBaseElement [MFC], OnDrawMenuImage
- CMFCRibbonBaseElement [MFC], OnDrawOnList
- CMFCRibbonBaseElement [MFC], OnKey
- CMFCRibbonBaseElement [MFC], OnMenuKey
- CMFCRibbonBaseElement [MFC], OnRTLChanged
- CMFCRibbonBaseElement [MFC], OnShow
- CMFCRibbonBaseElement [MFC], OnShowPopupMenu
- CMFCRibbonBaseElement [MFC], PostMenuCommand
- CMFCRibbonBaseElement [MFC], Redraw
- CMFCRibbonBaseElement [MFC], SetACCData
- CMFCRibbonBaseElement [MFC], SetCompactMode
- CMFCRibbonBaseElement [MFC], SetData
- CMFCRibbonBaseElement [MFC], SetDefaultMenuLook
- CMFCRibbonBaseElement [MFC], SetDescription
- CMFCRibbonBaseElement [MFC], SetID
- CMFCRibbonBaseElement [MFC], SetInitialMode
- CMFCRibbonBaseElement [MFC], SetKeys
- CMFCRibbonBaseElement [MFC], SetOriginal
- CMFCRibbonBaseElement [MFC], SetParentCategory
- CMFCRibbonBaseElement [MFC], SetParentMenu
- CMFCRibbonBaseElement [MFC], SetParentRibbonBar
- CMFCRibbonBaseElement [MFC], SetRect
- CMFCRibbonBaseElement [MFC], SetText
- CMFCRibbonBaseElement [MFC], SetTextAlwaysOnRight
- CMFCRibbonBaseElement [MFC], SetToolTipText
- CMFCRibbonBaseElement [MFC], SetVisible
- CMFCRibbonBaseElement [MFC], StretchHorizontally
- CMFCRibbonBaseElement [MFC], StretchToWholeRow
- CMFCRibbonBaseElement [MFC], UpdateTooltipInfo
- CMFCRibbonBaseElement [MFC], OnProcessKey
- CMFCRibbonBaseElement [MFC], OnSetFocus
ms.assetid: 419ea91b-5062-44cc-b0a3-f87d29566f62
ms.openlocfilehash: 9b6902c6f52b40b044c90d99835364f8c4f5a59f
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/11/2020
ms.locfileid: "97293867"
---
# <a name="cmfcribbonbaseelement-class"></a>CMFCRibbonBaseElement 类

`CMFCRibbonBaseElement`类是可以添加到[功能区栏](../../mfc/reference/cmfcribbonbar-class.md)的所有元素的基类。 功能区元素的示例包括功能区按钮、功能区复选框和功能区组合框。

## <a name="syntax"></a>语法

```
class CMFCRibbonBaseElement : public CObject
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|“属性”|描述|
|----------|-----------------|
|`CMFCRibbonBaseElement`|构造 `CMFCRibbonBaseElement` 对象。|

### <a name="public-methods"></a>公共方法

|“属性”|描述|
|----------|-----------------|
|[CMFCRibbonBaseElement：： AddToKeyList](#addtokeylist)|将功能区元素的 keytip 添加到 keytip 的数组。|
|[CMFCRibbonBaseElement：： AddToListBox](#addtolistbox)|将功能区元素添加到指定的功能区命令列表框中。|
|[CMFCRibbonBaseElement：： CanBeAddedToQuickAccessToolBar](#canbeaddedtoquickaccesstoolbar)|指示是否可以将功能区元素添加到快速访问工具栏。|
|[CMFCRibbonBaseElement：： CanBeCompacted](#canbecompacted)|指示功能区元素的大小是否可以紧凑。|
|[CMFCRibbonBaseElement：： CanBeStretched](#canbestretched)|指示功能区元素的高度是否可以垂直增加到功能区行的高度。|
|[CMFCRibbonBaseElement：： CanBeStretchedHorizontally](#canbestretchedhorizontally)|指示功能区元素的宽度是否可以更改。|
|[CMFCRibbonBaseElement：： CleanUpSizes](#cleanupsizes)|清除功能区元素的维度设置。|
|[CMFCRibbonBaseElement：： ClosePopupMenu](#closepopupmenu)|关闭功能区元素的弹出菜单。|
|[CMFCRibbonBaseElement：： CopyFrom](#copyfrom)|将指定的状态复制 `CMFCRibbonBaseElement` 到当前对象。|
|[CMFCRibbonBaseElement：:D estroyCtrl](#destroyctrl)|销毁功能区元素。|
|[CMFCRibbonBaseElement：:D rawImage](#drawimage)|绘制功能区元素的图像。|
|[CMFCRibbonBaseElement：： Find](#find)|如果指向当前对象，则返回指向功能区元素的指定指针。|
|[CMFCRibbonBaseElement：： FindByData](#findbydata)|如果包含指定数据，则检索指向功能区元素的指针。|
|[CMFCRibbonBaseElement：： FindByID](#findbyid)|检索指向功能区元素的指针（如果该元素由指定的命令 ID 标识）。|
|[CMFCRibbonBaseElement：： FindByOriginal](#findbyoriginal)|检索一个指向功能区元素的指针（如果它的原始功能区元素与指定的功能区元素匹配）。|
|[CMFCRibbonBaseElement：： GetCompactSize](#getcompactsize)|返回功能区元素的压缩大小。|
|[CMFCRibbonBaseElement：：](#getdata)|检索与功能区元素关联的用户定义数据。|
|[CMFCRibbonBaseElement：： GetDescription](#getdescription)|返回功能区元素的说明。|
|[CMFCRibbonBaseElement：： GetDroppedDown](#getdroppeddown)|检索一个指向功能区元素的指针（如果下拉菜单被删除）。|
|[CMFCRibbonBaseElement：： GetElements](#getelements)|将当前功能区元素添加到指定的数组。|
|[CMFCRibbonBaseElement：： GetElementsByID](#getelementsbyid)|如果当前功能区元素包含指定的命令 ID，则将当前功能区元素添加到指定的数组。|
|[CMFCRibbonBaseElement：： GetHighlighted](#gethighlighted)|如果突出显示了功能区元素，则检索指向它的指针。|
|[CMFCRibbonBaseElement：： GetID](#getid)|返回功能区元素的命令 ID。|
|[CMFCRibbonBaseElement：： GetImageSize](#getimagesize)|返回功能区元素的图像大小。|
|[CMFCRibbonBaseElement：： GetIntermediateSize](#getintermediatesize)|返回处于中间状态的功能区元素的大小。|
|[CMFCRibbonBaseElement：： GetKeys](#getkeys)|返回与功能区元素关联的 keytip。|
|[CMFCRibbonBaseElement：： GetKeyTipRect](#getkeytiprect)|检索功能区元素的 keytip 边界矩形。|
|[CMFCRibbonBaseElement：： GetKeyTipSize](#getkeytipsize)|检索 keytip 文本的大小。|
|[CMFCRibbonBaseElement：： GetLocationInGroup](#getlocationingroup)|指示功能区组中功能区元素的显示位置。|
|[CMFCRibbonBaseElement：： GetMenuKeys](#getmenukeys)|返回与按钮关联的键提示。|
|[CMFCRibbonBaseElement：： GetNotifyID](#getnotifyid)|检索功能区元素的通知命令 ID。|
|[CMFCRibbonBaseElement：： GetOriginal](#getoriginal)|检索原始功能区元素。|
|[CMFCRibbonBaseElement：： GetParentCategory](#getparentcategory)|检索功能区元素的功能区类别。|
|[CMFCRibbonBaseElement：： GetParentPanel](#getparentpanel)|检索包含功能区元素的功能区面板。|
|[CMFCRibbonBaseElement：： GetParentRibbonBar](#getparentribbonbar)|检索功能区元素的父功能区栏。|
|[CMFCRibbonBaseElement：： GetParentWnd](#getparentwnd)|检索功能区元素的父窗口。|
|[CMFCRibbonBaseElement：： GetPressed](#getpressed)|如果用户当前按下了功能区元素，则检索指向它的指针。|
|[CMFCRibbonBaseElement：： GetQuickAccessToolBarID](#getquickaccesstoolbarid)|检索位于 "快速访问工具栏" 中的功能区元素的命令 ID。|
|[CMFCRibbonBaseElement：： GetRect](#getrect)|返回功能区元素的边框。|
|[CMFCRibbonBaseElement：： GetRegularSize](#getregularsize)|返回功能区元素的常规大小。|
|[CMFCRibbonBaseElement：： GetSize](#getsize)|返回功能区元素的当前大小。|
|[CMFCRibbonBaseElement：： GetText](#gettext)|返回与功能区元素关联的文本。|
|[CMFCRibbonBaseElement：： GetToolTipText](#gettooltiptext)|返回功能区元素的工具提示文本。|
|[CMFCRibbonBaseElement：： GetTopLevelRibbonBar](#gettoplevelribbonbar)|检索功能区元素的顶级功能区栏。|
|[CMFCRibbonBaseElement：： HasCompactMode](#hascompactmode)|指定功能区元素是否有压缩模式。|
|[CMFCRibbonBaseElement：： HasFocus](#hasfocus)|指示父元素是否具有键盘焦点。|
|[CMFCRibbonBaseElement：： HasIntermediateMode](#hasintermediatemode)|指定功能区元素是否有中间模式。|
|[CMFCRibbonBaseElement：： HasLargeMode](#haslargemode)|指定功能区元素是否具有大模式。|
|[CMFCRibbonBaseElement：： HasMenu](#hasmenu)|指示功能区元素是否有菜单。|
|[CMFCRibbonBaseElement：： System.windows.media.visualtreehelper.hittest](#hittest)|检索一个指向功能区元素的指针（如果指定点位于该元素中）。|
|[CMFCRibbonBaseElement：： IsAlignByColumn](#isalignbycolumn)|指示功能区元素是否与其他功能区元素垂直对齐。|
|[CMFCRibbonBaseElement：： IsAlwaysLargeImage](#isalwayslargeimage)|指示功能区元素图像大小始终为大。|
|[CMFCRibbonBaseElement：： IsAutoRepeatMode](#isautorepeatmode)|指示功能区元素是否处于自动重复模式。|
|[CMFCRibbonBaseElement：： IsChecked](#ischecked)|指定是否选中功能区元素。|
|[CMFCRibbonBaseElement：： IsCompactMode](#iscompactmode)|指定功能区元素是否处于紧凑模式。|
|[CMFCRibbonBaseElement：： IsDefaultMenuLook](#isdefaultmenulook)||
|[CMFCRibbonBaseElement：： IsDisabled](#isdisabled)|指定是否禁用功能区元素。|
|[CMFCRibbonBaseElement：： IsDroppedDown](#isdroppeddown)|确定功能区元素是否显示弹出菜单并拖放。|
|[CMFCRibbonBaseElement：： IsFocused](#isfocused)|指定功能区元素是否具有焦点。|
|[CMFCRibbonBaseElement：： IsGalleryIcon](#isgalleryicon)|指示功能区元素是否包含在功能区库中。|
|[CMFCRibbonBaseElement：： IsHighlighted](#ishighlighted)|指定是否突出显示功能区元素。|
|[CMFCRibbonBaseElement：： IsIntermediateMode](#isintermediatemode)|指示功能区元素的当前图像是否为中间大小。|
|[CMFCRibbonBaseElement：： IsLargeMode](#islargemode)|指示功能区元素的当前图像大小是否大。|
|[CMFCRibbonBaseElement：： IsMenuMode](#ismenumode)|指示是否在菜单中包含功能区元素。|
|[CMFCRibbonBaseElement：： IsPressed](#ispressed)|指示用户是否已单击功能区元素。|
|[CMFCRibbonBaseElement：： IsQATMode](#isqatmode)|指示功能区元素是否包含在快速访问工具栏中。|
|[CMFCRibbonBaseElement：： IsSeparator](#isseparator)|指示功能区元素是否为显示分隔符。|
|[CMFCRibbonBaseElement：： IsShowGroupBorder](#isshowgroupborder)|指示功能区元素是否包含在显示公共边框的组中。|
|[CMFCRibbonBaseElement：： IsShowTooltipOnBottom](#isshowtooltiponbottom)|指示工具提示是否显示在功能区元素下。|
|[CMFCRibbonBaseElement：： IsTabStop](#istabstop)|指示是否可以通过键盘选择功能区元素。|
|[CMFCRibbonBaseElement：： IsTextAlwaysOnRight](#istextalwaysonright)|指示是否在右侧显示功能区元素的文本。|
|[CMFCRibbonBaseElement：： IsVisible](#isvisible)|指示功能区元素当前是否显示。|
|[CMFCRibbonBaseElement：： IsWholeRowHeight](#iswholerowheight)|指示功能区元素的显示 heigth 与包含它的功能区面板的显示高度是否相同。|
|[CMFCRibbonBaseElement：： NotifyCommand](#notifycommand)|将命令通知发送到功能区元素的父窗口。|
|[CMFCRibbonBaseElement：： NotifyHighlightListItem](#notifyhighlightlistitem)|当用户突出显示位于列表中的功能区元素时，通知功能区栏的父窗口。|
|[CMFCRibbonBaseElement：： OnAddToQAToolbar](#onaddtoqatoolbar)|将功能区元素添加到指定的快速访问工具栏。|
|[CMFCRibbonBaseElement：： OnAfterChangeRect](#onafterchangerect)|更新功能区元素的工具提示。|
|[CMFCRibbonBaseElement：： OnAutoRepeat](#onautorepeat)|更新功能区元素以响应持续的用户输入。|
|[CMFCRibbonBaseElement：： OnCalcTextSize](#oncalctextsize)|计算功能区元素的文本大小。|
|[CMFCRibbonBaseElement：： OnChangeMenuHighlight](#onchangemenuhighlight)|在菜单中的功能区元素的突出显示更改时由框架调用。|
|[CMFCRibbonBaseElement：： OnDraw](#ondraw)|由框架调用以绘制功能区元素。|
|[CMFCRibbonBaseElement：： OnDrawKeyTip](#ondrawkeytip)|由框架调用，用于绘制功能区元素的快捷键提示。|
|[CMFCRibbonBaseElement：： OnDrawMenuImage](#ondrawmenuimage)|当绘制功能区元素的菜单图像时由框架调用。|
|[CMFCRibbonBaseElement：： OnDrawOnList](#ondrawonlist)|由框架调用，用于在命令列表框中绘制功能区元素。|
|[CMFCRibbonBaseElement：： OnKey](#onkey)|当用户按下 keytip 并且功能区元素具有焦点时由框架调用。|
|[CMFCRibbonBaseElement：： OnMenuKey](#onmenukey)||
|[CMFCRibbonBaseElement：： OnRTLChanged](#onrtlchanged)|当布局更改方向时由框架调用。|
|[CMFCRibbonBaseElement：： OnShow](#onshow)|由框架调用以显示或隐藏功能区元素。|
|[CMFCRibbonBaseElement：： OnShowPopupMenu](#onshowpopupmenu)|当功能区元素要显示弹出菜单时由框架调用。|
|[CMFCRibbonBaseElement：:P ostMenuCommand](#postmenucommand)||
|[CMFCRibbonBaseElement：：重绘](#redraw)|更新功能区元素的显示。|
|[CMFCRibbonBaseElement：： SetACCData](#setaccdata)|设置功能区元素的可访问性数据。|
|[CMFCRibbonBaseElement：： SetCompactMode](#setcompactmode)|设置功能区元素的显示大小。|
|[CMFCRibbonBaseElement：： SetData](#setdata)|将数据项与功能区元素相关联。|
|[CMFCRibbonBaseElement：： SetDefaultMenuLook](#setdefaultmenulook)||
|[CMFCRibbonBaseElement：： SetDescription](#setdescription)|设置功能区元素的说明。|
|[CMFCRibbonBaseElement：： SetID](#setid)|设置功能区元素的命令 ID。|
|[CMFCRibbonBaseElement：： SetInitialMode](#setinitialmode)|设置功能区元素的初始显示大小。|
|[CMFCRibbonBaseElement：： SetKeys](#setkeys)|设置功能区元素的 keytip。|
|[CMFCRibbonBaseElement：： SetOriginal](#setoriginal)|设置功能区元素的原始功能区元素。|
|[CMFCRibbonBaseElement：： SetParentCategory](#setparentcategory)|设置功能区元素的父类别。|
|[CMFCRibbonBaseElement：： SetParentMenu](#setparentmenu)|设置功能区元素的父菜单容器。|
|[CMFCRibbonBaseElement：： SetParentRibbonBar](#setparentribbonbar)|设置功能区元素的父功能区栏。|
|[CMFCRibbonBaseElement：： SetRect](#setrect)|为功能区元素设置 fot 的显示矩形的尺寸。|
|[CMFCRibbonBaseElement：： SetText](#settext)|设置功能区元素的文本。|
|[CMFCRibbonBaseElement：： SetTextAlwaysOnRight](#settextalwaysonright)|设置要在右侧显示的功能区元素的文本。|
|[CMFCRibbonBaseElement：： SetToolTipText](#settooltiptext)|设置功能区元素的工具提示文本。|
|[CMFCRibbonBaseElement：： SetVisible](#setvisible)|设置功能区元素的可见性状态。|
|[CMFCRibbonBaseElement：： StretchHorizontally](#stretchhorizontally)|拉伸功能区元素的宽度。|
|[CMFCRibbonBaseElement：： StretchToWholeRow](#stretchtowholerow)|将功能区元素的显示高度更改为指定的行高。|
|[CMFCRibbonBaseElement：： UpdateTooltipInfo](#updatetooltipinfo)|使用功能区元素的命令资源更新工具提示文本。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCRibbonBaseElement：： OnProcessKey](#onprocesskey)|当用户按下快捷键时由框架调用。|
|[CMFCRibbonBaseElement：： OnSetFocus](#onsetfocus)|当功能区元素接收或失去输入焦点时由框架调用。|

## <a name="remarks"></a>备注

`CMFCRibbonBaseElement`类定义所有功能区元素所共有的属性，这些属性包括命令 ID、文本标签、工具提示文本、元素说明和状态 (这些属性可以集中、突出显示、按下、禁用、选中或下拉) 。

功能区元素的图像大小由 `RibbonImageType` 成员定义，可以是以下值之一：

- `RibbonImageLarge`

- `RibbonImageSmall`

功能区元素根据其大小显示小图像或大图像。

## <a name="example"></a>示例

下面的示例演示了如何使用 `CMFCRibbonBaseElement` 类中的各种方法。 该示例演示如何 `CMFCRibbonBaseElement` 从类获取对象 `CMFCRibbonStatusBar` 、设置功能区元素的说明、设置文本、设置 keytip 以及设置功能区元素的工具提示文本。 此代码片段属于 [Draw Client 示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_DrawClient#8](../../mfc/reference/codesnippet/cpp/cmfcribbonbaseelement-class_1.cpp)]
[!code-cpp[NVC_MFC_DrawClient#9](../../mfc/reference/codesnippet/cpp/cmfcribbonbaseelement-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

## <a name="requirements"></a>要求

**标头：** afxbaseribbonelement.h

## <a name="cmfcribbonbaseelementaddtokeylist"></a><a name="addtokeylist"></a> CMFCRibbonBaseElement：： AddToKeyList

将功能区元素的 keytip 添加到 keytip 的数组。

```
virtual void AddToKeyList(
    CArray<CMFCRibbonKeyTip*, CMFCRibbonKeyTip*>& arElems);
```

### <a name="parameters"></a>parameters

*arElems*<br/>
中键提示的 [CArray](../../mfc/reference/carray-class.md) 引用。

### <a name="remarks"></a>备注

启用功能区键提示功能后，当用户按下 ALT 键或 F10 键时，框架会显示功能区键提示。

## <a name="cmfcribbonbaseelementaddtolistbox"></a><a name="addtolistbox"></a> CMFCRibbonBaseElement：： AddToListBox

将功能区元素添加到指定的功能区命令列表框中。

```
virtual int AddToListBox(
    CMFCRibbonCommandsListBox* pWndListBox,
    BOOL bDeep);
```

### <a name="parameters"></a>parameters

*pWndListBox*<br/>
中指向命令列表框的指针。

*bDeep*<br/>
中未使用此参数。

### <a name="return-value"></a>返回值

添加的功能区元素的从零开始的索引。

### <a name="remarks"></a>备注

框架将功能区元素添加到 "命令" 列表框，以使用户能够自定义用户界面。

## <a name="cmfcribbonbaseelementcanbeaddedtoquickaccesstoolbar"></a><a name="canbeaddedtoquickaccesstoolbar"></a> CMFCRibbonBaseElement：： CanBeAddedToQuickAccessToolBar

指示是否可以将功能区元素添加到快速访问工具栏。

```
virtual BOOL CanBeAddedToQuickAccessToolBar() const;
```

### <a name="return-value"></a>返回值

如果可以添加元素，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementcanbecompacted"></a><a name="canbecompacted"></a> CMFCRibbonBaseElement：： CanBeCompacted

指示功能区元素的大小是否可以紧凑。

```
virtual BOOL CanBeCompacted() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的大小可以紧凑，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

功能区元素的大小可以是 compact、中间或大。

## <a name="cmfcribbonbaseelementcanbestretched"></a><a name="canbestretched"></a> CMFCRibbonBaseElement：： CanBeStretched

指示功能区元素的高度是否可以垂直增加到功能区行的高度。

```
virtual BOOL CanBeStretched();
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 重写此方法以指示功能区元素的高度是否可以垂直增加到功能区行的高度。

## <a name="cmfcribbonbaseelementcanbestretchedhorizontally"></a><a name="canbestretchedhorizontally"></a> CMFCRibbonBaseElement：： CanBeStretchedHorizontally

指示功能区元素的宽度是否可以更改。

```
virtual BOOL CanBeStretchedHorizontally();
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示功能区元素的宽度是否可以更改。

## <a name="cmfcribbonbaseelementcleanupsizes"></a><a name="cleanupsizes"></a> CMFCRibbonBaseElement：： CleanUpSizes

清除功能区元素的维度设置。

```
virtual void CleanUpSizes();
```

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 在派生类中重写此方法以重置功能区元素的维度设置。

## <a name="cmfcribbonbaseelementclosepopupmenu"></a><a name="closepopupmenu"></a> CMFCRibbonBaseElement：： ClosePopupMenu

关闭功能区元素的弹出菜单。

```
virtual void ClosePopupMenu();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementcopyfrom"></a><a name="copyfrom"></a> CMFCRibbonBaseElement：： CopyFrom

将指定 [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) 的状态复制到当前对象。

```
virtual void CopyFrom(const CMFCRibbonBaseElement& src);
```

### <a name="parameters"></a>parameters

*src*<br/>
中源 [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) 对象。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementdestroyctrl"></a><a name="destroyctrl"></a> CMFCRibbonBaseElement：:D estroyCtrl

销毁功能区元素。

```
virtual void DestroyCtrl();
```

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 在派生类中重写此方法以销毁功能区元素。

## <a name="cmfcribbonbaseelementdrawimage"></a><a name="drawimage"></a> CMFCRibbonBaseElement：:D rawImage

绘制功能区元素的图像。

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

type<br/>
中图像类型枚举值。 有关可能值的列表，请参阅 "备注" 部分。

*rectImage*<br/>
中图像矩形。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 在派生类中重写此方法，以绘制功能区元素的图像。

下表列出了 *类型* 参数的可能值：

|值|描述|
|-|-|
| `RibbonImageLarge`  | 大32x32 像素图像大小。  |
| `RibbonImageSmall`  | 小型16x16 像素图像大小。  |

## <a name="cmfcribbonbaseelementfind"></a><a name="find"></a> CMFCRibbonBaseElement：： Find

返回指定的指针（如果它指向当前对象）。

```
virtual CMFCRibbonBaseElement* Find(const CMFCRibbonBaseElement* pElement);
```

### <a name="parameters"></a>parameters

*pElement*<br/>
中指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果 *pElement* 指向当前对象，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementfindbydata"></a><a name="findbydata"></a> CMFCRibbonBaseElement：： FindByData

如果包含指定数据，则检索指向功能区元素的指针。

```
virtual CMFCRibbonBaseElement* FindByData(DWORD_PTR dwData);
```

### <a name="parameters"></a>parameters

*dwData*<br/>
中与功能区元素关联的数据。

### <a name="return-value"></a>返回值

如果功能区元素包含指定数据，则为指向它的指针; 否则为。否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementfindbyid"></a><a name="findbyid"></a> CMFCRibbonBaseElement：： FindByID

检索指向功能区元素的指针（如果该元素由指定的命令 ID 标识）。

```
virtual CMFCRibbonBaseElement* FindByID(UINT uiCmdID);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中功能区元素的命令 ID。

### <a name="return-value"></a>返回值

一个指向功能区元素的指针（如果该元素由指定的命令 ID 标识）;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementfindbyoriginal"></a><a name="findbyoriginal"></a> CMFCRibbonBaseElement：： FindByOriginal

检索指向当前功能区元素的指针（如果其原始功能区元素与指定的功能区元素匹配）。

```
virtual CMFCRibbonBaseElement* FindByOriginal(CMFCRibbonBaseElement* pOriginal);
```

### <a name="parameters"></a>parameters

*pOriginal*<br/>
中指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果功能区元素的原始功能区元素与指定的功能区元素匹配，则为指向它的指针;否则为 NULL。

### <a name="remarks"></a>备注

复制到另一个容器的功能区元素会保留一个指向原始功能区元素的指针。

## <a name="cmfcribbonbaseelementgetcompactsize"></a><a name="getcompactsize"></a> CMFCRibbonBaseElement：： GetCompactSize

返回功能区元素的压缩大小。

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素的压缩大小。

> [!NOTE]
> 紧凑型大小意味着功能区元素会被截断 (显示小图像或不包含文本) 的图像。

## <a name="cmfcribbonbaseelementgetdata"></a><a name="getdata"></a> CMFCRibbonBaseElement：：

检索与功能区元素关联的用户定义数据。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的用户定义数据。

## <a name="cmfcribbonbaseelementgetdescription"></a><a name="getdescription"></a> CMFCRibbonBaseElement：： GetDescription

返回功能区元素的说明。

```
virtual CString GetDescription() const;
```

### <a name="return-value"></a>返回值

功能区元素说明。 如果功能区元素位于 [CMFCRibbonMainPanel 类](../../mfc/reference/cmfcribbonmainpanel-class.md)中，则在状态栏或工具提示中或菜单按钮下显示说明。

## <a name="cmfcribbonbaseelementgetdroppeddown"></a><a name="getdroppeddown"></a> CMFCRibbonBaseElement：： GetDroppedDown

检索一个指向功能区元素的指针（如果下拉菜单被删除）。

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>返回值

如果下拉菜单被删除，则为指向功能区元素的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetelements"></a><a name="getelements"></a> CMFCRibbonBaseElement：： GetElements

将当前功能区元素添加到指定的数组。

```
virtual void GetElements(
    CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*arElements*<br/>
[in，out]功能区元素的数组。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetelementsbyid"></a><a name="getelementsbyid"></a> CMFCRibbonBaseElement：： GetElementsByID

如果当前功能区元素包含指定的命令 ID，则将当前功能区元素添加到指定的数组。

```
virtual void GetElementsByID(
    UINT uiCmdID,
    CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>parameters

*uiCmdID*<br/>
中功能区元素的命令 ID。

*arElements*<br/>
中功能区元素的数组。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgethighlighted"></a><a name="gethighlighted"></a> CMFCRibbonBaseElement：： GetHighlighted

如果突出显示了功能区元素，则检索指向它的指针。

```
virtual CMFCRibbonBaseElement* GetHighlighted();
```

### <a name="return-value"></a>返回值

如果突出显示了功能区元素，则为指向它的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetid"></a><a name="getid"></a> CMFCRibbonBaseElement：： GetID

返回功能区元素的命令 ID。

```
UINT GetID() const;
```

### <a name="return-value"></a>返回值

功能区元素的命令 ID。

## <a name="cmfcribbonbaseelementgetimagesize"></a><a name="getimagesize"></a> CMFCRibbonBaseElement：： GetImageSize

返回功能区元素的图像大小。

```
virtual CSize GetImageSize(RibbonImageType R) const;
```

### <a name="return-value"></a>返回值

功能区元素的图像大小。

## <a name="cmfcribbonbaseelementgetintermediatesize"></a><a name="getintermediatesize"></a> CMFCRibbonBaseElement：： GetIntermediateSize

返回处于中间状态的功能区元素的大小。

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素在其中间状态的大小。

## <a name="cmfcribbonbaseelementgetkeys"></a><a name="getkeys"></a> CMFCRibbonBaseElement：： GetKeys

返回与功能区元素关联的 keytip。

```
LPCTSTR GetKeys() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的 keytip。

## <a name="cmfcribbonbaseelementgetkeytiprect"></a><a name="getkeytiprect"></a> CMFCRibbonBaseElement：： GetKeyTipRect

检索功能区元素的 keytip 边界矩形。

```
virtual CRect GetKeyTipRect(
    CDC* pDC,
    BOOL bIsMenu);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*bIsMenu*<br/>
中如果功能区元素显示一个弹出菜单，则为 TRUE; 否则为。否则为 FALSE。

### <a name="return-value"></a>返回值

始终返回值为0的矩形。

### <a name="remarks"></a>备注

在派生类中重写此方法以返回 keytip 边界矩形。

## <a name="cmfcribbonbaseelementgetkeytipsize"></a><a name="getkeytipsize"></a> CMFCRibbonBaseElement：： GetKeyTipSize

检索 keytip 文本的大小。

```
virtual CSize GetKeyTipSize(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="return-value"></a>返回值

Keytip 文本的大小。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetlocationingroup"></a><a name="getlocationingroup"></a> CMFCRibbonBaseElement：： GetLocationInGroup

指示功能区组中功能区元素的显示位置。

```
RibbonElementLocation GetLocationInGroup() const;
```

### <a name="return-value"></a>返回值

`RibbonElementLocation` 枚举值。 下表列出了可能的值。

|值|描述|
|-----------|-----------------|
|`RibbonElementNotInGroup`|功能区组中未包含功能区元素。|
|`RibbonElementSingleInGroup`|功能区元素显示为功能区组中的唯一项。|
|`RibbonElementFirstInGroup`|功能区元素显示在功能区组的左侧。|
|`RibbonElementLastInGroup`|功能区元素显示在功能区组的右端。|
|`RibbonElementMiddleInGroup`|功能区元素不显示在功能区组的任一端。|

### <a name="remarks"></a>备注

功能区元素组仅水平对齐。

## <a name="cmfcribbonbaseelementgetmenukeys"></a><a name="getmenukeys"></a> CMFCRibbonBaseElement：： GetMenuKeys

返回功能区元素的菜单快捷键提示。

```
LPCTSTR GetMenuKeys() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的菜单快捷键提示。

### <a name="remarks"></a>备注

调用时，菜单快捷键提示会显示一个弹出菜单。

## <a name="cmfcribbonbaseelementgetnotifyid"></a><a name="getnotifyid"></a> CMFCRibbonBaseElement：： GetNotifyID

检索功能区元素的通知命令 ID。

```
virtual UINT GetNotifyID();
```

### <a name="return-value"></a>返回值

通知命令 ID。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetoriginal"></a><a name="getoriginal"></a> CMFCRibbonBaseElement：： GetOriginal

检索原始功能区元素。

```
CMFCRibbonBaseElement* GetOriginal() const;
```

### <a name="return-value"></a>返回值

指向原始功能区元素的指针。

### <a name="remarks"></a>备注

复制到另一个容器的功能区元素会保留一个指向原始功能区元素的指针。

## <a name="cmfcribbonbaseelementgetparentcategory"></a><a name="getparentcategory"></a> CMFCRibbonBaseElement：： GetParentCategory

检索功能区元素的功能区类别。

```
CMFCRibbonCategory* GetParentCategory() const;
```

### <a name="return-value"></a>返回值

指向功能区类别的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetparentpanel"></a><a name="getparentpanel"></a> CMFCRibbonBaseElement：： GetParentPanel

检索包含功能区元素的功能区面板。

```
virtual CMFCRibbonPanel* GetParentPanel() const;
```

### <a name="return-value"></a>返回值

指向包含功能区元素的功能区面板的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetparentribbonbar"></a><a name="getparentribbonbar"></a> CMFCRibbonBaseElement：： GetParentRibbonBar

检索功能区元素的父功能区栏。

```
CMFCRibbonBar* GetParentRibbonBar() const;
```

### <a name="return-value"></a>返回值

指向功能区元素的父功能区栏的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetparentwnd"></a><a name="getparentwnd"></a> CMFCRibbonBaseElement：： GetParentWnd

检索功能区元素的父窗口。

```
virtual CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>返回值

如果方法成功，则为指向功能区元素的父窗口的指针;否则为 NULL。

### <a name="remarks"></a>备注

功能区元素的父窗口是 [CMFCRibbonBar 类](../../mfc/reference/cmfcribbonbar-class.md) 或 [CMFCRibbonPanelMenuBar](internal-classes.md)。

## <a name="cmfcribbonbaseelementgetpressed"></a><a name="getpressed"></a> CMFCRibbonBaseElement：： GetPressed

如果用户当前按下了功能区元素，则检索指向它的指针。

```
virtual CMFCRibbonBaseElement* GetPressed();
```

### <a name="return-value"></a>返回值

如果用户当前按下了功能区元素，则为指向它的指针; 否则为。否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetquickaccesstoolbarid"></a><a name="getquickaccesstoolbarid"></a> CMFCRibbonBaseElement：： GetQuickAccessToolBarID

检索位于 "快速访问工具栏" 中的功能区元素的命令 ID。

```
virtual UINT GetQuickAccessToolBarID() const;
```

### <a name="return-value"></a>返回值

功能区元素位于快速访问工具栏中时的命令 ID。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementgetrect"></a><a name="getrect"></a> CMFCRibbonBaseElement：： GetRect

返回功能区元素的边框。

```
CRect GetRect() const;
```

### <a name="return-value"></a>返回值

功能区元素的边框。 矩形的位置位于父功能区控件的坐标中。

## <a name="cmfcribbonbaseelementgetregularsize"></a><a name="getregularsize"></a> CMFCRibbonBaseElement：： GetRegularSize

返回功能区元素的常规大小。

```
virtual CSize GetRegularSize(CDC* pDC) = 0;
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素的常规大小。

### <a name="remarks"></a>备注

> [!NOTE]
> 常规大小是功能区元素的最大可能大小。

## <a name="cmfcribbonbaseelementgetsize"></a><a name="getsize"></a> CMFCRibbonBaseElement：： GetSize

返回功能区元素的当前大小。

```
virtual CSize GetSize(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="return-value"></a>返回值

功能区元素的当前大小。

## <a name="cmfcribbonbaseelementgettext"></a><a name="gettext"></a> CMFCRibbonBaseElement：： GetText

返回与功能区元素关联的文本。

```
LPCTSTR GetText() const;
```

### <a name="return-value"></a>返回值

与功能区元素关联的文本。

## <a name="cmfcribbonbaseelementgettooltiptext"></a><a name="gettooltiptext"></a> CMFCRibbonBaseElement：： GetToolTipText

返回功能区元素的工具提示文本。

```
virtual CString GetToolTipText() const;
```

### <a name="return-value"></a>返回值

功能区元素的工具提示文本。

## <a name="cmfcribbonbaseelementgettoplevelribbonbar"></a><a name="gettoplevelribbonbar"></a> CMFCRibbonBaseElement：： GetTopLevelRibbonBar

检索功能区元素的顶级功能区栏。

```
CMFCRibbonBar* GetTopLevelRibbonBar() const;
```

### <a name="return-value"></a>返回值

如果方法成功，则为功能区元素的顶级功能区栏的指针;否则为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementhascompactmode"></a><a name="hascompactmode"></a> CMFCRibbonBaseElement：： HasCompactMode

指定功能区元素是否有压缩模式。

```
virtual BOOL HasCompactMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有紧凑模式，则为 TRUE。 否则为 FALSE。

### <a name="remarks"></a>备注

> [!NOTE]
> 在 compact 模式下，元素只显示一个小图像。

## <a name="cmfcribbonbaseelementhasintermediatemode"></a><a name="hasintermediatemode"></a> CMFCRibbonBaseElement：： HasIntermediateMode

指定功能区元素是否有中间模式。

```
virtual BOOL HasIntermediateMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有中间模式，则为 TRUE; 否则为 FALSE。 在中间模式下，元素显示图像右侧的小图像和文本。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementhaslargemode"></a><a name="haslargemode"></a> CMFCRibbonBaseElement：： HasLargeMode

确定功能区元素是否有大型模式。

```
virtual BOOL HasLargeMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的模式较大，则为 TRUE。 否则为 FALSE。

### <a name="remarks"></a>备注

在大模式下，元素可以获得父面板的全部高度。

## <a name="cmfcribbonbaseelementhasmenu"></a><a name="hasmenu"></a> CMFCRibbonBaseElement：： HasMenu

指示功能区元素是否有菜单。

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 在派生类中重写此方法，以指示功能区元素是否有菜单。

## <a name="cmfcribbonbaseelementhittest"></a><a name="hittest"></a> CMFCRibbonBaseElement：： System.windows.media.visualtreehelper.hittest

检索一个指向功能区元素的指针（如果指定点位于该元素中）。

```
virtual CMFCRibbonBaseElement* HitTest(CPoint point);
```

### <a name="parameters"></a>parameters

*情况*<br/>
中未使用此参数。

### <a name="return-value"></a>返回值

一个指向功能区元素的指针（如果存在）;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回指向功能区元素的有效指针（如果存在）。 重写此方法以指示该点是否位于功能区元素中。

## <a name="cmfcribbonbaseelementisalignbycolumn"></a><a name="isalignbycolumn"></a> CMFCRibbonBaseElement：： IsAlignByColumn

指示功能区元素是否与其他功能区元素垂直对齐。

```
virtual BOOL IsAlignByColumn() const;
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 在派生类中重写此方法，以指示派生功能区元素是否与其他功能区元素垂直对齐。

## <a name="cmfcribbonbaseelementisalwayslargeimage"></a><a name="isalwayslargeimage"></a> CMFCRibbonBaseElement：： IsAlwaysLargeImage

指示功能区元素图像大小始终为大。

```
virtual BOOL IsAlwaysLargeImage() const;
```

### <a name="return-value"></a>返回值

如果功能区元素图像大小始终很大，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

大图像大小为 32 x 32 像素。

## <a name="cmfcribbonbaseelementisautorepeatmode"></a><a name="isautorepeatmode"></a> CMFCRibbonBaseElement：： IsAutoRepeatMode

指示功能区元素是否处于自动重复模式。

```
virtual BOOL IsAutoRepeatMode(int& nDelay) const;
```

### <a name="parameters"></a>parameters

*nDelay*<br/>
中未使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示功能区元素是否处于自动重复模式。

在自动重复模式下，功能区元素以毫秒为单位，以毫秒为单位响应用户输入。

## <a name="cmfcribbonbaseelementischecked"></a><a name="ischecked"></a> CMFCRibbonBaseElement：： IsChecked

指定是否选中功能区元素。

```
virtual BOOL IsChecked() const;
```

### <a name="return-value"></a>返回值

如果选中功能区元素，则为 TRUE;否则为 FALSE。

## <a name="cmfcribbonbaseelementiscompactmode"></a><a name="iscompactmode"></a> CMFCRibbonBaseElement：： IsCompactMode

指定功能区元素是否处于紧凑模式。

```
BOOL IsCompactMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素处于简洁模式，则为 TRUE; 否则为。否则为 FALSE。

## <a name="cmfcribbonbaseelementisdefaultmenulook"></a><a name="isdefaultmenulook"></a> CMFCRibbonBaseElement：： IsDefaultMenuLook

指示功能区元素是否设置为显示为弹出命令。

```
BOOL IsDefaultMenuLook() const;
```

### <a name="return-value"></a>返回值

如果功能区元素设置为显示为弹出命令，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisdisabled"></a><a name="isdisabled"></a> CMFCRibbonBaseElement：： IsDisabled

指定是否禁用功能区元素。

```
virtual BOOL IsDisabled() const;
```

### <a name="return-value"></a>返回值

如果禁用功能区元素，则为 TRUE;否则为 FALSE。

## <a name="cmfcribbonbaseelementisdroppeddown"></a><a name="isdroppeddown"></a> CMFCRibbonBaseElement：： IsDroppedDown

指定功能区元素是否显示弹出菜单并拖放。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>返回值

如果关闭功能区元素并显示一个弹出菜单，则为 TRUE;否则为 FALSE。

## <a name="cmfcribbonbaseelementisfocused"></a><a name="isfocused"></a> CMFCRibbonBaseElement：： IsFocused

指定功能区元素是否具有焦点。

```
virtual BOOL IsFocused() const;
```

### <a name="return-value"></a>返回值

如果功能区元素具有焦点，则为 TRUE; 否则为。否则为 FALSE。

## <a name="cmfcribbonbaseelementisgalleryicon"></a><a name="isgalleryicon"></a> CMFCRibbonBaseElement：： IsGalleryIcon

指示功能区元素是否包含在功能区库中。

```
virtual BOOL IsGalleryIcon() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 在派生类中重写此方法，以指示功能区元素是否包含在功能区库中。

## <a name="cmfcribbonbaseelementishighlighted"></a><a name="ishighlighted"></a> CMFCRibbonBaseElement：： IsHighlighted

指定是否突出显示功能区元素。

```
virtual BOOL IsHighlighted() const;
```

### <a name="return-value"></a>返回值

如果突出显示功能区元素，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisintermediatemode"></a><a name="isintermediatemode"></a> CMFCRibbonBaseElement：： IsIntermediateMode

指示功能区元素的当前图像是否为中间大小。

```
BOOL IsIntermediateMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的图像为中间大小，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

中间图像大小为 16 x 16 像素。

## <a name="cmfcribbonbaseelementislargemode"></a><a name="islargemode"></a> CMFCRibbonBaseElement：： IsLargeMode

指示功能区元素的当前图像是否为大大小。

```
BOOL IsLargeMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的图像大小较大，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

大图像大小为 32 x 32 像素。

## <a name="cmfcribbonbaseelementismenumode"></a><a name="ismenumode"></a> CMFCRibbonBaseElement：： IsMenuMode

指示是否在菜单中包含功能区元素。

```
BOOL IsMenuMode() const;
```

### <a name="return-value"></a>返回值

如果功能区元素包含在菜单中，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementispressed"></a><a name="ispressed"></a> CMFCRibbonBaseElement：： IsPressed

指示用户是否已单击功能区元素。

```
virtual BOOL IsPressed() const;
```

### <a name="return-value"></a>返回值

如果用户已单击功能区元素，则为 TRUE;否则为 FALSE。

## <a name="cmfcribbonbaseelementisqatmode"></a><a name="isqatmode"></a> CMFCRibbonBaseElement：： IsQATMode

指示功能区元素是否包含在快速访问工具栏中。

```
BOOL IsQATMode() const;
```

### <a name="return-value"></a>返回值

如果快速访问工具栏中包含功能区元素，则为 TRUE; 否则为 false。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisseparator"></a><a name="isseparator"></a> CMFCRibbonBaseElement：： IsSeparator

指示功能区元素是否为显示分隔符。

```
virtual BOOL IsSeparator() const;
```

### <a name="return-value"></a>返回值

如果功能区元素为显示分隔符，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisshowgroupborder"></a><a name="isshowgroupborder"></a> CMFCRibbonBaseElement：： IsShowGroupBorder

指示功能区元素是否包含在显示公共边框的组中。

```
BOOL IsShowGroupBorder() const;
```

### <a name="return-value"></a>返回值

如果功能区元素包含在显示公共边框的组中，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisshowtooltiponbottom"></a><a name="isshowtooltiponbottom"></a> CMFCRibbonBaseElement：： IsShowTooltipOnBottom

指示工具提示是否显示在功能区元素下。

```
virtual BOOL IsShowTooltipOnBottom() const;
```

### <a name="return-value"></a>返回值

如果在功能区元素下显示工具提示，则为 TRUE;如果在指针附近显示工具提示，则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementistabstop"></a><a name="istabstop"></a> CMFCRibbonBaseElement：： IsTabStop

指示是否可以通过键盘选择功能区元素。

```
virtual BOOL IsTabStop() const;
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 重写此方法以指示是否可以通过键盘选择功能区元素。

## <a name="cmfcribbonbaseelementistextalwaysonright"></a><a name="istextalwaysonright"></a> CMFCRibbonBaseElement：： IsTextAlwaysOnRight

指示是否在右侧显示功能区元素的文本。

```
BOOL IsTextAlwaysOnRight() const;
```

### <a name="return-value"></a>返回值

如果右侧显示功能区元素的文本，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementisvisible"></a><a name="isvisible"></a> CMFCRibbonBaseElement：： IsVisible

指示功能区元素当前是否显示。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>返回值

如果功能区元素当前正在显示，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementiswholerowheight"></a><a name="iswholerowheight"></a> CMFCRibbonBaseElement：： IsWholeRowHeight

指示功能区元素的显示高度是否与包含它的功能区面板的显示高度相同。

```
virtual BOOL IsWholeRowHeight() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示功能区元素的显示高度是否与包含它的功能区面板的显示高度相同。

## <a name="cmfcribbonbaseelementnotifycommand"></a><a name="notifycommand"></a> CMFCRibbonBaseElement：： NotifyCommand

将命令通知发送到功能区元素的父窗口。

```
BOOL NotifyCommand(BOOL bWithDelay = FALSE);
```

### <a name="parameters"></a>parameters

*bWithDelay*<br/>
中若要将命令通知添加到父窗口的消息队列中，则为 TRUE;若要将消息立即发送到父窗口，则为 FALSE。

### <a name="return-value"></a>返回值

如果已发送消息，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementnotifyhighlightlistitem"></a><a name="notifyhighlightlistitem"></a> CMFCRibbonBaseElement：： NotifyHighlightListItem

当用户突出显示位于列表中的功能区元素时，通知功能区栏的父窗口。

```
virtual void NotifyHighlightListItem(int nIndex);
```

### <a name="parameters"></a>parameters

*nIndex*<br/>
中列表中功能区元素的索引。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementonaddtoqatoolbar"></a><a name="onaddtoqatoolbar"></a> CMFCRibbonBaseElement：： OnAddToQAToolbar

将功能区元素添加到指定的快速访问工具栏。

```
virtual BOOL OnAddToQAToolbar(CMFCRibbonQuickAccessToolBar& qat);
```

### <a name="parameters"></a>parameters

*qat*<br/>
中快速访问工具栏。

### <a name="return-value"></a>返回值

始终返回 TRUE，指示已将功能区元素添加到快速访问工具栏。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementonafterchangerect"></a><a name="onafterchangerect"></a> CMFCRibbonBaseElement：： OnAfterChangeRect

更新功能区元素的工具提示。

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法将更新功能区元素的工具提示。 重写此方法，以便在功能区元素的显示矩形发生更改后对其进行更新。

## <a name="cmfcribbonbaseelementonautorepeat"></a><a name="onautorepeat"></a> CMFCRibbonBaseElement：： OnAutoRepeat

更新功能区元素以响应持续的用户输入。

```
virtual BOOL OnAutoRepeat();
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以处理持续的用户输入。

## <a name="cmfcribbonbaseelementoncalctextsize"></a><a name="oncalctextsize"></a> CMFCRibbonBaseElement：： OnCalcTextSize

计算功能区元素的文本大小。

```
virtual void OnCalcTextSize(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以计算功能区元素的文本大小。

## <a name="cmfcribbonbaseelementonchangemenuhighlight"></a><a name="onchangemenuhighlight"></a> CMFCRibbonBaseElement：： OnChangeMenuHighlight

在菜单中的功能区元素的突出显示更改时由框架调用。

```
virtual void OnChangeMenuHighlight(CMFCRibbonPanelMenuBar* pPanelMenuBar
    CMFCRibbonBaseElement* pHot);
```

### <a name="parameters"></a>parameters

*pPanelMenuBar*<br/>
中未使用此参数。

*照片*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以更新突出显示时位于菜单中的功能区元素。

## <a name="cmfcribbonbaseelementondraw"></a><a name="ondraw"></a> CMFCRibbonBaseElement：： OnDraw

由框架调用以绘制功能区元素。

```
virtual void OnDraw(CDC* pDC) = 0;
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

### <a name="remarks"></a>备注

如果要自定义特定功能区元素的绘制，请在派生类中重写此方法。

## <a name="cmfcribbonbaseelementondrawkeytip"></a><a name="ondrawkeytip"></a> CMFCRibbonBaseElement：： OnDrawKeyTip

由框架调用，用于绘制功能区元素的快捷键提示。

```
virtual void OnDrawKeyTip(
    CDC* pDC,
    const CRect& rect,
    BOOL bIsMenu);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*rect*<br/>
中Keytip 的边界矩形。

*bIsMenu*<br/>
中如果 keytip 用于弹出菜单按钮，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementondrawmenuimage"></a><a name="ondrawmenuimage"></a> CMFCRibbonBaseElement：： OnDrawMenuImage

当绘制功能区元素的菜单图像时由框架调用。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*rect*<br/>
中菜单图像矩形。

### <a name="return-value"></a>返回值

始终返回 TRUE 以指示已绘制图像。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementondrawonlist"></a><a name="ondrawonlist"></a> CMFCRibbonBaseElement：： OnDrawOnList

由框架调用，用于在命令列表框中绘制功能区元素。

```
virtual void OnDrawOnList(
    CDC* pDC,
    CString strText,
    int nTextOffset,
    CRect rect,
    BOOL bIsSelected,
    BOOL bHighlighted);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向功能区元素的设备上下文的指针。

*strText*<br/>
中显示文本。

*nTextOffset*<br/>
中从列表框左侧到显示文本的距离（以像素为单位）。

*rect*<br/>
中功能区元素的显示矩形。

*bIsSelected*<br/>
中未使用此参数。

*bHighlighted*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

"命令" 列表框显示功能区元素，以使用户能够自定义快速访问工具栏。

## <a name="cmfcribbonbaseelementonkey"></a><a name="onkey"></a> CMFCRibbonBaseElement：： OnKey

当用户按下 keytip 并且功能区元素具有焦点时由框架调用。

```
virtual BOOL OnKey(BOOL bIsMenuKey);
```

### <a name="parameters"></a>parameters

*bIsMenuKey*<br/>
中如果 keytip 显示一个弹出菜单，则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果已处理事件，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementonmenukey"></a><a name="onmenukey"></a> CMFCRibbonBaseElement：： OnMenuKey

当用户按下主面板上的菜单快捷键提示时由框架调用。

```
virtual BOOL OnMenuKey(UINT nUpperChar);
```

### <a name="parameters"></a>parameters

*nUpperChar*<br/>
中未使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法，以便在用户按下主面板上的菜单快捷键提示时做出响应。

## <a name="cmfcribbonbaseelementonprocesskey"></a><a name="onprocesskey"></a> CMFCRibbonBaseElement：： OnProcessKey

当用户按下快捷键时由框架调用。

```
virtual BOOL OnProcessKey(UINT nChar);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
中未使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

如果希望功能区元素处理快捷键，请重写此方法。

## <a name="cmfcribbonbaseelementonrtlchanged"></a><a name="onrtlchanged"></a> CMFCRibbonBaseElement：： OnRTLChanged

当布局更改方向时由框架调用。

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>parameters

*bIsRTL*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以在布局更改方向时调整功能区元素。 默认的布局方向是从左向右。

## <a name="cmfcribbonbaseelementonsetfocus"></a><a name="onsetfocus"></a> CMFCRibbonBaseElement：： OnSetFocus

当功能区元素接收或失去输入焦点时由框架调用。

```
virtual void OnSetFocus(BOOL B);
```

### <a name="remarks"></a>备注

如果希望您的应用程序处理功能区元素的焦点更改，请在派生类中重写此方法。

## <a name="cmfcribbonbaseelementonshow"></a><a name="onshow"></a> CMFCRibbonBaseElement：： OnShow

由框架调用以显示或隐藏功能区元素。

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>parameters

*bShow*<br/>
中未使用此参数。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。 重写此方法以显示或隐藏功能区元素。

## <a name="cmfcribbonbaseelementonshowpopupmenu"></a><a name="onshowpopupmenu"></a> CMFCRibbonBaseElement：： OnShowPopupMenu

在功能区元素显示弹出菜单之前由框架调用。

```
virtual void OnShowPopupMenu();
```

### <a name="remarks"></a>备注

此方法通知功能区栏的父窗口，功能区元素将显示一个弹出菜单。

## <a name="cmfcribbonbaseelementpostmenucommand"></a><a name="postmenucommand"></a> CMFCRibbonBaseElement：:P ostMenuCommand

关闭功能区元素的弹出菜单，并向父菜单发送一个关闭消息。

```cpp
void PostMenuCommand(UINT uiCmdId);
```

### <a name="parameters"></a>parameters

*uiCmdId*<br/>
中未使用参数。

### <a name="remarks"></a>备注

仅当功能区元素位于弹出菜单上时，才会发送关闭消息。

## <a name="cmfcribbonbaseelementredraw"></a><a name="redraw"></a> CMFCRibbonBaseElement：：重绘

更新功能区元素的显示。

```
virtual void Redraw();
```

### <a name="remarks"></a>备注

此方法通过使用 RDW_INVALIDATE、RDW_ERASE 和 RDW_UPDATENOW 标志集调用 [CWnd：： RedrawWindow](/windows/win32/api/winuser/nf-winuser-redrawwindow) 来重绘功能区元素的显示矩形。

## <a name="cmfcribbonbaseelementsetaccdata"></a><a name="setaccdata"></a> CMFCRibbonBaseElement：： SetACCData

设置功能区元素的可访问性数据。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>parameters

*pParent*<br/>
功能区元素的父窗口。

*data*<br/>
功能区元素的可访问性数据。

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法将设置功能区元素的可访问性数据，并始终返回 TRUE。 重写此方法以设置可访问性数据并返回一个指示成功或失败的值。

## <a name="cmfcribbonbaseelementsetcompactmode"></a><a name="setcompactmode"></a> CMFCRibbonBaseElement：： SetCompactMode

设置功能区元素的显示大小。

```
virtual void SetCompactMode(BOOL bCompactMode = TRUE);
```

### <a name="parameters"></a>parameters

*bCompactMode*<br/>
中若要减小功能区元素的显示大小，则为 TRUE;若要增加功能区元素的显示大小，则为 FALSE。

### <a name="remarks"></a>备注

下表汇总了此方法的逻辑。

|*bCompactMode*|当前功能区元素大小|新功能区元素大小|
|--------------------|---------------------------------|-----------------------------|
|true|精简|无更改。|
|true|中级|压缩（如果可能）。|
|true|大型|中间（如果可能）。|
|FALSE|精简|中间（如果可能）;否则为大。|

## <a name="cmfcribbonbaseelementsetdata"></a><a name="setdata"></a> CMFCRibbonBaseElement：： SetData

将数据项与功能区元素相关联。

```cpp
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>parameters

*dwData*<br/>
中数据值。

## <a name="cmfcribbonbaseelementsetdefaultmenulook"></a><a name="setdefaultmenulook"></a> CMFCRibbonBaseElement：： SetDefaultMenuLook

设置要显示为弹出命令的功能区元素。

```cpp
void SetDefaultMenuLook(BOOL bIsDefaultMenuLook = TRUE);
```

### <a name="parameters"></a>parameters

*bIsDefaultMenuLook*<br/>
中若要将功能区元素设置为显示为弹出命令，则为 TRUE; 否则为。否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsetdescription"></a><a name="setdescription"></a> CMFCRibbonBaseElement：： SetDescription

设置功能区元素的说明。

```
virtual void SetDescription(LPCTSTR lpszText);
```

### <a name="parameters"></a>parameters

*lpszText*<br/>
中功能区元素的说明。

### <a name="remarks"></a>备注

框架在状态栏、工具提示或菜单按钮下显示新说明。

## <a name="cmfcribbonbaseelementsetid"></a><a name="setid"></a> CMFCRibbonBaseElement：： SetID

设置功能区元素的命令 ID。

```
virtual void SetID(UINT nID);
```

### <a name="parameters"></a>parameters

*nID*<br/>
中命令 ID。

## <a name="cmfcribbonbaseelementsetinitialmode"></a><a name="setinitialmode"></a> CMFCRibbonBaseElement：： SetInitialMode

设置功能区元素的初始显示大小。

```
virtual void SetInitialMode(BOOL bOneRow = FALSE);
```

### <a name="parameters"></a>parameters

*bOneRow*<br/>
中如果要将功能区元素的显示大小限制为 compact 或中间，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

功能区元素的显示大小可以是 compact、中间或大。

## <a name="cmfcribbonbaseelementsetkeys"></a><a name="setkeys"></a> CMFCRibbonBaseElement：： SetKeys

设置功能区元素的键提示。

```
virtual void SetKeys(
    LPCTSTR lpszKeys,
    LPCTSTR lpszMenuKeys=NULL);
```

### <a name="parameters"></a>parameters

*lpszKeys*<br/>
中功能区元素的快捷键提示。

*lpszMenuKeys*<br/>
中功能区元素的弹出菜单的快捷键提示。

## <a name="cmfcribbonbaseelementsetoriginal"></a><a name="setoriginal"></a> CMFCRibbonBaseElement：： SetOriginal

设置功能区元素的原始功能区元素。

```
virtual void SetOriginal(CMFCRibbonBaseElement* pOriginal);
```

### <a name="parameters"></a>parameters

*pOriginal*<br/>
中指向功能区元素的指针。

### <a name="remarks"></a>备注

复制到另一个容器的功能区元素会保留一个指向原始功能区元素的指针。

## <a name="cmfcribbonbaseelementsetparentcategory"></a><a name="setparentcategory"></a> CMFCRibbonBaseElement：： SetParentCategory

设置功能区元素的父类别。

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### <a name="parameters"></a>parameters

*pParent*<br/>
中指向功能区类别的指针。

### <a name="remarks"></a>备注

功能区控件中的选项卡式组称为类别。

## <a name="cmfcribbonbaseelementsetparentmenu"></a><a name="setparentmenu"></a> CMFCRibbonBaseElement：： SetParentMenu

设置功能区元素的父菜单容器。

```
virtual void SetParentMenu(CMFCRibbonPanelMenuBar* pMenuBar);
```

### <a name="parameters"></a>parameters

*pMenuBar*<br/>
中父菜单。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsetparentribbonbar"></a><a name="setparentribbonbar"></a> CMFCRibbonBaseElement：： SetParentRibbonBar

设置功能区元素的父功能区栏。

```
virtual void SetParentRibbonBar(CMFCRibbonBar* pRibbonBar);
```

### <a name="parameters"></a>parameters

*pRibbonBar*<br/>
中指向父功能区栏的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsetrect"></a><a name="setrect"></a> CMFCRibbonBaseElement：： SetRect

设置功能区元素的显示矩形的尺寸。

```cpp
void SetRect(CRect rect);
```

### <a name="parameters"></a>parameters

*rect*<br/>
中矩形的尺寸。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsettext"></a><a name="settext"></a> CMFCRibbonBaseElement：： SetText

设置功能区元素的文本和 keytip。

```
virtual void SetText(LPCTSTR lpszText);
```

### <a name="parameters"></a>parameters

*lpszText*<br/>
中功能区元素的文本和 keytip。

### <a name="remarks"></a>备注

若要设置功能区元素的 keytip，请将后跟 keytip 字符的行转义序列附加到 *lpszText*。

### <a name="example"></a>示例

```
//Set the text for the ribbon element
SetText(_T("Margins"))
//Set the text and a single-letter keytip
SetText(_T("Margins\nm"))
//Set the text and a multiple-letter keytip
SetText(_T("Line Numbers\nln"))
```

## <a name="cmfcribbonbaseelementsettextalwaysonright"></a><a name="settextalwaysonright"></a> CMFCRibbonBaseElement：： SetTextAlwaysOnRight

设置要在右侧显示的功能区元素的文本。

```
virtual void SetTextAlwaysOnRight(BOOL bSet = TRUE);
```

### <a name="parameters"></a>parameters

*bSet*<br/>
中若要在右侧显示文本，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementsettooltiptext"></a><a name="settooltiptext"></a> CMFCRibbonBaseElement：： SetToolTipText

设置功能区元素的工具提示文本。

```
virtual void SetToolTipText(LPCTSTR lpszText);
```

### <a name="parameters"></a>parameters

*lpszText*<br/>
中工具提示文本。

## <a name="cmfcribbonbaseelementsetvisible"></a><a name="setvisible"></a> CMFCRibbonBaseElement：： SetVisible

设置功能区元素的可见性。

```cpp
void SetVisible(BOOL bIsVisible);
```

### <a name="parameters"></a>parameters

*bIsVisible*<br/>
中若要显示功能区元素，则为 TRUE;若为 FALSE，则隐藏功能区元素。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementstretchhorizontally"></a><a name="stretchhorizontally"></a> CMFCRibbonBaseElement：： StretchHorizontally

拉伸功能区元素的宽度。

```
virtual void StretchHorizontally();
```

### <a name="remarks"></a>备注

默认情况下，此方法在调试生成中生成断言失败，因此不应调用。 重写此方法以拉伸功能区元素的宽度。

## <a name="cmfcribbonbaseelementstretchtowholerow"></a><a name="stretchtowholerow"></a> CMFCRibbonBaseElement：： StretchToWholeRow

将功能区元素的显示高度更改为指定的行高。

```
virtual BOOL StretchToWholeRow(
    CDC* pDC,
    int nHeight);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中未使用此参数。

*nHeight*<br/>
中行的高度。

### <a name="return-value"></a>返回值

如果设置了显示高度，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

重写此方法可以将功能区元素的显示高度更改为指定的行高。

## <a name="cmfcribbonbaseelementupdatetooltipinfo"></a><a name="updatetooltipinfo"></a> CMFCRibbonBaseElement：： UpdateTooltipInfo

使用功能区元素的命令资源更新工具提示文本。

```
virtual void UpdateTooltipInfo();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaseelementhasfocus"></a><a name="hasfocus"></a> CMFCRibbonBaseElement：： HasFocus

指示父元素是否具有键盘焦点。

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>返回值

如果功能区元素是焦点，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)
