---
title: COleControl ç±»
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 97c605426ed0ac869714f0f83d4957f7f6ce7d87
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426911"
---
# <a name="colecontrol-class"></a>COleControl ç±»

ç¨äºå¼å OLE æ§ä»¶çéè¦åºç±»ã

## <a name="syntax"></a>è¯­æ³

```
class COleControl : public CWnd
```

## <a name="members"></a>æå

### <a name="public-constructors"></a>å¬å±æé å½æ°

|åç§°|è¯´æ|
|----------|-----------------|
|[COleControlï¼ï¼ COleControl](#colecontrol)|åå»ºä¸ä¸ª `COleControl` å¯¹è±¡ã|

### <a name="public-methods"></a>å¬å±æ¹æ³

|åç§°|è¯´æ|
|----------|-----------------|
|[COleControlï¼ï¼ AmbientAppearance](#ambientappearance)|æ£ç´¢æ§ä»¶å½åçå¤è§ã|
|[COleControlï¼ï¼ AmbientBackColor](#ambientbackcolor)|è¿åç¯å¢èæ¯å¼å±æ§çå¼ã|
|[COleControlï¼ï¼ AmbientDisplayName](#ambientdisplayname)|è¿åç±å®¹å¨æå®çæ§ä»¶çåç§°ã|
|[COleControlï¼ï¼ AmbientFont](#ambientfont)|è¿åç¯å¢å­ä½å±æ§çå¼ã|
|[COleControlï¼ï¼ AmbientForeColor](#ambientforecolor)|è¿åç¯å¢åæ¯è²å±æ§çå¼ã|
|[COleControlï¼ï¼ AmbientLocaleID](#ambientlocaleid)|è¿åå®¹å¨çåºåè®¾ç½® IDã|
|[COleControlï¼ï¼ AmbientScaleUnits](#ambientscaleunits)|è¿åå®¹å¨ä½¿ç¨çåä½ç±»åã|
|[COleControlï¼ï¼ AmbientShowGrabHandles](#ambientshowgrabhandles)|ç¡®å®æ¯å¦åºæ¾ç¤ºæåæã|
|[COleControlï¼ï¼ AmbientShowHatching](#ambientshowhatching)|ç¡®å®æ¯å¦åºæ¾ç¤ºé´å½±ã|
|[COleControlï¼ï¼ AmbientTextAlign](#ambienttextalign)|è¿åç±å®¹å¨æå®çææ¬å¯¹é½æ¹å¼çç±»åã|
|[COleControlï¼ï¼ AmbientUIDead](#ambientuidead)|ç¡®å®æ§ä»¶æ¯å¦åºååºç¨æ·çé¢æä½ã|
|[COleControlï¼ï¼ AmbientUserMode](#ambientusermode)|ç¡®å®å®¹å¨çæ¨¡å¼ã|
|[COleControlï¼ï¼ BoundPropertyChanged](#boundpropertychanged)|éç¥å®¹å¨ç»å®å±æ§å·²æ´æ¹ã|
|[COleControlï¼ï¼ BoundPropertyRequestEdit](#boundpropertyrequestedit)|è¯·æ±æéä»¥ç¼è¾å±æ§å¼ã|
|[COleControlï¼ï¼ ClientToParent](#clienttoparent)|å°ç¸å¯¹äºæ§ä»¶åç¹çç¹è½¬æ¢ä¸ºç¸å¯¹äºå¶å®¹å¨åç¹çç¹ã|
|[COleControlï¼ï¼ ClipCaretRect](#clipcaretrect)|å¦ææå¥ç¬¦å·ç©å½¢ä¸æ§ä»¶éå ï¼åè°æ´å®ã|
|[COleControlï¼ï¼ ControlInfoChanged](#controlinfochanged)|å¨æ§ä»¶å¤ççå©è®°é®éæ´æ¹åè°ç¨æ­¤å½æ°ã|
|[COleControlï¼:D isplayError](#displayerror)|åæ§ä»¶çç¨æ·æ¾ç¤º stock éè¯¯äºä»¶ã|
|[COleControlï¼:D oClick](#doclick)|Stock `DoClick` æ¹æ³çå®ç°ã|
|[COleControlï¼:D oPropExchange](#dopropexchange)|åºåå `COleControl` å¯¹è±¡çå±æ§ã|
|[COleControlï¼:D oSuperclassPaint](#dosuperclasspaint)|éç»å·²ä» Windows æ§ä»¶ä¸­äº§çå­ç±»ç OLE æ§ä»¶ã|
|[COleControlï¼ï¼ EnableSimpleFrame](#enablesimpleframe)|å¯ç¨æ§ä»¶çç®åå¸§æ¯æã|
|[COleControlï¼ï¼ ExchangeExtent](#exchangeextent)|åºååæ§ä»¶çå®½åº¦åé«åº¦ã|
|[COleControlï¼ï¼ ExchangeStockProps](#exchangestockprops)|åºååæ§ä»¶çå¸¸ç¨å±æ§ã|
|[COleControlï¼ï¼ ExchangeVersion](#exchangeversion)|åºååæ§ä»¶ççæ¬å·ã|
|[COleControlï¼ï¼ FireClick](#fireclick)|æ¿åè¡ç¥¨ `Click` äºä»¶ã|
|[COleControlï¼ï¼ FireDblClick](#firedblclick)|æ¿åè¡ç¥¨ `DblClick` äºä»¶ã|
|[COleControlï¼ï¼ FireError](#fireerror)|æ¿åè¡ç¥¨ `Error` äºä»¶ã|
|[COleControlï¼ï¼ FireEvent](#fireevent)|å¼åèªå®ä¹äºä»¶ã|
|[COleControlï¼ï¼ FireKeyDown](#firekeydown)|æ¿åè¡ç¥¨ `KeyDown` äºä»¶ã|
|[COleControlï¼ï¼ FireKeyPress](#firekeypress)|æ¿åè¡ç¥¨ `KeyPress` äºä»¶ã|
|[COleControlï¼ï¼ FireKeyUp](#firekeyup)|æ¿åè¡ç¥¨ `KeyUp` äºä»¶ã|
|[COleControlï¼ï¼ FireMouseDown](#firemousedown)|æ¿åè¡ç¥¨ `MouseDown` äºä»¶ã|
|[COleControlï¼ï¼ FireMouseMove](#firemousemove)|æ¿åè¡ç¥¨ `MouseMove` äºä»¶ã|
|[COleControlï¼ï¼ FireMouseUp](#firemouseup)|æ¿åè¡ç¥¨ `MouseUp` äºä»¶ã|
|[COleControlï¼ï¼ FireReadyStateChange](#firereadystatechange)|å½æ§ä»¶çå°±ç»ªç¶æåçæ´æ¹æ¶ï¼å¼åäºä»¶ã|
|[COleControlï¼ï¼ GetActivationPolicy](#getactivationpolicy)|æ´æ¹æ¯æ `IPointerInactive` æ¥å£çæ§ä»¶çé»è®¤æ¿æ´»è¡ä¸ºã|
|[COleControlï¼ï¼ GetAmbientProperty](#getambientproperty)|è¿åæå®ç¯å¢å±æ§çå¼ã|
|[COleControlï¼ï¼ GetAppearance](#getappearance)|è¿å stock å¤è§å±æ§çå¼ã|
|[COleControlï¼ï¼ GetBackColor](#getbackcolor)|è¿å stock èæ¯è²å±æ§çå¼ã|
|[COleControlï¼ï¼ GetBorderStyle](#getborderstyle)|è¿å stock BorderStyle å±æ§çå¼ã|
|[COleControlï¼ï¼ GetCapture](#getcapture)|ç¡®å®æ çªå£ãå·²æ¿æ´»çæ§ä»¶å¯¹è±¡æ¯å¦å·æé¼ æ æè·ã|
|[COleControlï¼ï¼ GetClassID](#getclassid)|æ£ç´¢æ§ä»¶ç OLE ç±» IDã|
|[COleControlï¼ï¼ GetClientOffset](#getclientoffset)|æ£ç´¢æ§ä»¶çç©å½¢åºåçå·¦ä¸è§ä¸å¶å·¥ä½åºå·¦ä¸è§ä¹é´çå·®å¼ã|
|[COleControlï¼ï¼ GetClientRect](#getclientrect)|æ£ç´¢æ§ä»¶çå·¥ä½åºçå¤§å°ã|
|[COleControlï¼ï¼ GetClientSite](#getclientsite)|æ¥è¯¢å¯¹è±¡ï¼ä»¥ä¾¿æéæåå¶å®¹å¨ä¸­çå½åå®¢æ·ç«¯ç«ç¹ã|
|[COleControlï¼ï¼ GetControlFlags](#getcontrolflags)|æ£ç´¢æ§ä»¶æ å¿è®¾ç½®ã|
|[COleControlï¼ï¼ GetControlSize](#getcontrolsize)|è¿å OLE æ§ä»¶çä½ç½®åå¤§å°ã|
|[COleControlï¼ï¼ GetDC](#getdc)|ä¸ºæ çªå£æ§ä»¶æä¾ä»å¶å®¹å¨è·åè®¾å¤ä¸ä¸æçæ¹æ³ã|
|[COleControlï¼ï¼ GetEnabled](#getenabled)|è¿åå¯ç¨äºåºå­çå±æ§çå¼ã|
|[COleControlï¼ï¼ GetExtendedControl](#getextendedcontrol)|æ£ç´¢æåå±äºå®¹å¨çæ©å±æ§ä»¶å¯¹è±¡çæéã|
|[COleControlï¼ï¼ GetFocus](#getfocus)|ç¡®å®æ§ä»¶æ¯å¦æç¦ç¹ã|
|[COleControlï¼ï¼ Ivsfontandcolorstorage.getfont éè¯¯](#getfont)|è¿åå¸¸ç¨å­ä½å±æ§çå¼ã|
|[COleControlï¼ï¼ GetFontTextMetrics](#getfonttextmetrics)|è¿å `CFontHolder` å¯¹è±¡çææ ã|
|[COleControlï¼ï¼ GetForeColor](#getforecolor)|è¿å "è¡ç¥¨åæ¯è²" å±æ§çå¼ã|
|[COleControlï¼ï¼ GetHwnd](#gethwnd)|è¿å stock hWnd å±æ§çå¼ã|
|[COleControlï¼ï¼ GetMessageString](#getmessagestring)|æä¾èåé¡¹çç¶ææ ææ¬ã|
|[COleControlï¼ï¼ GetNotSupported](#getnotsupported)|ç¦æ­¢ç¨æ·è®¿é®æ§ä»¶çå±æ§å¼ã|
|[COleControlï¼ï¼ GetReadyState](#getreadystate)|è¿åæ§ä»¶çå°±ç»ªç¶æã|
|[COleControlï¼ï¼ GetRectInContainer](#getrectincontainer)|è¿åæ§ä»¶çç¸å¯¹äºå¶å®¹å¨çç©å½¢ã|
|[COleControlï¼ï¼ GetStockTextMetrics](#getstocktextmetrics)|è¿åå¸¸ç¨å­ä½å±æ§çåº¦éå¼ã|
|[COleControlï¼ï¼ GetText](#gettext)|è¿å stock ææ¬æ Caption å±æ§çå¼ã|
|[COleControlï¼ï¼ GetWindowlessDropTarget](#getwindowlessdroptarget)|éåä»¥åè®¸æ çªå£æ§ä»¶ä½ä¸ºææ¾æä½çç®æ ã|
|[COleControlï¼ï¼ InitializeIIDs](#initializeiids)|éç¥æ§ä»¶å°ä½¿ç¨ç Iid çåºç±»ã|
|[COleControlï¼ï¼ InternalGetFont](#internalgetfont)|è¿åå¸¸ç¨å­ä½å±æ§ç `CFontHolder` å¯¹è±¡ã|
|[COleControlï¼ï¼ InternalGetText](#internalgettext)|æ£ç´¢è¡ç¥¨ä»£ç æ é¢æææ¬å±æ§ã|
|[COleControlï¼ï¼ InternalSetReadyState](#internalsetreadystate)|è®¾ç½®æ§ä»¶çå°±ç»ªç¶æï¼å¹¶æ¿åå°±ç»ªç¶ææ´æ¹äºä»¶ã|
|[COleControlï¼ï¼ Microsoft.office.core.iribbonui.invalidatecontrol](#invalidatecontrol)|ä½¿æ¾ç¤ºçæ§ä»¶çåºåæ æï¼ä»èå¯¼è´éç»è¯¥æ§ä»¶ã|
|[COleControlï¼ï¼ InvalidateRgn](#invalidatergn)|ä½¿ç»å®åºååçå®¹å¨çªå£çå·¥ä½åºå¤±æã å¯ç¨äºå¨åºåä¸­éç»æ çªå£æ§ä»¶ã|
|[COleControlï¼ï¼ IsConvertingVBX](#isconvertingvbx)|åè®¸ä¸ç¨å è½½ OLE æ§ä»¶ã|
|[COleControlï¼ï¼ IsModified](#ismodified)|ç¡®å®æ§ä»¶ç¶ææ¯å¦å·²æ´æ¹ã|
|[COleControlï¼ï¼ IsOptimizedDraw](#isoptimizeddraw)|æç¤ºå®¹å¨æ¯å¦æ¯æå½åç»å¶æä½çä¼åç»å¾ã|
|[COleControlï¼ï¼ IsSubclassedControl](#issubclassedcontrol)|è°ç¨ä»¥ç¡®å®æ§ä»¶æ¯å¦ä¸º Windows æ§ä»¶çå­ç±»ã|
|[COleControlï¼ï¼ Load](#load)|éç½®ä»»ä½ä»¥åçå¼æ­¥æ°æ®å¹¶å¯å¨æ§ä»¶çå¼æ­¥å±æ§çæ°å è½½ã|
|[COleControlï¼ï¼ LockInPlaceActive](#lockinplaceactive)|ç¡®å®å®¹å¨æ¯å¦å¯ä»¥åç¨æ§ä»¶ã|
|[COleControlï¼ï¼ OnAmbientPropertyChange](#onambientpropertychange)|å¨ç¯å¢å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnAppearanceChanged](#onappearancechanged)|å½ "è¡ç¥¨å¤è§" å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnBackColorChanged](#onbackcolorchanged)|å½æ´æ¹äº stock èæ¯è²å±æ§æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnBorderStyleChanged](#onborderstylechanged)|å½ "è¡ç¥¨ BorderStyle" å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnClick](#onclick)|è°ç¨ä»¥æ¿å stock Click äºä»¶ã|
|[COleControlï¼ï¼ OnClose](#onclose)|éç¥æ§ä»¶ `IOleControl::Close` å·²è¢«è°ç¨ã|
|[COleControlï¼ï¼ OnDoVerb](#ondoverb)|å¨æ§è¡æ§å¶è°è¯åè°ç¨ã|
|[COleControlï¼ï¼ OnDraw](#ondraw)|å½è¯·æ±æ§ä»¶éç»èªèº«æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnDrawMetafile](#ondrawmetafile)|å½è¯·æ±æ§ä»¶ä½¿ç¨å¾åæä»¶è®¾å¤ä¸ä¸æéç»èªèº«æ¶ï¼ç±å®¹å¨è°ç¨ã|
|[COleControlï¼ï¼ OnEdit](#onedit)|ç±å®¹å¨è°ç¨ä»¥ UI æ¿æ´» OLE æ§ä»¶ã|
|[COleControlï¼ï¼ OnEnabledChanged](#onenabledchanged)|å½ "å·²å¯ç¨åºå­" å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnEnumVerbs](#onenumverbs)|ç±å®¹å¨è°ç¨ä»¥æä¸¾æ§ä»¶çè°è¯ã|
|[COleControlï¼ï¼ OnEventAdvise](#oneventadvise)|å½äºä»¶å¤çç¨åºè¿æ¥æä¸æ§ä»¶æ­å¼è¿æ¥æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnFontChanged](#onfontchanged)|å½ "å¸¸ç¨å­ä½" å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnForeColorChanged](#onforecolorchanged)|å½ "è¡ç¥¨åæ¯" å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnFreezeEvents](#onfreezeevents)|å½æ§ä»¶çäºä»¶è¢«å»ç»æè§£å»æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnGetColorSet](#ongetcolorset)|éç¥æ§ä»¶ `IOleObject::GetColorSet` å·²è¢«è°ç¨ã|
|[COleControlï¼ï¼ OnGetControlInfo](#ongetcontrolinfo)|åå®¹å¨æä¾å©è®°é®ä¿¡æ¯ã|
|[COleControlï¼ï¼ OnGetDisplayString](#ongetdisplaystring)|è°ç¨ä»¥è·åè¡¨ç¤ºå±æ§å¼çå­ç¬¦ä¸²ã|
|[COleControlï¼ï¼ OnGetInPlaceMenu](#ongetinplacemenu)|è¯·æ±å°ä¸å®¹å¨èååå¹¶çæ§ä»¶èåçå¥æã|
|[COleControlï¼ï¼ OnGetNaturalExtent](#ongetnaturalextent)|éåä»¥æ£ç´¢ææ¥è¿å»ºè®®å¤§å°ååºæ¨¡å¼çæ§ä»¶çæ¾ç¤ºå¤§å°ã|
|[COleControlï¼ï¼ OnGetPredefinedStrings](#ongetpredefinedstrings)|è¿åè¡¨ç¤ºå±æ§çå¯è½å¼çå­ç¬¦ä¸²ã|
|[COleControlï¼ï¼ OnGetPredefinedValue](#ongetpredefinedvalue)|è¿åä¸é¢å®ä¹å­ç¬¦ä¸²ç¸å¯¹åºçå¼ã|
|[COleControlï¼ï¼ OnGetViewExtent](#ongetviewextent)|éåä»¥æ£ç´¢æ§ä»¶çæ¾ç¤ºåºåçå¤§å°ï¼å¯ç¨äºå¯ç¨ä¸¤éç»å¶ï¼ã|
|[COleControlï¼ï¼ OnGetViewRect](#ongetviewrect)|éåä»¥å°æ§ä»¶çå¤§å°è½¬æ¢ä¸ºä»ç¹å®ä½ç½®å¼å§çç©å½¢ã|
|[COleControlï¼ï¼ OnGetViewStatus](#ongetviewstatus)|éåä»¥æ£ç´¢æ§ä»¶çè§å¾ç¶æã|
|[COleControlï¼ï¼ OnHideToolBars](#onhidetoolbars)|å½æ§ä»¶å¤äº UI ç¦ç¨ç¶ææ¶ç±å®¹å¨è°ç¨ã|
|[COleControlï¼ï¼ OnInactiveMouseMove](#oninactivemousemove)|éåä»¥ä½¿é¼ æ æéä¸çéæ´»å¨æ§ä»¶çå®¹å¨ WM_MOUSEMOVE åéå°æ§ä»¶çæ¶æ¯ã|
|[COleControlï¼ï¼ OnInactiveSetCursor](#oninactivesetcursor)|éåä»¥ä½¿é¼ æ æéä¸çéæ´»å¨æ§ä»¶çå®¹å¨ WM_SETCURSOR åéå°æ§ä»¶çæ¶æ¯ã|
|[COleControlï¼ï¼ OnKeyDownEvent](#onkeydownevent)|å¨æ¿åè¡ç¥¨ KeyDown äºä»¶ä¹åè°ç¨ã|
|[COleControlï¼ï¼ OnKeyPressEvent](#onkeypressevent)|å¨æ¿å stock æé®äºä»¶ä¹åè°ç¨ã|
|[COleControlï¼ï¼ OnKeyUpEvent](#onkeyupevent)|å¨æ¿å stock KeyUp äºä»¶ä¹åè°ç¨ã|
|[COleControlï¼ï¼ OnMapPropertyToPage](#onmappropertytopage)|æç¤ºç¨äºç¼è¾å±æ§çå±æ§é¡µã|
|[COleControlï¼ï¼ OnMnemonic](#onmnemonic)|å½å·²æä¸æ§ä»¶çå©è®°é®æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnProperties](#onproperties)|å¨è°ç¨æ§ä»¶ç "Properties" è°è¯æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnQueryHitPoint](#onqueryhitpoint)|éåä»¥æ¥è¯¢æ§ä»¶çæ¾ç¤ºæ¯å¦ä¸ç»å®ç¹éå ã|
|[COleControlï¼ï¼ OnQueryHitRect](#onqueryhitrect)|éåä»¥æ¥è¯¢æ§ä»¶çæ¾ç¤ºæ¯å¦ä¸ç»å®ç©å½¢ä¸­çä»»ä½ç¹éå ã|
|[COleControlï¼ï¼ OnRenderData](#onrenderdata)|ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã|
|[COleControlï¼ï¼ OnRenderFileData](#onrenderfiledata)|ç±æ¡æ¶è°ç¨ä»¥ä»æä»¶ä¸­æ£ç´¢æå®æ ¼å¼çæ°æ®ã|
|[COleControlï¼ï¼ OnRenderGlobalData](#onrenderglobaldata)|ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çå¨å±åå­ä¸­çæ°æ®ã|
|[COleControlï¼ï¼ OnResetState](#onresetstate)|å°æ§ä»¶çå±æ§éç½®ä¸ºé»è®¤å¼ã|
|[COleControlï¼ï¼ OnSetClientSite](#onsetclientsite)|éç¥æ§ä»¶ `IOleControl::SetClientSite` å·²è¢«è°ç¨ã|
|[COleControlï¼ï¼ OnSetData](#onsetdata)|å°æ§ä»¶çæ°æ®æ¿æ¢ä¸ºå¦ä¸ä¸ªå¼ã|
|[COleControlï¼ï¼ OnSetExtent](#onsetextent)|å¨æ§ä»¶çèå´åçæ´æ¹åè°ç¨ã|
|[COleControlï¼ï¼ OnSetObjectRects](#onsetobjectrects)|å¨æ§ä»¶çç»´åº¦æ´æ¹åè°ç¨ã|
|[COleControlï¼ï¼ OnShowToolBars](#onshowtoolbars)|å½æ§ä»¶å·²æ¿æ´» UI æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnTextChanged](#ontextchanged)|å½æ´æ¹äº stock ææ¬ææ é¢å±æ§æ¶è°ç¨ã|
|[COleControlï¼ï¼ OnWindowlessMessage](#onwindowlessmessage)|å¤çæ çªå£æ§ä»¶ççªå£æ¶æ¯ï¼é¼ æ åé®çæ¶æ¯é¤å¤ï¼ã|
|[COleControlï¼:P arentToClient](#parenttoclient)|å°ç¸å¯¹äºå®¹å¨åç¹çç¹è½¬æ¢ä¸ºç¸å¯¹äºæ§ä»¶åç¹çç¹ã|
|[COleControlï¼:P ostModalDialog](#postmodaldialog)|éç¥å®¹å¨æ¨¡å¼å¯¹è¯æ¡å·²å³é­ã|
|[COleControlï¼:P reModalDialog](#premodaldialog)|éç¥å®¹å¨å°è¦æ¾ç¤ºçæ¨¡å¼å¯¹è¯æ¡ã|
|[COleControlï¼ï¼ RecreateControlWindow](#recreatecontrolwindow)|éæ¯å¹¶éæ°åå»ºæ§ä»¶ççªå£ã|
|[COleControlï¼ï¼ Refresh](#refresh)|å¼ºå¶éæ°ç»å¶æ§ä»¶çå¤è§ã|
|[COleControlï¼ï¼ ReleaseCapture](#releasecapture)|éæ¾é¼ æ æè·ã|
|[COleControlï¼ï¼ ReleaseDC](#releasedc)|éæ¾æ çªå£æ§ä»¶çå®¹å¨çæ¾ç¤ºè®¾å¤ä¸ä¸æã|
|[COleControlï¼ï¼ ReparentControlWindow](#reparentcontrolwindow)|éç½®æ§ä»¶çªå£çç¶çº§ã|
|[COleControlï¼ï¼ ResetStockProps](#resetstockprops)|å° `COleControl` stock å±æ§åå§åä¸ºå¶é»è®¤å¼ã|
|[COleControlï¼ï¼ ResetVersion](#resetversion)|å°çæ¬å·åå§åä¸ºç»å®çå¼ã|
|[COleControlï¼ï¼ ScrollWindow](#scrollwindow)|åè®¸æ çªå£æ§ä»¶å¨å¶å°±å°æ´»å¨å¾åä¸­æ»å¨æ¾ç¤ºçåºåã|
|[COleControlï¼ï¼ SelectFontObject](#selectfontobject)|éæ©èªå®ä¹å­ä½å±æ§å°è®¾å¤ä¸ä¸æã|
|[COleControlï¼ï¼ SelectStockFont](#selectstockfont)|éæ© "å¸¸ç¨å­ä½" å±æ§å°è®¾å¤ä¸ä¸æã|
|[COleControlï¼ï¼ SerializeExtent](#serializeextent)|åºååæåå§åæ§ä»¶çæ¾ç¤ºç©ºé´ã|
|[COleControlï¼ï¼ SerializeStockProps](#serializestockprops)|åºååæåå§å `COleControl` å¸¸ç¨å±æ§ã|
|[COleControlï¼ï¼ SerializeVersion](#serializeversion)|åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯ã|
|[COleControlï¼ï¼ SetAppearance](#setappearance)|è®¾ç½® "è¡ç¥¨å¤è§" å±æ§çå¼ã|
|[COleControlï¼ï¼ SetBackColor](#setbackcolor)|è®¾ç½® "è¡ç¥¨èæ¯è²" å±æ§çå¼ã|
|[COleControlï¼ï¼ SetBorderStyle](#setborderstyle)|è®¾ç½® "stock BorderStyle" å±æ§çå¼ã|
|[COleControlï¼ï¼ SetCapture](#setcapture)|å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶å æ®é¼ æ æè·ã|
|[COleControlï¼ï¼ SetControlSize](#setcontrolsize)|è®¾ç½® OLE æ§ä»¶çä½ç½®åå¤§å°ã|
|[COleControlï¼ï¼ SetEnabled](#setenabled)|è®¾ç½® "å¯ç¨è¡ç¥¨" å±æ§çå¼ã|
|[COleControlï¼ï¼ SetFocus](#setfocus)|å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶æ¥æè¾å¥ç¦ç¹ã|
|[COleControlï¼ï¼ SetFont](#setfont)|è®¾ç½® "å¸¸ç¨å­ä½" å±æ§çå¼ã|
|[COleControlï¼ï¼ SetForeColor](#setforecolor)|è®¾ç½® "è¡ç¥¨åæ¯è²" å±æ§çå¼ã|
|[COleControlï¼ï¼ SetInitialSize](#setinitialsize)|è®¾ç½® OLE æ§ä»¶ç¬¬ä¸æ¬¡å¨å®¹å¨ä¸­æ¾ç¤ºæ¶çå¤§å°ã|
|[COleControlï¼ï¼ SetModifiedFlag](#setmodifiedflag)|æ´æ¹æ§ä»¶çä¿®æ¹ç¶æã|
|[COleControlï¼ï¼ SetNotPermitted](#setnotpermitted)|æç¤ºç¼è¾è¯·æ±å¤±è´¥ã|
|[COleControlï¼ï¼ SetNotSupported](#setnotsupported)|é²æ­¢ç¨æ·ä¿®æ¹æ§ä»¶çå±æ§å¼ã|
|[COleControlï¼ï¼ SetRectInContainer](#setrectincontainer)|è®¾ç½®æ§ä»¶ç¸å¯¹äºå¶å®¹å¨çç©å½¢ã|
|[COleControlï¼ï¼ SetText](#settext)|è®¾ç½® stock ææ¬ææ é¢å±æ§çå¼ã|
|[COleControlï¼ï¼ ThrowError](#throwerror)|æç¤º OLE æ§ä»¶ä¸­åçäºéè¯¯ã|
|[COleControlï¼ï¼ TransformCoords](#transformcoords)|è½¬æ¢å®¹å¨åæ§ä»¶ä¹é´çåæ å¼ã|
|[COleControlï¼ï¼ TranslateColor](#translatecolor)|å° OLE_COLOR å¼è½¬æ¢ä¸º COLORREF å¼ã|
|[COleControlï¼ï¼ WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|ç¡®å®å¨ä¸ä¸æ¬¡å è½½æ§ä»¶æ¶ç¯å¢å±æ§æ¯å¦å¯ç¨ã|
|[COleControlï¼ï¼ WindowProc](#windowproc)|ä¸º `COleControl` å¯¹è±¡æä¾ Windows è¿ç¨ã|

### <a name="protected-methods"></a>åä¿æ¤æ¹æ³

|åç§°|è¯´æ|
|----------|-----------------|
|[COleControlï¼:D rawContent](#drawcontent)|å½éè¦æ´æ°æ§ä»¶çå¤è§æ¶ç±æ¡æ¶è°ç¨ã|
|[COleControlï¼:D rawMetafile](#drawmetafile)|å½ä½¿ç¨å¾åæä»¶è®¾å¤ä¸ä¸ææ¶ç±æ¡æ¶è°ç¨ã|
|[COleControlï¼ï¼ IsInvokeAllowed](#isinvokeallowed)|å¯ç¨èªå¨åæ¹æ³è°ç¨ã|
|[COleControlï¼ï¼ SetInitialDataFormats](#setinitialdataformats)|ç±æ¡æ¶è°ç¨ä»¥åå§åæ§ä»¶æ¯æçæ°æ®æ ¼å¼åè¡¨ã|

## <a name="remarks"></a>å¤æ³¨

æ´¾çèª `CWnd`ï¼æ­¤ç±»ç»§æ¿ Windows çªå£å¯¹è±¡çææåè½ä»¥åç¹å®äº OLE çéå åè½ï¼å¦äºä»¶æ¿ååæ¯ææ¹æ³åå±æ§çåè½ã

å¯ä»¥å° OLE æ§ä»¶æå¥ OLE å®¹å¨åºç¨ç¨åºä¸­ï¼å¹¶ä½¿ç¨ååç³»ç»äºä»¶æ¿åå¹¶åå®¹å¨å¬å¼æ¹æ³åå±æ§ï¼ä¸å®¹å¨è¿è¡éä¿¡ã è¯·æ³¨æï¼æ å OLE å®¹å¨åªæ¯æ OLE æ§ä»¶çåºæ¬åè½ã å®ä»¬ä¸æ¯æ OLE æ§ä»¶çæ©å±åè½ã å¦æå¨æ§ä»¶ä¸­åçç¹å®æä½ï¼å°äºä»¶åéå°å®¹å¨ï¼åä¼åçäºä»¶æ¿åã åè¿æ¥ï¼å®¹å¨éè¿ä½¿ç¨ä¸ç»å¬å¼çæ¹æ³åå±æ§ï¼ç±»ä¼¼äºC++ç±»çæåå½æ°åæ°æ®æåï¼ä¸æ§ä»¶è¿è¡éä¿¡ã æ­¤æ¹æ³åè®¸å¼åäººåæ§å¶æ§ä»¶çå¤è§å¹¶å¨åçç¹å®æä½æ¶éç¥å®¹å¨ã

## <a name="windowless-controls"></a>æ çªå£æ§ä»¶

OLE æ§ä»¶å¯ä»¥å¨ä¸ä½¿ç¨çªå£çæåµä¸å°±å°æ¿æ´»ã æ çªå£æ§ä»¶å·æææ¾ä¼å¿ï¼

- æ çªå£æ§ä»¶å¯ä»¥æ¯éæçï¼ä¹å¯ä»¥æ¯éç©å½¢

- æ çªå£æ§ä»¶åå°å¯¹è±¡çå®ä¾å¤§å°ååå»ºæ¶é´

æ§ä»¶ä¸éè¦çªå£ã Windows æä¾çæå¡å¯ä»¥éè¿åä¸ªå±äº«çªå£ï¼éå¸¸æ¯å®¹å¨ï¼åä¸ä¸ªè°åº¦ä»£ç è½»æ¾å°æä¾ã å¨æ­¤å¯¹è±¡ä¸ï¼æä¸ä¸ªçªå£éå¸¸æ¯ä¸å¿è¦çã

å½ä½¿ç¨æ çªå£æ¿æ´»æ¶ï¼å®¹å¨ï¼æçªå£ï¼è´è´£æä¾å¶ä»å·²ç±æ§ä»¶èªå·±ççªå£æä¾çæå¡ã ä¾å¦ï¼å¦ææ¨çæ§ä»¶éè¦æ¥è¯¢é®çç¦ç¹ãæ¥è¯¢é¼ æ æè·æè·åè®¾å¤ä¸ä¸æï¼åè¿äºæä½ç±å®¹å¨ç®¡çã `COleControl` æ çªå£æä½æåå½æ°å¨å®¹å¨ä¸è°ç¨è¿äºæä½ã

å¯ç¨æ çªå£æ¿æ´»æ¶ï¼å®¹å¨ä¼å°è¾å¥æ¶æ¯å§æç»æ§ä»¶ç `IOleInPlaceObjectWindowless` æ¥å£ï¼ [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)çæ©å±å¯å®ç°æ çªå£æ¯æï¼ã å½è°æ´é¼ æ åæ åï¼æ­¤æ¥å£ `COleControl`çå®ç°å°éè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦è¿äºæ¶æ¯ã æ¨å¯ä»¥éè¿å°ç¸åºæ¡ç®æ·»å å°æ¶æ¯æ å°æ¥å¤çè¿äºæ¶æ¯ï¼å¦æ®éçªå£æ¶æ¯ã

å¨æ çªå£æ§ä»¶ä¸­ï¼åºå§ç»ä½¿ç¨ `COleControl` æåå½æ°ï¼èä¸æ¯ç¸åºç `CWnd` æåå½æ°æå¶ç¸å³ç Windows API å½æ°ã

OLE æ§ä»¶å¯¹è±¡ä¹å¯ä»¥ä»å¨æ´»å¨ç¶æä¸åå»ºçªå£ï¼ä½éæ´»å¨æ´»å¨è½¬æ¢æéçå·¥ä½éä¼ä¸éï¼å¹¶ä¸è¿æ¸¡éåº¦ä¼ä¸éã å¨æäºæåµä¸ï¼åºç°è¿ç§é®é¢ï¼ä½ä¸ºç¤ºä¾ï¼è¯·èèä½¿ç¨ææ¬æ¡ç½æ ¼ã å½ cursoring åæ¶ï¼å¿é¡»å°æ¯ä¸ªæ§ä»¶å°±å°æ¿æ´»ï¼ç¶åå°å¶åç¨ã éæ´»å¨/æ´»å¨è½¬æ¢çéåº¦å°ç´æ¥å½±åæ»å¨éåº¦ã

æå³å¼å OLE æ§ä»¶æ¡æ¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [Mfc Activex æ§ä»¶](../../mfc/mfc-activex-controls.md)å[æ¦è¿°ï¼åå»º mfc activex æ§å¶ç¨åº](../../mfc/reference/mfc-activex-control-wizard.md)ã æå³ä¼å OLE æ§ä»¶ï¼åæ¬æ çªå£åæ éªçæ§ä»¶ï¼çä¿¡æ¯ï¼è¯·åé[MFC ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="inheritance-hierarchy"></a>ç»§æ¿å±æ¬¡ç»æ

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>è¦æ±

**æ å¤´ï¼** afxctlãh

##  <a name="ambientbackcolor"></a>COleControlï¼ï¼ AmbientBackColor

è¿åç¯å¢èæ¯å¼å±æ§çå¼ã

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢èæ¯è²å±æ§çå½åå¼ï¼å¦ææï¼ã å¦æè¯¥å±æ§ä¸åæ¯æï¼åæ­¤å½æ°å°è¿åç³»ç»å®ä¹ç Windows èæ¯è²ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢èæ¯è²å±æ§å¯ä¾æææ§ä»¶ä½¿ç¨ï¼ç±å®¹å¨å®ä¹ã è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientdisplayname"></a>COleControlï¼ï¼ AmbientDisplayName

å®¹å¨åéç»æ§ä»¶çåç§°å¯ç¨äºåç¨æ·æ¾ç¤ºçéè¯¯æ¶æ¯ã

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>è¿åå¼

OLE æ§ä»¶çåç§°ã é»è®¤å¼ä¸ºé¶é¿åº¦å­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientfont"></a>COleControlï¼ï¼ AmbientFont

è¿åç¯å¢å­ä½å±æ§çå¼ã

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>è¿åå¼

æåå®¹å¨ç¯å¢å­ä½è°åº¦æ¥å£çæéã é»è®¤å¼ä¸º NULLã å¦æè¿åçä¸ç­äº NULLï¼åéè¦éè¿è°ç¨å¶[IUnknownï¼ï¼ Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)æåå½æ°æ¥éæ¾å­ä½ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢å­ä½å±æ§ç±å®¹å¨å®ä¹ï¼å¯ç¨äºæææ§ä»¶ãè¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientforecolor"></a>COleControlï¼ï¼ AmbientForeColor

è¿åç¯å¢åæ¯è²å±æ§çå¼ã

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢åæ¯è²å±æ§çå½åå¼ï¼å¦ææï¼ã å¦æä¸æ¯æï¼åæ­¤å½æ°å°è¿åç³»ç»å®ä¹ç Windows ææ¬é¢è²ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢åæ¯è²å±æ§å¯ä¾æææ§ä»¶ä½¿ç¨ï¼ç±å®¹å¨å®ä¹ã è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientlocaleid"></a>COleControlï¼ï¼ AmbientLocaleID

è¿åå®¹å¨çåºåè®¾ç½® IDã

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨ç LocaleID å±æ§çå¼ï¼å¦ææï¼ã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°è¿å0ã

### <a name="remarks"></a>å¤æ³¨

æ§ä»¶å¯ä»¥ä½¿ç¨ LocaleID æ¥è°æ´å¶ç¨æ·çé¢çç¹å®åºåè®¾ç½®ã è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientappearance"></a>COleControlï¼ï¼ AmbientAppearance

æ£ç´¢æ§ä»¶å¯¹è±¡çå½åå¤è§è®¾ç½®ã

```
short AmbientAppearance();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çå¤è§ï¼

- **0**å¹³é¢å¤è§

- **1**ä¸ç»´å¤è§

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯æ£ç´¢æ§ä»¶ç DISPID_AMBIENT_APPEARANCE å±æ§çå½åå¼ã

##  <a name="ambientscaleunits"></a>COleControlï¼ï¼ AmbientScaleUnits

è¿åå®¹å¨ä½¿ç¨çåä½ç±»åã

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>è¿åå¼

ä¸ä¸ªå­ç¬¦ä¸²ï¼å¶ä¸­åå«å®¹å¨çç¯å¢ ScaleUnitsã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°è¿åä¸ä¸ªé¿åº¦ä¸ºé¶çå­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

å®¹å¨çç¯å¢ ScaleUnits å±æ§å¯ç¨äºæ¾ç¤ºä½ç½®æç»´åº¦ï¼å¶ä¸­æ ææéåä½ï¼ä¾å¦ç¼æåç±³ã è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientshowgrabhandles"></a>COleControlï¼ï¼ AmbientShowGrabHandles

ç¡®å®å®¹å¨æ¯å¦åè®¸æ§ä»¶å¨æ´»å¨æ¶æ¾ç¤ºå¶èªèº«çæåæã

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>è¿åå¼

å¦æåºæ¾ç¤ºæåæï¼åä¸ºéé¶å¼;å¦åä¸º0ã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°å°è¿åéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientshowhatching"></a>COleControlï¼ï¼ AmbientShowHatching

ç¡®å®å®¹å¨æ¯å¦åè®¸æ§ä»¶å¨æ¿æ´» UI æ¶ä»¥é´å½±æ¨¡å¼æ¾ç¤ºèªèº«ã

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>è¿åå¼

å¦æåºæ¾ç¤ºé´å½±æ¨¡å¼ï¼åä¸ºéé¶å¼;å¦åä¸º0ã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°å°è¿åéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambienttextalign"></a>COleControlï¼ï¼ AmbientTextAlign

ç¡®å®æ§ä»¶å®¹å¨é¦éçç¯å¢ææ¬å¯¹é½æ¹å¼ã

```
short AmbientTextAlign();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢ææ¬å¯¹é½å±æ§çç¶æã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°è¿å0ã

ä¸é¢ååºäºææçè¿åå¼ï¼

|è¿åå¼|å«ä¹|
|------------------|-------------|
|0|å¸¸è§å¯¹é½æ¹å¼ï¼ä»å³å°å·¦çæ°å­ï¼ã|
|1|å·¦å¯¹é½|
|2|ä¸­å¿|
|3|å³å¯¹é½|

### <a name="remarks"></a>å¤æ³¨

æ­¤å±æ§å¯ç¨äºææåµå¥çæ§ä»¶ï¼å¹¶ä¸ç±å®¹å¨å®ä¹ã è¯·æ³¨æï¼æ¯ææ­¤å±æ§ä¸éè¦å®¹å¨ã

##  <a name="ambientuidead"></a>COleControlï¼ï¼ AmbientUIDead

ç¡®å®å®¹å¨æ¯å¦å¸ææ§ä»¶ååºç¨æ·çé¢æä½ã

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶åºååºç¨æ·çé¢æä½ï¼åä¸ºéé¶å¼;å¦åä¸º0ã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°è¿å0ã

### <a name="remarks"></a>å¤æ³¨

ä¾å¦ï¼å¨è®¾è®¡æ¨¡å¼ä¸ï¼å®¹å¨å¯è½å°æ­¤é¡¹è®¾ç½®ä¸º TRUEã

##  <a name="ambientusermode"></a>COleControlï¼ï¼ AmbientUserMode

ç¡®å®å®¹å¨æ¯å¤äºè®¾è®¡æ¨¡å¼è¿æ¯å¤äºç¨æ·æ¨¡å¼ã

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>è¿åå¼

å¦æå®¹å¨å¤äºç¨æ·æ¨¡å¼ï¼åä¸ºéé¶å¼;å¦åä¸º0ï¼å¤äºè®¾è®¡æ¨¡å¼ï¼ã å¦ææ­¤å±æ§ä¸åæ¯æï¼åæ­¤å½æ°è¿å TRUEã

### <a name="remarks"></a>å¤æ³¨

ä¾å¦ï¼å®¹å¨å¯è½å¨è®¾è®¡æ¨¡å¼ä¸å°æ­¤é¡¹è®¾ç½®ä¸º FALSEã

##  <a name="boundpropertychanged"></a>COleControlï¼ï¼ BoundPropertyChanged

ååºä¿¡å·è¡¨ç¤ºç»å®å±æ§å¼å·²æ´æ¹ã

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
æ§ä»¶çç»å®å±æ§çè°åº¦ IDã

### <a name="remarks"></a>å¤æ³¨

æ¯æ¬¡å±æ§çå¼åçæ´æ¹æ¶é½å¿é¡»è°ç¨æ­¤æ¹æ³ï¼å³ä½¿å¨æªéè¿å±æ§éæ¹æ³è¿è¡æ´æ¹çæåµä¸ä¹æ¯å¦æ­¤ã è¯·ç¹å«æ³¨ææ å°å°æååéçç»å®å±æ§ã ä»»ä½æ¶åæ­¤ç±»æååéåçæ´æ¹ï¼é½å¿é¡»è°ç¨ `BoundPropertyChanged`ã

##  <a name="boundpropertyrequestedit"></a>COleControlï¼ï¼ BoundPropertyRequestEdit

å `IPropertyNotifySink` æ¥å£è¯·æ±æéï¼ä»¥æ´æ¹æ§ä»¶æä¾çç»å®å±æ§å¼ã

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
æ§ä»¶çç»å®å±æ§çè°åº¦ IDã

### <a name="return-value"></a>è¿åå¼

å¦æåè®¸æ´æ¹ï¼åä¸ºéé¶å¼;å¦åä¸º0ã é»è®¤å¼ä¸ºéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

å¦ææéè¢«æç»ï¼åæ§ä»¶ä¸è½è®©å±æ§çå¼åçæ´æ¹ã è¿å¯ä»¥éè¿å¿½ç¥æå¤±è´¥å°è¯æ´æ¹å±æ§å¼çæä½æ¥å®æã

##  <a name="clienttoparent"></a>COleControlï¼ï¼ ClientToParent

å°*pPoint*çåæ è½¬æ¢ä¸ºç¶åæ ã

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
ä¸ä¸ªæéï¼æåå®¹å¨ä¸­ OLE æ§ä»¶çè¾¹çã ä¸æ¯å·¥ä½åºï¼èæ¯æ´ä¸ªæ§ä»¶çåºåï¼åæ¬è¾¹æ¡åæ»å¨æ¡ï¼ã

*pPoint*<br/>
æåè¦è½¬æ¢ä¸ºç¶ï¼å®¹å¨ï¼åæ ç OLE å·¥ä½åºç¹çæéã

### <a name="remarks"></a>å¤æ³¨

å¨ input *pPoint*ä¸ï¼ç¸å¯¹äº OLE æ§ä»¶ï¼æ§ä»¶å·¥ä½åºå·¦ä¸è§ï¼çå·¥ä½åºçåç¹ã On output *pPoint*æ¯ç¸å¯¹äºç¶çº§ï¼å®¹å¨å·¦ä¸è§ï¼çåç¹ã

##  <a name="clipcaretrect"></a>COleControlï¼ï¼ ClipCaretRect

å¦ææå¥ç¬¦å·ç©å½¢å®å¨æé¨åè¦çäºéå çä¸éæå¯¹è±¡ï¼åè°æ´å®ã

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
è¾å¥æ¶ï¼æååå«è¦è°æ´çæå¥ç¬¦å·åºåç[RECT](/windows/win32/api/windef/ns-windef-rect)ç»æçæéã è¾åºæ¶ï¼è°æ´åçæå¥ç¬¦å·åºå; å¦æå®å¨è¦çäºæå¥ç¬¦å·ç©å½¢ï¼åä¸º NULLã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

è±å­å·æ¯éªççº¿æ¡ãåæä½å¾ï¼éå¸¸æç¤ºææ¬æå¾å½¢çæå¥ä½ç½®ã

æ çªå£å¯¹è±¡å¨ä¸äºåæ£æ¥æå¥ç¬¦å·æ¯å¦é¨åæå®å¨éèäºéå å¯¹è±¡çæåµä¸ï¼ä¸è½å®å¨å°æ¾ç¤ºæå¥ç¬¦å·ã ä¸ºäºå®ç°æ­¤ç®çï¼å¯¹è±¡å¯ä»¥ä½¿ç¨ `ClipCaretRect` æ¥ä½¿æå¥ç¬¦å·è°æ´ï¼åå°ï¼ä»¥ç¡®ä¿å®éåäºåªè¾åºåã

åå»ºæå¥ç¬¦å·çå¯¹è±¡åºå°è±å­å·ç©å½¢æäº¤ç» `ClipCaretRect`ï¼å¹¶å°è°æ´åçç©å½¢ç¨äºæå¥ç¬¦å·ã å¦æå®å¨éèæå¥ç¬¦å·ï¼åæ­¤æ¹æ³å°è¿å FALSEï¼å¹¶ä¸å¨è¿ç§æåµä¸ï¼ä¸åºæ¾ç¤ºæå¥ç¬¦å·ã

##  <a name="colecontrol"></a>COleControlï¼ï¼ COleControl

æé  `COleControl` å¯¹è±¡ã

```
COleControl();
```

### <a name="remarks"></a>å¤æ³¨

éå¸¸ä¸ç´æ¥è°ç¨æ­¤å½æ°ã ç¸åï¼OLE æ§ä»¶éå¸¸ç±å¶ç±»å·¥ååå»ºã

##  <a name="controlinfochanged"></a>COleControlï¼ï¼ ControlInfoChanged

å¦ææ§ä»¶æ¯æçå©è®°é®éå·²æ´æ¹ï¼åè°ç¨æ­¤å½æ°ã

```
void ControlInfoChanged();
```

### <a name="remarks"></a>å¤æ³¨

æ¶å°æ­¤éç¥åï¼æ§ä»¶çå®¹å¨éè¿è°ç¨[IOleControlï¼ï¼ GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)è·åæ°çå©è®°é®éã è¯·æ³¨æï¼è¯¥å®¹å¨ä¸éè¦ååºæ­¤éç¥ã

##  <a name="displayerror"></a>COleControlï¼:D isplayError

å¨å¤ç stock éè¯¯äºä»¶ä¹åï¼ç±æ¡æ¶è°ç¨ï¼é¤éäºä»¶å¤çç¨åºå·²åæ¶æ¾ç¤ºéè¯¯ï¼ã

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>parameters

*scode*<br/>
è¦æ¥åçç¶æä»£ç å¼ã æå³å¯è½ä»£ç çå®æ´åè¡¨ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼é«çº§ä¸»é¢](../../mfc/mfc-activex-controls-advanced-topics.md)ã

*lpszDescription*<br/>
ææ¥åéè¯¯çè¯´æã

*lpszSource*<br/>
çæéè¯¯çæ¨¡åçåç§°ï¼éå¸¸æ¯ OLE æ§ä»¶æ¨¡åçåç§°ï¼ã

*lpszHelpFile*<br/>
åå«éè¯¯è¯´æçå¸®å©æä»¶çåç§°ã

*nHelpID*<br/>
ææ¥åéè¯¯çå¸®å©ä¸ä¸æ IDã

### <a name="remarks"></a>å¤æ³¨

é»è®¤è¡ä¸ºå°æ¾ç¤ºä¸ä¸ªæ¶æ¯æ¡ï¼å¶ä¸­åå«åå«å¨*lpszDescription*ä¸­çéè¯¯è¯´æã

éåæ­¤å½æ°ä»¥èªå®ä¹æ¾ç¤ºéè¯¯çæ¹å¼ã

##  <a name="doclick"></a>COleControlï¼:D oClick

æ¨¡ææ§ä»¶ä¸çé¼ æ åå»æä½ã

```
void DoClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶æ¯æï¼åå°è°ç¨å¯éåç `COleControl::OnClick` æåå½æ°ï¼å¹¶æ¿å stock Click äºä»¶ã

æ­¤å½æ°ä½ä¸ºå¸¸ç¨æ¹æ³ï¼ç§°ä¸º DoClickï¼ç± `COleControl` åºç±»æ¯æã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼æ¹æ³](../../mfc/mfc-activex-controls-methods.md)ä¸æã

##  <a name="dopropexchange"></a>COleControlï¼:D oPropExchange

å¨ä»æä¹å­å¨è¡¨ç¤ºå½¢å¼ï¼å¦æµæå±æ§éï¼å è½½æå­å¨æ§ä»¶æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
ä¸ä¸ªæå `CPropExchange` å¯¹è±¡çæéã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«å±æ§äº¤æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸ä¼è°ç¨**PX_** ç³»åå½æ°æ¥å è½½æå­å¨ OLE æ§ä»¶çç¹å®ç¨æ·å®ä¹å±æ§ã

å¦æå·²ä½¿ç¨ "æ§ä»¶åå¯¼" åå»º OLE æ§ä»¶é¡¹ç®ï¼åæ­¤å½æ°çéåçæ¬å°éè¿è°ç¨åºç±»å½æ°æ¥åºåå `COleControl` æ¯æçå¸¸ç¨å±æ§ï¼`COleControl::DoPropExchange`ã å°ç¨æ·å®ä¹å±æ§æ·»å å° OLE æ§ä»¶æ¶ï¼éè¦ä¿®æ¹æ­¤å½æ°ä»¥åºååæ°å±æ§ã æå³åºååçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼åºåå](../../mfc/mfc-activex-controls-serializing.md)ä¸æã

##  <a name="dosuperclasspaint"></a>COleControlï¼:D oSuperclassPaint

éç»å·²ä» Windows æ§ä»¶ä¸­äº§çå­ç±»ç OLE æ§ä»¶ã

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
æåæ§ä»¶å®¹å¨çè®¾å¤ä¸ä¸æçæéã

*rcBounds*<br/>
è¦å¨å¶ä¸­ç»å¶æ§ä»¶çåºåã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯æ­£ç¡®å¤çéæ´»å¨ OLE æ§ä»¶çç»å¶ã ä»å½ OLE æ§ä»¶å° Windows æ§ä»¶å­ç±»ï¼å¹¶åºå¨æ§ä»¶ç `OnDraw` å½æ°ä¸­è°ç¨æ­¤å½æ°æ¶ï¼æåºä½¿ç¨æ­¤å½æ°ã

æå³æ­¤å½æ°å Windows æ§ä»¶çå­ç±»çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¸º Windows æ§ä»¶æä¾å­ç±»ä¸](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)æã

##  <a name="drawcontent"></a>COleControlï¼:D rawContent

å½éè¦æ´æ°æ§ä»¶çå¤è§æ¶ç±æ¡æ¶è°ç¨ã

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
æåè®¾å¤ä¸ä¸æçæéã

*.rc*<br/>
è¦å¨å¶ä¸­ç»å¶çç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°ç´æ¥è°ç¨å¯éåç `OnDraw` å½æ°ã

##  <a name="drawmetafile"></a>COleControlï¼:D rawMetafile

å½ä½¿ç¨å¾åæä»¶è®¾å¤ä¸ä¸ææ¶ç±æ¡æ¶è°ç¨ã

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
æåå¾åæä»¶è®¾å¤ä¸ä¸æçæéã

*.rc*<br/>
è¦å¨å¶ä¸­ç»å¶çç©å½¢åºåã

##  <a name="enablesimpleframe"></a>COleControlï¼ï¼ EnableSimpleFrame

å¯ç¨ OLE æ§ä»¶çç®åæ¡æ¶ç¹æ§ã

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>å¤æ³¨

æ­¤ç¹æ§åè®¸æ§ä»¶æ¯æå¶ä»æ§ä»¶çå¯è§åå«ï¼ä½ä¸æ¯æçæ­£ç OLE åå®¹ã ä¾å¦ï¼åå«å¤ä¸ªæ§ä»¶çåç»æ¡ã è¿äºæ§ä»¶ä¸åå« OLEï¼ä½å®ä»¬ä½äºåä¸ä¸ªç»æ¡ä¸­ã

##  <a name="exchangeextent"></a>COleControlï¼ï¼ ExchangeExtent

åºååæåå§åæ§ä»¶çèå´ï¼å¶å¨ HIMETRIC ååä¸­çç»´åº¦ï¼çç¶æã

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
æå[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡çæéã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«å±æ§äº¤æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

### <a name="return-value"></a>è¿åå¼

å¦æå½æ°æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸ç± `COleControl::DoPropExchange`çé»è®¤å®ç°è°ç¨ã

##  <a name="exchangestockprops"></a>COleControlï¼ï¼ ExchangeStockProps

åºååæåå§åæ§ä»¶çå¸¸ç¨å±æ§çç¶æã

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
æå[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡çæéã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«å±æ§äº¤æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸ç± `COleControl::DoPropExchange`çé»è®¤å®ç°è°ç¨ã

##  <a name="exchangeversion"></a>COleControlï¼ï¼ ExchangeVersion

åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯çç¶æã

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>parameters

*pPX*<br/>
ä¸ä¸ªæå `CPropExchange` å¯¹è±¡çæéã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«å±æ§äº¤æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

*dwVersionDefault*<br/>
æ§ä»¶çå½åçæ¬å·ã

*bConvert*<br/>
æç¤ºæ°¸ä¹æ°æ®å¨ä¿å­æ¶æ¯å¦åºè½¬æ¢ä¸ºææ°æ ¼å¼ï¼æä¿æä¸ºä¸å è½½çæ ¼å¼ç¸åçæ ¼å¼ã

### <a name="return-value"></a>è¿åå¼

å½æ°çéé¶æå;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ï¼è¿å°æ¯ç±æ§ä»¶ç `COleControl::DoPropExchange`çéåè°ç¨çç¬¬ä¸ä¸ªå½æ°ã å è½½æ¶ï¼æ­¤å½æ°å°è¯»åæ°¸ä¹æ§æ°æ®ççæ¬å·ï¼å¹¶ç¸åºå°è®¾ç½®[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡ç version ç¹æ§ã ä¿å­æ¶ï¼æ­¤å½æ°å°åå¥æ°¸ä¹æ§æ°æ®ççæ¬å·ã

æå³æä¹æ§åçæ¬æ§å¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼åºåå](../../mfc/mfc-activex-controls-serializing.md)ä¸æã

##  <a name="fireclick"></a>COleControlï¼ï¼ FireClick

å½é¼ æ åå»æ´»å¨æ§ä»¶ä¸æ¶ç±æ¡æ¶è°ç¨ã

```
void FireClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦åç Click äºä»¶çèªå¨è§¦åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹äº stock Click äºä»¶ã

##  <a name="firedblclick"></a>COleControlï¼ï¼ FireDblClick

å½é¼ æ å¨æ´»å¨æ§ä»¶ä¸åå»æ¶ç±æ¡æ¶è°ç¨ã

```
void FireDblClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦åç DblClick äºä»¶çèªå¨è§¦åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹ä¸ä¸ª stock DblClick äºä»¶ã

##  <a name="fireerror"></a>COleControlï¼ï¼ FireError

æ¿å stock éè¯¯äºä»¶ã

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>parameters

*scode*<br/>
è¦æ¥åçç¶æä»£ç å¼ã æå³å¯è½ä»£ç çå®æ´åè¡¨ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼é«çº§ä¸»é¢](../../mfc/mfc-activex-controls-advanced-topics.md)ã

*lpszDescription*<br/>
ææ¥åéè¯¯çè¯´æã

*nHelpID*<br/>
ææ¥åéè¯¯çå¸®å© IDã

### <a name="remarks"></a>å¤æ³¨

æ­¤äºä»¶æä¾ä¸ç§å¨ä»£ç ä¸­çéå½ä½ç½®ï¼å¨æ§ä»¶ååçéè¯¯çæ¹å¼ã ä¸å¶ä»å¸¸ç¨äºä»¶ï¼å¦ Click æ MouseMoveï¼ä¸åï¼æ¡æ¶æ°¸è¿ä¸ä¼å¼åéè¯¯ã

è¥è¦æ¥åå¨å±æ§è·åå½æ°ãå±æ§éå½æ°æèªå¨åæ¹æ³æé´åççéè¯¯ï¼è¯·è°ç¨[COleControlï¼ï¼ ThrowError](#throwerror)ã

OLE æ§ä»¶ç Stock éè¯¯äºä»¶çå®ç°ä½¿ç¨ SCODE å¼ã å¦ææ§ä»¶ä½¿ç¨æ­¤äºä»¶ï¼å¹¶ä¸è¦å¨ Visual Basic 4.0 ä¸­ä½¿ç¨ï¼åå°æ¶å°éè¯¯ï¼å ä¸º Visual Basic ä¸æ¯æ SCODE å¼ã

è¥è¦è§£å³æ­¤é®é¢ï¼è¯·æå¨æ´æ¹æ§ä»¶çä¸­ç SCODE åæ°ãODL**æä»¶ã** æ­¤å¤ï¼ä½¿ç¨ SCODE åæ°çä»»ä½èªå®ä¹äºä»¶ãæ¹æ³æå±æ§ä¹ä¼å¯¼è´ç¸åçé®é¢ã

##  <a name="fireevent"></a>COleControlï¼ï¼ FireEvent

ä½¿ç¨ä»»ææ°éçå¯éåæ°ä»æ§ä»¶ä¸­è§¦åç¨æ·å®ä¹çäºä»¶ã

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
è¦æ¿åçäºä»¶çè°åº¦ IDã

*pbParams*<br/>
äºä»¶çåæ°ç±»åçæè¿°ç¬¦ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ä¸åºç´æ¥è°ç¨æ­¤å½æ°ã ç¸åï¼ä½ å°å¨æ§ä»¶çç±»å£°æçäºä»¶æ å°èä¸­è°ç¨äºä»¶è§¦åå½æ°ã

*PbParams*åæ°æ¯ä»¥ç©ºæ ¼åéç**VTS_** åè¡¨ã å¶ä¸­ä¸ä¸ªæå¤ä¸ªå¼ï¼ç±ç©ºæ ¼ï¼èä¸æ¯éå·ï¼åéï¼æå®å½æ°çåæ°åè¡¨ã å¯è½çå¼å¦ä¸æç¤ºï¼

|ç¬¦å·|åæ°ç±»å|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  å·²ä¸ºææåä½ç±»åå®ä¹äºå¶ä»åä½å¸¸éï¼VTS_FONT å VTS_PICTURE é¤å¤ï¼ï¼å®ä»¬æä¾æååéæ°æ®å¸¸éçæéã ä½¿ç¨**VTS_P**`constantname` çº¦å®æ¥å½åè¿äºå¸¸éã ä¾å¦ï¼VTS_PCOLOR æ¯æå VTS_COLOR å¸¸éçæéã

##  <a name="firekeydown"></a>COleControlï¼ï¼ FireKeyDown

å½æ§ä»¶å¤äºæ´»å¨ç¶ææ¶ï¼å½æä¸æä¸ªé®æ¶ç±æ¡æ¶è°ç¨ã

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>parameters

*pnChar*<br/>
æåæä¸é®çèæé®ä»£ç å¼çæéã æå³æ åèæé®ä»£ç çåè¡¨ï¼è¯·åé Winuserãh

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦åç KeyDown äºä»¶çèªå¨è§¦åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹æè¡ç¥¨ KeyDown äºä»¶ã

##  <a name="firekeypress"></a>COleControlï¼ï¼ FireKeyPress

å½æä¸æä¸ªé®æ¶ç±æ¡æ¶è°ç¨ï¼å½èªå®ä¹æ§ä»¶å¨å®¹å¨ä¸­å¤äºæ´»å¨ç¶ææ¶ï¼å°éæ¾è¯¥æ§ä»¶ã

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>parameters

*pnChar*<br/>
ä¸ä¸ªæéï¼æåæä¸çé®çå­ç¬¦å¼ã

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

ä¾å¦ï¼äºä»¶çæ¥æ¶æ¹å¯ä»¥ä¿®æ¹*pnChar*ï¼ä¾å¦ï¼å°ææå°åå­ç¬¦é½è½¬æ¢ä¸ºå¤§åã å¦æè¦æ£æ¥ä¿®æ¹åçå­ç¬¦ï¼è¯·è¦ç `OnKeyPressEvent`ã

è¥è¦åçæé®äºä»¶çèªå¨è§¦åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹äºä¸ä¸ª "stock æé®" äºä»¶ã

##  <a name="firekeyup"></a>COleControlï¼ï¼ FireKeyUp

å½èªå®ä¹æ§ä»¶å¨å®¹å¨ä¸­å¤äºæ´»å¨ç¶ææ¶ï¼å½éæ¾æä¸ªé®æ¶ç±æ¡æ¶è°ç¨ã

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>parameters

*pnChar*<br/>
æåå·²éæ¾å¯é¥çèæé®ä»£ç å¼çæéã æå³æ åèæé®ä»£ç çåè¡¨ï¼è¯·åé Winuserãh

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦åç KeyUp äºä»¶çèªå¨æ¿åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹ä¸ä¸ª stock KeyUp äºä»¶ã

##  <a name="firemousedown"></a>COleControlï¼ï¼ FireMouseDown

å½å¨æ´»å¨èªå®ä¹æ§ä»¶ä¸æä¸é¼ æ æé®æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>parameters

*nButton*<br/>
æä¸é¼ æ æé®çæ°å¼ã å®å¯ä»¥åå«ä»¥ä¸å¼ä¹ä¸ï¼

- LEFT_BUTTON æä¸é¼ æ å·¦é®ã

- MIDDLE_BUTTON æä¸é¼ æ ä¸­é®ã

- RIGHT_BUTTON æä¸é¼ æ å³é®ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

*x*<br/>
æä¸é¼ æ æé®æ¶åæ ç x åæ ã è¯¥åæ ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

*y*<br/>
æä¸é¼ æ æé®æ¶åæ ç y åæ ã è¯¥åæ ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦ä½¿ MouseDown äºä»¶èªå¨è§¦ååçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·²å®ä¹äºä¸ä¸ª stock MouseDown äºä»¶ã

##  <a name="firemousemove"></a>COleControlï¼ï¼ FireMouseMove

å½åæ ç§»å°æ´»å¨çèªå®ä¹æ§ä»¶ä¸æ¶ç±æ¡æ¶è°ç¨ã

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>parameters

*nButton*<br/>
æä¸é¼ æ æé®çæ°å¼ã åå«ä»¥ä¸å¼çç»åï¼

- LEFT_BUTTON å¨æä½è¿ç¨ä¸­æä¸é¼ æ å·¦é®ã

- MIDDLE_BUTTON æä½æé´ï¼æä¸é¼ æ ä¸­é®ã

- å¨æä½è¿ç¨ä¸­ï¼RIGHT_BUTTON æä¸é¼ æ å³é®ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

*x*<br/>
åæ ç x åæ ã è¯¥åæ ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

*y*<br/>
åæ ç y åæ ã è¯¥åæ ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦åç MouseMove äºä»¶çèªå¨è§¦åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹ä¸ä¸ª stock MouseMove äºä»¶ã

##  <a name="firemouseup"></a>COleControlï¼ï¼ FireMouseUp

å½éè¿æ´»å¨èªå®ä¹æ§ä»¶éæ¾é¼ æ æé®æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>parameters

*nButton*<br/>
å·²éæ¾çé¼ æ æé®çæ°å¼ã å®å¯ä»¥å·æä¸åå¼ä¹ä¸ï¼

- LEFT_BUTTON éæ¾é¼ æ å·¦é®ã

- MIDDLE_BUTTON æ¾å¼é¼ æ ä¸­é®ã

- å·²éæ¾é¼ æ å³é® RIGHT_BUTTONã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

*x*<br/>
éæ¾é¼ æ æé®æ¶åæ ç x åæ ã è¯¥åæ ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

*y*<br/>
éæ¾é¼ æ æé®æ¶åæ ç y åæ ã è¯¥åæ ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦æå°æ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åéè¦ç¡®å®äºä»¶çæ¿åæ¶é´ã

è¥è¦åç MouseUp äºä»¶çèªå¨æ¿åï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·²å®ä¹äº stock MouseUp äºä»¶ã

##  <a name="firereadystatechange"></a>COleControlï¼ï¼ FireReadyStateChange

ä½¿ç¨æ§ä»¶ç "å°±ç»ª" ç¶æçå½åå¼æ¿åä¸ä¸ªäºä»¶ã

```
void FireReadyStateChange();
```

### <a name="remarks"></a>å¤æ³¨

å°±ç»ªç¶æå¯ä»¥ä¸ºä¸åå¼ä¹ä¸ï¼

|||
|-|-|
|READYSTATE_UNINITIALIZED|é»è®¤åå§åç¶æ|
|READYSTATE_LOADING|æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§|
|READYSTATE_LOADED|æ§ä»¶å·²åå§å|
|READYSTATE_INTERACTIVE|æ§ä»¶å·æè¶³å¤çæ°æ®ä»¥è¿è¡äº¤äºï¼ä½å¹¶ä¸æ¯ææçå¼æ­¥æ°æ®é½å·²å è½½|
|READYSTATE_COMPLETE|æ§ä»¶çæææ°æ®|

ä½¿ç¨[GetReadyState](#getreadystate)ç¡®å®æ§ä»¶å½åçåå¤æåµã

[InternalSetReadyState](#internalsetreadystate)å° "å°±ç»ª" ç¶ææ´æ¹ä¸ºæä¾çå¼ï¼ç¶åè°ç¨ `FireReadyStateChange`ã

##  <a name="getactivationpolicy"></a>COleControlï¼ï¼ GetActivationPolicy

æ´æ¹æ¯æ `IPointerInactive` æ¥å£çæ§ä»¶çé»è®¤æ¿æ´»è¡ä¸ºã

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>è¿åå¼

POINTERINACTIVE æä¸¾ä¸­çæ å¿çç»åã å¯è½çæ å¿åæ¬ï¼

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|å½é¼ æ å¨é¼ æ ç§»å¨æä½è¿ç¨ä¸­è¾å¥å¯¹è±¡æ¶ï¼è¯¥å¯¹è±¡åºå°±å°æ¿æ´»ã|
|POINTERINACTIVE_DEACTIVATEONLEAVE|å½é¼ æ ç§»å¨æä½è¿ç¨ä¸­é¼ æ ç¦»å¼å¯¹è±¡æ¶ï¼åºåç¨å¯¹è±¡ã|
|POINTERINACTIVE_ACTIVATEONDRAG|å½å¨ææ¾æä½è¿ç¨ä¸­å°é¼ æ æå¨å°å¯¹è±¡ä¸æ¶ï¼åºå°±å°æ¿æ´»å¯¹è±¡ã|

### <a name="remarks"></a>å¤æ³¨

å¯ç¨ `IPointerInactive` æ¥å£æ¶ï¼å®¹å¨ä¼å° WM_SETCURSOR å WM_MOUSEMOVE æ¶æ¯å§æç»å®ã å½è°æ´é¼ æ åæ åï¼æ­¤æ¥å£ `COleControl`çå®ç°å°éè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦è¿äºæ¶æ¯ã

æ¯å½å®¹å¨æ¥æ¶å° WM_SETCURSOR æ WM_MOUSEMOVE æ¶æ¯ï¼å¹¶å°é¼ æ æéæ¬åå¨æ¯æ `IPointerInactive`çéæ´»å¨å¯¹è±¡ä¸æ¶ï¼å®åºè°ç¨æ¥å£ä¸ç `GetActivationPolicy`ï¼å¹¶ä» POINTERINACTIVE æä¸¾è¿åæ å¿ã

æ¨å¯ä»¥éè¿å°ç¸åºæ¡ç®æ·»å å°æ¶æ¯æ å°æ¥å¤çè¿äºæ¶æ¯ï¼å°±åæ®éççªå£æ¶æ¯ä¸æ ·ã å¨å¤çç¨åºä¸­ï¼é¿åå¨ä¸äºåæ£æ¥å¶å¼æ¯å¦ä¸ºé NULL çæåµä¸ä½¿ç¨ `m_hWnd` æååéï¼æä½¿ç¨è¯¥åéçä»»ä½æåå½æ°ï¼ã

é¤è®¾ç½®é¼ æ åæ å/ææ¿åé¼ æ ç§»å¨äºä»¶ï¼ä¾å¦æä¾ç¹æ®çè§è§åé¦ï¼ä»¥å¤çä»»ä½å¯¹è±¡é½åºè¿å POINTERINACTIVE_ACTIVATEONENTRY æ å¿å¹¶ä»å¨æ´»å¨æ¶æç»å¶åé¦ã å¦æå¯¹è±¡è¿åæ­¤æ å¿ï¼åå®¹å¨åºç«å³å°å¶æ¿æ´»ï¼ç¶åå°å¶è½¬åå°è§¦åè°ç¨ `GetActivationPolicy`çåä¸æ¶æ¯ã

å¦æåæ¶è¿å POINTERINACTIVE_ACTIVATEONENTRY å POINTERINACTIVE_DEACTIVATEONLEAVE æ å¿ï¼ååªæå½é¼ æ ä½äºå¯¹è±¡ä¸æ¶ï¼æä¼æ¿æ´»å¯¹è±¡ã å¦æåªè¿å POINTERINACTIVE_ACTIVATEONENTRY æ å¿ï¼åä»å½é¼ æ ç¬¬ä¸æ¬¡è¿å¥å¯¹è±¡æ¶ï¼æä¼æ¿æ´»è¯¥å¯¹è±¡ä¸æ¬¡ã

æ¨è¿å¯è½å¸æå°éæ´»å¨æ§ä»¶ä½ä¸º OLE ææ¾æä½çç®æ ã è¿éè¦å¨ç¨æ·å°å¯¹è±¡æå°æ§ä»¶ä¸æ¶æ¿æ´»æ§ä»¶ï¼ä½¿æ§ä»¶ççªå£å¯ä»¥æ³¨åä¸ºææ¾ç®æ ã è¥è¦å¯¼è´å¨æå¨è¿ç¨ä¸­åçæ¿æ´»ï¼è¯·è¿å POINTERINACTIVE_ACTIVATEONDRAG æ å¿ï¼

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

`GetActivationPolicy` éä¿¡çä¿¡æ¯ä¸åºç±å®¹å¨ç¼å­ã ç¸åï¼æ¯æ¬¡é¼ æ è¿å¥éæ´»å¨å¯¹è±¡æ¶ï¼é½åºè°ç¨æ­¤æ¹æ³ã

å¦æéæ´»å¨å¯¹è±¡å¨é¼ æ è¿å¥è¯¥å¯¹è±¡æ¶æªè¯·æ±å°±å°æ¿æ´»ï¼ååªè¦é¼ æ æéåçå¨è¯¥å¯¹è±¡ä¸ï¼å®çå®¹å¨å°±ä¼éè¿è°ç¨[OnInactiveSetCursor](#oninactivesetcursor)å°åç»­ WM_SETCURSOR æ¶æ¯è°åº¦å°æ­¤å¯¹è±¡ã

å¯ç¨ `IPointerInactive` æ¥å£éå¸¸æå³çå¸ææ§ä»¶å§ç»è½å¤å¤çé¼ æ æ¶æ¯ã è¥è¦å¨ä¸æ¯æ `IPointerInactive` æ¥å£çå®¹å¨ä¸­è·åæ­¤è¡ä¸ºï¼ä½ å°éè¦å¨å¯è§æ¶å§ç»æ¿æ´»æ§ä»¶ï¼è¿æå³çæ§ä»¶åºå¨å¶æé¡¹æ å¿ä¸­å·æ OLEMISC_ACTIVATEWHENVISIBLE æ å¿ã ä½æ¯ï¼è¥è¦é²æ­¢æ­¤æ å¿å¨æ¯æ `IPointerInactive`çå®¹å¨ä¸­çæï¼è¿å¯ä»¥æå® OLEMISC_IGNOREACTIVATEWHENVISIBLE æ å¿ï¼

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>COleControlï¼ï¼ GetAmbientProperty

è·åå®¹å¨çç¯å¢å±æ§çå¼ã

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>parameters

*dwDispid*<br/>
æéç¯å¢å±æ§çè°åº¦ IDã

*vtProp*<br/>
ä¸ä¸ªåéç±»åæ è®°ï¼å®æå®è¦å¨*pvProp*ä¸­è¿åçå¼çç±»åã

*pvProp*<br/>
ä¸ä¸ªæéï¼æåå°æ¥æ¶å±æ§å¼æè¿åå¼çåéçå°åã æ­¤æéçå®éç±»åå¿é¡»ä¸*vtProp*æå®çç±»åå¹éã

|vtProp|PvProp çç±»å|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>è¿åå¼

å¦ææ¯æç¯å¢å±æ§ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å¦æä½¿ç¨ `GetAmbientProperty` æ£ç´¢ç¯å¢ DisplayName å ScaleUnits å±æ§ï¼è¯·å°*vtProp*è®¾ç½®ä¸º "`CString*`" VT_BSTR å " *pvProp* "ã å¦æè¦æ£ç´¢ç¯å¢å­ä½å±æ§ï¼è¯·å°*vtProp*è®¾ç½®ä¸º VT_FONTï¼å¹¶å°*PVPROP*è®¾ç½®ä¸º LPFONTDISP *ã

è¯·æ³¨æï¼å·²ä¸ºå¸¸è§ç¯å¢å±æ§ï¼å¦[AmbientBackColor](#ambientbackcolor)å[AmbientFont](#ambientfont)ï¼æä¾å½æ°ã

##  <a name="getappearance"></a>COleControlï¼ï¼ GetAppearance

å®ç°æ§ä»¶ç stock å¤è§å±æ§ç Get å½æ°ã

```
short GetAppearance ();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åè¿åå¼å°å½åå¤è§è®¾ç½®æå®ä¸º**short** ï¼VT_I2ï¼å¼ã å¦ææ§ä»¶çå¤è§ä¸ºå¹³é¢ï¼åæ­¤å¼ä¸ºé¶; å¦ææ§ä»¶çå¤è§ä¸ºä¸ç»´ï¼åä¸º1ã

##  <a name="getbackcolor"></a>COleControlï¼ï¼ GetBackColor

å®ç°æ§ä»¶çå¸¸ç¨èæ¯è²å±æ§ç Get å½æ°ã

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åè¿åå¼æå®å½åèæ¯è²ä½ä¸º OLE_COLOR å¼ã å¯ä»¥éè¿è°ç¨ `TranslateColor`å°æ­¤å¼è½¬æ¢ä¸º COLORREF å¼ã

##  <a name="getborderstyle"></a>COleControlï¼ï¼ GetBorderStyle

å®ç°æ§ä»¶ç stock BorderStyle å±æ§ç Get å½æ°ã

```
short GetBorderStyle();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·ææ®éè¾¹æ¡ï¼åä¸º 1; å¦åä¸ºãå¦ææ§ä»¶æ²¡æè¾¹æ¡ï¼åä¸º0ã

##  <a name="getcapture"></a>COleControlï¼ï¼ GetCapture

ç¡®å® `COleControl` å¯¹è±¡æ¯å¦å·æé¼ æ æè·ã

```
CWnd* GetCapture();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·²æ¿æ´»ä¸æ çªå£ï¼åå¨æ§ä»¶å½åå·æé¼ æ æè·ï¼ç±æ§ä»¶çå®¹å¨ç¡®å®ï¼**æ¶è¿åï¼** å¦æè¯¥æ§ä»¶æ²¡ææè·ï¼åè¿å NULLã

å¦åï¼å°è¿åå·æé¼ æ æè·ç `CWnd` å¯¹è±¡ï¼ç­åäº `CWnd::GetCapture`ï¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨[SetCapture](#setcapture)æ¶ï¼æ¿æ´»çæ çªå£æ§ä»¶æ¥æ¶é¼ æ æè·ã

##  <a name="getclassid"></a>COleControlï¼ï¼ GetClassID

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æ§ä»¶ç OLE ç±» IDã

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>parameters

*pclsid*<br/>
æåç±» ID ä½ç½®çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨ä¸æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ç±[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)å®ç°ã

##  <a name="getclientoffset"></a>COleControlï¼ï¼ GetClientOffset

æ£ç´¢æ§ä»¶çç©å½¢åºåçå·¦ä¸è§ä¸å¶å·¥ä½åºå·¦ä¸è§ä¹é´çå·®å¼ã

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>parameters

*pdxOffset*<br/>
æå OLE æ§ä»¶çå·¥ä½åºçæ°´å¹³åç§»éçæéã

*pdyOffset*<br/>
æå OLE æ§ä»¶çå·¥ä½åºçåç´åç§»éçæéã

### <a name="remarks"></a>å¤æ³¨

OLE æ§ä»¶çå®¹å¨åæä¸ä¸ªç©å½¢åºåã æ§ä»¶çå·¥ä½åºæ¯ä¸åæ¬è¾¹æ¡åæ»å¨æ¡çæ§ä»¶åºåã `GetClientOffset` æ£ç´¢çåç§»éæ¯æ§ä»¶çç©å½¢åºåçå·¦ä¸è§åå¶å·¥ä½åºå·¦ä¸è§ä¹é´çå·®å¼ã å¦ææ§ä»¶å·ææ åè¾¹æ¡åæ»å¨æ¡ä»¥å¤çéå®¢æ·ç«¯åç´ ï¼è¯·éåæ­¤æåå½æ°ä»¥æå®åç§»éã

##  <a name="getclientrect"></a>COleControlï¼ï¼ GetClientRect

æ£ç´¢æ§ä»¶çå·¥ä½åºçå¤§å°ã

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
æå `RECT` ç»æçæéï¼è¯¥ç»æåå«æ çªå£æ§ä»¶çå·¥ä½åºçå°ºå¯¸;ä¹å°±æ¯è¯´ï¼æ§ä»¶çå¤§å°åå»çªå£è¾¹æ¡ãæ¡æ¶ãæ»å¨æ¡ç­ã *LpRect*åæ°æç¤ºæ§ä»¶çå®¢æ·ç«¯ç©å½¢çå¤§å°ï¼èä¸æ¯å¶ä½ç½®ã

##  <a name="getclientsite"></a>COleControlï¼ï¼ GetClientSite

æ¥è¯¢å¯¹è±¡ï¼ä»¥ä¾¿æéæåå¶å®¹å¨ä¸­çå½åå®¢æ·ç«¯ç«ç¹ã

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>è¿åå¼

æåæ§ä»¶çå®¹å¨ä¸­çå½åå®¢æ·ç«¯ç«ç¹çæéã

### <a name="remarks"></a>å¤æ³¨

è¿åçæéæå `IOleClientSite`çå®ä¾ã `IOleClientSite` æ¥å£ç±å®¹å¨å®ç°ï¼å®æ¯å¯¹è±¡ä¸ä¸æçè§å¾ï¼å®å¨ææ¡£ä¸­çå®ä½ä½ç½®ï¼å¶ä¸­è·åå¶å­å¨ãç¨æ·çé¢åå¶ä»èµæºã

##  <a name="getcontrolflags"></a>COleControlï¼ï¼ GetControlFlags

æ£ç´¢æ§ä»¶æ å¿è®¾ç½®ã

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>è¿åå¼

ControlFlags æä¸¾ä¸­æ å¿çè¿ç®ç»åï¼

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸ï¼`GetControlFlags` è¿å `fastBeginPaint | clipPaintDC`ã

|||
|-|-|
|`fastBeginPaint`|å¦æè®¾ç½®ï¼åä½¿ç¨ä¸º OLE æ§ä»¶èä¸æ¯[BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API å®å¶ç begin ç»å¾å½æ°ï¼é»è®¤è®¾ç½®ï¼ã|
|`clipPaintDC`|å¦ææªè®¾ç½®ï¼åç¦ç¨å¯¹ `COleControl` æå `IntersectClipRect` çè°ç¨ï¼å¹¶è·å¾è¾å°çéåº¦ä¼å¿ã å¦æä½¿ç¨æ çªå£æ¿æ´»ï¼æ å¿å°ä¸èµ·ä½ç¨ã|
|`pointerInactive`|å¦æè®¾ç½®ï¼åéè¿å¯ç¨ `COleControl`ç `IPointerInactive` æ¥å£å®ç°ï¼é»è®¤æåµä¸å·²ç¦ç¨ï¼ï¼æä¾é¼ æ äº¤äºï¼åæ¶æ§ä»¶å¤äºéæ´»å¨ç¶æã|
|`noFlickerActivate`|å¦æè®¾ç½®ï¼åæ¶é¤é¢å¤çç»å¾æä½åä¼´éçè§è§éªçã å½æ§ä»¶å¨éæ´»å¨ç¶æåæ´»å¨ç¶æä¸­ä»¥ç¸åæ¹å¼ç»å¶èªèº«æ¶ä½¿ç¨ã å¦æä½¿ç¨æ çªå£æ¿æ´»ï¼æ å¿å°ä¸èµ·ä½ç¨ã|
|`windowlessActivate`|å¦æè®¾ç½®ï¼åæç¤ºæ§ä»¶ä½¿ç¨æ çªå£æ¿æ´»ã|
|`canOptimizeDraw`|å¦æè®¾ç½®ï¼åæç¤ºæ§ä»¶å°æ§è¡ä¼åçç»å¾ï¼å¦æå®¹å¨æ¯æï¼ã|

æå³ `GetControlFlags` å OLE æ§ä»¶çå¶ä»ä¼åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="getcontrolsize"></a>COleControlï¼ï¼ GetControlSize

æ£ç´¢ OLE æ§ä»¶çªå£çå¤§å°ã

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>parameters

*pcx*<br/>
æå®æ§ä»¶çå®½åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

*pcy*<br/>
æå®æ§ä»¶çé«åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ§ä»¶çªå£çææåæ é½æ¯ç¸å¯¹äºæ§ä»¶çå·¦ä¸è§çã

##  <a name="getdc"></a>COleControlï¼ï¼ GetDC

ä¸ºæ çªå£å¯¹è±¡æä¾ä»å¶å®¹å¨è·åå±å¹ï¼æå¼å®¹ï¼çè®¾å¤ä¸ä¸æã

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>parameters

*lprcRect*<br/>
ä¸ä¸ªæéï¼æåæ çªå£æ§ä»¶è¦å¨æ§ä»¶çå·¥ä½åºåæ ä¸­éç»çç©å½¢ã NULL è¡¨ç¤ºå®å¨å¯¹è±¡çèå´ã

dwFlags<br/>
è®¾å¤ä¸ä¸æçç»å¶å±æ§ã éé¡¹åæ¬ï¼

- OLEDC_NODRAW æç¤ºå¯¹è±¡ä¸ä½¿ç¨è®¾å¤ä¸ä¸ææ¥æ§è¡ä»»ä½ç»å¶ï¼èåªæ¯è·åæå³æ¾ç¤ºè®¾å¤çä¿¡æ¯ã å®¹å¨åºè¯¥åªä¼ éçªå£ç DCï¼æ éè¿ä¸æ­¥å¤çã

- OLEDC_PAINTBKGND è¯·æ±å®¹å¨å¨è¿å DC ä¹åç»å¶èæ¯ã å¦æå¯¹è±¡æ­£å¨è¯·æ± DC æ¥éç»å¸¦æéæèæ¯çåºåï¼ååºä½¿ç¨æ­¤æ å¿ã

- OLEDC_OFFSCREEN éç¥å®¹å¨ï¼å¯¹è±¡è¦åç°å°å±å¹å¤ä½å¾ï¼éååºå°è¯¥ä½å¾å¤å¶å°å±å¹ä¸ã å½å¯¹è±¡è¦æ§è¡çç»å¾æä½çæå¾å¤éªçæ¶ï¼å¯¹è±¡åºä½¿ç¨æ­¤æ å¿ã å®¹å¨å¯éææ¥åæ­¤è¯·æ±ã ä½æ¯ï¼å¦ææªè®¾ç½®æ­¤æ å¿ï¼åå®¹å¨å¿é¡»æå¨ååå±å¹ DCã è¿åè®¸å¯¹è±¡æ§è¡ç´æ¥å±å¹æä½ï¼ä¾å¦æ¾ç¤ºéå®åå®¹ï¼éè¿**XOR**æä½ï¼ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ºæåå®¹å¨ `CWnd` å®¢æ·ç«¯åºåçæ¾ç¤ºè®¾å¤ä¸ä¸æçæé;å¦åï¼è¿åå¼ä¸º NULLã æ¾ç¤ºè®¾å¤ä¸ä¸æå¯ä»¥å¨åç»­ç GDI å½æ°ä¸­ç¨äºå¨å®¹å¨ççªå£çå·¥ä½åºä¸­è¿è¡ç»å¶ã

### <a name="remarks"></a>å¤æ³¨

å¿é¡»è°ç¨[ReleaseDC](#releasedc)æåå½æ°ï¼ä»¥ä¾¿å¨ç»å¶åéæ¾ä¸ä¸æã è°ç¨ `GetDC`æ¶ï¼å¯¹è±¡ä¼å°å¶è¦ç»å¶çç©å½¢ä¼ éå°èªå·±çå®¢æ·ç«¯åæ ä¸­ã `GetDC` å°å®ä»¬è½¬æ¢ä¸ºå®¹å¨å·¥ä½åºçåæ ã å¯¹è±¡ä¸åºè¯·æ±å¤§äºå¶èªå·±çå·¥ä½åºç©å½¢çæéç»å¶ç©å½¢ï¼å¶å¤§å°å¯ä»¥ä½¿ç¨[GetClientRect](#getclientrect)æ£ç´¢ã è¿å¯é²æ­¢å¯¹è±¡æ æä¸­ç»å¶ä¸åºåºç°çä½ç½®ã

##  <a name="getenabled"></a>COleControlï¼ï¼ GetEnabled

å®ç°æ§ä»¶çå¯ç¨äºåºå­çå±æ§ç Get å½æ°ã

```
BOOL GetEnabled();
```

### <a name="return-value"></a>è¿åå¼

å¦æå¯ç¨æ§ä»¶ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

##  <a name="getextendedcontrol"></a>COleControlï¼ï¼ GetExtendedControl

è·åä¸ä¸ªæéï¼è¯¥æéæåç±è¡¨ç¤ºå·æä¸ç»æ©å±å±æ§çæ§ä»¶çå®¹å¨ç»´æ¤çå¯¹è±¡ã

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>è¿åå¼

æåå®¹å¨çæ©å±æ§ä»¶å¯¹è±¡çæéã å¦ææ²¡æå¯ç¨çå¯¹è±¡ï¼åè¯¥å¼ä¸º NULLã

æ­¤å¯¹è±¡å¯éè¿å¶ `IDispatch` æ¥å£è¿è¡æä½ã ä½ è¿å¯ä»¥ä½¿ç¨ `QueryInterface` è·åç±å¯¹è±¡æä¾çå¶ä»å¯ç¨æ¥å£ã ä½æ¯ï¼è¯¥å¯¹è±¡ä¸æ¯æ¯æä¸ç»ç¹å®æ¥å£æå¿éçã è¯·æ³¨æï¼ä¾èµå®¹å¨æ©å±æ§ä»¶å¯¹è±¡çç¹å®åè½å¯å°æ§ä»¶çå¯ç§»æ¤æ§éå¶ä¸ºå¶ä»ä»»æå®¹å¨ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°çå½æ°è´è´£å¨å¯¹è±¡ç»ææ¶éæ¾æéã è¯·æ³¨æï¼å®¹å¨ä¸éè¦æ¯ææ­¤å¯¹è±¡ã

##  <a name="getfocus"></a>COleControlï¼ï¼ GetFocus

ç¡®å® `COleControl` å¯¹è±¡æ¯å¦å·æç¦ç¹ã

```
CWnd* GetFocus();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·²æ¿æ´»ä¸æ çªå£ï¼åå¨æ§ä»¶å½åå·æé®çç¦ç¹æ¶ï¼ç±æ§ä»¶çå®¹å¨ç¡®å® **ï¼è¿åï¼** å¦æè¯¥æ§ä»¶æ²¡æç¦ç¹ï¼åè¿å NULLã

å¦åï¼å°è¿åå·æç¦ç¹ç `CWnd` å¯¹è±¡ï¼ç­åäº `CWnd::GetFocus`ï¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨[SetFocus](#setfocus)æ¶ï¼æ¿æ´»çæ çªå£æ§ä»¶æ¥æ¶ç¦ç¹ã

##  <a name="getfont"></a>COleControlï¼ï¼ Ivsfontandcolorstorage.getfont éè¯¯

å®ç°å¸¸ç¨å­ä½å±æ§ç Get å½æ°ã

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>è¿åå¼

æåæ§ä»¶çå¸¸ç¨å­ä½å±æ§çå­ä½è°åº¦æ¥å£çæéã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼å¨å®æåï¼è°ç¨æ¹å¿é¡»éæ¾å¯¹è±¡ã å¨æ§ä»¶çå®ç°ä¸­ï¼ä½¿ç¨ `InternalGetFont` è®¿é®æ§ä»¶çå¸¸ç¨å­ä½å¯¹è±¡ã æå³å¨æ§ä»¶ä¸­ä½¿ç¨å­ä½çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[Activex æ§ä»¶ï¼å¨ Activex æ§ä»¶ä¸­ä½¿ç¨å­ä½ä¸](../../mfc/mfc-activex-controls-using-fonts.md)æã

##  <a name="getfonttextmetrics"></a>COleControlï¼ï¼ GetFontTextMetrics

åº¦éæ§ä»¶ææ¥æçä»»ä½ `CFontHolder` å¯¹è±¡çææ¬ææ ã

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>parameters

*lptm*<br/>
æå[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)ç»æçæéã

*fontHolder*<br/>
å¯¹[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡çå¼ç¨ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥ä½¿ç¨[COleControlï¼ï¼ SelectFontObject](#selectfontobject)å½æ°éæ©æ­¤ç±»å­ä½ã å¦ææåï¼`GetFontTextMetrics` ä¼å°*lptm*ææåç `TEXTMETRIC` ç»æåå§åä¸ºåå« `fontHolder`å­ä½çææææ ä¿¡æ¯; å¦æä¸æåï¼åç¨é¶å¡«åç»æã ç»å¶æ§ä»¶æ¶ï¼åºä½¿ç¨æ­¤å½æ°ï¼èä¸æ¯[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ï¼å ä¸ºæ§ä»¶ï¼å¦ä»»ä½åµå¥ç OLE å¯¹è±¡ï¼å¯è½éè¦å°å¶åç°å°å¾åæä»¶ä¸­ã

è°ç¨[SelectFontObject](#selectfontobject)å½æ°æ¶ï¼å°å·æ°é»è®¤å­ä½ç `TEXTMETRIC` ç»æã åªåºå¨éæ© "å¸¸ç¨å­ä½" å±æ§åè°ç¨ `GetFontTextMetrics`ï¼ä»¥ç¡®ä¿å®æä¾çä¿¡æ¯ææã

##  <a name="getforecolor"></a>COleControlï¼ï¼ GetForeColor

å®ç° stock åæ¯è²å±æ§ç Get å½æ°ã

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åè¿åå¼æå®å½ååæ¯è²ä½ä¸º OLE_COLOR å¼ã å¯ä»¥éè¿è°ç¨ `TranslateColor`å°æ­¤å¼è½¬æ¢ä¸º[COLORREF](/windows/win32/gdi/colorref)å¼ã

##  <a name="gethwnd"></a>COleControlï¼ï¼ GetHwnd

å®ç° stock hWnd å±æ§ç Get å½æ°ã

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>è¿åå¼

OLE æ§ä»¶ççªå£å¥æï¼å¦ææï¼;å¦åä¸º NULLã

##  <a name="getmessagestring"></a>COleControlï¼ï¼ GetMessageString

ç±æ¡æ¶è°ç¨ï¼ä»¥è·åæè¿°*nID*æ è¯çèåé¡¹çç¨éçç®ç­å­ç¬¦ä¸²ã

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>parameters

*nID*<br/>
èåé¡¹ IDã

*rMessage*<br/>
å¯¹[CString](../../atl-mfc-shared/reference/cstringt-class.md)å¯¹è±¡çå¼ç¨ï¼éè¿è¯¥å¯¹è±¡ï¼å°è¿åä¸ä¸ªå­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

è¿å¯ç¨äºå¨çªåºæ¾ç¤ºèåé¡¹æ¶ï¼è·åæ¾ç¤ºå¨ç¶ææ ä¸­çæ¶æ¯ã é»è®¤å®ç°å°è¯å è½½*nID*æ è¯çå­ç¬¦ä¸²èµæºã

##  <a name="getnotsupported"></a>COleControlï¼ï¼ GetNotSupported

ç¦æ­¢ç¨æ·è®¿é®æ§ä»¶çå±æ§å¼ã

```
void GetNotSupported();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»£æ¿ä»»ä½å±æ§ç Get å½æ°ï¼èæ§ä»¶çç¨æ·ä¸æ¯æå¯¹å¶è¿è¡å±æ§æ£ç´¢ã ä¸ä¸ªç¤ºä¾æ¯åªåçå±æ§ã

##  <a name="getreadystate"></a>COleControlï¼ï¼ GetReadyState

è¿åæ§ä»¶çå°±ç»ªç¶æã

```
long GetReadyState();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çå°±ç»ªç¶æï¼ä¸ºä»¥ä¸å¼ä¹ä¸ï¼

|||
|-|-|
|READYSTATE_UNINITIALIZED|é»è®¤åå§åç¶æ|
|READYSTATE_LOADING|æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§|
|READYSTATE_LOADED|æ§ä»¶å·²åå§å|
|READYSTATE_INTERACTIVE|æ§ä»¶å·æè¶³å¤çæ°æ®ä»¥è¿è¡äº¤äºï¼ä½å¹¶ä¸æ¯ææçå¼æ­¥æ°æ®é½å·²å è½½|
|READYSTATE_COMPLETE|æ§ä»¶çæææ°æ®|

### <a name="remarks"></a>å¤æ³¨

å¤§å¤æ°ç®åæ§ä»¶é½ä¸éè¦åºåå·²å è½½åäº¤äºå¼ã ä½æ¯ï¼å¨è³å°å¼æ­¥æ¥æ¶æäºæ°æ®ä¹åï¼æ¯ææ°æ®è·¯å¾å±æ§çæ§ä»¶å¯è½å°æªåå¤å¥½è¿è¡äº¤äºã æ§ä»¶ä¼å°è¯å°½å¿«æä¸ºäº¤äºæ§ä»¶ã

##  <a name="getrectincontainer"></a>COleControlï¼ï¼ GetRectInContainer

è·åæ§ä»¶çç©å½¢ç¸å¯¹äºå®¹å¨çåæ ï¼ä»¥è®¾å¤åä½è¡¨ç¤ºã

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
ä¸ä¸ªæéï¼æåå°åå¶ä¸­å¤å¶æ§ä»¶åæ çç©å½¢ç»æã

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å¤äºå°±å°æ´»å¨ç¶æï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

ä»å½æ§ä»¶å¤äºå°±å°æ´»å¨ç¶ææ¶ï¼ç©å½¢æææã

##  <a name="getstocktextmetrics"></a>COleControlï¼ï¼ GetStockTextMetrics

åº¦éæ§ä»¶çå¸¸ç¨å­ä½å±æ§çææ¬åº¦éå¼ï¼å¯éè¿[SelectStockFont](#selectstockfont)å½æ°è¿è¡éæ©ã

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>parameters

*lptm*<br/>
æå[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)ç»æçæéã

### <a name="remarks"></a>å¤æ³¨

å¦ææåï¼å `GetStockTextMetrics` å½æ°å°åå§å*lptm*ææåç `TEXTMETRIC` ç»æï¼å¦ææåï¼åç¨é¶å¡«åç»æ; å¦æä¸æåï¼åç¨é¶å¡«åç»æã å¨ç»å¶æ§ä»¶æ¶ä½¿ç¨æ­¤å½æ°ï¼èä¸æ¯[GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) ï¼å ä¸ºæ§ä»¶ï¼å¦ä»»ä½åµå¥ç OLE å¯¹è±¡ï¼å¯è½éè¦å°å¶åç°å°å¾åæä»¶ä¸­ã

è°ç¨ `SelectStockFont` å½æ°æ¶ï¼å°å·æ°é»è®¤å­ä½ç `TEXTMETRIC` ç»æã ä»å¨éæ©äºå¸¸ç¨å­ä½åï¼æåºè°ç¨æ­¤å½æ°ï¼ä»¥ç¡®ä¿å®æä¾çä¿¡æ¯ææã

##  <a name="gettext"></a>COleControlï¼ï¼ GetText

å®ç° stock ææ¬æ Caption å±æ§ç Get å½æ°ã

```
BSTR GetText();
```

### <a name="return-value"></a>è¿åå¼

å¦æä¸å­å¨å­ç¬¦ä¸²ï¼åä¸ºæ§ä»¶ææ¬å­ç¬¦ä¸²çå½åå¼æé¿åº¦ä¸ºé¶çå­ç¬¦ä¸²ã

> [!NOTE]
>  æå³ BSTR æ°æ®ç±»åçè¯¦ç»ä¿¡æ¯ï¼è¯·åéå®åå¨å±é¨åä¸­ç[æ°æ®ç±»å](../../mfc/reference/data-types-mfc.md)ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ­¤å½æ°çè°ç¨æ¹å¿é¡»å¯¹è¿åçå­ç¬¦ä¸²è°ç¨ `SysFreeString`ï¼ä»¥ä¾¿éæ¾èµæºã å¨æ§ä»¶çå®ç°ä¸­ï¼ä½¿ç¨ `InternalGetText` è®¿é®æ§ä»¶ç stock ææ¬ææ é¢å±æ§ã

##  <a name="getwindowlessdroptarget"></a>COleControlï¼ï¼ GetWindowlessDropTarget

å¦æå¸æå°æ çªå£æ§ä»¶ä½ä¸º OLE ææ¾æä½çç®æ ï¼è¯·è¦ç `GetWindowlessDropTarget`ã

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>è¿åå¼

æåå¯¹è±¡ç `IDropTarget` æ¥å£çæéã ç±äºå®æ²¡æçªå£ï¼å æ­¤æ çªå£å¯¹è±¡æ æ³æ³¨å `IDropTarget` æ¥å£ã ä½æ¯ï¼è¥è¦åä¸ææ¾ï¼æ çªå£å¯¹è±¡ä»å¯ä»¥å®ç°è¯¥æ¥å£ï¼å¹¶ `GetWindowlessDropTarget`ä¸­å°å¶è¿åã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ï¼è¿éè¦å°è¯¥æ§ä»¶ççªå£æ³¨åä¸ºæ¾ç½®ç®æ ã ä½ç±äºæ§ä»¶æ²¡æèªå·±ççªå£ï¼å®¹å¨å°ä½¿ç¨å¶èªå·±ççªå£ä½ä¸ºæ¾ç½®ç®æ ã æ§ä»¶åªéæä¾ `IDropTarget` æ¥å£çå®ç°ï¼å®¹å¨å¯ä»¥å¨éå½çæ¶é´å§æè°ç¨ã ä¾å¦ï¼

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>COleControlï¼ï¼ InitializeIIDs

éç¥æ§ä»¶å°ä½¿ç¨ç Iid çåºç±»ã

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>parameters

*piidPrimary*<br/>
æåæ§ä»¶çä¸»è°åº¦æ¥å£çæ¥å£ ID çæéã

*piidEvents*<br/>
æåæ§ä»¶çäºä»¶æ¥å£çæ¥å£ ID çæéã

### <a name="remarks"></a>å¤æ³¨

å¨æ§ä»¶çæé å½æ°ä¸­è°ç¨æ­¤å½æ°ï¼ä»¥éç¥æ§ä»¶å°ä½¿ç¨çæ¥å£ Id çåºç±»ã

##  <a name="internalgetfont"></a>COleControlï¼ï¼ InternalGetFont

è®¿é®æ§ä»¶çå¸¸ç¨å­ä½å±æ§

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>è¿åå¼

å¯¹åå« stock å­ä½å¯¹è±¡ç[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡çå¼ç¨ã

##  <a name="internalgettext"></a>COleControlï¼ï¼ InternalGetText

è®¿é®æ§ä»¶ç stock ææ¬æ Caption å±æ§ã

```
const CString& InternalGetText();
```

### <a name="return-value"></a>è¿åå¼

å¯¹æ§ä»¶ææ¬å­ç¬¦ä¸²çå¼ç¨ã

##  <a name="internalsetreadystate"></a>COleControlï¼ï¼ InternalSetReadyState

è®¾ç½®æ§ä»¶çå°±ç»ªç¶æã

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>parameters

*lNewReadyState*<br/>
ä¸ºæ§ä»¶è®¾ç½®çå°±ç»ªç¶æä¸ºä»¥ä¸å¼ä¹ä¸ï¼

|||
|-|-|
|READYSTATE_UNINITIALIZED|é»è®¤åå§åç¶æ|
|READYSTATE_LOADING|æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§|
|READYSTATE_LOADED|æ§ä»¶å·²åå§å|
|READYSTATE_INTERACTIVE|æ§ä»¶å·æè¶³å¤çæ°æ®ä»¥è¿è¡äº¤äºï¼ä½å¹¶ä¸æ¯ææçå¼æ­¥æ°æ®é½å·²å è½½|
|READYSTATE_COMPLETE|æ§ä»¶çæææ°æ®|

### <a name="remarks"></a>å¤æ³¨

å¤§å¤æ°ç®åæ§ä»¶é½ä¸éè¦åºåå·²å è½½åäº¤äºå¼ã ä½æ¯ï¼å¨è³å°å¼æ­¥æ¥æ¶æäºæ°æ®ä¹åï¼æ¯ææ°æ®è·¯å¾å±æ§çæ§ä»¶å¯è½å°æªåå¤å¥½è¿è¡äº¤äºã æ§ä»¶ä¼å°è¯å°½å¿«æä¸ºäº¤äºæ§ä»¶ã

##  <a name="invalidatecontrol"></a>COleControlï¼ï¼ Microsoft.office.core.iribbonui.invalidatecontrol

å¼ºå¶æ§ä»¶éç»èªèº«ã

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
æåè¦ä½¿å¶æ æçæ§ä»¶çåºåçæéã

*bErase*<br/>
æå®å¨å¤çæ´æ°åºåæ¶æ¯å¦æ¸é¤æ´æ°åºåä¸­çèæ¯ã

### <a name="remarks"></a>å¤æ³¨

å¦æ*lpRect*å·æ NULL å¼ï¼åå°éæ°ç»å¶æ´ä¸ªæ§ä»¶ã å¦æ*lpRect*ä¸ä¸º NULLï¼åè¡¨ç¤ºè¦ä½¿å¶æ æçæ§ä»¶ç©å½¢é¨åã å¦ææ§ä»¶æ²¡æçªå£ï¼æèå½åä¸å¤äºæ´»å¨ç¶æï¼åå¿½ç¥è¯¥ç©å½¢ï¼å¹¶å¯¹å®¢æ·ç«¯ç«ç¹ç[IAdviseSinkï¼ï¼ OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)æåå½æ°è¿è¡è°ç¨ã ä½¿ç¨æ­¤å½æ°ï¼èä¸æ¯ `CWnd::InvalidateRect` æ `InvalidateRect`ã

##  <a name="invalidatergn"></a>COleControlï¼ï¼ InvalidateRgn

ä½¿ç»å®åºååçå®¹å¨çªå£çå·¥ä½åºå¤±æã

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>parameters

*pRgn*<br/>
æå[CRgn](../../mfc/reference/crgn-class.md)å¯¹è±¡çæéï¼è¯¥å¯¹è±¡æ è¯è¦ä½¿å¶å¨åå«çªå£çå·¥ä½åºåæ ä¸­æ æç OLE å¯¹è±¡çæ¾ç¤ºåºåã å¦ææ­¤åæ°ä¸º NULLï¼åèå´ä¸ºæ´ä¸ªå¯¹è±¡ã

*bErase*<br/>
æå®æ¯å¦è¦æ¸é¤æ æåºåä¸­çèæ¯ã å¦æä¸º TRUEï¼åæ¸é¤èæ¯ã å¦æä¸º FALSEï¼ååå°ä¿æä¸åã

### <a name="remarks"></a>å¤æ³¨

è¿å¯ç¨äºå¨å®¹å¨ä¸­éç»æ çªå£æ§ä»¶ã å¨åéä¸ä¸[WM_PAINT](/windows/win32/gdi/wm-paint)æ¶æ¯æ¶ï¼æ æåºåä¸æ´æ°åºåä¸­çææå¶ä»åºåä¸èµ·æ è®°ä¸ºè¦è¿è¡ç»å¶ã

å¦æ*bErase*å¨æ´æ°åºåçä»»ä½é¨åé½ä¸º TRUEï¼åå°æ¸é¤æ´ä¸ªåºåä¸­çèæ¯ï¼èä¸åªæ¯ç»å®é¨ä»¶çèæ¯ã

##  <a name="isconvertingvbx"></a>COleControlï¼ï¼ IsConvertingVBX

åè®¸ä¸ç¨å è½½ OLE æ§ä»¶ã

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ­£å¨è½¬æ¢æ§ä»¶ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å°ä½¿ç¨ VBX æ§ä»¶ççªä½è½¬æ¢ä¸ºä½¿ç¨ OLE æ§ä»¶ççªä½æ¶ï¼å¯è½éè¦ OLE æ§ä»¶çç¹æ®å è½½ä»£ç ã ä¾å¦ï¼å¦æè¦å è½½ OLE æ§ä»¶çå®ä¾ï¼åå¯è½ä¼è°ç¨ `DoPropExchange`ä¸­ç[PX_Font](persistence-of-ole-controls.md#px_font) ï¼

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

ä½æ¯ï¼VBX æ§ä»¶æ²¡æ Font å¯¹è±¡;æ¯ä¸ªå­ä½å±æ§é½åç¬ä¿å­ã å¨è¿ç§æåµä¸ï¼å¯ä»¥ä½¿ç¨ `IsConvertingVBX` æ¥åºåè¿ä¸¤ç§æåµï¼

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

å¦ä¸ç§æåµæ¯ï¼å¦ææ¨ç VBX æ§ä»¶ä¿å­äºä¸æçäºè¿å¶æ°æ®ï¼å¨å¶ VBM_SAVEPROPERTY çæ¶æ¯å¤çç¨åºä¸­ï¼ï¼å¹¶ä¸æ¨ç OLE æ§ä»¶ä»¥ä¸åçæ ¼å¼ä¿å­å¶äºè¿å¶æ°æ®ã å¦æå¸ææ¨ç OLE æ§ä»¶ä¸ VBX æ§ä»¶ååå¼å®¹ï¼åå¯ä»¥éè¿åºå VBX æ§ä»¶æ OLE æ§ä»¶æ¯å¦æ­£å¨å è½½æ¥ä½¿ç¨ `IsConvertingVBX` å½æ°è¯»åæ§æ ¼å¼åæ°æ ¼å¼ã

å¨æ§ä»¶ç `DoPropExchange` å½æ°ä¸­ï¼å¯ä»¥æ£æ¥æ­¤æ¡ä»¶ï¼å¦æä¸º trueï¼åæ§è¡ç¹å®äºæ­¤è½¬æ¢çå è½½ä»£ç ï¼å¦åé¢çç¤ºä¾ï¼ã å¦ææ§ä»¶æªè¿è¡è½¬æ¢ï¼åå¯ä»¥æ§è¡æ­£å¸¸å è½½ä»£ç ã æ­¤åè½ä»éç¨äºä» VBX å¯¹åºé¡¹è½¬æ¢çæ§ä»¶ã

##  <a name="isinvokeallowed"></a>COleControlï¼ï¼ IsInvokeAllowed

å¯ç¨èªå¨åæ¹æ³è°ç¨ã

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>è¿åå¼

å¦æå·²åå§åæ§ä»¶ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

æ¡æ¶å¯¹ `IDispatch::Invoke` è°ç¨ `IsInvokeAllowed` æ¥ç¡®å®æ¯å¦å¯ä»¥è°ç¨ç»å®å½æ°ï¼ç± `dispid`æ è¯ï¼ã OLE æ§ä»¶çé»è®¤è¡ä¸ºæ¯ä»å½æ§ä»¶å·²åå§åæ¶æåè®¸è°ç¨èªå¨åæ¹æ³;ä½ `IsInvokeAllowed` æ¯ä¸ä¸ªèå½æ°ï¼å¦æå¿è¦ï¼å¯è½ä¼è¢«éåï¼ä¾å¦ï¼å°æ§ä»¶ç¨ä½èªå¨åæå¡å¨æ¶ï¼ã

##  <a name="ismodified"></a>COleControlï¼ï¼ IsModified

ç¡®å®æ¯å¦å·²ä¿®æ¹æ§ä»¶çç¶æã

```
BOOL IsModified();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶èªä¸æ¬¡ä¿å­åå·²ä¿®æ¹ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å½å±æ§æ´æ¹å¼æ¶ï¼å°ä¿®æ¹æ§ä»¶çç¶æã

##  <a name="isoptimizeddraw"></a>COleControlï¼ï¼ IsOptimizedDraw

ç¡®å®å®¹å¨æ¯å¦æ¯æå½åç»å¶æä½çä¼åç»å¾ã

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>è¿åå¼

å¦æå®¹å¨æ¯æå½åç»å¶æä½çä¼åç»å¾ï¼åä¸º TRUE;å¦åä¸º FALSEã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¯æä¼åçç»å¾ï¼åç»å¶å®æåï¼æ§ä»¶ä¸éè¦éæ©æ§å¯¹è±¡ï¼ç¬ãç»ç¬ãå­ä½ç­ï¼å°è®¾å¤ä¸ä¸æã

##  <a name="issubclassedcontrol"></a>COleControlï¼ï¼ IsSubclassedControl

ç±æ¡æ¶è°ç¨ï¼ä»¥ç¡®å®æ§ä»¶æ¯å¦ä¸º Windows æ§ä»¶çå­ç±»ã

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶ä¸ºå­ç±»ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å¿é¡»éåæ­¤å½æ°ï¼å¦æ OLE æ§ä»¶å° Windows æ§ä»¶å­ç±»ï¼åè¿å TRUEã

##  <a name="load"></a>COleControlï¼ï¼ Load

éç½®ææååå è½½çæ°æ®ï¼å¹¶å¯å¨æ§ä»¶å¼æ­¥å±æ§çæ°å è½½ã

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>parameters

*strNewPath*<br/>
æåå­ç¬¦ä¸²çæéï¼è¯¥å­ç¬¦ä¸²åå«å¼ç¨å¼æ­¥æ§ä»¶å±æ§ç»å¯¹ä½ç½®çè·¯å¾ã

*ç*<br/>
å®ç°å¼æ­¥æ§ä»¶å±æ§ç[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)å¯¹è±¡ã

##  <a name="lockinplaceactive"></a>COleControlï¼ï¼ LockInPlaceActive

é»æ­¢å®¹å¨åç¨æ§ä»¶ã

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>parameters

*æ¨¡å*<br/>
å¦æè¦éå®æ§ä»¶çå°±å°æ´»å¨ç¶æï¼åä¸º TRUE;å¦æè¦è§£é¤éå®ï¼åä¸º FALSEã

### <a name="return-value"></a>è¿åå¼

å¦æéå®æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼å¨å®æåï¼æ§ä»¶çæ¯ä¸ªéå®å¿é¡»ä¸æ§ä»¶è§£é¤éå®ã åªåºå°æ§ä»¶éå®ä¸å°æ®µæ¶é´ï¼å¦è§¦åäºä»¶æ¶ã

##  <a name="onambientpropertychange"></a>COleControlï¼ï¼ OnAmbientPropertyChange

å½å®¹å¨çæä¸ªç¯å¢å±æ§æ´æ¹äºå¼æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>parameters

*dispID*<br/>
å·²æ´æ¹çç¯å¢å±æ§çè°åº¦ IDï¼æå¨å¤ä¸ªå±æ§å·²æ´æ¹çæåµä¸ DISPID_UNKNOWNã

##  <a name="onappearancechanged"></a>COleControlï¼ï¼ OnAppearanceChanged

å½ stock å¤è§å±æ§å¼å·²æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã é»è®¤å®ç°å°è°ç¨ `InvalidateControl`ã

##  <a name="onbackcolorchanged"></a>COleControlï¼ï¼ OnBackColorChanged

å½ stock èæ¯è²å±æ§å¼å·²æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã é»è®¤å®ç°å°è°ç¨ `InvalidateControl`ã

##  <a name="onborderstylechanged"></a>COleControlï¼ï¼ OnBorderStyleChanged

å½ stock BorderStyle å±æ§å¼å·²æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨ `InvalidateControl`ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã

##  <a name="onclick"></a>COleControlï¼ï¼ OnClick

å½åå»é¼ æ æé®æè°ç¨ DoClick stock æ¹æ³æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>parameters

*iButton*<br/>
é¼ æ æé®çç´¢å¼ã å¯ä»¥æ¯ä¸åå¼ä¹ä¸ï¼

- LEFT_BUTTON åå»äºé¼ æ å·¦é®ã

- MIDDLE_BUTTON åå»äºé¼ æ ä¸­é®ã

- åå»é¼ æ å³é® RIGHT_BUTTONã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨ `COleControl::FireClick`ã

éåæ­¤æåå½æ°ä»¥ä¿®æ¹ææ©å±é»è®¤å¤çã

##  <a name="onclose"></a>COleControlï¼ï¼ OnClose

å½å®¹å¨è°ç¨æ§ä»¶ç `IOleControl::Close` å½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>parameters

*dwSaveOption*<br/>
æç¤ºæ¯å¦åºå¨å è½½åä¿å­å¯¹è±¡çæ å¿ã ææå¼æ¯ï¼

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸ï¼å¦ææ§ä»¶å¯¹è±¡å·²ä¿®æ¹å¹¶ä¸*dwSaveOption*ä¸º OLECLOSE_SAVEIFDIRTY æ OLECLOSE_PROMPTSAVEï¼å `OnClose` å°ä¿å­æ§ä»¶å¯¹è±¡ã

##  <a name="ondoverb"></a>COleControlï¼ï¼ OnDoVerb

å½å®¹å¨è°ç¨ `IOleObject::DoVerb` æåå½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*iVerb*<br/>
è¦è°ç¨çæ§å¶è°è¯çç´¢å¼ã

*lpMsg*<br/>
æåå¯¼è´è°ç¨è°è¯ç Windows æ¶æ¯çæéã

*hWndParent*<br/>
æ§ä»¶çç¶çªå£çå¥æã å¦ææ§è¡è°è¯æ¶åå»ºäºçªå£ï¼æçªå£ï¼ï¼ååºå°*hWndParent*ç¨ä½ç¶é¡¹ã

*lpRect*<br/>
ä¸ä¸ªæéï¼å®æåå°å¤å¶æ§ä»¶çåæ ï¼ç¸å¯¹äºå®¹å¨ï¼ç RECT ç»æã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä½¿ç¨ ON_OLEVERB å ON_STDOLEVERB æ¶æ¯æ å°é¡¹æ¥ç¡®å®è¦è°ç¨çæ­£ç¡®å½æ°ã

éåæ­¤å½æ°å¯ä»¥æ´æ¹è°è¯çé»è®¤å¤çã

##  <a name="ondraw"></a>COleControlï¼ï¼ OnDraw

ç±æ¡æ¶è°ç¨ï¼ä»¥ä½¿ç¨æå®çè®¾å¤ä¸ä¸æå¨æå®çè¾¹æ¡ä¸­ç»å¶ OLE æ§ä»¶ã

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
å¨å¶ä¸­è¿è¡ç»å¶çè®¾å¤ä¸ä¸æã

*rcBounds*<br/>
æ§ä»¶çç©å½¢åºåï¼åæ¬è¾¹æ¡ã

*rcInvalid*<br/>
æ æçæ§ä»¶çç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

`OnDraw` éå¸¸ç§°ä¸ºå±å¹æ¾ç¤ºï¼å°å±å¹è®¾å¤ä¸ä¸æä½ä¸º*pDC*ä¼ éã *RcBounds*åæ°æ è¯ç®æ è®¾å¤ä¸ä¸æä¸­çç©å½¢ï¼ç¸å¯¹äºå¶å½åæ å°æ¨¡å¼ï¼ã *RcInvalid*åæ°æ¯æ æçå®éç©å½¢ã å¨æäºæåµä¸ï¼è¿å°æ¯æ¯*rcBounds*æ´å°çåºåã

##  <a name="ondrawmetafile"></a>COleControlï¼ï¼ OnDrawMetafile

ç±æ¡æ¶è°ç¨ï¼ä»¥ä½¿ç¨æå®çå¾åæä»¶è®¾å¤ä¸ä¸æå¨æå®çè¾¹æ¡åç»å¶ OLE æ§ä»¶ã

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
å¨å¶ä¸­è¿è¡ç»å¶çè®¾å¤ä¸ä¸æã

*rcBounds*<br/>
æ§ä»¶çç©å½¢åºåï¼åæ¬è¾¹æ¡ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨[OnDraw](#ondraw)å½æ°ã

##  <a name="onedit"></a>COleControlï¼ï¼ OnEdit

å¯¼è´æ§ä»¶æ¿æ´» UIã

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpMsg*<br/>
æåè°ç¨è°è¯ç Windows æ¶æ¯çæéã

*hWndParent*<br/>
æ§ä»¶çç¶çªå£çå¥æã

*lpRect*<br/>
æåå®¹å¨ä¸­çæ§ä»¶ä½¿ç¨çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

è¿ç­æäºè°ç¨æ§ä»¶ç OLEIVERB_UIACTIVATE è°è¯ã

æ­¤å½æ°éå¸¸ç¨ä½ ON_OLEVERB æ¶æ¯æ å°é¡¹çå¤çç¨åºå½æ°ã è¿ä¼ä½¿ "ç¼è¾" è°è¯å¯ç¨äºæ§ä»¶ç "å¯¹è±¡" èåã ä¾å¦ï¼

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>COleControlï¼ï¼ OnEnabledChanged

å½å¯ç¨äº stock çå±æ§å¼æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã é»è®¤å®ç°å°è°ç¨[microsoft.office.core.iribbonui.invalidatecontrol](#invalidatecontrol)ã

##  <a name="onenumverbs"></a>COleControlï¼ï¼ OnEnumVerbs

å½å®¹å¨è°ç¨ `IOleObject::EnumVerbs` æåå½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>parameters

*ppenumOleVerb*<br/>
æåæä¸¾æ§ä»¶çè°è¯ç `IEnumOLEVERB` å¯¹è±¡çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°è¯å¯ç¨ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æä¸¾æ¶æ¯æ å°ä¸­ç ON_OLEVERB é¡¹ã

éåæ­¤å½æ°å¯ä»¥æ´æ¹æä¸¾è°è¯çé»è®¤æ¹å¼ã

##  <a name="oneventadvise"></a>COleControlï¼ï¼ OnEventAdvise

å½äºä»¶å¤çç¨åºè¿æ¥å° OLE æ§ä»¶æä¸è¯¥æ§ä»¶æ­å¼è¿æ¥æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>parameters

*bAdvise*<br/>
å¦æä¸º TRUEï¼åè¡¨ç¤ºäºä»¶å¤çç¨åºå·²è¿æ¥å°æ§ä»¶ã FALSE æç¤ºäºä»¶å¤çç¨åºå·²ä¸æ§ä»¶æ­å¼è¿æ¥ã

##  <a name="onfontchanged"></a>COleControlï¼ï¼ OnFontChanged

å½å¸¸ç¨å­ä½å±æ§å¼å·²æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨ `COleControl::InvalidateControl`ã å¦ææ§ä»¶æ¯å¯¹ Windows æ§ä»¶è¿è¡å­ç±»åï¼åé»è®¤å®ç°è¿ä¼åæ§ä»¶ççªå£åé WM_SETFONT æ¶æ¯ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>COleControlï¼ï¼ OnForeColorChanged

å½è¡ç¥¨åæ¯å±æ§å¼å·²æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨ `InvalidateControl`ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã

##  <a name="onfreezeevents"></a>COleControlï¼ï¼ OnFreezeEvents

å¨å®¹å¨è°ç¨ `IOleControl::FreezeEvents`ä¹åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>parameters

*bFreeze*<br/>
å¦ææ§ä»¶çäºä»¶å¤çè¢«å»ç»ï¼åä¸º TRUE;å¦åä¸º FALSEã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã

å¦æå¨äºä»¶å¤çè¢«å»ç»æè§£å»æ¶éè¦å¶ä»è¡ä¸ºï¼è¯·éåæ­¤å½æ°ã

##  <a name="ongetcolorset"></a>COleControlï¼ï¼ OnGetColorSet

å½å®¹å¨è°ç¨ `IViewObject::GetColorSet` æåå½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>parameters

*ptd*<br/>
æååºåç°å¾ççç®æ è®¾å¤ã å¦ææ­¤å¼ä¸º NULLï¼ååºè¯¥ä¸ºé»è®¤ç®æ è®¾å¤ï¼éå¸¸ä¸ºæ¾ç¤ºè®¾å¤ï¼åç°å¾çã

*hicTargetDev*<br/>
æå®*ptd*ææç¤ºçç®æ è®¾å¤ä¸çä¿¡æ¯ä¸ä¸æã æ­¤åæ°å¯ä»¥æ¯è®¾å¤ä¸ä¸æï¼ä½è¿ä¸æ¯å¿éçã å¦æ*ptd*ä¸º nullï¼å*hicTargetDev*è¿åºä¸º nullã

*ppColorSet*<br/>
ä¸ä¸ªæéï¼æååºå°ä½¿ç¨çé¢è²éå¤å¶å°å¶ä¸­çä½ç½®ã å¦æè¯¥å½æ°æªè¿åé¢è²éï¼åè¿å NULLã

### <a name="return-value"></a>è¿åå¼

å¦æè¿åææçé¢è²éï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å®¹å¨è°ç¨æ­¤å½æ°ä»¥è·åç»å¶ OLE æ§ä»¶æéçææé¢è²ã å®¹å¨å¯ä»¥ä½¿ç¨ä¸è®¾ç½®æ»ä½è°è²æ¿æéçé¢è²ä¸èµ·è·å¾çé¢è²éã é»è®¤å®ç°è¿å FALSEã

éåæ­¤å½æ°ä»¥å¯¹æ­¤è¯·æ±è¿è¡ä»»ä½ç¹æ®å¤çã

##  <a name="ongetcontrolinfo"></a>COleControlï¼ï¼ OnGetControlInfo

å½æ§ä»¶çå®¹å¨è¯·æ±æå³æ§ä»¶çä¿¡æ¯æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>parameters

*pControlInfo*<br/>
æåè¦å¡«åç[CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo)ç»æçæéã

### <a name="remarks"></a>å¤æ³¨

æ­¤ä¿¡æ¯ä¸»è¦åå«æ§ä»¶çå©è®°é®çè¯´æã é»è®¤å®ç°ç¨é»è®¤ä¿¡æ¯å¡«å*pControlInfo* ã

å¦ææ§ä»¶éè¦å¤çå©è®°é®ï¼è¯·éåæ­¤å½æ°ã

##  <a name="ongetdisplaystring"></a>COleControlï¼ï¼ OnGetDisplayString

ç±æ¡æ¶è°ç¨ä»¥è·åä¸ä¸ªå­ç¬¦ä¸²ï¼è¯¥å­ç¬¦ä¸²è¡¨ç¤º*dispid*æ è¯çå±æ§çå½åå¼ã

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*strValue*<br/>
å¯¹[CString](../../atl-mfc-shared/reference/cstringt-class.md)å¯¹è±¡çå¼ç¨ï¼éè¿è¯¥å¯¹è±¡ï¼å°è¿åä¸ä¸ªå­ç¬¦ä¸²ã

### <a name="return-value"></a>è¿åå¼

å¦æå·²å¨ StrValue ä¸­è¿åä¸ä¸ªå­ç¬¦ä¸² *ï¼åä¸º*éé¶; å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶çå±æ§çå¼æ æ³ç´æ¥è½¬æ¢ä¸ºå­ç¬¦ä¸²ï¼å¹¶ä¸æ¨å¸æå¨å®¹å¨æä¾çå±æ§æµè§å¨ä¸­æ¾ç¤ºè¯¥å±æ§çå¼ï¼åéåæ­¤å½æ°ã

##  <a name="ongetinplacemenu"></a>COleControlï¼ï¼ OnGetInPlaceMenu

å½æ§ä»¶æ¿æ´» UI æ¶ç±æ¡æ¶è°ç¨ï¼ä»¥è·åè¦åå¹¶å°å®¹å¨çç°æèåä¸­çèåã

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çèåçå¥æ; å¦ææ§ä»¶æ²¡æï¼åä¸º NULLã é»è®¤å®ç°è¿å NULLã

### <a name="remarks"></a>å¤æ³¨

æå³åå¹¶ OLE èµæºçè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [èååèµæºï¼OLEï¼](../../mfc/menus-and-resources-ole.md)ä¸æã

##  <a name="ongetnaturalextent"></a>COleControlï¼ï¼ OnGetNaturalExtent

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç `IViewObjectEx::GetNaturalExtent` è¯·æ±ã

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
æå®è¦å¦ä½è¡¨ç¤ºè¯¥å¯¹è±¡ã è¡¨ç¤ºå½¢å¼åæ¬åå®¹ãå¾æ ãç¼©ç¥å¾ææå°ææ¡£ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*lindex*<br/>
å¯¹è±¡ä¸­æå´è¶£çé¨åã ç®ååªæ-1 æ¯ææçã

*ptd*<br/>
æå[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)ç»æï¼å®ä¹åºä¸ºå¶è¿åå¯¹è±¡å¤§å°çç®æ è®¾å¤ã

*hicTargetDev*<br/>
æå®*ptd*åæ°æç¤ºçç®æ è®¾å¤çä¿¡æ¯ä¸ä¸æï¼å¯¹è±¡å¯ä»è¯¥åæ°æåè®¾å¤åº¦éå¼å¹¶æµè¯è®¾å¤çåè½ã å¦æ*ptd*ä¸º NULLï¼åå¯¹è±¡åºå¿½ç¥*hicTargetDev*åæ°ä¸­çå¼ã

*pExtentInfo*<br/>
æåæå®å¤§å°è°æ´æ°æ®ç `DVEXTENTINFO` ç»æã `DVEXTENTINFO` ç»æä¸ºï¼

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

ç»ææå `dwExtentMode` å¯ä»¥éç¨ä»¥ä¸ä¸¤ä¸ªå¼ä¹ä¸ï¼

- DVEXTENT_CONTENT æ¥è¯¢æ§ä»¶ç²¾ç¡®éåºåå®¹çå¤§å°ï¼é é½å°å¤§å°ï¼

- è°æ´å¤§å°æ¶ï¼è¯· DVEXTENT_INTEGRAL ä¼ éå»ºè®®å¤§å°ä»¥è¿è¡æ§å¶

*psizel*<br/>
æåç±æ§ä»¶è¿åçå¤§å°è°æ´æ°æ®çç¹ã å¯¹äºæªè°æ´çä»»ä½ç»´åº¦ï¼è¿åçå¤§å°è°æ´æ°æ®å°è®¾ç½®ä¸º-1ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åæè°æ´å¤§å°ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

éåæ­¤å½æ°ä»¥è¿åå¯¹è±¡çæ¾ç¤ºå¤§å°ï¼è¯¥å¤§å°ä¸ `DVEXTENTINFO` ç»æä¸­çå»ºè®®å¤§å°ååºæ¨¡å¼ææ¥è¿ã é»è®¤å®ç°è¿å FALSEï¼å¹¶ä¸ä¸å¯¹å¤§å°è¿è¡è°æ´ã

##  <a name="ongetpredefinedstrings"></a>COleControlï¼ï¼ OnGetPredefinedStrings

ç±æ¡æ¶è°ç¨ä»¥è·åä¸ç»é¢å®ä¹çå­ç¬¦ä¸²ï¼è¿äºå­ç¬¦ä¸²è¡¨ç¤ºå±æ§çå¯è½å¼ã

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*pStringArray*<br/>
è¦ç¨è¿åå¼å¡«åçå­ç¬¦ä¸²æ°ç»ã

*pCookieArray*<br/>
è¦ç¨è¿åå¼å¡«åç DWORD æ°ç»ã

### <a name="return-value"></a>è¿åå¼

å¦æå·²å°åç´ æ·»å å°*pStringArray*å*pCookieArray*ï¼åä¸ºéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶æä¸ä¸ªå±æ§ï¼å¶ä¸­åå«ä¸ç»å¯ç±å­ç¬¦ä¸²è¡¨ç¤ºçå¯è½å¼ï¼è¯·éåæ­¤å½æ°ã å¯¹äºæ·»å å°*pStringArray*çæ¯ä¸ªåç´ ï¼åºå°ç¸åºç "cookie" åç´ æ·»å å°*pCookieArray ä¸­ã* æ­¤æ¡æ¶ç¨åå¯è½ä¼å°è¿äº "cookie" å¼ä¼ éå° `COleControl::OnGetPredefinedValue` å½æ°ã

##  <a name="ongetpredefinedvalue"></a>COleControlï¼ï¼ OnGetPredefinedValue

ç±æ¡æ¶è°ç¨ï¼ä»¥è·åä¸ååç± `COleControl::OnGetPredefinedStrings`éåè¿åçé¢å®ä¹å­ç¬¦ä¸²ä¹ä¸ç¸å¯¹åºçå¼ã

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*dwCookie*<br/>
ååç± `COleControl::OnGetPredefinedStrings`éåè¿åç cookie å¼ã

*lpvarOut*<br/>
æå `VARIANT` ç»æçæéï¼éè¿è¯¥ç»æå°è¿åå±æ§å¼ã

### <a name="return-value"></a>è¿åå¼

å¦æå·²å¨*lpvarOut*ä¸­è¿åå¼ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

##  <a name="ongetviewextent"></a>COleControlï¼ï¼ OnGetViewExtent

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç[IViewObject2ï¼ï¼ GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)è¯·æ±ã

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>parameters

*dwDrawAspect*<br/>
ç¨äºæè¿°è¦æ¾ç¤ºå¯¹è±¡çåªä¸çªä½ææ¹é¢ç DWORDã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*lindex*<br/>
å¯¹è±¡ä¸­æå´è¶£çé¨åã ç®ååªæ-1 æ¯ææçã

*ptd*<br/>
æå[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)ç»æï¼å®ä¹åºä¸ºå¶è¿åå¯¹è±¡å¤§å°çç®æ è®¾å¤ã

*lpsizel*<br/>
æåè¿åå¯¹è±¡å¤§å°çä½ç½®ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åäºåºä¿¡æ¯ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶ä½¿ç¨ä¸¤éç»å¾ï¼å¹¶ä¸å®çéæåéæé¨åå·æä¸åçå°ºå¯¸ï¼åéåæ­¤å½æ°ã

##  <a name="ongetviewrect"></a>COleControlï¼ï¼ OnGetViewRect

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç `IViewObjectEx::GetRect` è¯·æ±ã

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
ç¨äºæè¿°è¦æ¾ç¤ºå¯¹è±¡çåªä¸çªä½ææ¹é¢ç DWORDã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ï¼

- æ´ä¸ªå¯¹è±¡ç DVASPECT_CONTENT è¾¹æ¡ã å¯¹è±¡åç¹çå·¦ä¸è§ï¼å¤§å°ç­äº `GetViewExtent`è¿åçèå´ *ã*

- å·æç©å½¢ä¸éæåºåç DVASPECT_OPAQUE å¯¹è±¡å°è¿åè¯¥ç©å½¢ã å¶ä»å¤±è´¥ã

- è¦çææéææä¸è§åé¨åç DVASPECT_TRANSPARENT ç©å½¢ã

*pRect*<br/>
æå[RECTL](/previous-versions/dd162907\(v=vs.85\))ç»æï¼æå®åºå¨å¶ä¸­ç»å¶å¯¹è±¡çç©å½¢ã æ­¤åæ°æ§å¶å¯¹è±¡çå®ä½åæä¼¸ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åå¤§å°ä¸ºå¯¹è±¡çç©å½¢ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å¯¹è±¡çå¤§å°ç± `OnGetViewRect` è½¬æ¢ä¸ºä»ç¹å®ä½ç½®ï¼é»è®¤ä¸ºæ¾ç¤ºçå·¦ä¸è§ï¼å¼å§çç©å½¢ã å¦ææ§ä»¶ä½¿ç¨ä¸¤éç»å¾ï¼å¹¶ä¸å®çéæåéæé¨åå·æä¸åçå°ºå¯¸ï¼åéåæ­¤å½æ°ã

##  <a name="ongetviewstatus"></a>COleControlï¼ï¼ OnGetViewStatus

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç `IViewObjectEx::GetViewStatus` è¯·æ±ã

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸º VIEWSTATUS æä¸¾çå¼ä¹ä¸;å¦åä¸º0ã å¯è½çå¼åæ¬ä»¥ä¸åé¡¹çä»»æç»åï¼

|||
|-|-|
|VIEWSTATUS_OPAQUE|å¯¹è±¡å®å¨ä¸éæã å¦ææªè®¾ç½®æ­¤ä½ï¼åå¯¹è±¡å°åå«éæé¨åã æ­¤ä½ä»éç¨äºåå®¹ç¸å³çæ¹é¢ï¼èä¸æ¯ DVASPECT_ICON æ DVASPECT_DOCPRINTã|
|VIEWSTATUS_SOLIDBKGND|å¯¹è±¡å·æçº¯è²èæ¯ï¼ç±çº¯è²èéç»ç¬å¾æ¡ç»æï¼ã åªæå¨è®¾ç½® VIEWSTATUS_OPAQUE å¹¶ä»éç¨äºä¸åå®¹ç¸å³çæ¹é¢ï¼èä¸æ¯ DVASPECT_ICON æ DVASPECT_DOCPRINT æ¶ï¼æ­¤ä½æææä¹ã|
|VIEWSTATUS_DVASPECTOPAQUE|å¯¹è±¡æ¯æ DVASPECT_OPAQUEã å°ç»å¾æ¹ä½ä½ä¸ºåæ°çææ IViewObjectEx æ¹æ³åå¯éè¿æ­¤æ¹é¢è°ç¨ã|
|VIEWSTATUS_DVASPECTTRANSPARENT|å¯¹è±¡æ¯æ DVASPECT_TRANSPARENTã å°ç»å¾æ¹é¢ä½ä¸ºåæ°çææ `IViewObjectEx` æ¹æ³é½å¯ä»¥ä½¿ç¨æ­¤ç¹æ§æ¥è°ç¨ã|

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶ä½¿ç¨ä¸¤éç»å¾ï¼åéåæ­¤å½æ°ã é»è®¤å®ç°è¿å VIEWSTATUS_OPAQUEã

##  <a name="onhidetoolbars"></a>COleControlï¼ï¼ OnHideToolBars

å½æ§ä»¶ä¸º UI åç¨æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>å¤æ³¨

å®ç°åºéè `OnShowToolbars`æ¾ç¤ºçææå·¥å·æ ã

##  <a name="oninactivemousemove"></a>COleControlï¼ï¼ OnInactiveMouseMove

ç±é¼ æ æéä¸çéæ´»å¨å¯¹è±¡çå®¹å¨è°ç¨ï¼æ¥æ¶å° WM_MOUSEMOVE æ¶æ¯ã

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
åå«çªå£çå·¥ä½åºåæ ä¸­çå¯¹è±¡è¾¹æ¡ã æ¥æ¶å° WM_MOUSEMOVE æ¶æ¯æ¶ï¼éç¥å¯¹è±¡å¨å±å¹ä¸çåç¡®ä½ç½®åå¤§å°ã

*x*<br/>
é¼ æ ä½ç½®å¨æåå«çªå£çå·¥ä½åºåæ ä¸­ç x åæ ã

*y*<br/>
é¼ æ ä½ç½®å¨æåå«çªå£çå·¥ä½åºåæ ä¸­ç y åæ ã

*dwKeyState*<br/>
æ è¯é®çä¸çé®çä¿®æ¹é®çå½åç¶æã ææå¼å¯ä»¥æ¯ä»»ä½æ å¿çç»å MK_CONTROLãMK_SHIFTãMK_ALTãMK_BUTTONãMK_LBUTTONãMK_MBUTTON å MK_RBUTTONã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼çªå£å®¢æ·ç«¯åæ ï¼åç´ ï¼ç¨äºä¼ éé¼ æ åæ çä½ç½®ã è¿æ¯éè¿åæ¶ä¼ éåä¸åæ ç³»ç»ä¸­çå¯¹è±¡çè¾¹æ¡æ¥å®ç°çã

##  <a name="oninactivesetcursor"></a>COleControlï¼ï¼ OnInactiveSetCursor

ç±é¼ æ æéä¸çéæ´»å¨å¯¹è±¡çå®¹å¨è°ç¨ï¼æ¥æ¶å° WM_SETCURSOR æ¶æ¯ã

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
åå«çªå£çå·¥ä½åºåæ ä¸­çå¯¹è±¡è¾¹æ¡ã æ¥æ¶å° WM_SETCURSOR æ¶æ¯æ¶ï¼éç¥å¯¹è±¡å¨å±å¹ä¸çåç¡®ä½ç½®åå¤§å°ã

*x*<br/>
é¼ æ ä½ç½®å¨æåå«çªå£çå·¥ä½åºåæ ä¸­ç x åæ ã

*y*<br/>
é¼ æ ä½ç½®å¨æåå«çªå£çå·¥ä½åºåæ ä¸­ç y åæ ã

*dwMouseMsg*<br/>
åç WM_SETCURSOR çé¼ æ æ¶æ¯çæ è¯ç¬¦ã

*bSetAlways*<br/>
æå®å¯¹è±¡æ¯å¦å¿é¡»è®¾ç½®åæ ã å¦æä¸º TRUEï¼åå¯¹è±¡å¿é¡»è®¾ç½®åæ ;å¦æä¸º FALSEï¼åæ¸¸æ æ éè®¾ç½®æ¸¸æ ï¼å¹¶ä¸åºå¨è¿ç§æåµä¸è¿å S_FALSEã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼çªå£å®¢æ·ç«¯åæ ï¼åç´ ï¼ç¨äºä¼ éé¼ æ åæ çä½ç½®ã è¿æ¯éè¿åæ¶ä¼ éåä¸åæ ç³»ç»ä¸­çå¯¹è±¡çè¾¹æ¡æ¥å®ç°çã

##  <a name="onkeydownevent"></a>COleControlï¼ï¼ OnKeyDownEvent

å¨å¤çäºè¡ç¥¨ KeyDown äºä»¶ä¹åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
æä¸çé®çèæé®ä»£ç å¼ã æå³æ åèæé®ä»£ç çåè¡¨ï¼è¯·åé Winuserãh

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦æå¨è§¦åäºä»¶åï¼æ§ä»¶éè¦è®¿é®å¯é¥ä¿¡æ¯ï¼è¯·éåæ­¤å½æ°ã

##  <a name="onkeypressevent"></a>COleControlï¼ï¼ OnKeyPressEvent

å¨æ¿åäº stock æé®äºä»¶ä¹åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
åå«æä¸çé®çèæé®ä»£ç å¼ã æå³æ åèæé®ä»£ç çåè¡¨ï¼è¯·åé Winuserãh

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ­¤*nChar*å¼å¯è½å·²ç±å®¹å¨è¿è¡äºä¿®æ¹ã

å¦æå¸æå¨æ­¤äºä»¶åçåååºéç¥ï¼è¯·éåæ­¤å½æ°ã

##  <a name="onkeyupevent"></a>COleControlï¼ï¼ OnKeyUpEvent

å¨å¤çäºè¡ç¥¨ KeyDown äºä»¶ä¹åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>parameters

*nChar*<br/>
æä¸çé®çèæé®ä»£ç å¼ã æå³æ åèæé®ä»£ç çåè¡¨ï¼è¯·åé Winuserãh

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½è¿ç¨ä¸­ï¼SHIFT_MASK æä¸ SHIFT é®ã

- CTRL_MASK å¨æä½è¿ç¨ä¸­æä¸äº CTRL é®ã

- ALT_MASK å¨æä½è¿ç¨ä¸­æä¸äº ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦æå¨è§¦åäºä»¶åï¼æ§ä»¶éè¦è®¿é®å¯é¥ä¿¡æ¯ï¼è¯·éåæ­¤å½æ°ã

##  <a name="onmappropertytopage"></a>COleControlï¼ï¼ OnMapPropertyToPage

ç±æ¡æ¶è°ç¨ï¼ä»¥è·åå®ç°äºæå®å±æ§çç¼è¾çå±æ§é¡µçç±» IDã

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>parameters

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*lpclsid*<br/>
æå `CLSID` ç»æçæéï¼éè¿è¯¥ç»æå°è¿åç±» IDã

*pbPageOptional*<br/>
è¿åä¸ä¸ªæç¤ºç¬¦ï¼æç¤ºæ¯å¦ä½¿ç¨æå®çå±æ§é¡µã

### <a name="return-value"></a>è¿åå¼

å¦æå·²å¨*lpclsid*ä¸­è¿åç±» IDï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

éåæ­¤å½æ°ä»¥æä¾ä¸ç§æ¹æ³ï¼ç¨äºä»å®¹å¨çå±æ§æµè§å¨è°ç¨æ§ä»¶çå±æ§é¡µã

##  <a name="onmnemonic"></a>COleControlï¼ï¼ OnMnemonic

å½å®¹å¨å·²æ£æµå° OLE æ§ä»¶çå©è®°é®å·²æä¸æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>parameters

*pMsg*<br/>
ä¸ä¸ªæéï¼æåç±å©è®°é®æé®æä½çæç Windows æ¶æ¯ã

##  <a name="onproperties"></a>COleControlï¼ï¼ OnProperties

å½å®¹å¨è°ç¨æ§ä»¶çå±æ§è°è¯æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpMsg*<br/>
æåè°ç¨è°è¯ç Windows æ¶æ¯çæéã

*hWndParent*<br/>
æ§ä»¶çç¶çªå£çå¥æã

*lpRect*<br/>
æåå®¹å¨ä¸­çæ§ä»¶ä½¿ç¨çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æ¾ç¤º "æ¨¡å¼å±æ§" å¯¹è¯æ¡ã

ä½ è¿å¯ä»¥ä½¿ç¨æ­¤å½æ°æ¥å¯¼è´æ§ä»¶çå±æ§é¡µçæ¾ç¤ºã è°ç¨ `OnProperties` å½æ°ï¼å°æ§ä»¶çç¶çº§çå¥æä¼ éå°*hWndParent*åæ°ã å¨è¿ç§æåµä¸ï¼å°å¿½ç¥*lpMsg*å*lpRect*åæ°çå¼ã

##  <a name="onqueryhitpoint"></a>COleControlï¼ï¼ OnQueryHitPoint

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç `IViewObjectEx::QueryHitPoint` è¯·æ±ã

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
æå®è¡¨ç¤ºå¯¹è±¡çæ¹å¼ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*pRectBounds*<br/>
æå `RECT` ç»æçæéï¼è¯¥ç»ææå® OLE æ§ä»¶å®¢æ·ç«¯åºåçè¾¹æ¡ã

*ptlLoc*<br/>
æå `POINT` ç»æçæéï¼è¯¥ç»ææå®è¦æ£æ¥æ¯å¦å½ä¸­çç¹ã å¨ OLE å·¥ä½åºåæ ä¸­æå®è¯¥ç¹ã

*lCloseHint*<br/>
ä¸ºæ£æ¥å½ä¸­çç¹å®ä¹ "æ¶ç" çè·ç¦»ã

*pHitResult*<br/>
æåå½ä¸­æ¥è¯¢ç»æçæéã ä»¥ä¸å¼ä¹ä¸ï¼

- HITRESULT_OUTSIDE *ptlLoc*ä½äº OLE å¯¹è±¡ä¹å¤ï¼ä½æªå³é­ã

- HITRESULT_TRANSPARENT *ptlLoc*ä½äº OLE å¯¹è±¡çè¾¹çåï¼ä½ä¸æ¥è¿å¾åã ä¾å¦ï¼éæåçä¸­é´ç¹å¯ä»¥ HITRESULT_TRANSPARENTã

- HITRESULT_CLOSE *ptlLoc*ä½äº OLE å¯¹è±¡åé¨æå¤é¨ï¼ä½æ¥è¿äºè¦å¨å¶ä¸­è¢«è§ä¸ºçå¯¹è±¡ã å°åãç¦æè¯¦ç»å¯¹è±¡å¯è½ä¼ä½¿ç¨æ­¤å¼ã å³ä½¿æä¸ªç¹ä½äºå¯¹è±¡çè¾¹æ¡å¤ï¼å®ä»å¯è½ä¼å³é­ï¼è¿å¯¹äºå½ä¸­å°å¯¹è±¡æ¯å¿éçï¼ã

- HITRESULT_HIT *ptlLoc*ä½äºå¯¹è±¡çå¾ååã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åå½ä¸­ç»æï¼åä¸ºéé¶å¼;å¦åä¸º0ã å½ä¸­ä¸ OLE æ§ä»¶æ¾ç¤ºåºåéå ã

### <a name="remarks"></a>å¤æ³¨

æ¥è¯¢å¯¹è±¡çæ¾ç¤ºç©å½¢æ¯å¦ä¸ç»å®ç¹éå ï¼ç¹å»ç¹ï¼ã å¯å¯¹ `QueryHitPoint` è¿è¡éåï¼ä»¥å¯¹éç©å½¢å¯¹è±¡è¿è¡å½ä¸­æµè¯ã

##  <a name="onqueryhitrect"></a>COleControlï¼ï¼ OnQueryHitRect

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç `IViewObjectEx::QueryHitRect` è¯·æ±ã

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>parameters

*dwAspect*<br/>
æå®è¦å¦ä½è¡¨ç¤ºè¯¥å¯¹è±¡ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*pRectBounds*<br/>
æå `RECT` ç»æçæéï¼è¯¥ç»ææå® OLE æ§ä»¶å®¢æ·ç«¯åºåçè¾¹æ¡ã

*prcLoc*<br/>
æå `RECT` ç»æçæéï¼è¯¥ç»ææå®è¦æ£æ¥æ¯å¦å­å¨å½ä¸­çç©å½¢ï¼ä¸å¯¹è±¡ç©å½¢éå ï¼ï¼ç¸å¯¹äºå¯¹è±¡çå·¦ä¸è§ã

*lCloseHint*<br/>
æªä½¿ç¨ã

*pHitResult*<br/>
æåå½ä¸­æ¥è¯¢ç»æçæéã ä»¥ä¸å¼ä¹ä¸ï¼

- OLE å¯¹è±¡ä¸ä¼éå°ç©å½¢ä¸­çä»»ä½ç¹ HITRESULT_OUTSIDEã

- HITRESULT_HIT ç©å½¢ä¸­çè³å°ä¸ä¸ªç¹æ¯å¯¹è±¡ä¸çä¸ä¸ªç¹ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åå½ä¸­ç»æï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

æ¥è¯¢å¯¹è±¡çæ¾ç¤ºç©å½¢æ¯å¦ä¸ç»å®ç©å½¢ä¸­çä»»ä½ç¹éå ï¼å°è¾¾ç©å½¢ï¼ã å¯å¯¹ `QueryHitRect` è¿è¡éåï¼ä»¥å¯¹éç©å½¢å¯¹è±¡è¿è¡å½ä¸­æµè¯ã

##  <a name="onrenderdata"></a>COleControlï¼ï¼ OnRenderData

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æï¼æå®è¯·æ±ä¿¡æ¯æ¶æç¨çæ ¼å¼ã

*lpStgMedium*<br/>
æåè¦è¿åæ°æ®ç[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)ç»æã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)æ[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)æåå½æ°æ¾ç½®å¨æ§ä»¶å¯¹è±¡ä¸­ç¨äºå»¶è¿åç°çæ ¼å¼ã æ­¤å½æ°çé»è®¤å®ç°åå«è°ç¨ `OnRenderFileData` æ `OnRenderGlobalData`ï¼å¦ææä¾çå­å¨ä»è´¨æ¯æä»¶æåå­ï¼ã å¦æè¯·æ±çæ ¼å¼ä¸º CF_METAFILEPICT ææä¹å±æ§éæ ¼å¼ï¼åé»è®¤å®ç°å°åç°ç¸åºçæ°æ®å¹¶è¿åéé¶å¼ã å¦åï¼å®å°è¿å0å¹¶ä¸æ§è¡ä»»ä½æä½ã

å¦æ TYMED_NULL *lpStgMedium > tymed* ï¼ååºæ*lpFormatEtc-> tymed*æå®çæ¹å¼åéåå¡«å STGMEDIUMã å¦ææª TYMED_NULLï¼ååºå° STGMEDIUM ä¸æ°æ®ä¸èµ·å¡«åã

éåæ­¤å½æ°ä»¥æè¯·æ±çæ ¼å¼ååªä½æä¾æ°æ®ã æ ¹æ®æ¨çæ°æ®ï¼æ¨å¯è½éè¦æ¿ä»£æ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦ææ°æ®å¤§å°è¾å°ä¸åºå®ï¼è¯·è¦ç `OnRenderGlobalData`ã å¦ææ°æ®ä½äºæä»¶ä¸­æå¤§å°å¯åï¼è¯·è¦ç `OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows SDK ä¸­ç `FORMATETC` å `STGMEDIUM` ç»æã

##  <a name="onrenderfiledata"></a>COleControlï¼ï¼ OnRenderFileData

å½å­å¨ä»è´¨ä¸ºæä»¶æ¶ï¼ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æï¼æå®è¯·æ±ä¿¡æ¯æ¶æç¨çæ ¼å¼ã

*.Pfile*<br/>
æåè¦å¨å¶ä¸­åç°æ°æ®ç[CFile](../../mfc/reference/cfile-class.md)å¯¹è±¡ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åå¨æ§ä»¶å¯¹è±¡ä¸­æ¾ç½®çæ ¼å¼ï¼å®ä½¿ç¨[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)æåå½æ°è¿è¡å»¶è¿æ¸²æã æ­¤å½æ°çé»è®¤å®ç°åªè¿å FALSEã

éåæ­¤å½æ°ä»¥æè¯·æ±çæ ¼å¼ååªä½æä¾æ°æ®ã æ ¹æ®æ¨çæ°æ®ï¼æ¨å¯è½å¸ææ¹ä¸ºéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æè¦å¤çå¤ä¸ªå­å¨åªä½ï¼è¯·è¦ç `OnRenderData`ã å¦ææ°æ®ä½äºæä»¶ä¸­æå¤§å°å¯åï¼è¯·è¦ç `OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows SDK ä¸­ç `FORMATETC` ç»æã

##  <a name="onrenderglobaldata"></a>COleControlï¼ï¼ OnRenderGlobalData

å½æå®çå­å¨ä»è´¨ä¸ºå¨å±åå­æ¶ï¼ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æï¼æå®è¯·æ±ä¿¡æ¯æ¶æç¨çæ ¼å¼ã

*phGlobal*<br/>
æåå¨å±åå­çå¥æï¼å¶ä¸­çæ°æ®å°è¢«è¿åã å¦ææªåéåå­ï¼åæ­¤åæ°å¯ä»¥ä¸º NULLã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åå¨æ§ä»¶å¯¹è±¡ä¸­æ¾ç½®çæ ¼å¼ï¼å®ä½¿ç¨[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)æåå½æ°è¿è¡å»¶è¿æ¸²æã æ­¤å½æ°çé»è®¤å®ç°åªè¿å FALSEã

å¦æ*phGlobal*ä¸º NULLï¼ååºå¨*phGlobal*ä¸­åéå¹¶è¿åæ°ç HGLOBALã å¦åï¼ç±*phGlobal*æå®ç HGLOBAL åºä½¿ç¨æ°æ®è¿è¡å¡«åã æ¾ç½®å¨ HGLOBAL ä¸­çæ°æ®éä¸è½è¶è¿åå­åçå½åå¤§å°ã æ­¤å¤ï¼ä¸è½å°åéæ°åéå°æ´å¤§çå¤§å°ã

éåæ­¤å½æ°ä»¥æè¯·æ±çæ ¼å¼ååªä½æä¾æ°æ®ã æ ¹æ®æ¨çæ°æ®ï¼æ¨å¯è½éè¦æ¿ä»£æ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æè¦å¤çå¤ä¸ªå­å¨åªä½ï¼è¯·è¦ç `OnRenderData`ã å¦ææ°æ®ä½äºæä»¶ä¸­æå¤§å°å¯åï¼è¯·è¦ç `OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows SDK ä¸­ç `FORMATETC` ç»æã

##  <a name="onresetstate"></a>COleControlï¼ï¼ OnResetState

å½æ§ä»¶çå±æ§åºè®¾ç½®ä¸ºå¶é»è®¤å¼æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnResetState();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨[DoPropExchange](#dopropexchange)ï¼åæ¶ä¼ éå¯¼è´å±æ§è®¾ç½®ä¸ºå¶é»è®¤å¼ç `CPropExchange` å¯¹è±¡ã

æ§ä»¶ç¼åå¨å¯ä»¥å¨æ­¤å¯éåçä¸­æå¥ OLE æ§ä»¶çåå§åä»£ç ã å¦æè°ç¨äº[IPersistStreamï¼ï¼ Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)æ[IPersistStorageï¼ï¼ load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)å¤±è´¥ï¼æèè°ç¨[IPersistStreamInitï¼ï¼ InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)æ[IPersistStorageï¼ï¼ InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) ï¼èæ éåè°ç¨ `IPersistStream::Load` æ `IPersistStorage::Load`ï¼åå°è°ç¨æ­¤å½æ°ã

##  <a name="onsetclientsite"></a>COleControlï¼ï¼ OnSetClientSite

å½å®¹å¨è°ç¨æ§ä»¶ç `IOleControl::SetClientSite` å½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸ï¼`OnSetClientSite` ä¼æ£æ¥æ¯å¦å è½½æ°æ®è·¯å¾å±æ§ï¼å¦ææ¯ï¼åè°ç¨ `DoDataPathPropExchange`ã

éåæ­¤å½æ°ä»¥å¯¹æ­¤éç¥æ§è¡ä»»ä½ç¹æ®å¤çã ç¹å«æ¯ï¼æ­¤å½æ°çéååºè°ç¨åºç±»ã

##  <a name="onsetdata"></a>COleControlï¼ï¼ OnSetData

ç±æ¡æ¶è°ç¨ä»¥å°æ§ä»¶çæ°æ®æ¿æ¢ä¸ºæå®çæ°æ®ã

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>parameters

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æçæéï¼è¯¥ç»ææå®æ°æ®çæ ¼å¼ã

*lpStgMedium*<br/>
æåæ°æ®æå¨ç[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)ç»æçæéã

*bRelease*<br/>
å¦ææ§ä»¶åºéæ¾å­å¨ä»è´¨ï¼åä¸º TRUE;å¦ææ§ä»¶ä¸åºéæ¾å­å¨ä»è´¨ï¼åä¸º FALSEã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ°æ®éç¨æä¹æ§å±æ§éæ ¼å¼ï¼åé»è®¤å®ç°ä¼ç¸åºå°ä¿®æ¹æ§ä»¶çç¶æã å¦åï¼é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã å¦æ*bRelease*ä¸º TRUEï¼åå¯¹ `ReleaseStgMedium` è°ç¨ãå¦åä¸ºã

éåæ­¤å½æ°ä»¥å°æ§ä»¶çæ°æ®æ¿æ¢ä¸ºæå®çæ°æ®ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows SDK ä¸­ç `FORMATETC` å `STGMEDIUM` ç»æã

##  <a name="onsetextent"></a>COleControlï¼ï¼ OnSetExtent

å½éè¦æ´æ¹æ§ä»¶çèå´æ¶ç±æ¡æ¶è°ç¨ï¼è¿æ¯å¯¹[IOleObjectï¼ï¼ SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)çè°ç¨çç»æã

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>parameters

*lpSizeL*<br/>
æå `SIZEL` ç»æçæéï¼è¯¥ç»æä½¿ç¨é¿æ´æ°è¡¨ç¤ºæ§ä»¶çå®½åº¦åé«åº¦ï¼ä»¥ HIMETRIC åä½è¡¨ç¤ºã

### <a name="return-value"></a>è¿åå¼

å¦ææ¥åå¤§å°æ´æ¹ï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å¤çæ§ä»¶èå´çå¤§å°è°æ´ã å¦ææ§ä»¶å¤äºå°±å°æ´»å¨ç¶æï¼åä¼å¯¹å®¹å¨ç `OnPosRectChanged` è¿è¡è°ç¨ã

éåæ­¤å½æ°ä»¥æ´æ¹æ§ä»¶çé»è®¤å¤§å°è°æ´ã

##  <a name="onsetobjectrects"></a>COleControlï¼ï¼ OnSetObjectRects

ç±æ¡æ¶è°ç¨ä»¥å®ç°å¯¹[IOleInPlaceObjectï¼ï¼ SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)çè°ç¨ã

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>parameters

*lpRectPos*<br/>
æå `RECT` ç»æçæéï¼è¯¥ç»ææç¤ºæ§ä»¶ç¸å¯¹äºå®¹å¨çæ°ä½ç½®åå¤§å°ã

*lpRectClip*<br/>
ä¸ä¸ªæå `RECT` ç»æçæéï¼è¯¥æéæç¤ºæ§ä»¶è¦åªè£å°çç©å½¢åºåã

### <a name="return-value"></a>è¿åå¼

å¦æå·²æ¥åéå®ä½ï¼åä¸ºéé¶;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¼èªå¨å¤çæ§ä»¶çªå£çéå®ä½åè°æ´å¤§å°ï¼å¹¶è¿å TRUEã

éåæ­¤å½æ°ä»¥æ´æ¹æ­¤å½æ°çé»è®¤è¡ä¸ºã

##  <a name="onshowtoolbars"></a>COleControlï¼ï¼ OnShowToolBars

å½æ§ä»¶å·²æ¿æ´» UI æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã

##  <a name="ontextchanged"></a>COleControlï¼ï¼ OnTextChanged

å½ stock æ é¢æææ¬å±æ§å¼å·²æ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨ `InvalidateControl`ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åååºéç¥ï¼è¯·éåæ­¤å½æ°ã

##  <a name="onwindowlessmessage"></a>COleControlï¼ï¼ OnWindowlessMessage

ç±æ¡æ¶è°ç¨ï¼ä»¥ååºå®¹å¨ç `IOleInPlaceObjectWindowless::OnWindowMessage` è¯·æ±ã

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>parameters

*ç¼ºå°*<br/>
Windows ä¼ éçæ¶æ¯æ è¯ç¬¦ã

*wParam*<br/>
ç± Windows ä¼ éã æå®å¶ä»ç¹å®äºæ¶æ¯çä¿¡æ¯ã æ­¤åæ°çåå®¹åå³äº*msg*åæ°çå¼ã

*lParam*<br/>
ç± Windows ä¼ éã æå®å¶ä»ç¹å®äºæ¶æ¯çä¿¡æ¯ã æ­¤åæ°çåå®¹åå³äº*msg*åæ°çå¼ã

*plResult*<br/>
Windows ç»æä»£ç ã æå®æ¶æ¯å¤ççç»æï¼å¹¶åå³äºæåéçæ¶æ¯ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¤çæ çªå£æ§ä»¶ççªå£æ¶æ¯ã `COleControl`ç `OnWindowlessMessage` åºç¨äºé¤é¼ æ æ¶æ¯åé®çæ¶æ¯ä»¥å¤ççªå£æ¶æ¯ã `COleControl` æä¾äº[SetCapture](#setcapture)å[SetFocus](#setfocus) ï¼ä¸ç¨äºä¸ºæ çªå£ OLE å¯¹è±¡è·åé¼ æ æè·åé®çç¦ç¹ã

ç±äºæ çªå£å¯¹è±¡æ²¡æçªå£ï¼å æ­¤å®ä»¬éè¦ä¸ä¸ªæºå¶è®©å®¹å¨åå®ä»¬åæ´¾æ¶æ¯ã æ çªå£ OLE å¯¹è±¡ `OnWindowMessage` éè¿ `IOleInPlaceObjectWindowless` æ¥å£ï¼ [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)çæ©å±æ¯æçæ©å±ï¼ä»å¶å®¹å¨ä¸­è·åæ¶æ¯ã `OnWindowMessage` ä¸éç¨ `HWND` åæ°ã

##  <a name="parenttoclient"></a>COleControlï¼:P arentToClient

å°*pPoint*çåæ è½¬æ¢ä¸ºå®¢æ·ç«¯åæ ã

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>parameters

*lprcBounds*<br/>
ä¸ä¸ªæéï¼æåå®¹å¨ä¸­ OLE æ§ä»¶çè¾¹çã ä¸æ¯å·¥ä½åºï¼èæ¯æ´ä¸ªæ§ä»¶çåºåï¼åæ¬è¾¹æ¡åæ»å¨æ¡ï¼ã

*pPoint*<br/>
æåè¦è½¬æ¢ä¸ºæ§ä»¶çå·¥ä½åºåæ çç¶çº§ï¼å®¹å¨ï¼ç¹çæéã

*bHitTest*<br/>
æå®æ¯å¦å¨ç¹ä¸å®æå½ä¸­æµè¯ã

### <a name="return-value"></a>è¿åå¼

å¦æ*bHitTest*ä¸º FALSEï¼åè¿å HTNOWHEREã å¦æ*bHitTest*ä¸º TRUEï¼åè¿åç¶ï¼å®¹å¨ï¼ç¹å¨ OLE æ§ä»¶çå·¥ä½åºä¸­çéçä½ç½®ï¼å®æ¯ä»¥ä¸é¼ æ å½ä¸­æµè¯å¼ä¹ä¸ï¼

- ä¸å·æå¤§å°è°æ´è¾¹æ¡ççªå£è¾¹æ¡ä¸­ç HTBORDERã

- çªå£çä¸æ°´å¹³è¾¹æ¡ä¸­ç HTBOTTOMã

- çªå£è¾¹æ¡å·¦ä¸è§ç HTBOTTOMLEFTã

- çªå£è¾¹æ¡å³ä¸è§ç HTBOTTOMRIGHTã

- æ é¢æ åºåä¸­ç HTCAPTIONã

- å·¥ä½åºä¸­ç HTCLIENTã

- HTERROR å¨å±å¹èæ¯ä¸æå¨çªå£ä¹é´çåéçº¿ä¸ï¼ä¸ HTNOWHERE ç¸åï¼ä¸åä¹å¤å¨äº `DefWndProc` Windows å½æ°ååºç³»ç»æç¤ºé³ï¼æç¤ºéè¯¯ï¼ã

- HTGROWBOX å¨ "å¤§å°" æ¡ä¸­ã

- æ°´å¹³æ»å¨æ¡ä¸­ç HTHSCROLLã

- çªå£å·¦è¾¹æ¡ä¸­ç HTLEFTã

- "æå¤§å" æé®ä¸­ç HTMAXBUTTONã

- èååºåä¸­ç HTMENUã

- "æå°å" æé®ä¸­ç HTMINBUTTONã

- HTNOWHERE å¨å±å¹èæ¯ä¸æå¨çªå£ä¹é´çåéçº¿ä¸æ¾ç¤ºã

- "æå°å" æé®ä¸­ç HTREDUCEã

- çªå£å³è¾¹æ¡ä¸­ç HTRIGHTã

- HTSIZE å¨å¤§å°æ¡ä¸­ï¼ä¸ HTGROWBOX ç¸åï¼ã

- HTSYSMENU å¨æ§ä»¶èåæå­çªå£ç "å³é­" æé®ä¸­ã

- çªå£çä¸æ°´å¹³è¾¹æ¡ä¸­ç HTTOPã

- çªå£è¾¹æ¡å·¦ä¸è§ç HTTOPLEFTã

- çªå£è¾¹æ¡å³ä¸è§ç HTTOPRIGHTã

- å½åç±å¦ä¸ä¸ªçªå£è¦çççªå£ä¸­ç HTTRANSPARENTã

- åç´æ»å¨æ¡ä¸­ç HTVSCROLLã

- "æå¤§å" æé®ä¸­ç HTZOOMã

### <a name="remarks"></a>å¤æ³¨

On input *pPoint*æ¯ç¸å¯¹äºç¶çº§ï¼å®¹å¨å·¦ä¸è§ï¼çåç¹ã å¨ output *pPoint*ä¸ï¼ç¸å¯¹äº OLE æ§ä»¶ï¼æ§ä»¶å·¥ä½åºå·¦ä¸è§ï¼çå·¥ä½åºçåç¹ã

##  <a name="postmodaldialog"></a>COleControlï¼:P ostModalDialog

éç¥å®¹å¨æ¨¡å¼å¯¹è¯æ¡å·²å³é­ã

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>parameters

*hWndParent*<br/>
æ¨¡å¼å¯¹è¯æ¡çç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

å¨æ¾ç¤ºä»»ä½æ¨¡å¼å¯¹è¯æ¡åè°ç¨æ­¤å½æ°ã æ¨å¿é¡»è°ç¨æ­¤å½æ°ï¼ä»¥ä¾¿å®¹å¨å¯ä»¥ `PreModalDialog`ç¦ç¨ä»»ä½é¡¶çº§çªå£ã åºå°æ­¤å½æ°ä¸å¯¹ `PreModalDialog`çè°ç¨éå¯¹ã

##  <a name="premodaldialog"></a>COleControlï¼:P reModalDialog

éç¥å®¹å¨å°è¦æ¾ç¤ºçæ¨¡å¼å¯¹è¯æ¡ã

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>parameters

*hWndParent*<br/>
æ¨¡å¼å¯¹è¯æ¡çç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

å¨æ¾ç¤ºä»»ä½æ¨¡å¼å¯¹è¯æ¡ä¹åè°ç¨æ­¤å½æ°ã å¿é¡»è°ç¨æ­¤å½æ°ï¼ä½¿å®¹å¨è½å¤ç¦ç¨å¶ææé¡¶çº§çªå£ã æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡ä¹åï¼å¿é¡»è°ç¨ `PostModalDialog`ã

##  <a name="recreatecontrolwindow"></a>COleControlï¼ï¼ RecreateControlWindow

éæ¯å¹¶éæ°åå»ºæ§ä»¶ççªå£ã

```
void RecreateControlWindow();
```

### <a name="remarks"></a>å¤æ³¨

å¦æéè¦æ´æ¹çªå£çæ ·å¼ä½ï¼åè¿å¯è½æ¯å¿éçã

##  <a name="refresh"></a>COleControlï¼ï¼ Refresh

å¼ºå¶éæ°ç»å¶ OLE æ§ä»¶ã

```
void Refresh();
```

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°ä½ä¸ºå¸¸ç¨æ¹æ³ï¼ç§°ä¸º Refreshï¼ `COleControl` åºç±»æ¯æã è¿åè®¸ OLE æ§ä»¶çç¨æ·å¨ç¹å®æ¶é´éç»æ§ä»¶ã æå³æ­¤æ¹æ³çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼æ¹æ³](../../mfc/mfc-activex-controls-methods.md)ã

##  <a name="releasecapture"></a>COleControlï¼ï¼ ReleaseCapture

éæ¾é¼ æ æè·ã

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å½åå·æé¼ æ æè·ï¼åéæ¾æè·ã å¦åï¼æ­¤å½æ°å°ä¸èµ·ä½ç¨ã

##  <a name="releasedc"></a>COleControlï¼ï¼ ReleaseDC

éæ¾æ çªå£æ§ä»¶çå®¹å¨çæ¾ç¤ºè®¾å¤ä¸ä¸æï¼éæ¾è®¾å¤ä¸ä¸æä»¥ä¾å¶ä»åºç¨ç¨åºä½¿ç¨ã

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
æ è¯è¦éæ¾çå®¹å¨è®¾å¤ä¸ä¸æã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

åºç¨ç¨åºå¿é¡»è°ç¨[GetDC](#getdc)çæ¯ä¸ªè°ç¨ç `ReleaseDC`ã

##  <a name="reparentcontrolwindow"></a>COleControlï¼ï¼ ReparentControlWindow

è®¾ç½®æ§ä»¶çç¶çº§ã

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>parameters

*hWndOuter*<br/>
æ§ä»¶çªå£çå¥æã

*hWndParent*<br/>
æ°çç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯éç½®æ§ä»¶çªå£çç¶çº§ã

##  <a name="resetstockprops"></a>COleControlï¼ï¼ ResetStockProps

å° `COleControl` è¡ç¥¨å±æ§çç¶æåå§åä¸ºå¶é»è®¤å¼ã

```
void ResetStockProps();
```

### <a name="remarks"></a>å¤æ³¨

å±æ§åæ¬ï¼å¤è§ãèæ¯è²ãæ ·å¼æ ãæ é¢ãå·²å¯ç¨ãå­ä½ãåæ¯è²ãhWnd åææ¬ã æå³å¸¸ç¨å±æ§çè¯´æï¼è¯·åé[ActiveX æ§ä»¶ï¼æ·»å å¸¸ç¨å±æ§](../../mfc/mfc-activex-controls-adding-stock-properties.md)ã

æ¨å¯ä»¥éè¿ä½¿ç¨ `ResetStockProps` å `ResetVersion` æ¥è¦ç `COleControl::OnResetState`ï¼æé«æ§ä»¶çäºè¿å¶åå§åæ§è½ã è¯·åéä»¥ä¸ç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>COleControlï¼ï¼ ResetVersion

å°çæ¬å·åå§åä¸ºæå®å¼ã

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>parameters

*dwVersionDefault*<br/>
è¦åéç»æ§ä»¶ççæ¬å·ã

### <a name="remarks"></a>å¤æ³¨

æ¨å¯ä»¥éè¿ä½¿ç¨ `ResetVersion` å `ResetStockProps` æ¥è¦ç `COleControl::OnResetState`ï¼æé«æ§ä»¶çäºè¿å¶åå§åæ§è½ã è¯·åé[ResetStockProps](#resetstockprops)ä¸çç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="scrollwindow"></a>COleControlï¼ï¼ ScrollWindow

åè®¸æ çªå£ OLE å¯¹è±¡å¨å±å¹ä¸çå°±å°æ´»å¨å¾åä¸­æ»å¨åºåã

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>parameters

*xAmount*<br/>
æå®æ°´å¹³æ»å¨çéï¼ä»¥è®¾å¤åä½ä¸ºåä½ï¼ã æ­¤åæ°å¿é¡»æ¯è´å¼æè½æ»å¨å°å·¦ä¾§ã

*yAmount*<br/>
æå®åç´æ»å¨çéï¼ä»¥è®¾å¤åä½ä¸ºåä½ï¼ã æ­¤åæ°å¿é¡»ä¸ºè´å¼æè½åä¸æ»å¨ã

*lpRect*<br/>
æå[CRect](../../atl-mfc-shared/reference/crect-class.md)å¯¹è±¡æ RECT ç»æï¼å®æå®è¦æ»å¨ç OLE å¯¹è±¡çå·¥ä½åºé¨åï¼å¨åå«çªå£çå·¥ä½åºåæ ä¸­ï¼ã å¦æ*lpRect*ä¸º NULLï¼åæ»å¨æ´ä¸ª OLE å¯¹è±¡çå·¥ä½åºã

*lpClipRect*<br/>
æåä¸ä¸ª `CRect` å¯¹è±¡æ `RECT` ç»æï¼è¯¥å¯¹è±¡æå®è¦åªè£å°çç©å½¢ã ä»æ»å¨ç©å½¢åçåç´ ã å³ä½¿å¨*lpRect*ç©å½¢ä¸­ï¼å®ä¹ä¸ä¼åå°å½±åã å¦æ*lpClipRect*ä¸º NULLï¼åä¸ä¼å¯¹æ»å¨ç©å½¢æ§è¡ä»»ä½åªåã

##  <a name="selectfontobject"></a>COleControlï¼ï¼ SelectFontObject

å¨è®¾å¤ä¸ä¸æä¸­éæ©å­ä½ã

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
æåè®¾å¤ä¸ä¸æå¯¹è±¡çæéã

*fontHolder*<br/>
å¯¹[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡çå¼ç¨ï¼è¯¥å¯¹è±¡è¡¨ç¤ºè¦éæ©çå­ä½ã

### <a name="return-value"></a>è¿åå¼

æåååéå®å­ä½çæéã å½è°ç¨æ¹å®æä½¿ç¨ FontHolder çææç»å¶æä½æ¶ *ï¼* å®åºéè¿å°ä»¥åéæ©çå­ä½ä½ä¸ºåæ°ä¼ éç»[CDCï¼ï¼ SelectObject](../../mfc/reference/cdc-class.md#selectobject)æ¥éæ°éæ©å®ã

##  <a name="selectstockfont"></a>COleControlï¼ï¼ SelectStockFont

éæ© "å¸¸ç¨å­ä½" å±æ§å°è®¾å¤ä¸ä¸æã

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
å°éæ©å­ä½çè®¾å¤ä¸ä¸æã

### <a name="return-value"></a>è¿åå¼

æååé¢éå®ç `CFont` å¯¹è±¡çæéã å®æåï¼åºä½¿ç¨[CDCï¼ï¼ SelectObject](../../mfc/reference/cdc-class.md#selectobject)å°æ­¤å­ä½éæ©åè®¾å¤ä¸ä¸æã

##  <a name="serializeextent"></a>COleControlï¼ï¼ SerializeExtent

åºååæåå§ååéç»æ§ä»¶çæ¾ç¤ºç©ºé´çç¶æã

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>parameters

*ar*<br/>
è¦åºååå°æä»å¶è¿è¡åºååç `CArchive` å¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

æ¨å¯ä»¥ä½¿ç¨ `SerializeExtent`ã`SerializeStockProps`å `SerializeVersion` éå `COleControl::Serialize`æ¥æ¹åæ§ä»¶çäºè¿å¶æä¹æ§æ§è½ã è¯·åéä»¥ä¸ç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>COleControlï¼ï¼ SerializeStockProps

åºååæåå§å `COleControl` è¡ç¥¨å±æ§çç¶æï¼å¤è§ãèæ¯è²ãæ ·å¼æ ãæ é¢ãå·²å¯ç¨ãå­ä½ãåæ¯è²åææ¬ã

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>parameters

*ar*<br/>
è¦åºååå°æä»å¶è¿è¡åºååç `CArchive` å¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

æå³å¸¸ç¨å±æ§çè¯´æï¼è¯·åé[ActiveX æ§ä»¶ï¼æ·»å å¸¸ç¨å±æ§](../../mfc/mfc-activex-controls-adding-stock-properties.md)ã

æ¨å¯ä»¥ä½¿ç¨ `SerializeStockProps`ã`SerializeExtent`å `SerializeVersion` éå `COleControl::Serialize`æ¥æ¹åæ§ä»¶çäºè¿å¶æä¹æ§æ§è½ã æå³ç¤ºä¾ï¼è¯·åé[SerializeExtent](#serializeextent)ä¸­çä»£ç ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="serializeversion"></a>COleControlï¼ï¼ SerializeVersion

åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯çç¶æã

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>parameters

*ar*<br/>
è¦åºååå°æä»å¶è¿è¡åºååç `CArchive` å¯¹è±¡ã

*dwVersionDefault*<br/>
æ§ä»¶çå½åçæ¬å·ã

*bConvert*<br/>
æç¤ºæ¯å¦åºå¨ä¿å­æä¹æ§æ°æ®æ¶å°å¶è½¬æ¢ä¸ºææ°æ ¼å¼ï¼æä»¥å è½½æ¶çç¸åæ ¼å¼è¿è¡ç»´æ¤ã

### <a name="return-value"></a>è¿åå¼

æ§ä»¶ççæ¬å·ã å¦ææ­£å¨å è½½æå®çå­æ¡£ï¼`SerializeVersion` å°è¿åä»è¯¥å­æ¡£å è½½ççæ¬ã å¦åï¼å®å°è¿åå½åå è½½ççæ¬ã

### <a name="remarks"></a>å¤æ³¨

æ¨å¯ä»¥ä½¿ç¨ `SerializeVersion`ã`SerializeExtent`å `SerializeStockProps` éå `COleControl::Serialize`æ¥æ¹åæ§ä»¶çäºè¿å¶æä¹æ§æ§è½ã æå³ç¤ºä¾ï¼è¯·åé[SerializeExtent](#serializeextent)ä¸­çä»£ç ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="setappearance"></a>COleControlï¼ï¼ SetAppearance

è®¾ç½®æ§ä»¶ç stock å¤è§å±æ§å¼ã

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>parameters

*sAppearance*<br/>
ç¨äºæ§ä»¶å¤è§ç**ç­**ï¼VT_I2ï¼å¼ã å¦æå¼ä¸ºé¶ï¼åå°æ§ä»¶çå¤è§è®¾ç½®ä¸ºå¹³é¢ï¼å¼ä¸º1æ¶ï¼å°æ§ä»¶çå¤è§è®¾ç½®ä¸ºä¸ç»´ã

### <a name="remarks"></a>å¤æ³¨

æå³å¸¸ç¨å±æ§çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

##  <a name="setbackcolor"></a>COleControlï¼ï¼ SetBackColor

è®¾ç½®æ§ä»¶çå¸¸ç¨èæ¯è²å±æ§å¼ã

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>parameters

*dwBackColor*<br/>
ç¨äºæ§ä»¶çèæ¯ç»å¶ç OLE_COLOR å¼ã

### <a name="remarks"></a>å¤æ³¨

æå³ä½¿ç¨æ­¤å±æ§åå¶ä»ç¸å³å±æ§çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼å±æ§](../../mfc/mfc-activex-controls-properties.md)ä¸æã

##  <a name="setborderstyle"></a>COleControlï¼ï¼ SetBorderStyle

è®¾ç½®æ§ä»¶ç stock æ ·å¼å±æ§å¼ã

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>parameters

*sBorderStyle*<br/>
æ§ä»¶çæ°è¾¹æ¡æ ·å¼;0æç¤ºæ²¡æè¾¹æ¡ï¼1è¡¨ç¤ºæ®éè¾¹æ¡ã

### <a name="remarks"></a>å¤æ³¨

ç¶åï¼å°éæ°åå»ºå¹¶ `OnBorderStyleChanged` è°ç¨æ§ä»¶çªå£ã

##  <a name="setcapture"></a>COleControlï¼ï¼ SetCapture

å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶å æ®é¼ æ æè·ã

```
CWnd* SetCapture();
```

### <a name="return-value"></a>è¿åå¼

ä¸ä¸ªæéï¼æåååæ¥æ¶å°çé¼ æ è¾å¥ `CWnd` çªå£å¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å·²æ¿æ´»ä¸æ çªå£ï¼æ­¤å½æ°ä¼å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»£è¡¨é¼ æ æè·ã å¦åï¼æ­¤å½æ°ä¼ä½¿æ§ä»¶æ¬èº«å æé¼ æ æè·ï¼ä¸ `CWnd::SetCapture`ç¸åï¼ã

##  <a name="setcontrolsize"></a>COleControlï¼ï¼ SetControlSize

è®¾ç½® OLE æ§ä»¶çªå£çå¤§å°ï¼å¹¶éç¥å®¹å¨æ§ä»¶ç½ç«æ­£å¨æ´æ¹ã

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>parameters

*cx*<br/>
æå®æ§ä»¶çæ°å®½åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

*cy*<br/>
æå®æ§ä»¶çæ°é«åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

ä¸åºå¨æ§ä»¶çæé å½æ°ä¸­ä½¿ç¨æ­¤å½æ°ã

è¯·æ³¨æï¼æ§ä»¶çªå£çææåæ é½æ¯ç¸å¯¹äºæ§ä»¶çå·¦ä¸è§çã

##  <a name="setenabled"></a>COleControlï¼ï¼ SetEnabled

è®¾ç½®æ§ä»¶ç "å¯ç¨äºè¡ç¥¨" çå±æ§å¼ã

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>parameters

*bEnabled*<br/>
å¦æè¦å¯ç¨è¯¥æ§ä»¶ï¼åä¸º TRUE;å¦åä¸º FALSEã

### <a name="remarks"></a>å¤æ³¨

è®¾ç½®æ­¤å±æ§åï¼å°è°ç¨ `OnEnabledChange`ã

##  <a name="setfocus"></a>COleControlï¼ï¼ SetFocus

å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶æ¥æè¾å¥ç¦ç¹ã

```
CWnd* SetFocus();
```

### <a name="return-value"></a>è¿åå¼

æåä¹åå·æè¾å¥ç¦ç¹ç `CWnd` çªå£å¯¹è±¡çæé; å¦ææ²¡ææ­¤ç±»çªå£ï¼åä¸º NULLã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å·²æ¿æ´»ä¸æ çªå£ï¼æ­¤å½æ°ä¼ä½¿æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶ä¸çè¾å¥ç¦ç¹ã è¾å¥ç¦ç¹ä¼å°é®çè¾å¥å®åå°å®¹å¨ççªå£ï¼å®¹å¨ä¼å°ææåç»­é®çæ¶æ¯è°åº¦å°è°ç¨ `SetFocus`ç OLE å¯¹è±¡ã ä¹åæè¾å¥ç¦ç¹çä»»ä½çªå£é½å°ä¸¢å¤±å®ã

å¦ææ§ä»¶ä¸æ¯æ çªå£çï¼åæ­¤å½æ°ä¼ä½¿æ§ä»¶æ¬èº«æ¥æè¾å¥ç¦ç¹ï¼ä¸ `CWnd::SetFocus`ç¸åï¼ã

##  <a name="setfont"></a>COleControlï¼ï¼ SetFont

è®¾ç½®æ§ä»¶çå¸¸ç¨å­ä½å±æ§ã

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>parameters

*pFontDisp*<br/>
æåå­ä½è°åº¦æ¥å£çæéã

##  <a name="setforecolor"></a>COleControlï¼ï¼ SetForeColor

è®¾ç½®æ§ä»¶ç "è¡ç¥¨åæ¯è²" å±æ§å¼ã

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>parameters

*dwForeColor*<br/>
ç¨äºæ§ä»¶çåæ¯ç»å¾ç OLE_COLOR å¼ã

### <a name="remarks"></a>å¤æ³¨

æå³ä½¿ç¨æ­¤å±æ§åå¶ä»ç¸å³å±æ§çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼å±æ§](../../mfc/mfc-activex-controls-properties.md)ä¸æã

##  <a name="setinitialdataformats"></a>COleControlï¼ï¼ SetInitialDataFormats

ç±æ¡æ¶è°ç¨ä»¥åå§åæ§ä»¶æ¯æçæ°æ®æ ¼å¼åè¡¨ã

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æå®ä¸¤ç§æ ¼å¼ï¼ CF_METAFILEPICT åæä¹æ§å±æ§éã

##  <a name="setinitialsize"></a>COleControlï¼ï¼ SetInitialSize

è®¾ç½® OLE æ§ä»¶ç¬¬ä¸æ¬¡å¨å®¹å¨ä¸­æ¾ç¤ºæ¶çå¤§å°ã

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>parameters

*cx*<br/>
OLE æ§ä»¶çåå§å®½åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

*cy*<br/>
OLE æ§ä»¶çåå§é«åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

### <a name="remarks"></a>å¤æ³¨

å¨æé å½æ°ä¸­è°ç¨æ­¤å½æ°å¯è®¾ç½®æ§ä»¶çåå§å¤§å°ã åå§å¤§å°ä»¥è®¾å¤åä½æåç´ ä¸ºåä½ã å»ºè®®å¨æ§ä»¶çæé å½æ°ä¸­è¿è¡æ­¤è°ç¨ã

##  <a name="setmodifiedflag"></a>COleControlï¼ï¼ SetModifiedFlag

æ´æ¹æ§ä»¶çä¿®æ¹ç¶æã

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>parameters

*bModified*<br/>
æ§ä»¶çå·²ä¿®æ¹æ å¿çæ°å¼ã å¦æä¸º TRUEï¼åè¡¨ç¤ºå·²ä¿®æ¹æ§ä»¶çç¶æ;FALSE æç¤ºæ§ä»¶çç¶æååä¿å­ã

### <a name="remarks"></a>å¤æ³¨

æ¯å½åçä¼å½±åæ§ä»¶æä¹ç¶æçæ´æ¹æ¶è°ç¨æ­¤å½æ°ã ä¾å¦ï¼å¦ææ°¸ä¹æ§å±æ§çå¼åçæ´æ¹ï¼åä½¿ç¨*bModified* **TRUE**è°ç¨æ­¤å½æ°ã

##  <a name="setnotpermitted"></a>COleControlï¼ï¼ SetNotPermitted

æç¤ºç¼è¾è¯·æ±å¤±è´¥ã

```
void SetNotPermitted();
```

### <a name="remarks"></a>å¤æ³¨

å¦æ `BoundPropertyRequestEdit` å¤±è´¥ï¼è¯·è°ç¨æ­¤å½æ°ã æ­¤å½æ°å¼åç±»å `COleDispScodeException` çå¼å¸¸ï¼ä»¥æç¤ºä¸åè®¸è®¾ç½®æä½ã

##  <a name="setnotsupported"></a>COleControlï¼ï¼ SetNotSupported

é²æ­¢ç¨æ·ä¿®æ¹æ§ä»¶çå±æ§å¼ã

```
void SetNotSupported();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»¥ä»£æ¿ä»»ä½å±æ§ç Set å½æ°ï¼ä½ä¸æ¯æå¯¹æ§ä»¶çç¨æ·ä¿®æ¹å±æ§å¼ã ä¸ä¸ªç¤ºä¾æ¯åªè¯»å±æ§ã

##  <a name="setrectincontainer"></a>COleControlï¼ï¼ SetRectInContainer

è®¾ç½®æ§ä»¶ç©å½¢ç¸å¯¹äºå®¹å¨çåæ ï¼ä»¥è®¾å¤åä½è¡¨ç¤ºã

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>parameters

*lpRect*<br/>
æåä¸ä¸ªç©å½¢çæéï¼è¯¥ç©å½¢åå«æ§ä»¶çæ°åæ ï¼ç¸å¯¹äºå®¹å¨ï¼ã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åä¸ºéé¶å¼;å¦åä¸º0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å¤äºæå¼ç¶æï¼åè°æ´å¶å¤§å°;å¦åï¼å°è°ç¨å®¹å¨ç `OnPosRectChanged` å½æ°ã

##  <a name="settext"></a>COleControlï¼ï¼ SetText

è®¾ç½®æ§ä»¶çå¸¸ç¨æ é¢æææ¬å±æ§çå¼ã

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>parameters

*pszText*<br/>
æåå­ç¬¦ä¸²çæéã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼stock æ é¢åææ¬å±æ§é½æ å°å°ç¸åçå¼ã è¿æå³çå¯¹ä»»ä¸å±æ§æåçä»»ä½æ´æ¹é½å°èªå¨æ´æ¹è¿ä¸¤ç§å±æ§ã éå¸¸ï¼æ§ä»¶åºæ¯æ stock æ é¢æææ¬å±æ§ï¼ä½ä¸è½åæ¶æ¯æä¸¤èã

##  <a name="throwerror"></a>COleControlï¼ï¼ ThrowError

æç¤ºæ§ä»¶ä¸­åºç°éè¯¯ã

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>parameters

*sc*<br/>
è¦æ¥åçç¶æä»£ç å¼ã æå³å¯è½ä»£ç çå®æ´åè¡¨ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼é«çº§ä¸»é¢](../../mfc/mfc-activex-controls-advanced-topics.md)ã

*nDescriptionID*<br/>
è¦æ¥åçå¼å¸¸çå­ç¬¦ä¸²èµæº IDã

*nHelpID*<br/>
è¦æ¥åçä¸»é¢çå¸®å© IDã

*pszDescription*<br/>
ä¸ä¸ªå­ç¬¦ä¸²ï¼å¶ä¸­åå«è¦æ¥åçå¼å¸¸çè¯´æã

### <a name="remarks"></a>å¤æ³¨

åªåºä» OLE å±æ§ç Get æ Set å½æ°ä¸­è°ç¨æ­¤å½æ°ï¼æèä» OLE èªå¨åæ¹æ³çå®ç°ä¸­è°ç¨æ­¤å½æ°ã å¦æéè¦ååºå¶ä»æ¶é´åççä¿¡å·éè¯¯ï¼åºæ¿å stock éè¯¯äºä»¶ã

##  <a name="transformcoords"></a>COleControlï¼ï¼ TransformCoords

è½¬æ¢ HIMETRIC ååä¸å®¹å¨çæ¬æºåä½ä¹é´çåæ å¼ã

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>parameters

*lpptlHimetric*<br/>
æå `POINTL` ç»æçæéï¼è¯¥ç»æåå« HIMETRIC åä½ä¸­çåæ ã

*lpptfContainer*<br/>
æå `POINTF` ç»æçæéï¼è¯¥ç»æåå«å®¹å¨çååå¤§å°çåæ ã

*flag*<br/>
ä»¥ä¸å¼çç»åï¼

- XFORMCOORDS_POSITION å®¹å¨ä¸­çä½ç½®ã

- XFORMCOORDS_SIZE å®¹å¨ä¸­çå¤§å°ã

- XFORMCOORDS_HIMETRICTOCONTAINER å° HIMETRIC åä½è½¬æ¢ä¸ºå®¹å¨çåä½ã

- XFORMCOORDS_CONTAINERTOHIMETRIC å°å®¹å¨çåä½è½¬æ¢ä¸º HIMETRIC ååã

### <a name="remarks"></a>å¤æ³¨

åä¸¤ä¸ªæ å¿ "XFORMCOORDS_POSITION" å "XFORMCOORDS_SIZE" æç¤ºæ¯å¦åºå°åæ è§ä¸ºä½ç½®æå¤§å°ã å¶ä½ä¸¤ä¸ªæ å¿æç¤ºè½¬æ¢çæ¹åã

##  <a name="translatecolor"></a>COleControlï¼ï¼ TranslateColor

å° OLE_COLOR æ°æ®ç±»åçé¢è²å¼è½¬æ¢ä¸º[COLORREF](/windows/win32/gdi/colorref)æ°æ®ç±»åã

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>parameters

*clrColor*<br/>
ä¸ä¸ª OLE_COLOR æ°æ®ç±»åã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)å½æ°ã

*hpal*<br/>
å¯éè°è²æ¿çå¥æ;å¯ä»¥ä¸º NULLã

### <a name="return-value"></a>è¿åå¼

RGB ï¼çº¢ãç»¿ãèï¼32ä½é¢è²å¼ï¼ç¨äºå®ä¹ä¸è®¾å¤å¯è¡¨ç¤ºç*clrColor*å¼ææ¥è¿ççº¯è²ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°å¯ç¨äºå°åºå­åæ¯è²åèæ¯è²å±æ§è½¬æ¢ä¸º[CDC](../../mfc/reference/cdc-class.md)æåå½æ°ä½¿ç¨ç COLORREF ç±»åã

##  <a name="willambientsbevalidduringload"></a>COleControlï¼ï¼ WillAmbientsBeValidDuringLoad

ç¡®å®æ§ä»¶æ¯å¦åºä½¿ç¨ç¯å¢å±æ§çå¼ä½ä¸ºé»è®¤å¼ï¼å½å®éåä»å¶æä¹æ§ç¶æå è½½æ¶ï¼ã

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>è¿åå¼

éé¶è¡¨ç¤ºç¯å¢å±æ§å°ææ;å¦åï¼ç¯å¢å±æ§å°æ æã

### <a name="remarks"></a>å¤æ³¨

å¨æäºå®¹å¨ä¸­ï¼å¨é¦æ¬¡è°ç¨ `COleControl::DoPropExchange`çéåè¿ç¨ä¸­ï¼æ§ä»¶å¯è½æ æ³è®¿é®å¶ç¯å¢å±æ§ã å¦æå®¹å¨å¨è°ç¨[IOleObjectï¼ï¼ SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)ä¹åè°ç¨[IPersistStreamInitï¼ï¼ load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)æ[IPersistStorageï¼ï¼ load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) ï¼å°±ä¼åºç°è¿ç§æåµï¼å³ï¼å¦æå®ä¸æä» OLEMISC_SETCLIENTSITEFIRST ç¶æä½ï¼ã

##  <a name="windowproc"></a>COleControlï¼ï¼ WindowProc

ä¸º `COleControl` å¯¹è±¡æä¾ Windows è¿ç¨ã

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>parameters

message<br/>
æå®è¦å¤çç Windows æ¶æ¯ã

*wParam*<br/>
æä¾å¤çæ¶æ¯æ¶ä½¿ç¨çå¶ä»ä¿¡æ¯ã åæ°å¼åå³äºæ¶æ¯ã

*lParam*<br/>
æä¾å¤çæ¶æ¯æ¶ä½¿ç¨çå¶ä»ä¿¡æ¯ã åæ°å¼åå³äºæ¶æ¯ã

### <a name="return-value"></a>è¿åå¼

å·²è°åº¦æ¶æ¯çè¿åå¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯éè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦ç¹å®æ¶æ¯ã

## <a name="see-also"></a>å¦è¯·åé

[MFC ç¤ºä¾ CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC ç¤ºä¾ TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage ç±»](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd ç±»](../../mfc/reference/cwnd-class.md)<br/>
[å±æ¬¡ç»æå¾](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder ç±»](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder ç±»](../../mfc/reference/cpictureholder-class.md)<br/>
