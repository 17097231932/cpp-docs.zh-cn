---
title: COleIPFrameWndEx 类
ms.date: 11/04/2016
f1_keywords:
- COleIPFrameWndEx
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddDockSite
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AdjustDockingLayout
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPaneLeftOf
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableAutoHidePanes
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableDocking
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnablePaneMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetActivePopup
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetContainerFrameWindow
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDefaultResId
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockingManager
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMainFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMenuBar
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetTearOffBars
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetToolbarButtonToolTipText
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InsertPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsMenuBarAvailable
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsPointNearDockSite
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::LoadFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseDockingPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseMiniFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnClosePopupMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCmdMsg
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuImage
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuLogo
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMenuButtonToolHitTest
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMoveMiniFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnSetPreviewMode
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowCustomizePane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPanes
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPopupMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnTearOffMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PaneFromPoint
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PreTranslateMessage
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RecalcLayout
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RemovePaneFromDockManager
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetDockState
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetupToolbarMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::ShowPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::WinHelpA
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InitUserToobars
helpviewer_keywords:
- COleIPFrameWndEx [MFC], AddDockSite
- COleIPFrameWndEx [MFC], AddPane
- COleIPFrameWndEx [MFC], AdjustDockingLayout
- COleIPFrameWndEx [MFC], DockPane
- COleIPFrameWndEx [MFC], DockPaneLeftOf
- COleIPFrameWndEx [MFC], EnableAutoHidePanes
- COleIPFrameWndEx [MFC], EnableDocking
- COleIPFrameWndEx [MFC], EnablePaneMenu
- COleIPFrameWndEx [MFC], GetActivePopup
- COleIPFrameWndEx [MFC], GetContainerFrameWindow
- COleIPFrameWndEx [MFC], GetDefaultResId
- COleIPFrameWndEx [MFC], GetDockFrame
- COleIPFrameWndEx [MFC], GetDockingManager
- COleIPFrameWndEx [MFC], GetMainFrame
- COleIPFrameWndEx [MFC], GetMenuBar
- COleIPFrameWndEx [MFC], GetPane
- COleIPFrameWndEx [MFC], GetTearOffBars
- COleIPFrameWndEx [MFC], GetToolbarButtonToolTipText
- COleIPFrameWndEx [MFC], InsertPane
- COleIPFrameWndEx [MFC], IsMenuBarAvailable
- COleIPFrameWndEx [MFC], IsPointNearDockSite
- COleIPFrameWndEx [MFC], LoadFrame
- COleIPFrameWndEx [MFC], OnCloseDockingPane
- COleIPFrameWndEx [MFC], OnCloseMiniFrame
- COleIPFrameWndEx [MFC], OnClosePopupMenu
- COleIPFrameWndEx [MFC], OnCmdMsg
- COleIPFrameWndEx [MFC], OnDrawMenuImage
- COleIPFrameWndEx [MFC], OnDrawMenuLogo
- COleIPFrameWndEx [MFC], OnMenuButtonToolHitTest
- COleIPFrameWndEx [MFC], OnMoveMiniFrame
- COleIPFrameWndEx [MFC], OnSetPreviewMode
- COleIPFrameWndEx [MFC], OnShowCustomizePane
- COleIPFrameWndEx [MFC], OnShowPanes
- COleIPFrameWndEx [MFC], OnShowPopupMenu
- COleIPFrameWndEx [MFC], OnTearOffMenu
- COleIPFrameWndEx [MFC], PaneFromPoint
- COleIPFrameWndEx [MFC], PreTranslateMessage
- COleIPFrameWndEx [MFC], RecalcLayout
- COleIPFrameWndEx [MFC], RemovePaneFromDockManager
- COleIPFrameWndEx [MFC], SetDockState
- COleIPFrameWndEx [MFC], SetupToolbarMenu
- COleIPFrameWndEx [MFC], ShowPane
- COleIPFrameWndEx [MFC], WinHelpA
- COleIPFrameWndEx [MFC], InitUserToobars
ms.assetid: ebff1560-a1eb-4854-af00-95d4a192bd55
ms.openlocfilehash: 71c0db8d059ede0016caf7ceb72c7f3ab7da2718
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426881"
---
# <a name="coleipframewndex-class"></a>COleIPFrameWndEx 类

`COleIPFrameWndEx` 类实现支持 MFC 的 OLE 容器。 必须从 `COleIPFrameWndEx` 类派生应用程序的就地框架窗口类，而不是从 [COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)类派生。
有关更多详细信息，请参阅位于你的 Visual Studio 安装的**VC\\atlmfc\\src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class COleIPFrameWndEx : public COleIPFrameWnd
```

## <a name="members"></a>成员

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[COleIPFrameWndEx::AddDockSite](#adddocksite)||
|[COleIPFrameWndEx::AddPane](#addpane)||
|[COleIPFrameWndEx：： AdjustDockingLayout](#adjustdockinglayout)||
|[COleIPFrameWndEx：:D ockPane](#dockpane)||
|[COleIPFrameWndEx：:D ockPaneLeftOf](#dockpaneleftof)|将一个窗格停靠到另一个窗格的左侧。|
|[COleIPFrameWndEx::EnableAutoHidePanes](#enableautohidepanes)||
|[COleIPFrameWndEx：： EnableDocking](#enabledocking)||
|[COleIPFrameWndEx::EnablePaneMenu](#enablepanemenu)||
|[COleIPFrameWndEx::GetActivePopup](#getactivepopup)|返回一个指向当前显示的弹出菜单的指针。|
|[COleIPFrameWndEx::GetContainerFrameWindow](#getcontainerframewindow)||
|[COleIPFrameWndEx::GetDefaultResId](#getdefaultresid)|返回加载窗口时你指定的框架窗口的资源 ID。|
|[COleIPFrameWndEx::GetDockFrame](#getdockframe)||
|[COleIPFrameWndEx::GetDockingManager](#getdockingmanager)||
|[COleIPFrameWndEx::GetMainFrame](#getmainframe)||
|[COleIPFrameWndEx::GetMenuBar](#getmenubar)|返回一个指向附加到框架窗口的菜单栏对象的指针。|
|[COleIPFrameWndEx::GetPane](#getpane)||
|[COleIPFrameWndEx::GetTearOffBars](#gettearoffbars)|返回处于拖曳状态的窗格对象的列表。|
|[COleIPFrameWndEx::GetToolbarButtonToolTipText](#gettoolbarbuttontooltiptext)|在显示按钮的工具提示之前由框架调用。|
|[COleIPFrameWndEx::InsertPane](#insertpane)||
|[COleIPFrameWndEx::IsMenuBarAvailable](#ismenubaravailable)|确定指向菜单栏对象的指针是否不是 `NULL`。|
|[COleIPFrameWndEx::IsPointNearDockSite](#ispointneardocksite)||
|[COleIPFrameWndEx::LoadFrame](#loadframe)|（重写 `COleIPFrameWnd::LoadFrame`。）|
|[COleIPFrameWndEx::OnCloseDockingPane](#onclosedockingpane)||
|[COleIPFrameWndEx::OnCloseMiniFrame](#oncloseminiframe)||
|[COleIPFrameWndEx::OnClosePopupMenu](#onclosepopupmenu)|当活动的弹出菜单处理 WM_DESTROY 消息时由框架调用。|
|[COleIPFrameWndEx：： OnCmdMsg](#oncmdmsg)|（重写 `CFrameWnd::OnCmdMsg`。）|
|[COleIPFrameWndEx：： OnDrawMenuImage](#ondrawmenuimage)|当绘制与菜单项关联的图像时由框架调用。|
|[COleIPFrameWndEx::OnDrawMenuLogo](#ondrawmenulogo)|当 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)对象处理 WM_PAINT 消息时由框架调用。|
|[COleIPFrameWndEx::OnMenuButtonToolHitTest](#onmenubuttontoolhittest)|当 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)对象处理 WM_NCHITTEST 消息时由框架调用。|
|[COleIPFrameWndEx::OnMoveMiniFrame](#onmoveminiframe)||
|[COleIPFrameWndEx：： OnSetPreviewMode](#onsetpreviewmode)|调用该成员函数以设置应用程序主框架窗口打印预览模式的流入和流出。 （重写 [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。）|
|[COleIPFrameWndEx::OnShowCustomizePane](#onshowcustomizepane)||
|[COleIPFrameWndEx::OnShowPanes](#onshowpanes)||
|[COleIPFrameWndEx::OnShowPopupMenu](#onshowpopupmenu)|当激活弹出菜单时由框架调用。|
|[COleIPFrameWndEx::OnTearOffMenu](#ontearoffmenu)|当激活带有拖曳栏的菜单时由框架调用。|
|[COleIPFrameWndEx：:P aneFromPoint](#panefrompoint)||
|[COleIPFrameWndEx：:P reTranslateMessage](#pretranslatemessage)|（重写 `COleIPFrameWnd::PreTranslateMessage`。）|
|[COleIPFrameWndEx：： RecalcLayout](#recalclayout)|（重写 `COleIPFrameWnd::RecalcLayout`。）|
|[COleIPFrameWndEx::RemovePaneFromDockManager](#removepanefromdockmanager)||
|[COleIPFrameWndEx::SetDockState](#setdockstate)|将指定的停靠状态应用于属于框架窗口的窗格。|
|[COleIPFrameWndEx::SetupToolbarMenu](#setuptoolbarmenu)|通过搜索虚拟项并将其替换为指定的用户定义项修改工具栏对象。|
|[COleIPFrameWndEx::ShowPane](#showpane)||
|[COleIPFrameWndEx::WinHelpA](#winhelpa)|由框架调用以启动 WinHelp 应用程序或上下文帮助。|

### <a name="protected-methods"></a>受保护方法

|名称|说明|
|----------|-----------------|
|[COleIPFrameWndEx::InitUserToobars](#initusertoobars)|告知框架初始化一系列分配给用户定义的工具栏的控件 ID。|

## <a name="example"></a>示例

下面的示例演示如何将 `COleIPFrameWndEx` 类的实例作为子类并重写其方法。 该示例演示如何重写 `OnDestory` 方法、 `RepositionFrame` 方法、 `RecalcLayout` 方法和 `CalcWindowRect` 方法。 此代码片段属于 [Word Pad 示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_WordPad#1](../../mfc/reference/codesnippet/cpp/coleipframewndex-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)

[COleIPFrameWndEx](../../mfc/reference/coleipframewndex-class.md)

## <a name="requirements"></a>要求

**标头：** afxoleipframewndex.h

##  <a name="adddocksite"></a>COleIPFrameWndEx::AddDockSite

```
void AddDockSite();
```

### <a name="remarks"></a>备注

##  <a name="addpane"></a>COleIPFrameWndEx::AddPane

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail = TRUE);
```

### <a name="parameters"></a>parameters

中*pControlBar*<br/>
中*bTail*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="adjustdockinglayout"></a>COleIPFrameWndEx：： AdjustDockingLayout

```
virtual void AdjustDockingLayout(HDWP hdwp = NULL);
```

### <a name="parameters"></a>parameters

中*hdwp*<br/>

### <a name="remarks"></a>备注

##  <a name="dockpane"></a>COleIPFrameWndEx：:D ockPane

```
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID = 0,
    LPCRECT lpRect = NULL);
```

### <a name="parameters"></a>parameters

中*pBar*<br/>
中*nDockBarID*<br/>
中*lpRect*<br/>

### <a name="remarks"></a>备注

##  <a name="dockpaneleftof"></a>COleIPFrameWndEx：:D ockPaneLeftOf

将一个窗格停靠到另一个窗格的左侧。

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>parameters

*pBar*<br/>
中指向要停靠的窗格的指针。

*pLeftOf*<br/>
中指向用作原点的窗格的指针。

### <a name="return-value"></a>返回值

如果操作成功，则返回 TRUE。 否则返回 FALSE。

### <a name="remarks"></a>备注

调用此方法以按预定义顺序停靠若干窗格对象。 此方法将*pBar*指定的窗格停靠在*pLeftOf*指定的窗格的左侧。

##  <a name="enableautohidepanes"></a>COleIPFrameWndEx::EnableAutoHidePanes

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>parameters

中*dwDockStyle*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="enabledocking"></a>COleIPFrameWndEx：： EnableDocking

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>parameters

中*dwDockStyle*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="enablepanemenu"></a>COleIPFrameWndEx::EnablePaneMenu

```
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly = FALSE,
    BOOL bViewMenuShowsToolbarsOnly = FALSE);
```

### <a name="parameters"></a>parameters

中*bEnable*<br/>
中*uiCustomizeCmd*<br/>
中*strCustomizeLabel*<br/>
中*uiViewToolbarsMenuEntryID*<br/>
中*bContextMenuShowsToolbarsOnly*<br/>
中*bViewMenuShowsToolbarsOnly*<br/>

### <a name="remarks"></a>备注

##  <a name="getactivepopup"></a>COleIPFrameWndEx::GetActivePopup

返回一个指向当前显示的弹出菜单的指针。

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>返回值

指向活动弹出菜单的指针;否则为 NULL。

### <a name="remarks"></a>备注

使用此方法可获取指向当前显示的[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象的指针。

##  <a name="getcontainerframewindow"></a>COleIPFrameWndEx::GetContainerFrameWindow

```
COleCntrFrameWndEx* GetContainerFrameWindow();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getdefaultresid"></a>COleIPFrameWndEx::GetDefaultResId

返回在框架窗口加载菜单时指定的菜单资源 ID。

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>返回值

返回菜单的资源 ID; 如果框架窗口没有菜单栏，则返回0。

### <a name="remarks"></a>备注

调用此函数可检索框架窗口在通过调用 `COleIPFrameWndEx::LoadFrame`加载菜单资源时指定的资源 ID。

##  <a name="getdockframe"></a>COleIPFrameWndEx::GetDockFrame

```
CFrameWnd* GetDockFrame();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getdockingmanager"></a>COleIPFrameWndEx::GetDockingManager

```
CDockingManager* GetDockingManager();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getmainframe"></a>COleIPFrameWndEx::GetMainFrame

```
CFrameWnd* GetMainFrame();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getmenubar"></a>COleIPFrameWndEx::GetMenuBar

返回一个指向附加到框架窗口的菜单栏对象的指针。

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>返回值

指向菜单栏对象的指针。

### <a name="remarks"></a>备注

使用此函数可检索指向 `COleIPFrameWndEx` 对象的菜单栏对象的指针。

##  <a name="getpane"></a>COleIPFrameWndEx::GetPane

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>parameters

中*nID*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="gettearoffbars"></a>COleIPFrameWndEx::GetTearOffBars

返回处于拖曳状态的窗格对象的列表。

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>返回值

对 `CObList` 对象的引用，该对象包含指向[CBasePane 类](../../mfc/reference/cbasepane-class.md)派生对象的指针的集合。

### <a name="remarks"></a>备注

`COleIPFrameWndEx` 对象将被取消的菜单的集合作为[CBasePane 类](../../mfc/reference/cbasepane-class.md)派生对象的列表进行维护。 使用此方法可检索此列表的引用。

##  <a name="gettoolbarbuttontooltiptext"></a>COleIPFrameWndEx::GetToolbarButtonToolTipText

在显示按钮的工具提示之前由框架调用。

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>parameters

*pButton*<br/>
中指向按钮的指针。

*strTTText*<br/>
中指向工具提示文本的指针。

### <a name="return-value"></a>返回值

默认实现返回0。

### <a name="remarks"></a>备注

重写此函数以自定义工具栏按钮上的工具提示显示。

##  <a name="initusertoobars"></a>COleIPFrameWndEx::InitUserToobars

指定框架分配给用户定义的工具栏的控件 Id 的范围。

```
void InitUserToolbars(
    LPCTSTR lpszRegEntry,
    UINT uiUserToolbarFirst,
    UINT uiUserToolbarLast)
```

### <a name="parameters"></a>parameters

*lpszRegEntry*<br/>
中库存储用户工具栏设置的注册表项。

*uiUserToolbarFirst*<br/>
中分配给第一个用户定义的工具栏的控件 ID。

*uiUserToolbarLast*<br/>
中分配给最后一个用户定义的工具栏的控件 ID。

### <a name="remarks"></a>备注

使用此函数可初始化用于分配给用户动态定义的工具栏的一系列控件 Id。 参数*uiUserToolbarFirst*和*uiUserToolbarLast*定义了一系列允许的工具栏控件 id。 若要禁用用户定义的工具栏的创建，请将*uiUserToolbarFirst*或*uiUserToolbarLast*设置为-1。

##  <a name="insertpane"></a>COleIPFrameWndEx::InsertPane

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter = TRUE);
```

### <a name="parameters"></a>parameters

中*pControlBar*<br/>
中*pTarget*<br/>
中*bAfter*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="ismenubaravailable"></a>COleIPFrameWndEx::IsMenuBarAvailable

确定指向菜单栏对象的指针是否不为 NULL

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>返回值

如果框架窗口具有菜单栏，则返回非零值;否则，返回0。

### <a name="remarks"></a>备注

调用此方法可确定框架窗口是否维护其菜单栏对象的非 NULL 指针。

##  <a name="ispointneardocksite"></a>COleIPFrameWndEx::IsPointNearDockSite

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>parameters

中*点*<br/>
中*dwBarAlignment*<br/>
中*bOuterEdge*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="loadframe"></a>COleIPFrameWndEx::LoadFrame

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>parameters

中*nIDResource*<br/>
中*dwDefaultStyle*<br/>
中*pParentWnd*<br/>
中*pContext*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onclosedockingpane"></a>COleIPFrameWndEx::OnCloseDockingPane

```
virtual BOOL OnCloseDockingPane(CDockablePane*);
```

### <a name="parameters"></a>parameters

中*CDockablePane&#42;*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="oncloseminiframe"></a>COleIPFrameWndEx::OnCloseMiniFrame

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### <a name="parameters"></a>parameters

中*CPaneFrameWnd&#42;*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onclosepopupmenu"></a>COleIPFrameWndEx::OnClosePopupMenu

当活动的弹出菜单处理 WM_DESTROY 消息时由框架调用。

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>parameters

*pMenuPopup*<br/>
中指向弹出菜单对象的指针。

### <a name="remarks"></a>备注

重写此方法，以便在处理 WM_DESTROY 消息时接收来自 `CMFCPopupMenu` 对象的通知。

##  <a name="oncmdmsg"></a>COleIPFrameWndEx：： OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>parameters

中*nID*<br/>
中*nCode*<br/>
中*pExtra*<br/>
中*pHandlerInfo*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="ondrawmenuimage"></a>COleIPFrameWndEx：： OnDrawMenuImage

当绘制与菜单项关联的图像时由框架调用。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*pMenuButton*<br/>
中指向菜单按钮的指针。

*rectImage*<br/>
中与菜单项关联的图像。

### <a name="return-value"></a>返回值

默认实现不执行任何操作并返回0。

### <a name="remarks"></a>备注

如果要为属于由 `COleIPFrameWndEx`派生的对象所拥有的菜单栏的菜单项自定义图像绘制，请重写此方法。

##  <a name="ondrawmenulogo"></a>COleIPFrameWndEx::OnDrawMenuLogo

当 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)对象处理 WM_PAINT 消息时由框架调用。

```
virtual void OnDrawMenuLogo(
    CDC* pDC,
    CMFCPopupMenu* pMenu,
    const CRect& rectLogo);
```

### <a name="parameters"></a>parameters

*pDC*<br/>
中指向设备上下文的指针。

*pMenu*<br/>
中指向弹出菜单对象的指针。

*rectLogo*<br/>
中指向要显示的徽标的指针。

### <a name="remarks"></a>备注

重写此方法以在与由 `COleIPFrameWndEx`派生的对象所拥有的菜单栏相关联的弹出菜单上显示徽标。 默认实现不执行任何操作。

##  <a name="onmenubuttontoolhittest"></a>COleIPFrameWndEx::OnMenuButtonToolHitTest

当[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)对象处理 WM_NCHITTEST 消息时由框架调用。

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>parameters

[in] pButton 指向菜单按钮的指针。

[out] 指向 `TOOLINFO` 结构的 pTI 指针。

### <a name="return-value"></a>返回值

默认实现不执行任何操作并返回0。 如果填充*pTI*参数，则实现应返回非零值。

### <a name="remarks"></a>备注

重写此方法以提供有关特定菜单项的工具提示信息。

##  <a name="onmoveminiframe"></a>COleIPFrameWndEx::OnMoveMiniFrame

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>parameters

中*pFrame*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onsetpreviewmode"></a>COleIPFrameWndEx：： OnSetPreviewMode

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>parameters

中*bPreview*<br/>
中*pState*<br/>

### <a name="remarks"></a>备注

##  <a name="onshowcustomizepane"></a>COleIPFrameWndEx::OnShowCustomizePane

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>parameters

中*pMenuPane*<br/>
中*uiToolbarID*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onshowpanes"></a>COleIPFrameWndEx::OnShowPanes

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>parameters

中*bShow*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onshowpopupmenu"></a>COleIPFrameWndEx::OnShowPopupMenu

当显示弹出菜单时由框架调用。

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>parameters

*pMenuPopup*<br/>
中指向要显示的弹出菜单的指针。

### <a name="return-value"></a>返回值

默认实现不执行任何操作，并返回一个非零值。 如果无法显示弹出菜单，则实现应返回 FALSE。

### <a name="remarks"></a>备注

重写此方法以自定义弹出菜单的显示。 例如，您可以将菜单按钮更改为彩色菜单按钮或初始化撕块。

##  <a name="ontearoffmenu"></a>COleIPFrameWndEx::OnTearOffMenu

当用户选择具有撕条的菜单时由框架调用。

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>parameters

*pMenuPopup*<br/>
中指向用户选择的弹出菜单的指针。

*pBar*<br/>
中指向承载菜单的窗格的指针。

### <a name="return-value"></a>返回值

如果希望框架激活弹出菜单，则为 TRUE; 否则为。否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

如果要自定义脱离栏的设置，请重写此函数。

##  <a name="panefrompoint"></a>COleIPFrameWndEx：:P aneFromPoint

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>parameters

中*点*<br/>
中*nSensitivity*<br/>
中*bExactBar*<br/>
中*pRTCBarType*<br/>
中*dwAlignment*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="pretranslatemessage"></a>COleIPFrameWndEx：:P reTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>parameters

中*pMsg*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="recalclayout"></a>COleIPFrameWndEx：： RecalcLayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>parameters

中*bNotify*<br/>

### <a name="remarks"></a>备注

##  <a name="removepanefromdockmanager"></a>COleIPFrameWndEx::RemovePaneFromDockManager

```
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>parameters

中*pControlBar*<br/>
中*bDestroy*<br/>
中*bAdjustLayout*<br/>
中*bAutoHide*<br/>
中*pBarReplacement*<br/>

### <a name="remarks"></a>备注

##  <a name="setdockstate"></a>COleIPFrameWndEx::SetDockState

将指定的停靠状态应用于属于框架窗口的窗格。

```
void SetDockState(const CDockState& state);
```

### <a name="parameters"></a>parameters

State<br/>
中指定停靠状态。

### <a name="remarks"></a>备注

使用此函数为属于 `COleIPFrameWndEx` 对象的窗格指定新的停靠状态。

##  <a name="setuptoolbarmenu"></a>COleIPFrameWndEx::SetupToolbarMenu

通过搜索虚拟项并将其替换为指定的用户定义项修改工具栏对象。

```
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>parameters

*下拉菜单*<br/>
中对要修改的[CMenu](../../mfc/reference/cmenu-class.md)对象的引用。

*uiViewUserToolbarCmdFirst*<br/>
中指定第一个用户定义的命令。

*uiViewUserToolbarCmdLast*<br/>
中指定最后一个用户定义的命令。

### <a name="remarks"></a>备注

##  <a name="showpane"></a>COleIPFrameWndEx::ShowPane

```
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>parameters

中*pBar*<br/>
中*bShow*<br/>
中*bDelay*<br/>
中*bActivate*<br/>

### <a name="remarks"></a>备注

##  <a name="winhelpa"></a>COleIPFrameWndEx::WinHelpA

由框架调用以启动 WinHelp 应用程序或上下文帮助。

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>parameters

[in] dwData 根据*nCmd*指定的帮助类型的要求指定数据。

*nCmd*<br/>
中指定请求的帮助的类型。 有关可能值的列表以及这些值如何影响*dwData*参数，请参阅 Windows SDK 中的[WinHelp 函数](/windows/win32/api/winuser/nf-winuser-winhelpw)。

### <a name="remarks"></a>备注

## <a name="see-also"></a>另请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CFrameWndEx 类](../../mfc/reference/cframewndex-class.md)<br/>
[CMDIFrameWndEx 类](../../mfc/reference/cmdiframewndex-class.md)
