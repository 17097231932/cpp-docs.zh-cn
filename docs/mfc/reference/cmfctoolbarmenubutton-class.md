---
title: CMFCToolBarMenuButton 类 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 07b582c8b785adb13acce86497d898c183b3128b
ms.sourcegitcommit: 9a0905c03a73c904014ec9fd3d6e59e4fa7813cd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/29/2018
ms.locfileid: "43205140"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton 类
包含一个弹出菜单的工具栏按钮。  
 有关更多详细信息，请参阅中的源代码**VC\\atlmfc\\src\\mfc**的 Visual Studio 安装文件夹。  
  
## <a name="syntax"></a>语法  
  
```  
class CMFCToolBarMenuButton : public CMFCToolBarButton  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|构造 `CMFCToolBarMenuButton` 对象。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::CompareWith](#comparewith)|将此实例与所提供`CMFCToolBarButton`对象。 (重写[CMFCToolBarButton::CompareWith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith)。)|  
|[Cmfctoolbarmenubutton:: Copyfrom](#copyfrom)|将另一个工具栏按钮的属性复制到当前按钮。 (重写[CMFCToolBarButton::CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)。)|  
|[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)|初始化从 Windows 菜单句柄的工具栏菜单。|  
|[CMFCToolBarMenuButton::CreateMenu](#createmenu)|创建一个 Windows 菜单中的工具栏菜单的命令组成。 返回的句柄的 Windows 菜单。|  
|[Cmfctoolbarmenubutton:: Createpopupmenu](#createpopupmenu)|创建弹出菜单对象 ( [CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)) 以显示工具栏菜单。|  
|[CMFCToolBarMenuButton::EnableQuickCustomize](#enablequickcustomize)||  
|[CMFCToolBarMenuButton::GetCommands](#getcommands)|中的工具栏菜单的命令列表中，只读访问。|  
|[CMFCToolBarMenuButton::GetImageRect](#getimagerect)|检索按钮图像的边框。|  
|[CMFCToolBarMenuButton::GetPaletteRows](#getpaletterows)|菜单在调色板模式下时，请在弹出菜单中返回行的数。|  
|[CMFCToolBarMenuButton::GetPopupMenu](#getpopupmenu)|返回一个指向与按钮相关联的弹出菜单对象。|  
|[CMFCToolBarMenuButton::HasButton](#hasbutton)||  
|[CMFCToolBarMenuButton::HaveHotBorder](#havehotborder)|确定当用户选择按钮时是否显示按钮的边框。 (重写[CMFCToolBarButton::HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder)。)|  
|[CMFCToolBarMenuButton::IsBorder](#isborder)||  
|[CMFCToolBarMenuButton::IsClickedOnMenu](#isclickedonmenu)||  
|[CMFCToolBarMenuButton::IsDroppedDown](#isdroppeddown)|确定是否显示弹出菜单。|  
|[Cmfctoolbarmenubutton:: Isemptymenuallowed](#isemptymenuallowed)|由框架调用以确定用户是否可以从所选的菜单项打开子菜单。|  
|[CMFCToolBarMenuButton::IsExclusive](#isexclusive)|确定按钮是否在独占模式下，也就是说，即使用户将指针移到另一个工具栏或按钮上的弹出菜单是否保持打开。|  
|[CMFCToolBarMenuButton::IsMenuPaletteMode](#ismenupalettemode)|确定弹出菜单是否处于调色板模式。|  
|[CMFCToolBarMenuButton::IsQuickMode](#isquickmode)||  
|[CMFCToolBarMenuButton::IsTearOffMenu](#istearoffmenu)|确定弹出菜单是否具有拖曳栏。|  
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||  
|[CMFCToolBarMenuButton::OnBeforeDrag](#onbeforedrag)|指定是否可以拖动按钮。 (重写[CMFCToolBarButton::OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)。)|  
|[CMFCToolBarMenuButton::OnCalculateSize](#oncalculatesize)|由框架调用以计算指定的设备上下文和停靠状态的按钮的大小。 (重写[CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize)。)|  
|[CMFCToolBarMenuButton::OnCancelMode](#oncancelmode)|由框架调用以处理[WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode)消息。 (重写[CMFCToolBarButton::OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode)。)|  
|[CMFCToolBarMenuButton::OnChangeParentWnd](#onchangeparentwnd)|按钮插入到一个新的工具栏中时由框架调用。 (重写[CMFCToolBarButton::OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd)。)|  
|[CMFCToolBarMenuButton::OnClick](#onclick)|当用户单击鼠标按钮时由框架调用。 (重写[CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick)。)|  
|[CMFCToolBarMenuButton::OnClickMenuItem](#onclickmenuitem)|当用户选择某个项的弹出菜单中，由框架调用。|  
|[CMFCToolBarMenuButton::OnContextHelp](#oncontexthelp)|当在父级工具栏处理 WM_HELPHITTEST 消息时由框架调用。 (重写[CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp)。)|  
|[CMFCToolBarMenuButton::OnDraw](#ondraw)|由框架调用以绘制按钮通过使用指定的样式和选项。 (重写[CMFCToolBarButton::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw)。)|  
|[CMFCToolBarMenuButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|由框架调用以将按钮画入**命令**窗格**自定义**对话框。 (重写[CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist)。)|  
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|在用户打开的弹出菜单时由框架调用。|  
|[CMFCToolBarMenuButton::ResetImageToDefault](#resetimagetodefault)|设置为默认值是与按钮关联的图像。 (重写[CMFCToolBarButton::ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault)。)|  
|[CMFCToolBarMenuButton::SaveBarState](#savebarstate)|保存的工具栏按钮的状态。 (重写[CMFCToolBarButton::SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate)。)|  
|[CMFCToolBarMenuButton::Serialize](#serialize)|从存档读取此对象或将其写入到存档。 (重写[CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize)。)|  
|[CMFCToolBarMenuButton::SetACCData](#setaccdata)|填充所提供`CAccessibilityData`对象从工具栏按钮可访问性数据。 (重写[CMFCToolBarButton::SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata)。)|  
|[CMFCToolBarMenuButton::SetMenuOnly](#setmenuonly)|指定是否可以将按钮添加到工具栏。|  
|[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)|指定弹出菜单是否处于调色板模式。|  
|[CMFCToolBarMenuButton::SetMessageWnd](#setmessagewnd)||  
|[CMFCToolBarMenuButton::SetRadio](#setradio)|强制工具栏菜单按钮，以显示一个图标，表示处于选中状态。|  
|[CMFCToolBarMenuButton::SetTearOff](#settearoff)|指定拖曳栏的弹出菜单 ID。|  
  
### <a name="protected-methods"></a>受保护的方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::DrawDocumentIcon](#drawdocumenticon)|菜单按钮上绘制一个图标。|  
  
### <a name="data-members"></a>数据成员  
  
|name|描述|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|如果为 TRUE，框架将始终调用[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)时绘制一个按钮。|  
  
## <a name="remarks"></a>备注  
 一个`CMFCToolBarMenuButton`可以显示为菜单、 具有子菜单的菜单项，用于执行的命令或可显示一个菜单的按钮或显示仅一个菜单的按钮。 通过指定参数，如图像、 文本、 菜单句柄，确定的行为和外观的菜单按钮和命令与构造函数中的按钮相关联的 ID `CMFCToolbarMenuButton::CMFCToolbarMenuButton`。  
  
 自定义类派生自`CMFCToolbarMenuButton`类必须使用[DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)宏。 [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)宏生成一个错误，应用程序关闭时。  
  
## <a name="example"></a>示例  
 下面的示例演示如何配置`CMFCToolBarMenuButton`对象。 该代码演示如何指定下拉列表菜单处于调色板模式，并指定在用户拖动从菜单栏的菜单按钮时创建的拖曳栏的 ID。 此代码片段属于 [Word Pad 示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](cobject-class.md)  
  
 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)  
  
 [CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)  
  
## <a name="requirements"></a>要求  
 **标头：** afxtoolbarmenubutton.h  
  
##  <a name="cmfctoolbarmenubutton"></a>  CMFCToolBarMenuButton::CMFCToolBarMenuButton  
 构造 `CMFCToolBarMenuButton` 对象。  
  
```  
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,  
    HMENU hMenu,  
    int iImage,  
    LPCTSTR lpszText=NULL,  
    BOOL bUserButton=FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in]*src*  
 将现有`CMFCToolBarMenuButton`复制到此对象`CMFCToolBarMenuButton`对象。  
  
 [in]*uiID*  
 用户单击按钮; 时要执行的命令 ID或者 (UINT)-1 不直接执行命令的菜单按钮。  
  
 [in]*hMenu*  
 句柄菜单;或者，如果该按钮不具有一个菜单，则为 NULL。  
  
 [in]*iImage*  
 按钮; 的图像的索引或如果此按钮不具有一个图标，或由指定的命令中使用的图标为-1 *uiID*。 索引是相同的每个`CMFCToolBarImages`在应用程序中的对象。  
  
 [in]*lpszText*  
 工具栏菜单按钮的文本。  
  
 [in]*bUserButton*  
 如果该按钮显示用户定义的图像; 则为 TRUE如果按钮将显示与指定的命令相关联的预定义的映像，则为 FALSE *uiID*。  
  
### <a name="remarks"></a>备注  
 如果*uiID*是一个有效命令 ID，当用户单击它时请单击按钮执行该命令。 如果*hMenu*是有效的菜单的句柄，该按钮时它将显示在菜单中将出现一个工具栏或子菜单中提供下拉列表菜单。 如果这两个*uiID*并*hMenu*是否有效，该按钮是用户单击它时将执行该命令的一部分而有一个向下箭头，将的下拉列表菜单部分拆分按钮时用户单击它。 但是，如果*hMenu*有效，用户将不能单击按钮时要执行的命令按钮插入到一个菜单。  
  
### <a name="example"></a>示例  
 下面的示例演示如何构造的对象`CMFCToolBarMenuButton`类。 此代码片段属于 [Word Pad 示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]  
  
##  <a name="comparewith"></a>  CMFCToolBarMenuButton::CompareWith  

  
```  
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;  
```  
  
### <a name="parameters"></a>参数  
 [in]*其他*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="copyfrom"></a>  Cmfctoolbarmenubutton:: Copyfrom  

  
```  
virtual void CopyFrom(const CMFCToolBarButton& src);
```  
  
### <a name="parameters"></a>参数  
 [in]*src*  
  
### <a name="remarks"></a>备注  
  
##  <a name="createfrommenu"></a>  CMFCToolBarMenuButton::CreateFromMenu  
 初始化从 Windows 菜单句柄的工具栏菜单。  
  
```  
virtual void CreateFromMenu(HMENU hMenu);
```  
  
### <a name="parameters"></a>参数  
 [in]*hMenu*  
 菜单句柄。  
  
### <a name="remarks"></a>备注  
 工具栏菜单按钮可以显示一个下拉列表子菜单。  
  
 框架调用此方法来初始化从一个菜单的子菜单中的命令。  
  
##  <a name="createmenu"></a>  CMFCToolBarMenuButton::CreateMenu  
 创建一个菜单，其中包含的工具栏菜单中的命令。 返回的句柄菜单。  
  
```  
virtual HMENU CreateMenu() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个句柄菜单上，如果成功。 如果与工具栏菜单按钮关联的命令的列表为空，则为 NULL。  
  
### <a name="remarks"></a>备注  
 您可以重写此方法在派生类自定义的方式生成菜单中。  
  
##  <a name="createpopupmenu"></a>  Cmfctoolbarmenubutton:: Createpopupmenu  
 创建`CMFCPopupMenu`要显示的工具栏菜单对象。  
  
```  
virtual CMFCPopupMenu* CreatePopupMenu();
```  
  
### <a name="return-value"></a>返回值  
 一个指向`CMFCPopupMenu`显示与工具栏菜单按钮关联的下拉列表菜单的对象。  
  
### <a name="remarks"></a>备注  
 若要准备与按钮关联的下拉列表菜单显示的 framework 调用此方法。  
  
 默认实现只是构造并返回一个新`CMFCPopupMenu`对象。 如果想要使用的派生的类型重写此方法[CMFCPopupMenu 类](cmfcpopupmenu-class.md)或执行附加的初始化。  
  
##  <a name="drawdocumenticon"></a>  CMFCToolBarMenuButton::DrawDocumentIcon  
 菜单按钮上绘制文档图标。  
  
```  
void DrawDocumentIcon(
    CDC* pDC,  
    const CRect& rectImage,  
    HICON hIcon);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
 指向设备上下文的指针。  
  
 [in]*rectImage*  
 图像边框的坐标。  
  
 [in]*hIcon*  
 图标句柄。  
  
### <a name="remarks"></a>备注  
 此方法接受文档图标，并将其绘制在指定的区域中居中显示的菜单按钮*rectImage*。  
  
##  <a name="enablequickcustomize"></a>  CMFCToolBarMenuButton::EnableQuickCustomize  

  
```  
void EnableQuickCustomize();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="hasbutton"></a>  CMFCToolBarMenuButton::HasButton  

  
```  
virtual BOOL HasButton() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="havehotborder"></a>  CMFCToolBarMenuButton::HaveHotBorder  

  
```  
virtual BOOL HaveHotBorder() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isborder"></a>  CMFCToolBarMenuButton::IsBorder  

  
```  
virtual BOOL IsBorder() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isclickedonmenu"></a>  CMFCToolBarMenuButton::IsClickedOnMenu  

  
```  
BOOL IsClickedOnMenu() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isquickmode"></a>  CMFCToolBarMenuButton::IsQuickMode  

  
```  
BOOL IsQuickMode();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getcommands"></a>  CMFCToolBarMenuButton::GetCommands  
 中的工具栏菜单的命令列表中，只读访问。  
  
```  
const CObList& GetCommands() const;  
```  
  
### <a name="return-value"></a>返回值  
 常量引用[CObList 类](../../mfc/reference/coblist-class.md)对象，它包含一系列[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象。  
  
### <a name="remarks"></a>备注  
 工具栏菜单按钮可显示子菜单。 您可以在构造函数中或在子菜单中的命令列表[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)作为菜单 (HMENU) 的句柄。 在菜单转换为派生自的对象的列表[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)并存储在内部`CObList`对象。 可以通过调用此方法访问此列表。  
  
##  <a name="getimagerect"></a>  CMFCToolBarMenuButton::GetImageRect  
 检索按钮图像的边框。  
  
```  
void GetImageRect(CRect& rectImage);
```  
  
### <a name="parameters"></a>参数  
 [out]*rectImage*  
 对引用`CRect`对象，它接收图像边框的坐标。  
  
##  <a name="getpaletterows"></a>  CMFCToolBarMenuButton::GetPaletteRows  
 菜单在调色板模式下时，请在下拉列表菜单中返回行的数。  
  
```  
int GetPaletteRows() const;  
```  
  
### <a name="return-value"></a>返回值  
 在面板中的行数。  
  
### <a name="remarks"></a>备注  
 当菜单按钮设置为调色板模式中时，菜单项将出现在只有有限数量的行与多个列。 调用此方法来获得的行数。 可以启用或禁用调色板模式并指定使用的行数[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)。  
  
##  <a name="getpopupmenu"></a>  CMFCToolBarMenuButton::GetPopupMenu  
 返回一个指向[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象，表示按钮的下拉列表菜单。  
  
```  
CMFCPopupMenu* GetPopupMenu() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)framework 绘制的工具栏菜单按钮; 子菜单时创建的对象如果没有子菜单显示为 NULL。  
  
### <a name="remarks"></a>备注  
 该按钮时工具栏菜单按钮可显示一个下拉列表菜单，创建[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象来表示菜单。 调用此方法以获取指向的`CMFCPopupMenu`对象。 因为它是暂时性的当用户关闭下拉列表菜单将变为无效，不应存储返回的指针。  
  
##  <a name="isdroppeddown"></a>  CMFCToolBarMenuButton::IsDroppedDown  
 指示当前是否显示弹出菜单。  
  
```  
virtual BOOL IsDroppedDown() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果工具栏菜单按钮都显示其子菜单; 则为 TRUE否则为 FALSE。  
  
##  <a name="isemptymenuallowed"></a>  Cmfctoolbarmenubutton:: Isemptymenuallowed  
 指定菜单项是否显示为空的子菜单。  
  
```  
virtual BOOL IsEmptyMenuAllowed() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果框架在即使子菜单为空，则为从当前所选的菜单项打开子菜单，则返回 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 当用户尝试从当前所选的菜单项打开子菜单时，框架将调用此方法。 如果是空的子菜单和`IsEmptyMenuAllowed`返回 FALSE，将不会打开子菜单。  
  
 默认实现将返回 FALSE。 重写此方法以自定义此行为。  
  
##  <a name="isexclusive"></a>  CMFCToolBarMenuButton::IsExclusive  
 指示按钮是否处于独占模式。  
  
```  
virtual BOOL IsExclusive() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果该按钮使用独占模式下; 则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 当用户打开一个弹出菜单的按钮，然后将鼠标指针移到另一个工具栏或菜单按钮上时，弹出菜单会关闭除非该按钮以独占模式。  
  
 默认实现始终返回 FALSE。 如果你想要启用独占模式，重写此方法在派生类中。  
  
##  <a name="ismenupalettemode"></a>  CMFCToolBarMenuButton::IsMenuPaletteMode  
 确定下拉列表菜单是否处于调色板模式。  
  
```  
BOOL IsMenuPaletteMode() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果调色板模式下启用，则为; 否则为 FALSE，则为 TRUE。  
  
### <a name="remarks"></a>备注  
 当菜单按钮设置为调色板模式下时，只有有限数量的行与多个列中显示菜单项。 调用此方法来获得的行数。 您可以启用或禁用调色板模式通过调用[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)。  
  
##  <a name="istearoffmenu"></a>  CMFCToolBarMenuButton::IsTearOffMenu  
 指示下拉菜单上是否有拖曳栏。  
  
```  
virtual BOOL IsTearOffMenu() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果工具栏菜单按钮具有拖曳栏; 则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 若要启用拖曳功能，并将设置为 off 拆解条形 ID，调用[CMFCToolBarMenuButton::SetTearOff](#settearoff)。  
  
##  <a name="m_balwayscallownerdraw"></a>  CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw  
 指定框架是否始终调用[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)时绘制一个按钮。  
  
```  
static BOOL m_bAlwaysCallOwnerDraw;  
```  
  
### <a name="remarks"></a>备注  
 如果此成员变量设置为 TRUE，始终调用该按钮[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)方法以在按钮上显示图像。 当`m_bAlwaysCallOwnerDraw`为 FALSE 时，按钮自身绘制的图像，如果预定义映像。 否则，它会调用`OnDrawMenuImage`。  
  
##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu  

  
```  
virtual void OnAfterCreatePopupMenu();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="onbeforedrag"></a>  CMFCToolBarMenuButton::OnBeforeDrag  

  
```  
virtual BOOL OnBeforeDrag() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="oncalculatesize"></a>  CMFCToolBarMenuButton::OnCalculateSize  

  
```  
virtual SIZE OnCalculateSize(
    CDC* pDC,  
    const CSize& sizeDefault,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
 [in]*大小*  
 [in]*bHorz*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="oncancelmode"></a>  CMFCToolBarMenuButton::OnCancelMode  

  
```  
virtual void OnCancelMode();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="onchangeparentwnd"></a>  CMFCToolBarMenuButton::OnChangeParentWnd  

  
```  
virtual void OnChangeParentWnd(CWnd* pWndParent);
```  
  
### <a name="parameters"></a>参数  
 [in]*pWndParent*  
  
### <a name="remarks"></a>备注  
  
##  <a name="onclick"></a>  CMFCToolBarMenuButton::OnClick  

  
```  
virtual BOOL OnClick(
    CWnd* pWnd,  
    BOOL bDelay = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in]*pWnd*  
 [in]*bDelay*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="onclickmenuitem"></a>  CMFCToolBarMenuButton::OnClickMenuItem  
 当用户在下拉列表菜单中选择某个项时由框架调用。  
  
```  
virtual BOOL OnClickMenuItem();
```  
  
### <a name="return-value"></a>返回值  
 如果框架应继续默认菜单项处理，则为 FALSE否则，返回 TRUE。 默认实现始终返回 FALSE。  
  
### <a name="remarks"></a>备注  
 当用户单击菜单项时，框架将执行与该项关联的命令。  
  
 若要自定义菜单项处理，请重写`OnClickMenuItem`派生类中`CMFCToolBarMenuButton`类。 您还必须重写[CFrameWndEx::OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) ，并将为需要进行特殊处理的派生类实例的菜单按钮。  
  
##  <a name="oncontexthelp"></a>  CMFCToolBarMenuButton::OnContextHelp  

  
```  
virtual BOOL OnContextHelp(CWnd* pWnd);
```  
  
### <a name="parameters"></a>参数  
 [in]*pWnd*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="ondraw"></a>  CMFCToolBarMenuButton::OnDraw  

  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rect,  
    CMFCToolBarImages* pImages,  
    BOOL bHorz = TRUE,  
    BOOL bCustomizeMode = FALSE,  
    BOOL bHighlight = FALSE,  
    BOOL bDrawBorder = TRUE,  
    BOOL bGrayDisabledButtons = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
 [in]*rect*  
 [in]*pImages*  
 [in]*bHorz*  
 [in]*bCustomizeMode*  
 [in]*bHighlight*  
 [in]*bDrawBorder*  
 [in]*bGrayDisabledButtons*  
  
### <a name="remarks"></a>备注  
  
##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarMenuButton::OnDrawOnCustomizeList  

  
```  
virtual int OnDrawOnCustomizeList(
    CDC* pDC,  
    const CRect& rect,  
    BOOL bSelected);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
 [in]*rect*  
 [in]*bSelected*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="openpopupmenu"></a>  CMFCToolBarMenuButton::OpenPopupMenu  
 在用户打开的工具栏菜单按钮的下拉列表菜单时由框架调用。  
  
```  
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```  
  
### <a name="parameters"></a>参数  
 [in]*pWnd*  
 指定接收的下拉列表菜单命令的窗口。 仅当工具栏菜单按钮具有父窗口，它可以为 NULL。  
  
### <a name="return-value"></a>返回值  
 TRUE 何时[CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)对象已创建并打开成功; 否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 在用户从工具栏菜单按钮打开下拉列表菜单时由框架调用此函数。  
  
##  <a name="resetimagetodefault"></a>  CMFCToolBarMenuButton::ResetImageToDefault  

  
```  
virtual void ResetImageToDefault();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="savebarstate"></a>  CMFCToolBarMenuButton::SaveBarState  

  
```  
virtual void SaveBarState();
```  
  
### <a name="remarks"></a>备注  
 作为拖放操作的结果创建的工具栏按钮时，框架将调用此方法。 此方法调用[CMFCPopupMenu::SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate)顶级弹出菜单上，这会导致重新创建其菜单的弹出菜单的父按钮的方法。  
  
##  <a name="serialize"></a>  CMFCToolBarMenuButton::Serialize  

  
```  
virtual void Serialize(CArchive& ar);
```  
  
### <a name="parameters"></a>参数  
 [in]*ar*  
  
### <a name="remarks"></a>备注  
  
##  <a name="setaccdata"></a>  CMFCToolBarMenuButton::SetACCData  
 设置功能区元素的可访问性数据。  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,  
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>参数  
 *pParent*  
 功能区元素的父窗口。  
  
 *data*  
 功能区元素的可访问性数据。  
  
### <a name="return-value"></a>返回值  
 始终返回 TRUE。  
  
### <a name="remarks"></a>备注  
 默认情况下此方法设置功能区元素的可访问性数据，并始终返回 TRUE。 重写此方法以设置可访问性数据并返回一个指示成功或失败的值。  
  
##  <a name="setmenuonly"></a>  CMFCToolBarMenuButton::SetMenuOnly  
 指定是否具有有效的命令 ID 和子菜单时作为菜单按钮或拆分按钮绘制按钮。  
  
```  
void SetMenuOnly(BOOL bMenuOnly);
```  
  
### <a name="parameters"></a>参数  
 [in]*bMenuOnly*  
 若要当它具有有效的命令 ID 和子菜单，则返回 FALSE 时它具有有效的命令 ID 和子菜单的拆分按钮以显示此按钮时显示此按钮为菜单按钮，则为 TRUE。  
  
### <a name="remarks"></a>备注  
 通常情况下，在时工具栏菜单按钮具有子菜单和命令 ID，菜单显示向下箭头按钮都有主要按钮和一个附加的拆分按钮。 如果调用此方法和*bMenuOnly*为 TRUE 时，该按钮改为显示为一个具有向下箭头按钮中的单个菜单按钮。 当用户单击其中任一模式下的箭头时，将打开子菜单，并且当用户单击其中任一模式下在 framework 中的按钮的非箭头一部分执行的命令。  
  
##  <a name="setmenupalettemode"></a>  CMFCToolBarMenuButton::SetMenuPaletteMode  
 指定下拉列表菜单是否处于调色板模式。  
  
```  
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,  
    int nPaletteRows=1);
```  
  
### <a name="parameters"></a>参数  
 [in]*bMenuPaletteMode*  
 指定下拉列表菜单是否处于调色板模式。  
  
 [in]*nPaletteRows*  
 在面板中的行数。  
  
### <a name="remarks"></a>备注  
 在调色板模式下，所有菜单项都显示为多列的调色板。 使用指定的行数*nPaletteRows*。  
  
##  <a name="setmessagewnd"></a>  CMFCToolBarMenuButton::SetMessageWnd  

  
```  
void SetMessageWnd(CWnd* pWndMessage);
```  
  
### <a name="parameters"></a>参数  
 [in]*pWndMessage*  
  
### <a name="remarks"></a>备注  
  
##  <a name="setradio"></a>  CMFCToolBarMenuButton::SetRadio  
 设置用于显示如果选中此单选按钮样式图标的工具栏菜单按钮。  
  
```  
virtual void SetRadio();
```  
  
### <a name="remarks"></a>备注  
 当它处于选中状态时绘制菜单按钮时，它将调用[CMFCVisualManager::OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck)绘制一个复选标记图标。 默认情况下，`OnDrawMenuCheck`请求当前视觉管理器绘制一个复选框样式的菜单按钮上的复选标记。 调用此方法后，当前的视觉管理器而是菜单按钮上绘制单选按钮样式复选标记。 此更改无法撤消。  
  
 如果当前显示的菜单按钮调用此方法，将会刷新。  
  
##  <a name="settearoff"></a>  CMFCToolBarMenuButton::SetTearOff  
 指定下拉列表菜单拖曳栏的 ID。  
  
```  
virtual void SetTearOff(UINT uiBarID);
```  
  
### <a name="parameters"></a>参数  
 [in]*uiBarID*  
 指定新拖曳栏 id。  
  
### <a name="remarks"></a>备注  
 调用此方法以指定在用户拖动从菜单栏的菜单按钮时创建的拖曳栏的 ID。 如果*uiBarID*参数为 0，则用户不能拉出菜单按钮。  
  
 调用[CWinAppEx::EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus)若要启用应用程序中的分离式菜单功能。  
  
## <a name="see-also"></a>请参阅  
 [层次结构图表](../../mfc/hierarchy-chart.md)   
 [类](../../mfc/reference/mfc-classes.md)   
 [CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)   
 [CMFCToolBar 类](../../mfc/reference/cmfctoolbar-class.md)   
 [CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)