---
title: 添加方法向导 | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-ide
ms.topic: conceptual
f1_keywords:
- vc.codewiz.method.overview
dev_langs:
- C++
helpviewer_keywords:
- Add Method Wizard [C++]
- methods [C++], adding using wizards
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 45c3b0ca9a3e6c88e4ae40a5eb52aeb3223d2860
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/19/2018
ms.locfileid: "46397294"
---
# <a name="add-method-wizard"></a>添加方法向导

使用此向导可将方法添加到接口。 根据要添加方法的项目类型或接口类型，向导显示不同的选项。

## <a name="names"></a>名称

- **返回类型**

   该方法返回的数据类型。 建议将 `HRESULT` 用于所有接口类型，因为它提供返回错误的标准方式。

   |接口类型|描述|
   |--------------------|-----------------|
   |双重接口|`HRESULT`。 不可更改。|
   |自定义接口|`HRESULT`。 不可更改。|
   |本地自定义接口|提供自己的返回类型或从列表中选择。|
   |调度接口|提供自己的返回类型或从列表中选择。|
   |MFC ActiveX 控件调度接口|如果实现常用方法，则返回类型将设置为适当的值且不可更改。 如果从“方法名”列表中选择方法，然后单击“选择方法类型”下的“自定义”，请从列表中选择返回类型。|

- **方法名**

   设置方法的名称。

   |接口类型|描述|
   |--------------------|-----------------|
   |ATL 双重接口、自定义接口和本地自定义接口|提供自己的方法名。|
   |MFC 调度接口|提供自己的方法名或从列表中选择建议的方法名。 如果从列表中选择名称，则相应的值将显示在“返回类型”框中，并且不可更改。|
   |MFC ActiveX 控件调度接口|提供自己的方法或选择 [DoClick](../mfc/reference/colecontrol-class.md#doclick) 和 [Refresh](../mfc/reference/colecontrol-class.md#refresh) 常用方法中的任意一种。 有关详细信息，请参阅 [MFC ActiveX 控件：添加常用方法](../mfc/mfc-activex-controls-adding-stock-methods.md)。|

- **方法类型**

   仅适用于 MFC ActiveX 控件。 如果在“方法名”框中提供方法名，而不是从列表中选择方法，则此框不可用。

   如果在“方法名”列表中选择其中一种方法，请选择常用实现或自定义实现。

   |方法类型|描述|
   |-----------------|-----------------|
   |**常用**|默认值。 插入在“方法名”列表中所选方法的常用实现。 如果选择“常用”，则“返回类型”不可更改。|
   |**自定义**|插入在“方法名”列表中所选方法的存根实现。 对于自定义方法类型，可提供自己的返回类型，也可从“返回类型”列表中选择一种类型。|

- **内部名称**

   仅适用于添加到 MFC 调度接口的自定义方法。 设置用于调度映射、头 (.h) 文件和实现 (.cpp) 文件的名称。 默认情况下，此名称与“方法名”相同。 如果正在使用 MFC 调度接口或正在将自定义方法添加到 MFC ActiveX 控件调度接口，则可更改方法名。

   |接口类型|描述|
   |--------------------|-----------------|
   |ATL 双重接口、自定义接口和本地自定义接口|不可用|
   |MFC 调度接口|默认设置为方法名。 可编辑内部名称。|
   |MFC ActiveX 控件调度接口|仅能为自定义方法设置内部名称。 常用方法不使用内部名称。|

- **参数属性**

   为“参数名称”中指定的参数设置任何其他属性。

   |参数属性|描述|允许的组合|
   |-------------------------|-----------------|--------------------------|
   |**In**|指示参数将从调用过程传递到被调用过程。|仅限 in<br /><br /> in 和 out|
   |**Out**|指示从被调用过程返回到调用过程（从服务器到客户端）的指针参数。|仅限 out<br /><br /> in 和 out<br /><br /> out 和 retval|
   |**Retval**|指示接收该成员的返回值的参数。|retval 和 out|

- **参数类型**

   设置参数的数据类型。 从列表中选择类型。

- **参数名称**

   设置要通过方法传递的参数名称。 键入名称后，必须单击“添加”才能将其添加到参数列表，参数通过方法进行传递。 如果未提供参数名称，向导会忽略任何参数属性（仅限 ATL）或“参数类型”选项。

   单击“添加”后，参数名称随即显示在“参数列表”中。

   > [!Note]
   > 如果提供参数名称，然后在单击“添加”前先单击“完成”，则不会将该参数添加到方法中。 必须找到该方法并手动插入参数。

- **添加**

   将在“参数名称”中指定的参数及其类型和参数属性添加到“参数列表”中。 必须单击“添加”才能将参数添加到列表中。

- **移除**

   从列表中删除在“参数列表”中选择的参数。

- **参数列表**

   显示当前为该方法添加的所有参数及其修饰符和类型。 添加参数时，向导更新“参数列表”以显示每个参数及其修饰符和类型。

## <a name="see-also"></a>请参阅

[添加方法](../ide/adding-a-method-visual-cpp.md)<br/>
[IDL 特性，添加方法向导](../ide/idl-attributes-add-method-wizard.md)