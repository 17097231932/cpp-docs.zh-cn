---
title: CMFCPropertyGridCtrl 类
ms.date: 11/19/2018
f1_keywords:
- CMFCPropertyGridCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::CMFCPropertyGridCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::accSelect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::AddProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::AlwaysShowUserToolTip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::CloseColorPopup
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::Create
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::DeleteProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::DrawControlBarColors
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EnableDescriptionArea
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EnableHeaderCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EnsureVisible
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::ExpandAll
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::FindItemByData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accChildCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accFocus
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accHelp
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accHelpTopic
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accKeyboardShortcut
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::get_accSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetBkColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetBoldFont
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetCurSel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetCustomColors
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetDescriptionHeight
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetDescriptionRows
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetHeaderCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetHeaderHeight
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetLeftColumnWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetListRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetPropertyColumnWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetPropertyCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetRowHeight
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetScrollBarCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::GetTextColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::HitTest
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::InitHeader
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsAlphabeticMode
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsAlwaysShowUserToolTip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsDescriptionArea
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsGroupNameFullWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsHeaderCtrl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsMarkModifiedProperties
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsShowDragContext
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::IsVSDotNetLook
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::MarkModifiedProperties
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::RemoveAll
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::ResetOriginalValues
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetAlphabeticMode
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetBoolLabels
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetCurSel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetCustomColors
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetDescriptionRows
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetGroupNameFullWidth
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetListDelimiter
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetShowDragContext
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::SetVSDotNetLook
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::UpdateColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::AdjustLayout
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::CompareProps
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EditItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::EndEditItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::Init
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnChangeSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnClickButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawBorder
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawList
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnDrawProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnPropertyChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::OnSelectCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridCtrl::ValidateItemData
helpviewer_keywords:
- CMFCPropertyGridCtrl [MFC], CMFCPropertyGridCtrl
- CMFCPropertyGridCtrl [MFC], accSelect
- CMFCPropertyGridCtrl [MFC], AddProperty
- CMFCPropertyGridCtrl [MFC], AlwaysShowUserToolTip
- CMFCPropertyGridCtrl [MFC], CloseColorPopup
- CMFCPropertyGridCtrl [MFC], Create
- CMFCPropertyGridCtrl [MFC], DeleteProperty
- CMFCPropertyGridCtrl [MFC], DrawControlBarColors
- CMFCPropertyGridCtrl [MFC], EnableDescriptionArea
- CMFCPropertyGridCtrl [MFC], EnableHeaderCtrl
- CMFCPropertyGridCtrl [MFC], EnsureVisible
- CMFCPropertyGridCtrl [MFC], ExpandAll
- CMFCPropertyGridCtrl [MFC], FindItemByData
- CMFCPropertyGridCtrl [MFC], get_accChildCount
- CMFCPropertyGridCtrl [MFC], get_accFocus
- CMFCPropertyGridCtrl [MFC], get_accHelp
- CMFCPropertyGridCtrl [MFC], get_accHelpTopic
- CMFCPropertyGridCtrl [MFC], get_accKeyboardShortcut
- CMFCPropertyGridCtrl [MFC], get_accSelection
- CMFCPropertyGridCtrl [MFC], GetBkColor
- CMFCPropertyGridCtrl [MFC], GetBoldFont
- CMFCPropertyGridCtrl [MFC], GetCurSel
- CMFCPropertyGridCtrl [MFC], GetCustomColors
- CMFCPropertyGridCtrl [MFC], GetDescriptionHeight
- CMFCPropertyGridCtrl [MFC], GetDescriptionRows
- CMFCPropertyGridCtrl [MFC], GetHeaderCtrl
- CMFCPropertyGridCtrl [MFC], GetHeaderHeight
- CMFCPropertyGridCtrl [MFC], GetLeftColumnWidth
- CMFCPropertyGridCtrl [MFC], GetListRect
- CMFCPropertyGridCtrl [MFC], GetProperty
- CMFCPropertyGridCtrl [MFC], GetPropertyColumnWidth
- CMFCPropertyGridCtrl [MFC], GetPropertyCount
- CMFCPropertyGridCtrl [MFC], GetRowHeight
- CMFCPropertyGridCtrl [MFC], GetScrollBarCtrl
- CMFCPropertyGridCtrl [MFC], GetTextColor
- CMFCPropertyGridCtrl [MFC], HitTest
- CMFCPropertyGridCtrl [MFC], InitHeader
- CMFCPropertyGridCtrl [MFC], IsAlphabeticMode
- CMFCPropertyGridCtrl [MFC], IsAlwaysShowUserToolTip
- CMFCPropertyGridCtrl [MFC], IsDescriptionArea
- CMFCPropertyGridCtrl [MFC], IsGroupNameFullWidth
- CMFCPropertyGridCtrl [MFC], IsHeaderCtrl
- CMFCPropertyGridCtrl [MFC], IsMarkModifiedProperties
- CMFCPropertyGridCtrl [MFC], IsShowDragContext
- CMFCPropertyGridCtrl [MFC], IsVSDotNetLook
- CMFCPropertyGridCtrl [MFC], MarkModifiedProperties
- CMFCPropertyGridCtrl [MFC], RemoveAll
- CMFCPropertyGridCtrl [MFC], ResetOriginalValues
- CMFCPropertyGridCtrl [MFC], SetAlphabeticMode
- CMFCPropertyGridCtrl [MFC], SetBoolLabels
- CMFCPropertyGridCtrl [MFC], SetCurSel
- CMFCPropertyGridCtrl [MFC], SetCustomColors
- CMFCPropertyGridCtrl [MFC], SetDescriptionRows
- CMFCPropertyGridCtrl [MFC], SetGroupNameFullWidth
- CMFCPropertyGridCtrl [MFC], SetListDelimiter
- CMFCPropertyGridCtrl [MFC], SetShowDragContext
- CMFCPropertyGridCtrl [MFC], SetVSDotNetLook
- CMFCPropertyGridCtrl [MFC], UpdateColor
- CMFCPropertyGridCtrl [MFC], AdjustLayout
- CMFCPropertyGridCtrl [MFC], CompareProps
- CMFCPropertyGridCtrl [MFC], EditItem
- CMFCPropertyGridCtrl [MFC], EndEditItem
- CMFCPropertyGridCtrl [MFC], Init
- CMFCPropertyGridCtrl [MFC], OnChangeSelection
- CMFCPropertyGridCtrl [MFC], OnClickButton
- CMFCPropertyGridCtrl [MFC], OnDrawBorder
- CMFCPropertyGridCtrl [MFC], OnDrawDescription
- CMFCPropertyGridCtrl [MFC], OnDrawList
- CMFCPropertyGridCtrl [MFC], OnDrawProperty
- CMFCPropertyGridCtrl [MFC], OnPropertyChanged
- CMFCPropertyGridCtrl [MFC], OnSelectCombo
- CMFCPropertyGridCtrl [MFC], ValidateItemData
ms.assetid: 95877cae-2311-4a2a-9031-0c8c3cf0a5f9
ms.openlocfilehash: 93ace0388981f429ac4a422947fbdaae8cdb8f24
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/05/2019
ms.locfileid: "58781973"
---
# <a name="cmfcpropertygridctrl-class"></a>CMFCPropertyGridCtrl 类

有关更多详细信息，请参阅中的源代码**VC\\atlmfc\\src\\mfc**的 Visual Studio 安装文件夹。

支持可以按字母或分层顺序显示属性的可编辑属性网格控件。

## <a name="syntax"></a>语法

```
class CMFCPropertyGridCtrl : public CWnd
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridCtrl::CMFCPropertyGridCtrl](#cmfcpropertygridctrl)|构造 `CMFCPropertyGridCtrl` 对象。|
|`CMFCPropertyGridCtrl::~CMFCPropertyGridCtrl`|析构函数。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|`CMFCPropertyGridCtrl::accHitTest`|由框架调用以检索屏幕上给定点处的子元素或子对象。 (重写[CWnd::accHitTest](../../mfc/reference/cwnd-class.md#acchittest)。)|
|`CMFCPropertyGridCtrl::accLocation`|由框架调用以检索指定对象的当前屏幕位置。 (重写[CWnd::accLocation](../../mfc/reference/cwnd-class.md#acclocation)。)|
|[CMFCPropertyGridCtrl::accSelect](#accselect)|由框架调用以修改选定内容或移动指定对象的键盘焦点。 (重写[CWnd::accSelect](../../mfc/reference/cwnd-class.md#accselect)。)|
|[CMFCPropertyGridCtrl::AddProperty](#addproperty)|将新属性添加到属性网格控件。|
|[CMFCPropertyGridCtrl::AlwaysShowUserToolTip](#alwaysshowusertooltip)||
|[CMFCPropertyGridCtrl::CloseColorPopup](#closecolorpopup)|关闭颜色选择对话框。|
|[CMFCPropertyGridCtrl::Create](#create)|创建属性网格控件，并将其附加到属性网格控件对象。|
|[CMFCPropertyGridCtrl::DeleteProperty](#deleteproperty)|从属性网格控件中删除指定的属性。|
|[CMFCPropertyGridCtrl::DrawControlBarColors](#drawcontrolbarcolors)||
|[CMFCPropertyGridCtrl::EnableDescriptionArea](#enabledescriptionarea)|启用或禁用的属性列表下显示的描述区域。|
|[CMFCPropertyGridCtrl::EnableHeaderCtrl](#enableheaderctrl)|启用或禁用在属性网格控件顶部的标头控件。|
|[CMFCPropertyGridCtrl::EnsureVisible](#ensurevisible)|属性网格控件滚动并展开属性项，直到指定的属性可见。|
|[CMFCPropertyGridCtrl::ExpandAll](#expandall)|展开或折叠属性网格控件的所有节点。|
|[CMFCPropertyGridCtrl::FindItemByData](#finditembydata)|检索与用户定义的 DWORD 值相关联的属性。|
|`CMFCPropertyGridCtrl::get_accChild`|由框架调用以检索指定子级的 `IDispatch` 接口地址。 (重写[CWnd::get_accChild](../../mfc/reference/cwnd-class.md#get_accchild)。)|
|[CMFCPropertyGridCtrl::get_accChildCount](#get_accchildcount)|由框架调用调用以检索属于该对象的子级的个数。 (重写[CWnd::get_accChildCount](../../mfc/reference/cwnd-class.md#get_accchildcount)。)|
|`CMFCPropertyGridCtrl::get_accDefaultAction`|由框架调用以检索描述对象默认操作的字符串。 (重写[CWnd::get_accDefaultAction](../../mfc/reference/cwnd-class.md#get_accdefaultaction)。)|
|`CMFCPropertyGridCtrl::get_accDescription`|由框架调用以检索描述指定对象的可视外观的字符串。 (重写[CWnd::get_accDescription](../../mfc/reference/cwnd-class.md#get_accdescription)。)|
|[CMFCPropertyGridCtrl::get_accFocus](#get_accfocus)|由框架调用以检索具有键盘焦点的对象。 (重写[CWnd::get_accFocus](../../mfc/reference/cwnd-class.md#get_accfocus)。)|
|[CMFCPropertyGridCtrl::get_accHelp](#get_acchelp)|由框架调用以检索对象的`Help`属性字符串。 (重写[CWnd::get_accHelp](../../mfc/reference/cwnd-class.md#get_acchelp)。)|
|[CMFCPropertyGridCtrl::get_accHelpTopic](#get_acchelptopic)|由框架调用以检索的完整路径**WinHelp**与指定的对象和该文件内相应主题的标识符关联的文件。 (重写[CWnd::get_accHelpTopic](../../mfc/reference/cwnd-class.md#get_acchelptopic)。)|
|[CMFCPropertyGridCtrl::get_accKeyboardShortcut](#get_acckeyboardshortcut)|由框架调用以检索指定对象的快捷键或访问键。 (重写[CWnd::get_accKeyboardShortcut](../../mfc/reference/cwnd-class.md#get_acckeyboardshortcut)。)|
|`CMFCPropertyGridCtrl::get_accName`|由框架调用以检索指定对象的名称。 (重写[CWnd::get_accName](../../mfc/reference/cwnd-class.md#get_accname)。)|
|`CMFCPropertyGridCtrl::get_accRole`|由框架调用以检索描述指定对象的角色的信息。 (重写[CWnd::get_accRole](../../mfc/reference/cwnd-class.md#get_accrole)。)|
|[CMFCPropertyGridCtrl::get_accSelection](#get_accselection)|由框架调用以检索该对象的选定子级。 (重写[CWnd::get_accSelection](../../mfc/reference/cwnd-class.md#get_accselection)。)|
|`CMFCPropertyGridCtrl::get_accState`|由框架调用以检索指定对象的当前状态。 (重写[CWnd::get_accState](../../mfc/reference/cwnd-class.md#get_accstate)。)|
|`CMFCPropertyGridCtrl::get_accValue`|由框架调用以检索指定对象的值。 (重写[CWnd::get_accValue](../../mfc/reference/cwnd-class.md#get_accvalue)。)|
|[CMFCPropertyGridCtrl::GetBkColor](#getbkcolor)|检索当前的属性网格控件的背景色。|
|[CMFCPropertyGridCtrl::GetBoldFont](#getboldfont)|检索 Windows 字体中粗体样式控制的当前属性网格中的文本。|
|[CMFCPropertyGridCtrl::GetCurSel](#getcursel)|检索当前所选的属性。|
|[CMFCPropertyGridCtrl::GetCustomColors](#getcustomcolors)|检索当前为属性网格控件元素定义的自定义颜色。|
|[CMFCPropertyGridCtrl::GetDescriptionHeight](#getdescriptionheight)|检索位于属性网格控件底部的说明区域的高度。|
|[CMFCPropertyGridCtrl::GetDescriptionRows](#getdescriptionrows)|检索当前的属性网格控件的说明区域中的行数。|
|[CMFCPropertyGridCtrl::GetHeaderCtrl](#getheaderctrl)|检索内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象框架使用，以显示当前的属性网格控件。|
|[CMFCPropertyGridCtrl::GetHeaderHeight](#getheaderheight)|检索的属性网格控件标头的高度。|
|[CMFCPropertyGridCtrl::GetLeftColumnWidth](#getleftcolumnwidth)|检索当前的属性网格控件，其中包含每个属性的名称的左侧列的宽度。|
|[CMFCPropertyGridCtrl::GetListRect](#getlistrect)|检索属性网格控件的边框。|
|[CMFCPropertyGridCtrl::GetProperty](#getproperty)|检索指向对应的属性网格控件项的指定索引的属性对象的指针。|
|[CMFCPropertyGridCtrl::GetPropertyColumnWidth](#getpropertycolumnwidth)|检索包含属性值的列的当前宽度。|
|[CMFCPropertyGridCtrl::GetPropertyCount](#getpropertycount)|检索在属性网格控件中的属性数。|
|[CMFCPropertyGridCtrl::GetRowHeight](#getrowheight)|检索的属性网格控件中的行的高度。|
|[CMFCPropertyGridCtrl::GetScrollBarCtrl](#getscrollbarctrl)|检索指向在属性网格控件中滚动条控件。 (重写[cwnd:: Getscrollbarctrl](../../mfc/reference/cwnd-class.md#getscrollbarctrl)。)|
|[CMFCPropertyGridCtrl::GetTextColor](#gettextcolor)|检索当前的属性网格控件中的属性项的文本的颜色。|
|`CMFCPropertyGridCtrl::GetThisClass`|由框架用于获取一个指向[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)与此类类型相关联的对象。|
|[CMFCPropertyGridCtrl::HitTest](#hittest)|检索指向指定的点是否在该项目中对应的属性网格控件项的属性对象的指针。 此方法还指示在属性网格控件中包含点的区域。|
|[CMFCPropertyGridCtrl::InitHeader](#initheader)|初始化内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象框架使用，以显示当前的属性网格控件。|
|[CMFCPropertyGridCtrl::IsAlphabeticMode](#isalphabeticmode)|指示在属性网格控件是否处于按字母顺序模式。|
|[CMFCPropertyGridCtrl::IsAlwaysShowUserToolTip](#isalwaysshowusertooltip)||
|[CMFCPropertyGridCtrl::IsDescriptionArea](#isdescriptionarea)|指示是否显示属性网格控件的说明区域。|
|[CMFCPropertyGridCtrl::IsGroupNameFullWidth](#isgroupnamefullwidth)|指示是否在当前的属性网格控件的宽度范围内显示每个属性组名称。|
|[CMFCPropertyGridCtrl::IsHeaderCtrl](#isheaderctrl)|指示是否显示标头控件。|
|[CMFCPropertyGridCtrl::IsMarkModifiedProperties](#ismarkmodifiedproperties)|指示属性网格控件显示修改后的属性的方式。|
|[CMFCPropertyGridCtrl::IsShowDragContext](#isshowdragcontext)|指示是否在 framework 重绘当前属性网格控件的名称和值列时用户调整列的大小。|
|[CMFCPropertyGridCtrl::IsVSDotNetLook](#isvsdotnetlook)|指示属性网格控件的外观是否使用与.net 的样式。|
|[CMFCPropertyGridCtrl::MarkModifiedProperties](#markmodifiedproperties)|指定如何显示修改后的属性。|
|`CMFCPropertyGridCtrl::PreTranslateMessage`|在将窗口消息发送到 [TranslateMessage](../../mfc/reference/cwinapp-class.md) 和 [DispatchMessage](/windows/desktop/api/winuser/nf-winuser-translatemessage) Windows 函数之前，由 [CWinApp](/windows/desktop/api/winuser/nf-winuser-dispatchmessage) 类用于对此消息进行转换。 （重写 [CWnd::PreTranslateMessage](../../mfc/reference/cwnd-class.md#pretranslatemessage)。）|
|[CMFCPropertyGridCtrl::RemoveAll](#removeall)|从属性网格控件中删除所有属性对象。|
|[CMFCPropertyGridCtrl::ResetOriginalValues](#resetoriginalvalues)|还原所有属性的原始值。|
|[CMFCPropertyGridCtrl::SetAlphabeticMode](#setalphabeticmode)|设置或重置字母顺序模式。|
|[CMFCPropertyGridCtrl::SetBoolLabels](#setboollabels)|指定布尔值的标签的文本。|
|[CMFCPropertyGridCtrl::SetCurSel](#setcursel)|在属性网格控件中选择一个属性。|
|[CMFCPropertyGridCtrl::SetCustomColors](#setcustomcolors)|指定各种属性网格控件元素的自定义的颜色。|
|[CMFCPropertyGridCtrl::SetDescriptionRows](#setdescriptionrows)|指定要在当前的属性网格控件的描述部分中显示行的数。|
|[CMFCPropertyGridCtrl::SetGroupNameFullWidth](#setgroupnamefullwidth)|指定是否在当前的属性网格控件中显示完整宽度的一组属性的类别名称。|
|[CMFCPropertyGridCtrl::SetListDelimiter](#setlistdelimiter)|定义将用作属性值的列表中分隔符的字符。|
|[CMFCPropertyGridCtrl::SetShowDragContext](#setshowdragcontext)|指定是否在 framework 重绘当前属性网格控件的名称和值列时用户调整列的大小。|
|[CMFCPropertyGridCtrl::SetVSDotNetLook](#setvsdotnetlook)|设置为在与.NET 中使用的样式属性网格控件的外观。|
|[CMFCPropertyGridCtrl::UpdateColor](#updatecolor)|设置当前选定的颜色属性的颜色值。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridCtrl::AdjustLayout](#adjustlayout)|重绘属性网格控件并将其属性。|
|[CMFCPropertyGridCtrl::CompareProps](#compareprops)|调用属性网格控件对属性进行排序。|
|[CMFCPropertyGridCtrl::EditItem](#edititem)|当用户开始修改属性时，由框架调用。|
|[CMFCPropertyGridCtrl::EndEditItem](#endedititem)|当用户停止修改属性时，由框架调用。|
|[CMFCPropertyGridCtrl::Init](#init)|由框架调用以初始化属性网格控件。|
|[CMFCPropertyGridCtrl::OnChangeSelection](#onchangeselection)|当前所选内容发生更改时由框架调用。|
|[CMFCPropertyGridCtrl::OnClickButton](#onclickbutton)|单击属性按钮时由框架调用。|
|[CMFCPropertyGridCtrl::OnDrawBorder](#ondrawborder)|由框架调用以在属性网格控件周围绘制边框。|
|[CMFCPropertyGridCtrl::OnDrawDescription](#ondrawdescription)|由框架调用以绘制说明区域并显示的说明文本。|
|[CMFCPropertyGridCtrl::OnDrawList](#ondrawlist)|由框架调用以在属性网格控件中显示的属性列表。|
|[CMFCPropertyGridCtrl::OnDrawProperty](#ondrawproperty)|由框架调用以显示属性。|
|[CMFCPropertyGridCtrl::OnPropertyChanged](#onpropertychanged)|属性值发生更改时由框架调用。|
|[CMFCPropertyGridCtrl::OnSelectCombo](#onselectcombo)|选择包含组合框控件的属性时，由框架调用。|
|[CMFCPropertyGridCtrl::ValidateItemData](#validateitemdata)|由框架调用以验证属性的数据。|

## <a name="remarks"></a>备注

`CMFCPropertyGridCtrl`类将显示在属性网格控件，其中包含可编辑的属性派生自[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)类。 每个属性可以表示一种类型，它可以包含的子项。 属性网格控件支持的可调整大小的区域可以显示所选属性的说明在底部。

若要使用属性网格控件，构造`CMFCPropertyGridCtrl`对象，然后调用[CMFCPropertyGridCtrl::Create](#create)方法。 使用[CMFCPropertyGridCtrl::AddProperty](#addproperty)方法将属性添加到列表。

## <a name="selection-properties"></a>选择属性

而不是表示一个值，一个属性项可以启动一个对话框，使用户能够选择颜色、 文件或字体。

下表列出了四种选择属性类型：

|类|描述|
|-----------|-----------------|
|[CMFCPropertyGridProperty 类](../../mfc/reference/cmfcpropertygridproperty-class.md)|一个常规用途属性，用于指定的字符串、 布尔值，日期值，等等。|
|[CMFCPropertyGridColorProperty 类](../../mfc/reference/cmfcpropertygridcolorproperty-class.md)|一个属性，用于选择颜色值。|
|[CMFCPropertyGridFileProperty 类](../../mfc/reference/cmfcpropertygridfileproperty-class.md)|一个属性，用于选择文件。|
|[CMFCPropertyGridFontProperty 类](../../mfc/reference/cmfcpropertygridfontproperty-class.md)|一个属性，用于选择一种字体。|

## <a name="illustrations"></a>图示

下图描述了两种方式显示属性的属性网格控件。 第一张图显示的属性层次结构，第二个按字母顺序显示属性。

![属性列表与属性表](../../mfc/reference/media/proplist.png "属性列表与属性表")

## <a name="example"></a>示例

下面的示例演示如何使用各种方法中的配置的属性网格控件对象`CMFCPropertyGridCtrl`类。 该示例演示如何启用标头控件、 启用描述区域中，并设置属性网格控件的外观。 该示例还演示如何设置按其属性名称，它包含的所有属性的控件，该控件进行排序的字母模式以及如何都设置的属性网格控件的各种元素的自定义颜色。 此示例摘自[新的控件示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_NewControls#14](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_1.h)]
[!code-cpp[NVC_MFC_NewControls#16](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_2.cpp)]
[!code-cpp[NVC_MFC_NewControls#20](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_3.cpp)]
[!code-cpp[NVC_MFC_NewControls#21](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_4.cpp)]
[!code-cpp[NVC_MFC_NewControls#24](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_5.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CMFCPropertyGridCtrl](../../mfc/reference/cmfcpropertygridctrl-class.md)

## <a name="requirements"></a>要求

**标头：** afxpropertygridctrl.h

##  <a name="accselect"></a>  CMFCPropertyGridCtrl::accSelect

```
virtual HRESULT accSelect(
    long flagsSelect,
    VARIANT varChild);
```

### <a name="parameters"></a>参数

[in] *flagsSelect*<br/>
[in] *varChild*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="addproperty"></a>  CMFCPropertyGridCtrl::AddProperty

将新属性添加到属性网格控件。

```
int AddProperty(
    CMFCPropertyGridProperty* pProp,
    BOOL bRedraw=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向属性。

*bRedraw*<br/>
[in]若要立即; 重绘该属性，则返回 TRUE否则为 FALSE。 默认值为 TRUE。

*bAdjustLayout*<br/>
[in]为 true，则重新计算如何绘制的文本和值的属性，然后绘制您的属性。为 FALSE，则使用现有的计算来绘制属性。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果此方法成功，其中添加属性; 在属性网格控件中的位置的从零开始的索引否则为-1。

### <a name="remarks"></a>备注

此方法将添加到属性网格控件中的属性列表的末尾的指定属性的指针。 不要销毁属性或允许它们超出范围之前销毁网格控件。 当完成属性网格控件时，调用[CMFCPropertyGridCtrl::RemoveAll](#removeall)若要删除所有已添加的属性。 如果指定的属性已添加到列表 AddProperty 方法失败。

##  <a name="adjustlayout"></a>  CMFCPropertyGridCtrl::AdjustLayout

重绘属性网格控件并将其属性。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>备注

此方法重新计算如何绘制整个属性网格控件和其属性，包括图像、 字体和控件。

##  <a name="alwaysshowusertooltip"></a>  CMFCPropertyGridCtrl::AlwaysShowUserToolTip

```
void AlwaysShowUserToolTip(BOOL bShow = TRUE);
```

### <a name="parameters"></a>参数

[in] *bShow*<br/>

### <a name="remarks"></a>备注

##  <a name="closecolorpopup"></a>  CMFCPropertyGridCtrl::CloseColorPopup

关闭颜色选择对话框。

```
virtual void CloseColorPopup();
```

### <a name="remarks"></a>备注

有关颜色选择对话框的详细信息，请参阅[CMFCPropertyGridColorProperty 类](../../mfc/reference/cmfcpropertygridcolorproperty-class.md)。

##  <a name="cmfcpropertygridctrl"></a>  CMFCPropertyGridCtrl::CMFCPropertyGridCtrl

构造 `CMFCPropertyGridCtrl` 对象。

```
CMFCPropertyGridCtrl();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="compareprops"></a>  CMFCPropertyGridCtrl::CompareProps

调用属性网格控件对属性进行排序。

```
virtual int CompareProps(
    const CMFCPropertyGridProperty* pProp1,
    const CMFCPropertyGridProperty* pProp2) const;
```

### <a name="parameters"></a>参数

*pProp1*<br/>
属性指向的指针。

*pProp2*<br/>
属性指向的指针。

### <a name="return-value"></a>返回值

|返回值|描述|
|------------------|-----------------|
|< 0|名称*pProp1*参数小于的名称*pProp2*参数。|
|0|名称*pProp1*参数是与名称相同*pProp2*参数。|
|> 0|名称*pProp1*对象是否大于的名称*pProp2*参数。|

### <a name="remarks"></a>备注

默认情况下，此方法使用[CString::Compare](../../atl-mfc-shared/reference/cstringt-class.md#compare)方法来比较`CMFCPropertyGridProperty::m_strName`指定参数的成员。

##  <a name="create"></a>  CMFCPropertyGridCtrl::Create

创建属性网格控件，并将其附加到属性网格控件对象。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
[in]按位组合 (OR) 的[的窗口样式](../../mfc/reference/styles-used-by-mfc.md#window-styles)。

*rect*<br/>
[in]客户端中指定的大小和窗口的位置的绑定矩形坐标*pParentWnd*。

*pParentWnd*<br/>
[in]向父窗口的指针。 不能为 NULL。

*nID*<br/>
[in]子窗口的 ID。

### <a name="return-value"></a>返回值

如果该窗口已创建的成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

若要创建属性网格控件，第一次调用[CMFCPropertyGridCtrl::CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造属性网格对象。 然后，调用`CMFCPropertyGridCtrl::Create`。

### <a name="example"></a>示例

下面的示例演示如何使用`Create`中的方法`CMFCPropertyGridCtrl`类。 此示例摘自[新的控件示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_NewControls#15](../../mfc/reference/codesnippet/cpp/cmfcpropertygridctrl-class_6.cpp)]

##  <a name="deleteproperty"></a>  CMFCPropertyGridCtrl::DeleteProperty

从属性网格控件中删除指定的属性。

```
BOOL DeleteProperty(
    CMFCPropertyGridProperty*& pProp,
    BOOL bRedraw=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向属性。

*bRedraw*<br/>
[in]重绘属性网格控件，则为 TRUE否则为 FALSE。 默认值为 TRUE。

*bAdjustLayout*<br/>
[in]为 true，则重新计算如何在属性网格控件中，绘制所有文本、 图像和项，然后都绘制控件;否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此方法用于从属性网格控件中删除某个属性和任何子项目。

##  <a name="drawcontrolbarcolors"></a>  CMFCPropertyGridCtrl::DrawControlBarColors

```
BOOL DrawControlBarColors() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="edititem"></a>  CMFCPropertyGridCtrl::EditItem

当用户开始修改属性时，由框架调用。

```
virtual BOOL EditItem(
    CMFCPropertyGridProperty* pProp,
    LPPOINT lptClick=NULL);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向属性。

*lptClick*<br/>
[in]用户单击以开始编辑操作的属性网格控件上的点。 关键是在控件的工作区中。 默认值为 NULL。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="enabledescriptionarea"></a>  CMFCPropertyGridCtrl::EnableDescriptionArea

启用或禁用显示在属性网格控件中的属性列表之下的说明区域。

```
void EnableDescriptionArea(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]为 TRUE，则启用说明区域;如果为 FALSE 禁用说明区域。 默认值为 TRUE。

### <a name="remarks"></a>备注

说明区域显示在属性网格控件的底部。 默认情况下，说明区域已禁用，并且不可见。

##  <a name="enableheaderctrl"></a>  CMFCPropertyGridCtrl::EnableHeaderCtrl

启用或禁用在属性网格控件顶部的标头控件。

```
void EnableHeaderCtrl(
    BOOL bEnable=TRUE,
    LPCTSTR lpszLeftColumn=_T("Property"),
    LPCTSTR lpszRightColumn=_T("Value"));
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]为 TRUE，则启用该标头控件;如果为 FALSE 禁用标头控件。 默认值为 TRUE。

*lpszLeftColumn*<br/>
[in]标头控件的左侧列的标题。 默认值是**属性**。

*lpszRightColumn*<br/>
[in]标头控件的右侧列的标题。 默认值是**值**。

##  <a name="endedititem"></a>  CMFCPropertyGridCtrl::EndEditItem

当用户完成修改属性时，由框架调用。

```
virtual BOOL EndEditItem(BOOL bUpdateData=TRUE);
```

### <a name="parameters"></a>参数

*bUpdateData*<br/>
[in]为 TRUE，则指定编辑操作已完成; 时，必须验证的已修改的属性数据否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

如果成功，则结束编辑操作，则返回 TRUE如果已修改的属性数据不是有效或编辑操作应继续，则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="ensurevisible"></a>  CMFCPropertyGridCtrl::EnsureVisible

属性网格控件滚动并展开属性项，直到指定的属性可见。

```
void EnsureVisible(
    CMFCPropertyGridProperty* pProp,
    BOOL bExpandParents=FALSE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向属性。

*bExpandParents*<br/>
[in]展开父项，以使指定的属性可见，则为 TRUE否则为 FALSE。 默认值为 FALSE。

### <a name="remarks"></a>备注

##  <a name="expandall"></a>  CMFCPropertyGridCtrl::ExpandAll

展开或折叠属性网格控件的所有节点。

```
void ExpandAll(BOOL bExpand=TRUE);
```

### <a name="parameters"></a>参数

*bExpand*<br/>
[in]展开所有节点，则为 TRUE为 FALSE，则折叠所有节点。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="finditembydata"></a>  CMFCPropertyGridCtrl::FindItemByData

检索与用户定义的 DWORD 值相关联的属性。

```
CMFCPropertyGridProperty* FindItemByData(
    DWORD_PTR dwData,
    BOOL bSearchSubItems=TRUE) const;
```

### <a name="parameters"></a>参数

*dwData*<br/>
[in]一个 DWORD 值。

*bSearchSubItems*<br/>
[in]为 TRUE，则搜索属性的子项目;否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

指向此方法成功; 如果关联的属性对象的指针否则，为 NULL。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl::CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造函数或[CMFCPropertyGridProperty::SetData](../../mfc/reference/cmfcpropertygridproperty-class.md#setdata)方法以将一个 dword 值与属性相关联。

##  <a name="get_accchildcount"></a>  CMFCPropertyGridCtrl::get_accChildCount

```
virtual HRESULT get_accChildCount(long* pcountChildren);
```

### <a name="parameters"></a>参数

[in] *pcountChildren*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_accfocus"></a>  CMFCPropertyGridCtrl::get_accFocus

```
virtual HRESULT get_accFocus(VARIANT* pvarChild);
```

### <a name="parameters"></a>参数

[in] *pvarChild*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_acchelp"></a>  CMFCPropertyGridCtrl::get_accHelp

```
virtual HRESULT get_accHelp(
    VARIANT varChild,
    BSTR* pszHelp);
```

### <a name="parameters"></a>参数

[in] *varChild*<br/>
[in] *pszHelp*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_acchelptopic"></a>  CMFCPropertyGridCtrl::get_accHelpTopic

```
virtual HRESULT get_accHelpTopic(
    BSTR* pszHelpFile,
    VARIANT varChild,
    long* pidTopic);
```

### <a name="parameters"></a>参数

[in] *pszHelpFile*<br/>
[in] *varChild*<br/>
[in] *pidTopic*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_acckeyboardshortcut"></a>  CMFCPropertyGridCtrl::get_accKeyboardShortcut

```
virtual HRESULT get_accKeyboardShortcut(
    VARIANT varChild,
    BSTR* pszKeyboardShortcut);
```

### <a name="parameters"></a>参数

[in] *varChild*<br/>
[in] *pszKeyboardShortcut*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="get_accselection"></a>  CMFCPropertyGridCtrl::get_accSelection

```
virtual HRESULT get_accSelection(VARIANT* pvarChildren);
```

### <a name="parameters"></a>参数

[in] *pvarChildren*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getbkcolor"></a>  CMFCPropertyGridCtrl::GetBkColor

检索当前的属性网格控件的背景色。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>返回值

RGB 颜色值。

### <a name="remarks"></a>备注

此方法检索框架使用用于绘制当前的属性网格控件的背景的颜色。 [CMFCPropertyGridCtrl::GetTextColor](#gettextcolor)方法检索的前景色。

##  <a name="getboldfont"></a>  CMFCPropertyGridCtrl::GetBoldFont

检索用于粗体样式中的当前属性网格控件中绘制文本的 Windows 字体。

```
CFont& GetBoldFont();
```

### <a name="return-value"></a>返回值

对引用[CFont](../../mfc/reference/cfont-class.md)描述了粗体的字体特征的对象。

##  <a name="getcursel"></a>  CMFCPropertyGridCtrl::GetCurSel

检索当前所选的属性。

```
CMFCPropertyGridProperty* GetCurSel() const;
```

### <a name="return-value"></a>返回值

指向对应于在属性网格控件中的选定项的属性对象的指针。

### <a name="remarks"></a>备注

##  <a name="getcustomcolors"></a>  CMFCPropertyGridCtrl::GetCustomColors

检索当前为属性网格控件元素定义的自定义颜色。

```
void GetCustomColors(
    COLORREF& clrBackground,
    COLORREF& clrText,
    COLORREF& clrGroupBackground,
    COLORREF& clrGroupText,
    COLORREF& clrDescriptionBackground,
    COLORREF& clrDescriptionText,
    COLORREF& clrLine);
```

### <a name="parameters"></a>参数

*clrBackground*<br/>
[out]属性值的背景色。

*clrText*<br/>
[out]属性名称和属性值文本的颜色。

*clrGroupBackground*<br/>
[out]属性组的背景色。

*clrGroupText*<br/>
[out]属性组中的文本的颜色。

*clrDescriptionBackground*<br/>
[out]说明区域的背景色。

*clrDescriptionText*<br/>
[out]在说明区域中的文本的颜色。

*clrLine*<br/>
[out]属性之间绘制的线条的颜色。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl::SetCustomColors](#setcustomcolors)方法以设置自定义颜色。

##  <a name="getdescriptionheight"></a>  CMFCPropertyGridCtrl::GetDescriptionHeight

检索描述区域中，位于底部的属性网格控件的高度。

```
int GetDescriptionHeight() const;
```

### <a name="return-value"></a>返回值

描述区域中，以像素为单位的高度。

### <a name="remarks"></a>备注

说明区域的高度由系统自动计算并设置为 1/4 属性网格控件的高度。

使用[CMFCPropertyGridCtrl::EnableDescriptionArea](#enabledescriptionarea)方法来显示或隐藏说明区域。 使用[CMFCPropertyGridCtrl::IsDescriptionArea](#isdescriptionarea)方法，以确定是否说明区域是显示还是隐藏。

##  <a name="getdescriptionrows"></a>  CMFCPropertyGridCtrl::GetDescriptionRows

检索当前的属性网格控件的说明区域中的行数。

```
int GetDescriptionRows() const;
```

### <a name="return-value"></a>返回值

在说明区域中的当前属性网格控件的行数。

### <a name="remarks"></a>备注

[CMFCPropertyGridCtrl::CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造函数初始化 3 行的说明区域。

##  <a name="getheaderctrl"></a>  CMFCPropertyGridCtrl::GetHeaderCtrl

检索内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象框架使用，以显示当前的属性网格控件。

```
virtual CMFCHeaderCtrl& GetHeaderCtrl();
```

### <a name="return-value"></a>返回值

对 `CMFCHeaderCtrl` 对象的引用。

##  <a name="getheaderheight"></a>  CMFCPropertyGridCtrl::GetHeaderHeight

检索在属性网格控件的标头的高度。

```
int GetHeaderHeight() const;
```

### <a name="return-value"></a>返回值

标头，以像素为单位的高度。

### <a name="remarks"></a>备注

##  <a name="getleftcolumnwidth"></a>  CMFCPropertyGridCtrl::GetLeftColumnWidth

检索当前的属性网格控件，其中包含每个属性的名称的左侧列的宽度。

```
int GetLeftColumnWidth() const;
```

### <a name="return-value"></a>返回值

名称列的宽度。

### <a name="remarks"></a>备注

在属性网格控件的右侧列包含每个属性的值。

##  <a name="getlistrect"></a>  CMFCPropertyGridCtrl::GetListRect

检索属性网格控件的边框。

```
CRect GetListRect() const;
```

### <a name="return-value"></a>返回值

属性网格控件的边框。 此 rectange 不包括说明区域和标头。

### <a name="remarks"></a>备注

##  <a name="getproperty"></a>  CMFCPropertyGridCtrl::GetProperty

检索到的指定索引的属性网格控件中的项相对应的属性对象的指针。

```
CMFCPropertyGridProperty* GetProperty(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]属性网格控件项的从零开始的索引。

如果此方法会断言*nIndex*参数小于零或大于或等于属性的数目。

### <a name="return-value"></a>返回值

指向对应于指定的索引，如果此方法成功; 的属性对象的指针否则为`NULL`。

### <a name="remarks"></a>备注

##  <a name="getpropertycolumnwidth"></a>  CMFCPropertyGridCtrl::GetPropertyColumnWidth

检索包含属性值的列的当前宽度。

```
int GetPropertyColumnWidth() const;
```

### <a name="return-value"></a>返回值

包含属性值的列的当前宽度。

### <a name="remarks"></a>备注

在属性网格控件中右侧列包含的属性值。 客户可以使用属性网格控件的拆分框来更改值列的宽度。

##  <a name="getpropertycount"></a>  CMFCPropertyGridCtrl::GetPropertyCount

检索在属性网格控件中的属性数。

```
int GetPropertyCount() const;
```

### <a name="return-value"></a>返回值

属性的数目。

### <a name="remarks"></a>备注

##  <a name="getrowheight"></a>  CMFCPropertyGridCtrl::GetRowHeight

检索的属性网格控件中的行的高度。

```
int GetRowHeight() const;
```

### <a name="return-value"></a>返回值

行的高度。

### <a name="remarks"></a>备注

行的高度等于当前的字体高度加上 4 个像素。

##  <a name="getscrollbarctrl"></a>  CMFCPropertyGridCtrl::GetScrollBarCtrl

检索指向在属性网格控件中滚动条控件。

```
virtual CScrollBar* GetScrollBarCtrl(int nBar) const;
```

### <a name="parameters"></a>参数

*nBar*<br/>
[in]必须为 SB_VERT 在滚动条的方向。

### <a name="return-value"></a>返回值

指向一个滚动条对象，则为 NULL，如果出现任何滚动条或滚动条方向是 SB_HORZ。

### <a name="remarks"></a>备注

此方法用于获取到垂直滚动条控件的直接访问权限。

##  <a name="gettextcolor"></a>  CMFCPropertyGridCtrl::GetTextColor

检索用于绘制当前的属性网格控件中的属性项的文本的颜色。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>返回值

RGB 颜色值。

### <a name="remarks"></a>备注

此方法检索框架使用来绘制当前的属性网格控件的前景色的颜色。 [CMFCPropertyGridCtrl::GetBkColor](#getbkcolor)方法检索的背景色。

##  <a name="hittest"></a>  CMFCPropertyGridCtrl::HitTest

检索指向指定的点是否在该项目中对应的属性网格控件项的属性对象的指针。 此方法还指示在属性网格控件中包含点的区域。

```
CMFCPropertyGridProperty* HitTest(
    CPoint pt,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL,
    BOOL bPropsOnly=FALSE) const;
```

### <a name="parameters"></a>参数

*pt*<br/>
[in]客户端坐标中的点。

*pnArea*<br/>
[in、 out]一个指向`ClickArea`变量。 当此方法返回时，该变量指示*属性区域*，其中包含指定的点。 有关属性区域的详细信息，请参阅备注。

*bPropsOnly*<br/>
[in]为 TRUE，则测试仅属性区域;如果为 FALSE，测试*说明区域*如果指定的点不在的属性区域中。 默认值是 FALSE。 有关说明区域的详细信息，请参阅备注。

### <a name="return-value"></a>返回值

如果*bPropsOnly*参数为 TRUE 和指定的点是属性区域中，返回值是指向相应的属性对象的指针。 此外， *pnArea*参数设置为包含指定的点的特定区域。 否则，返回值为 NULL， *pnArea*不修改参数。

如果*bPropsOnly*参数为 FALSE，返回值始终为 NULL。 但是，如果指定的点在说明区域中， *pnArea*参数设置为`CMFCPropertyGridProperty::ClickDescription`。

### <a name="remarks"></a>备注

术语*属性区域*任一名称、 值、 引用或展开框区域的属性网格控件项。 *说明区域*是在属性网格控件的底部区域。 当您单击属性网格控件项时，说明区域显示了相应的属性的说明。

此方法设置的变量的值*pnArea*参数指向。 下表列出了可能的值和相应的区域。

|值|区域|
|-----------|----------|
|`ClickArea::ClickExpandBox`|属性展开框控件。|
|`ClickArea::ClickName`|属性名称。|
|`ClickArea::ClickValue`|属性值。|
|`CMFCPropertyGridProperty::ClickDescription`|属性网格控件说明区域。|

##  <a name="init"></a>  CMFCPropertyGridCtrl::Init

由框架调用以初始化属性网格控件。

```
virtual void Init();
```

### <a name="remarks"></a>备注

##  <a name="initheader"></a>  CMFCPropertyGridCtrl::InitHeader

初始化内部[CMFCHeaderCtrl](../../mfc/reference/cmfcheaderctrl-class.md)对象框架使用，以显示当前的属性网格控件。

```
virtual void InitHeader();
```

##  <a name="isalphabeticmode"></a>  CMFCPropertyGridCtrl::IsAlphabeticMode

指示在属性网格控件是否处于按字母顺序模式。

```
BOOL IsAlphabeticMode() const;
```

### <a name="return-value"></a>返回值

如果属性网格控件中按字母顺序模式，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

按字母顺序模式的属性网格控件时，其名称按字母顺序排序的所有属性。 否则，属性被分组在其父节点。

使用[CMFCPropertyGridCtrl::SetAlphabeticMode](#setalphabeticmode)方法启用或禁用按字母顺序模式。

##  <a name="isalwaysshowusertooltip"></a>  CMFCPropertyGridCtrl::IsAlwaysShowUserToolTip

```
BOOL IsAlwaysShowUserToolTip() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isdescriptionarea"></a>  CMFCPropertyGridCtrl::IsDescriptionArea

指示是否显示属性网格控件的说明区域。

```
BOOL IsDescriptionArea() const;
```

### <a name="return-value"></a>返回值

显示说明区域; 如果为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl::EnableDescriptionArea](#enabledescriptionarea)方法来隐藏或显示说明区域。

##  <a name="isgroupnamefullwidth"></a>  CMFCPropertyGridCtrl::IsGroupNameFullWidth

指示是否在当前的属性网格控件的宽度范围内显示每个属性组名称。

```
BOOL IsGroupNameFullWidth() const;
```

### <a name="return-value"></a>返回值

如果组名显示在属性网格控件; 的宽度范围内，则返回 TRUE如果该控件的右侧 （值） 列被截断组名称，则为 FALSE。

### <a name="remarks"></a>备注

一个*组*是在属性网格控件中的相关属性的集合。 如果控件按层次结构，显示*组名称*显示为组上方的行中的类别标题。

##  <a name="isheaderctrl"></a>  CMFCPropertyGridCtrl::IsHeaderCtrl

指示是否显示标头控件。

```
BOOL IsHeaderCtrl() const;
```

### <a name="return-value"></a>返回值

如果显示标头控件; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl::EnableHeaderCtrl](#enableheaderctrl)以隐藏或显示标头控件的方法。

##  <a name="ismarkmodifiedproperties"></a>  CMFCPropertyGridCtrl::IsMarkModifiedProperties

指示属性网格控件显示修改后的属性的方式。

```
BOOL IsMarkModifiedProperties() const;
```

### <a name="return-value"></a>返回值

TRUE 如果粗体样式用于显示修改的属性;FALSE 如果正则样式用于显示修改的属性。

### <a name="remarks"></a>备注

##  <a name="isshowdragcontext"></a>  CMFCPropertyGridCtrl::IsShowDragContext

指示是否在 framework 重绘当前属性网格控件的名称和值列时用户调整列的大小。

```
BOOL IsShowDragContext() const;
```

### <a name="return-value"></a>返回值

如果在调整大小操作; 过程框架重绘的名称和值的列，则返回 TRUE如果框架重绘列拖动操作完成后，则为 FALSE。

### <a name="remarks"></a>备注

通过拖动列之间的拆分栏，用户可以调整大小属性网格控件的名称和值列。 如果显示的拖动上下文，则只要用户拖动拆分栏将调整大小的名称和值的列。 否则为在拆分栏移动，但列不重新绘制，直到完成拖动操作。

##  <a name="isvsdotnetlook"></a>  CMFCPropertyGridCtrl::IsVSDotNetLook

指示是否在 Visual Studio.NET 的样式属性网格控件的外观。

```
BOOL IsVSDotNetLook() const;
```

### <a name="return-value"></a>返回值

属性网格控件样式的 Visual Studio.NET 中; 如果为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl::SetVSDotNetLook](#setvsdotnetlook)方法设置为 Visual Studio.NET 的样式的属性网格控件。

##  <a name="markmodifiedproperties"></a>  CMFCPropertyGridCtrl::MarkModifiedProperties

指定如何显示修改后的属性。

```
void MarkModifiedProperties(
    BOOL bMark=TRUE,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*bMark*<br/>
[in]为 true，则显示修改粗体样式; 中的属性为 FALSE，则正则样式显示修改后的属性。 默认值为 TRUE。

*bRedraw*<br/>
[in]为 true，则重绘属性网格控件立即;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="onchangeselection"></a>  CMFCPropertyGridCtrl::OnChangeSelection

当前所选内容发生更改时由框架调用。

```
virtual void OnChangeSelection(
    CMFCPropertyGridProperty* pNewSel,
    CMFCPropertyGridProperty* pOldSel);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*pNewSel*|[in]指向新选定的属性。|
|*pOldSel*|[in]指向先前选定的属性。|

### <a name="remarks"></a>备注

此方法的默认实现没有任何影响。

##  <a name="onclickbutton"></a>  CMFCPropertyGridCtrl::OnClickButton

单击属性按钮时由框架调用。

```
virtual void OnClickButton(CPoint point);
```

### <a name="parameters"></a>参数

*point*<br/>
[in]客户端坐标中的点。

### <a name="remarks"></a>备注

默认情况下，此方法更新当前属性值。

##  <a name="ondrawborder"></a>  CMFCPropertyGridCtrl::OnDrawBorder

由框架调用以在属性网格控件周围绘制边框。

```
virtual void OnDrawBorder(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

### <a name="remarks"></a>备注

##  <a name="ondrawdescription"></a>  CMFCPropertyGridCtrl::OnDrawDescription

由框架调用以绘制说明区域并显示的说明文本。

```
virtual void OnDrawDescription(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rect*<br/>
[in]一个指定位置绘制说明区域的矩形。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridCtrl::EnableDescriptionArea](#enabledescriptionarea)方法来显示说明区域。

##  <a name="ondrawlist"></a>  CMFCPropertyGridCtrl::OnDrawList

由框架调用以在属性网格控件中显示的属性列表。

```
virtual void OnDrawList(CDC* pDC);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

### <a name="remarks"></a>备注

##  <a name="ondrawproperty"></a>  CMFCPropertyGridCtrl::OnDrawProperty

由框架调用以显示属性。

```
virtual int OnDrawProperty(
    CDC* pDC,
    CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*pProp*<br/>
[in]指向属性对象的指针。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="onpropertychanged"></a>  CMFCPropertyGridCtrl::OnPropertyChanged

属性值发生更改时由框架调用。

```
virtual void OnPropertyChanged(CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向其值已更改的属性对象的指针。

### <a name="remarks"></a>备注

默认情况下，此方法将发送[AFX_WM_PROPERTY_CHANGED](../../mfc/reference/afx-messages.md)属性网格控件的所有者的消息。

##  <a name="onselectcombo"></a>  CMFCPropertyGridCtrl::OnSelectCombo

选择包含组合框控件的属性时，由框架调用。

```
void OnSelectCombo();
```

### <a name="remarks"></a>备注

##  <a name="removeall"></a>  CMFCPropertyGridCtrl::RemoveAll

从属性网格控件中删除所有属性对象。

```
void RemoveAll();
```

### <a name="remarks"></a>备注

##  <a name="resetoriginalvalues"></a>  CMFCPropertyGridCtrl::ResetOriginalValues

还原所有属性的原始值。

```
void ResetOriginalValues(BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*bRedraw*<br/>
[in]为 TRUE，则重绘属性列表中;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="setalphabeticmode"></a>  CMFCPropertyGridCtrl::SetAlphabeticMode

设置或重置字母的模式。

```
void SetAlphabeticMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[in]为 TRUE，则将按字母顺序模式; 设置FALSE 重置字母的模式。 默认值为 TRUE。

### <a name="remarks"></a>备注

按字母顺序模式的属性网格控件时，该控件对其属性名称及其包含的所有属性进行都排序。

##  <a name="setboollabels"></a>  CMFCPropertyGridCtrl::SetBoolLabels

指定布尔值的标签的文本。

```
void SetBoolLabels(
    LPCTSTR lpszTrue,
    LPCTSTR lpszFalse);
```

### <a name="parameters"></a>参数

*lpszTrue*<br/>
[in]要为 true 的布尔值显示的文本字符串。

*lpszFalse*<br/>
[in]要为 false 的布尔值显示的文本字符串。

### <a name="remarks"></a>备注

##  <a name="setcursel"></a>  CMFCPropertyGridCtrl::SetCurSel

在属性网格控件中选择一个属性。

```
void SetCurSel(
    CMFCPropertyGridProperty* pProp,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向属性对象的指针。

*bRedraw*<br/>
[in]为 true，则重绘属性网格控件立即;否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

使用此方法以取消在属性网格控件中当前项的选择，然后选择对应于指定的属性的项。

##  <a name="setcustomcolors"></a>  CMFCPropertyGridCtrl::SetCustomColors

指定属性网格控件的各种元素的自定义的颜色。

```
void SetCustomColors(
    COLORREF clrBackground,
    COLORREF clrText,
    COLORREF clrGroupBackground,
    COLORREF clrGroupText,
    COLORREF clrDescriptionBackground,
    COLORREF clrDescriptionText,
    COLORREF clrLine);
```

### <a name="parameters"></a>参数

*clrBackground*<br/>
[in]属性值的背景色。

*clrText*<br/>
[in]属性名称和属性值文本的颜色。

*clrGroupBackground*<br/>
[in]属性组的背景色。

*clrGroupText*<br/>
[in]属性组的新的文本颜色。

*clrDescriptionBackground*<br/>
[in]说明区域的背景色。

*clrDescriptionText*<br/>
[in]在说明区域中的文本的颜色。

*clrLine*<br/>
[in]属性之间绘制的线条的颜色。

### <a name="remarks"></a>备注

对于任何参数，指定`((COLORREF)-1)`颜色值要用于该元素的属性网格控件的默认颜色。

若要自定义的特定属性的外观，派生的类从[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)类，然后重写[CMFCPropertyGridProperty::OnDrawName](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawname)， [Cmfcpropertygridproperty:: Ondrawvalue](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawvalue)， [CMFCPropertyGridProperty::OnDrawExpandBox](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawexpandbox)，和[CMFCPropertyGridProperty::OnDrawButton](../../mfc/reference/cmfcpropertygridproperty-class.md#ondrawbutton)方法。

##  <a name="setdescriptionrows"></a>  CMFCPropertyGridCtrl::SetDescriptionRows

指定要在当前的属性网格控件的描述部分中显示行的数。

```
void SetDescriptionRows(int nDescRows);
```

### <a name="parameters"></a>参数

*nDescRows*<br/>
[in]要在属性说明中显示的行数。

##  <a name="setgroupnamefullwidth"></a>  CMFCPropertyGridCtrl::SetGroupNameFullWidth

指定是否在当前的属性网格控件中显示完整宽度的一组属性的类别名称。

```
void SetGroupNameFullWidth(
    BOOL bGroupNameFullWidth = TRUE,
    BOOL bRedraw = TRUE);
```

### <a name="parameters"></a>参数

*bGroupNameFullWidth*<br/>
[in]若要显示完整宽度的类别名称而不考虑属性名称列的宽度，则为 TRUE。 如果为 FALSE，以限制类别名称和属性名称列的宽度的宽度。 默认值为 TRUE。

*bRedraw*<br/>
[in]为 true，则更新属性网格控件立即;为 FALSE，则下一个重绘事件时更新控件时发生。 默认值为 TRUE。

### <a name="remarks"></a>备注

属性网格控件组成可调整大小*属性名称*列和一个*属性值*列。 名称列的末尾还是值列的起点。 若要调整列的大小，请在列之间拖动边框。

条款*组名称*并*类别名称*此方法中互换使用。 类别名称显示在指向一组相关的属性和值的行。 此方法指定属性名称列的宽度是否还指定显示的类别名称的宽度。

##  <a name="setlistdelimiter"></a>  CMFCPropertyGridCtrl::SetListDelimiter

定义用作分隔符的属性值的列表中的字符。

```
void SetListDelimiter(TCHAR c);
```

### <a name="parameters"></a>参数

*c*<br/>
[in]要用作分隔符的字符。

### <a name="remarks"></a>备注

使用此方法中使用的属性值的列表中定义分隔符字符[CMFCPropertyGridProperty::CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md#cmfcpropertygridproperty)构造函数。 在该构造函数中设置*bIsValueList*参数设为 TRUE。

默认情况下[CMFCPropertyGridCtrl::CMFCPropertyGridCtrl](#cmfcpropertygridctrl)构造函数设置分隔符为逗号 （，）。

##  <a name="setshowdragcontext"></a>  CMFCPropertyGridCtrl::SetShowDragContext

指定是否在 framework 重绘当前属性网格控件的名称和值列时用户调整列的大小。

```
void SetShowDragContext(BOOL bShowDragContext = TRUE);
```

### <a name="parameters"></a>参数

*bShowDragContext*<br/>
[in]为 TRUE，则在调整大小操作; 期间重绘的名称和值的列如果为 FALSE，则重绘列拖动操作完成后。 默认值为 TRUE。

### <a name="remarks"></a>备注

通过拖动列之间的拆分栏，用户可以调整大小属性网格控件的名称和值列。 如果显示的拖动上下文，则只要用户拖动拆分栏将调整大小的名称和值的列。 否则为在拆分栏移动，但列不重新绘制，直到完成拖动操作。

##  <a name="setvsdotnetlook"></a>  CMFCPropertyGridCtrl::SetVSDotNetLook

设置为在 Visual Studio.NET 中使用的样式属性网格控件的外观。

```
void SetVSDotNetLook(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[in]在属性网格为样式，可在 Visual Studio.NET; 则为 True 的控制否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="updatecolor"></a>  CMFCPropertyGridCtrl::UpdateColor

设置当前选定的颜色属性的颜色值。

```
virtual void UpdateColor(COLORREF color);
```

### <a name="parameters"></a>参数

*颜色*<br/>
[in]RGB 颜色值。

### <a name="remarks"></a>备注

此方法断言在调试模式下，如果属性网格控件的当前所选的属性不是颜色属性。

##  <a name="validateitemdata"></a>  CMFCPropertyGridCtrl::ValidateItemData

由框架调用以验证属性的数据。

```
virtual BOOL ValidateItemData(CMFCPropertyGridProperty* pProp);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*pProp*|[in]指向属性。 未使用此参数。|

### <a name="return-value"></a>返回值

始终为 TRUE。

### <a name="remarks"></a>备注

[CMFCPropertyGridCtrl::EndEditItem](#endedititem)方法调用此方法以验证数据。 默认情况下，此方法不使用其*pProp*参数和它的返回值始终为 TRUE。

如果重写此方法，则返回 TRUE，如果指定的属性数据是否有效。 否则，返回 FALSE，这种情况下该框架不会更新该属性。

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)
