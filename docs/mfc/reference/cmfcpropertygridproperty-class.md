---
title: CMFCPropertyGridProperty 类
ms.date: 11/04/2016
f1_keywords:
- CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AddOption
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AddSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AdjustButtonRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AdjustInPlaceEditRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AllowEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateInPlaceEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateSpinControl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Enable
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::EnableSpinControl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Expand
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::FormatProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetExpandedSubItems
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetHierarchyLevel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetNameTooltip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOption
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOptionCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetParent
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetSubItemsCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetValueTooltip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::HitTest
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsAllowEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsEnabled
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsExpanded
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsGroup
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsInPlaceEditing
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsModified
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsParentExpanded
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsSelected
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsVisible
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnCloseCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDblClk
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawExpandBox
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnEndEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnKillSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnPosSizeChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnRClickName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnRClickValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSelectCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSetCursor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSetSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnUpdateValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::PushChar
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Redraw
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::RemoveAllOptions
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::RemoveSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::ResetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Show
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::HasButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Init
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsValueChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnCtlColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDestroyWindow
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnKillFocus
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatDouble
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatFloat
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatLong
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatShort
helpviewer_keywords:
- CMFCPropertyGridProperty [MFC], CMFCPropertyGridProperty
- CMFCPropertyGridProperty [MFC], AddOption
- CMFCPropertyGridProperty [MFC], AddSubItem
- CMFCPropertyGridProperty [MFC], AdjustButtonRect
- CMFCPropertyGridProperty [MFC], AdjustInPlaceEditRect
- CMFCPropertyGridProperty [MFC], AllowEdit
- CMFCPropertyGridProperty [MFC], CreateInPlaceEdit
- CMFCPropertyGridProperty [MFC], CreateSpinControl
- CMFCPropertyGridProperty [MFC], Enable
- CMFCPropertyGridProperty [MFC], EnableSpinControl
- CMFCPropertyGridProperty [MFC], Expand
- CMFCPropertyGridProperty [MFC], FormatProperty
- CMFCPropertyGridProperty [MFC], GetData
- CMFCPropertyGridProperty [MFC], GetDescription
- CMFCPropertyGridProperty [MFC], GetExpandedSubItems
- CMFCPropertyGridProperty [MFC], GetHierarchyLevel
- CMFCPropertyGridProperty [MFC], GetName
- CMFCPropertyGridProperty [MFC], GetNameTooltip
- CMFCPropertyGridProperty [MFC], GetOption
- CMFCPropertyGridProperty [MFC], GetOptionCount
- CMFCPropertyGridProperty [MFC], GetOriginalValue
- CMFCPropertyGridProperty [MFC], GetParent
- CMFCPropertyGridProperty [MFC], GetRect
- CMFCPropertyGridProperty [MFC], GetSubItem
- CMFCPropertyGridProperty [MFC], GetSubItemsCount
- CMFCPropertyGridProperty [MFC], GetValue
- CMFCPropertyGridProperty [MFC], GetValueTooltip
- CMFCPropertyGridProperty [MFC], HitTest
- CMFCPropertyGridProperty [MFC], IsAllowEdit
- CMFCPropertyGridProperty [MFC], IsEnabled
- CMFCPropertyGridProperty [MFC], IsExpanded
- CMFCPropertyGridProperty [MFC], IsGroup
- CMFCPropertyGridProperty [MFC], IsInPlaceEditing
- CMFCPropertyGridProperty [MFC], IsModified
- CMFCPropertyGridProperty [MFC], IsParentExpanded
- CMFCPropertyGridProperty [MFC], IsSelected
- CMFCPropertyGridProperty [MFC], IsVisible
- CMFCPropertyGridProperty [MFC], OnClickButton
- CMFCPropertyGridProperty [MFC], OnClickName
- CMFCPropertyGridProperty [MFC], OnClickValue
- CMFCPropertyGridProperty [MFC], OnCloseCombo
- CMFCPropertyGridProperty [MFC], OnDblClk
- CMFCPropertyGridProperty [MFC], OnDrawButton
- CMFCPropertyGridProperty [MFC], OnDrawDescription
- CMFCPropertyGridProperty [MFC], OnDrawExpandBox
- CMFCPropertyGridProperty [MFC], OnDrawName
- CMFCPropertyGridProperty [MFC], OnDrawValue
- CMFCPropertyGridProperty [MFC], OnEdit
- CMFCPropertyGridProperty [MFC], OnEndEdit
- CMFCPropertyGridProperty [MFC], OnKillSelection
- CMFCPropertyGridProperty [MFC], OnPosSizeChanged
- CMFCPropertyGridProperty [MFC], OnRClickName
- CMFCPropertyGridProperty [MFC], OnRClickValue
- CMFCPropertyGridProperty [MFC], OnSelectCombo
- CMFCPropertyGridProperty [MFC], OnSetCursor
- CMFCPropertyGridProperty [MFC], OnSetSelection
- CMFCPropertyGridProperty [MFC], OnUpdateValue
- CMFCPropertyGridProperty [MFC], PushChar
- CMFCPropertyGridProperty [MFC], Redraw
- CMFCPropertyGridProperty [MFC], RemoveAllOptions
- CMFCPropertyGridProperty [MFC], RemoveSubItem
- CMFCPropertyGridProperty [MFC], ResetOriginalValue
- CMFCPropertyGridProperty [MFC], SetData
- CMFCPropertyGridProperty [MFC], SetDescription
- CMFCPropertyGridProperty [MFC], SetName
- CMFCPropertyGridProperty [MFC], SetOriginalValue
- CMFCPropertyGridProperty [MFC], SetValue
- CMFCPropertyGridProperty [MFC], Show
- CMFCPropertyGridProperty [MFC], CreateCombo
- CMFCPropertyGridProperty [MFC], HasButton
- CMFCPropertyGridProperty [MFC], Init
- CMFCPropertyGridProperty [MFC], IsSubItem
- CMFCPropertyGridProperty [MFC], IsValueChanged
- CMFCPropertyGridProperty [MFC], OnCtlColor
- CMFCPropertyGridProperty [MFC], OnDestroyWindow
- CMFCPropertyGridProperty [MFC], OnKillFocus
- CMFCPropertyGridProperty [MFC], m_strFormatDouble
- CMFCPropertyGridProperty [MFC], m_strFormatFloat
- CMFCPropertyGridProperty [MFC], m_strFormatLong
- CMFCPropertyGridProperty [MFC], m_strFormatShort
ms.assetid: 36f3fabe-0efe-468b-8a0b-5a7956db38a2
ms.openlocfilehash: aa88cc2d4ee915b970157ee6ed280512e2352bcc
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/05/2019
ms.locfileid: "58779022"
---
# <a name="cmfcpropertygridproperty-class"></a>CMFCPropertyGridProperty 类

一个`CMFCPropertyGridProperty`对象都表示属性列表控件中的列表项。

   有关更多详细信息，请参阅中的源代码**VC\\atlmfc\\src\\mfc**的 Visual Studio 安装文件夹。

## <a name="syntax"></a>语法

```
class CMFCPropertyGridProperty : public CObject
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridProperty::CMFCPropertyGridProperty](#cmfcpropertygridproperty)|构造 `CMFCPropertyGridProperty` 对象。|
|`CMFCPropertyGridProperty::~CMFCPropertyGridProperty`|析构函数。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridProperty::AddOption](#addoption)|将新列表项添加到属性列表控件。|
|[CMFCPropertyGridProperty::AddSubItem](#addsubitem)|将子项添加到一个属性。|
|[CMFCPropertyGridProperty::AdjustButtonRect](#adjustbuttonrect)|调用要告知要调整大小的嵌入按钮的边框的属性的父属性列表控件。|
|[CMFCPropertyGridProperty::AdjustInPlaceEditRect](#adjustinplaceeditrect)|检索用于设置属性值的文本框和可选数值调节按钮控件的边界。|
|[CMFCPropertyGridProperty::AllowEdit](#allowedit)|使属性是可编辑或只读的。|
|[CMFCPropertyGridProperty::CreateInPlaceEdit](#createinplaceedit)|由框架调用以创建可编辑的控件的属性。|
|[CMFCPropertyGridProperty::CreateSpinControl](#createspincontrol)|由框架调用以创建一个可编辑数值调节钮按钮控件。|
|[CMFCPropertyGridProperty::Enable](#enable)|启用或禁用一个属性。|
|[CMFCPropertyGridProperty::EnableSpinControl](#enablespincontrol)|启用或禁用调节按钮控件用于修改属性值。|
|[CMFCPropertyGridProperty::Expand](#expand)|展开或折叠包含子属性的属性。|
|[CMFCPropertyGridProperty::FormatProperty](#formatproperty)|设置属性值的文本表示形式的格式。|
|[CMFCPropertyGridProperty::GetData](#getdata)|检索与属性关联的 DWORD 值。|
|[CMFCPropertyGridProperty::GetDescription](#getdescription)|检索的属性说明。|
|[CMFCPropertyGridProperty::GetExpandedSubItems](#getexpandedsubitems)|检索扩展的子项目数。|
|[CMFCPropertyGridProperty::GetHierarchyLevel](#gethierarchylevel)|检索属性的层次结构级别的从零开始的索引。|
|[CMFCPropertyGridProperty::GetName](#getname)|检索的属性的名称。|
|[CMFCPropertyGridProperty::GetNameTooltip](#getnametooltip)|由框架调用以在工具提示中显示的属性的名称。|
|[CMFCPropertyGridProperty::GetOption](#getoption)|检索由索引指定选项的文本。|
|[CMFCPropertyGridProperty::GetOptionCount](#getoptioncount)|检索属于某个属性的选项数。|
|[CMFCPropertyGridProperty::GetOriginalValue](#getoriginalvalue)|检索当前属性的初始值。|
|[CMFCPropertyGridProperty::GetParent](#getparent)|检索指向父属性。|
|[CMFCPropertyGridProperty::GetRect](#getrect)|检索一个属性的边框。|
|[CMFCPropertyGridProperty::GetSubItem](#getsubitem)|检索由从零开始的索引标识的子属性。|
|[CMFCPropertyGridProperty::GetSubItemsCount](#getsubitemscount)|检索子项目数。|
|`CMFCPropertyGridProperty::GetThisClass`|由框架用于获取一个指向[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)与此类类型相关联的对象。|
|[CMFCPropertyGridProperty::GetValue](#getvalue)|检索一个属性值。|
|[CMFCPropertyGridProperty::GetValueTooltip](#getvaluetooltip)|由框架调用以检索属性值，然后在工具提示中显示的文本表示形式。|
|[CMFCPropertyGridProperty::HitTest](#hittest)|指向对应于对应于一个点的属性列表项的属性对象。|
|[CMFCPropertyGridProperty::IsAllowEdit](#isallowedit)|指示属性是否可编辑。|
|[CMFCPropertyGridProperty::IsEnabled](#isenabled)|指示属性是启用还是禁用。|
|[CMFCPropertyGridProperty::IsExpanded](#isexpanded)|指示属性是否是展开还是折叠。|
|[CMFCPropertyGridProperty::IsGroup](#isgroup)|指示当前属性是否表示一个组。|
|[CMFCPropertyGridProperty::IsInPlaceEditing](#isinplaceediting)|指示当前属性是否可编辑。|
|[CMFCPropertyGridProperty::IsModified](#ismodified)|指示是否修改当前属性。|
|[CMFCPropertyGridProperty::IsParentExpanded](#isparentexpanded)|指示是否展开当前属性的父级。|
|[CMFCPropertyGridProperty::IsSelected](#isselected)|指示是否选择当前的属性。|
|[CMFCPropertyGridProperty::IsVisible](#isvisible)|指示当前属性是否可见。|
|[CMFCPropertyGridProperty::OnClickButton](#onclickbutton)|当用户单击属性中包含的按钮时，由框架调用。|
|[CMFCPropertyGridProperty::OnClickName](#onclickname)|当用户单击某个属性的名称字段时，调用由父属性列表控件。|
|[CMFCPropertyGridProperty::OnClickValue](#onclickvalue)|当用户单击某个属性的值字段时，调用由父属性列表控件。|
|[CMFCPropertyGridProperty::OnCloseCombo](#onclosecombo)|当关闭属性中包含一个组合框时，由框架调用。|
|[CMFCPropertyGridProperty::OnDblClk](#ondblclk)|当用户双击某个属性时，由框架调用。|
|[CMFCPropertyGridProperty::OnDrawButton](#ondrawbutton)|由框架调用以绘制属性中包含一个按钮。|
|[CMFCPropertyGridProperty::OnDrawDescription](#ondrawdescription)|由框架调用以显示属性说明。|
|[CMFCPropertyGridProperty::OnDrawExpandBox](#ondrawexpandbox)|由框架调用以绘制展开框控件附近包含子属性的属性。|
|[CMFCPropertyGridProperty::OnDrawName](#ondrawname)|由框架调用以显示属性名称。|
|[CMFCPropertyGridProperty::OnDrawValue](#ondrawvalue)|由框架调用以显示属性值。|
|[CMFCPropertyGridProperty::OnEdit](#onedit)|当用户要修改属性值时由框架调用。|
|[CMFCPropertyGridProperty::OnEndEdit](#onendedit)|当用户已完成时由框架调用修改属性值。|
|[CMFCPropertyGridProperty::OnKillSelection](#onkillselection)||
|[CMFCPropertyGridProperty::OnPosSizeChanged](#onpossizechanged)||
|[CMFCPropertyGridProperty::OnRClickName](#onrclickname)|当用户单击属性名称区域中的鼠标右键按钮时由框架调用。|
|[CMFCPropertyGridProperty::OnRClickValue](#onrclickvalue)|当用户单击属性值区域中的鼠标右键按钮时由框架调用。|
|[CMFCPropertyGridProperty::OnSelectCombo](#onselectcombo)|当用户选择某个项的可编辑组合框中，由框架调用。|
|[CMFCPropertyGridProperty::OnSetCursor](#onsetcursor)|当鼠标指针移动到的属性项，由框架调用。|
|[CMFCPropertyGridProperty::OnSetSelection](#onsetselection)||
|[CMFCPropertyGridProperty::OnUpdateValue](#onupdatevalue)|当可编辑属性值已更改时由框架调用。|
|[CMFCPropertyGridProperty::PushChar](#pushchar)|当选择了属性和用户输入新字符时，调用从属性列表控件。|
|[CMFCPropertyGridProperty::Redraw](#redraw)|重绘该属性。|
|[CMFCPropertyGridProperty::RemoveAllOptions](#removealloptions)|从属性中移除所有选项 （项）。|
|[CMFCPropertyGridProperty::RemoveSubItem](#removesubitem)|删除指定的子项目。|
|[CMFCPropertyGridProperty::ResetOriginalValue](#resetoriginalvalue)|还原已编辑属性的原始值。|
|[CMFCPropertyGridProperty::SetData](#setdata)|将 DWORD 值与属性相关联。|
|[CMFCPropertyGridProperty::SetDescription](#setdescription)|指定描述当前属性的文本。|
|[CMFCPropertyGridProperty::SetName](#setname)|设置属性的名称。|
|[CMFCPropertyGridProperty::SetOriginalValue](#setoriginalvalue)|设置可编辑属性的原始值。|
|[CMFCPropertyGridProperty::SetValue](#setvalue)|设置属性网格属性的值。|
|[CMFCPropertyGridProperty::Show](#show)|显示或隐藏属性。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridProperty::CreateCombo](#createcombo)|由框架调用以将组合框添加到属性。|
|[CMFCPropertyGridProperty::HasButton](#hasbutton)|指示属性是否包含一个按钮。|
|[CMFCPropertyGridProperty::Init](#init)|由框架调用以初始化属性对象。|
|[CMFCPropertyGridProperty::IsSubItem](#issubitem)|指示指定的属性是否为当前属性的子项目。|
|[CMFCPropertyGridProperty::IsValueChanged](#isvaluechanged)|指示是否已更改的当前属性的值。|
|[CMFCPropertyGridProperty::OnCtlColor](#onctlcolor)|它必须检索一个画笔来填充属性的背景色时由框架调用。|
|[CMFCPropertyGridProperty::OnDestroyWindow](#ondestroywindow)|销毁一个属性时或在编辑完成后，由框架调用。|
|[CMFCPropertyGridProperty::OnKillFocus](#onkillfocus)|属性失去输入的焦点时由框架调用。|

### <a name="data-members"></a>数据成员

|名称|描述|
|----------|-----------------|
|[CMFCPropertyGridProperty::m_strFormatDouble](#m_strformatdouble)|双精度类型值的格式字符串。|
|[CMFCPropertyGridProperty::m_strFormatFloat](#m_strformatfloat)|类型为 float 的值的格式字符串。|
|[CMFCPropertyGridProperty::m_strFormatLong](#m_strformatlong)|长时间格式的字符串类型的值。|
|[CMFCPropertyGridProperty::m_strFormatShort](#m_strformatshort)|Short 类型的值的格式字符串。|

## <a name="remarks"></a>备注

使用`CMFCPropertyGridProperty`对象以表示属性，然后将你添加到属性列表控件。 有关详细信息，请参阅[CMFCPropertyGridCtrl 类](../../mfc/reference/cmfcpropertygridctrl-class.md)。

属性对象可以表示数据类型，例如字符串、 日期和布尔值或整数值。 它可以包含子属性，也可以包含一个组合框等控件或按钮控件。

## <a name="example"></a>示例

下面的示例演示如何构造`CMFCPropertyGridProperty`对象。 该示例还演示如何使用中的各种方法`CMFCPropertyGridProperty`类添加一个选项，添加个子项、 启用一个属性，并显示属性。 此示例摘自[新的控件示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_NewControls#27](../../mfc/reference/codesnippet/cpp/cmfcpropertygridproperty-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)

## <a name="requirements"></a>要求

**标头：** afxpropertygridctrl.h

##  <a name="addoption"></a>  CMFCPropertyGridProperty::AddOption

将新列表项添加到属性列表控件。

```
BOOL AddOption(
    LPCTSTR lpszOption,
    BOOL bInsertUnique=TRUE);
```

### <a name="parameters"></a>参数

*lpszOption*<br/>
[in]列表项 （选项） 来添加。

*bInsertUnique*<br/>
[in]为 true，则将该列表添加项仅当已存在;否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

为 TRUE，这意味着添加列表项。 否则为 FALSE，这意味着，不是列表项添加，因为*bInsertUnique*参数为 TRUE，且项指定的列表*lpszOption*参数已存在。

### <a name="remarks"></a>备注

##  <a name="addsubitem"></a>  CMFCPropertyGridProperty::AddSubItem

将子项添加到一个属性。

```
BOOL AddSubItem(CMFCPropertyGridProperty* pProp);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向要添加的属性。

### <a name="return-value"></a>返回值

如果指定的属性已成功添加为子属性，则为 TRUE。 如果属性不添加，因为它已经出现在父属性，则为 FALSE。

### <a name="remarks"></a>备注

此方法用于创建属性的层次结构父级和子级的列表。 子属性添加之后，父属性会自动显示一个加号 （+） 指定一个展开框控件。 当用户单击加号时，父属性展开并显示任何子属性项。

##  <a name="adjustbuttonrect"></a>  CMFCPropertyGridProperty::AdjustButtonRect

调用要告知要调整大小的嵌入按钮的边框的属性的父属性列表控件。

```
virtual void AdjustButtonRect();
```

### <a name="remarks"></a>备注

默认情况下，此方法：

- 调整宽度按钮等于按钮的高度加上 3 个像素。

- 将按钮的边界矩形移到该属性的右边缘

- 将该属性的上边缘下方的按钮 1 像素。

##  <a name="adjustinplaceeditrect"></a>  CMFCPropertyGridProperty::AdjustInPlaceEditRect

检索用于设置属性值的文本框和可选数值调节按钮控件的边界。

```
virtual void AdjustInPlaceEditRect(
    CRect& rectEdit,
    CRect& rectSpin);
```

### <a name="parameters"></a>参数

*rectEdit*<br/>
[out]当此方法返回时，指定的属性值的文本框的边界的矩形。

*rectSpin*<br/>
[out]当此方法返回时，指定的属性值的数值调节钮按钮控件的边界的矩形。 或者，如果属性不支持调节按钮，为空矩形。

### <a name="remarks"></a>备注

属性的值区域由一个文本框和可能*选项按钮*，例如数值调节按钮控件。 此方法计算的维度的文本框和选项按钮，然后返回这些值中指定的参数。

##  <a name="allowedit"></a>  CMFCPropertyGridProperty::AllowEdit

使属性是可编辑或只读的。

```
void AllowEdit(BOOL bAllow=TRUE);
```

### <a name="parameters"></a>参数

*bAllow*<br/>
[in]为 TRUE，则使该属性可编辑;如果为 FALSE，则使该属性只读的。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="cmfcpropertygridproperty"></a>  CMFCPropertyGridProperty::CMFCPropertyGridProperty

构造 `CMFCPropertyGridProperty` 对象。

```
CMFCPropertyGridProperty(
    const CString& strGroupName,
    DWORD_PTR dwData=0,
    BOOL bIsValueList=FALSE);

CMFCPropertyGridProperty(
    const CString& strName,
    const _variant_t& varValue,
    LPCTSTR lpszDescr=NULL,
    DWORD_PTR dwData=0,
    LPCTSTR lpszEditMask=NULL,
    LPCTSTR lpszEditTemplate=NULL,
    LPCTSTR lpszValidChars=NULL);
```

### <a name="parameters"></a>参数

*strGroupName*<br/>
[in]组名称。 一个*组*是在属性网格控件中的相关属性的集合。 如果控件按层次结构，显示*组名称*显示为组上方的行中的类别标题。

*dwData*<br/>
[in]特定于应用程序的数据，如整数或与属性关联的其他数据的指针。 默认值为 0。

*strName*<br/>
[in]属性的名称。

*varValue*<br/>
[in]属性值中。

*lpszDescr*<br/>
[in]属性说明。 默认值为 NULL。

*lpszEditMask*<br/>
[in]编辑掩码中，如果属性是掩码的编辑控件。 默认值为 NULL。

*lpszEditTemplate*<br/>
[in]编辑模板中，如果属性是掩码的编辑控件。 默认值为 NULL。

*lpszValidChars*<br/>
[in]如果该属性是掩码的编辑控件的有效字符的列表。 默认值为 NULL。

*bIsValueList*<br/>
[in]如果该属性表示一系列值; 则为 TRUE如果该属性表示的单个值，则为 FALSE。 默认值是 FALSE。

### <a name="remarks"></a>备注

##  <a name="createcombo"></a>  CMFCPropertyGridProperty::CreateCombo

由框架调用以将组合框添加到属性。

```
virtual CComboBox* CreateCombo(
    CWnd* pWndParent,
    CRect rect);
```

### <a name="parameters"></a>参数

*pWndParent*<br/>
[in]向组合框的父窗口的指针。

*rect*<br/>
[in]组合框的边框。

### <a name="return-value"></a>返回值

指向新指针[CComboBox](../../mfc/reference/ccombobox-class.md)对象。

### <a name="remarks"></a>备注

##  <a name="createinplaceedit"></a>  CMFCPropertyGridProperty::CreateInPlaceEdit

由框架调用以创建可编辑的控件的属性。

```
virtual CWnd* CreateInPlaceEdit(
    CRect rectEdit,
    BOOL& bDefaultFormat);
```

### <a name="parameters"></a>参数

*rectEdit*<br/>
[in]可编辑控件的边框。

*bDefaultFormat*<br/>
[in]为 TRUE，则使用默认属性格式设置的可编辑的控件; 文本否则为 FALSE。

### <a name="return-value"></a>返回值

如果此方法成功，则可编辑的控件指针否则，为 NULL。

### <a name="remarks"></a>备注

此方法使用的值*varValue*， *lpszEditMask*， *lpszEditTemplate*，以及*lpszValidChars*参数中指定[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)类构造函数。 默认情况下，此方法支持*varValue*变体类型。 这包括 VT_BSTR、 VT_R4、 VT_R8、 VT_UI1、 VT_I2、 VT_INT、 VT_UINT、 VT_I4、 VT_UI2、 VT_UI4 和 VT_BOOL。

此方法创建[CMFCMaskedEdit](../../mfc/reference/cmfcmaskededit-class.md)如果一个或多个控制*lpszEditMask*， *lpszEditTemplate*，或者*lpszValidChars*指定参数;否则，它会创建[CEdit](../../mfc/reference/cedit-class.md)控件。

##  <a name="createspincontrol"></a>  CMFCPropertyGridProperty::CreateSpinControl

由框架调用以创建一个可编辑数值调节钮按钮控件。

```
virtual CSpinButtonCtrl* CreateSpinControl(CRect rectSpin);
```

### <a name="parameters"></a>参数

*rectSpin*<br/>
[in]定义其中创建可编辑调节钮控件的矩形。

### <a name="return-value"></a>返回值

指向一个新的指针[CMFCSpinButtonCtrl](../../mfc/reference/cmfcspinbuttonctrl-class.md)强制转换为指向指针的对象[CSpinButtonCtrl](../../mfc/reference/cspinbuttonctrl-class.md)对象。

### <a name="remarks"></a>备注

调用[CMFCPropertyGridProperty::EnableSpinControl](#enablespincontrol)方法的属性的右边缘显示一个可编辑数值调节钮按钮控件。

##  <a name="enable"></a>  CMFCPropertyGridProperty::Enable

启用或禁用一个属性。

```
void Enable(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]为 true 以启用您的属性。如果为 FALSE，则若要禁用的属性。 已禁用的属性不响应鼠标或键盘输入。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="enablespincontrol"></a>  CMFCPropertyGridProperty::EnableSpinControl

启用或禁用调节按钮控件用于修改属性值。

```
void EnableSpinControl(
    BOOL bEnable=TRUE,
    int nMin=0,
    int nMax=0);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
[in]为 true 以启用调节钮控件;如果为 FALSE 禁用调节钮控件。 默认值为 TRUE。

*nMin*<br/>
[in]调节钮控件最小值。 默认值为 0。

*nMax*<br/>
[in]调节钮控件的最大值。 默认值为 0。

### <a name="remarks"></a>备注

属性是要对其进行编辑时，框架自动创建数值调节按钮控件。

指定的属性类型*varValue*的参数[CMFCPropertyGridProperty::CMFCPropertyGridProperty](#cmfcpropertygridproperty)构造函数，必须是受支持的变体类型。 否则，此方法在调试模式中断言。 支持的类型包括 VT_INT、 VT_UINT、 VT_I2、 VT_I4、 VT_UI2 和 VT_UI4。

##  <a name="expand"></a>  CMFCPropertyGridProperty::Expand

展开或折叠包含子属性的属性。

```
void Expand(BOOL bExpand=TRUE);
```

### <a name="parameters"></a>参数

*bExpand*<br/>
[in]为 TRUE，则展开您的属性。为 FALSE，则折叠属性。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="formatproperty"></a>  CMFCPropertyGridProperty::FormatProperty

设置属性值的文本表示形式的格式。

```
virtual CString FormatProperty();
```

### <a name="return-value"></a>返回值

属性值的文本表示形式。

### <a name="remarks"></a>备注

在显示的属性值之前，由框架调用此方法。

##  <a name="getdata"></a>  CMFCPropertyGridProperty::GetData

检索与属性关联的 DWORD 值。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

一个 DWORD 值。

### <a name="remarks"></a>备注

返回的数据是特定于应用程序的值，如数字或其他数据的指针。 指定的数据值在构造属性时或调用[CMFCPropertyGridProperty::SetData](#setdata)方法。

##  <a name="getdescription"></a>  CMFCPropertyGridProperty::GetDescription

检索的属性说明。

```
const CString& GetDescription() const;
```

### <a name="return-value"></a>返回值

包含属性说明的文本字符串。

### <a name="remarks"></a>备注

属性列表控件还使用此方法来显示属性的说明。

##  <a name="getexpandedsubitems"></a>  CMFCPropertyGridProperty::GetExpandedSubItems

检索扩展的子项目数。

```
int GetExpandedSubItems(BOOL bIncludeHidden=TRUE) const;
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*bIncludeHidden*|[in]为 TRUE，则将隐藏子项包含到计数中;否则为 FALSE。 默认值为 TRUE。|

### <a name="return-value"></a>返回值

展开子项目数。

### <a name="remarks"></a>备注

##  <a name="gethierarchylevel"></a>  CMFCPropertyGridProperty::GetHierarchyLevel

检索属性的层次结构级别的从零开始的索引。

```
int GetHierarchyLevel() const;
```

### <a name="return-value"></a>返回值

该属性的层次结构级别。

### <a name="remarks"></a>备注

##  <a name="getname"></a>  CMFCPropertyGridProperty::GetName

检索的属性的名称。

```
LPCTSTR GetName() const;
```

### <a name="return-value"></a>返回值

包含属性名称的字符串指针。

### <a name="remarks"></a>备注

##  <a name="getnametooltip"></a>  CMFCPropertyGridProperty::GetNameTooltip

由框架调用以在工具提示中显示的属性的名称。

```
virtual CString GetNameTooltip();
```

### <a name="return-value"></a>返回值

一个包含属性名称的字符串。 默认情况下，返回值为空字符串。

### <a name="remarks"></a>备注

##  <a name="getoption"></a>  CMFCPropertyGridProperty::GetOption

检索由索引指定选项的文本。

```
LPCTSTR GetOption(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
属性列表项 （选项） 来检索的从零开始的索引。

### <a name="return-value"></a>返回值

包含选项文本的字符串指针。

### <a name="remarks"></a>备注

##  <a name="getoptioncount"></a>  CMFCPropertyGridProperty::GetOptionCount

检索属于某个属性的选项数。

```
int GetOptionCount() const;
```

### <a name="return-value"></a>返回值

属性控件中包含的属性列表项 （选项） 数。

### <a name="remarks"></a>备注

调用[CMFCPropertyGridProperty::AddOption](#addoption)方法将项添加到属性列表。 调用[CMFCPropertyGridProperty::RemoveAllOptions](#removealloptions)方法中删除所有项。

##  <a name="getoriginalvalue"></a>  CMFCPropertyGridProperty::GetOriginalValue

检索当前属性的初始值。

```
const COleVariant& GetOriginalValue() const;
```

### <a name="return-value"></a>返回值

当前属性的原始值。

### <a name="remarks"></a>备注

此方法用于撤消更改当前属性的值编辑操作的效果。

设置当前属性的原始值[CMFCPropertyGridProperty::CMFCPropertyGridProperty](#cmfcpropertygridproperty)构造函数中，通过修改[CMFCPropertyGridProperty::SetOriginalValue](#setoriginalvalue)方法通过和重置[cmfcpropertygridproperty:: Resetoriginalvalue](#resetoriginalvalue)方法。

##  <a name="getparent"></a>  CMFCPropertyGridProperty::GetParent

检索指向父属性。

```
CMFCPropertyGridProperty* GetParent() const;
```

### <a name="return-value"></a>返回值

指向父属性对象，则为 NULL 的顶级属性的指针。

### <a name="remarks"></a>备注

##  <a name="getrect"></a>  CMFCPropertyGridProperty::GetRect

检索一个属性的边框。

```
CRect GetRect() const;
```

### <a name="return-value"></a>返回值

一个[CRect](../../atl-mfc-shared/reference/crect-class.md)对象，描述的边框。

### <a name="remarks"></a>备注

##  <a name="getsubitem"></a>  CMFCPropertyGridProperty::GetSubItem

检索由从零开始的索引标识的子属性。

```
CMFCPropertyGridProperty* GetSubItem(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[in]要检索的属性的从零开始的索引。 此参数是无效的如果它小于零或大于或等于子属性的数目。

### <a name="return-value"></a>返回值

指向为此属性的子项的属性对象的指针。

或

在零售模式下，如果为 NULL *nIndex*参数无效。 在调试模式下，此方法断言。

### <a name="remarks"></a>备注

##  <a name="getsubitemscount"></a>  CMFCPropertyGridProperty::GetSubItemsCount

检索子项目数。

```
int GetSubItemsCount() const;
```

### <a name="return-value"></a>返回值

子项目数。

### <a name="remarks"></a>备注

##  <a name="getvalue"></a>  CMFCPropertyGridProperty::GetValue

检索一个属性值。

```
virtual const _variant_t& GetValue() const;
```

### <a name="return-value"></a>返回值

包含属性值的变量。

### <a name="remarks"></a>备注

##  <a name="getvaluetooltip"></a>  CMFCPropertyGridProperty::GetValueTooltip

由框架调用以检索属性值，然后在工具提示中显示的文本表示形式。

```
virtual CString GetValueTooltip();
```

### <a name="return-value"></a>返回值

一个`CString`对象，其中包含的属性值的文本表示形式。 默认情况下，此值为空字符串。

### <a name="remarks"></a>备注

##  <a name="hasbutton"></a>  CMFCPropertyGridProperty::HasButton

指示属性是否包含一个按钮。

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>返回值

如果属性包含按钮 （或属性列表） 中;否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="hittest"></a>  CMFCPropertyGridProperty::HitTest

指向对应于对应于一个点的属性列表项的属性对象。

```
CMFCPropertyGridProperty* HitTest(
    CPoint point,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL);

CMFCPropertyGridProperty* HitTest(
    CPoint pt,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL,
    BOOL bPropsOnly=FALSE) const;
```

### <a name="parameters"></a>参数

*point*<br/>
[in]要在工作区坐标中测试的点。 此参数通常是当前鼠标指针位置。

*pt*<br/>
[in]要在工作区坐标中测试的点。

*pnArea*<br/>
[out]此方法返回时，指示包含指定的点的区域。 有关更多信息，请参见“备注”。 默认值为 NULL。

*bPropsOnly*<br/>
[in]若要测试属性控件; 中的任何区域，则返回 TRUE为 FALSE，则测试只描述区域。 默认值是 FALSE。

### <a name="return-value"></a>返回值

与属性的对象或为 NULL 指针。

### <a name="remarks"></a>备注

默认情况下，此方法测试属性的子项，如果任一属性项中找不到指定的点。

下表列出了可以返回到的值*pnArea*参数。

|区域|描述|
|----------|-----------------|
|`ClickArea::ClickExpandBox`|展开框控件由下面一个加号 （+）。|
|`ClickArea::ClickName`|属性名称。|
|`ClickArea::ClickValue`|属性值。|

##  <a name="init"></a>  CMFCPropertyGridProperty::Init

由框架调用以初始化属性对象。

```
void Init();
```

### <a name="remarks"></a>备注

##  <a name="isallowedit"></a>  CMFCPropertyGridProperty::IsAllowEdit

指示属性是否可编辑。

```
BOOL IsAllowEdit() const;
```

### <a name="return-value"></a>返回值

如果该属性是可编辑; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isenabled"></a>  CMFCPropertyGridProperty::IsEnabled

指示属性是启用还是禁用。

```
BOOL IsEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用该属性; 则为 TRUE如果禁用了该属性为 FALSE。

### <a name="remarks"></a>备注

指示属性是启用还是禁用。

##  <a name="isexpanded"></a>  CMFCPropertyGridProperty::IsExpanded

指示属性是否是展开还是折叠。

```
BOOL IsExpanded() const;
```

### <a name="return-value"></a>返回值

如果该属性已展开，则为 TRUE如果该属性处于折叠状态，则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isgroup"></a>  CMFCPropertyGridProperty::IsGroup

指示当前属性是否表示一个组。

```
BOOL IsGroup() const;
```

### <a name="return-value"></a>返回值

如果当前的属性对象表示一组; 则为 TRUE如果该属性表示一个值，则为 FALSE。

### <a name="remarks"></a>备注

一个*组*是在属性网格控件中的相关属性的集合。 如果控件按层次结构，显示*组名称*显示为组上方的行中的类别标题。

##  <a name="isinplaceediting"></a>  CMFCPropertyGridProperty::IsInPlaceEditing

指示当前属性是否可编辑。

```
BOOL IsInPlaceEditing() const;
```

### <a name="return-value"></a>返回值

如果当前的属性是可编辑; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="ismodified"></a>  CMFCPropertyGridProperty::IsModified

指示是否修改当前属性。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>返回值

如果修改此属性; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isparentexpanded"></a>  CMFCPropertyGridProperty::IsParentExpanded

指示是否展开当前属性的父级。

```
BOOL IsParentExpanded() const;
```

### <a name="return-value"></a>返回值

如果展开所有父级的当前属性; 则为 TRUE如果父属性处于折叠状态，则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isselected"></a>  CMFCPropertyGridProperty::IsSelected

指示是否选择当前的属性。

```
virtual BOOL IsSelected() const;
```

### <a name="return-value"></a>返回值

如果当前的属性处于选中状态，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="issubitem"></a>  CMFCPropertyGridProperty::IsSubItem

指示指定的属性是否为当前属性的子项目。

```
BOOL IsSubItem(CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]属性指向的指针。

### <a name="return-value"></a>返回值

如果指定的属性的子项目的当前属性; 则为 TRUE否则为 FALSE。

##  <a name="isvaluechanged"></a>  CMFCPropertyGridProperty::IsValueChanged

指示是否已更改的当前属性的值。

```
virtual BOOL IsValueChanged() const;
```

### <a name="return-value"></a>返回值

如果当前属性的值已更改; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="isvisible"></a>  CMFCPropertyGridProperty::IsVisible

指示当前属性是否可见。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>返回值

如果当前属性可见，则为 TRUE否则为如果为 FALSE。

### <a name="remarks"></a>备注

##  <a name="m_strformatdouble"></a>  CMFCPropertyGridProperty::m_strFormatDouble

包含双精度类型的值的格式字符串。

```
static CString m_strFormatDouble;
```

### <a name="remarks"></a>备注

##  <a name="m_strformatfloat"></a>  CMFCPropertyGridProperty::m_strFormatFloat

包含类型为 float 的值的格式字符串。

```
static CString m_strFormatFloat;
```

### <a name="remarks"></a>备注

##  <a name="m_strformatlong"></a>  CMFCPropertyGridProperty::m_strFormatLong

包含的类型为 long 值的格式字符串。

```
static CString m_strFormatLong;
```

### <a name="remarks"></a>备注

##  <a name="m_strformatshort"></a>  CMFCPropertyGridProperty::m_strFormatShort

包含短类型的值的格式字符串。

```
static CString m_strFormatShort;
```

### <a name="remarks"></a>备注

##  <a name="onclickbutton"></a>  CMFCPropertyGridProperty::OnClickButton

当用户单击属性中包含的按钮时，由框架调用。

```
virtual void OnClickButton(CPoint point);
```

### <a name="parameters"></a>参数

*point*<br/>
[in]客户端坐标中的点。

### <a name="remarks"></a>备注

默认情况下，此方法没有任何影响。

##  <a name="onclickname"></a>  CMFCPropertyGridProperty::OnClickName

当用户单击某个属性的名称字段时，调用由父属性列表控件。

```
virtual void OnClickName(CPoint C);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*C*|[in]客户端坐标中的点。|

### <a name="remarks"></a>备注

默认情况下，此方法没有任何影响。

##  <a name="onclickvalue"></a>  CMFCPropertyGridProperty::OnClickValue

当用户单击某个属性的值字段时，调用由父属性列表控件。

```
virtual BOOL OnClickValue(
    UINT uiMsg,
    CPoint point);
```

### <a name="parameters"></a>参数

*uiMsg*<br/>
[in]鼠标消息。

*point*<br/>
[in]客户端坐标中的点。

### <a name="return-value"></a>返回值

如果指定的鼠标消息处理通过此方法; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法返回 FALSE，如果当前的属性不是可编辑。 否则为编辑或与此属性关联的数值调节钮控件处理指定的鼠标消息，并且该方法将返回 TRUE。

##  <a name="onclosecombo"></a>  CMFCPropertyGridProperty::OnCloseCombo

当关闭属性中包含一个组合框时，由框架调用。

```
virtual void OnCloseCombo();
```

### <a name="remarks"></a>备注

##  <a name="onctlcolor"></a>  CMFCPropertyGridProperty::OnCtlColor

它必须检索一个画笔来填充属性的背景色时由框架调用。

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文指针。

*nCtlColor*<br/>
[in]（是未使用此参数。）

### <a name="return-value"></a>返回值

如果此方法成功; 画笔的句柄否则，为 NULL。

### <a name="remarks"></a>备注

##  <a name="ondblclk"></a>  CMFCPropertyGridProperty::OnDblClk

当用户双击某个属性时，由框架调用。

```
virtual BOOL OnDblClk(CPoint point);
```

### <a name="parameters"></a>参数

*point*<br/>
[in]客户端坐标中的点。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法选择属性列表控件中的下一步的属性项。

##  <a name="ondestroywindow"></a>  CMFCPropertyGridProperty::OnDestroyWindow

销毁一个属性时或在编辑完成后，由框架调用。

```
virtual void OnDestroyWindow();
```

### <a name="remarks"></a>备注

##  <a name="ondrawbutton"></a>  CMFCPropertyGridProperty::OnDrawButton

由框架调用以绘制属性中包含一个按钮。

```
virtual void OnDrawButton(
    CDC* pDC,
    CRect rectButton);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rectButton*<br/>
[in]指定位置绘制一个按钮边框。

### <a name="remarks"></a>备注

##  <a name="ondrawdescription"></a>  CMFCPropertyGridProperty::OnDrawDescription

由框架调用以绘制属性说明。

```
virtual void OnDrawDescription(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rect*<br/>
[in]指定要绘制的属性说明的位置的边界矩形。

### <a name="remarks"></a>备注

默认情况下，此方法中使用父属性列表控件的字体绘制的属性名称和描述。 在常规样式绘制的属性说明和属性名称中粗体样式绘制。

##  <a name="ondrawexpandbox"></a>  CMFCPropertyGridProperty::OnDrawExpandBox

由框架调用以绘制展开框控件附近包含子属性的属性。

```
virtual void OnDrawExpandBox(
    CDC* pDC,
    CRect rectExpand);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rectExpand*<br/>
[in]指定要绘制展开框控件的位置的边界矩形。

### <a name="remarks"></a>备注

单击展开框控件以展开或折叠子属性的列表。 展开框控件由下面的正方形中包含一个加号 （+） 或减号 （-）。 加号指示可以展开该属性以显示子属性的列表。 减号符号表示可折叠列表以显示属性。

##  <a name="ondrawname"></a>  CMFCPropertyGridProperty::OnDrawName

由框架调用以显示属性名称。

```
virtual void OnDrawName(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rect*<br/>
[in]指定要绘制的属性名称的位置的边界矩形。

### <a name="remarks"></a>备注

##  <a name="ondrawvalue"></a>  CMFCPropertyGridProperty::OnDrawValue

由框架调用以显示属性值。

```
virtual void OnDrawValue(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[in]指向设备上下文的指针。

*rect*<br/>
[in]指定要绘制的属性值的位置的边界矩形。

### <a name="remarks"></a>备注

##  <a name="onedit"></a>  CMFCPropertyGridProperty::OnEdit

当用户要修改属性值时由框架调用。

```
virtual BOOL OnEdit(LPPOINT lptClick);
```

### <a name="parameters"></a>参数

*lptClick*<br/>
[in]（是未使用此参数。）指向客户端坐标中的点的指针。

### <a name="return-value"></a>返回值

如果编辑操作启动成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

当用户要修改的属性值时，由框架调用此函数。 默认情况下，此方法启动的组合框控件或数值调节钮控件在适当的编辑器。

##  <a name="onendedit"></a>  CMFCPropertyGridProperty::OnEndEdit

当用户已完成时由框架调用修改属性值。

```
virtual BOOL OnEndEdit();
```

### <a name="return-value"></a>返回值

此方法始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法销毁当前编辑控件，然后返回 TRUE。

##  <a name="onkillfocus"></a>  CMFCPropertyGridProperty::OnKillFocus

属性失去输入的焦点时由框架调用。

```
virtual BOOL OnKillFocus(CWnd*);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*CWnd*|[in]（未使用。）指向窗口的指针。|

### <a name="return-value"></a>返回值

此方法始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作，然后返回 TRUE。 如果重写此方法，则返回 TRUE，如果属性失去输入的焦点时，框架可以结束编辑操作。

##  <a name="onkillselection"></a>  CMFCPropertyGridProperty::OnKillSelection

```
virtual void OnKillSelection(CMFCPropertyGridProperty*);
```

### <a name="parameters"></a>参数

[in] *CMFCPropertyGridProperty&#42;*<br/>

### <a name="remarks"></a>备注

默认情况下，此方法没有任何影响。

##  <a name="onpossizechanged"></a>  CMFCPropertyGridProperty::OnPosSizeChanged

```
virtual void OnPosSizeChanged(CRect);
```

### <a name="parameters"></a>参数

[in] *CRect*<br/>

### <a name="remarks"></a>备注

默认情况下，此方法没有任何影响。

##  <a name="onrclickname"></a>  CMFCPropertyGridProperty::OnRClickName

当用户单击属性名称区域中的鼠标右键按钮时由框架调用。

```
virtual void OnRClickName(CPoint C);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*C*|[in]客户端坐标中的点。|

### <a name="remarks"></a>备注

默认情况下，此方法没有任何影响。

##  <a name="onrclickvalue"></a>  CMFCPropertyGridProperty::OnRClickValue

当用户单击属性值区域中的鼠标右键按钮时由框架调用。

```
virtual void OnRClickValue(
    CPoint C,
    BOOL B);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*C*|[in]客户端坐标中的点。|
|*B*|[in]一个布尔值。|

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作并*B*参数的任何预定义的用途。

##  <a name="onselectcombo"></a>  CMFCPropertyGridProperty::OnSelectCombo

当用户选择某个项的可编辑组合框中，由框架调用。

```
virtual void OnSelectCombo();
```

### <a name="remarks"></a>备注

默认情况下，此方法使用所选的项的文本来更新属性值。

##  <a name="onsetcursor"></a>  CMFCPropertyGridProperty::OnSetCursor

当鼠标指针移动到的属性项，由框架调用。

```
virtual BOOL OnSetCursor() const;
```

### <a name="return-value"></a>返回值

如果当前属性为 variant 类型的值类型或一系列值，并且此方法成功加载插入点 （i 形） 的鼠标光标; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此方法支持以下变量类型：VT_INT、 VT_I2、 VT_I4、 VT_UINT、 VT_UI1、 VT_UI2、 VT_UI4、 VT_R4、 VT_R8 和 VT_BSTR。

##  <a name="onsetselection"></a>  CMFCPropertyGridProperty::OnSetSelection

```
virtual void OnSetSelection CMFCPropertyGridProperty*);
```

### <a name="parameters"></a>参数

[in] *CMFCPropertyGridProperty&#42;*<br/>

### <a name="remarks"></a>备注

默认情况下，此方法没有任何影响。

##  <a name="onupdatevalue"></a>  CMFCPropertyGridProperty::OnUpdateValue

当可编辑属性值已更改时由框架调用。

```
virtual BOOL OnUpdateValue();
```

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

##  <a name="pushchar"></a>  CMFCPropertyGridProperty::PushChar

当选择了属性和用户输入新字符时，调用从属性列表控件。

```
virtual BOOL PushChar(UINT nChar);
```

### <a name="parameters"></a>参数

*nChar*<br/>
[in]一个字符。

### <a name="return-value"></a>返回值

如果编辑操作仍在继续; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

此方法支持一个属性，它是一系列值或以下的变体类型之一：VT_INT、 VT_I2、 VT_I4、 VT_UINT、 VT_UI1、 VT_UI2、 VT_UI4、 VT_R4、 VT_R8 和 VT_BSTR。

##  <a name="redraw"></a>  CMFCPropertyGridProperty::Redraw

重绘该属性。

```
void Redraw();
```

### <a name="remarks"></a>备注

##  <a name="removealloptions"></a>  CMFCPropertyGridProperty::RemoveAllOptions

从属性中移除所有选项 （项）。

```
void RemoveAllOptions();
```

### <a name="remarks"></a>备注

选项也称为为列表项的属性列表控件。

##  <a name="removesubitem"></a>  CMFCPropertyGridProperty::RemoveSubItem

删除指定的子项目。

```
BOOL RemoveSubItem(
    CMFCPropertyGridProperty*& pProp,
    BOOL bDelete=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[in]指向属性个子项的指针。

*bDelete*<br/>
[in]为 true，则删除指定的属性对象*pProp*参数; 否则为 FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

为 FALSE 指定*bDelete*参数，如果你想要移动指定的子项目; 也就是说，删除子项，并再将其添加到其他位置。

##  <a name="resetoriginalvalue"></a>  CMFCPropertyGridProperty::ResetOriginalValue

还原已编辑属性的原始值。

```
virtual void ResetOriginalValue();
```

### <a name="remarks"></a>备注

##  <a name="setdata"></a>  CMFCPropertyGridProperty::SetData

将 DWORD 值与属性相关联。

```
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*dwData*<br/>
[in]特定于应用程序的 32 位值，如整数或其他数据的指针。

### <a name="remarks"></a>备注

使用[CMFCPropertyGridProperty::GetData](#getdata)方法来检索其中的 DWORD 值。 使用[CMFCPropertyGridCtrl::FindItemByData](../../mfc/reference/cmfcpropertygridctrl-class.md#finditembydata)方法找到与指定的 DWORD 值相关联的属性列表项。

##  <a name="setdescription"></a>  CMFCPropertyGridProperty::SetDescription

指定描述当前属性的文本。

```
void SetDescription(const CString& strDescr);
```

### <a name="parameters"></a>参数

*strDescr*<br/>
[in]描述当前属性的文本。

### <a name="remarks"></a>备注

##  <a name="setname"></a>  CMFCPropertyGridProperty::SetName

设置属性的名称。

```
void SetName(
    LPCTSTR lpszName,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*lpszName*<br/>
[in]属性名称。

*bRedraw*<br/>
[in]若要立即; 重绘该属性，则返回 TRUE否则为 FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

##  <a name="setoriginalvalue"></a>  CMFCPropertyGridProperty::SetOriginalValue

设置可编辑属性的原始值。

```
virtual void SetOriginalValue(const COleVariant& varValue);
```

### <a name="parameters"></a>参数

*varValue*<br/>
[in]一个值。

### <a name="remarks"></a>备注

使用[cmfcpropertygridproperty:: Resetoriginalvalue](#resetoriginalvalue)方法来重置已编辑属性的原始值。

##  <a name="setvalue"></a>  CMFCPropertyGridProperty::SetValue

设置属性网格属性的值。

```
virtual void SetValue(const _variant_t& varValue);
```

### <a name="parameters"></a>参数

*varValue*<br/>
[in]一个值对的引用。

### <a name="remarks"></a>备注

##  <a name="show"></a>  CMFCPropertyGridProperty::Show

显示或隐藏属性。

```
void Show(
    BOOL bShow=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>参数

*bShow*<br/>
[in]为 TRUE，则显示当前属性和其子项目;如果为 FALSE，则若要隐藏的当前属性和其子项目。 默认值为 TRUE。

*bAdjustLayout*<br/>
[in]为 TRUE，则重新计算如何绘制标签和属性的值，然后绘制您的属性。为 FALSE，则使用现有的计算来绘制属性。 默认值为 TRUE。

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPropertyGridCtrl 类](../../mfc/reference/cmfcpropertygridctrl-class.md)
