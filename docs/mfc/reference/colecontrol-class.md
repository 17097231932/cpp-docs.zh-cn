---
title: COleControl ç±» |Microsoft Docs
ms.custom: ''
ms.date: 08/27/2018
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: d3c5f68d35c4cf77073de3f8d2e6090f62a6dae2
ms.sourcegitcommit: 913c3bf23937b64b90ac05181fdff3df947d9f1c
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/18/2018
ms.locfileid: "46050094"
---
# <a name="colecontrol-class"></a>COleControl ç±»
ç¨äºå¼å OLE æ§ä»¶çéè¦åºç±»ã

## <a name="syntax"></a>è¯­æ³

```
class COleControl : public CWnd
```

## <a name="members"></a>æå

### <a name="public-constructors"></a>å¬å±æé å½æ°

|åç§°|æè¿°|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|åå»ºä¸ä¸ª `COleControl` å¯¹è±¡ã|

### <a name="public-methods"></a>å¬å±æ¹æ³

|åç§°|æè¿°|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|æ£ç´¢å½åæ§ä»¶çå¤è§ã|
|[COleControl::AmbientBackColor](#ambientbackcolor)|è¿åç¯å¢ BackColor å±æ§çå¼ã|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|æå®¹å¨è¿åæå®æ§ä»¶çåç§°ã|
|[COleControl::AmbientFont](#ambientfont)|è¿åç¯å¢å­ä½å±æ§çå¼ã|
|[COleControl::AmbientForeColor](#ambientforecolor)|è¿åç¯å¢åæ¯è²å±æ§çå¼ã|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|è¿åå®¹å¨çåºåè®¾ç½® idã|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|è¿åç±å®¹å¨æç¨çåä½ç±»åã|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|ç¡®å®æ¯å¦åºæ¾ç¤ºæ¡æã|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|ç¡®å®æ¯å¦åºæ¾ç¤ºé´å½±ã|
|[COleControl::AmbientTextAlign](#ambienttextalign)|è¿åæå®çå®¹å¨çææ¬å¯¹é½æ¹å¼çç±»åã|
|[COleControl::AmbientUIDead](#ambientuidead)|ç¡®å®æ¯å¦æ§ä»¶åºååºç¨æ·çé¢æä½ã|
|[COleControl::AmbientUserMode](#ambientusermode)|ç¡®å®å®¹å¨çæ¨¡å¼ã|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|éç¥å®¹å¨ç»å®çå±æ§å·²æ´æ¹ã|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|è¥è¦ç¼è¾çå±æ§å¼çè¯·æ±æéã|
|[COleControl::ClientToParent](#clienttoparent)|å°è½¬æ¢ä¸ºç¸å¯¹äºæ§ä»¶çåç¹å°ç¹ç¸å¯¹äºå¶å®¹å¨çæºç¹ã|
|[COleControl::ClipCaretRect](#clipcaretrect)|å¦æå®ç±æ§ä»¶éå ï¼è¯·è°æ´ä¸ä¸ªæå¥ç¬¦å·çç©å½¢ã|
|[COleControl::ControlInfoChanged](#controlinfochanged)|è°ç¨æ­¤å½æ°åå·²æ´æ¹çå¤çç±æ§ä»¶çå©è®°é®éã|
|[COleControl::DisplayError](#displayerror)|ä¸ºæ§ä»¶çç¨æ·æ¾ç¤ºå¸¸ç¨çéè¯¯äºä»¶ã|
|[COleControl::DoClick](#doclick)|å®ç°çè¡ç¥¨`DoClick`æ¹æ³ã|
|[COleControl::DoPropExchange](#dopropexchange)|åºååçå±æ§`COleControl`å¯¹è±¡ã|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|éç» OLE æ§ä»¶ç Windows æ§ä»¶å­ç±»å«ã|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|æ§ä»¶æ¯æç®åæ¡æ¶ã|
|[COleControl::ExchangeExtent](#exchangeextent)|åºååè¯¥æ§ä»¶çå®½åº¦åé«åº¦ã|
|[COleControl::ExchangeStockProps](#exchangestockprops)|åºååè¯¥æ§ä»¶çå¸¸ç¨å±æ§ã|
|[COleControl::ExchangeVersion](#exchangeversion)|åºååè¯¥æ§ä»¶ççæ¬å·ã|
|[COleControl::FireClick](#fireclick)|è§¦åè¡ç¥¨`Click`äºä»¶ã|
|[COleControl::FireDblClick](#firedblclick)|è§¦åè¡ç¥¨`DblClick`äºä»¶ã|
|[COleControl::FireError](#fireerror)|è§¦åè¡ç¥¨`Error`äºä»¶ã|
|[COleControl::FireEvent](#fireevent)|è§¦åèªå®ä¹äºä»¶ã|
|[COleControl::FireKeyDown](#firekeydown)|è§¦åè¡ç¥¨`KeyDown`äºä»¶ã|
|[COleControl::FireKeyPress](#firekeypress)|è§¦åè¡ç¥¨`KeyPress`äºä»¶ã|
|[COleControl::FireKeyUp](#firekeyup)|è§¦åè¡ç¥¨`KeyUp`äºä»¶ã|
|[COleControl::FireMouseDown](#firemousedown)|è§¦åè¡ç¥¨`MouseDown`äºä»¶ã|
|[COleControl::FireMouseMove](#firemousemove)|è§¦åè¡ç¥¨`MouseMove`äºä»¶ã|
|[COleControl::FireMouseUp](#firemouseup)|è§¦åè¡ç¥¨`MouseUp`äºä»¶ã|
|[COleControl::FireReadyStateChange](#firereadystatechange)|è§¦åäºä»¶æ¶è¯¥æ§ä»¶çå°±ç»ªç¶ææ´æ¹ã|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|æ´æ¹æ¯æçæ§ä»¶çé»è®¤æ¿æ´»è¡ä¸º`IPointerInactive`æ¥å£ã|
|[COleControl::GetAmbientProperty](#getambientproperty)|è¿åæå®çç¯å¢å±æ§çå¼ã|
|[COleControl::GetAppearance](#getappearance)|è¿åå¸¸ç¨çå¤è§å±æ§çå¼ã|
|[COleControl::GetBackColor](#getbackcolor)|è¿åè¡ç¥¨ BackColor å±æ§çå¼ã|
|[COleControl::GetBorderStyle](#getborderstyle)|è¿åå¸¸ç¨çè¾¹æ¡æ ·å¼å±æ§çå¼ã|
|[COleControl::GetCapture](#getcapture)|ç¡®å®ä¸ä¸ªæ çªå£æ¿æ´»çæ§ä»¶å¯¹è±¡æ¯å¦å·æé¼ æ æè·ã|
|[COleControl::GetClassID](#getclassid)|æ£ç´¢æ§ä»¶ç OLE ç±» IDã|
|[COleControl::GetClientOffset](#getclientoffset)|æ£ç´¢æ§ä»¶çç©å½¢åºåå·¦ä¸çè§åå¶å·¥ä½åºçå·¦ä¸çè§çåºå«ã|
|[COleControl::GetClientRect](#getclientrect)|æ£ç´¢æ§ä»¶çå·¥ä½åºçå¤§å°ã|
|[COleControl::GetClientSite](#getclientsite)|å°æ¥è¯¢ä¸ä¸ªå¯¹è±¡ï¼ç¨äºæåå¶å½åçå®¢æ·ç«¯ç«ç¹ï¼å¨å¶å®¹å¨åçæéã|
|[COleControl::GetControlFlags](#getcontrolflags)|æ£ç´¢æ§å¶æ å¿è®¾ç½®ã|
|[COleControl::GetControlSize](#getcontrolsize)|è¿åçä½ç½®å OLE æ§ä»¶çå¤§å°ã|
|[COleControl::GetDC](#getdc)|æä¾ä¸ç§æ çªå£æ§ä»¶ä»å¶å®¹å¨ä¸­è·åçè®¾å¤ä¸ä¸æã|
|[COleControl::GetEnabled](#getenabled)|è¿åè¡ç¥¨ Enabled å±æ§çå¼ã|
|[COleControl::GetExtendedControl](#getextendedcontrol)|æ£ç´¢æåå±äºå®¹å¨çæ©å±çæ§ä»¶å¯¹è±¡çæéã|
|[COleControl::GetFocus](#getfocus)|ç¡®å®æ§ä»¶æ¯å¦å·æç¦ç¹ã|
|[COleControl::GetFont](#getfont)|è¿åå¸¸ç¨å­ä½å±æ§çå¼ã|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|è¿åçåº¦éå¼`CFontHolder`å¯¹è±¡ã|
|[COleControl::GetForeColor](#getforecolor)|è¿åè¡ç¥¨ ForeColor å±æ§çå¼ã|
|[COleControl::GetHwnd](#gethwnd)|è¿åè¡ç¥¨ hWnd å±æ§çå¼ã|
|[COleControl::GetMessageString](#getmessagestring)|èåé¡¹æä¾çç¶ææ ææ¬ã|
|[COleControl::GetNotSupported](#getnotsupported)|å¯é²æ­¢å¯¹ç¨æ·æ§ä»¶çå±æ§å¼çè®¿é®ã|
|[COleControl::GetReadyState](#getreadystate)|è¿åæ§ä»¶çå°±ç»ªç¶æã|
|[COleControl::GetRectInContainer](#getrectincontainer)|è¿åç¸å¯¹äºå¶å®¹å¨çæ§ä»¶çç©å½¢ã|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|è¿åå¸¸ç¨å­ä½å±æ§çåº¦éçå¼ã|
|[COleControl::GetText](#gettext)|è¿åå¸¸ç¨çææ¬ææ é¢å±æ§çå¼ã|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|éåä»¥åè®¸æ çªå£æ§ä»¶ä½ä¸ºç®æ çææ¾æä½ã|
|[COleControl::InitializeIIDs](#initializeiids)|éç¥æ§ä»¶å°ä½¿ç¨ç Iid çåºç±»ã|
|[COleControl::InternalGetFont](#internalgetfont)|è¿å`CFontHolder`å¸¸ç¨å­ä½å±æ§çå¯¹è±¡ã|
|[COleControl::InternalGetText](#internalgettext)|æ£ç´¢è¡ç¥¨çæ é¢æææ¬å±æ§ã|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|è®¾ç½®æ§ä»¶çåå¤æåµç¶æå¹¶è§¦åå°±ç»ªç¶ææ´æ¹äºä»¶ã|
|[COleControl::InvalidateControl](#invalidatecontrol)|ä½¿æ¾ç¤ºçæ§ä»¶ï¼ä»èå¯¼è´éç»è¯¥åºåæ æã|
|[COleControl::InvalidateRgn](#invalidatergn)|ä½¿ç»å®åºååçå®¹å¨çªå£çå®¢æ·ç«¯åºåæ æã å¯ä»¥ä½¿ç¨éç»çåºåä¸­çæ çªå£æ§ä»¶ã|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|åè®¸ OLE æ§ä»¶çä¸ç¨çå è½½ã|
|[COleControl::IsModified](#ismodified)|ç¡®å®æ¯å¦å·²æ´æ¹çæ§ä»¶ç¶æã|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|æç¤ºå®¹å¨æ¯å¦ä¸ºå½åçç»å¶æä½æ¯æä¼åçç»å¾ã|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|è°ç¨ä»¥ç¡®å®æ¯å¦æ§ä»¶å­ç±» Windows æ§å¶ã|
|[COleControl::Load](#load)|éç½®ææä»¥åçå¼æ­¥æ°æ®ï¼å¹¶å¯å¨æ°çæ§ä»¶çå¼æ­¥å±æ§å è½½ã|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|ç¡®å®æ¯å¦æ§ä»¶å¯ä»¥åç¨çå®¹å¨ã|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|ç¯å¢å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|å¸¸ç¨çå¤è§å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|å¸¸ç¨ç BackColor å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|å¸¸ç¨ BorderStyle å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnClick](#onclick)|è°ç¨ä»¥è§¦åå¸¸ç¨ Click äºä»¶ã|
|[COleControl::OnClose](#onclose)|éç¥æ§ä»¶ç`IOleControl::Close`å·²è°ç¨ã|
|[COleControl::OnDoVerb](#ondoverb)|å¨æ§è¡æ§å¶è°è¯åè°ç¨ã|
|[COleControl::OnDraw](#ondraw)|å½è¯·æ±æ§ä»¶éç»èªèº«æ¶è°ç¨ã|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|å½è¯·æ±æ§ä»¶éç»èªèº«ä½¿ç¨å¾åæä»¶è®¾å¤ä¸ä¸ææ¶ï¼ç±å®¹å¨è°ç¨ã|
|[COleControl::OnEdit](#onedit)|è°ç¨å°ç¨æ·çé¢æ¿æ´»å®¹å¨ OLE æ§ä»¶ã|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Stock Enabled å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnEnumVerbs](#onenumverbs)|è°ç¨ç±å®¹å¨ä»¥æä¸¾æ§ä»¶çè°è¯ã|
|[COleControl::OnEventAdvise](#oneventadvise)|å½è¿æ¥æä»æ§ä»¶æ­å¼è¿æ¥äºä»¶å¤çç¨åºæ¶è°ç¨ã|
|[COleControl::OnFontChanged](#onfontchanged)|å¸¸ç¨å­ä½å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|å¸¸ç¨çåæ¯è²å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnFreezeEvents](#onfreezeevents)|æ§ä»¶çäºä»¶æ¯å»ç»æè§£å»æ¶è°ç¨ã|
|[COleControl::OnGetColorSet](#ongetcolorset)|éç¥æ§ä»¶ç`IOleObject::GetColorSet`å·²è°ç¨ã|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|æä¾å¯¹å®¹å¨çå©è®°é®ä¿¡æ¯ã|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|è°ç¨ä»¥è·åè¡¨ç¤ºå±æ§å¼çå­ç¬¦ä¸²ã|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|è¯·æ±å®¹å¨èåä¸æ§ä»¶çèåå°åå¹¶çå¥çæã|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|éåä»¥æ£ç´¢æ§ä»¶çæ¾ç¤ºå¤§å°ææ¥è¿çå»ºè®®çå¤§å°åæ©å±çåºæ¨¡å¼ã|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|è¿åè¡¨ç¤ºå±æ§çå¯è½å¼çå­ç¬¦ä¸²ã|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|è¿åå¯¹åºäºé¢å®ä¹çå­ç¬¦ä¸²çå¼ã|
|[COleControl::OnGetViewExtent](#ongetviewextent)|éåä»¥æ£ç´¢æ§ä»¶çæ¾ç¤ºåºå ï¼å¯ç¨äºå¯ç¨ä¸¤æ¬¡ç»å¾ï¼ çå¤§å°ã|
|[COleControl::OnGetViewRect](#ongetviewrect)|éåæ§ä»¶çå¤§å°è½¬æ¢ä¸ºç¹å®çä½ç½®å¼å§çç©å½¢ã|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|éåä»¥æ£ç´¢æ§ä»¶çè§å¾ç¶æã|
|[COleControl::OnHideToolBars](#onhidetoolbars)|å½æ§ä»¶å¤äºç¨æ·çé¢å·²åç¨æ¶ï¼ç±å®¹å¨è°ç¨ã|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|éåä»¥æ¥æå¨é¼ æ æéè°åº¦ WM_MOUSEMOVE æ¶æ¯å°è¯¥æ§ä»¶å¤äºéæ´»å¨ç¶æçæ§ä»¶çå®¹å¨ã|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|éåä»¥æ¥æå¨é¼ æ æéè°åº¦ WM_SETCURSOR æ¶æ¯å°è¯¥æ§ä»¶å¤äºéæ´»å¨ç¶æçæ§ä»¶çå®¹å¨ã|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|å·²æ¿åè¡ç¥¨ç KeyDown äºä»¶ä¹åè°ç¨ã|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|å·²æ¿åè¡ç¥¨ç KeyPress äºä»¶ä¹åè°ç¨ã|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|å·²æ¿åå¸¸ç¨ç KeyUp äºä»¶åè°ç¨ã|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|æç¤ºè¦ç¨äºç¼è¾å±æ§çå±æ§é¡µã|
|[COleControl::OnMnemonic](#onmnemonic)|å½æä¸æ§ä»¶çå©è®°é®æ¶è°ç¨ã|
|[COleControl::OnProperties](#onproperties)|å½è°ç¨æ§ä»¶ç"å±æ§"è°è¯æ¶è°ç¨ã|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|æ§ä»¶çæ¾ç¤ºéå ç»çå®ç¹æ¯å¦éåæ¥è¯¢ã|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|æ§ä»¶çæ¾ç¤ºéå ç»å®ç©å½¢ä¸­çä»»ä½ç¹æ¯å¦éåæ¥è¯¢ã|
|[COleControl::OnRenderData](#onrenderdata)|ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã|
|[COleControl::OnRenderFileData](#onrenderfiledata)|ç±æ¡æ¶è°ç¨ä»¥ä»æä»¶ä¸­æå®çæ ¼å¼æ£ç´¢æ°æ®ã|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|ç±æ¡æ¶è°ç¨ä»¥ä»å±ç¨åå­ä¸­æå®çæ ¼å¼æ£ç´¢æ°æ®ã|
|[COleControl::OnResetState](#onresetstate)|å°æ§ä»¶çå±æ§éç½®ä¸ºé»è®¤å¼ã|
|[COleControl::OnSetClientSite](#onsetclientsite)|éç¥æ§ä»¶ç`IOleControl::SetClientSite`å·²è°ç¨ã|
|[COleControl::OnSetData](#onsetdata)|æ§ä»¶çæ°æ®æ¿æ¢ä¸ºå¦ä¸ä¸ªå¼ã|
|[COleControl::OnSetExtent](#onsetextent)|æ§ä»¶çå¤§å°æ¶åçæ´æ¹åè°ç¨ã|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|è°ç¨åå·²æ´æ¹æ§ä»¶çç»´åº¦ã|
|[COleControl::OnShowToolBars](#onshowtoolbars)|å½æ§ä»¶å·²å¤äºç¨æ·çé¢æ¿æ´»æ¶è°ç¨ã|
|[COleControl::OnTextChanged](#ontextchanged)|Stock Text æ Caption å±æ§æ´æ¹æ¶è°ç¨ã|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|æ çªå£æ§ä»¶å¤ççªå£æ¶æ¯ ï¼èä¸æ¯é¼ æ åé®çæ¶æ¯ï¼ã|
|[COleControl::ParentToClient](#parenttoclient)|å°è½¬æ¢ä¸ºç¸å¯¹äºå®¹å¨çåç¹å°ç¹ç¸å¯¹äºæ§ä»¶çåç¹çç¹ã|
|[COleControl::PostModalDialog](#postmodaldialog)|éç¥å®¹å¨æ¨¡å¼å¯¹è¯æ¡å·²å³é­ã|
|[COleControl::PreModalDialog](#premodaldialog)|éç¥å³å°æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡ä¸­çå®¹å¨ã|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|éæ¯å¹¶éæ°åå»ºæ§ä»¶ççªå£ã|
|[COleControl::Refresh](#refresh)|å¼ºå¶éæ°ç»å¶çæ§ä»¶çå¤è§ã|
|[COleControl::ReleaseCapture](#releasecapture)|éæ¾é¼ æ æè·ã|
|[COleControl::ReleaseDC](#releasedc)|éæ¾æ¾ç¤ºè®¾å¤ä¸ä¸æçæ çªå£æ§ä»¶çå®¹å¨ã|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|éç½®æ§ä»¶çªå£çç¶çº§ã|
|[COleControl::ResetStockProps](#resetstockprops)|åå§å`COleControl`å¸¸ç¨å±æ§ä¸ºå¶é»è®¤å¼ã|
|[COleControl::ResetVersion](#resetversion)|åå§åä¸ºç»å®å¼ççæ¬å·ã|
|[COleControl::ScrollWindow](#scrollwindow)|åè®¸æ çªå£æ§ä»¶æ»å¨æ¾ç¤ºå¶å°±å°æ´»å¨å¾ååçæä¸ªåºåã|
|[COleControl::SelectFontObject](#selectfontobject)|éæ©å°è®¾å¤ä¸ä¸æçèªå®ä¹çå­ä½å±æ§ã|
|[COleControl::SelectStockFont](#selectstockfont)|éæ©å°è®¾å¤ä¸ä¸æçå¸¸ç¨å­ä½å±æ§ã|
|[COleControl::SerializeExtent](#serializeextent)|åºååæåå§åè¯¥æ§ä»¶çæ¾ç¤ºç©ºé´ã|
|[COleControl::SerializeStockProps](#serializestockprops)|åºååæåå§å`COleControl`å¸¸ç¨å±æ§ã|
|[COleControl::SerializeVersion](#serializeversion)|åºååæåå§åè¯¥æ§ä»¶ççæ¬ä¿¡æ¯ã|
|[COleControl::SetAppearance](#setappearance)|è®¾ç½®å¸¸ç¨çå¤è§å±æ§çå¼ã|
|[COleControl::SetBackColor](#setbackcolor)|è®¾ç½®å¸¸ç¨ BackColor å±æ§çå¼ã|
|[COleControl::SetBorderStyle](#setborderstyle)|è®¾ç½®å¸¸ç¨çè¾¹æ¡æ ·å¼å±æ§çå¼ã|
|[COleControl::SetCapture](#setcapture)|ä½¿æ§ä»¶çå®¹å¨çªå£æ§ä»¶çä»£è¡¨éè¦æ¥æé¼ æ æè·ã|
|[COleControl::SetControlSize](#setcontrolsize)|è®¾ç½®ä½ç½®å OLE æ§ä»¶çå¤§å°ã|
|[COleControl::SetEnabled](#setenabled)|è®¾ç½®è¡ç¥¨ Enabled å±æ§çå¼ã|
|[COleControl::SetFocus](#setfocus)|ä½¿æ§ä»¶çå®¹å¨çªå£æ§ä»¶çä»£è¡¨éè¦æ¥æè¾å¥ç¦ç¹ã|
|[COleControl::SetFont](#setfont)|è®¾ç½®å¸¸ç¨å­ä½å±æ§çå¼ã|
|[COleControl::SetForeColor](#setforecolor)|è®¾ç½®å¸¸ç¨ ForeColor å±æ§å¼ã|
|[COleControl::SetInitialSize](#setinitialsize)|è®¾ç½® OLE æ§ä»¶å®¹å¨ä¸­é¦æ¬¡æ¾ç¤ºæ¶çå¤§å°ã|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|æ´æ¹æ§ä»¶çå·²ä¿®æ¹çç¶æã|
|[COleControl::SetNotPermitted](#setnotpermitted)|æç¤ºçç¼è¾è¯·æ±å·²å¤±è´¥ã|
|[COleControl::SetNotSupported](#setnotsupported)|é²æ­¢ä¿®æ¹ä¸ºç¨æ·æ§ä»¶çå±æ§å¼ã|
|[COleControl::SetRectInContainer](#setrectincontainer)|è®¾ç½®ç¸å¯¹äºå¶å®¹å¨çæ§ä»¶çç©å½¢ã|
|[COleControl::SetText](#settext)|è®¾ç½®å¸¸ç¨çææ¬ææ é¢å±æ§çå¼ã|
|[COleControl::ThrowError](#throwerror)|åºç°éè¯¯ä¸­ OLE æ§ä»¶çä¿¡å·ã|
|[COleControl::TransformCoords](#transformcoords)|è½¬æ¢åè°å®¹å¨ä¸æ§ä»¶ä¹é´çå¼ã|
|[COleControl::TranslateColor](#translatecolor)|å° OLE_COLOR å¼è½¬æ¢ä¸º COLORREF å¼ã|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|ç¡®å®æ¯å¦ç¯å¢å±æ§å¯å¨ä¸æ¬¡å è½½æ§ä»¶ã|
|[COleControl::WindowProc](#windowproc)|æä¾æå³ Windows è¿ç¨`COleControl`å¯¹è±¡ã|

### <a name="protected-methods"></a>åä¿æ¤çæ¹æ³

|åç§°|æè¿°|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|å½æ§ä»¶çå¤è§éè¦æ´æ°æ¶ç±æ¡æ¶è°ç¨ã|
|[COleControl::DrawMetafile](#drawmetafile)|å¨ä½¿ç¨å¾åæä»¶è®¾å¤ä¸ä¸ææ¶ç±æ¡æ¶è°ç¨ã|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|å¯ç¨èªå¨åæ¹æ³è°ç¨ã|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|ç±æ¡æ¶è°ç¨ä»¥åå§åæ§ä»¶æ¯æçæ°æ®æ ¼å¼çåè¡¨ã|

## <a name="remarks"></a>å¤æ³¨

æ´¾çèª`CWnd`ï¼æ­¤ç±»ç»§æ¿ç Windows çªå£å¯¹è±¡çææåè½ä»¥åå¶ä»åè½ç¹å®äº OLEï¼å¦äºä»¶è§¦ååæ¯ææ¹æ³åå±æ§çè½åã

OLE æ§ä»¶å¯ä»¥æå¥å° OLE å®¹å¨åºç¨ç¨åºï¼å¹¶ä½¿ç¨ååç³»ç»çäºä»¶æ¿ååå¬å¼æ¹æ³åå±æ§æ·»å å°å®¹å¨ä¸å®¹å¨éä¿¡ã è¯·æ³¨æï¼æ å OLE å®¹å¨ä»æ¯æ OLE æ§ä»¶çåºæ¬åè½ã å®ä»¬ä¸è½æ¯æ OLE æ§ä»¶çæ©å±çåè½ã å½äºä»¶è¢«åéå°æ§ä»¶ä¸­åçæäºæä½ï¼ç±äºå®¹å¨æ¶åçäºä»¶è§¦åã åè¿æ¥ï¼å®¹å¨ä¸æ§ä»¶éä¿¡éè¿ä½¿ç¨ä¸ç»å¬å¼çæ¹æ³åå±æ§ç±»ä¼¼äºæåå½æ°å c + + ç±»çæ°æ®æåã æ­¤æ¹æ³åè®¸å¼åäººåæ§å¶æ§ä»¶çå¤è§åç¹å®æä½åçæ¶éç¥è¯¥å®¹å¨ã

## <a name="windowless-controls"></a>æ çªå£æ§ä»¶

OLE æ§ä»¶å¯ä»¥æ¯æ çªå£ä½¿ç¨å¤äºå°±å°æ´»å¨ç¶æã æ çªå£æ§ä»¶æææ¾çä¼ç¹ï¼

- æ çªå£æ§ä»¶å¯ä»¥æ¯éæçå¹¶ä¸éç©å½¢

- æ çªå£æ§ä»¶åå°å¯¹è±¡çå®ä¾å¤§å°ååå»ºæ¶é´

æ§ä»¶ä¸éè¦ä¸ä¸ªçªå£ã çªå£æä¾çæå¡å¯ä»¥è½»æ¾å°éè¿åä¸ªå±äº«ççªå£ ï¼éå¸¸æ¯å®¹å¨çï¼ åä¸äºè°åº¦ä»£ç æä¾ã å·æä¸ä¸ªçªå£æ¯ä¸»è¦å¯¹è±¡ä¸çä¸å¿è¦å¤ææ§ã

ä½¿ç¨æ çªå£æ¿æ´»æ¶ï¼æ¯è´è´£æä¾æå¡ï¼å¦åå°ç±æ§ä»¶èªå·±ççªå£æä¾çå®¹å¨ ï¼å®å·æä¸ä¸ªçªå£ï¼ã ä¾å¦ï¼å¦ææ¨çæ§ä»¶éè¦æ¥è¯¢é®çç¦ç¹ã æ¥è¯¢é¼ æ æè·ï¼æè·åè®¾å¤ä¸ä¸æï¼ç±å®¹å¨ç®¡çè¿äºæä½ã `COleControl`æ çªå£æä½æåå½æ°å°è°ç¨è¿äºæä½å¨å®¹å¨ä¸çã

å¯ç¨æ çªå£æ¿æ´»åï¼å®¹å¨å§æè¾å¥å°æ§ä»¶çæ¶æ¯`IOleInPlaceObjectWindowless`æ¥å£ (çæ©å±[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)æ çªå£æ¯æ)ã `COleControl`éå½å°è°æ´é¼ æ åæ åï¼æ­¤æ¥å£çå®ç°å°è°åº¦éè¿æ§ä»¶çæ¶æ¯æ å°ï¼è¿äºæ¶æ¯ã å¯ä»¥éè¿å°ç¸åºçæ¡ç®æ·»å å°æ¶æ¯æ å°æ¥å¤çè¿äºæ¶æ¯ä¸æ®éçªå£æ¶æ¯ä¸æ ·ã

å¨æ çªå£æ§ä»¶ä¸­ï¼å§ç»åºä½¿ç¨`COleControl`æåå½æ°èä¸æ¯ç¸åº`CWnd`æåå½æ°æå¶ç¸å³ç Windows API å½æ°ã

ä»å½å®ä»¬åä¸ºæ´»å¨ç¶æï¼ä½å¤äºéæ´»å¨ç¶æå¤äºæ´»å¨ç¶æè½¬æ¢æéçå·¥ä½éå°åä¸è½¬åè¿æ¸¡çéåº¦åçæéæ¶ï¼OLE æ§ä»¶å¯¹è±¡è¿å¯ä»¥åå»ºä¸ä¸ªçªå£ã æäºæåµä¸è¿æ¯ä¸ä¸ªé®é¢ï¼ ä½ä¸ºç¤ºä¾ï¼è¯·èèä¸ä¸ªææ¬æ¡ä¸­çç½æ ¼ã å½åéè¿åä¸ååä¸çæéï¼æ¯ä¸ªæ§ä»¶å¿é¡»å°±å°æ¿æ´»ï¼ç¶ååç¨ã éæ´»å¨/æ´»å¨è¿æ¸¡çéåº¦ä¼ç´æ¥å½±åæ»å¨éåº¦ã

å¼å OLE æ§ä»¶æ¡æ¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [MFC ActiveX æ§ä»¶](../../mfc/mfc-activex-controls.md)å¹¶[æ¦è¿°ï¼ åå»º MFC ActiveX æ§ä»¶ç¨åº](../../mfc/reference/mfc-activex-control-wizard.md)ã æå³ä¼å OLE æ§ä»¶ï¼åæ¬æ çªå£å¹¶ä¸æ éªçæ§ä»¶ï¼è¯·åé[MFC ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="inheritance-hierarchy"></a>ç»§æ¿å±æ¬¡ç»æ

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>è¦æ±

**æ å¤´ï¼** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

è¿åç¯å¢ BackColor å±æ§çå¼ã

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢ BackColor å±æ§ï¼å¦ææå½åå¼ã å¦æä¸æ¯æçå±æ§ï¼æ­¤å½æ°è¿åçç³»ç»å®ä¹ç Windows èæ¯è²ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢ç BackColor å±æ§å¯ä¾æææ§ä»¶ï¼å¹¶ä¸ç±å®¹å¨å®ä¹ã è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

å¯ä»¥åç¨æ·æ¾ç¤ºçéè¯¯æ¶æ¯ä¸­ä½¿ç¨è¯¥å®¹å¨å·²åéç»æ§ä»¶çåç§°ã

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>è¿åå¼

OLE æ§ä»¶çåç§°ã é»è®¤å¼ä¸ºé¶é¿åº¦å­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientfont"></a>  COleControl::AmbientFont

è¿åç¯å¢å­ä½å±æ§çå¼ã

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>è¿åå¼

æåå®¹å¨çç¯å¢å­ä½è°åº¦æ¥å£çæéã é»è®¤å¼ä¸º NULLã è¿åä¸ç­äº NULLï¼å¦ææ¨æ¯è´è´£éæ¾å­ä½éè¿è°ç¨å¶[iunknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release)æåå½æ°ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢å­ä½å±æ§æ¯ç±å®¹å¨å®ä¹å¹¶å¯ä¾æææ§ä»¶ãè¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

è¿åç¯å¢åæ¯è²å±æ§çå¼ã

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢åæ¯è²å±æ§ï¼å¦ææå½åå¼ã å¦æä¸æ¯æï¼æ­¤å½æ°è¿åçç³»ç»å®ä¹ç Windows ææ¬é¢è²ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢åæ¯è²å±æ§å¯ä¾æææ§ä»¶ï¼å¹¶ä¸ç±å®¹å¨å®ä¹ã è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

è¿åå®¹å¨çåºåè®¾ç½® idã

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨ç LocaleID å±æ§ ï¼å¦ææï¼ çå¼ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°å°è¿å 0ã

### <a name="remarks"></a>å¤æ³¨

è¯¥æ§ä»¶å¯ä»¥ä½¿ç¨ LocaleID ä»¥éåºç¹å®åºåè®¾ç½®å¶ç¨æ·çé¢ã è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

æ£ç´¢æ§ä»¶å¯¹è±¡çå½åå¤è§è®¾ç½®ã

```
short AmbientAppearance();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çå¤è§ï¼

- **0**å¹³é¢å¤è§

- **1**ä¸ç»´å¤è§

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯æ£ç´¢æ§ä»¶ç DISPID_AMBIENT_APPEARANCE å±æ§çå½åå¼ã

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

è¿åç±å®¹å¨æç¨çåä½ç±»åã

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>è¿åå¼

åå«å®¹å¨çç¯å¢ ScaleUnits çå­ç¬¦ä¸²ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°å°è¿åä¸ä¸ªé¶é¿åº¦å­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

å®¹å¨çç¯å¢ ScaleUnits å±æ§å¯ä»¥ç¨äºä½ç½®æç»´åº¦ï¼æ è®°ä¸ºä¸æéååï¼å¦ç¼è¿æ¯æåç±³æ¾ç¤ºã è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

ç¡®å®å®¹å¨æ¯å¦åè®¸è¦ä¸ºå¶èªèº«æ´»å¨æ¶æ¾ç¤ºæ¡æçæ§ä»¶ã

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>è¿åå¼

å¦æåºæ¾ç¤ºæ¡æï¼åéé¶å¼å¦åä¸º 0ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿åéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

ç¡®å®å®¹å¨æ¯å¦åè®¸è¯¥æ§ä»¶ä»¥å°å®ä¸é´å½±çº¿æ¾ç¤ºæ¨¡å¼ UI å¤äºæ´»å¨ç¶æã

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>è¿åå¼

éé¶å¼æ¯å¦åºæ¾ç¤ºé´å½±çæ¨¡å¼;å¦åä¸º 0ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿åéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

ç¡®å®é¦éçæ§ä»¶å®¹å¨çç¯å¢çææ¬å¯¹é½æ¹å¼ã

```
short AmbientTextAlign();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢ TextAlign å±æ§çç¶æã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°å°è¿å 0ã

ä¸é¢æ¯ææçè¿åå¼çåè¡¨ï¼

|è¿åå¼|å«ä¹|
|------------------|-------------|
|0|å¸¸è§çå¯¹é½æ¹å¼ ï¼æ°å­è½¬æ¢ä¸ºå·¦ä¾§çå³ï¼ææ¬ï¼ã|
|1|å·¦å¯¹é½|
|2|å±ä¸­|
|3|å³å¯¹é½|

### <a name="remarks"></a>å¤æ³¨

æ­¤å±æ§å¯ä¾ææåµå¥çæ§ä»¶ï¼ç±å®¹å¨å®ä¹ã è¯·æ³¨æè¯¥å®¹å¨ä¸éè¦æ¯ææ­¤å±æ§ã

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

ç¡®å®å®¹å¨æ¯å¦æ³è¦ååºç¨æ·çé¢æä½çæ§ä»¶ã

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶åºååºç¨æ·çé¢æä½; éé¶å¼å¦åä¸º 0ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°å°è¿å 0ã

### <a name="remarks"></a>å¤æ³¨

ä¾å¦ï¼å®¹å¨å¯è½ä¼å°æ­¤é¡¹è®¾ç½®ä¸º TRUE ä»¥è®¾è®¡æ¨¡å¼ã

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

ç¡®å®å®¹å¨æ¯å¦å¨è®¾è®¡æ¨¡å¼æç¨æ·æ¨¡å¼ã

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>è¿åå¼

å¦æå®¹å¨æ¯å¨ç¨æ·æ¨¡å¼ï¼åä¸ºéé¶å¼å¦åä¸º 0 ï¼å¨è®¾è®¡æ¨¡å¼ä¸ï¼ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°å°è¿å TRUEã

### <a name="remarks"></a>å¤æ³¨

ä¾å¦ï¼å®¹å¨å¯è½ä¼å°æ­¤é¡¹è®¾ç½®ä¸º FALSE å¨è®¾è®¡æ¨¡å¼ä¸ã

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

ç»å®çå±æ§å¼å·²æ´æ¹çä¿¡å·ã

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
æ§ä»¶çç»å®å±æ§çè°åº¦ IDã

### <a name="remarks"></a>å¤æ³¨

è¿å¿é¡»å¨æ¯æ¬¡å±æ§æ´æ¹ï¼çè³å¨å¶ä¸­éè¿å±æ§ä¸è¿è¡äºæ´æ¹çæåµä¸çå¼è®¾ç½®æ¹æ³è°ç¨ã è¯·ç¹å«æ³¨æçç»å®å±æ§æ å°å°æååéã ä»»ä½æ­¤ç±»æååéæ¬¡åçæ´æ¹æ¶ï¼`BoundPropertyChanged`å¿é¡»è°ç¨ã

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

è¯·æ±æéä»`IPropertyNotifySink`æ¥å£æ¥æ´æ¹è¯¥æ§ä»¶æä¾çç»å®çå±æ§å¼ã

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
æ§ä»¶çç»å®å±æ§çè°åº¦ IDã

### <a name="return-value"></a>è¿åå¼

å¦æåè®¸æ­¤æ´æ¹; éé¶å¼å¦åä¸º 0ã é»è®¤å¼ä¸ºéé¶å¼ã

### <a name="remarks"></a>å¤æ³¨

å¦ææéè¢«æç»ï¼æ§ä»¶å¿é¡»åè®¸å±æ§æ´æ¹çå¼ã è¿å¯ä»¥éè¿å¶ä¸­å¿½ç¥æå¤±è´¥çå°è¯å°å±æ§å¼æ´æ¹çæä½ã

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

å°è½¬æ¢çåæ *pPoint*ç¶çº§åæ ã

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
æå OLE æ§ä»¶å¨å®¹å¨åçè¾¹çã ä¸æ¯å·¥ä½åºï¼ä½æ´ä¸ªæ§ä»¶åæ¬è¾¹æ¡åæ»å¨æ¡çåºåã

*pPoint*<br/>
æå OLE å®¢æ·ç«¯åºåç¹è½¬æ¢ä¸ºç¶ ï¼å®¹å¨ï¼ çåæ ã

### <a name="remarks"></a>å¤æ³¨

å¨è¾å¥*pPoint*æ¯ç¸å¯¹äº OLE æ§ä»¶ ï¼å·¦ä¸è§çæ§ä»¶çå®¢æ·ç«¯åºåï¼ çå®¢æ·ç«¯åºåçåç¹ã å¨è¾åº*pPoint*æ¯ç¸å¯¹äºç¶çº§ ï¼å·¦ä¸è§çå®¹å¨ï¼ çæºã

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

å¦æå®å®å¨æé¨åæ¶µçéå çã ä¸éæå¯¹è±¡ï¼è°æ´ä¸ä¸ªæå¥ç¬¦å·çç©å½¢ã

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
å¨è¾å¥ä¸ä¸ªæå[RECT](../../mfc/reference/rect-structure1.md)ç»æï¼å¶ä¸­åå«è¦è¿è¡è°æ´çæå¥ç¹åºåã å¨è¾åºä¸­ï¼è°æ´åçæå¥ç¬¦å·çåºåä¸­ï¼æå¦æè±å­å·ç©å½¢å®å¨è¦çï¼åä¸º NULLã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå¥ç¬¦å·æ¯éªççè¡ã åæä½å¾ï¼éå¸¸æç¤ºå¨å¶ä¸­æå¥ææ¬æå¾å½¢ã

æ çªå£å¯¹è±¡æ æ³å®å¨å°æ¾ç¤ºæå¥ç¬¦å·ï¼èæ éåæ£æ¥æ¯å¦å°æå¥ç¬¦å·è¢«é¨åæå®å¨éèéå çå¯¹è±¡ã è¥è¦å®ç°è¿ä¸ç¹ï¼å¯ä»¥ä½¿ç¨å¯¹è±¡`ClipCaretRect`ä»¥è·åæå¥ç¬¦å·è°æ´ ï¼åå°ï¼ ä»¥ç¡®ä¿å®éåçåªè¾åºåã

åå»ºä¸ä¸ªæå¥ç¬¦å·çå¯¹è±¡åºæäº¤å°çæå¥ç¬¦å·ç©å½¢`ClipCaretRect`åç¨äºæå¥ç¬¦å·çè°æ´åçç©å½¢ã å¦æå°æå¥ç¬¦å·å®å¨éèçæ­¤æ¹æ³å°è¿å FALSE å¹¶å°æå¥ç¬¦å·æ¾ç¤ºæ¶ä¸åºå¨ææè¿ç§æåµä¸ã

##  <a name="colecontrol"></a>  COleControl::COleControl

æé  `COleControl` å¯¹è±¡ã

```
COleControl();
```

### <a name="remarks"></a>å¤æ³¨

éå¸¸ä¸ç´æ¥è°ç¨æ­¤å½æ°ã èæ¯ OLE æ§ä»¶éå¸¸ç±å¶ç±»å·¥ååå»ºã

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

æ¯æçæ§ä»¶çå©è®°é®éåçæ´æ¹æ¶è°ç¨æ­¤å½æ°ã

```
void ControlInfoChanged();
```

### <a name="remarks"></a>å¤æ³¨

æ¶å°æ­¤éç¥æ¶ï¼è¯¥æ§ä»¶çå®¹å¨è·åä¸ç»æ°çå©è®°é®å¯¹çè°ç¨ï¼ä»è[IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)ã è¯·æ³¨æï¼è¯¥å®¹å¨ä¸éè¦ååºæ­¤éç¥ã

##  <a name="displayerror"></a>  COleControl::DisplayError

å¸¸ç¨çéè¯¯äºä»¶å¤ç ï¼é¤éäºä»¶å¤çç¨åºå·²ç¦æ­¢æ¾ç¤ºçéè¯¯ï¼ åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>åæ°

*scode*<br/>
è¦æ¥åçç¶æä»£ç å¼ã å¯è½çä»£ç çå®æ´åè¡¨ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ é«çº§ä¸»é¢](../../mfc/mfc-activex-controls-advanced-topics.md)ã

*lpszDescription*<br/>
æ­£å¨æ¥åçéè¯¯çè¯´æã

*lpszSource*<br/>
çæéè¯¯ ï¼éå¸¸æåµä¸ï¼OLE æ§ä»¶æ¨¡åçåç§°ï¼ çæ¨¡åçåç§°ã

*lpszHelpFile*<br/>
åå«è¯´æçéè¯¯çå¸®å©æä»¶çåç§°ã

*nHelpID*<br/>
æ­£å¨æ¥åçéè¯¯çå¸®å©ä¸ä¸æ IDã

### <a name="remarks"></a>å¤æ³¨

é»è®¤è¡ä¸ºæ¯æ¾ç¤ºä¸ä¸ªæ¶æ¯æ¡åå«ä¸­åå«éè¯¯çè¯´æ*lpszDescription*ã

éåæ­¤å½æ°å¯èªå®ä¹éè¯¯çæ¾ç¤ºæ¹å¼ã

##  <a name="doclick"></a>  COleControl::DoClick

æ¨¡æé¼ æ åå»æ§ä»¶ä¸çæä½ã

```
void DoClick();
```

### <a name="remarks"></a>å¤æ³¨

å¯éå`COleControl::OnClick`å°è°ç¨æåå½æ°ï¼åå¸¸ç¨ Click äºä»¶å°è§¦åï¼å¦ææ§ä»¶æ¯æã

æ¯ææ­¤å½æ°`COleControl`åºç±»ä½ä¸ºè°ç¨ DoClick å¸¸ç¨æ¹æ³ã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ æ¹æ³](../../mfc/mfc-activex-controls-methods.md)ã

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

ç±æ¡æ¶å è½½æå­å¨çæä¹æ§å­å¨åºè¡¨ç¤ºå½¢å¼ï¼å¦æµæå±æ§ç»ä¸­çä¸ä¸ªæ§ä»¶æ¶è°ç¨ã

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
ä¸ä¸ªæå`CPropExchange`å¯¹è±¡ã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«çä¸ä¸æå±æ§ exchangeï¼åæ¬å¶æ¹åã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸ä¼è°ç¨**PX_** ç³»åå½æ°ä»¥å è½½æå­å¨ç OLE æ§ä»¶ç¹å®çç¨æ·å®ä¹çå±æ§ã

å¦ææ§ä»¶åå¯¼ç¨äºåå»º OLE æ§ä»¶é¡¹ç®ï¼æ­¤å½æ°çéåççæ¬å°åºååæ¯æçå¸¸ç¨å±æ§`COleControl`éè¿è°ç¨åºç±»å½æ°ï¼ `COleControl::DoPropExchange`ã å¨æ¨å OLE æ§ä»¶å°éè¦ä¿®æ¹æ­¤å½æ°å¯åºååæ°å±æ§æ·»å ç¨æ·å®ä¹çå±æ§ã åºååçè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ åºåå](../../mfc/mfc-activex-controls-serializing.md)ã

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

éç» OLE æ§ä»¶ç Windows æ§ä»¶å­ç±»å«ã

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æåæ§ä»¶å®¹å¨çè®¾å¤ä¸ä¸æçæéã

*rcBounds*<br/>
æ§ä»¶å°ç»å¶åºåã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯æ­£ç¡®å¤ççéæ´»å¨ç OLE æ§ä»¶ç»å¶ã å¦æ OLE æ§ä»¶ç Windows æ§ä»¶çå­ç±»ï¼åºè°ç¨ï¼ä»åºä½¿ç¨æ­¤å½æ°`OnDraw`æ§ä»¶çå½æ°ã

æ­¤å½æ°å Windows æ§ä»¶å­ç±»åçè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ å­ç±»å Windows æ§ä»¶](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)ã

##  <a name="drawcontent"></a>  COleControl::DrawContent

å½æ§ä»¶çå¤è§éè¦æ´æ°æ¶ç±æ¡æ¶è°ç¨ã

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æåè®¾å¤ä¸ä¸ææéã

*rc*<br/>
è¦å¨ä¸­ç»å¶çç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°å°ç´æ¥è°ç¨å¯éå`OnDraw`å½æ°ã

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

å¨ä½¿ç¨å¾åæä»¶è®¾å¤ä¸ä¸ææ¶ç±æ¡æ¶è°ç¨ã

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
å¾åæä»¶è®¾å¤ä¸ä¸æçæéã

*rc*<br/>
è¦å¨ä¸­ç»å¶çç©å½¢åºåã

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

åè®¸ OLE æ§ä»¶çç®åæ¡æ¶ç¹æ§ã

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>å¤æ³¨

æ­¤ç¹æ§åè®¸æ§ä»¶ç¨æ¥æ¯æ visual åå«å¶ä»æ§ä»¶ï¼ä½äºå®å¹¶éå¦æ­¤ OLE åå®¹ã ç¤ºä¾æ¯å·æå¤ä¸ªæ§ä»¶åçç»æ¡ã è¿äºæ§ä»¶ä¸æ¯ OLE åå«ï¼ä½å®ä»¬æ¯å¨åä¸ç»ä¸­ã

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

åºååæåå§åè¯¥æ§ä»¶çä½ç¨å ï¼å¶ç»´åº¦ä»¥ HIMETRIC ä¸ºåä½ï¼ çç¶æã

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
ä¸ä¸ªæå[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡ã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«çä¸ä¸æå±æ§ exchangeï¼åæ¬å¶æ¹åã

### <a name="return-value"></a>è¿åå¼

å¦æå½æ°æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°éå¸¸æåµä¸è°ç¨æ­¤å½æ°`COleControl::DoPropExchange`ã

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

åºååæåå§åè¯¥æ§ä»¶çå¸¸ç¨å±æ§çç¶æã

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
ä¸ä¸ªæå[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡ã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«çä¸ä¸æå±æ§ exchangeï¼åæ¬å¶æ¹åã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°éå¸¸æåµä¸è°ç¨æ­¤å½æ°`COleControl::DoPropExchange`ã

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯çç¶æã

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
ä¸ä¸ªæå`CPropExchange`å¯¹è±¡ã æ¡æ¶æä¾äºæ­¤å¯¹è±¡ä»¥å»ºç«çä¸ä¸æå±æ§ exchangeï¼åæ¬å¶æ¹åã

*dwVersionDefault*<br/>
æ§ä»¶çå½åçæ¬å·ã

*bConvert*<br/>
æç¤ºæ°¸ä¹æ§æ°æ®æ¯å¦åºè½¬æ¢ä¸ºææ°æ ¼å¼ä¿å­ï¼æä¿çå¨ç¸åçæ ¼å¼å è½½æ¶ã

### <a name="return-value"></a>è¿åå¼

æåï¼åè¯¥å½æ°çéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ï¼è¿å°æ¯ç¬¬ä¸ä¸ªå½æ°è°ç¨çæ§ä»¶çéå`COleControl::DoPropExchange`ã å¨å è½½æ¶ï¼æ­¤å½æ°è¯»åæ°¸ä¹æ§æ°æ®ççæ¬å·ï¼å¹¶è®¾ç½®ç version å±æ§[CPropExchange](../../mfc/reference/cpropexchange-class.md)ç¸åºå¯¹è±¡ã ä¿å­æ¶ï¼æ­¤å½æ°å°åå¥æä¹æ§æ°æ®ççæ¬å·ã

æä¹æ§åçæ¬æ§å¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ åºåå](../../mfc/mfc-activex-controls-serializing.md)ã

##  <a name="fireclick"></a>  COleControl::FireClick

é¼ æ åå»æ´»å¨æ§ä»¶ä¸æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
void FireClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦å Click äºä»¶åçï¼è¯¥æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå¸¸ç¨ Click äºä»¶å®ä¹çã

##  <a name="firedblclick"></a>  COleControl::FireDblClick

å½é¼ æ ä½äºåå»æ´»å¨æ§ä»¶ä¸æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
void FireDblClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦å DblClick äºä»¶çåçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ DblClick äºä»¶ã

##  <a name="fireerror"></a>  COleControl::FireError

è§¦åè¡ç¥¨çéè¯¯äºä»¶ã

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>åæ°

*scode*<br/>
è¦æ¥åçç¶æä»£ç å¼ã å¯è½çä»£ç çå®æ´åè¡¨ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ é«çº§ä¸»é¢](../../mfc/mfc-activex-controls-advanced-topics.md)ã

*lpszDescription*<br/>
æ­£å¨æ¥åçéè¯¯çè¯´æã

*nHelpID*<br/>
æ¥åçéè¯¯çå¸®å© IDã

### <a name="remarks"></a>å¤æ³¨

æ­¤äºä»¶æä¾ä¸ç§ä¿¡ä»¤éè¯¯åçå¨æ§ä»¶åï¼å¨ä½ çä»£ç ä¸­çç¸åºä½ç½®ã ä¸å¶ä»å¸¸ç¨äºä»¶ï¼ä¾å¦ï¼åå»æ MouseMove ä¸åéè¯¯æ°¸è¿ä¸ä¼å¼åç±æ¡æ¶ä¸­ã

è¥è¦æ¥åçå±æ§ get å½æ°ã å±æ§éå½æ°æèªå¨åæ¹æ³è¿ç¨ä¸­åçéè¯¯ï¼è¯·è°ç¨[colecontrol:: Throwerror](#throwerror)ã

OLE æ§ä»¶çè¡ç¥¨éè¯¯äºä»¶çå®ç°ä½¿ç¨ SCODE å¼ã å¦ææ¨çæ§ä»¶ä½¿ç¨æ­¤äºä»¶ï¼å¹¶ä¸æç®å¨ Visual Basic 4.0 ä¸­ä½¿ç¨ï¼ä½ å°æ¶å°éè¯¯ï¼å ä¸ºå¨ Visual Basic ä¸­ä¸æ¯æ SCODE å¼ã

è¥è¦è§£å³æ­¤é®é¢ï¼æå¨æ´æ¹è¯¥æ§ä»¶ä¸­ç SCODE åæ°ãODL æä»¶**é¿**ã æ­¤å¤ï¼ä»»ä½èªå®ä¹äºä»¶ã æ¹æ³æå±æ§ï¼å¯ä½¿ç¨ SCODE åæ°è¿ä¼å¯¼è´ç¸åçé®é¢ã

##  <a name="fireevent"></a>  COleControl::FireEvent

è§¦åä»æ¨çæ§ä»¶ä¸ä»»ææ°éçå¯éèªåéï¼ä¸ºç¨æ·å®ä¹çäºä»¶ã

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
è¦è§¦åçäºä»¶çè°åº¦ IDã

*pbParams*<br/>
äºä»¶çåæ°ç±»åæè¿°ç¬¦ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸åºä¸ç´æ¥è°ç¨æ­¤å½æ°ã èæ¯å°äºä»¶æ å°é¨åä¸­çæ§ä»¶çç±»å£°æä¸­è°ç¨äºä»¶è§¦åå½æ°ã

*PbParams*åæ°æ¯ä»¥ç©ºæ ¼åéçåè¡¨**VTS_**ã å¶ä¸­ä¸ä¸ªæå¤ä¸ªå¼ï¼ç±ç©ºæ ¼ï¼èä¸æ¯éå·ï¼åéï¼æå®å½æ°çåæ°åè¡¨ã å¯è½çå¼å¦ä¸ï¼

|ç¬¦å·|åæ°ç±»å|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  å¶ä»åä½å¸¸éå·²å®ä¹çææåéçç±»åï¼é¤ VTS_FONT å VTS_PICTUREï¼æä¾åéæ°æ®å¸¸éçæéã ä½¿ç¨å½åè¿äºå¸¸é**VTS_P** `constantname`çº¦å®ã ä¾å¦ï¼VTS_PCOLOR æ¯æå VTS_COLOR å¸¸éçæéã

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

å½æ§ä»¶å¤äºæ´»å¨ç¶æçç¨æ·çé¢æä¸æä¸ªé®æ¶ç±æ¡æ¶è°ç¨ã

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>åæ°

*pnChar*<br/>
ä¸ºèæé®ä»£ç å¼çæä¸çé®çæéã æ åèæé®ä»£ç çåè¡¨ï¼è¯·åè§ Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦å KeyDown äºä»¶çåçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ KeyDown äºä»¶ã

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

å½æä¸æä¸ªé®å¹¶å°å¶éæ¾èªå®ä¹æ§ä»¶å¤äº UI æ´»å¨ç¶æçå®¹å¨åæ¶ç±æ¡æ¶è°ç¨ã

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>åæ°

*pnChar*<br/>
æåææçé®çå­ç¬¦å¼çæéã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

äºä»¶çæ¥æ¶æ¹å¯è½ä¼ä¿®æ¹*pnChar*ï¼ä¾å¦ï¼å°ææå°åå­ç¬¦è½¬æ¢ä¸ºå¤§åã å¦æä½ æ³è¦æ£æ¥ä¿®æ¹åçå­ç¬¦ï¼éå`OnKeyPressEvent`ã

å¯¹äºèªå¨è§¦å KeyPress äºä»¶çåçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ KeyPress äºä»¶ã

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

èªå®ä¹æ§ä»¶å¤äº UI æ´»å¨ç¶æçå®¹å¨åæ¶æ¾å¼æä¸ªé®æ¶ç±æ¡æ¶è°ç¨ã

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>åæ°

*pnChar*<br/>
æåå·²åå¸çé¡¹çèæé®ä»£ç å¼ã æ åèæé®ä»£ç çåè¡¨ï¼è¯·åè§ Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦åç KeyUp äºä»¶åççæ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ KeyUp äºä»¶ã

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

æ´»å¨çèªå®ä¹æ§ä»¶ä¸æé¼ æ æé®æ¶ç±æ¡æ¶è°ç¨ã

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>åæ°

*n æé®*<br/>
æä¸é¼ æ æé®çæ°å¼ã å®å¯ä»¥åå«ä»¥ä¸å¼ä¹ä¸ï¼

- LEFT_BUTTON é¼ æ å·¦é®å·²æä¸ã

- MIDDLE_BUTTON é¼ æ ä¸­é®å·²æä¸ã

- RIGHT_BUTTON é¼ æ å³é®å·²æä¸ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

*x*<br/>
é¼ æ å·¦é®å·²æä¸æ¶ï¼åæ  x åæ ã åæ æ¯ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

*y*<br/>
é¼ æ å·¦é®å·²æä¸æ¶ï¼åæ ç y åæ ã åæ æ¯ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦åé¼ æ æä¸äºä»¶çåçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ MouseDown äºä»¶ã

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

å½åæ ç§»å°æ´»å¨çèªå®ä¹æ§ä»¶ä¸ï¼ç±æ¡æ¶è°ç¨ã

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>åæ°

*n æé®*<br/>
æä¸é¼ æ æé®çæ°å¼ã åå«ä»¥ä¸å¼çç»åï¼

- å¨æä½æé´æä¸é¼ æ å·¦é®äº LEFT_BUTTONã

- MIDDLE_BUTTON æä½æé´æä¸é¼ æ ä¸­æé®äºã

- RIGHT_BUTTON æä½æé´æä¸é¼ æ å³é®æé®äºã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

*x*<br/>
åæ ç x åæ ã åæ æ¯ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

*y*<br/>
åæ ç y åæ ã åæ æ¯ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦å MouseMove äºä»¶çåçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ MouseMove äºä»¶ã

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

å½å¨æ´»å¨çèªå®ä¹æ§ä»¶ä¸éæ¾é¼ æ æé®æ¶ç±æ¡æ¶è°ç¨ã

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>åæ°

*n æé®*<br/>
éæ¾é¼ æ æé®çæ°å¼ã å®å¯ä»¥å·æä»¥ä¸å¼ä¹ä¸ï¼

- LEFT_BUTTON é¼ æ å·¦é®å·²éæ¾ã

- åå¸ MIDDLE_BUTTON é¼ æ ä¸­é®ã

- RIGHT_BUTTON é¼ æ å³é®å·²éæ¾ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

*x*<br/>
æ¸¸æ å·²éæ¾é¼ æ å·¦é®æ¶ç x åæ ã åæ æ¯ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

*y*<br/>
æ¸¸æ å·²éæ¾é¼ æ å·¦é®æ¶ç y åæ ã åæ æ¯ç¸å¯¹äºæ§ä»¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼æ¨å¯ä»¥ç¡®å®å¨æ¿åäºä»¶æ¶ã

å¯¹äºèªå¨è§¦å MouseUp äºä»¶çåçï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å·æå®ä¹çå¸¸ç¨ MouseUp äºä»¶ã

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

è§¦åäºä»¶ä¸å°±ç»ªç¶æçæ§ä»¶çå½åå¼ã

```
void FireReadyStateChange();
```

### <a name="remarks"></a>å¤æ³¨

å°±ç»ªç¶æå¯ä»¥æ¯ä¸åå¼ä¹ä¸ï¼

READYSTATE_UNINITIALIZED é»è®¤åå§åç¶æ

READYSTATE_LOADING æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§

READYSTATE_LOADED æ§ä»¶å·²ç»åå§å

READYSTATE_INTERACTIVE æ§ä»¶ææ°æ®ä¸è¶³ï¼æ æ³è¿è¡äº¤äºï¼ä½å°æªå è½½ä¸å¨é½æ¯å¼æ­¥çæ°æ®

READYSTATE_COMPLETE æ§ä»¶å·æå¶æææ°æ®

ä½¿ç¨[GetReadyState](#getreadystate)æ¥ç¡®å®æ§ä»¶çå½åçåå¤æåµã

[InternalSetReadyState](#internalsetreadystate)å°±ç»ªç¶ææ´æ¹ä¸ºå¼æä¾ï¼ç¶åè°ç¨`FireReadyStateChange`ã

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

æ´æ¹æ¯æçæ§ä»¶çé»è®¤æ¿æ´»è¡ä¸º`IPointerInactive`æ¥å£ã

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>è¿åå¼

POINTERINACTIVE æä¸¾ä¸­çæ å¿çç»åã å¯è½çæ å¿åæ¬ï¼

POINTERINACTIVE_ACTIVATEONENTRY å¯¹è±¡åºè¯¥æ¯å°±å°æ¿æ´»æ¶å¨é¼ æ ç§»å¨æä½æé´é¼ æ è¿å¥å®ã

POINTERINACTIVE_DEACTIVATEONLEAVE åºåç¨è¯¥å¯¹è±¡ï¼å½é¼ æ ç¦»å¼å¯¹è±¡æé´é¼ æ ç§»å¨æä½ã

POINTERINACTIVE_ACTIVATEONDRAG å¯¹è±¡åºå°±å°æ¿æ´»æé´å°å®ä¸æå¨é¼ æ æ¶ï¼å¹¶å é¤æä½ã

### <a name="remarks"></a>å¤æ³¨

å½`IPointerInactive`å¯ç¨æ¥å£ï¼å®¹å¨å°å§æ WM_SETCURSOR å WM_MOUSEMOVE æ¶æ¯å°å®ã `COleControl`éå½å°è°æ´é¼ æ åæ åï¼æ­¤æ¥å£çå®ç°å°è°åº¦éè¿æ§ä»¶çæ¶æ¯æ å°ï¼è¿äºæ¶æ¯ã

æ¯å½å®¹å¨å°éè¿éæ´»å¨ç¶æçå¯¹è±¡æ¯ææ¥æ¶ WM_SETCURSOR æ WM_MOUSEMOVE æ¶æ¯ä½¿ç¨é¼ æ æé`IPointerInactive`ï¼ååºè°ç¨`GetActivationPolicy`ä¸çæ¥å£å POINTERINACTIVE æä¸¾ä¸­è¿åçæ å¿ã

å¯ä»¥éè¿å°ç¸åºçæ¡ç®æ·»å å°æ¶æ¯æ å°å¤çè¿äºæ¶æ¯å°±åæ®éççªå£æ¶æ¯ä¸æ ·ã å¨æ¨çå¤çç¨åºï¼é¿åä½¿ç¨`m_hWnd`æååé ï¼æä½¿ç¨å®çä»»ä½æåå½æ°ï¼ èä¸å¿é¦åæ£æ¥å¶å¼ä¸ºé NULLã

ç¨äºæ§è¡å¤ä¸ªè®¾ç½®é¼ æ åæ å/æè§¦åé¼ æ ç§»å¨äºä»¶ï¼ä¾å¦ä»»ä½å¯¹è±¡æä¾ç¹æ®å¯è§åé¦ã åºè¿å POINTERINACTIVE_ACTIVATEONENTRY æ å¿åç»å¶æ´»å¨æ¶ä»çåé¦ã å¦ææ­¤æ å¿è¿åçå¯¹è±¡ï¼åºç«å³å°å¶å¨å°±å°æ¿æ´»ï¼ç¶åå°å¶è½¬åè§¦åå¯¹è°ç¨çåä¸æ¶æ¯å®¹å¨`GetActivationPolicy`ã

å¦æè¿å POINTERINACTIVE_ACTIVATEONENTRY å POINTERINACTIVE_DEACTIVATEONLEAVE æ å¿ï¼ç¶åè¯¥å¯¹è±¡å°ä»è¢«æ¿æ´»ï¼å½é¼ æ ä½äºå¯¹è±¡æ¶ã å¦æåªè¿å POINTERINACTIVE_ACTIVATEONENTRY æ å¿ï¼ç¶åè¯¥å¯¹è±¡å°æä¼æ¿æ´»é¼ æ é¦æ¬¡è¿å¥è¯¥å¯¹è±¡ã

æ¨å¯è½æ³è¦ä½ä¸ºç®æ ç OLE ææ¾æä½çéæ´»å¨æ§ä»¶ã è¿è¦æ±ç¨æ·å°å¯¹è±¡æå°å®ï¼æ­¤æ¶æ¿æ´»æ§ä»¶ï¼ä»¥ä¾¿å¯ä»¥å°æ§ä»¶ççªå£æ³¨åä¸ºæ¾ç½®ç®æ ã è¥è¦ä½¿ä»¥å¨æå¨è¿ç¨è¿è¡æ¿æ´»ï¼è¯·è¿å POINTERINACTIVE_ACTIVATEONDRAG æ å¿ï¼

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

ä¿¡æ¯ä¼ è¾¾çä¿¡æ¯`GetActivationPolicy`å®¹å¨ä¸åºç¼å­ã ç¸åï¼æ¯æ¬¡é¼ æ è¿å¥éæ´»å¨ç¶æçå¯¹è±¡æ¶ï¼åºè°ç¨æ­¤æ¹æ³ã

å¦æå¤äºéæ´»å¨ç¶æçå¯¹è±¡æªè¯·æ±è¦å°±å°æ¿æ´»å½é¼ æ è¿å¥å®æ¶ï¼å¶å®¹å¨åºåç»­ WM_SETCURSOR å°æ¶æ¯è°åº¦å°æ­¤å¯¹è±¡éè¿è°ç¨[OnInactiveSetCursor](#oninactivesetcursor)åªè¦é¼ æ æéä¸çå¯¹è±¡ä¿æä¸åã

å¯ç¨`IPointerInactive`æ¥å£éå¸¸è¡¨ç¤ºä½ å¸ææ§ä»¶ï¼ä½¿å¶è½å¤å¨ä»»ä½æ¶åå¤çé¼ æ æ¶æ¯ã è¥è¦å¨ä¸æ¯æçå®¹å¨ä¸­è·åæ­¤è¡ä¸º`IPointerInactive`æ¥å£ï¼æ¨å°éè¦å·ææ§ä»¶å§ç»æ¿æ´»æ¶å¯è§ï¼è¿æå³çè¯¥æ§ä»¶åºå·æå¨å¶åç§æ å¿ OLEMISC_ACTIVATEWHENVISIBLE æ å¿ã ä½æ¯ï¼è¥è¦é²æ­¢ä»æ­¤æ å¿ï¼å¹¶ä¸å¨å®¹å¨ä¸­ççææ¯æ`IPointerInactive`ï¼è¿å¯ä»¥æå® OLEMISC_IGNOREACTIVATEWHENVISIBLE æ å¿ï¼

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

è·åå®¹å¨çç¯å¢å±æ§çå¼ã

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>åæ°

*dwDispid*<br/>
æéçç¯å¢å±æ§çè°åº¦ IDã

*vtProp*<br/>
æå®è¦å¨ä¸­è¿åçå¼çç±»åçåä½ç±»åæ è®°*pvProp*ã

*pvProp*<br/>
æåå°æ¥æ¶çå±æ§å¼æè¿åå¼çåéçå°åçæéã This æéçå®éç±»åå¿é¡»å¹éæå®çç±»å*vtProp*ã

|vtProp|PvProp çç±»å|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>è¿åå¼

å¦ææ¯æç¯å¢çå±æ§ï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¨ä½¿ç¨`GetAmbientProperty`è¥è¦æ£ç´¢çç¯å¢ç DisplayName å ScaleUnits å±æ§ï¼è®¾ç½®*vtProp*ä¸º VT_BSTR å*pvProp*å°`CString*`ã å¦æè¦æ£ç´¢ç¯å¢å­ä½å±æ§ï¼è®¾ç½®*vtProp*å° VT_FONT å*pvProp*å° LPFONTDISP *ã

è¯·æ³¨æï¼å½æ°å·²æä¾å¸¸è§çç¯å¢å±æ§ï¼å¦[AmbientBackColor](#ambientbackcolor)å¹¶[AmbientFont](#ambientfont)ã

##  <a name="getappearance"></a>  COleControl::GetAppearance

å®ç°æ§ä»¶çå¤è§çå¸¸ç¨å±æ§ç Get å½æ°ã

```
short GetAppearance ();
```

### <a name="return-value"></a>è¿åå¼

è¿åçå¼æå®ä¸ºå½åçå¤è§è®¾ç½®**ç­**(VT_I2) å¼ï¼å¦ææåã å¦ææ§ä»¶çå¤è§æ¯å¹³é¢ï¼1ï¼åè¯¥æ§ä»¶çå¤è§æ¯ 3Dï¼æ­¤å¼ä¸ºé¶ã

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

å®ç°æ§ä»¶çèæ¯è²çå¸¸ç¨å±æ§ç Get å½æ°ã

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼è¿åå¼ä¸º OLE_COLOR å¼ï¼æå®å½åçèæ¯è²ã æ­¤å¼å¯ä»¥éè¿è°ç¨è½¬æ¢ä¸º COLORREF å¼`TranslateColor`ã

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

å®ç°æ§ä»¶çè¾¹æ¡æ ·å¼çå¸¸ç¨å±æ§ç Get å½æ°ã

```
short GetBorderStyle();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·ææ­£å¸¸çè¾¹æ¡;ï¼1å¦ææ§ä»¶å·ææ²¡æè¾¹æ¡ï¼åä¸º 0ã

##  <a name="getcapture"></a>  COleControl::GetCapture

ç¡®å®æ¯å¦`COleControl`å¯¹è±¡å·æé¼ æ æè·ã

```
CWnd* GetCapture();
```

### <a name="return-value"></a>è¿åå¼

å¦æè¯¥æ§ä»¶å·²æ¿æ´»å¹¶æ çªå£ï¼å°è¿å**è¿**å¦æè¯¥æ§ä»¶å½åå·æé¼ æ æè· ï¼ä½ä¸ºç±æ§ä»¶çå®¹å¨ï¼ï¼æå¦æå®ä¸å·ææè·ï¼åä¸º NULLã

å¦åï¼è¿å`CWnd`å·æé¼ æ æè·çå¯¹è±¡ (ä¸ç¸å`CWnd::GetCapture`)ã

### <a name="remarks"></a>å¤æ³¨

å·²æ¿æ´»çæ çªå£æ§ä»¶å¨æ¥æ¶å°é¼ æ æè·æ¶[SetCapture](#setcapture)è°ç¨ã

##  <a name="getclassid"></a>  COleControl::GetClassID

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢ OLE ç±» ID çæ§ä»¶ã

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>åæ°

*pclsid*<br/>
æåçä½ç½®çç±» idã

### <a name="return-value"></a>è¿åå¼

å¦æè¯¥è°ç¨æªæåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ç±å®ç°[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)ã

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

æ£ç´¢æ§ä»¶çç©å½¢åºåå·¦ä¸çè§åå¶å·¥ä½åºçå·¦ä¸çè§çåºå«ã

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>åæ°

*pdxOffset*<br/>
æå OLE æ§ä»¶çå®¢æ·ç«¯åºåçæ°´å¹³åç§»éã

*pdyOffset*<br/>
æå OLE æ§ä»¶çå®¢æ·ç«¯åºåçåç´åç§»éã

### <a name="remarks"></a>å¤æ³¨

OLE æ§ä»¶å·æå¨å¶å®¹å¨åçç©å½¢åºåã æ§ä»¶çå®¢æ·ç«¯åºåæ¯ä¸åæ¬è¾¹æ¡åæ»å¨æ¡çæ§ä»¶åºåã åç§»éæ¥æ£ç´¢`GetClientOffset`æ¯æ§ä»¶çç©å½¢åºåå·¦ä¸çè§åå¶å·¥ä½åºçå·¦ä¸çè§çåºå«ã å¦ææ§ä»¶æéå®¢æ·ç«¯åç´ èéæ åè¾¹æ¡åæ»å¨æ¡ï¼éåæ­¤æåå½æ°ä»¥æå®åç§»éã

##  <a name="getclientrect"></a>  COleControl::GetClientRect

æ£ç´¢æ§ä»¶çå·¥ä½åºçå¤§å°ã

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æå`RECT`ç»æï¼å®åå«æ çªå£æ§ä»¶çå®¢æ·ç«¯åºåçå°ºå¯¸; å³ï¼è¯¥æ§ä»¶çå¤§å°åå»çªå£è¾¹æ¡ã å¸§ã æ»å¨æ¡åç­ç­ã *LpRect*åæ°æç¤ºè¯¥æ§ä»¶çå®¢æ·ç«¯ç©å½¢ï¼èéå¶ä½ç½®çå¤§å°ã

##  <a name="getclientsite"></a>  COleControl::GetClientSite

å°æ¥è¯¢ä¸ä¸ªå¯¹è±¡ï¼ç¨äºæåå¶å½åçå®¢æ·ç«¯ç«ç¹ï¼å¨å¶å®¹å¨åçæéã

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>è¿åå¼

å¨å®¹å¨ä¸­æ§ä»¶çå½åå®¢æ·ç«¯ç«ç¹æåçæéã

### <a name="remarks"></a>å¤æ³¨

è¿åçæéæåçå®ä¾`IOleClientSite`ã `IOleClientSite`ç±å®¹å¨å®ç°çæ¥å£æ¯å¶ä¸ä¸æçå¯¹è±¡çè§å¾ï¼ å¶å®ä½å¨ææ¡£ä¸­ï¼å¶ä¸­å®å°è·åå¶å­å¨ã ç¨æ·çé¢åå¶ä»èµæºã

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

æ£ç´¢æ§å¶æ å¿è®¾ç½®ã

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>è¿åå¼

ControlFlags æä¸¾ä¸­çæ å¿æè¿ç®ç»åï¼

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸`GetControlFlags`è¿å`fastBeginPaint | clipPaintDC`ã

|||
|-|-|
|`fastBeginPaint`|å¦æè®¾ç½®ï¼è¯·ä½¿ç¨ begin ç»å¾å½æ°å®å¶èä¸æ¯ OLE æ§ä»¶ç[BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API ï¼é»è®¤è®¾ç½®ï¼ã|
|`clipPaintDC`|å¦ææªè®¾ç½®ï¼ç¦ç¨å¯¹`IntersectClipRect`æåç`COleControl`åè·å¾å°çéåº¦ä¼å¿ã å¦æä½¿ç¨æ çªå£æ¿æ´»ï¼åè¯¥æ å¿æ æã|
|`pointerInactive`|å¦æè®¾ç½®ï¼æä¾é¼ æ äº¤äºï¼èæ¨çæ§ä»¶å¤äºéæ´»å¨ç¶æï¼ä»è`COleControl`çå®ç°`IPointerInactive`æ¥å£ï¼å®é»è®¤å¤äºç¦ç¨ç¶æã|
|`noFlickerActivate`|å¦æè®¾ç½®ï¼åè½é¿åé¢å¤ç»å¶æä½åä¼´éçå¯è§éªçã å½æ¨çæ§ä»¶ç»å¶èªèº«ç¸åå¤äºéæ´»å¨åæ´»å¨ç¶ææ¶ä½¿ç¨ã å¦æä½¿ç¨æ çªå£æ¿æ´»ï¼åè¯¥æ å¿æ æã|
|`windowlessActivate`|å¦æè®¾ç½®ï¼åè¡¨ç¤ºæ¨çæ§ä»¶ä½¿ç¨æ çªå£æ¿æ´»ã|
|`canOptimizeDraw`|å¦æè®¾ç½®ï¼åæç¤ºè¯¥æ§ä»¶å°æ§è¡ä¼åçç»å¾ï¼å¦æè¯¥å®¹å¨æ¯æå®ã|

æå³è¯¦ç»ä¿¡æ¯`GetControlFlags`åå¶ä»ä¼å OLE æ§ä»¶ï¼è¯·åé[ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

æ£ç´¢ OLE æ§ä»¶çªå£çå¤§å°ã

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>åæ°

*pcx*<br/>
ä»¥åç´ ä¸ºåä½æå®æ§ä»¶çå®½åº¦ã

*pcy*<br/>
ä»¥åç´ ä¸ºåä½æå®æ§ä»¶çé«åº¦ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼ç¨äºæ§å¶ windows çææåæ é½é½ç¸å¯¹äºæ§ä»¶çå·¦ä¸è§ã

##  <a name="getdc"></a>  COleControl::GetDC

ä»å¶å®¹å¨ä¸ºæ çªå£å¯¹è±¡æä¾å° get å±å¹ ï¼æå¼å®¹ï¼ çè®¾å¤ä¸ä¸æã

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>åæ°

*lprcRect*<br/>
æ çªå£æ§ä»¶çç©å½¢çæéæ³è¦éç»æ§ä»¶çå·¥ä½åºä¸­ã NULL è¡¨ç¤ºå®æ´å¯¹è±¡çèå´ã

*dwFlags*<br/>
ç»å¶çè®¾å¤ä¸ä¸æçå±æ§ã éé¡¹åæ¬ï¼

- OLEDC_NODRAW æç¤ºï¼è¯¥å¯¹è±¡ä¸ä¼ä½¿ç¨è®¾å¤ä¸ä¸æä»¥æ§è¡ä»»ä½ç»å¾ä½åªä»¥è·åæå³æ¾ç¤ºè®¾å¤çä¿¡æ¯ã å®¹å¨åºåªéä¼ å¥çªå£ç DCï¼èæ éè¿ä¸æ­¥å¤çã

- OLEDC_PAINTBKGND è¯·æ±å®¹å¨è¿å DC ä¹åç»å¶èæ¯ã å¯¹è±¡åºä½¿ç¨æ­¤æ å¿ï¼å¦æå®è¯·æ± DC ç»å¶å¸¦æéæèæ¯çåºåã

- OLEDC_OFFSCREEN éç¥å¯¹è±¡æ³è¦åç°å°å±å¹å¤ä½å¾ï¼ç¶åå¤å¶å°å±å¹çå®¹å¨ã å¯¹è±¡åºä½¿ç¨æ­¤æ å¿æ¶å®å°æ§è¡ç»å¶æä½ä¼çæå¤§ééªçã å®¹å¨æ¯åè´¹å¯ä»¥æä¸æ¥åæ­¤è¯·æ±ã ä½æ¯ï¼å¦ææªè®¾ç½®æ­¤æ å¿ï¼å®¹å¨å¿é¡»éåå±å¹ DCã è¿åè®¸æ§è¡ç´æ¥å±å¹æä½ï¼ä¾å¦æ¾ç¤ºéæ©çå¯¹è±¡ (éè¿**XOR**æä½)ã

### <a name="return-value"></a>è¿åå¼

ä¸ºå®¹å¨çæ¾ç¤ºè®¾å¤ä¸ä¸ææé`CWnd`å·¥ä½åºå¦ææå; å¦åä¸ºè¿åå¼ä¸º NULLã æ¾ç¤ºè®¾å¤ä¸ä¸æå¯ä»¥å¨åç»­ç GDI å½æ°ï¼ç¨äºå¨å®¹å¨ççªå£çå®¢æ·ç«¯åºåä¸­ç»å¶ã

### <a name="remarks"></a>å¤æ³¨

[ReleaseDC](#releasedc)å¿é¡»è°ç¨æåå½æ°æ¥ç»å¶åéæ¾ä¸ä¸æã è°ç¨æ¶`GetDC`ï¼å¯¹è±¡å°ä¼ éèæ³è¦å¨å¶èªå·±çå·¥ä½åºåæ ä¸­ç»å¶å°çç©å½¢ã `GetDC` å°è½¬æ¢å°çå®¹å¨å·¥ä½åºçåæ ã è¯¥å¯¹è±¡åºè¯¥ä¸ä¼è¯·æ±æéçç»å¶ç©å½¢å¤§äºå¶èªå·±çå®¢æ·ç«¯åºåç©å½¢ï¼å¯éè¿æ£ç´¢å®çå¤§å°[GetClientRect](#getclientrect)ã è¿å¯ä»¥é²æ­¢æ æä¸­ç»å¶ï¼å®ä»¬ä¸åºä¸ºå¯¹è±¡ã

##  <a name="getenabled"></a>  COleControl::GetEnabled

å®ç°æ§ä»¶çè¡ç¥¨ Enabled å±æ§ç Get å½æ°ã

```
BOOL GetEnabled();
```

### <a name="return-value"></a>è¿åå¼

å¦æå¯ç¨æ§ä»¶ï¼åéé¶å¼å¦åä¸º 0ã

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

è·åæåè¡¨ç¤ºå·æä¸ç»æ©å±çå±æ§çæ§ä»¶çå®¹å¨æç»´æ¤çå¯¹è±¡çæéã

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>è¿åå¼

æåå®¹å¨çæ©å±æ§ä»¶å¯¹è±¡ã å¦ææ²¡æå¯ç¨çå¯¹è±¡ï¼åè¯¥å¼ä¸º NULLã

æ­¤å¯¹è±¡å¯è½ä¼éè¿æä½å¶`IDispatch`æ¥å£ã æ­¤å¤å¯ä»¥ä½¿ç¨`QueryInterface`è·åå¯¹è±¡æä¾çå¶ä»å¯ç¨æ¥å£ã ä½æ¯ï¼è¯¥å¯¹è±¡ä¸éè¦æ¯æä¸ç»ç¹å®çæ¥å£ã è¯·æ³¨æï¼ä¾èµäºå®¹å¨çæ©å±çæ§ä»¶å¯¹è±¡çç¹å®åè½éå¶å°å¶ä»ä»»æå®¹å¨æ§ä»¶çå¯ç§»æ¤æ§ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°çå½æ°ä¼éæ¾æ¶å·²å®æï¼ä½è¯¥å¯¹è±¡çæéã è¯·æ³¨æï¼ä¸éè¦å®¹å¨ä¸ºæ¯ææ­¤å¯¹è±¡ã

##  <a name="getfocus"></a>  COleControl::GetFocus

ç¡®å®æ¯å¦`COleControl`å¯¹è±¡å·æç¦ç¹ã

```
CWnd* GetFocus();
```

### <a name="return-value"></a>è¿åå¼

å¦æè¯¥æ§ä»¶å·²æ¿æ´»å¹¶æ çªå£ï¼å°è¿å**è¿**å¦æè¯¥æ§ä»¶å½åå·æé®çç¦ç¹ ï¼ä½ä¸ºç±æ§ä»¶çå®¹å¨ï¼ï¼æå¦æå®ä¸å·æç¦ç¹ï¼åä¸º NULLã

å¦åï¼è¿å`CWnd`å·æç¦ç¹çå¯¹è±¡ (ä¸ç¸å`CWnd::GetFocus`)ã

### <a name="remarks"></a>å¤æ³¨

å·²æ¿æ´»çæ çªå£æ§ä»¶æ¥æ¶ç¦ç¹æ¶[SetFocus](#setfocus)è°ç¨ã

##  <a name="getfont"></a>  COleControl::GetFont

å®ç°å¸¸ç¨å­ä½å±æ§ç Get å½æ°ã

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>è¿åå¼

æåæ§ä»¶çå¸¸ç¨å­ä½å±æ§çå­ä½è°åº¦æ¥å£çæéã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼è°ç¨æ¹å¿é¡»éæ¾å¯¹è±¡æ¶å®æã å¨æ§ä»¶å®ç°ä¸­ï¼ä½¿ç¨`InternalGetFont`è®¿é®æ§ä»¶çå¸¸ç¨å­ä½å¯¹è±¡ã ä½¿ç¨æ¨çæ§ä»¶ä¸­çå­ä½çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ å¨ ActiveX æ§ä»¶ä¸­ä½¿ç¨å­ä½](../../mfc/mfc-activex-controls-using-fonts.md)ã

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

åº¦éå¼çææ¬ææ ï¼éå¯¹ä»»ä½`CFontHolder`ææ¥æçæ§ä»¶å¯¹è±¡ã

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>åæ°

*lptm*<br/>
æå[TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)ç»æã

*fontHolder*<br/>
å¼ç¨[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥ä½¿ç¨éæ©è¿ç§å­ä½[COleControl::SelectFontObject](#selectfontobject)å½æ°ã `GetFontTextMetrics` å°åå§å`TEXTMETRIC`æåç»æ*lptm*ææææ æå³çä¿¡æ¯`fontHolder`çå­ä½ï¼å¦ææåï¼æå¦æä¸æåï¼åç¨é¶å¡«åç»æã åºä½¿ç¨æ­¤å½æ°ï¼èä¸æ¯[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)æ¶ç»å¶æ§ä»¶ï¼å ä¸ºæ§ä»¶ï¼åä»»ä½åµå¥ OLE å¯¹è±¡ï¼å¯è½éè¦èªè¡åç°å°å¾åæä»¶ã

`TEXTMETRIC`ç»æçé»è®¤å­ä½ä¸ºå·æ°æ¶[SelectFontObject](#selectfontobject)è°ç¨å½æ°ã åºè°ç¨`GetFontTextMetrics`å¯ä¸åéæ©å¸¸ç¨çå­ä½å±æ§ï¼ä»¥ç¡®ä¿å®æä¾çä¿¡æ¯æ¯å¦ææã

##  <a name="getforecolor"></a>  COleControl::GetForeColor

å®ç°å¸¸ç¨çåæ¯è²å±æ§ç Get å½æ°ã

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼è¿åå¼ä¸º OLE_COLOR å¼ï¼æå®çå½ååæ¯è²ã æ­¤å¼å¯ä»¥è½¬æ¢ä¸º[COLORREF](/windows/desktop/gdi/colorref)å¼ï¼è¯¥å¼å·æè°ç¨`TranslateColor`ã

##  <a name="gethwnd"></a>  COleControl::GetHwnd

å®ç°å¸¸ç¨ hWnd å±æ§ç Get å½æ°ã

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>è¿åå¼

OLE æ§ä»¶ççªå£å¥æï¼å¦ææçè¯;å¦åä¸ºï¼ä¸º NULLã

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

ç±æ¡æ¶è°ç¨ä»¥è·åç­å­ç¬¦ä¸²ï¼æè¿°ç±æ è¯çèåé¡¹çç®ç*nID*ã

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>åæ°

*nID*<br/>
èåé¡¹ idã

*rMessage*<br/>
å¯¹å¼ç¨[CString](../../atl-mfc-shared/reference/cstringt-class.md)å¯¹è±¡éè¿è¿åçå­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

è¿å¯ä»¥ç¨äºè·åå¨ç¶ææ ä¸­æ¾ç¤ºä¸æ¡æ¶æ¯ï¼èçªåºæ¾ç¤ºçèåé¡¹ã å°è¯å è½½ç±æ è¯çå­ç¬¦ä¸²èµæºçé»è®¤å®ç°*nID*ã

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

å¯é²æ­¢å¯¹ç¨æ·æ§ä»¶çå±æ§å¼çè®¿é®ã

```
void GetNotSupported();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°æ¥ä»£æ¿ä»»ä½å±æ§ç Get å½æ°ä¸æ¯æçæ§ä»¶çç¨æ·å±æ§æ£ç´¢çã ä¾å¦ï¼å¯ä»¥æ¯åªåçå±æ§ã

##  <a name="getreadystate"></a>  COleControl::GetReadyState

è¿åæ§ä»¶çå°±ç»ªç¶æã

```
long GetReadyState();
```

### <a name="return-value"></a>è¿åå¼

å°±ç»ªç¶æä¸ºæ§ä»¶ï¼ä¸åå¼ä¹ä¸ï¼

READYSTATE_UNINITIALIZED é»è®¤åå§åç¶æ

READYSTATE_LOADING æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§

READYSTATE_LOADED æ§ä»¶å·²ç»åå§å

READYSTATE_INTERACTIVE æ§ä»¶ææ°æ®ä¸è¶³ï¼æ æ³è¿è¡äº¤äºï¼ä½å°æªå è½½ä¸å¨é½æ¯å¼æ­¥çæ°æ®

READYSTATE_COMPLETE æ§ä»¶å·æå¶æææ°æ®

### <a name="remarks"></a>å¤æ³¨

å¤§å¤æ°ç®åæ§ä»¶æ°¸è¿ä¸éè¦åºå LOADED åäº¤äºã ä½æ¯ï¼æ¯ææ°æ®è·¯å¾å±æ§çæ§ä»¶å¯è½ä¸æ¯åå¤å¥½è¿è¡äº¤äºï¼ç´å°å¼æ­¥æ¥æ¶å°è³å°æäºæ°æ®ã æ§ä»¶åºå°è¯å°½å¯è½å¿«å°åä¸ºäº¤äºæ¨¡å¼ã

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

è·åç¸å¯¹äºå®¹å¨ï¼ä»¥è®¾å¤åä½è¡¨ç¤ºæ§ä»¶çç©å½¢çåæ ã

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æåæ§ä»¶çåæ å°å¤å¶å°å¶ä¸­çç©å½¢ç»æçæéã

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶æ¯å¤äºå°±å°æ´»å¨ç¶æ; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

ç©å½¢æææçæ§ä»¶æ¯å¤äºå°±å°æ´»å¨ç¶æã

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

æµéæ§ä»¶çå¸¸ç¨å­ä½å±æ§ï¼è¿å¯ä»¥ä½¿ç¨æéææ¬è§æ ¼[SelectStockFont](#selectstockfont)å½æ°ã

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>åæ°

*lptm*<br/>
ä¸ä¸ªæå[TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)ç»æã

### <a name="remarks"></a>å¤æ³¨

`GetStockTextMetrics`å½æ°å°åå§å`TEXTMETRIC`æåç»æ*lptm*å¸¦ææææ ä¿¡æ¯å¦ææåæå¡«åé¶ï¼å¦æä¸æåï¼åè¯¥ç»æã ä½¿ç¨æ­¤å½æ°ï¼èä¸æ¯[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)æ¶ç»å¶æ§ä»¶ï¼å ä¸ºæ§ä»¶ï¼åä»»ä½åµå¥ OLE å¯¹è±¡ï¼å¯è½éè¦èªè¡åç°å°å¾åæä»¶ã

`TEXTMETRIC`ç»æçé»è®¤å­ä½ä¸ºå·æ°æ¶`SelectStockFont`è°ç¨å½æ°ã ä»éæ©å¸¸ç¨çå­ä½ï¼ä»¥ç¡®ä¿å®æä¾çä¿¡æ¯ææä¹åï¼åºè°ç¨æ­¤å½æ°ã

##  <a name="gettext"></a>  COleControl::GetText

å®ç°å¸¸ç¨çææ¬ææ é¢å±æ§ç Get å½æ°ã

```
BSTR GetText();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çææ¬å­ç¬¦ä¸²æå¦æä¸æä»»ä½å­ç¬¦ä¸²çé¿åº¦ä¸ºé¶çå­ç¬¦ä¸²çå½åå¼ã

> [!NOTE]
>  BSTR æ°æ®ç±»åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[æ°æ®ç±»å](../../mfc/reference/data-types-mfc.md)å®åå¨å±å½æ°é¨åä¸­ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ­¤å½æ°çè°ç¨æ¹å¿é¡»è°ç¨`SysFreeString`å¯¹å­ç¬¦ä¸²è¿åä»¥ä¾¿åè´¹èµæºã å¨æ§ä»¶å®ç°ä¸­ï¼ä½¿ç¨`InternalGetText`è®¿é®æ§ä»¶çå¸¸ç¨ææ¬ææ é¢å±æ§ã

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

éå`GetWindowlessDropTarget`æ¶æ¨å¸ææ çªå£æ§ä»¶ä¸ºç®æ ç OLE ææ¾æä½ã

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>è¿åå¼

æåå¯¹è±¡çæé`IDropTarget`æ¥å£ã å ä¸ºå®ä¸ä¼å¨çªå£ä¸­ï¼æ çªå£å¯¹è±¡æ æ³æ³¨å`IDropTarget`æ¥å£ã ä½æ¯ï¼è¥è¦åä¸ææ¾åè½ï¼æ çªå£å¯¹è±¡å¯ä»¥ä»å®ç°æ¥å£å¹¶è¿åå®å¨`GetWindowlessDropTarget`ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ï¼è¿éè¦å°è¯¥æ§ä»¶ççªå£æ³¨åä¸ºæ¾ç½®ç®æ ã ä½ç±äºè¯¥æ§ä»¶æ²¡æèªå·±ççªå£ï¼è¯¥å®¹å¨å°ä½¿ç¨å¶èªå·±ççªå£ï¼ä¸ºæ¾ç½®ç®æ ã è¯¥æ§ä»¶åªæ¯éè¦æä¾çä¸ä¸ªå®ç°`IDropTarget`æ¥å£å°çå®¹å¨å¯ä»¥å§æçè°ç¨å¨éå½çæ¶é´ã ä¾å¦ï¼

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

éç¥æ§ä»¶å°ä½¿ç¨ç Iid çåºç±»ã

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>åæ°

*piidPrimary*<br/>
ä¸ºæ§ä»¶çä¸»è°åº¦æ¥å£çæ¥å£ ID çæéã

*piidEvents*<br/>
ä¸ºæ§ä»¶çäºä»¶æ¥å£çæ¥å£ ID çæéã

### <a name="remarks"></a>å¤æ³¨

æ§ä»¶çæé å½æ°æ¥éç¥çæ¥å£ Idï¼å°ä½¿ç¨æ¨çæ§ä»¶çåºç±»ä¸­è°ç¨æ­¤å½æ°ã

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

è®¿é®æ¨çæ§ä»¶çå æ  Font å±æ§

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>è¿åå¼

å¯¹å¼ç¨[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡ï¼å¶ä¸­åå«å¸¸ç¨å­ä½å¯¹è±¡ã

##  <a name="internalgettext"></a>  COleControl::InternalGetText

è®¿é®æ§ä»¶çå¸¸ç¨çææ¬ææ é¢å±æ§ã

```
const CString& InternalGetText();
```

### <a name="return-value"></a>è¿åå¼

å¯¹æ§ä»¶çææ¬å­ç¬¦ä¸²çå¼ç¨ã

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

è®¾ç½®æ§ä»¶çå°±ç»ªç¶æã

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>åæ°

*lNewReadyState*<br/>
è¦è®¾ç½®è¿è¡æ§å¶ï¼ä»¥ä¸å¼ä¹ä¸çåå¤æåµç¶æï¼

READYSTATE_UNINITIALIZED é»è®¤åå§åç¶æ

READYSTATE_LOADING æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§

READYSTATE_LOADED æ§ä»¶å·²ç»åå§å

READYSTATE_INTERACTIVE æ§ä»¶ææ°æ®ä¸è¶³ï¼æ æ³è¿è¡äº¤äºï¼ä½å°æªå è½½ä¸å¨é½æ¯å¼æ­¥çæ°æ®

READYSTATE_COMPLETE æ§ä»¶å·æå¶æææ°æ®

### <a name="remarks"></a>å¤æ³¨

å¤§å¤æ°ç®åæ§ä»¶æ°¸è¿ä¸éè¦åºå LOADED åäº¤äºã ä½æ¯ï¼æ¯ææ°æ®è·¯å¾å±æ§çæ§ä»¶å¯è½ä¸æ¯åå¤å¥½è¿è¡äº¤äºï¼ç´å°å¼æ­¥æ¥æ¶å°è³å°æäºæ°æ®ã æ§ä»¶åºå°è¯å°½å¯è½å¿«å°åä¸ºäº¤äºæ¨¡å¼ã

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

å¼ºå¶æ§ä»¶éç»èªèº«ã

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æåè¦å¤±æçæ§ä»¶çåºåçæéã

*bErase*<br/>
æå®æ¯å¦è¦æ¸é¤æ¶å¤çæ´æ°åºåä¸­æ´æ°åºåçèæ¯ã

### <a name="remarks"></a>å¤æ³¨

å¦æ*lpRect*å·æ NULL å¼ï¼å°éæ°ç»å¶æ´ä¸ªæ§ä»¶ã å¦æ*lpRect*ä¸ä¸º NULLï¼è¿è¡¨ç¤ºçæ¯æ æçæ§ä»¶çç©å½¢é¨åã å¨å¶ä¸­æ§ä»¶æ²¡æçªå£æå½åæªå¤äºæ´»å¨ç¶æï¼è¯¥ç©å½¢å¿½ç¥ï¼å¹¶ä¸è°ç¨å®¢æ·ç«¯ç«ç¹çæåµä¸[IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange)æåå½æ°ã ä½¿ç¨æ­¤å½æ°ï¼èä¸æ¯`CWnd::InvalidateRect`æ`InvalidateRect`ã

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

ä½¿ç»å®åºååçå®¹å¨çªå£çå®¢æ·ç«¯åºåæ æã

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>åæ°

*pRgn*<br/>
ä¸ä¸ªæå[CRgn](../../mfc/reference/crgn-class.md)å¯¹è±¡ï¼ç¨äºæ è¯è¦ä½¿ä¹æ æï¼å¨åå«çªå£çå·¥ä½åºä¸­ç OLE å¯¹è±¡çæ¾ç¤ºåºåã å¦ææ­¤åæ°ä¸º NULLï¼èå´æ¯æ´ä¸ªå¯¹è±¡ã

*bErase*<br/>
æå®æ¯å¦è¦æ¸é¤æ æçåºåä¸­çèæ¯ã å¦æä¸º TRUEï¼å°æ¸é¤èæ¯ã å¦æä¸º FALSEï¼åå¨åå°ä¿æä¸åã

### <a name="remarks"></a>å¤æ³¨

è¿å¯ç¨æ¥éç»æ çªå£æ§ä»¶å®¹å¨ä¸­ã æ æçåºåï¼ä»¥åæ´æ°åºåä¸­çææå¶ä»åºåæ è®°ä¸ºè¿è¡ç»å¶æ¶çä¸ä¸æ­¥[WM_PAINT](/windows/desktop/gdi/wm-paint)åéæ¶æ¯ã

å¦æ*bErase*æ¯ TRUE çæ¸é¤æ´æ°åºåï¼èä¸ä»ä»æ¯å¨ç»å®é¨ä»¶çæ´ä¸ªåºåä¸­çèæ¯çä»»æé¨åã

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

åè®¸ OLE æ§ä»¶çä¸ç¨çå è½½ã

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶æ­£å¨è½¬æ¢; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å½è½¬æ¢ä½¿ç¨ VBX ççªä½æ§ä»¶æ·»å å°å¦ä¸ä¸ªä½¿ç¨ OLE æ§ä»¶æ¶ï¼å¯è½éè¦ OLE æ§ä»¶çç¹æ®å è½½ä»£ç ã ä¾å¦ï¼å¦æä½ å è½½ç OLE æ§ä»¶çå®ä¾ï¼åå¯è½å¿é¡»è°ç¨[PX_Font](persistence-of-ole-controls.md#px_font)å¨ä½ `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

ä½æ¯ï¼VBX æ§ä»¶æ²¡æå­ä½å¯¹è±¡;åç¬ä¿å­æ¯ä¸ªå­ä½å±æ§ã å¨è¿ç§æåµä¸ï¼å°ä½¿ç¨`IsConvertingVBX`æ¥åºåè¿ä¸¤ç§æåµï¼

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

å¦æå° VBX æ§ä»¶ä¿å­ä¸æäºè¿å¶æ°æ® ï¼å¨å¶ VBM_SAVEPROPERTY æ¶æ¯å¤çç¨åºï¼ï¼å¹¶ä¸ OLE æ§ä»¶å°å¶äºè¿å¶æ°æ®ä¿å­å¨ä¸åçæ ¼å¼æ¯å¦ä¸ç§æåµã å¦ææ¨å¸æ OLE æ§ä»¶è¦ä¸è¯¥ VBX æ§ä»¶ååå¼å®¹ï¼æ æ³è¯»åä½¿ç¨çè¿ä¸¤ç§æ§çåæ°æ ¼å¼`IsConvertingVBX`éè¿åºåæ¯å¦æ­£å¨å è½½ VBX æ§ä»¶æ OLE æ§ä»¶çå½æ°ã

å¨æ§ä»¶ç`DoPropExchange`å½æ°ï¼æ¨å¯ä»¥æ£æ¥æ­¤æ¡ä»¶å¹¶å¦æä¸º trueï¼æ§è¡å è½½ä»£ç ç¹å®äºæ­¤çè½¬æ¢ï¼ï¼å¦åé¢çç¤ºä¾ï¼ã å¦ææ§ä»¶ä¸ä¼è¢«è½¬æ¢ï¼å¯ä»¥æ§è¡æ­£å¸¸çè´è½½çä»£ç ã æ­¤åè½æéç¨äºä» VBX å¯¹åºé¡¹è¦è½¬æ¢çæ§ä»¶ã

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

å¯ç¨èªå¨åæ¹æ³è°ç¨ã

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·²åå§å; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æ¡æ¶çå®ç°`IDispatch::Invoke`è°ç¨`IsInvokeAllowed`è¥è¦ç¡®å®ç»å®çå½æ° (ç±æ è¯`dispid`) å¯è½ä¼è°ç¨ã OLE æ§ä»¶çé»è®¤è¡ä¸ºæ¯åè®¸ä»å½æ§ä»¶å·²åå§å; è°ç¨èªå¨åæ¹æ³ä½æ¯ï¼`IsInvokeAllowed`æ¯èæå½æ°ï¼å¯ä»¥è¢«éåå¦æå¿è¦ ï¼ä¾å¦ï¼å½æ§ä»¶ç¨ä½èªå¨åæå¡å¨ï¼ã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åéç¥è¯åºæç«  Q166472ï¼"å¦ä½ï¼ ä½¿ç¨ OLE æ§ä»¶ä½ä¸ºèªå¨åæå¡å¨ã" ç¥è¯åºæç« ä½äº[ http://support.microsoft.com ](http://support.microsoft.com/)ã

##  <a name="ismodified"></a>  COleControl::IsModified

ç¡®å®æ§ä»¶çç¶æå·²è¢«ä¿®æ¹ã

```
BOOL IsModified();
```

### <a name="return-value"></a>è¿åå¼

å¦æèªä¸æ¬¡ä¿å­; æ§ä»¶çç¶æå·²è¢«ä¿®æ¹ï¼éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å½å±æ§å¼æ´æ¹æ¶ï¼åä¿®æ¹æ§ä»¶çç¶æã

##  <a name="isoptimizeddraw"></a>  Colecontrol:: Isoptimizeddraw

ç¡®å®å®¹å¨æ¯å¦ä¸ºå½åçç»å¶æä½æ¯æä¼åçç»å¾ã

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>è¿åå¼

å¦æè¯¥å®¹å¨æ¯æä¼åçç»å¾å½åç»å¾æä½; åä¸º TRUEå¦åä¸º FALSEã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¯æä¼åçç»å¾ï¼ç¶åè¯¥æ§ä»¶éè¦æ¶ï¼éæ©æ§çå¯¹è±¡ ï¼é¢ç¬ã ç»ç¬ã å­ä½ã ç­ï¼ è®¾å¤ä¸ä¸æä¸­å®æç»å¾ã

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

ç±æ¡æ¶è°ç¨ä»¥ç¡®å®æ¯å¦æ§ä»¶å­ç±» Windows æ§å¶ã

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>è¿åå¼

å¦æè¯¥æ§ä»¶è¿è¡äºå­ç±»å; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¿é¡»éåæ­¤å½æ°å¹¶è¿å TRUEï¼å¦æä½  OLE æ§å¶ Windows æ§ä»¶å­ç±»ã

##  <a name="load"></a>  COleControl::Load

éç½®ä»¥å¼æ­¥æ¹å¼å è½½ææä»¥åçæ°æ®ï¼å¹¶å¯å¨æ°å è½½çæ§ä»¶çå¼æ­¥å±æ§ã

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>åæ°

*strNewPath*<br/>
æååå«å¼ç¨å¼æ­¥æ§ä»¶å±æ§çç»å¯¹ä½ç½®è·¯å¾çå­ç¬¦ä¸²çæéã

*å±æ§*<br/>
ä¸ä¸ª[CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)å®ç°å¼æ­¥æ§ä»¶å±æ§çå¯¹è±¡ã

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

å¯é²æ­¢å®¹å¨åç¨æ¨çæ§ä»¶ã

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>åæ°

*å*<br/>
å¦æè¯¥æ§ä»¶çå°±å°æ´»å¨ç¶æå°è¢«éå®; åä¸º TRUEå¦æå®æ¯å°å¶è§£éï¼åä¸º FALSEã

### <a name="return-value"></a>è¿åå¼

å¦æéå®æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æå¿é¡»ä¸æ§ä»¶å®æè§£éæå¯¹æ¯ä¸ªæ§ä»¶çéå®ã ä½ åºä»éå®æ¨çæ§ä»¶ç­æ¶é´åï¼å¦è§¦åäºä»¶æ¶ã

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

å½å®¹å¨çç¯å¢å±æ§å·²æ´æ¹å¼æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>åæ°

*dispID*<br/>
åçæ´æ¹æ¶ï¼ç¯å¢å±æ§çè°åº¦ ID æ DISPID_UNKNOWN å¦æå¤ä¸ªå±æ§å·²æ´æ¹ã

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

è¡ç¥¨çå¤è§å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã é»è®¤å®ç°å°è°ç¨`InvalidateControl`ã

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

è¡ç¥¨ BackColor å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã é»è®¤å®ç°å°è°ç¨`InvalidateControl`ã

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

è¡ç¥¨ BorderStyle å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨`InvalidateControl`ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã

##  <a name="onclick"></a>  COleControl::OnClick

å·²åå»é¼ æ æé®æè°ç¨ DoClick å¸¸ç¨æ¹æ³æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>åæ°

*iButton*<br/>
é¼ æ æé®çç´¢å¼ã å¯ä»¥å·æä»¥ä¸å¼ä¹ä¸ï¼

- LEFT_BUTTON åå»äºé¼ æ å·¦é®ã

- åå» MIDDLE_BUTTON é¼ æ ä¸­é®ã

- åå»äºé¼ æ å³é®æé® RIGHT_BUTTONã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨`COleControl::FireClick`ã

éåæ­¤æåå½æ°ä»¥ä¿®æ¹ææ©å±çé»è®¤å¤çã

##  <a name="onclose"></a>  COleControl::OnClose

å½å®¹å¨å·²è°ç¨è¯¥æ§ä»¶æ¶ç±æ¡æ¶è°ç¨`IOleControl::Close`å½æ°ã

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>åæ°

*dwSaveOption*<br/>
è¯¥æ å¿æç¤ºæ¯å¦åºå¨å è½½ä¹åä¿å­å¯¹è±¡ã ææå¼ä¸ºï¼

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸`OnClose`å°ä¿å­çæ§ä»¶å¯¹è±¡ï¼å¦æå·²ä¿®æ¹å¹¶*dwSaveOption* OLECLOSE_SAVEIFDIRTY æ OLECLOSE_PROMPTSAVEã

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

å½å®¹å¨è°ç¨æ¶ç±æ¡æ¶è°ç¨`IOleObject::DoVerb`æåå½æ°ã

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*iVerb*<br/>
è¦è°ç¨ä¸­æ§å¶è°è¯çç´¢å¼ã

*lpMsg*<br/>
å¯¼è´è¦è°ç¨çè°è¯ç Windows æ¶æ¯æåçæéã

*hWndParent*<br/>
åæ§ä»¶çç¶çªå£å¥æã å¦æè°è¯çæ§è¡å°åå»ºä¸ä¸ªçªå£ ï¼æ windowsï¼ *hWndParent*åºä½ä¸ºç¶çº§ã

*lpRect*<br/>
æåçæ§ä»¶ï¼ç¸å¯¹äºå®¹å¨çå·¥ä½å°å¤å¶å°å¶ä¸­ç RECT ç»æçæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä½¿ç¨ ON_OLEVERB å ON_STDOLEVERB æ¶æ¯æ å°æ¡ç®æ¥ç¡®å®è¦è°ç¨çéå½å½æ°ã

éåæ­¤å½æ°å¯æ´æ¹é»è®¤çå¤ççè°è¯ã

##  <a name="ondraw"></a>  COleControl::OnDraw

ç±æ¡æ¶è°ç¨ä»¥ä½¿ç¨æå®çè®¾å¤ä¸ä¸æçæå®è¾¹æ¡åç»å¶ OLE æ§ä»¶ã

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
ç»å¾åçå¨å¶ä¸­çè®¾å¤ä¸ä¸æã

*rcBounds*<br/>
æ§ä»¶ï¼åæ¬è¾¹æ¡çç©å½¢åºåã

*rcInvalid*<br/>
æ¯æ æçæ§ä»¶çç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

`OnDraw` éå¸¸ç¨äºå±å¹æ¾ç¤ºï¼å¹¶ä¼ éä½ä¸ºå±å¹è®¾å¤ä¸ä¸æè°ç¨*pDC*ã *RcBounds*åæ°æ è¯çç®æ è®¾å¤ä¸ä¸æ ï¼ç¸å¯¹äºå½åæ å°æ¨¡å¼ä¸ï¼ ä¸­çç©å½¢ã *RcInvalid*åæ°æ¯æ æçå®éç©å½¢ã å¨æäºæåµä¸ï¼è¿å°æ¯æ¯è¾å°çåºå*rcBounds*ã

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

ç±æ¡æ¶è°ç¨ä»¥ä½¿ç¨æå®çå¾åæä»¶è®¾å¤ä¸ä¸æçæå®è¾¹æ¡åç»å¶ OLE æ§ä»¶ã

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
ç»å¾åçå¨å¶ä¸­çè®¾å¤ä¸ä¸æã

*rcBounds*<br/>
æ§ä»¶ï¼åæ¬è¾¹æ¡çç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨[OnDraw](#ondraw)å½æ°ã

##  <a name="onedit"></a>  COleControl::OnEdit

å¯¼è´æ¯ UI æ¿æ´»çæ§ä»¶ã

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpMsg*<br/>
æåè°ç¨æ­¤è°è¯ç Windows æ¶æ¯çæéã

*hWndParent*<br/>
æ§ä»¶çç¶çªå£çå¥æã

*lpRect*<br/>
æåç±å®¹å¨ä¸­æ§ä»¶çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

è¿ä¸è°ç¨æ§ä»¶ç OLEIVERB_UIACTIVATE è°è¯çææç¸åã

æ­¤å½æ°éå¸¸ç¨ä½ ON_OLEVERB æ¶æ¯æ å°æ¡ç®çå¤çç¨åºå½æ°ã è¿ä½¿"ç¼è¾"è°è¯åºç°å¨æ§ä»¶ç"å¯¹è±¡"èåã ä¾å¦ï¼

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Stock Enabled å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>å¤æ³¨

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã é»è®¤å®ç°è°ç¨[InvalidateControl](#invalidatecontrol)ã

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

å½å®¹å¨è°ç¨æ¶ç±æ¡æ¶è°ç¨`IOleObject::EnumVerbs`æåå½æ°ã

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>åæ°

*ppenumOleVerb*<br/>
ä¸ä¸ªæå`IEnumOLEVERB`æä¸¾æ§ä»¶çè°è¯çå¯¹è±¡ã

### <a name="return-value"></a>è¿åå¼

å¦æè°è¯æ¯å¯ç¨ï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æä¸¾ä¸­çæ¶æ¯æ å°ç ON_OLEVERB æ¡ç®ã

éåæ­¤å½æ°å¯æ´æ¹æä¸¾è°è¯çé»è®¤æ¹å¼ã

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

è¿æ¥å°ææ­å¼è¿æ¥æ¥èª OLE æ§ä»¶çäºä»¶å¤çç¨åºæ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>åæ°

*bAdvise*<br/>
TRUE è¡¨ç¤ºä¸ä¸ªäºä»¶å¤çç¨åºå·²è¿æ¥å°æ§ä»¶ã FALSE è¡¨ç¤ºä»æ§ä»¶æ­å¼è¿æ¥äºä»¶å¤çç¨åºã

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

å¸¸ç¨å­ä½å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨`COleControl::InvalidateControl`ã å¦ææ§ä»¶å­ç±»å Windows æ§ä»¶ï¼åé»è®¤å®ç°è¿å° WM_SETFONT æ¶æ¯åéå°æ§ä»¶ççªå£ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

è¡ç¥¨ ForeColor å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨`InvalidateControl`ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

ç±æ¡æ¶è°ç¨åå®¹å¨è°ç¨`IOleControl::FreezeEvents`ã

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>åæ°

*bFreeze*<br/>
å¦ææ§ä»¶çäºä»¶å¤çå¤äºå»ç»ç¶æ;å¦åä¸º FALSEã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã

éåæ­¤å½æ°ï¼å¦æå»ç»æè§£å»äºä»¶å¤çæ¶éè¦å¶ä»è¡ä¸ºã

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

å½å®¹å¨è°ç¨æ¶ç±æ¡æ¶è°ç¨`IViewObject::GetColorSet`æåå½æ°ã

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>åæ°

*ptd*<br/>
æåç®æ è®¾å¤åºä¸ºå¶åç°å¾çã å¦ææ­¤å¼ä¸º NULLï¼ååºä¸ºé»è®¤ç®æ è®¾å¤ï¼éå¸¸æ¾ç¤ºè®¾å¤åç°å¾çã

*hicTargetDev*<br/>
æç¤ºå¨ç®æ è®¾å¤ä¸æå®çä¿¡æ¯ä¸ä¸æ*ptd*ã æ­¤åæ°å¯ä»¥æ¯è®¾å¤ä¸ä¸æï¼ä½ä¸ä¸å®ã å¦æ*ptd*ä¸º NULLï¼ *hicTargetDev*è¿åºä¸º NULLã

*ppColorSet*<br/>
æåå°ä½¿ç¨çé¢è²éåºè¯¥å¤å¶å°å¶ä¸­çä½ç½®çæéã å¦æè¯¥å½æ°ä¸è¿åé¢è²éï¼åè¿å NULLã

### <a name="return-value"></a>è¿åå¼

è¿åææçé¢è²é; å¦æéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å®¹å¨è°ç¨æ­¤å½æ°å¯è·åæææéç»å¶ OLE æ§ä»¶çé¢è²ã å®¹å¨å¯ä»¥ä½¿ç¨è·åå®éè¦è®¾ç½®æ´ä¸ªè°è²æ¿çé¢è²ä¸ç»åä½¿ç¨çé¢è²éã é»è®¤å®ç°å°è¿å FALSEã

éåæ­¤å½æ°å¯æ§è¡æ­¤è¯·æ±çä»»ä½ç¹æ®å¤çã

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

å½æ§ä»¶çå®¹å¨å·²è¯·æ±æå³æ§ä»¶çä¿¡æ¯æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>åæ°

*pControlInfo*<br/>
æå[CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo)è¦å¡«åçç»æã

### <a name="remarks"></a>å¤æ³¨

æ­¤ä¿¡æ¯ä¸»è¦ç±æ§ä»¶çå©è®°é®çè¯´æã é»è®¤å®ç°å¡«å*pControlInfo*ä¸é»è®¤çä¿¡æ¯ã

å¦ææ¨çæ§ä»¶éè¦å¤çå©è®°é®ï¼éåæ­¤å½æ°ã

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

ç±æ¡æ¶è°ç¨ä»¥è·åä¸ä¸ªå­ç¬¦ä¸²ï¼è¡¨ç¤ºéè¿æ è¯çå±æ§çå½åå¼*dispid*ã

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*strValue*<br/>
å¯¹å¼ç¨[CString](../../atl-mfc-shared/reference/cstringt-class.md)å¯¹è±¡éè¿è¿åçå­ç¬¦ä¸²ã

### <a name="return-value"></a>è¿åå¼

å¦æå·²å¨è¿åçå­ç¬¦ä¸²çéé¶*strValue;* å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¨çæ§ä»¶å·æå¶å¼ä¸è½ç´æ¥è½¬æ¢ä¸ºå­ç¬¦ä¸²çå±æ§ï¼å¹¶ä¸ä½ æ³è¦å¨å®¹å¨æä¾å±æ§æµè§å¨ä¸­æ¾ç¤ºçå±æ§çå¼æ¥è¦çæ­¤å½æ°ã

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

å½æ§ä»¶å¤äºç¨æ·çé¢æ¿æ´»ä»¥è·åè¦åå¹¶å°å®¹å¨çç°æèåçèåæ¶ç±æ¡æ¶è°ç¨ã

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çèåä¸­æå¦æè¯¥æ§ä»¶å·æ noneï¼åä¸º NULL çå¥æã é»è®¤å®ç°è¿å NULLã

### <a name="remarks"></a>å¤æ³¨

åå¹¶ OLE èµæºçè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [èååèµæº (OLE)](../../mfc/menus-and-resources-ole.md)ã

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

å¨ååºå®¹å¨çæ¡æ¶è°ç¨`IViewObjectEx::GetNaturalExtent`è¯·æ±ã

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æå®è¦å¦ä½è¡¨ç¤ºè¯¥å¯¹è±¡ã è¡¨ç¤ºå½¢å¼åå«åå®¹ã å¾æ ã ç¼©ç¥å¾ææå°çææ¡£ã ææçå¼åèªæä¸¾[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)æ DVASPECT2ã

*lindex*<br/>
æå´è¶£çæ¯å¯¹è±¡çé¨åã å½åä»ä¸º-1 æ¯ææçã

*ptd*<br/>
æå[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)ç»æå®ä¹åºå½ä¸ºå¶è¿åå¯¹è±¡çå¤§å°çç®æ è®¾å¤ã

*hicTargetDev*<br/>
æå®ç±ç®æ è®¾å¤çä¿¡æ¯ä¸ä¸æ*ptd*åæ°å¯¹è±¡ä»å¶æåè®¾å¤éåº¦å¹¶æµè¯è®¾å¤çåè½ã å¦æ*ptd*ä¸º NULLï¼è¯¥å¯¹è±¡åºå¿½ç¥ä¸­çå¼*hicTargetDev*åæ°ã

*pExtentInfo*<br/>
æå`DVEXTENTINFO`ç»æï¼å®æå®å¤§å°è°æ´æ°æ®ã `DVEXTENTINFO`ç»ææ¯ï¼

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

ç»ææå`dwExtentMode`å¯ä»¥éç¨ä¸¤ä¸ªå¼ä¹ä¸ï¼

- DVEXTENT_CONTENT æ¥è¯¢æ§ä»¶åºè¯¥æå¤å¤§ä»¥å®å¨éååå®¹ ï¼ç®¡çååå¤§å°ï¼

- DVEXTENT_INTEGRAL å¨è°æ´å¤§å°æ¶ï¼å°å»ºè®®çå¤§å°ä¼ éå°æ§ä»¶

*psizel*<br/>
æåå¤§å°æ§å¶è¿åçæ°æ®ã è¿åçå¤§å°è°æ´æ°æ®è®¾ç½®ä¸º-1ï¼è¡¨ç¤ºæªç»è¿è°æ´çä»»ä½ç»´åº¦ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åï¼æè°æ´å¤§å°; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

éåæ­¤å½æ°å¯è¿åå¯¹è±¡çæ¾ç¤ºå¤§å°æ¥è¿ä¸­å»ºè®®çå¤§å°åæ©å±çåºæ¨¡å¼`DVEXTENTINFO`ç»æã é»è®¤å®ç°è¿å FALSEï¼å¹¶ä¸å°ä»»ä½è°æ´å¤§å°ã

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

ç±æ¡æ¶è°ç¨ä»¥è·åä¸ç»é¢å®ä¹çå­ç¬¦ä¸²è¡¨ç¤ºä¸ä¸ªå±æ§çå¯è½å¼ã

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*pStringArray*<br/>
ä¸ä¸ªå­ç¬¦ä¸²æ°ç»ä¸­ç¨æ¥å¡«åè¿åçå¼ã

*pCookieArray*<br/>
ä¸ä¸ªåå­èæ°ç»ä¸­ç¨æ¥å¡«åè¿åçå¼ã

### <a name="return-value"></a>è¿åå¼

å¦æåç´ å·²æ·»å å°éé¶*pStringArray*å¹¶*pCookieArray*ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶æå·æä¸ç»å¯ç±å­ç¬¦ä¸²è¡¨ç¤ºçå¯è½å¼çå±æ§ï¼éåæ­¤å½æ°ã æ·»å å°æ¯ä¸ªåç´ *pStringArray*ï¼åºæ·»å å°ç¸åºç"cookie"åç´ *pCookieArrayã* è¿äº"cookie"å¼å¯è½ä¼æ´é«çæ¬ä¼ éå°æ¡æ¶`COleControl::OnGetPredefinedValue`å½æ°ã

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

ç±æ¡æ¶è°ç¨ä»¥è·åå¯¹åºäºä¸ä¸ªä»¥åè¿åçéåçé¢å®ä¹å­ç¬¦ä¸²å¼`COleControl::OnGetPredefinedStrings`ã

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*dwCookie*<br/>
éåä»¥åè¿åç cookie å¼`COleControl::OnGetPredefinedStrings`ã

*lpvarOut*<br/>
æå`VARIANT`ç»æï¼éè¿å°å¶è¿åå±æ§å¼ã

### <a name="return-value"></a>è¿åå¼

å¦æå·²å¨è¿åçå¼éé¶*lpvarOut*; å¦åä¸º 0ã

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

è°ç¨ä»¥ååºå®¹å¨çæ¡æ¶[IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent)è¯·æ±ã

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>åæ°

*dwDrawAspect*<br/>
æè¿°ççªä½ä¸­æå¯¹è±¡çæ¹ä½ï¼DWORD æ¯æ¾ç¤ºã ææçå¼åèªæä¸¾[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)æ DVASPECT2ã

*lindex*<br/>
æå´è¶£çæ¯å¯¹è±¡çé¨åã å½åä»ä¸º-1 æ¯ææçã

*ptd*<br/>
æå[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)ç»æå®ä¹åºå½ä¸ºå¶è¿åå¯¹è±¡çå¤§å°çç®æ è®¾å¤ã

*lpsizel*<br/>
æåå°è¿åå¯¹è±¡çå¤§å°çä½ç½®ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åæ©å±çåºä¿¡æ¯; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¨çæ§ä»¶ä½¿ç¨ä¸¤æ¬¡ç»å¾ï¼å¹¶ä¸å¶ä¸éæåéæçé¨ä»¶å·æä¸åçç»´åº¦ï¼éåæ­¤å½æ°ã

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

å¨ååºå®¹å¨çæ¡æ¶è°ç¨`IViewObjectEx::GetRect`è¯·æ±ã

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æè¿°ççªä½ä¸­æå¯¹è±¡çæ¹ä½ï¼DWORD æ¯æ¾ç¤ºã ææçå¼åèªæä¸¾[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)æ DVASPECT2:

- DVASPECT_CONTENT è¾¹çç©å½¢çæ´ä¸ªå¯¹è±¡ã å¯¹è±¡çæºåå¤§å°ç¸ç­çèå´åè¿åçå·¦ä¸è§`GetViewExtent` *ã*

- ä½¿ç¨ä¸éæçç©å½¢åºåç DVASPECT_OPAQUE å¯¹è±¡è¿åè¯¥ç©å½¢ã å¶ä»å¤±è´¥ã

- è¦çéææä¸å®æåä¸ª DVASPECT_TRANSPARENT ç©å½¢ã

*pRect*<br/>
æå[RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907)ç»æï¼å®æå®åºå¨å¶ä¸­ç»å¶è¯¥å¯¹è±¡çç©å½¢ã æ­¤åæ°æ§å¶çå®ä½åæä¼¸çå¯¹è±¡ã

### <a name="return-value"></a>è¿åå¼

æåå°è¿åç©å½¢çå¤§å°è°æ´ä¸ºè¯¥å¯¹è±¡; å¦æéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¯¹è±¡çå¤§å°æ¥è½¬æ¢`OnGetViewRect`å¨ä¸ä¸ªç©å½¢ç ï¼é»è®¤ä¸ºæ¾ç¤ºçå·¦ä¸çè§ï¼ çç¹å®ä½ç½®å¼å§ã å¦ææ¨çæ§ä»¶ä½¿ç¨ä¸¤æ¬¡ç»å¾ï¼å¹¶ä¸å¶ä¸éæåéæçé¨ä»¶å·æä¸åçç»´åº¦ï¼éåæ­¤å½æ°ã

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

å¨ååºå®¹å¨çæ¡æ¶è°ç¨`IViewObjectEx::GetViewStatus`è¯·æ±ã

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼å VIEWSTATUS æä¸¾å¼ä¹ä¸å¦åä¸º 0ã å¯è½çå¼ä¸ºä»¥ä¸ä»»æç»åï¼

VIEWSTATUS_OPAQUE å¯¹è±¡æ¯å®å¨ä¸éæçã å¦ææªè®¾ç½®æ­¤ä½ï¼è¯¥å¯¹è±¡åå«éæé¨åã æ­¤ä½ä»éç¨äºä¸åå®¹ç¸å³çæ¹é¢åä¸éç¨äº DVASPECT_ICON æ DVASPECT_DOCPRINTã

VIEWSTATUS_SOLIDBKGND å¯¹è±¡å·æçº¯è²èæ¯ ï¼åå«å¨çº¯è²ï¼èéç»ç¬å¾æ¡ä¸­ï¼ã ä»å½ VIEWSTATUS_OPAQUE è®¾ç½®ä¸ä»éç¨äºä¸åå®¹ç¸å³çæ¹é¢åä¸éç¨äº DVASPECT_ICON æ DVASPECT_DOCPRINT æ­¤ä½ä¸ºææä¹ã

VIEWSTATUS_DVASPECTOPAQUE å¯¹è±¡æ¯æ DVASPECT_OPAQUEã å¯ä»¥ä½¿ç¨æ­¤æ¹é¢è°ç¨åæ°æ¶æéåçç»å¾æ¹ä½çææ IViewObjectEx æ¹æ³ã

VIEWSTATUS_DVASPECTTRANSPARENT å¯¹è±¡æ¯æ DVASPECT_TRANSPARENTã ææ`IViewObjectEx`æ¹æ³å¯ä»¥å¯¹æ­¤è°ç¨åæ°æ¶æéåçç»å¾æ¹ä½ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¨çæ§ä»¶ä½¿ç¨ä¸¤æ¬¡ç»å¾ï¼éåæ­¤å½æ°ã é»è®¤å®ç°è¿å VIEWSTATUS_OPAQUEã

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

å½æ§ä»¶å¤äºç¨æ·çé¢å·²åç¨æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>å¤æ³¨

å®ç°åºéèæææåµä¸æ¾ç¤ºçå·¥å·æ `OnShowToolbars`ã

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

åä¸ºæä¸é¼ æ æéå¨æ¶å° WM_MOUSEMOVE æ¶æ¯å¤äºéæ´»å¨ç¶æçå¯¹è±¡çå®¹å¨ã

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
è¾¹çç©å½¢ï¼å¨åå«çªå£çå·¥ä½åºä¸­çå¯¹è±¡ã åç¥å¯¹è±¡å¶åç¡®ä½ç½®åå¤§å°å¨å±å¹ä¸æ¶å° WM_MOUSEMOVE æ¶æ¯æ¶ã

*x*<br/>
åå«çªå£å·¥ä½åºåæ ä¸­é¼ æ ä½ç½®ç x åæ ã

*y*<br/>
åå«çªå£å·¥ä½åºåæ ä¸­é¼ æ ä½ç½®ç y åæ ã

*dwKeyState*<br/>
æ è¯å¨é®çä¸çé®çä¿®æ¹é®çå½åç¶æã ææçå¼å¯ä»¥æ¯ä»»ä½ MK_CONTROLã MK_SHIFTã MK_ALTã MK_BUTTONã MK_LBUTTONã MK_MBUTTON å MK_RBUTTON çæ å¿çç»åã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æçªå£å·¥ä½åºåæ  ï¼åç´ ï¼ï¼ç¨äºä¼ éé¼ æ åæ ä½ç½®ã è¿æ¯éè¿å®ç°åæ¶ä¼ éè¯¥å¯¹è±¡çè¾¹çç©å½¢ç¸åçåæ ç³»ç»ä¸­ã

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

å¨å°é¼ æ æéæ¬åå¨æ¥æ¶ WM_SETCURSOR æ¶æ¯å¤äºéæ´»å¨ç¶æçå¯¹è±¡çå®¹å¨ç±è°ç¨ã

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
è¾¹çç©å½¢ï¼å¨åå«çªå£çå·¥ä½åºä¸­çå¯¹è±¡ã åç¥å¯¹è±¡å¶åç¡®ä½ç½®åå¤§å°å¨å±å¹ä¸æ¶æ¥æ¶ WM_SETCURSOR æ¶æ¯ã

*x*<br/>
åå«çªå£å·¥ä½åºåæ ä¸­é¼ æ ä½ç½®ç x åæ ã

*y*<br/>
åå«çªå£å·¥ä½åºåæ ä¸­é¼ æ ä½ç½®ç y åæ ã

*dwMouseMsg*<br/>
WM_SETCURSOR åçé¼ æ æ¶æ¯çæ è¯ç¬¦ã

*bSetAlways*<br/>
æå®å¿é¡»è®¾ç½®åæ çå¯¹è±¡ã å¦æä¸º TRUEï¼è¯¥å¯¹è±¡å¿é¡»è®¾ç½®æ¸¸æ ;å¦æä¸º FALSEï¼åæ æ²¡æä¹å¡å°åæ æ¾ç½®ï¼å¹¶ä¸åºå¨è¿ç§æåµä¸è¿å S_FALSEã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æçªå£å·¥ä½åºåæ  ï¼åç´ ï¼ï¼ç¨äºä¼ éé¼ æ åæ ä½ç½®ã è¿æ¯éè¿å®ç°åæ¶ä¼ éè¯¥å¯¹è±¡çè¾¹çç©å½¢ç¸åçåæ ç³»ç»ä¸­ã

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

å¨å¤çå¸¸ç¨ç KeyDown äºä»¶ä¹åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>åæ°

*NChar*<br/>
æä¸çé®èæé®ä»£ç å¼ã æ åèæé®ä»£ç çåè¡¨ï¼è¯·åè§ Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¨çæ§ä»¶éè¦è®¿é®å¯é¥ä¿¡æ¯åè§¦åäºäºä»¶ï¼éåæ­¤å½æ°ã

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

ç±æ¡æ¶è°ç¨ä¹åå¼å KeyPress äºä»¶çè¡ç¥¨ã

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>åæ°

*NChar*<br/>
åå«èæé®ä»£ç å¼çæä¸çé®ã æ åèæé®ä»£ç çåè¡¨ï¼è¯·åè§ Winuser.h

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼ *nChar*å¼å¯è½å·²è¢«ä¿®æ¹çå®¹å¨ã

å¦æå¸æéç¥æ­¤äºä»¶åçåï¼éåæ­¤å½æ°ã

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

å¨å¤çå¸¸ç¨ç KeyDown äºä»¶ä¹åï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>åæ°

*NChar*<br/>
æä¸çé®èæé®ä»£ç å¼ã æ åèæé®ä»£ç çåè¡¨ï¼è¯·åè§ Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- å¨æä½æé´æä¸äº SHIFT_MASK SHIFT é®ã

- å¨æä½æé´æä¸äº CTRL_MASK CTRL é®ã

- å¨æä½æé´æä¸ ALT_MASK ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¨çæ§ä»¶éè¦è®¿é®å¯é¥ä¿¡æ¯åè§¦åäºäºä»¶ï¼éåæ­¤å½æ°ã

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

ç±æ¡æ¶è°ç¨ä»¥è·åå®ç°ç¼è¾æå®çå±æ§çå±æ§é¡µçç±» IDã

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>åæ°

*dispid*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*lpclsid*<br/>
æå`CLSID`ç»æï¼éè¿è¿åçç±» IDã

*pbPageOptional*<br/>
è¿åæç¤ºæ¯å¦æå®çå±æ§é¡µçä½¿ç¨æ¯å¯éçã

### <a name="return-value"></a>è¿åå¼

å¦æç±» ID å·²å¨è¿åéé¶*lpclsid*; å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

éåæ­¤å½æ°å¯æä¾ä¸ç§æ¹æ³æ¥è°ç¨ä»å®¹å¨çå±æ§æµè§å¨æ§ä»¶çå±æ§é¡µã

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

å®¹å¨å·²æ£æµå° OLE æ§ä»¶çå©è®°é®å·²æä¸æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>åæ°

*pMsg*<br/>
ä¸ä¸ªæéï¼æåç±å©è®°é®æé®æä½çæç Windows æ¶æ¯ã

##  <a name="onproperties"></a>  COleControl::OnProperties

å½å·²ç±å®¹å¨è°ç¨æ§ä»¶çå±æ§è°è¯æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpMsg*<br/>
æåè°ç¨æ­¤è°è¯ç Windows æ¶æ¯çæéã

*hWndParent*<br/>
æ§ä»¶çç¶çªå£çå¥æã

*lpRect*<br/>
æåç±å®¹å¨ä¸­æ§ä»¶çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°æ¾ç¤ºä¸ä¸ªæ¨¡å¼å±æ§å¯¹è¯æ¡ã

æ­¤å¤å¯ä»¥ä½¿ç¨æ­¤å½æ°ä¼å¯¼è´æ§ä»¶çå±æ§é¡µçæ¾ç¤ºã è°ç¨`OnProperties`å½æ°ï¼ä¼ éä¸­çæ§ä»¶çç¶çº§çå¥æ*hWndParent*åæ°ã å¨æ¬ç¤ºä¾ä¸­çå¼*lpMsg*å¹¶*lpRect*åæ°å°è¢«å¿½ç¥ã

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

å¨ååºå®¹å¨çæ¡æ¶è°ç¨`IViewObjectEx::QueryHitPoint`è¯·æ±ã

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æå®å¦ä½è¡¨ç¤ºçå¯¹è±¡ã ææçå¼åèªæä¸¾[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)æ DVASPECT2ã

*pRectBounds*<br/>
æå`RECT`ç»æï¼å®æå® OLE æ§ä»¶å®¢æ·ç«¯åºåçè¾¹æ¡ã

*ptlLoc*<br/>
æå`POINT`ç»æï¼å®æå®è¦æ£æ¥çä¸æ¬¡ç¹å»çç¹ã OLE å®¢æ·ç«¯åºååæ ä¸­æå®ç¹ã

*lCloseHint*<br/>
å®ä¹"å³é­"å°ç¹æ£æ¥å½ä¸­çè·ç¦»ã

*pHitResult*<br/>
æåå½ä¸­æ¥è¯¢çç»æã ä»¥ä¸å¼ä¹ä¸ï¼

- HITRESULT_OUTSIDE *ptlLoc*æ¯å¤é¨ OLE å¯¹è±¡ï¼å¹¶ä¸ä¼å³é­ã

- HITRESULT_TRANSPARENT *ptlLoc*ç OLE å¯¹è±¡ï¼ä½ä¸æ¯æ¥è¿å¾åçè¾¹çåã ä¾å¦ï¼ä¸­é´éæåç¹å¯è½æ¯ HITRESULT_TRANSPARENTã

- HITRESULT_CLOSE *ptlLoc*æ¯åé¨æå¤é¨ç OLE å¯¹è±¡ä½è¿ä¸å¤æ¥è¿è¦è¢«è§ä¸ºåé¨çå¯¹è±¡ã å°åã ç²¾ç®ï¼æè¯¦ç»å¯¹è±¡å¯ä»¥ä½¿ç¨æ­¤å¼ã å³ä½¿ç¹ä½äºå¤é¨çè¾¹çç©å½¢å¯¹è±¡å¯è½ä»ç¶ä¼å³é­ ï¼è¿æéè¾¾å°çå°åå¯¹è±¡ï¼ã

- HITRESULT_HIT *ptlLoc*åå¯¹è±¡çå¾åã

### <a name="return-value"></a>è¿åå¼

éé¶ï¼å¦ææåå°è¿åå½ä¸­çç»æ;å¦åä¸º 0ã å½ä¸­æ°æ¯ä¸ OLE æ§ä»¶æ¾ç¤ºåºåéå ã

### <a name="remarks"></a>å¤æ³¨

æ¥è¯¢å¯¹è±¡çæ¾ç¤ºç©å½¢æ¯å¦ä¸ç»å®çç¹éå  ï¼è¾¾å°è¯¥ç¹ï¼ã `QueryHitPoint` å¯ä»¥éåä»¥æµè¯éç©å½¢å¯¹è±¡çå½ä¸­æ°ã

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

å¨ååºå®¹å¨çæ¡æ¶è°ç¨`IViewObjectEx::QueryHitRect`è¯·æ±ã

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æå®è¦å¦ä½è¡¨ç¤ºè¯¥å¯¹è±¡ã ææçå¼åèªæä¸¾[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)æ DVASPECT2ã

*pRectBounds*<br/>
æå`RECT`ç»æï¼å®æå® OLE æ§ä»¶å®¢æ·ç«¯åºåçè¾¹æ¡ã

*prcLoc*<br/>
æå`RECT`ç»æï¼å®æå®è¦æ£æ¥çå½ä¸­ ï¼ä¸å¯¹è±¡ç©å½¢çéå ï¼ï¼ç¸å¯¹äºå¯¹è±¡çå·¦ä¸è§çç©å½¢ã

*lCloseHint*<br/>
æªä½¿ç¨ã

*pHitResult*<br/>
æåå½ä¸­æ¥è¯¢çç»æã ä»¥ä¸å¼ä¹ä¸ï¼

- HITRESULT_OUTSIDE OLE å¯¹è±¡è¢«å½ä¸­çç©å½¢ä¸­çä»»ä½ç¹ã

- HITRESULT_HIT çç©å½¢ä¸­çè³å°ä¸ä¸ªç¹æ¯å¨å¯¹è±¡ä¸çå½ä¸­ã

### <a name="return-value"></a>è¿åå¼

éé¶ï¼å¦ææåå°è¿åå½ä¸­çç»æ;å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æ¥è¯¢å¯¹è±¡çæ¾ç¤ºç©å½¢æ¯å¦ä¸ç»å®ç©å½¢ä¸­çä»»æç¹ ï¼è¾¾å°è¯¥ç©å½¢ï¼ éå ã `QueryHitRect` å¯ä»¥éåä»¥æµè¯éç©å½¢å¯¹è±¡çå½ä¸­æ°ã

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)ç»æï¼å®æå®ä¸ºè¯·æ±ä¿¡æ¯çæ ¼å¼ã

*lpStgMedium*<br/>
æå[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) ï¼æ°æ®å°è¿åçç»æã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨æ§ä»¶å¯¹è±¡ä¸­æ¾ç½®[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)æ[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)æåå½æ°è¢«å»¶è¿åç°çã æ­¤å½æ°çé»è®¤å®ç°è°ç¨`OnRenderFileData`æ`OnRenderGlobalData`åå«ï¼å¦ææä¾çå­å¨ä»è´¨æ¯æä»¶æåå­ã å¦æè¯·æ±çæ ¼å¼ï¼CF_METAFILEPICT ææä¹å±æ§è®¾ç½®æ ¼å¼çé»è®¤å®ç°å°åç°ç¸åºçæ°æ®ï¼å¹¶è¿åéé¶å¼ã å¦åä¸ºå®å°è¿å 0ï¼å¹¶ä¸ä¸æ§è¡ä»»ä½æä½ã

å¦æ*lpStgMedium-> tymed*æ¯ TYMED_NULLï¼åºåéå¹¶ç±æå®å¡«å STGMEDIUM *lpFormatEtc-> tymed*ã å¦æä¸åºå¨å·ææ°æ®çä½ç½®å¡«å TYMED_NULLã STGMEDIUMã

éåæ­¤å½æ°å¯æä¾è¯·æ±çæ ¼å¼åä»è´¨ä¸­çæ°æ®ã å·ä½åå³äºä½ çæ°æ®ï¼ä½ å¯è½æ³è¦æ¹ä¸ºéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æä½ çæ°æ®è¾å°ä¸å¤§å°åºå®ï¼éå`OnRenderGlobalData`ã å¦ææ°æ®æ¯å¨æä»¶ä¸­ï¼æèæ¯å¤§å°å¯åçéå`OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé`FORMATETC`å`STGMEDIUM`Windows SDK ä¸­çç»æã

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®çå­å¨ä»è´¨æ¯æä»¶æ¶ã

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)ç»æï¼å®æå®ä¸ºè¯·æ±ä¿¡æ¯çæ ¼å¼ã

*pFile*<br/>
æå[CFile](../../mfc/reference/cfile-class.md) ï¼æ°æ®å°åç°çå¯¹è±¡ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨æ§ä»¶å¯¹è±¡ä¸­æ¾ç½®[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)å»¶è¿åç°çæåå½æ°ã æ­¤å½æ°çé»è®¤å®ç°åªæ¯è¿å FALSEã

éåæ­¤å½æ°å¯æä¾è¯·æ±çæ ¼å¼åä»è´¨ä¸­çæ°æ®ã å·ä½åå³äºä½ çæ°æ®ï¼ä½ å¯è½æ³è¦æ¹ä¸ºéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æä½ æ³è¦å¤çå¤ä¸ªå­å¨åªä»ï¼éå`OnRenderData`ã å¦ææ°æ®æ¯å¨æä»¶ä¸­ï¼æèæ¯å¤§å°å¯åçéå`OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé`FORMATETC`Windows SDK ä¸­çç»æã

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®æ¶æå®çå­å¨ä»è´¨æ¯å¨å±åå­ã

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)ç»æï¼å®æå®ä¸ºè¯·æ±ä¿¡æ¯çæ ¼å¼ã

*phGlobal*<br/>
æåå¨å±åå­ï¼æ°æ®å°è¿åçå¥æã å¦æå·²ä¸åéä»»ä½åå­ï¼åæ­¤åæ°å¯ä»¥ä¸º NULLã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨æ§ä»¶å¯¹è±¡ä¸­æ¾ç½®[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)å»¶è¿åç°çæåå½æ°ã æ­¤å½æ°çé»è®¤å®ç°åªæ¯è¿å FALSEã

å¦æ*phGlobal*ä¸º NULLï¼ååºåéå¹¶è¿åæ° HGLOBAL *phGlobal*ã å¦åï¼HGLOBAL æå®*phGlobal*åºå¡«åæ°æ®ã å¨ HGLOBAL ä¸­æ¾ç½®çæ°æ®éä¸è½è¶è¿åå­åçå½åå¤§å°ã æ­¤å¤ï¼åä¸è½éæ°åéç»è¾å¤§çå¤§å°ã

éåæ­¤å½æ°å¯æä¾è¯·æ±çæ ¼å¼åä»è´¨ä¸­çæ°æ®ã å·ä½åå³äºä½ çæ°æ®ï¼ä½ å¯è½æ³è¦æ¹ä¸ºéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æä½ æ³è¦å¤çå¤ä¸ªå­å¨åªä»ï¼éå`OnRenderData`ã å¦ææ°æ®æ¯å¨æä»¶ä¸­ï¼æèæ¯å¤§å°å¯åçéå`OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé`FORMATETC`Windows SDK ä¸­çç»æã

##  <a name="onresetstate"></a>  COleControl::OnResetState

å½æ§ä»¶çå±æ§åºè®¾ç½®ä¸ºå¶é»è®¤å¼æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnResetState();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨[DoPropExchange](#dopropexchange)ï¼å¹¶ä¼ é`CPropExchange`å¯¼è´è¦ä¸ºå¶é»è®¤å¼è®¾ç½®çå±æ§çå¯¹è±¡ã

æ§å¶ç¼åå¨å¯ä»¥å¨æ­¤æå¥ OLE æ§ä»¶çåå§åä»£ç å¯éåã å½è°ç¨æ­¤å½æ°[IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load)æ[ipersiststorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)åçæéï¼æ[IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)æ[IPersistStorage:ï¼ ä¸¢å¤±](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew)è°ç¨ï¼èä¸ä¼ç¬¬ä¸ä¸ªè°ç¨ä»»ä¸`IPersistStream::Load`æ`IPersistStorage::Load`ã

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

å½å®¹å¨å·²è°ç¨è¯¥æ§ä»¶æ¶ç±æ¡æ¶è°ç¨`IOleControl::SetClientSite`å½æ°ã

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸`OnSetClientSite`æ£æ¥æ¯å¦å è½½æ°æ®è·¯å¾å±æ§ï¼å¹¶ä¸å¦æå®ä»¬æ¯è°ç¨`DoDataPathPropExchange`ã

éåæ­¤å½æ°å¯æ§è¡æ­¤éç¥çä»»ä½ç¹æ®å¤çã å·ä½èè¨ï¼æ­¤å½æ°çéååºè°ç¨çåºç±»ã

##  <a name="onsetdata"></a>  COleControl::OnSetData

ç±æ¡æ¶è°ç¨ä»¥æ§ä»¶çæ°æ®æ¿æ¢ä¸ºæå®çæ°æ®ã

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)ç»æï¼å®æå®æ°æ®çæ ¼å¼ã

*lpStgMedium*<br/>
æå[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium)æå¨æ°æ®ç»æã

*bRelease*<br/>
å¦ææ§ä»¶åºéæ¾å­å¨ä»è´¨ä¸­; åä¸º TRUEå¦ææ§ä»¶ä¸åºéæ¾å­å¨ä»è´¨ï¼åä¸º FALSEã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ°æ®çæä¹æ§å±æ§ä¸­è®¾ç½®æ ¼å¼çé»è®¤å®ç°å°è¿è¡ç¸åºä¿®æ¹æ§ä»¶çç¶æã å¦åï¼é»è®¤å®ç°æ²¡æä»»ä½å½±åã å¦æ*bRelease*ä¸º TRUEï¼åè°ç¨`ReleaseStgMedium`è¿è¡; å¦åä¸º notã

éåæ­¤å½æ°ä½¿ç¨æå®çæ°æ®æ¿æ¢æ§ä»¶çæ°æ®ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé`FORMATETC`å`STGMEDIUM`Windows SDK ä¸­çç»æã

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

å½æ§ä»¶çå¤§å°æ¶éè¦å è°ç¨èæ´æ¹æ¶ç±æ¡æ¶è°ç¨[IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent)ã

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>åæ°

*lpSizeL*<br/>
ä¸ä¸ªæå`SIZEL`ä½¿ç¨é¿æ´æ°æ¥è¡¨ç¤ºçå®½åº¦åé«åº¦çæ§å¶ï¼ä»¥ HIMETRIC ä¸ºåä½è¡¨ç¤ºçç»æã

### <a name="return-value"></a>è¿åå¼

å¦æå·²æ¥åçå¤§å°æ´æ¹; éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å¯å¤ççæ§ä»¶çå¤§å°æ¶éè®¾å¤§å°ã å¦ææ§ä»¶æ¯å¤äºå°±å°æ´»å¨ç¶æï¼è°ç¨å®¹å¨ç`OnPosRectChanged`åè¿è¡ã

éåæ­¤å½æ°å¯æ´æ¹æ¨çæ§ä»¶çé»è®¤å¤§å°è°æ´ã

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

ç±æ¡æ¶è°ç¨ä»¥å®ç°è°ç¨[IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)ã

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>åæ°

*lpRectPos*<br/>
ä¸ä¸ªæå`RECT`ç»æï¼æç¤ºæ§ä»¶çæ°ä½ç½®åç¸å¯¹äºå®¹å¨çå¤§å°ã

*lpRectClip*<br/>
ä¸ä¸ªæå`RECT`ç»æï¼æç¤ºè¯¥æ§ä»¶æ¯è¦åªè£çç©å½¢åºåã

### <a name="return-value"></a>è¿åå¼

å¦ææ¥åéæ°å®ä½ï¼;ï¼éé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°èªå¨å¤ççéæ°å®ä½åè°æ´å¤§å°çæ§å¶çªå£ï¼å¹¶è¿å TRUEã

éåæ­¤å½æ°å¯æ´æ¹æ­¤å½æ°çé»è®¤è¡ä¸ºã

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

å½æ§ä»¶å·²æ¿æ´»ç UI æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

è¡ç¥¨çæ é¢æææ¬å±æ§å¼åçæ´æ¹æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å°è°ç¨`InvalidateControl`ã

å¦æå¸æå¨æ­¤å±æ§æ´æ¹åçéç¥ï¼éåæ­¤å½æ°ã

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

å¨ååºå®¹å¨çæ¡æ¶è°ç¨`IOleInPlaceObjectWindowless::OnWindowMessage`è¯·æ±ã

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>åæ°

*æ¶æ¯*<br/>
æä¼ éç Windows æ¶æ¯æ è¯ç¬¦ã

*wParam*<br/>
æä¼ éç Windowsã æå®å¶ä»ç¹å®äºæ¶æ¯çä¿¡æ¯ã æ­¤åæ°çåå®¹åå³äºçå¼*msg*åæ°ã

*lParam*<br/>
æä¼ éç Windowsã æå®å¶ä»ç¹å®äºæ¶æ¯çä¿¡æ¯ã æ­¤åæ°çåå®¹åå³äºçå¼*msg*åæ°ã

*plResult*<br/>
Windows ç»æä»£ç ã æå®çæ¶æ¯å¤çç»æï¼å¹¶åå³äºåéçæ¶æ¯ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¤çæ çªå£æ§ä»¶ççªå£æ¶æ¯ã `COleControl``OnWindowlessMessage`åºè¯¥ç¨äºé¼ æ æ¶æ¯åé®çæ¶æ¯ä»¥å¤ççªå£æ¶æ¯ã `COleControl` æä¾äº[SetCapture](#setcapture)å¹¶[SetFocus](#setfocus)ä¸é¨ç¨äºè·åé¼ æ æè·åé®çç¦ç¹çæ çªå£ç OLE å¯¹è±¡ã

æ çªå£å¯¹è±¡ä¸å·æä¸ä¸ªçªå£ï¼å ä¸ºå®ä»¬éè¦ä¸ç§æºå¶ï¼ä»¥ä¾¿åéå°å®ä»¬çå®¹å¨è°åº¦æ¶æ¯ã æ çªå£ç OLE å¯¹è±¡ä»å¶å®¹å¨ä¸­è·åæ¶æ¯éè¿`OnWindowMessage`æ¹æ³`IOleInPlaceObjectWindowless`æ¥å£ (çæ©å±[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)æ çªå£æ¯æ)ã `OnWindowMessage` ä¸éç¨`HWND`åæ°ã

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

å°è½¬æ¢çåæ *pPoint*æå·¥ä½åºåæ ã

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
æå OLE æ§ä»¶å¨å®¹å¨åçè¾¹çã ä¸æ¯å·¥ä½åºï¼ä½æ´ä¸ªæ§ä»¶åæ¬è¾¹æ¡åæ»å¨æ¡çåºåã

*pPoint*<br/>
æåç¶ ï¼å®¹å¨ï¼ çç¹è½¬æ¢ä¸ºæ§ä»¶çå®¢æ·ç«¯åºåçåæ ã

*bHitTest*<br/>
æå®å½ä¸­æµè¯ï¼ä»¥å¨ç¹ä¸å®æã

### <a name="return-value"></a>è¿åå¼

å¦æ*bHitTest*ä¸º FALSEï¼åè¿å HTNOWHEREã å¦æ*bHitTest*ä¸º TRUEï¼è¿åç¶ ï¼å®¹å¨ï¼ ä¸­çç¹çä½ç½®ç»å½å° OLE æ§ä»¶çå®¢æ·ç«¯åºåï¼å½ä¸­æµè¯çå¼æ¯ä»¥ä¸é¼ æ ä¹ä¸ï¼

- HTBORDER ä¸å·æå¤§å°è°æ´è¾¹æ¡ççªå£è¾¹æ¡ä¸­ã

- HTBOTTOM è¾ä½æ°´å¹³è¾¹æ¡ççªå£ä¸­ã

- HTBOTTOMLEFT å¨å·¦ä¸è§ççªå£è¾¹æ¡ã

- HTBOTTOMRIGHT çªå£çè¾¹æ¡å³ä¸è§ä¸­ã

- HTCAPTION æ é¢æ åºåä¸­ã

- HTCLIENT ä¸­çå·¥ä½åºä¸­ã

- HTERROR å±å¹èæ¯ä¸æå¨ windows ä¹é´çåéçº¿ (HTNOWHERE ç¸ååªä¸è¿`DefWndProc`Windows å½æ°çæç³»ç»æç¤ºé³è¡¨ç¤ºåºç°éè¯¯)ã

- HTGROWBOX å¤§å°æ¡ä¸­ã

- HTHSCROLL æ°´å¹³æ»å¨æ¡ä¸­ã

- HTLEFT ä¸­çªå£çå·¦è¾¹æ¡ã

- HTMAXBUTTON ä¸­æå¤§åæé®ã

- HTMENU èååºåä¸­ã

- HTMINBUTTON ä¸­æå°åæé®ã

- å¨å±å¹èæ¯ HTNOWHERE ä¸æå¨ windows ä¹é´çåéçº¿ã

- HTREDUCE ä¸­æå°åæé®ã

- HTRIGHT å³è¾¹æ¡ççªå£ä¸­ã

- HTSIZE å¤§å°æ¡ ï¼ä¸ HTGROWBOX ç¸åï¼ ä¸­ã

- HTSYSMENU ä¸­æ§ä»¶èåæå³é­æé®ä¸­çå­çªå£ä¸­ã

- HTTOP ä¸é¨æ°´å¹³è¾¹æ¡ççªå£ä¸­ã

- HTTOPLEFT çªå£è¾¹æ¡çå·¦ä¸è§ä¸­ã

- HTTOPRIGHT çªå£è¾¹æ¡çå³ä¸è§ä¸­ã

- HTTRANSPARENT å½ååå¦ä¸ä¸ªçªå£ççªå£ä¸­ã

- HTVSCROLL åç´æ»å¨æ¡ä¸­ã

- HTZOOM ä¸­æå¤§åæé®ã

### <a name="remarks"></a>å¤æ³¨

å¨è¾å¥*pPoint*æ¯ç¸å¯¹äºç¶çº§ ï¼å·¦ä¸è§çå®¹å¨ï¼ çæºã å¨è¾åº*pPoint*æ¯ç¸å¯¹äº OLE æ§ä»¶ ï¼å·¦ä¸è§çæ§ä»¶çå®¢æ·ç«¯åºåï¼ çå®¢æ·ç«¯åºåçåç¹ã

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

éç¥å®¹å¨æ¨¡å¼å¯¹è¯æ¡å·²å³é­ã

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>åæ°

*hWndParent*<br/>
æ¨¡å¼å¯¹è¯æ¡çç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

å¨æ¾ç¤ºä»»ä½æ¨¡å¼å¯¹è¯æ¡ä¹åè°ç¨æ­¤å½æ°ã æ¨å¿é¡»è°ç¨æ­¤å½æ°ï¼ä»¥ä¾¿å®¹å¨å¯ä»¥å¯ç¨ç¦ç¨çä»»ä½é¡¶çº§çªå£`PreModalDialog`ã æ­¤å½æ°åºéè¿è°ç¨éå¯¹`PreModalDialog`ã

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

éç¥å³å°æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡ä¸­çå®¹å¨ã

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>åæ°

*hWndParent*<br/>
æ¨¡å¼å¯¹è¯æ¡çç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

æ¾ç¤ºä»»ä½æ¨¡å¼å¯¹è¯æ¡ä¹åè°ç¨æ­¤å½æ°ã æ¨å¿é¡»è°ç¨æ­¤å½æ°ï¼ä»¥ä¾¿å®¹å¨å¯ä»¥ç¦ç¨ææé¡¶çº§çªå£ã æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡åï¼å¿é¡»è°ç¨`PostModalDialog`ã

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

éæ¯å¹¶éæ°åå»ºæ§ä»¶ççªå£ã

```
void RecreateControlWindow();
```

### <a name="remarks"></a>å¤æ³¨

è¿å¯è½æå¿è¦ï¼å¦æéè¦æ´æ¹çªå£çæ ·å¼ä½ã

##  <a name="refresh"></a>  COleControl::Refresh

å¼ºå¶éæ°ç»å¶ç OLE æ§ä»¶ã

```
void Refresh();
```

### <a name="remarks"></a>å¤æ³¨

æ¯ææ­¤å½æ°`COleControl`åºç±»ä½ä¸ºä¸ä¸ªåä¸ºå·æ°çå¸¸ç¨æ¹æ³ã è¿åè®¸ OLE æ§ä»¶çç¨æ·å¨ç¹å®çæ¶é´éæ°ç»å¶æ§ä»¶ã æ­¤æ¹æ³çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ æ¹æ³](../../mfc/mfc-activex-controls-methods.md)ã

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

éæ¾é¼ æ æè·ã

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦æè¯¥æ§ä»¶å½åå·æé¼ æ æè·ï¼éæ¾è¯¥æè·ã å¦åï¼æ­¤å½æ°ä¸èµ·ä½ç¨ã

##  <a name="releasedc"></a>  COleControl::ReleaseDC

éæ¾ç±å¶ä»åºç¨ç¨åºéæ¾ä½¿ç¨çè®¾å¤ä¸ä¸æçæ çªå£æ§ä»¶çå®¹å¨çæ¾ç¤ºè®¾å¤ä¸ä¸æã

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æ è¯è¦éæ¾çå®¹å¨è®¾å¤ä¸ä¸æã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

åºç¨ç¨åºå¿é¡»è°ç¨`ReleaseDC`æ¯æ¬¡è°ç¨[GetDC](#getdc)ã

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

è®¾ç½®æ§ä»¶çç¶çº§ã

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>åæ°

*hWndOuter*<br/>
æ§å¶çªå£çå¥æã

*hWndParent*<br/>
æ°çç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯éç½®æ§ä»¶çªå£çç¶çº§ã

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

åå§åçç¶æ`COleControl`å¸¸ç¨å±æ§ä¸ºå¶é»è®¤å¼ã

```
void ResetStockProps();
```

### <a name="remarks"></a>å¤æ³¨

å±æ§æ¯ï¼ å¤è§ã èæ¯è²ã è¾¹æ¡æ ·å¼ã æ é¢ã å·²å¯ç¨ã å­ä½ã åæ¯è²ã hWnd åææ¬ã å¸¸ç¨å±æ§çè¯´æï¼è¯·åé[ActiveX æ§ä»¶ï¼ æ·»å å¸¸ç¨å±æ§](../../mfc/mfc-activex-controls-adding-stock-properties.md)ã

å¯ä»¥éè¿ä½¿ç¨æé«æ§ä»¶çäºè¿å¶åå§åæ§è½`ResetStockProps`å¹¶`ResetVersion`éå`COleControl::OnResetState`ã è¯·åè§ä¸é¢çç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

åå§åä¸ºæå®çå¼ççæ¬å·ã

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>åæ°

*dwVersionDefault*<br/>
è¦åéç»æ§ä»¶ççæ¬å·ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥éè¿ä½¿ç¨æé«æ§ä»¶çäºè¿å¶åå§åæ§è½`ResetVersion`å¹¶`ResetStockProps`éå`COleControl::OnResetState`ã å¨ç¤ºä¾ï¼è¯·åé[ResetStockProps](#resetstockprops)ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

åè®¸æ çªå£ç OLE å¯¹è±¡æ»å¨å±å¹ä¸å¶å°±å°æ´»å¨å¾ååçæä¸ªåºåã

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>åæ°

*xAmount*<br/>
æå®éï¼ä»¥è®¾å¤ä¸ºåä½ï¼æ°´å¹³æ»å¨ã æ­¤åæ°å¿é¡»ä¸ºè´å¼å¯åå·¦æ»å¨ã

*yAmount*<br/>
æå®éï¼ä»¥è®¾å¤ä¸ºåä½çåç´æ»å¨ã æ­¤åæ°å¿é¡»æ¯è´å¼å°åä¸æ»å¨ã

*lpRect*<br/>
æå[CRect](../../atl-mfc-shared/reference/crect-class.md)å¯¹è±¡æ RECT ç»æï¼å®åå«çªå£çå·¥ä½åºåæ ä¸­æå®è¦åä¸æ»å¨ï¼OLE å¯¹è±¡çå®¢æ·ç«¯åºåçé¨åã å¦æ*lpRect*ä¸º NULLï¼æ»å¨æ´ä¸ª OLE å¯¹è±¡çå®¢æ·ç«¯åºåã

*lpClipRect*<br/>
æå`CRect`å¯¹è±¡æ`RECT`ç»æï¼å®æå®å°ååªè¾ç©å½¢ã åªæå¨ç©å½¢åçåç´ çæ»å¨éã ç©å½¢å¤ç bits ä¸ä¼åå°å½±åï¼å³ä½¿å®ä»¬ä½äº*lpRect*ç©å½¢ã å¦æ*lpClipRect*ä¸º NULLï¼ä¸å­å¨ä¿®åªæ§è¡æ»å¨ç©å½¢ä¸ã

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

éæ©å°è®¾å¤ä¸ä¸æçå­ä½ã

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æåè®¾å¤ä¸ä¸æå¯¹è±¡çæéã

*fontHolder*<br/>
å¼ç¨[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡ï¼è¡¨ç¤ºè¦éæ©çå­ä½ã

### <a name="return-value"></a>è¿åå¼

ä¸ä¸ªæåä»¥åéæ©çå­ä½ã è°ç¨æ¹ä½æ¶å®æï¼ä½¿ç¨ææç»å¶æä½*fontHolderï¼* å®åºéæ°ä»¥åéæ©çå­ä½éæ©ä½ä¸ºåæ°è¿è¡ä¼ é[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)ã

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

éæ©å°è®¾å¤ä¸ä¸æçå¸¸ç¨å­ä½å±æ§ã

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
å°å¨å¶ä¸­éæ©å­ä½çè®¾å¤ä¸ä¸æã

### <a name="return-value"></a>è¿åå¼

æåä¹åéæ©ç`CFont`å¯¹è±¡ã åºä½¿ç¨[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)å®æåæ¢å¤å°çè®¾å¤ä¸ä¸æéæ©æ­¤å­ä½ã

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

åºååæåå§ååéç»æ§ä»¶çæ¾ç¤ºç©ºé´çç¶æã

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>åæ°

*ar*<br/>
ä¸ä¸ª`CArchive`è¦é¢åææºèªåºååå¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥éè¿ä½¿ç¨æé«æ§ä»¶çäºè¿å¶æçæ§è½`SerializeExtent`ï¼ `SerializeStockProps`ï¼å¹¶`SerializeVersion`éå`COleControl::Serialize`ã è¯·åè§ä¸é¢çç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

åºååæåå§åçç¶æ`COleControl`å¸¸ç¨å±æ§ï¼ å¤è§ã èæ¯è²ã è¾¹æ¡æ ·å¼ã æ é¢ã å·²å¯ç¨ã å­ä½ã åæ¯è²åææ¬ã

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>åæ°

*ar*<br/>
ä¸ä¸ª`CArchive`è¦é¢åææºèªåºååå¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¸¸ç¨å±æ§çè¯´æï¼è¯·åé[ActiveX æ§ä»¶ï¼ æ·»å å¸¸ç¨å±æ§](../../mfc/mfc-activex-controls-adding-stock-properties.md)ã

å¯ä»¥éè¿ä½¿ç¨æé«æ§ä»¶çäºè¿å¶æçæ§è½`SerializeStockProps`ï¼ `SerializeExtent`ï¼å¹¶`SerializeVersion`éå`COleControl::Serialize`ã æå³ç¤ºä¾ï¼è¯·åéå¤çä»£ç [SerializeExtent](#serializeextent)ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯çç¶æã

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>åæ°

*ar*<br/>
ä¸ä¸ª`CArchive`è¦é¢åææºèªåºååå¯¹è±¡ã

*dwVersionDefault*<br/>
æ§ä»¶çå½åçæ¬å·ã

*bConvert*<br/>
æç¤ºæ°¸ä¹æ§æ°æ®æ¯å¦åºä¸ºææ°æ ¼å¼ä¿å­ï¼æå¨ç¸åçæ ¼å¼ä¸­ç»´æ¤æ¶å è½½å®æ¶è½¬æ¢ã

### <a name="return-value"></a>è¿åå¼

æ§ä»¶ççæ¬å·ã å¦æå è½½æå®çå­æ¡£ï¼`SerializeVersion`è¿åè¯¥å­æ¡£ä¸­å è½½ççæ¬ã å¦åï¼å®è¿åå½åå è½½ççæ¬ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥éè¿ä½¿ç¨æé«æ§ä»¶çäºè¿å¶æçæ§è½`SerializeVersion`ï¼ `SerializeExtent`ï¼å¹¶`SerializeStockProps`éå`COleControl::Serialize`ã æå³ç¤ºä¾ï¼è¯·åéå¤çä»£ç [SerializeExtent](#serializeextent)ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

##  <a name="setappearance"></a>  COleControl::SetAppearance

è®¾ç½®æ§ä»¶çè¡ç¥¨çå¤è§å±æ§å¼ã

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>åæ°

*sAppearance*<br/>
ä¸ä¸ª**ç­**è¦ä½¿ç¨çæ§ä»¶çå¤è§ (VT_I2) å¼ã å¼ä¸ºé¶è®¾ç½®æ§ä»¶çå¤è§ä¸ºå¹³é¢å 1 çå¼è®¾ç½®ä¸ºä¸ç»´æ§ä»¶çå¤è§ã

### <a name="remarks"></a>å¤æ³¨

æå³å¸¸ç¨å±æ§çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

è®¾ç½®æ§ä»¶çè¡ç¥¨ç BackColor å±æ§å¼ã

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>åæ°

*dwBackColor*<br/>
è¦ç¨äºç»å¶æ§ä»¶çèæ¯ OLE_COLOR å¼ã

### <a name="remarks"></a>å¤æ³¨

æå³è¯¦ç»ä¿¡æ¯ä½¿ç¨æ­¤å±æ§åå¶ä»ç¸å³å±æ§ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

è®¾ç½®æ§ä»¶çè¡ç¥¨ BorderStyle å±æ§å¼ã

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>åæ°

*sBorderStyle*<br/>
æ§ä»¶; çæ°è¾¹æ¡æ ·å¼0 è¡¨ç¤ºæ²¡æè¾¹æ¡ï¼1 è¡¨ç¤ºæ­£å¸¸çè¾¹æ¡ã

### <a name="remarks"></a>å¤æ³¨

æ§å¶çªå£å°éæ°åå»ºå`OnBorderStyleChanged`è°ç¨ã

##  <a name="setcapture"></a>  COleControl::SetCapture

ä½¿æ§ä»¶çå®¹å¨çªå£æ§ä»¶çä»£è¡¨éè¦æ¥æé¼ æ æè·ã

```
CWnd* SetCapture();
```

### <a name="return-value"></a>è¿åå¼

ä¸ä¸ªæå`CWnd`ä»¥åæ¥æ¶å°é¼ æ è¾å¥ççªå£å¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¦æè¯¥æ§ä»¶å·²æ¿æ´»å¹¶æ çªå£ï¼æ­¤å½æ°ä¼å¯¼è´æ§ä»¶çå®¹å¨çªå£ï¼æè½æ¥æé¼ æ æè·ï¼æ§ä»¶çä»£è¡¨ã å¦åï¼æ­¤å½æ°æ¶ï¼æ§ä»¶ä¼æ¬èº«æè½æ¥æé¼ æ æè· (ä¸ç¸å`CWnd::SetCapture`)ã

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

è®¾ç½® OLE æ§ä»¶çªå£çå¤§å°ï¼å¹¶éç¥æ´æ¹æ§ä»¶ç«ç¹çå®¹å¨ã

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>åæ°

*cx*<br/>
ä»¥åç´ ä¸ºåä½æå®æ§ä»¶çæ°å®½åº¦ã

*cy*<br/>
ä»¥åç´ ä¸ºåä½æå®æ§ä»¶çæ°é«åº¦ã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°ä¸åºå¨æ§ä»¶çæé å½æ°ä¸­ä½¿ç¨ã

è¯·æ³¨æï¼ç¨äºæ§å¶ windows çææåæ é½é½ç¸å¯¹äºæ§ä»¶çå·¦ä¸è§ã

##  <a name="setenabled"></a>  COleControl::SetEnabled

è®¾ç½®å¸¸ç¨æ§ä»¶ç Enabled å±æ§å¼ã

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>åæ°

*bEnabled*<br/>
å¦ææ§ä»¶å°å¯ç¨ï¼åä¸º TRUEå¦åä¸º FALSEã

### <a name="remarks"></a>å¤æ³¨

è®¾ç½®æ­¤å±æ§å`OnEnabledChange`è°ç¨ã

##  <a name="setfocus"></a>  COleControl::SetFocus

ä½¿æ§ä»¶çå®¹å¨çªå£æ§ä»¶çä»£è¡¨éè¦æ¥æè¾å¥ç¦ç¹ã

```
CWnd* SetFocus();
```

### <a name="return-value"></a>è¿åå¼

ä¸ä¸ªæå`CWnd`ä»¥åå·æè¾å¥ç¦ç¹ï¼åä¸º NULLï¼å¦ææ²¡ææ­¤ç±»çªå£ççªå£å¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¦æè¯¥æ§ä»¶å·²æ¿æ´»å¹¶æ çªå£ï¼æ­¤å½æ°ä¼å¯¼è´è¯¥æ§ä»¶çå®¹å¨çªå£ï¼æè½æ¥æè¾å¥ç¦ç¹çæ§ä»¶çä»£è¡¨ã è¾å¥çç¦ç¹å°å®åå°å®¹å¨ççªå£çé®çè¾å¥ï¼å¹¶å¨å®¹å¨å°è°åº¦å°è°ç¨è¯¥ OLE å¯¹è±¡çææåç»­çé®çæ¶æ¯`SetFocus`ã ä»»ä½ä»¥åå·æè¾å¥çç¦ç¹ççªå£å¤±å»å®ã

å¦ææ§ä»¶ä¸æ¯æ çªå£ï¼æ­¤å½æ°æ¶ï¼æ§ä»¶ä¼æ¬èº«æè½æ¥æè¾å¥ç¦ç¹ (ä¸ç¸å`CWnd::SetFocus`)ã

##  <a name="setfont"></a>  COleControl::SetFont

è®¾ç½®æ§ä»¶çå¸¸ç¨å­ä½å±æ§ã

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>åæ°

*pFontDisp*<br/>
æåå­ä½è°åº¦æ¥å£çæéã

##  <a name="setforecolor"></a>  COleControl::SetForeColor

è®¾ç½®æ§ä»¶çè¡ç¥¨ ForeColor å±æ§å¼ã

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>åæ°

*dwForeColor*<br/>
è¦ç¨äºç»å¶æ§ä»¶çåæ¯è² OLE_COLOR å¼ã

### <a name="remarks"></a>å¤æ³¨

æå³è¯¦ç»ä¿¡æ¯ä½¿ç¨æ­¤å±æ§åå¶ä»ç¸å³å±æ§ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

ç±æ¡æ¶è°ç¨ä»¥åå§åæ§ä»¶æ¯æçæ°æ®æ ¼å¼çåè¡¨ã

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æå®è¿ä¸¤ç§æ ¼å¼ï¼ CF_METAFILEPICT åæä¹æ§å±æ§ã

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

è®¾ç½® OLE æ§ä»¶å®¹å¨ä¸­é¦æ¬¡æ¾ç¤ºæ¶çå¤§å°ã

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>åæ°

*cx*<br/>
ä»¥åç´ ä¸ºåä½ç OLE æ§ä»¶åå§å®½åº¦ã

*cy*<br/>
ä»¥åç´ ä¸ºåä½ç OLE æ§ä»¶çåå§é«åº¦ã

### <a name="remarks"></a>å¤æ³¨

è¥è¦è®¾ç½®æ§ä»¶çåå§å¤§å°å¨æé å½æ°ä¸­è°ç¨æ­¤å½æ°ã ä»¥è®¾å¤åä½æåç´ ä¸ºåä½çåå§å¤§å°ã å»ºè®®å¨æ§ä»¶çæé å½æ°ä¸­è¿è¡æ­¤è°ç¨ã

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

æ´æ¹æ§ä»¶çå·²ä¿®æ¹çç¶æã

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>åæ°

*bModified*<br/>
æ§ä»¶çæ°å¼çä¿®æ¹æ å¿ã TRUE è¡¨ç¤ºå·²ä¿®æ¹æ§ä»¶çç¶æ;FALSE è¡¨ç¤ºåªéä¿å­æ§ä»¶çç¶æã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ï¼æ¯å½åççæ´æ¹ä¼å½±åæ§ä»¶çæä¹ç¶æã ä¾å¦ï¼å¦ææä¹æ§çå±æ§çå¼åçæ´æ¹ï¼è°ç¨æ­¤å½æ°å¸¦*bModified* **TRUE**ã

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

æç¤ºçç¼è¾è¯·æ±å·²å¤±è´¥ã

```
void SetNotPermitted();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°æ¶`BoundPropertyRequestEdit`å¤±è´¥ã æ­¤å½æ°å°å¼åç±»åçå¼å¸¸`COleDispScodeException`ä»¥æç¤ºä¸åè®¸è®¾ç½®æä½ã

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

é²æ­¢ä¿®æ¹ä¸ºç¨æ·æ§ä»¶çå±æ§å¼ã

```
void SetNotSupported();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°æ¥ä»£æ¿ä»»ä½å±æ§ç Set å½æ°ä¸æ¯æä¿®æ¹ç±è¯¥æ§ä»¶çç¨æ·çå±æ§å¼çã ä¸ä¸ªç¤ºä¾æ¯ä¸ä¸ªå±æ§ï¼å®åªè¯»çã

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

è®¾ç½®ç¸å¯¹äºå®¹å¨ï¼ä»¥è®¾å¤åä½è¡¨ç¤ºæ§ä»¶çç©å½¢çåæ ã

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æååå«æ°çæ§ä»¶çåæ ï¼ç¸å¯¹äºå®¹å¨çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶å¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å¤äºæå¼ç¶æï¼å®æ¯è°æ´å¤§å°;å¦åä¸ºå®¹å¨ç`OnPosRectChanged`è°ç¨å½æ°ã

##  <a name="settext"></a>  COleControl::SetText

è®¾ç½®æ§ä»¶çå¸¸ç¨æ é¢æææ¬å±æ§çå¼ã

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>åæ°

*pszText*<br/>
æåå­ç¬¦å­ç¬¦ä¸²çæéã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼å¸¸ç¨çæ é¢åææ¬å±æ§æ å°å°ç¸åçå¼ã è¿æå³çå¯¹è¿ä¸¤ä¸ªå±æ§æåçä»»ä½æ´æ¹å°èªå¨æ´æ¹è¿ä¸¤ä¸ªå±æ§ã ä¸è¬æåµä¸ï¼æ§ä»¶åºæ¯æè¡ç¥¨æ é¢æææ¬å±æ§ï¼ä½ä¸å¯åæ¶ä½¿ç¨ä¸¤èã

##  <a name="throwerror"></a>  Colecontrol:: Throwerror

ååºä¿¡å·çå¹éé¡¹å¨æ§ä»¶ä¸­çéè¯¯ã

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);


void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>åæ°

*sc*<br/>
è¦æ¥åçç¶æä»£ç å¼ã å¯è½çä»£ç çå®æ´åè¡¨ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼ é«çº§ä¸»é¢](../../mfc/mfc-activex-controls-advanced-topics.md)ã

*nDescriptionID*<br/>
å­ç¬¦ä¸²èµæº ID çå¼å¸¸æ¥åã

*nHelpID*<br/>
è¦æ¥åä¸æ¬ä¸»é¢çå¸®å© IDã

*pszDescription*<br/>
åå«è¦æ¥åçå¼å¸¸çè¯´æçå­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°åºä»ä»è°ç¨ Get æ Set å½æ°ä¸­ç¨äº OLE å±æ§æ OLE èªå¨åæ¹æ³çå®ç°ã å¦æéè¦ä»¥æç¤ºéè¯¯åçå¨å¶ä»æåµä¸ï¼åºè§¦åå¸¸ç¨çéè¯¯äºä»¶ã

##  <a name="transformcoords"></a>  COleControl::TransformCoords

è½¬æ¢åæ  HIMETRIC åä½åå®¹å¨çæ¬æºåä½ä¹é´çå¼ã

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>åæ°

*lpptlHimetric*<br/>
æå`POINTL`ç»æï¼å®åå«ä»¥ HIMETRIC ä¸ºåä½çåæ ã

*lpptfContainer*<br/>
æå`POINTF`ç»æï¼å®åå«åæ ä»¥å®¹å¨çååå¤§å°ã

*flags*<br/>
ä»¥ä¸å¼çç»åï¼

- XFORMCOORDS_POSITION ä¸ä¸ªå®¹å¨ä¸­çä½ç½®ã

- XFORMCOORDS_SIZE å®¹å¨ä¸­çå¤§å°ã

- XFORMCOORDS_HIMETRICTOCONTAINER è½¬æ¢ HIMETRIC å°å®¹å¨çåä½ä¸ºåä½ã

- XFORMCOORDS_CONTAINERTOHIMETRIC è½¬æ¢å° HIMETRIC ä¸ºåä½çå®¹å¨çåä½ã

### <a name="remarks"></a>å¤æ³¨

åä¸¤ä¸ªæ å¿ XFORMCOORDS_POSITION å XFORMCOORDS_SIZEï¼æç¤ºæ¯å¦åºä½ä¸ºä¸ä¸ªä½ç½®æå¤§å°å¤çåæ ã å©ä½çä¸¤ä¸ªæ å¿æç¤ºè½¬æ¢çæ¹åã

##  <a name="translatecolor"></a>  COleControl::TranslateColor

é¢è²å¼å°ä» OLE_COLOR æ°æ®ç±»åè½¬æ¢å°[COLORREF](/windows/desktop/gdi/colorref)æ°æ®ç±»åã

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>åæ°

*clrColor*<br/>
OLE_COLOR æ°æ®ç±»åã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor)å½æ°ã

*hpal*<br/>
å¯éçè°è²æ¿; çå¥æå¯ä»¥ä¸º NULLã

### <a name="return-value"></a>è¿åå¼

RGB ï¼çº¢è²ã ç»¿è²ã èè²ï¼ 32 ä½é¢è²å¼ï¼ç¨äºå®ä¹å®ä½çé¢è²ææ¥è¿*clrColor*è®¾å¤å¯ä»¥è¡¨ç¤ºçå¼ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°å¯ç¨äºå°è½¬æ¢ä¸º COLORREF ç±»åä½¿ç¨çå¸¸ç¨çåæ¯è²åèæ¯è²å±æ§[CDC](../../mfc/reference/cdc-class.md)æåå½æ°ã

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

ç¡®å®æ§ä»¶æ¯å¦åºä½ä¸ºé»è®¤å¼ä¸­ä½¿ç¨çç¯å¢å±æ§çå¼æ¶ä»å¶æä¹æ§ç¶æéåå è½½å®ã

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>è¿åå¼

Nonzero æç¤ºä¼ææï¼åä¸ºç¯å¢å±æ§å¦åç¯å¢å±æ§å°ä¸åææã

### <a name="remarks"></a>å¤æ³¨

å¨æäºå®¹å¨æ§ä»¶å¯è½æ²¡æå¯¹å¶ç¯å¢å±æ§çè®¿é®å¨é¦æ¬¡è°ç¨çéåæé´`COleControl::DoPropExchange`ã è¿æ¯è¿ç§æåµï¼å¦æå®¹å¨è°ç¨[IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load)æ[ipersiststorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)ä¹åè°ç¨[IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) ï¼å³ï¼å¦æä¸æ¯éµå¾ª OLEMISC_SETCLIENTSITEFIRST ç¶æä½ï¼ã

##  <a name="windowproc"></a>  COleControl::WindowProc

æä¾æå³ Windows è¿ç¨`COleControl`å¯¹è±¡ã

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>åæ°

*message*<br/>
æå®è¦å¤çç Windows æ¶æ¯ã

*wParam*<br/>
æä¾ä½¿ç¨å¨å¤çæ¶æ¯çå¶ä»ä¿¡æ¯ã åæ°å¼åå³äºæ¶æ¯ã

*lParam*<br/>
æä¾ä½¿ç¨å¨å¤çæ¶æ¯çå¶ä»ä¿¡æ¯ã åæ°å¼åå³äºæ¶æ¯ã

### <a name="return-value"></a>è¿åå¼

è°åº¦æ¶æ¯çè¿åå¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°å¯å°ç¹å®æ¶æ¯éè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦ã

## <a name="see-also"></a>è¯·åé

[MFC ç¤ºä¾ CIRC3](../../visual-cpp-samples.md)<br/>
[MFC ç¤ºä¾ TESTHELP](../../visual-cpp-samples.md)<br/>
[COlePropertyPage ç±»](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd ç±»](../../mfc/reference/cwnd-class.md)<br/>
[å±æ¬¡ç»æå¾](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder ç±»](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder ç±»](../../mfc/reference/cpictureholder-class.md)<br/>
