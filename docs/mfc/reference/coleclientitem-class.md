---
title: COleClientItem 类
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 706e7cd290e41ba9f3761f43688dc89fad5f3b74
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/31/2018
ms.locfileid: "50579317"
---
# <a name="coleclientitem-class"></a>COleClientItem 类

定义 OLE 项的容器接口。

## <a name="syntax"></a>语法

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|构造 `COleClientItem` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|打开 OLE 项的操作，然后执行指定的谓词。|
|[COleClientItem::ActivateAs](#activateas)|作为另一种类型将激活该项。|
|[COleClientItem::AttachDataObject](#attachdataobject)|访问 OLE 对象中的数据。|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|指示容器应用程序是否可以创建嵌入的对象。|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|指示容器应用程序是否可以创建链接的对象。|
|[COleClientItem::CanPaste](#canpaste)|指示剪贴板是否包含可嵌入或静态 OLE 项。|
|[COleClientItem::CanPasteLink](#canpastelink)|指示剪贴板是否包含可链接的 OLE 项。|
|[COleClientItem::Close](#close)|关闭到服务器的链接，但不会销毁 OLE 项。|
|[COleClientItem::ConvertTo](#convertto)|将项转换为另一种类型。|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|将 OLE 项复制到剪贴板。|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|创建现有项的副本。|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|从剪贴板中创建嵌入的项。|
|[COleClientItem::CreateFromData](#createfromdata)|从数据对象创建嵌入的项。|
|[COleClientItem::CreateFromFile](#createfromfile)|从文件创建一个嵌入的项。|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|从剪贴板中创建链接的项。|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|从数据对象创建链接的项。|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|从文件创建链接的项。|
|[COleClientItem::CreateNewItem](#createnewitem)|通过启动服务器应用程序创建新的嵌入的项。|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|从剪贴板中创建一个静态项。|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|从数据对象创建一个静态项。|
|[COleClientItem::Deactivate](#deactivate)|停用该项目。|
|[COleClientItem::DeactivateUI](#deactivateui)|将容器应用程序的用户界面还原到其原始状态。|
|[COleClientItem::Delete](#delete)|删除或关闭 OLE 项时链接的项。|
|[COleClientItem::DoDragDrop](#dodragdrop)|执行拖放操作。|
|[COleClientItem::DoVerb](#doverb)|执行指定的谓词。|
|[COleClientItem::Draw](#draw)|绘制 OLE 项。|
|[COleClientItem::GetActiveView](#getactiveview)|获取在其就地激活项的视图。|
|[COleClientItem::GetCachedExtent](#getcachedextent)|返回 OLE 项的矩形的边界。|
|[COleClientItem::GetClassID](#getclassid)|获取显示项的类 id。|
|[COleClientItem::GetClipboardData](#getclipboarddata)|获取通过调用将被放置在剪贴板的数据`CopyToClipboard`成员函数。|
|[COleClientItem::GetDocument](#getdocument)|返回`COleDocument`对象，其中包含存在的项。|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|获取呈现项的当前视图。|
|[COleClientItem::GetExtent](#getextent)|返回 OLE 项的矩形的边界。|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|检索与特定的 CLSID 的服务器关联的图标的句柄。|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|获取用于绘制项的图标的图元文件。|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|返回一个指向项的就地编辑窗口。|
|[COleClientItem::GetItemState](#getitemstate)|获取项的当前状态。|
|[COleClientItem::GetLastStatus](#getlaststatus)|返回最后一个 OLE 操作的状态。|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|返回链接项 （高级功能） 的更新模式。|
|[COleClientItem::GetType](#gettype)|返回 OLE 项的类型 （嵌入、 链接或静态）。|
|[COleClientItem::GetUserType](#getusertype)|获取一个描述项的类型的字符串。|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|如果项处于就地活动状态，则返回 TRUE。|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|返回 TRUE，如果链接的项是包含其源文档的最新更新。|
|[COleClientItem::IsModified](#ismodified)|如果自上次修改此项，保存返回 TRUE。|
|[COleClientItem::IsOpen](#isopen)|返回 TRUE，如果项当前已打开服务器应用程序中。|
|[COleClientItem::IsRunning](#isrunning)|如果项的服务器应用程序正在运行，则返回 TRUE。|
|[COleClientItem::OnActivate](#onactivate)|由框架调用以通知项激活它。|
|[COleClientItem::OnActivateUI](#onactivateui)|由框架调用以通知该项它被激活，并应显示其用户界面。|
|[COleClientItem::OnChange](#onchange)|服务器更改 OLE 项时调用。 所需的实现。|
|[COleClientItem::OnDeactivate](#ondeactivate)|停用某个项时由框架调用。|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|当其就地用户界面中已删除该服务器时由框架调用。|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|由框架调用以获取要复制到剪贴板中的数据。|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|由框架调用以创建复合菜单。|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|由框架调用以从复合菜单移除容器的菜单。|
|[COleClientItem::OnSetMenu](#onsetmenu)|由框架调用以安装和移除复合菜单。|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|由框架调用以显示和隐藏控件条。|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|由框架调用以更新框架窗口的标题栏。|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|可重新激活项并撤消上一个就地编辑操作。|
|[COleClientItem::Release](#release)|释放为 OLE 链接项连接并关闭它，如果它处于打开状态。 不会销毁的客户端项。|
|[COleClientItem::Reload](#reload)|在调用后将重新加载项`ActivateAs`。|
|[COleClientItem::Run](#run)|运行与项关联的应用程序。|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|设置项的当前视图中呈现。|
|[COleClientItem::SetExtent](#setextent)|设置 OLE 项的边框。|
|[COleClientItem::SetHostNames](#sethostnames)|设置的名称，则服务器将显示编辑 OLE 项时。|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|缓存用于绘制项的图标的图元文件。|
|[COleClientItem::SetItemRects](#setitemrects)|设置项的边框。|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|设置链接的项 （高级功能） 的更新模式。|
|[COleClientItem::SetPrintDevice](#setprintdevice)|设置用于此客户端项目的打印目标设备。|
|[COleClientItem::UpdateLink](#updatelink)|更新演示文稿缓存的项。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|由框架调用以确定是否允许就地激活。|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|项的位置发生更改时由框架调用。|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|由框架调用以在激活后撤消。|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|由框架调用以放弃项的撤消状态信息。|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|由框架调用以获取项的剪辑矩形坐标。|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|由框架调用以获取相对于视图的项的位置。|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|就地激活项时由框架调用。|
|[COleClientItem::OnScrollBy](#onscrollby)|由框架调用以将项滚动到视图。|
|[COleClientItem::OnShowItem](#onshowitem)|由框架调用以显示 OLE 项。|

## <a name="remarks"></a>备注

OLE 项表示的数据，由服务器应用程序，可以将"无缝"合并到一个文档，以便显示给用户以单个文档创建和维护。 结果是一个"复合文档"的 OLE 项和包含文档组成。

可以嵌入或链接 OLE 项。 如果嵌入，其数据存储作为复合文档的一部分。 如果链接，其数据存储为单独的文件服务器应用程序，创建的一部分，并仅链接到该文件存储在复合文档。 所有 OLE 项都包含指定要对其进行编辑，应调用的服务器应用程序的信息。

`COleClientItem` 定义多个可重写函数调用的响应请求从服务器应用程序;这些可重写通常充当通知。 这允许服务器应用程序以通知用户编辑 OLE 项时所做的更改的容器或检索编辑期间所需的信息。

`COleClientItem` 可以通过使用[COleDocument](../../mfc/reference/coledocument-class.md)， [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)，或[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)类。 若要使用`COleClientItem`、 从其派生一个类并实现[OnChange](#onchange)成员函数，用于定义容器的项所做的更改的响应方式。 若要支持就地激活，重写[OnGetItemPosition](#ongetitemposition)成员函数。 此函数提供了有关 OLE 项的显示位置的信息。

有关使用容器接口的详细信息，请参阅文章[容器： 实现容器](../../mfc/containers-implementing-a-container.md)并[激活](../../mfc/activation-cpp.md)。

> [!NOTE]
>  Windows SDK 引用嵌入的和链接的项称为"对象"，并将类型的项作为"类"。 此引用使用术语"项"以将 OLE 实体与相应的 c + + 对象和字词"类型"c + + 类区分开来 OLE 类别区分开来。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>要求

**标头：** afxole.h

##  <a name="activate"></a>  COleClientItem::Activate

调用此函数可执行而不是指定的谓词[DoVerb](#doverb)这样，您可以执行您自己处理时引发异常。

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>参数

*nVerb*<br/>
指定要执行的谓词。 它可以是以下值之一：

|“值”|含义|符号|
|-----------|-------------|------------|
|- 0|主谓词|OLEIVERB_PRIMARY|
|- 1|辅助谓词|（无）|
|- 1|显示用于编辑的项|OLEIVERB_SHOW|
|- 2|在单独的窗口中编辑项目|OLEIVERB_OPEN|
|- 3|隐藏项|OLEIVERB_HIDE|

-1 值通常是另一个动作的别名。 如果不支持打开编辑，-2 将具有相同的效果-1。 其他值，请参阅[IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) Windows SDK 中。

*pView*<br/>
指向包含 OLE 项; 容器视图窗口这用于服务器应用程序的就地激活。 如果容器不支持就地激活，则此参数应为 NULL。

*lpMsg*<br/>
指向导致要激活的项的消息。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，此函数会导致[OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb)成员函数的相应`COleServerItem`要执行对象。

如果为编辑主谓词中指定零*nVerb*启动参数，服务器应用程序以允许进行编辑的 OLE 项。 如果容器应用程序支持就地激活，则可以就地完成编辑。 如果容器不支持就地激活 （或如果指定了动词 Open），在一个单独的窗口中启动服务器，可以那里完成编辑。 通常情况下，当容器应用程序的用户双击 OLE 项，主谓词中的值时，才*nVerb*参数用于确定用户可以采取哪些操作。 然而，如果服务器支持只有一个操作，它将该操作，无论所中指定值*nVerb*参数。

有关详细信息，请参阅[IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) Windows SDK 中。

##  <a name="activateas"></a>  COleClientItem::ActivateAs

使用 OLE 的对象转换工具以激活项，就好像它是由指定的类型的项*clsidNew*。

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>参数

*lpszUserType*<br/>
指向的字符串表示的目标用户类型，如"Word 文档"。

*clsidOld*<br/>
对项的当前类的引用 id。 由于存储的除非它是一个链接的类 ID 应表示实际对象的类型。 在这种情况下，它应该是项的链接所引用的 CLSID。 [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)自动提供正确的类 ID 的项。

*clsidNew*<br/>
对目标类 id。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

这称为自动[COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)。 它是不通常直接调用。

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

调用此函数可初始化[COleDataObject](../../mfc/reference/coledataobject-class.md)用于访问 OLE 项中的数据。

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>参数

*rDataObject*<br/>
引用`COleDataObject`将初始化 OLE 项中允许对数据的访问的对象。

##  <a name="canactivate"></a>  COleClientItem::CanActivate

当用户请求的 OLE 项; 就地激活时由框架调用此函数的返回值确定是否允许就地激活。

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>返回值

如果允许就地激活; 非零值否则为 0。

### <a name="remarks"></a>备注

如果容器具有有效的窗口，则默认实现允许就地激活。 重写此函数可实现特殊逻辑，将接受或拒绝的激活请求。 例如，如果 OLE 项因太小或当前不可见，则可以拒绝激活请求。

有关详细信息，请参阅[IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) Windows SDK 中。

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

检查容器应用程序是否可以创建嵌入的对象从给定`COleDataObject`对象。

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向[COleDataObject](../../mfc/reference/coledataobject-class.md)是要创建的 OLE 项的对象。

### <a name="return-value"></a>返回值

如果该容器可以创建从嵌入的对象的非零`COleDataObject`对象; 否则为 0。

### <a name="remarks"></a>备注

`COleDataObject`类用于在数据传输中从剪贴板、 通过拖放操作，或从嵌入 OLE 项检索各种格式的数据。

容器可以使用此函数来决定启用或禁用其编辑粘贴和编辑选择性粘贴命令。

有关详细信息，请参阅文章[数据对象和数据源 (OLE)](../../mfc/data-objects-and-data-sources-ole.md)。

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

检查容器应用程序是否可以创建链接的对象从给定`COleDataObject`对象。

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向[COleDataObject](../../mfc/reference/coledataobject-class.md)是要创建的 OLE 项的对象。

### <a name="return-value"></a>返回值

如果该容器可以创建从某个链接的对象的非零`COleDataObject`对象。

### <a name="remarks"></a>备注

`COleDataObject`类用于在数据传输中从剪贴板、 通过拖放操作，或从嵌入 OLE 项检索各种格式的数据。

容器可以使用此函数来决定启用或禁用其编辑选择性粘贴和编辑粘贴链接命令。

有关详细信息，请参阅文章[数据对象和数据源 (OLE)](../../mfc/data-objects-and-data-sources-ole.md)。

##  <a name="canpaste"></a>  COleClientItem::CanPaste

调用此函数，以查看是否可以从剪贴板粘贴嵌入的 OLE 项。

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>返回值

非零，如果可以从剪贴板; 粘贴嵌入的 OLE 项否则为 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard)并[OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) Windows SDK 中。

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

调用此函数，以查看是否可以从剪贴板粘贴链接的 OLE 项。

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>返回值

非零，如果可以从剪贴板; 粘贴链接的 OLE 项否则为 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard)并[OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) Windows SDK 中。

##  <a name="close"></a>  COleClientItem::Close

调用此函数可从加载在内存中其处理程序但不是运行的服务器向加载状态，即，运行状态更改的 OLE 项的状态。

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>参数

*dwCloseOption*<br/>
标志，指定何种情况下向加载状态返回时保存 OLE 项。 它可以具有以下值之一：

- OLECLOSE_SAVEIFDIRTY 保存 OLE 项。

- OLECLOSE_NOSAVE 不保存 OLE 项。

- OLECLOSE_PROMPTSAVE 提示是否保存 OLE 项上的用户。

### <a name="remarks"></a>备注

OLE 项未在运行时，则此函数无效。

有关详细信息，请参阅[IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) Windows SDK 中。

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

构造`COleClientItem`对象，并将其添加到的文档项的容器文档的集合，该构造仅 c + + 对象，并且不执行任何 OLE 初始化。

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>参数

*pContainerDoc*<br/>
指向将包含此项的容器文档的指针。 这可以是任意[COleDocument](../../mfc/reference/coledocument-class.md)派生类。

### <a name="remarks"></a>备注

如果传递 NULL 指针，则没有添加对容器文档。 必须显式调用[COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem)。

使用 OLE 项之前，必须调用以下创建成员函数之一：

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

调用此成员函数以将项转换为指定的类型*clsidNew*。

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>参数

*clsidNew*<br/>
目标类型的类 ID。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

这称为自动[COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)。 不需要直接调用。

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

调用此函数可将 OLE 项复制到剪贴板。

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>参数

*bIncludeLink*<br/>
如果链接信息应复制到剪贴板，从而允许链接的项，无法粘贴; 则为 TRUE否则为 FALSE。

### <a name="remarks"></a>备注

通常情况下，从编辑菜单中写入消息处理程序的复制或剪切命令时调用此函数。 如果你想要实现的复制或剪切命令，必须在容器应用程序中实现项选择。

有关详细信息，请参阅[OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) Windows SDK 中。

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

调用此函数可创建指定的 OLE 项的副本。

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>参数

*pSrcItem*<br/>
指向要复制的 OLE 项的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

副本是相同的源项。 此函数可用于支持撤消操作。

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

调用此函数可从剪贴板的内容创建嵌入的项。

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

您通常从调用此函数的消息处理程序的编辑菜单上的粘贴命令。 (如果粘贴命令启用框架[CanPaste](#canpaste)成员函数返回非零值。)

有关详细信息，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

调用此函数可创建从嵌入的项`COleDataObject`对象。

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向[COleDataObject](../../mfc/reference/coledataobject-class.md)是要创建的 OLE 项的对象。

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

数据传输操作，例如从剪贴板或拖放操作中，粘贴提供`COleDataObject`对象包含的信息提供的服务器应用程序。 它通常用于在重写[CView::OnDrop](../../mfc/reference/cview-class.md#ondrop)。

有关详细信息，请参阅[OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata)， [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)，并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

调用此函数可从文件创建嵌入的 OLE 项。

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*lpszFileName*<br/>
指向要创建的 OLE 项的文件的名称。

*clsid*<br/>
留待将来使用。

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

框架将调用该函数从[COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)如果用户在选择文件按钮从创建时从插入对象对话框中选择确定。

有关详细信息，请参阅[OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile)， [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)，并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

调用此函数可从剪贴板的内容创建链接的项。

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

您通常从调用此函数的消息处理程序的编辑菜单上的粘贴链接命令。 (粘贴链接命令的默认实现中启用[COleDocument](../../mfc/reference/coledocument-class.md)如果剪贴板包含可以链接到的 OLE 项。)

有关详细信息，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

调用此函数可创建链接的项目从`COleDataObject`对象。

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向[COleDataObject](../../mfc/reference/coledataobject-class.md)是要创建的 OLE 项的对象。

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

这在期间调用删除操作时用户可以指示应创建的链接。 此外可以用于处理编辑粘贴命令。 由框架在调用`COleClientItem::CreateLinkFromClipboard`然后在[COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)时已选择链接选项。

有关详细信息，请参阅[OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata)， [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)，并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

调用此函数可从文件创建链接的 OLE 项。

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*lpszFileName*<br/>
指向要创建的 OLE 项的文件的名称。

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

框架调用此函数，如果用户在创建从文件按钮被选定且链接复选框被选中时从插入对象对话框中选择确定。 从调用[COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)。

有关详细信息，请参阅[OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile)， [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)，并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

调用此函数可创建嵌入的项;此函数可用于启动服务器应用程序，允许用户创建的 OLE 项。

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*clsid*<br/>
唯一标识要创建的 OLE 项的类型的 ID。

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

框架调用此函数，如果用户在选择新建按钮时从插入对象对话框中选择确定。

有关详细信息，请参阅[OleCreate](/windows/desktop/api/ole/nf-ole-olecreate)， [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)，并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

调用此函数可通过剪贴板的内容创建一个静态项。

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

静态项包含演示数据，但不是本机数据;因此无法编辑它。 如果通常调用此函数[CreateFromClipboard](#createfromclipboard)成员函数将失败。

有关详细信息，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

调用此函数可创建静态项目从`COleDataObject`对象。

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向[COleDataObject](../../mfc/reference/coledataobject-class.md)是要创建的 OLE 项的对象。

*呈现器*<br/>
标志，指定服务器的 OLE 项呈现方式。 有关可能的值，请参阅[OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) Windows SDK 中。

*cfFormat*<br/>
指定要创建 OLE 项时进行缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)如果使用的结构*呈现*OLERENDER_FORMAT 或 OLERENDER_DRAW。 为此参数提供一个值，仅当你想要指定超出指定的剪贴板格式的格式的其他信息*cfFormat*。 如果省略此参数，将对其他字段中使用默认值`FORMATETC`结构。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

静态项包含演示数据，但不是本机数据;因此，无法编辑它。 这是实质上是相同[CreateStaticFromClipboard](#createstaticfromclipboard)只不过可以从任意创建一个静态项`COleDataObject`，而不只是从剪贴板。

在中使用[COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)选中静态。

有关详细信息，请参阅[OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata)， [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender)，并[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) Windows SDK 中。

##  <a name="deactivate"></a>  COleClientItem::Deactivate

调用此函数可停用 OLE 项并释放所有关联的资源。

```
void Deactivate();
```

### <a name="remarks"></a>备注

您通常在用户单击鼠标在客户端区域中的项的边界之外时停用的就地活动 OLE 项。 请注意停用 OLE 项将放弃其撤消状态，因此无法调用[ReactivateAndUndo](#reactivateandundo)成员函数。

如果你的应用程序支持撤消，不要调用`Deactivate`; 相反，调用[DeactivateUI](#deactivateui)。

有关详细信息，请参阅[IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) Windows SDK 中。

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

调用此函数，当用户将就地激活项。

```
void DeactivateUI();
```

### <a name="remarks"></a>备注

此函数将还原到其原始状态，隐藏任何菜单和创建就地激活其他控件的容器应用程序的用户界面。

此函数将该项的撤消状态信息未刷新。 信息将保留，以便[ReactivateAndUndo](#reactivateandundo)可更高版本用于服务器应用程序中执行的撤消命令在停用项后立即选择容器的撤消命令的情况下。

有关详细信息，请参阅[IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) Windows SDK 中。

##  <a name="delete"></a>  COleClientItem::Delete

调用此函数可从容器文档中删除 OLE 项。

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>参数

*bAutoDelete*<br/>
指定是否要从文档中删除项。

### <a name="remarks"></a>备注

此函数将调用[版本](#release)成员函数，又删除项，永久删除 OLE 项从文档的 c + + 对象。 如果嵌入 OLE 项时，删除项的本机数据。 它将始终关闭正在运行的服务器;因此，如果该项是打开的链接，此函数将关闭它。

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

调用`DoDragDrop`成员函数以执行拖放操作。

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>参数

*lpItemRect*<br/>
在工作区坐标 （像素） 的屏幕上的项的矩形。

*ptOffset*<br/>
从偏移量*lpItemRect*在拖动时所在的鼠标位置。

*bIncludeLink*<br/>
这为 TRUE 将链接设置应将数据复制到剪贴板。 将其设置为 FALSE，如果服务器应用程序不支持链接。

*dwEffects*<br/>
确定拖动源将允许在拖动操作的效果。

*lpRectStartDrag*<br/>
向定义实际开始拖动该矩形的指针。 有关更多信息，请参见下面的“备注”部分。

### <a name="return-value"></a>返回值

一个 DROPEFFECT 值。 如果它是 DROPEFFECT_MOVE，应删除原始数据。

### <a name="remarks"></a>备注

拖放操作不会立即启动。 它等待，直到鼠标光标离开所指定的矩形*lpRectStartDrag*或之前已通过指定的毫秒数。 如果*lpRectStartDrag*为 NULL，矩形的大小是一个像素。

注册表项设置由指定的延迟时间。 您可以通过调用来更改延迟时间[CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)或[cwinapp:: Writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint)。 如果未指定延迟时间，使用默认值为 200 毫秒。 将延迟时间存储中，如下所示：

- Windows NT 将延迟时间将存储在 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay。

- Windows 3.x 拖动延迟时间将存储在 WIN。INI 文件，[Windows} 部分。

- Windows 95/98 拖动延迟时间将存储在 WIN 的缓存版本。INI。

详细了解如何将拖动的延迟信息存储在任一注册表或。INI 文件，请参阅[WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) Windows SDK 中。

##  <a name="doverb"></a>  COleClientItem::DoVerb

调用`DoVerb`以执行指定的谓词。

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>参数

*nVerb*<br/>
指定要执行的谓词。 它可以包括以下项之一：

|“值”|含义|符号|
|-----------|-------------|------------|
|- 0|主谓词|OLEIVERB_PRIMARY|
|- 1|辅助谓词|（无）|
|- 1|显示用于编辑的项|OLEIVERB_SHOW|
|- 2|在单独的窗口中编辑项目|OLEIVERB_OPEN|
|- 3|隐藏项|OLEIVERB_HIDE|

-1 值通常是另一个动作的别名。 如果不支持打开编辑，-2 将具有相同的效果-1。 其他值，请参阅[IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) Windows SDK 中。

*pView*<br/>
指针，指向视图窗口中;这用于服务器的就地激活。 如果容器应用程序不允许就地激活，则此参数应为 NULL。

*lpMsg*<br/>
指向导致要激活的项的消息。

### <a name="return-value"></a>返回值

已成功执行谓词; 如果非零值否则为 0。

### <a name="remarks"></a>备注

此函数将调用[激活](#activate)成员函数以执行谓词。 它还捕获异常并向用户显示一个消息框，如果引发了一个。

如果为编辑主谓词中指定零*nVerb*启动参数，服务器应用程序以允许进行编辑的 OLE 项。 如果容器应用程序支持就地激活，则可以就地完成编辑。 如果容器不支持就地激活 （或如果指定了动词 Open），在一个单独的窗口中启动服务器，可以那里完成编辑。 通常情况下，当容器应用程序的用户双击 OLE 项，主谓词中的值时，才*nVerb*参数用于确定用户可以采取哪些操作。 然而，如果服务器支持只有一个操作，它将该操作，无论所中指定值*nVerb*参数。

##  <a name="draw"></a>  COleClientItem::Draw

调用此函数可到使用指定的设备上下文的指定边界矩形中绘制 OLE 项。

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>参数

*pDC*<br/>
指向[CDC](../../mfc/reference/cdc-class.md)对象用于绘制 OLE 项。

*lpBounds*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或`RECT`结构，它定义要在其中绘制 （以逻辑单位由设备上下文） 的 OLE 项的边框。

*nDrawAspect*<br/>
指定的方面的 OLE 项，也就是说，它的显示方式。 如果*nDrawAspect*为-1，使用设置的最后一个方面[SetDrawAspect](#setdrawaspect)使用。 有关此标志的可能值的详细信息，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

该函数可能会使用创建的 OLE 项的 metafile 表示形式[OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)成员函数的`COleServerItem`。

通常使用`Draw`屏幕显示将传递在屏幕设备上下文*pDC*。 在这种情况下，需要指定只有前两个参数。

*LpBounds*参数标识的目标设备上下文 （相对于当前映射模式下） 中的矩形。 呈现可能涉及到缩放图片和容器应用程序可用于实施之间显示的视图和最终打印的图像缩放的视图。

有关详细信息，请参阅[iviewobject:: Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) Windows SDK 中。

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

返回在其的项是就地激活的视图。

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>返回值

一个指向该视图;如果此项不是就地激活，否则为 NULL。

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

调用此函数可检索 OLE 项的大小。

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>参数

*lpSize*<br/>
指向`SIZE`结构或[CSize](../../atl-mfc-shared/reference/csize-class.md)将收到的大小信息的对象。

*nDrawAspect*<br/>
指定要从中检索其边界的 OLE 项的方面。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则非零值如果 OLE 项为空，则为 0。

### <a name="remarks"></a>备注

此函数提供了相同的信息[GetExtent](#getextent)。 但是，可以调用`GetCachedExtent`来获取扩展盘区信息处理过程中的其他 OLE 处理程序，如[OnChange](#onchange)。 维度是 MM_HIMETRIC 单位。

这可能是因为`GetCachedExtent`使用[IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2)接口而不使用[IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject)接口，用于获取此项的范围。 `IViewObject2` COM 对象缓存到在上一个调用中使用的扩展盘区信息[iviewobject:: Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw)。

有关详细信息，请参阅[IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) Windows SDK 中。

##  <a name="getclassid"></a>  COleClientItem::GetClassID

返回的项的类 ID 到指向的内存*pClassID*。

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>参数

*pClassID*<br/>
指向类型的标识符[CLSID](/windows/desktop/com/clsid-key-hklm)检索类 id。 CLSID 的信息，请参阅 Windows SDK。

### <a name="remarks"></a>备注

类 ID 是唯一标识的应用程序编辑嵌入项的一个 128 位数字。

有关详细信息，请参阅[IPersist::GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) Windows SDK 中。

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

调用此函数可获取`COleDataSource`对象，其中包含所有数据将放置在剪贴板上通过调用[CopyToClipboard](#copytoclipboard)成员函数。

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>参数

*pDataSource*<br/>
指向[COleDataSource](../../mfc/reference/coledatasource-class.md)将 OLE 项中收到包含的数据的对象。

*bIncludeLink*<br/>
如果链接数据应包括; 则为 TRUE否则为 FALSE。

*lpOffset*<br/>
以像素为单位对象从源鼠标光标的偏移量。

*lpSize*<br/>
以像素为单位的对象的大小。

### <a name="remarks"></a>备注

`GetClipboardData` 作为的默认实现调用[OnGetClipboardData](#ongetclipboarddata)。 重写`OnGetClipboardData`仅当你想要提供除提供的数据格式`CopyToClipboard`。 将放置在这些格式`COleDataSource`对象之前或之后调用`CopyToClipboard`，然后将传递`COleDataSource`对象传递给[COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard)函数。 例如，如果你想在剪贴板上随附其容器文档中的 OLE 项的位置，将定义您自己的格式传递该信息和将其置于`COleDataSource`之前调用`CopyToClipboard`。

##  <a name="getdocument"></a>  COleClientItem::GetDocument

调用此函数可获得一个指向包含 OLE 项的文档。

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>返回值

指向包含 OLE 项的文档的指针。 如果项不是文档的一部分，则为 NULL。

### <a name="remarks"></a>备注

此指针允许访问`COleDocument`作为参数传递的对象`COleClientItem`构造函数。

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

调用`GetDrawAspect`成员函数来确定当前"方面，"或视图的项。

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>返回值

来自 DVASPECT 枚举，其值的引用中列出的值[SetDrawAspect](#setdrawaspect)。

### <a name="remarks"></a>备注

该方面指定项的呈现方式。

##  <a name="getextent"></a>  COleClientItem::GetExtent

调用此函数可检索 OLE 项的大小。

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>参数

*lpSize*<br/>
指向`SIZE`结构或`CSize`将收到的大小信息的对象。

*nDrawAspect*<br/>
指定要从中检索其边界的 OLE 项的方面。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则非零值如果 OLE 项为空，则为 0。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，此函数会导致[OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent)成员函数的相应`COleServerItem`对象调用。 请注意，检索到的大小可能不同于上次设置的大小[SetExtent](#setextent)成员函数; 指定的大小`SetExtent`视为一项建议。 维度是 MM_HIMETRIC 单位。

> [!NOTE]
>  不要调用`GetExtent`处理过程中的 OLE 的处理程序，如[OnChange](#onchange)。 调用[GetCachedExtent](#getcachedextent)相反。

有关详细信息，请参阅[IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) Windows SDK 中。

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

调用此成员函数以检索与特定 CLSID 服务器关联的图标资源的句柄。

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>参数

*clsid*<br/>
对与图标关联的服务器的 CLSID 的引用。

### <a name="return-value"></a>返回值

一个有效的句柄的图标资源，或如果无法找到服务器的图标或默认图标，则为 NULL。

### <a name="remarks"></a>备注

此成员函数将不启动服务器，或即使服务器已在运行中动态地获得图标。 相反，此成员函数将打开服务器的可执行映像，并检索与服务器关联，因为它已注册的静态图标。

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

检索用于绘制项的图标的图元文件。

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>返回值

如果成功，则的图元文件句柄否则为，为 NULL。

### <a name="remarks"></a>备注

如果没有当前的图标，则返回默认图标。 这称为自动由 MFC/OLE 对话框，通常不直接调用。

此函数还将调用[SetIconicMetafile](#seticonicmetafile)缓存以供将来使用图元文件。

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

调用`GetInPlaceWindow`成员函数以进行就地编辑到在其中打开该项目的窗口获取的指针。

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>返回值

一个指向项的就地编辑窗口;如果该项未处于活动状态或其服务器不可用，则为 NULL。

### <a name="remarks"></a>备注

仅为处于就地活动状态的项，应调用此函数。

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

调用此函数可获取 OLE 项的当前状态。

```
UINT GetItemState() const;
```

### <a name="return-value"></a>返回值

一个`COleClientItem::ItemState`枚举值，该值可以是以下值之一： `emptyState`， `loadedState`， `openState`， `activeState`， `activeUIState`。 有关这些状态信息，请参阅文章[容器： 客户端项状态](../../mfc/containers-client-item-states.md)。

### <a name="remarks"></a>备注

若要将 OLE 项的状态更改时得到通知，请使用[OnChange](#onchange)成员函数。

有关详细信息，请参阅文章[容器： 客户端项状态](../../mfc/containers-client-item-states.md)。

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

返回最后一次 OLE 操作的状态代码。

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>返回值

一个 SCODE 值。

### <a name="remarks"></a>备注

对于成员函数返回 BOOL 值为 FALSE 或其他成员函数返回 NULL，`GetLastStatus`返回更详细的失败信息。 请注意大多数 OLE 成员函数会引发异常更严重的错误。 对 SCODE 解释的特定信息取决于上一次返回了 SCODE 值的基础 OLE 调用。

SCODE 的详细信息，请参阅[COM 错误代码的结构](/windows/desktop/com/structure-of-com-error-codes)Windows SDK 文档中。

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

调用此函数可获取 OLE 项的链接更新选项的当前值。

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>返回值

以下值之一：

- OLEUPDATE_ALWAYS 更新链接的项，只要有可能。 此选项支持链接对话框中的自动链接更新单选按钮。

- OLEUPDATE_ONCALL 更新仅在从容器应用程序的请求上链接的项 (当[UpdateLink](#updatelink)调用成员函数)。 在链接对话框中，此选项支持手动链接更新单选按钮。

### <a name="remarks"></a>备注

这是一项高级的操作。

会自动调用此函数[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)类。

有关详细信息，请参阅[IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) Windows SDK 中。

##  <a name="gettype"></a>  COleClientItem::GetType

调用此函数可确定是否将 OLE 项嵌入或链接，或静态。

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>返回值

一个无符号的整数，其以下值之一：

- OT_LINK OLE 项是一个链接。

- 嵌入 OT_EMBEDDED OLE 项。

- OT_STATIC OLE 项是静态的也就是说，它包含仅演示数据，不是本机数据并因此不能编辑。

##  <a name="getusertype"></a>  COleClientItem::GetUserType

调用此函数可获取用户可见的字符串，该字符串描述 OLE 项的类型，如"Word 文档"。

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>参数

*nUserClassType*<br/>
一个值，该值描述 OLE 项的类型的字符串的所需变体。 这可以具有以下值之一：

- USERCLASSTYPE_FULL 的完整类型名称向用户显示。

- USERCLASSTYPE_SHORT 一个短名称 （最多 15 个字符） 在弹出菜单和编辑链接对话框中使用。

- USERCLASSTYPE_APPNAME 服务类应用程序的名称。

*rString*<br/>
对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)描述 OLE 项的类型的字符串是要返回的对象。

### <a name="remarks"></a>备注

这通常是系统注册数据库中的条目。

如果完整类型名称为请求，但不可用，改为使用短名称。 如果在注册数据库中，如果未找到的类型的 OLE 项条目，或如果不存在用户类型为 OLE 项的类型注册，则用户类型当前存储在使用 OLE 项。 如果该用户类型名称为空字符串，则使用"未知对象"。

有关详细信息，请参阅[IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) Windows SDK 中。

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

调用此函数可将 OLE 项是否为处于就地活动状态。

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项处于就地活动状态; 非零值否则为 0。

### <a name="remarks"></a>备注

若要执行不同的逻辑，具体取决于是否正在编辑的项在位置常见于。 该函数检查当前的项状态是否为相等`activeState`或`activeUIState`。

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

调用此函数以确定是否为最新的 OLE 项。

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>返回值

OLE 项是最新的; 如果非零值否则为 0。

### <a name="remarks"></a>备注

链接的项可以是过期如果已更新其源文档。 嵌入的项包含在其中的链接可能同样会变得过时。 该函数执行递归检查的 OLE 项。 请注意，确定是否过期的 OLE 项可以是成本是实际执行更新。

这称为自动[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)实现。

有关详细信息，请参阅[IOleObject::IsUpToDate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) Windows SDK 中。

##  <a name="ismodified"></a>  COleClientItem::IsModified

调用此函数可看到 OLE 项是脏的 （自上次保存以来已修改）。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>返回值

OLE 项已更新; 如果非零值否则为 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) Windows SDK 中。

##  <a name="isopen"></a>  COleClientItem::IsOpen

调用此函数，以查看是否已打开，则 OLE 项即，在单独窗口中运行的服务器应用程序实例中打开。

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项已打开，则非零值否则为 0。

### <a name="remarks"></a>备注

它用于确定何时绘制该对象具有阴影模式。 打开的对象应具有在该对象之上绘制的阴影模式。 可以使用[CRectTracker](../../mfc/reference/crecttracker-class.md)对象来实现此目的。

##  <a name="isrunning"></a>  COleClientItem::IsRunning

调用此函数，以查看是否正在运行的 OLE 项;也就是说，项是否加载并正在运行服务器应用程序中。

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>返回值

如果正在运行的 OLE 项; 非零值否则为 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) Windows SDK 中。

##  <a name="onactivate"></a>  COleClientItem::OnActivate

由框架调用以通知项，只需激活到位。

```
virtual void OnActivate();
```

### <a name="remarks"></a>备注

请注意，此函数调用以指示服务器正在运行，不以指示已在容器应用程序中安装其用户界面。 此时，该对象不具有活动的用户界面 (不是`activeUIState`)。 它不具有安装其菜单或工具栏。 [OnActivateUI](#onactivateui)发生这种情况时，调用成员函数。

默认实现调用[OnChange](#onchange) OLE_CHANGEDSTATE 作为参数的成员函数。 重写此函数以执行自定义处理项变得处于就地活动状态时。

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

框架将调用`OnActivateUI`当对象已进入活动的 UI 状态。

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>备注

对象现在已安装其工具栏和菜单。

对于更高版本的默认实现会记住服务器的 HWND`GetServerWindow`调用。

##  <a name="onchange"></a>  COleClientItem::OnChange

用户修改、 保存，或关闭 OLE 项时由框架调用。

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>参数

*nCode*<br/>
在服务器的原因更改此项。 它可以具有以下值之一：

- OLE_CHANGED OLE 项的外观已更改。

- 已保存 OLE_SAVED OLE 项。

- 已关闭 OLE_CLOSED OLE 项。

- OLE_CHANGED_STATE OLE 项已从一个状态更改为另一个。

*dwParam*<br/>
如果*nCode* OLE_SAVED 或 OLE_CLOSED，未使用此参数。 如果*nCode*是 OLE_CHANGED，此参数指定的 OLE 项的已更改的方面。 有关可能的值，请参阅*dwParam*的参数[COleClientItem::Draw](#draw)。 如果*nCode*是 OLE_CHANGED_STATE，此参数是`COleClientItem::ItemState`枚举值，并介绍要进入的状态。 它可以具有以下值之一： `emptyState`， `loadedState`， `openState`， `activeState`，或`activeUIState`。

### <a name="remarks"></a>备注

(如果服务器应用程序使用 Microsoft 基础类库编写的此函数调用以响应`Notify`的成员函数`COleServerDoc`或`COleServerItem`。)默认实现将容器文档标记为已修改，如果*nCode* OLE_CHANGED 或 OLE_SAVED。

从返回的当前状态为 OLE_CHANGED_STATE， [GetItemState](#getitemstate)仍将旧的状态，这意味着当前在此状态更改前的状态。

重写此函数可对 OLE 项的状态变化作出响应。 通常导致无效的区域的项显示在其中更新项的外观。 重写的开头调用基类实现。

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

由框架调用以通知 OLE 项的作用域在就地激活期间已更改的容器。

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>参数

*rectPos*<br/>
指示项的位置相对于容器应用程序的客户端区。

### <a name="return-value"></a>返回值

已成功更改项的位置; 如果非零值否则为 0。

### <a name="remarks"></a>备注

默认实现确定 OLE 项和调用的新可见的矩形[SetItemRects](#setitemrects)使用新值。 默认实现计算项可见的矩形，并将该信息传递到服务器。

重写此函数应用特殊规则来重设大小/移动操作。 如果应用程序在 MFC 中编写的此调用会因为在服务器调用[COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)。

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

从就地活动状态转换的 OLE 项时由框架调用 ( `activeState`) 向加载状态，这意味着，它已停用后的就地激活。

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>备注

请注意，此函数调用以指示 OLE 项已关闭，不，其用户界面已从容器应用程序。 在这种情况， [OnDeactivateUI](#ondeactivateui)调用成员函数。

默认实现调用[OnChange](#onchange) OLE_CHANGEDSTATE 作为参数的成员函数。 重写此函数以执行自定义处理时停用的就地活动项。 例如，如果在容器应用程序中支持撤消命令，你可以重写此函数可放弃撤消状态，，指出 OLE 项执行的最后一个操作无法撤消项停用后。

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

当用户激活就地 OLE 项后调用撤消命令时，由框架调用。

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>备注

默认实现调用[DeactivateUI](#deactivateui)停用服务器的用户界面。 如果要在容器应用程序中实现撤消命令，重写此函数。 在替代中，调用该函数的基类版本，然后撤消你的应用程序中执行的最后一个命令。

有关详细信息，请参阅[IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) Windows SDK 中。

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

当用户将就地激活项时调用。

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>参数

*bUndoable*<br/>
指定是否可撤消编辑更改。

### <a name="remarks"></a>备注

此函数将还原到其原始状态，隐藏任何菜单和创建就地激活其他控件的容器应用程序的用户界面。

如果*bUndoable*为 FALSE 时，容器应禁用撤消命令，实际上放弃撤消状态的容器，因为它表示由服务器执行的最后一个操作不可撤消。

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

当用户执行编辑 OLE 项时放弃的撤消状态的操作时由框架调用。

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>备注

默认实现不执行任何操作。 如果要在容器应用程序中实现撤消命令，重写此函数。 在替代中，放弃容器应用程序的撤消状态。

如果服务器已使用 Microsoft 基础类库编写，服务器可能会导致调用通过调用此函数[COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate)。

有关详细信息，请参阅[IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) Windows SDK 中。

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

由框架调用以获取`COleDataSource`对象，其中包含所有数据将放置在剪贴板上通过调用[CopyToClipboard](#copytoclipboard)或[DoDragDrop](#dodragdrop)成员函数。

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>参数

*bIncludeLink*<br/>
将此设置为 true 将数据链接应复制到剪贴板。 将此设置为 FALSE; 你的服务器应用程序不支持链接。

*lpOffset*<br/>
相对于鼠标光标的偏移量从原点以像素为单位的对象的指针。

*lpSize*<br/>
以像素为单位的对象的大小的指针。

### <a name="return-value"></a>返回值

一个指向[COleDataSource](../../mfc/reference/coledatasource-class.md)对象，其中包含剪贴板数据。

### <a name="remarks"></a>备注

此函数的默认实现调用[GetClipboardData](#getclipboarddata)。

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

框架将调用`OnGetClipRect`成员函数以在位置获取正在编辑的项的剪辑矩形坐标。

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>参数

*rClipRect*<br/>
指向类的对象指针[CRect](../../atl-mfc-shared/reference/crect-class.md)用于将保存的项的剪辑矩形坐标。

### <a name="remarks"></a>备注

坐标是相对于容器应用程序窗口的工作区以像素为单位。

默认实现只需返回项处于就地活动状态的视图在其上的客户端的矩形。

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

框架将调用`OnGetItemPosition`成员函数以在位置获取正在编辑的项的坐标。

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>参数

*rPosition*<br/>
引用[CRect](../../atl-mfc-shared/reference/crect-class.md)对象将包含项的位置坐标。

### <a name="remarks"></a>备注

坐标是相对于容器应用程序窗口的工作区以像素为单位。

此函数的默认实现不执行任何操作。 支持就地编辑的应用程序需要它的实现。

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

就地激活项时由框架调用。

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>参数

*ppMainFrame*<br/>
指针到指向主框架窗口。

*ppDocFrame*<br/>
指针到指向文档框架窗口。

*lpFrameInfo*<br/>
指向[OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi)结构，它将接收帧窗口信息。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此函数用于检索有关 OLE 项的父窗口的信息。

如果容器是 MDI 应用程序，默认实现返回一个指向[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)对象中*ppMainFrame*和指向活动[CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)中的对象*ppDocFrame*。 如果容器是 SDI 应用程序，默认实现返回一个指向[CFrameWnd](../../mfc/reference/cframewnd-class.md)对象中*ppMainFrame* ，并返回中的 NULL *ppDocFrame*。 默认实现中的成员还填充*lpFrameInfo*。

默认实现不能满足你的应用程序; 如果仅重写此函数例如，如果你的应用程序具有不同于 SDI 或 MDI 用户界面范例。 这是一种高级可重写。

有关详细信息，请参阅[IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext)并[OLEINPLACEFRAMEINFO](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) Windows SDK 中的结构。

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

由框架调用期间就地激活，将容器应用程序的菜单插入空菜单。

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>参数

*pMenuShared*<br/>
指向一个空菜单。

*lpMenuWidths*<br/>
指向数组的 6 个 LONG 值，该值指示在每个以下的菜单组中的菜单数： 文件中，编辑，容器对象，窗口中，帮助。 容器应用程序负责文件、 容器和窗口菜单组，对应于 0、 2 和 4 此数组的元素。

### <a name="remarks"></a>备注

此菜单然后传递到服务器，将插入其自己的菜单，创建复合菜单。 可以反复调用此函数来生成多个复合菜单。

默认实现将插入到*pMenuShared*就地容器菜单; 即，文件、 容器和窗口菜单组。 [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo)用于设置此菜单资源。 默认实现还将相应的值分配给 0、 2 和 4 中的元素*lpMenuWidths*，取决于该菜单资源。 默认实现不适合于你的应用程序; 如果重写此函数例如，如果你的应用程序不使用将资源与文档类型相关联的文档模板。 如果重写此函数，则还应重写[OnSetMenu](#onsetmenu)并[OnRemoveMenus](#onremovemenus)。 这是一种高级可重写。

有关详细信息，请参阅[ioleinplaceframe:: Insertmenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) Windows SDK 中。

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

由框架调用以就地激活结束时从指定的复合菜单移除容器的菜单。

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>参数

*pMenuShared*<br/>
指向通过调用来构造复合菜单[OnInsertMenus](#oninsertmenus)成员函数。

### <a name="remarks"></a>备注

从默认实现中移除*pMenuShared*就地容器菜单，即、 文件、 容器和窗口菜单组。 默认实现不适合于你的应用程序; 如果重写此函数例如，如果你的应用程序不使用将资源与文档类型相关联的文档模板。 如果重写此函数，则可能应重写[OnInsertMenus](#oninsertmenus)并[OnSetMenu](#onsetmenu)也。 这是一种高级可重写。

在子菜单*pMenuShared*如果服务器已反复调用都可以由多个复合菜单共同`OnInsertMenus`。 因此不应删除任何子菜单中的重写`OnRemoveMenus`; 应仅分离。

有关详细信息，请参阅[IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) Windows SDK 中。

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

由框架调用以响应来自服务器的请求中将 OLE 项滚动。

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>参数

*sizeExtent*<br/>
指定距离，以像素为单位，在 x 和 y 方向滚动。

### <a name="return-value"></a>返回值

如果该项已滚动;，则非零值如果不滚动项，则为 0。

### <a name="remarks"></a>备注

例如，如果 OLE 项是部分可见，并且用户将移动可视区域以外执行就地编辑时，此函数调用保持游标可见。 默认实现不执行任何操作。 重写此函数可将项滚动指定的量。 请注意由于滚动时，可以更改 OLE 项的可见部分。 调用[SetItemRects](#setitemrects)更新项的可见的矩形。

有关详细信息，请参阅[IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) Windows SDK 中。

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

由框架调用两次时就地激活开始和结束;首次安装复合菜单和第二个时间 (与*holemenu*等于 NULL) 将其删除。

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>参数

*pMenuShared*<br/>
指向通过调用来构造复合菜单[OnInsertMenus](#oninsertmenus)成员函数和`InsertMenu`函数。

*holemenu*<br/>
返回菜单描述符的句柄`OleCreateMenuDescriptor`函数，或如果调度代码是要删除，则为 NULL。

*hwndActiveObject*<br/>
OLE 项的编辑窗口的句柄。 这是将接收来自 OLE 的编辑命令窗口。

### <a name="remarks"></a>备注

默认实现将安装或移除复合菜单，然后调用[OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor)函数来安装或删除调度的代码。 如果默认实现不适合于你的应用程序，重写此函数。 如果重写此函数，则可能应重写[OnInsertMenus](#oninsertmenus)并[OnRemoveMenus](#onremovemenus)也。 这是一种高级可重写。

有关详细信息，请参阅[OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor)， [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor)，并[ioleinplaceframe:: Setmenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) Windows SDK 中。

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

由框架调用以显示和隐藏容器应用程序的控件条。

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>参数

*pFrameWnd*<br/>
向容器应用程序的框架窗口的指针。 这可以是主框架窗口或 MDI 子窗口。

*bShow*<br/>
指定是否要显示或隐藏控件条。

### <a name="return-value"></a>返回值

如果函数调用中的控件条的状态，则将导致更改非零值0 或如果该调用将导致无更改，如果*pFrameWnd*没有指向容器的框架窗口。

### <a name="remarks"></a>备注

如果控件条在已指定的状态，此函数将返回 0 *bShow。* 出现这种，例如，如果隐藏的控件条和*bShow*为 FALSE。

从顶级框架窗口中的默认实现删除工具栏。

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

由框架调用以显示 OLE 项，使其在编辑期间完全可见。

```
virtual void OnShowItem();
```

### <a name="remarks"></a>备注

当容器应用程序支持指向嵌入项时，使用 (即，如果从您的文档类派生[COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md))。 在就地激活或当 OLE 项是链接源时，用户想要对其进行编辑期间调用此函数。 默认实现将激活容器文档的第一个视图。 重写此函数可将文档滚动，以便 OLE 项可见。

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

由框架调用以更新框架窗口的标题栏的就地激活过程。

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>返回值

非零，如果此函数已成功更新帧标题，否则为零。

### <a name="remarks"></a>备注

默认实现不会更改框架窗口标题。 如果想要不同的帧标题应用程序，例如重写此函数"*服务器应用程序* - *项*中*docname*"（如下所示，"MicrosoftExcel-在报表中的电子表格。文档"）。 这是一种高级可重写。

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

调用此函数以重新激活 OLE 项并撤消的就地编辑过程中由用户执行的最后一个操作。

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果容器应用程序支持撤消命令，如果用户选择撤消命令在停用 OLE 项后立即调用此函数。

如果服务器应用程序使用 Microsoft 基础类库编写的此函数会导致调用服务器[COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)。

有关详细信息，请参阅[IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) Windows SDK 中。

##  <a name="release"></a>  COleClientItem::Release

调用此函数可清理 OLE 项所使用的资源。

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>参数

*dwCloseOption*<br/>
标志，指定何种情况下向加载状态返回时保存 OLE 项。 有关可能的值的列表，请参阅[COleClientItem::Close](#close)。

### <a name="remarks"></a>备注

`Release` 由调用`COleClientItem`析构函数。

有关详细信息，请参阅[iunknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) Windows SDK 中。

##  <a name="reload"></a>  COleClientItem::Reload

关闭并重新加载项。

```
BOOL Reload();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

调用`Reload`函数之后，激活作为另一种类型的项的项，通过调用[ActivateAs](#activateas)。

##  <a name="run"></a>  COleClientItem::Run

运行与此项关联的应用程序。

```
void Run();
```

### <a name="remarks"></a>备注

调用`Run`成员函数以启动服务器应用程序激活项之前。 这是自动[激活](#activate)并[DoVerb](#doverb)，因此通常需要调用此函数。 调用此函数，如果需要运行服务器，以设置项属性，如[SetExtent](#setextent)，在执行之前[DoVerb](#doverb)。

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

调用`SetDrawAspect`成员函数设置的"方面"或查看的项。

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>参数

*nDrawAspect*<br/>
DVASPECT 枚举中的值。 此参数可以具有下列值之一：

- DVASPECT_CONTENT 项可以显示为其容器内的嵌入对象的方式表示。

- DVASPECT_THUMBNAIL 项将呈现在"缩略图"表示形式，以便它可以显示在浏览工具。

- DVASPECT_ICON 项由一个图标表示。

- DVASPECT_DOCPRINT 项表现为似乎打印出的使用文件菜单中的打印命令。

### <a name="remarks"></a>备注

方面指定项的方式来呈现[绘制](#draw)时的默认值为该函数的*nDrawAspect*使用参数。

通过更改图标 （和其他对话框直接调用更改图标对话框的） 自动调用此函数以启用该图标显示方面时用户请求。

##  <a name="setextent"></a>  COleClientItem::SetExtent

调用此函数可指定空间量是可用于将 OLE 项。

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>参数

*size*<br/>
一个[CSize](../../atl-mfc-shared/reference/csize-class.md)对象，其中包含的大小信息。

*nDrawAspect*<br/>
指定要设置其边界的 OLE 项的方面。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="remarks"></a>备注

如果服务器应用程序使用 Microsoft 基础类库编写的这将导致[OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent)成员函数的相应`COleServerItem`对象调用。 OLE 项然后可以相应地调整其显示。 维度必须采用 MM_HIMETRIC 单位。 调用此函数在用户调整 OLE 项或支持某种形式的布局协商。

有关详细信息，请参阅[IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) Windows SDK 中。

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

调用此函数可指定容器应用程序的名称和嵌入 OLE 项的容器的名称。

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>参数

*lpszHost*<br/>
一个指针，指向容器应用程序的用户可见的名称。

*lpszHostObj*<br/>
指向包含 OLE 项的容器的标识字符串的指针。

### <a name="remarks"></a>备注

如果使用 Microsoft 基础类库编写服务器应用程序，此函数将调用[OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames)成员函数的`COleServerDoc`文档，其中包含 OLE 项。 在编辑 OLE 项时，将在窗口标题中使用此信息。 每次加载容器文档时，框架在文档中的所有 OLE 项都调用此函数。 `SetHostNames` 是仅适用于嵌入的项。 不需要调用此函数每次激活嵌入的 OLE 项以进行编辑。

这也称为自动文档名称的应用程序名称与加载对象时或以其他名称保存文件时。 相应地，它不是直接调用此函数通常都有必要的。

有关详细信息，请参阅[IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) Windows SDK 中。

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

缓存用于绘制项的图标的图元文件。

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>参数

*hMetaPict*<br/>
用于绘制项的图标的图元文件句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

使用[GetIconicMetafile](#geticonicmetafile)检索图元文件。

*HMetaPict*参数复制到项目中; 因此， *hMetaPict*必须由调用方释放。

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

调用此函数可设置的边框或 OLE 项的可见的矩形。

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>参数

*lprcPosRect*<br/>
指向包含相对于其父窗口，在客户端坐标中的 OLE 项的边界的矩形的指针。

*lprcClipRect*<br/>
指向包含相对于其父窗口，在客户端坐标中的 OLE 项的可见部分的边界的矩形的指针。

### <a name="return-value"></a>返回值

如果成功，则非零值否则为为 0。

### <a name="remarks"></a>备注

默认实现调用此函数[OnChangeItemPosition](#onchangeitemposition)成员函数。 每当位置或可见部分 OLE 项的更改时，应调用此函数。 通常，这意味着从视图的调用它[OnSize](../../mfc/reference/cwnd-class.md#onsize)并[OnScrollBy](../../mfc/reference/cview-class.md#onscrollby)成员函数。

有关详细信息，请参阅[IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) Windows SDK 中。

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

调用此函数可设置指定的链接项的演示文稿的链接更新选项。

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>参数

*dwUpdateOpt*<br/>
此项的链接更新选项的值。 此值必须是以下值之一：

- OLEUPDATE_ALWAYS 更新链接的项，只要有可能。 此选项支持链接对话框中的自动链接更新单选按钮。

- OLEUPDATE_ONCALL 更新仅在从容器应用程序的请求上链接的项 (当[UpdateLink](#updatelink)调用成员函数)。 在链接对话框中，此选项支持手动链接更新单选按钮。

### <a name="remarks"></a>备注

通常情况下，不应更改链接对话框中的用户的所选更新选项。

有关详细信息，请参阅[IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) Windows SDK 中。

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

调用此函数可更改此项的打印目标设备。

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>参数

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)数据结构，其中包含有关新的打印目标设备的信息。 可以为 NULL。

*ppd*<br/>
指向[PRINTDLG](https://msdn.microsoft.com/library/windows/desktop/ms646940)数据结构，其中包含有关新的打印目标设备的信息。 可以为 NULL。

### <a name="return-value"></a>返回值

如果函数成功，则非零值否则为 0。

### <a name="remarks"></a>备注

此函数更新项的打印目标设备，但不会刷新演示文稿缓存。 若要更新某个项的演示文稿缓存，请调用[UpdateLink](#updatelink)。

此函数的参数包含 OLE 系统用来标识目标设备的信息。 `PRINTDLG`结构包含 Windows 用来初始化通用打印对话框信息。 用户关闭对话框后，Windows 将在此结构中返回有关用户的选择信息。 `m_pd`的成员[CPrintDialog](../../mfc/reference/cprintdialog-class.md)对象是`PRINTDLG`结构。

有关此结构的详细信息，请参阅[PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) Windows SDK 中。

有关详细信息，请参阅[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) Windows SDK 中。

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

调用此函数可立即更新 OLE 项的呈现数据。

```
BOOL UpdateLink();
```

### <a name="return-value"></a>返回值

若成功，则为非零；否则为 0。

### <a name="remarks"></a>备注

对于链接项，该函数来查找链接源以获取新的演示文稿的 OLE 项。 此过程可能涉及运行一个或多个服务器应用程序，这可能非常耗时。 对于嵌入项，函数进行操作以递归方式检查嵌入的项是否包含可能会过时的链接并更新它们。 用户还可以手动更新使用链接对话框中的单个链接。

有关详细信息，请参阅[IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) Windows SDK 中。

## <a name="see-also"></a>请参阅

[MFC 示例 MFCBIND](../../visual-cpp-samples.md)<br/>
[MFC 示例 OCLIENT](../../visual-cpp-samples.md)<br/>
[CDocItem 类](../../mfc/reference/cdocitem-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[COleServerItem 类](../../mfc/reference/coleserveritem-class.md)
