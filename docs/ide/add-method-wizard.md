---
title: "添加方法向导 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.codewiz.method.overview"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "添加方法向导 [C++]"
  - "方法 [C++], 使用向导添加"
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
caps.latest.revision: 7
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 7
---
# 添加方法向导
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

使用该向导向接口添加方法。  根据要向其添加方法的项目类型或接口类型，该向导显示不同的选项。  
  
## 名称  
 **返回类型**  
 由方法返回的数据类型。  建议对所有接口类型使用 `HRESULT`，因为它提供了一种返回错误的标准方式。  
  
|接口类型|说明|  
|----------|--------|  
|双重接口|`HRESULT`.  不可更改。|  
|自定义接口|`HRESULT`.  不可更改。|  
|本地自定义接口|提供您自己的返回类型或从列表中选择。|  
|调度接口|提供您自己的返回类型或从列表中选择。|  
|MFC ActiveX 控件调度接口|如果实现常用方法，则将返回类型设置为适当的值并且不可更改。  如果从“方法名称”列表中选择方法并单击“选择方法类型”下的“自定义”，则从列表中选择返回类型。|  
  
 **方法名**  
 设置方法名称。  
  
|接口类型|说明|  
|----------|--------|  
|ATL 双重接口、自定义接口和本地自定义接口|提供您自己的方法名称。|  
|MFC 调度接口|提供您自己的方法名称，或从列表中选择建议的方法名称。  如果从列表中选择名称，则“返回类型”框中出现适当的值，并且该值不可更改。|  
|MFC ActiveX 控件调度接口|提供您自己的方法名称或者从常用方法 [DoClick](../Topic/COleControl::DoClick.md) 和 [Refresh](../Topic/COleControl::Refresh.md) 中选择一个。  有关更多信息，请参见 [MFC ActiveX 控件：添加常用方法](../mfc/mfc-activex-controls-adding-stock-methods.md)。|  
  
 **方法类型**  
 仅可用于 MFC ActiveX 控件。  如果在“方法名称”框中提供方法名称，而不是从列表中选择方法，则该框不可用。  
  
 如果在“方法名称”列表中选择一个方法，则选择常用实现或自定义实现。  
  
|方法类型|说明|  
|----------|--------|  
|**常用**|默认值。  插入在“方法名称”列表中选择的方法的常用实现。  如果选择“常用”，则“返回类型”不可更改。|  
|**自定义**|插入在“方法名称”列表中选择的方法的存根 \(stub\) 实现。  对于自定义方法类型，可以提供您自己的返回类型，或者可以从“返回类型”列表中选择一个返回类型。|  
  
 **内部名称**  
 仅可用于添加到 MFC 调度接口的自定义方法。  设置在调度映射、头 \(.h\) 文件和实现 \(.cpp\) 文件中使用的名称。  默认情况下，该名称与“方法名称”相同。  如果正在处理 MFC 调度接口或者正向 MFC ActiveX 控件调度接口添加自定义方法，则可以更改方法名称。  
  
|接口类型|说明|  
|----------|--------|  
|ATL 双重接口、自定义接口和本地自定义接口|不可用|  
|MFC 调度接口|默认情况下设置为方法名称。  可以编辑该内部名称。|  
|MFC ActiveX 控件调度接口|只能为自定义方法设置内部名称。  常用方法不使用内部名称。|  
  
 **参数特性**  
 为在“参数名”中指定的参数设置任何附加特性。  
  
|参数特性|说明|允许的组合|  
|----------|--------|-----------|  
|**在 ... 中**|指示参数从调用过程传递到被调用过程。|仅为 **in**<br /><br /> **in** 和 **out**|  
|**out**|指示指针参数从被调用过程返回到调用过程（即从服务器到客户端）。|仅为 **out**<br /><br /> **in** 和 **out**<br /><br /> **out** 和 **retval**|  
|**retval**|指示参数接收成员的返回值。|retval 和 out|  
  
 **参数类型**  
 设置参数的数据类型。  从列表中选择类型。  
  
 **参数名**  
 设置通过方法传递的参数的名称。  键入名称后，必须单击“添加”才能将它添加到将通过方法传递的参数的列表。  如果不提供参数名，则向导忽略任何参数特性（只适用于 ATL）或“参数类型”选择。  
  
 单击“添加”后，参数名出现在**“参数列表”**中。  
  
 **注意** 如果提供参数名，然后在单击“添加”之前单击“完成”，则参数不添加到方法中。  必须查找该方法并手动插入参数。  
  
 **添加**  
 向**“参数列表”**添加在“参数名”中指定的参数及其类型和参数特性。  必须单击“添加”才能将参数添加到列表中。  
  
 **移除**  
 从列表中移除在“参数列表”中选择的参数。  
  
 **参数列表**  
 显示当前为方法添加的所有参数及其修饰符和类型。  添加参数时，向导随之更新**“参数列表”**以显示每一个参数及其修饰符和类型。  
  
## 请参阅  
 [添加方法](../ide/adding-a-method-visual-cpp.md)   
 [“添加方法向导”\-\>“IDL 特性”](../ide/idl-attributes-add-method-wizard.md)