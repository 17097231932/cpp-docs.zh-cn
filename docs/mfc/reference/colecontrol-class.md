---
title: "COleControl 类 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- OLE controls, MFC
- windowless controls, MFC
- windowless controls
- controls [MFC], OLE
- controls [MFC], windowless
- COleControl class
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 128bd124c2536d86c8b673b54abc4b5505526b41
ms.openlocfilehash: 7f98ac382549509874bd570307a05ccea5ed657a
ms.contentlocale: zh-cn
ms.lasthandoff: 05/10/2017

---
# <a name="colecontrol-class"></a>COleControl 类
用于开发 OLE 控件的重要基类。  
  
## <a name="syntax"></a>语法  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|描述|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|创建一个 `COleControl` 对象。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|描述|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|检索当前控件的外观。|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|返回环境 BackColor 属性的值。|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|按容器返回作为指定控件的名称。|  
|[COleControl::AmbientFont](#ambientfont)|返回环境字体属性的值。|  
|[COleControl::AmbientForeColor](#ambientforecolor)|返回环境前景色属性的值。|  
|[Colecontrol:: Ambientlocaleid](#ambientlocaleid)|返回容器的区域设置 id。|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|返回容器使用的单位类型。|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|确定是否应显示抓取手柄。|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|确定是否应显示阴影。|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|返回指定的容器的文本对齐方式的类型。|  
|[COleControl::AmbientUIDead](#ambientuidead)|确定控件应响应用户界面操作。|  
|[COleControl::AmbientUserMode](#ambientusermode)|确定的容器的模式。|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|通知容器绑定的属性已更改。|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|若要编辑的属性值的请求权限。|  
|[COleControl::ClientToParent](#clienttoparent)|将相对于控件的原点相对于其容器的原点的点到点转换。|  
|[COleControl::ClipCaretRect](#clipcaretrect)|如果它由控件重叠，则调整脱字号矩形。|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|调用此函数后已更改的处理由控件的助记键集。|  
|[COleControl::DisplayError](#displayerror)|显示对控件的用户的常用的错误事件。|  
|[COleControl::DoClick](#doclick)|常用实现`DoClick`方法。|  
|[COleControl::DoPropExchange](#dopropexchange)|属性进行序列化`COleControl`对象。|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|重绘具有已通过 Windows 控件子类化的 OLE 控件。|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|控件支持简单的帧。|  
|[COleControl::ExchangeExtent](#exchangeextent)|序列化控件的宽度和高度。|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|序列化控件的常用属性。|  
|[COleControl::ExchangeVersion](#exchangeversion)|序列化控件的版本号。|  
|[COleControl::FireClick](#fireclick)|激发 stock`Click`事件。|  
|[COleControl::FireDblClick](#firedblclick)|激发 stock`DblClick`事件。|  
|[COleControl::FireError](#fireerror)|激发 stock`Error`事件。|  
|[COleControl::FireEvent](#fireevent)|触发自定义事件。|  
|[COleControl::FireKeyDown](#firekeydown)|激发 stock`KeyDown`事件。|  
|[COleControl::FireKeyPress](#firekeypress)|激发 stock`KeyPress`事件。|  
|[COleControl::FireKeyUp](#firekeyup)|激发 stock`KeyUp`事件。|  
|[COleControl::FireMouseDown](#firemousedown)|激发 stock`MouseDown`事件。|  
|[COleControl::FireMouseMove](#firemousemove)|激发 stock`MouseMove`事件。|  
|[COleControl::FireMouseUp](#firemouseup)|激发 stock`MouseUp`事件。|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|激发事件时控件的就绪状态更改。|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|更改支持的控件的默认激活行为`IPointerInactive`接口。|  
|[COleControl::GetAmbientProperty](#getambientproperty)|返回指定的环境属性的值。|  
|[COleControl::GetAppearance](#getappearance)|返回的常用的外观属性的值。|  
|[COleControl::GetBackColor](#getbackcolor)|返回常用 BackColor 属性的值。|  
|[COleControl::GetBorderStyle](#getborderstyle)|返回的常用的边框样式属性的值。|  
|[COleControl::GetCapture](#getcapture)|确定无窗口，激活的控件对象是否具有鼠标捕获。|  
|[COleControl::GetClassID](#getclassid)|检索控件的 OLE 类的 ID。|  
|[COleControl::GetClientOffset](#getclientoffset)|检索控件的矩形区域的左上的角和其工作区的左上的角之间的差异。|  
|[COleControl::GetClientRect](#getclientrect)|检索控件的客户端区域的大小。|  
|[COleControl::GetClientSite](#getclientsite)|查询一个对象，用于指向其当前的客户端站点，在其容器内的指针。|  
|[COleControl::GetControlFlags](#getcontrolflags)|检索的控制标志设置。|  
|[COleControl::GetControlSize](#getcontrolsize)|返回的位置和 OLE 控件的大小。|  
|[COleControl::GetDC](#getdc)|提供无窗口控件从其容器获取设备上下文的一种方法。|  
|[COleControl::GetEnabled](#getenabled)|返回 stock Enabled 属性的值。|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|检索指向属于容器的扩展的控件对象的指针。|  
|[COleControl::GetFocus](#getfocus)|确定是否在控件有焦点。|  
|[COleControl::GetFont](#getfont)|返回的常用字体属性的值。|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|返回的度量值`CFontHolder`对象。|  
|[COleControl::GetForeColor](#getforecolor)|返回的常用的前景色属性的值。|  
|[COleControl::GetHwnd](#gethwnd)|返回股票 hWnd 属性的值。|  
|[COleControl::GetMessageString](#getmessagestring)|菜单项中提供的状态栏文本。|  
|[Colecontrol:: Getnotsupported](#getnotsupported)|可防止对控件的属性值由用户的访问。|  
|[COleControl::GetReadyState](#getreadystate)|返回控件的就绪状态。|  
|[COleControl::GetRectInContainer](#getrectincontainer)|返回相对于其容器的控件的矩形。|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|返回的度量值的常用字体属性。|  
|[COleControl::GetText](#gettext)|返回的常用的文本或标题属性的值。|  
|[Colecontrol:: Getwindowlessdroptarget](#getwindowlessdroptarget)|重写以允许无窗口控件并将检索作为目标的拖放操作。|  
|[COleControl::InitializeIIDs](#initializeiids)|通知控件将使用的 Iid 的基类。|  
|[COleControl::InternalGetFont](#internalgetfont)|返回`CFontHolder`常用字体属性的对象。|  
|[COleControl::InternalGetText](#internalgettext)|检索常用的标题或文本属性。|  
|[Colecontrol:: Internalsetreadystate](#internalsetreadystate)|设置控件的就绪状态，并触发就绪状态更改事件。|  
|[COleControl::InvalidateControl](#invalidatecontrol)|使显示的控件，从而导致重绘区域无效。|  
|[COleControl::InvalidateRgn](#invalidatergn)|使给定区域内的容器窗口工作区无效。 可以使用重绘的区域中的无窗口控件。|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|允许 OLE 控件的专用的加载。|  
|[COleControl::IsModified](#ismodified)|确定是否已更改的控件状态。|  
|[Colecontrol:: Isoptimizeddraw](#isoptimizeddraw)|指示容器是否支持当前绘图操作优化的绘制。|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|调用以确定是否控件子类化 Windows 控件。|  
|[COleControl::Load](#load)|重置任何以前的异步数据并启动一个新的控件的异步属性负载。|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|确定是否由容器，可以停用你的控件。|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|更改环境的属性时调用。|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|常用的外观属性更改时调用。|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|常用的 BackColor 属性更改时调用。|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|常用的边框样式属性更改时调用。|  
|[COleControl::OnClick](#onclick)|调用以触发常用 Click 事件。|  
|[COleControl::OnClose](#onclose)|通知控件，`IOleControl::Close`已调用。|  
|[COleControl::OnDoVerb](#ondoverb)|在执行控制谓词后调用。|  
|[COleControl::OnDraw](#ondraw)|当控件请求重绘自身时调用。|  
|[Colecontrol:: Ondrawmetafile](#ondrawmetafile)|当请求控件重绘其自身使用图元文件设备上下文由容器调用。|  
|[COleControl::OnEdit](#onedit)|由 UI 激活容器调用 OLE 控件。|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|股票 Enabled 属性更改时调用。|  
|[COleControl::OnEnumVerbs](#onenumverbs)|由要枚举控制的谓词的容器调用。|  
|[COleControl::OnEventAdvise](#oneventadvise)|当连接或从控件断开连接事件处理程序时调用。|  
|[COleControl::OnFontChanged](#onfontchanged)|常用字体属性更改时调用。|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|常用的前景色属性更改时调用。|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|当冻结或解冻控件的事件时调用。|  
|[COleControl::OnGetColorSet](#ongetcolorset)|通知控件，`IOleObject::GetColorSet`已调用。|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|提供对容器的助记键信息。|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|调用以获取表示属性值的字符串。|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|请求控件的菜单将合并的容器菜单的句的柄。|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|重写以检索控件的显示大小接近的建议的大小和扩展盘区模式。|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|返回表示属性的可能值的字符串。|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|返回对应于预定义的字符串的值。|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|重写以检索 （可用来启用两次绘图） 的控件的显示区域的大小。|  
|[COleControl::OnGetViewRect](#ongetviewrect)|重写以将控件的大小转换为的特定位置开始的矩形。|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|重写以检索控件的视图状态。|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|当控件处于停用的用户界面由容器调用。|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|替代用于具有下鼠标指针调度的非活动控件的容器`WM_MOUSEMOVE`到控件的消息。|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|替代用于具有下鼠标指针调度的非活动控件的容器`WM_SETCURSOR`到控件的消息。|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|在已触发了常用的 KeyDown 事件之后调用。|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|在已触发了常用的 KeyPress 事件之后调用。|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|在已触发了常用的 KeyUp 事件之后调用。|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|指示要用于编辑属性的属性页。|  
|[COleControl::OnMnemonic](#onmnemonic)|当已经按下该控件的助记键时调用。|  
|[COleControl::OnProperties](#onproperties)|当在调用控件的"属性"谓词时调用。|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|控件的显示重叠的给定的点是否重写查询。|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|控件的显示重叠给定矩形中的任何点是否重写查询。|  
|[COleControl::OnRenderData](#onrenderdata)|由框架调用以检索指定的格式中的数据。|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|由框架调用以从指定的格式的文件中检索数据。|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|由框架调用以从指定的格式中的全局内存中检索数据。|  
|[COleControl::OnResetState](#onresetstate)|将控件的属性重置为默认值。|  
|[Colecontrol:: Onsetclientsite](#onsetclientsite)|通知控件，`IOleControl::SetClientSite`已调用。|  
|[COleControl::OnSetData](#onsetdata)|控件的数据替换为另一个值。|  
|[COleControl::OnSetExtent](#onsetextent)|更改控件的大小时后调用。|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|控件的维度具有更改之后调用。|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|当控件已经被 UI 激活时调用。|  
|[COleControl::OnTextChanged](#ontextchanged)|股票文本或标题属性更改时调用。|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|为无窗口控件过程 （而不是鼠标和键盘消息） 的窗口消息。|  
|[COleControl::ParentToClient](#parenttoclient)|将相对于容器的来源，相对于控件的原点的点到点转换。|  
|[COleControl::PostModalDialog](#postmodaldialog)|通知容器模式对话框已关闭。|  
|[COleControl::PreModalDialog](#premodaldialog)|通知即将显示模式对话框的容器。|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|销毁并重新创建该控件的窗口。|  
|[COleControl::Refresh](#refresh)|强制重新绘制的控件的外观。|  
|[COleControl::ReleaseCapture](#releasecapture)|释放鼠标捕获。|  
|[COleControl::ReleaseDC](#releasedc)|释放无窗口控件的容器的显示设备上下文。|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|重置控件窗口的父级。|  
|[COleControl::ResetStockProps](#resetstockprops)|初始化`COleControl`常用为其默认值的属性。|  
|[COleControl::ResetVersion](#resetversion)|初始化为给定值的版本号。|  
|[COleControl::ScrollWindow](#scrollwindow)|允许无窗口控件滚动上显示其处于就地活动映像内的某个区域。|  
|[COleControl::SelectFontObject](#selectfontobject)|选择到设备上下文的自定义的字体属性。|  
|[COleControl::SelectStockFont](#selectstockfont)|选择到设备上下文的常用字体属性。|  
|[COleControl::SerializeExtent](#serializeextent)|序列化或初始化该控件的显示空间。|  
|[COleControl::SerializeStockProps](#serializestockprops)|序列化或初始化`COleControl`常用属性。|  
|[COleControl::SerializeVersion](#serializeversion)|序列化或初始化该控件的版本信息。|  
|[COleControl::SetAppearance](#setappearance)|设置常用的外观属性的值。|  
|[COleControl::SetBackColor](#setbackcolor)|设置常用 BackColor 属性的值。|  
|[COleControl::SetBorderStyle](#setborderstyle)|设置常用的边框样式属性的值。|  
|[COleControl::SetCapture](#setcapture)|将导致该控件的容器窗口，才能拥有鼠标捕获控件的代表。|  
|[COleControl::SetControlSize](#setcontrolsize)|设置的位置和 OLE 控件的大小。|  
|[COleControl::SetEnabled](#setenabled)|设置 stock Enabled 属性的值。|  
|[COleControl::SetFocus](#setfocus)|将导致该控件的容器窗口，才能拥有输入焦点的控件的代表。|  
|[COleControl::SetFont](#setfont)|设置常用字体属性的值。|  
|[COleControl::SetForeColor](#setforecolor)|设置常用的前景色属性的值。|  
|[COleControl::SetInitialSize](#setinitialsize)|设置当第一次显示容器中的 OLE 控件的大小。|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|更改控件的已修改的状态。|  
|[COleControl::SetNotPermitted](#setnotpermitted)|指示编辑请求已失败。|  
|[Colecontrol:: Setnotsupported](#setnotsupported)|禁止到用户控件的属性值的修改。|  
|[COleControl::SetRectInContainer](#setrectincontainer)|设置相对于其容器的控件的矩形。|  
|[COleControl::SetText](#settext)|设置常用的文本或标题属性的值。|  
|[Colecontrol:: Throwerror](#throwerror)|出现错误的 OLE 控件中的通知。|  
|[COleControl::TransformCoords](#transformcoords)|转换坐标容器和控件之间的值。|  
|[COleControl::TranslateColor](#translatecolor)|将转换**OLE_COLOR**值赋给**COLORREF**值。|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|确定是否环境属性将可用在下一步时加载的控件。|  
|[COleControl::WindowProc](#windowproc)|提供有关 Windows 过程`COleControl`对象。|  
  
### <a name="protected-methods"></a>受保护的方法  
  
|名称|描述|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|当控件的外观需要更新时，由框架调用。|  
|[COleControl::DrawMetafile](#drawmetafile)|在使用图元文件设备上下文时，由框架调用。|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|启用自动化方法调用。|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|由框架调用以初始化控件支持的数据格式的列表。|  
  
## <a name="remarks"></a>备注  
 派生自`CWnd`，此类继承的 Windows 窗口对象的所有功能以及其他功能特定于 OLE，如事件触发和支持方法和属性的能力。  
  
 OLE 控件可以插入到 OLE 容器应用程序，以及使用事件激发和公开方法和属性添加到容器的双向系统，与容器进行通信。 请注意，标准 OLE 容器仅支持 OLE 控件的基本功能。 他们将无法支持 OLE 控件的扩展的功能。 当事件被发送到作为某些控件中发生的操作的结果容器时，将出现事件激发。 反过来，容器与控件通过使用一组公开的方法和属性类似于成员函数和数据成员的 c + + 类通信。 此方法允许开发人员可以控制控件的外观和某些操作发生时通知该容器。  
  
## <a name="windowless-controls"></a>无窗口控件  
 OLE 控件可以是无窗口使用处于就地活动状态。 无窗口控件具有明显优势︰  
  
-   无窗口控件可以是透明的并且非矩形  
  
-   无窗口控件减少的对象的实例大小和创建时间  
  
 控件不需要一个窗口。 窗口提供的服务可以轻松通过单个共享的窗口 （通常是容器的） 和的调度代码提供。 具有一个窗口是主要种不必要的复杂性，在对象上。  
  
 当使用无窗口激活时，容器 （它具有一个窗口） 将负责提供服务，否则将由控件自己的窗口提供。 例如，如果你的控件需要查询键盘焦点、 查询鼠标捕获，或获取设备上下文，由容器管理这些操作。 `COleControl`[无窗口操作成员函数](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)调用这些容器上的操作。  
  
 启用无窗口激活后，容器委托输入到控件的消息`IOleInPlaceObjectWindowless`接口 (的扩展[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)无窗口支持)。 `COleControl`相应地调整鼠标坐标后，此接口的实现将调度控件的消息映射，通过这些消息。 你可以通过将对应的条目添加到消息映射来处理普通窗口消息之类的这些消息。  
  
 在无窗口控件中，你应始终使用`COleControl`成员函数而不是相应`CWnd`成员函数或其相关的 Windows API 函数。  
  
 只有当它们变为活动状态，但处于非活动状态活动转换所需的工作量将进入并转换的速度关闭时，OLE 控件对象还可以创建一个窗口。 有某些情况下这是一个问题︰ 作为示例，请考虑文本框中的网格。 当高和调低通过列的指针，每个控件必须是就地激活，然后停用。 非活动/活动转换的速度会直接影响滚动的速度。  
  
 有关开发 OLE 控件 framework 的详细信息，请参阅文章[MFC ActiveX 控件](../../mfc/mfc-activex-controls.md)和[概述︰ 创建 MFC ActiveX 控件程序](../../mfc/reference/mfc-activex-control-wizard.md)。 有关信息优化 OLE 控件，包括无窗口和闪烁控件，请参阅[MFC ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>要求  
 **标头︰** afxctl.h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 返回环境 BackColor 属性的值。  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>返回值  
 容器的环境 BackColor 属性，如果任何当前值。 如果不支持的属性，此函数将返回系统定义的 Windows 背景色。  
  
### <a name="remarks"></a>备注  
 环境 BackColor 属性可供所有控件，并定义由容器。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 向用户显示的错误消息中，可以使用容器已分配给控件的名称。  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>返回值  
 OLE 控件的名称。 默认值为零长度字符串。  
  
### <a name="remarks"></a>备注  
 请注意该容器不需要支持此属性。  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 返回环境字体属性的值。  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>返回值  
 指向容器的环境字体调度接口的指针。 默认值是**NULL**。 如果返回值不等于**NULL**，你将负责字体释放通过调用其[iunknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317)成员函数。  
  
### <a name="remarks"></a>备注  
 环境字体属性是定义由容器并可供所有控件。请注意该容器不需要支持此属性。  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 返回环境前景色属性的值。  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>返回值  
 容器的环境前景色属性，如果任何当前值。 如果不支持，此函数将返回的系统定义的 Windows 文本颜色。  
  
### <a name="remarks"></a>备注  
 环境的前景色属性可供所有控件，并定义由容器。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientlocaleid"></a>Colecontrol:: Ambientlocaleid  
 返回容器的区域设置 id。  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>返回值  
 容器的 LocaleID 属性，如果任何值。 如果不支持此属性，则此函数将返回 0。  
  
### <a name="remarks"></a>备注  
 该控件可以使用 LocaleID 以适应特定区域设置其用户界面。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 检索控件对象的当前外观设置。  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>返回值  
 控件的外观︰  
  
- **0**平面外观  
  
- **1** 3D 外观  
  
### <a name="remarks"></a>备注  
 调用此函数可检索的当前值**DISPID_AMBIENT_APPEARANCE**控件的属性。  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 返回容器使用的单位类型。  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>返回值  
 包含容器环境 ScaleUnits 的字符串。 如果不支持此属性，则此函数将返回一个零长度字符串。  
  
### <a name="remarks"></a>备注  
 容器的环境 ScaleUnits 属性可以用于显示位置或维度，用选定的单元，如缇或厘米标记。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 确定容器是否允许要为其自身活动时显示抓取手柄的控件。  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>返回值  
 如果应显示抓取手柄; 则为非 0否则为 0。 如果不支持此属性，则此函数将返回非零值。  
  
### <a name="remarks"></a>备注  
 请注意该容器不需要支持此属性。  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 确定容器是否允许控件以将它显示与阴影模式用户界面活动。  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>返回值  
 如果应显示阴影的模式; 则为非 0否则为 0。 如果不支持此属性，则此函数将返回非零值。  
  
### <a name="remarks"></a>备注  
 请注意该容器不需要支持此属性。  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 确定首选通过控件容器的环境的文本对齐方式。  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>返回值  
 容器的环境 TextAlign 属性的状态。 如果不支持此属性，则此函数将返回 0。  
  
 以下是有效的返回值的列表︰  
  
|返回值|含义|  
|------------------|-------------|  
|0|常规的对齐方式 （数字转换为左侧的右侧，文本）。|  
|1|左对齐|  
|2|居中|  
|3|右对齐|  
  
### <a name="remarks"></a>备注  
 此属性可供所有嵌入的控件，并定义由容器。 请注意该容器不需要支持此属性。  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 确定容器是否想要响应用户界面操作的控件。  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>返回值  
 如果控件应响应用户界面操作; 则为非 0否则为 0。 如果不支持此属性，则此函数将返回 0。  
  
### <a name="remarks"></a>备注  
 例如，容器可能设置为**TRUE**在设计模式下。  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 确定是否容器是在设计模式或用户模式。  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>返回值  
 如果容器是在用户模式，则为非零否则为 0 （在设计模式下）。 如果不支持此属性，则此函数将返回 TRUE。  
  
### <a name="remarks"></a>备注  
 例如，容器可能设置为**FALSE**在设计模式下。  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 绑定的属性值已更改的通知。  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 控件的绑定属性的调度 ID。  
  
### <a name="remarks"></a>备注  
 这必须每次属性更改，甚至在其中通过属性不进行了更改的情况下的值设置方法时调用。 请特别注意映射到成员变量的绑定属性。 任何时候，此类成员变量更改，`BoundPropertyChanged`必须调用。  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 请求权限从`IPropertyNotifySink`接口来更改该控件提供的绑定的属性值。  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 控件的绑定属性的调度 ID。  
  
### <a name="return-value"></a>返回值  
 如果允许此更改; 则为非 0否则为 0。 默认值为非零值。  
  
### <a name="remarks"></a>备注  
 如果权限被拒绝，控件必须不允许属性更改的值。 这可以通过忽略或失败试图更改属性值的操作。  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 将转换的坐标`pPoint`成父坐标。  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 于容器内的 OLE 控件的边界的指针。 不是工作区但包括边框和滚动条整个控件的区域。  
  
 `pPoint`  
 指向要转换为父 （容器） 的坐标的 OLE 客户端区域点的指针。  
  
### <a name="remarks"></a>备注  
 在输入`pPoint`是相对于源的 OLE 控件 （左上角的控件的客户端区域） 的客户端区域。 输出`pPoint`是相对于父 （左上角的容器） 的源。  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 如果它完全或部分涵盖重叠、 不透明的对象，请调整脱字号矩形。  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 在输入指向的指针[RECT](../../mfc/reference/rect-structure1.md)结构，其中包含要进行调整的插入符号区域。 在输出时，调整后的插入符号区域中，或**NULL**如果完全覆盖的插入符号矩形。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 脱字号位于闪烁的行、 块或通常指示文本或图形将插入的位图。  
  
 无窗口对象无法安全地显示插入符号不首先检查是否脱字号部分或完全隐藏的重叠对象。 为了实现这一点，可以使用对象`ClipCaretRect`以获取插入符号调整 （缩小） 以确保其适合大小的剪辑区域。  
  
 创建插入符号的对象应提交的插入符号矩形`ClipCaretRect`和为插入符号使用调整后的矩形。 如果脱字号完全处于隐藏状态，则此方法将返回**FALSE**并且脱字号应不会显示在所有在此情况下。  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 构造 `COleControl` 对象。  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>备注  
 通常不直接调用此函数。 改为 OLE 控件通常会创建由其类工厂。  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 已更改的支持的控件的助记键集时，请调用此函数。  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>备注  
 在收到此通知，控件的容器获取新的助记键集通过调用[IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730)。 请注意，该容器不需要对此通知做出响应。  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 常用的错误事件已进行了处理 （除非事件处理程序已禁止显示的错误） 后，由框架调用。  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>参数  
 *scode*  
 要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件︰ 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `lpszDescription`  
 正在报告的错误的说明。  
  
 *lpszSource*  
 生成错误 （通常情况下，OLE 控件模块的名称） 模块的名称。  
  
 `lpszHelpFile`  
 包含错误的描述的帮助文件的名称。  
  
 `nHelpID`  
 正在报告的错误的帮助上下文 ID。  
  
### <a name="remarks"></a>备注  
 默认行为显示包含错误中, 包含的说明的消息框`lpszDescription`。  
  
 重写此函数可自定义错误的显示方式。  
  
##  <a name="doclick"></a>COleControl::DoClick  
 模拟鼠标单击控件上的操作。  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>备注  
 可重写`COleControl::OnClick`将调用成员函数，和常用 Click 事件将触发，如果控件支持。  
  
 此函数支持通过`COleControl`作为常用方法，调用 DoClick 基类。 有关详细信息，请参阅文章[ActiveX 控件︰ 方法](../../mfc/mfc-activex-controls-methods.md)。  
  
##  <a name="dopropexchange"></a>COleControl::DoPropExchange  
 由框架在加载或存储某个控件从持久性存储区表示形式，如一组流或属性时调用。  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 指向的指针`CPropExchange`对象。 框架提供了此对象以建立属性交换，包括其方向的上下文。  
  
### <a name="remarks"></a>备注  
 使用此功能通常可以调用**PX_**系列函数以加载或存储的 OLE 控件的特定用户定义属性。  
  
 如果控件向导用于创建 OLE 控件项目，此函数的重写的版本将序列化支持的常用属性`COleControl`通过调用基类函数， `COleControl::DoPropExchange`。 将用户定义的属性添加到您的 OLE 控件将需要修改此函数可序列化新属性。 在序列化的详细信息，请参阅文章[ActiveX 控件︰ 序列化](../../mfc/mfc-activex-controls-serializing.md)。  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 重绘具有已通过 Windows 控件子类化的 OLE 控件。  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 指向控件容器的设备上下文的指针。  
  
 `rcBounds`  
 控件将在其中绘制区域。  
  
### <a name="remarks"></a>备注  
 调用此函数可正确处理的非活动的 OLE 控件的绘制。 应仅使用此函数，如果 OLE 控制 Windows 控件的子类，且应调用`OnDraw`函数的控件。  
  
 此函数和子类化 Windows 控件的详细信息，请参阅文章[ActiveX 控件︰ 子类化 Windows 控件](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)。  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 当控件的外观需要更新时，由框架调用。  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 指向设备上下文的指针。  
  
 `rc`  
 要绘制的矩形区域。  
  
### <a name="remarks"></a>备注  
 此函数直接调用可重写`OnDraw`函数。  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 在使用图元文件设备上下文时，由框架调用。  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 到图元文件设备上下文的指针。  
  
 `rc`  
 要绘制的矩形区域。  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 启用 OLE 控件的简单的框架特性。  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>备注  
 这种特性允许控件支持的其他控件的可视包容但事实并非如此 OLE 包含。 示例将具有几个控件内的组框。 这些控件不是 OLE 包含，但它们可以在同一组框中。  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 序列化或初始化的控件的范围内的状态 (在其尺寸**HIMETRIC**单位)。  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 指向的指针[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象。 框架提供了此对象以建立属性交换，包括其方向的上下文。  
  
### <a name="return-value"></a>返回值  
 如果该函数成功，则非零否则为 0。  
  
### <a name="remarks"></a>备注  
 通常通过的默认实现调用此函数`COleControl::DoPropExchange`。  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 序列化或初始化的控件的常用属性的状态。  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 指向的指针[CPropExchange](../../mfc/reference/cpropexchange-class.md)对象。 框架提供了此对象以建立属性交换，包括其方向的上下文。  
  
### <a name="remarks"></a>备注  
 通常通过的默认实现调用此函数`COleControl::DoPropExchange`。  
  
##  <a name="exchangeversion"></a>COleControl::ExchangeVersion  
 序列化或初始化的控件的版本信息的状态。  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `pPX`  
 指向的指针`CPropExchange`对象。 框架提供了此对象以建立属性交换，包括其方向的上下文。  
  
 `dwVersionDefault`  
 控件的当前版本号。  
  
 `bConvert`  
 指示是否应将持久性数据转换为最新格式保存，或在加载了相同的格式中维护时。  
  
### <a name="return-value"></a>返回值  
 非零的成功，则该函数否则为 0。  
  
### <a name="remarks"></a>备注  
 通常情况下，这将是第一个函数调用的控件的重写`COleControl::DoPropExchange`。 在加载时，此函数读取版本数永久性的数据，并设置的版本属性[CPropExchange](../../mfc/reference/cpropexchange-class.md)相应对象。 保存时，此函数会写入持久性数据的版本号。  
  
 持久性和版本控制的详细信息，请参阅文章[ActiveX 控件︰ 序列化](../../mfc/mfc-activex-controls-serializing.md)。  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 鼠标单击通过活动控件时由框架调用。  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 用于自动触发的单击事件发生，该控件的事件映射必须具有常用 Click 事件定义。  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 鼠标位于双击活动控件上方时，由框架调用。  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 用于自动触发的 DblClick 事件发生，该控件的事件映射必须具有定义的常用 DblClick 事件。  
  
##  <a name="fireerror"></a>COleControl::FireError  
 触发常用的错误事件。  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>参数  
 *scode*  
 要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件︰ 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `lpszDescription`  
 正在报告的错误的说明。  
  
 `nHelpID`  
 报告的错误的帮助 ID。  
  
### <a name="remarks"></a>备注  
 此事件提供一种正在发出信号，在适当的位置，在代码中，在控件内发生错误。 与其他常用事件，如 Click 或 MouseMove，不同错误永远不会引发由框架中。  
  
 若要报告属性 get 函数、 属性 set 函数或自动化方法过程中发生的错误，调用[colecontrol:: Throwerror](#throwerror)。  
  
 OLE 控件的 Stock 错误事件使用的实现`SCODE`值。 如果你的控件使用此事件，并且用于在 Visual Basic 4.0 中使用，则会出现错误，因为`SCODE`在 Visual Basic 中不支持值。  
  
 若要解决此问题，手动更改`SCODE`中控件的参数。ODL 文件**长**。 此外，任何自定义事件、 方法或属性，它使用`SCODE`参数也会导致相同的问题。  
  
##  <a name="fireevent"></a>COleControl::FireEvent  
 引发包含任意数量的可选自变量，控件中的用户定义事件。  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 要激发的事件调度 ID。  
  
 `pbParams`  
 事件的参数类型描述符。  
  
### <a name="remarks"></a>备注  
 通常应不直接调用此函数。 相反，您将控件的类声明的事件映射节中调用的事件触发函数。  
  
 `pbParams`自变量是空格分隔的列表**VTS_**。 其中一个或多个值（由空格（而不是逗号）分隔）指定函数的参数列表。 可能的值如下：  
  
|符号|参数类型|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  为所有变体类型，除定义其他变体常量**VTS_FONT**和**VTS_PICTURE**，提供指向各种不同的数据常量的指针。 使用命名这些常量**VTS_P** `constantname`约定。 例如， **VTS_PCOLOR**是一个指向**VTS_COLOR**常量。  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 当控件处于活动状态的 UI，按下某个键时，由框架调用。  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `pnChar`  
 为虚拟键代码值的按下的键的指针。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 对于 KeyDown 事件发生后自动触发，控件的事件映射必须具有定义的常用 KeyDown 事件。  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 当按下某个键并将其释放时自定义控件位于 UI 活动容器内时，由框架调用。  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>参数  
 `pnChar`  
 指向所按的键的字符值的指针。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 事件的接收方可能会修改`pnChar`，例如，将所有小写字符转换为大写形式。 如果你想要检查修改后的字符，重写`OnKeyPressEvent`。  
  
 用于自动触发的 KeyPress 事件发生，该控件的事件映射必须具有定义的常用 KeyPress 事件。  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 当在容器中，自定义控件处于 UI 活动状态时松开某个键时，由框架调用。  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `pnChar`  
 指向已发布的键的虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 用于自动触发的 KeyUp 事件发生，该控件的事件映射必须具有定义的常用 KeyUp 事件。  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 通过活动的自定义控件按下鼠标按钮时，由框架调用。  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>参数  
 `nButton`  
 按下鼠标按钮的数字值。 它可以包含以下值之一︰  
  
- **LEFT_BUTTON**按下鼠标左键了。  
  
- **MIDDLE_BUTTON**按下鼠标中键了。  
  
- **RIGHT_BUTTON**按下鼠标右键按钮了。  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
 *x*  
 光标时按下鼠标按钮了 x 坐标。 相对于控件窗口的左上角的坐标。  
  
 *y*  
 当按下鼠标按钮了鼠标指针指针 y 坐标。 相对于控件窗口的左上角的坐标。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 对于 MouseDown 事件发生后自动触发，控件的事件映射必须具有定义的常用 MouseDown 事件。  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 当光标移到活动的自定义控件，由框架调用。  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>参数  
 `nButton`  
 按下鼠标按钮的数字值。 包含以下值的组合︰  
  
- **LEFT_BUTTON**操作期间按下鼠标左键了。  
  
- **MIDDLE_BUTTON**操作期间按下鼠标中键了。  
  
- **RIGHT_BUTTON**操作期间按下鼠标右键按钮了。  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
 *x*  
 光标 x 坐标。 相对于控件窗口的左上角的坐标。  
  
 *y*  
 光标 y 坐标。 相对于控件窗口的左上角的坐标。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 对于 MouseMove 事件发生后自动触发，控件的事件映射必须具有定义的常用 MouseMove 事件。  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 当在活动的自定义控件上释放鼠标按钮时，由框架调用。  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>参数  
 `nButton`  
 释放鼠标按钮的数值。 它可以具有以下值之一︰  
  
- **LEFT_BUTTON**已松开了鼠标按钮。  
  
- **MIDDLE_BUTTON**已松开了鼠标按钮。  
  
- **RIGHT_BUTTON**已松开了鼠标右键按钮。  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
 *x*  
 光标时已松开鼠标按钮 x 坐标。 相对于控件窗口的左上角的坐标。  
  
 *y*  
 当已松开鼠标按钮，鼠标指针指针 y 坐标。 相对于控件窗口的左上角的坐标。  
  
### <a name="remarks"></a>备注  
 如果此事件定义为自定义事件，你可以确定何时激发事件。  
  
 对于 MouseUp 事件发生后自动触发，控件的事件映射必须具有定义的常用 MouseUp 事件。  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 一个与控件的就绪状态的当前值的事件的激发。  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>备注  
 就绪状态可以是以下值之一︰  
  
 **READYSTATE_UNINITIALIZED**  
 默认初始化状态  
  
 **READYSTATE_LOADING**  
 控件当前正在加载其属性  
  
 **READYSTATE_LOADED**  
 初始化控件  
  
 **READYSTATE_INTERACTIVE**  
 控件具有足够的数据进行交互，但不是所有异步数据尚未加载  
  
 `READYSTATE_COMPLETE`  
 控件具有其所有数据  
  
 使用[GetReadyState](#getreadystate)以确定控件的当前准备情况。  
  
 [InternalSetReadyState](#internalsetreadystate)就绪状态更改为值提供，则调用`FireReadyStateChange`。  
  
##  <a name="getactivationpolicy"></a>COleControl::GetActivationPolicy  
 更改支持的控件的默认激活行为`IPointerInactive`接口。  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>返回值  
 中的标志的组合**POINTERINACTIVE**枚举。 可能的标志包括︰  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 该对象应是就地激活时鼠标进入它在鼠标移动操作过程。  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 在鼠标移动操作过程中鼠标离开对象时，应停用该对象。  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 该对象应就地激活期间拖动鼠标拖到它时，删除操作。  
  
### <a name="remarks"></a>备注  
 当`IPointerInactive`启用接口，容器将委托`WM_SETCURSOR`和`WM_MOUSEMOVE`到它的消息。 `COleControl`相应地调整鼠标坐标后，此接口的实现将调度控件的消息映射，通过这些消息。  
  
 每当容器接收`WM_SETCURSOR`或`WM_MOUSEMOVE`与鼠标指针放在处于非活动状态的对象支持的消息`IPointerInactive`，则应调用`GetActivationPolicy`上的接口和从返回标志**POINTERINACTIVE**枚举。  
  
 你可以通过将对应的条目添加到消息映射来处理普通窗口消息，就像这些消息。 在您的处理程序，应避免使用`m_hWnd`成员变量 （或使用它的任何成员函数） 但未事先检查，其值非**NULL**。  
  
 任何对象用于执行多个设置鼠标光标和/或激发鼠标移动事件，如同时提供特殊可视反馈，应返回**POINTERINACTIVE_ACTIVATEONENTRY**标志，并绘制活动时仅的反馈。 容器如果对象返回此标志，应立即将其在就地激活，然后将其转发触发对的调用，同一消息`GetActivationPolicy`。  
  
 如果这两个**POINTERINACTIVE_ACTIVATEONENTRY**和**POINTERINACTIVE_DEACTIVATEONLEAVE**返回标志，然后在鼠标位于对象时，仅被激活对象。 如果仅**POINTERINACTIVE_ACTIVATEONENTRY**返回标志，然后将其鼠标首先进入对象后，仅将激活对象。  
  
 您可能还要不活动的控件是 OLE 拖目标和删除操作。 这要求用户将对象拖动到它，此时激活控件，以便可以将该控件的窗口注册为放置目标。 若要使能够在拖动过程进行激活，返回**POINTERINACTIVE_ACTIVATEONDRAG**标志︰  
  
 [!code-cpp[NVC_MFCAxCtl # 1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 信息由传递`GetActivationPolicy`不应由容器缓存。 相反，每次鼠标进入非活动状态的对象，则应调用此方法。  
  
 如果不请求处于非活动状态的对象不是就地激活时鼠标进入它，则其容器应调度后续`WM_SETCURSOR`到通过调用此对象的消息[OnInactiveSetCursor](#oninactivesetcursor) ，只要鼠标指针悬停在对象上保持。  
  
 启用`IPointerInactive`接口通常表示你希望控件，使其能够在所有时间处理鼠标消息。 若要在不支持容器中获取此行为`IPointerInactive`接口，你将需要使控件始终激活时可见，这意味着该控件应具有**OLEMISC_ACTIVATEWHENVISIBLE**之间其杂项标志的标志。 但是，若要防止此标志从生效容器中，支持`IPointerInactive`，还可以指定**OLEMISC_IGNOREACTIVATEWHENVISIBLE**标志︰  
  
 [!code-cpp[NVC_MFCAxCtl # 10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl::GetAmbientProperty  
 获取容器的环境属性的值。  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>参数  
 *dwDispid*  
 所需的环境属性的调度 ID。  
  
 `vtProp`  
 指定要在中返回的值的类型的变量类型标记`pvProp`。  
  
 `pvProp`  
 指向的地址将接收的属性值或返回值的变量的指针。 此指针的实际类型必须与由指定的类型匹配`vtProp`。  
  
|vtProp|PvProp 的类型|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**短\***|  
|`VT_I4`|**长\***|  
|`VT_R4`|**float\***|  
|`VT_R8`|**双精度\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>返回值  
 如果支持则环境的属性; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 如果你使用`GetAmbientProperty`若要检索的环境的 DisplayName 和 ScaleUnits 属性，设置`vtProp`到`VT_BSTR`和`pvProp`到**CString\***。 如果你在检索环境字体属性，设置`vtProp`到**VT_FONT**和`pvProp`到**LPFONTDISP\***。  
  
 请注意，函数已为提供了常见的环境属性，如[AmbientBackColor](#ambientbackcolor)和[AmbientFont](#ambientfont)。  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 实现控件的常用外观属性的 Get 函数。  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>返回值  
 返回值指定为当前的外观设置**短**( `VT_I2`) 值，如果成功。 如果控件的外观会平面和 1，如果控件的外观会三维，则此值为零。  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 实现控件的常用 BackColor 属性的 Get 函数。  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>返回值  
 返回值指定为当前的背景色**OLE_COLOR**值，如果成功。 此值可以转换为**COLORREF**值通过调用`TranslateColor`。  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 实现控件的常用的边框样式属性的 Get 函数。  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>返回值  
 如果控件具有正常边框; 则为 1如果控件具有没有边框，则为 0。  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 确定是否`COleControl`对象具有鼠标捕获。  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>返回值  
 如果该控件已激活并无窗口，将返回**这**如果控件当前具有鼠标捕获 （如由控件的容器），或**NULL**如果它不具有捕获。  
  
 否则，返回`CWnd`具有鼠标捕获的对象 (与相同`CWnd::GetCapture`)。  
  
### <a name="remarks"></a>备注  
 激活的无窗口控件接收到鼠标捕获时[SetCapture](#setcapture)调用。  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 由框架调用以检索的控件的 OLE 类 ID。  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>参数  
 *pclsid*  
 指向的位置的类 id。  
  
### <a name="return-value"></a>返回值  
 如果调用未成功，则非零否则为 0。  
  
### <a name="remarks"></a>备注  
 通常由实施[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)。  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 检索控件的矩形区域的左上的角和其工作区的左上的角之间的差异。  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>参数  
 *pdxOffset*  
 指向 OLE 控件的工作区的水平偏移量的指针。  
  
 *pdyOffset*  
 指向 OLE 控件的工作区的垂直偏移量的指针。  
  
### <a name="remarks"></a>备注  
 OLE 控件具有在其容器内的矩形区域。 控件的客户端区域是不包括边框和滚动条的控件区域。 偏移量检索`GetClientOffset`是控件的矩形区域的左上的角和其工作区的左上的角之间的差异。 如果控件具有非客户端元素而非标准的边框和滚动条，重写该成员函数以指定偏移量。  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 检索控件的客户端区域的大小。  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向`RECT`结构，它包含无窗口控件的客户端区域的尺寸; 即，该控件的大小减去窗口边框、 帧、 滚动条和等等。 `lpRect`参数指示该控件的客户端矩形，而非其位置的大小。  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 查询一个对象，用于指向其当前的客户端站点，在其容器内的指针。  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>返回值  
 指向控件的当前客户端站点中其容器的指针。  
  
### <a name="remarks"></a>备注  
 返回的指针指向的实例`IOleClientSite`。 `IOleClientSite`由容器实现的接口是其上下文对象的视图︰ 其中定位在文档中，其中它将获取其存储、 用户界面和其他资源。  
  
##  <a name="getcontrolflags"></a>COleControl::GetControlFlags  
 检索的控制标志设置。  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>返回值  
 ControlFlags 枚举中的标志且组合︰  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>备注  
 默认情况下，`GetControlFlags`返回`fastBeginPaint | clipPaintDC`。  
  
 `fastBeginPaint`  
 如果设置，使用开始绘制函数定制而不是 OLE 控件的[BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) （默认设置） 的 API。  
  
 `clipPaintDC`  
 如果未设置，禁用对的调用`IntersectClipRect`由`COleControl`并获得小的速度优势。 如果使用无窗口激活，则该标志无效。  
  
 `pointerInactive`  
 如果设置，提供鼠标交互，而你的控件处于非活动状态的通过启用`COleControl`的实现`IPointerInactive`接口，默认处于禁用状态。  
  
 `noFlickerActivate`  
 如果设置，无需额外绘制操作和伴随的可视闪烁。 当控件绘制本身相同处于非活动和活动状态时使用。 如果使用无窗口激活，则该标志无效。  
  
 `windowlessActivate`  
 如果设置，则表示你的控件使用无窗口激活。  
  
 `canOptimizeDraw`  
 如果设置，则表示该控件将执行优化的绘图，如果容器支持它。  
  
 有关详细信息`GetControlFlags`和其他优化 OLE 控件，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 检索 OLE 控件窗口的大小。  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>参数  
 *pcx*  
 以像素为单位指定控件的宽度。  
  
 *pcy*  
 以像素为单位指定控件的高度。  
  
### <a name="remarks"></a>备注  
 请注意，用于控制 windows 的所有坐标相对于控件的左上角。  
  
##  <a name="getdc"></a>COleControl::GetDC  
 从其容器为无窗口对象提供到 get 的屏幕 （或兼容） 的设备上下文。  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>参数  
 *lprcRect*  
 无窗口控件的矩形的指针想要在工作区坐标的控件重绘。 **NULL**意味着将整个对象的范围。  
  
 `dwFlags`  
 绘制的设备上下文的属性。 选项有︰  
  
- **OLEDC_NODRAW**指示该对象不会使用的设备上下文以执行任何绘图，但只使获取有关显示设备的信息。 容器应只需将窗口的 DC 传递而不会进一步处理。  
  
- **OLEDC_PAINTBKGND**请求容器在返回 DC 之前绘制背景。 如果它为请求 DC 重绘带有透明背景的区域，对象应使用此标志。  
  
- **OLEDC_OFFSCREEN**通知对象想要将呈现到屏幕之外的位图，然后复制到屏幕的容器。 一个对象应使用此标志，当它即将执行绘制操作生成大量的闪烁。 容器可以自由地或不接受此请求。 但是，如果未设置此标志，容器必须退回屏幕 DC。 这允许对象执行直接屏幕操作，例如显示所选内容 (通过**XOR**操作)。  
  
### <a name="return-value"></a>返回值  
 容器的显示设备上下文的指针`CWnd`工作区成功; 否则为返回的值是否**NULL**。 显示设备上下文可以在后续的 GDI 函数中，用于在容器的窗口的工作区中进行绘制。  
  
### <a name="remarks"></a>备注  
 [ReleaseDC](#releasedc)必须调用成员函数来绘制后释放上下文。 在调用时`GetDC`，对象将传递客户想要在其自己的客户端坐标中进行绘制到的矩形。 `GetDC`将转换到的容器的工作区的坐标。 该对象应该不会请求所需的绘制矩形大于其自己的客户端区域矩形，可以使用检索的大小[GetClientRect](#getclientrect)。 这可以防止无意中绘制其中它们不应为对象。  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 实现控件的 stock Enabled 属性的 Get 函数。  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>返回值  
 如果已启用该控件; 则为非 0否则为 0。  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 获取指向由表示使用扩展的一组属性的控件的容器维护的对象的指针。  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>返回值  
 指向容器的扩展控件对象。 如果没有可用的对象，则值是**NULL**。  
  
 此对象可能通过操作其`IDispatch`接口。 你还可以使用`QueryInterface`获取对象提供的其他可用接口。 但是，该对象不需要支持一组特定的接口。 请注意，依赖于容器的扩展的控件对象的特定功能限制到其他任意容器控件的可移植性。  
  
### <a name="remarks"></a>备注  
 调用此函数的函数负责释放时已完成，但该对象的指针。 请注意该容器不需要支持此对象。  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 确定是否`COleControl`对象具有焦点。  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>返回值  
 如果该控件已激活并无窗口，将返回**这**如果控件当前已经有键盘焦点 （如由控件的容器），或**NULL**如果它不具有焦点。  
  
 否则，返回`CWnd`具有焦点的对象 (与相同`CWnd::GetFocus`)。  
  
### <a name="remarks"></a>备注  
 激活的无窗口控件接收到焦点时[SetFocus](#setfocus)调用。  
  
##  <a name="getfont"></a>COleControl::GetFont  
 实现常用字体属性的 Get 函数。  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>返回值  
 给控件的常用字体属性的字体调度接口指针。  
  
### <a name="remarks"></a>备注  
 请注意，调用方必须释放对象时完成。 在控件的实现，使用`InternalGetFont`访问控件的常用字体对象。 使用控件中的字体的详细信息，请参阅文章[ActiveX 控件︰ 在 ActiveX 控件中使用的字体](../../mfc/mfc-activex-controls-using-fonts.md)。  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 测量的文本度量值的任何`CFontHolder`控件所拥有的对象。  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>参数  
 `lptm`  
 指向[TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132)结构。  
  
 `fontHolder`  
 引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象。  
  
### <a name="remarks"></a>备注  
 可以使用选择这种字体[COleControl::SelectFontObject](#selectfontobject)函数。 `GetFontTextMetrics`将初始化`TEXTMETRIC`指向结构`lptm`包含的有效度量值信息`fontHolder`的字体如果成功，或如果不成功，用零填充结构。 应使用此函数，而不是[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)时绘制控件，因为控件，像任何嵌入 OLE 对象，可能需要将自身呈现到图元文件。  
  
 `TEXTMETRIC`结构的默认字体是刷新时[SelectFontObject](#selectfontobject)调用函数。 应调用`GetFontTextMetrics`唯一有效选择常用的字体属性，以确保它提供的信息后。  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 实现的 Get 函数中的常用的前景色属性。  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>返回值  
 返回值指定为当前前的景色**OLE_COLOR**值，如果成功。 此值可以转换为[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)值通过调用`TranslateColor`。  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 实现常用 hWnd 属性的 Get 函数。  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>返回值  
 OLE 控件的窗口句柄，如果任何;否则为**NULL**。  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 由框架获取描述由标识的菜单项的目的的短字符串调用`nID`。  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>参数  
 `nID`  
 菜单项 id。  
  
 `rMessage`  
 对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)通过返回的字符串对象。  
  
### <a name="remarks"></a>备注  
 这可以用于获取在状态栏中显示一条消息，在突出显示时的菜单项。 默认实现尝试加载标识的字符串资源`nID`。  
  
##  <a name="getnotsupported"></a>Colecontrol:: Getnotsupported  
 可防止对控件的属性值由用户的访问。  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>备注  
 调用此函数来代替任何属性的 Get 函数检索由控件的用户的属性不支持的位置。 一个示例是只写的属性。  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 返回控件的就绪状态。  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>返回值  
 就绪状态为该控件，下列值之一︰  
  
 **READYSTATE_UNINITIALIZED**  
 默认初始化状态  
  
 **READYSTATE_LOADING**  
 控件当前正在加载其属性  
  
 **READYSTATE_LOADED**  
 初始化控件  
  
 **READYSTATE_INTERACTIVE**  
 控件具有足够的数据进行交互，但不是所有异步数据尚未加载  
  
 `READYSTATE_COMPLETE`  
 控件具有其所有数据  
  
### <a name="remarks"></a>备注  
 大多数简单控件永远不需要区分**LOADED**和`INTERACTIVE`。 但是，支持数据路径属性的控件可能不是准备好进行交互，直到异步接收至少部分数据。 控件应尝试尽可能快地变为交互模式。  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 获取相对于容器，以设备的单位表示的控件的矩形的坐标。  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向控件的坐标将复制到其中的矩形结构的指针。  
  
### <a name="return-value"></a>返回值  
 如果控件是处于就地活动状态; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 仅在该矩形时有效如果控件是处于就地活动状态。  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 测量控件的常用字体属性，这可以使用选择的文本指标[SelectStockFont](#selectstockfont)函数。  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>参数  
 `lptm`  
 指向的指针[TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132)结构。  
  
### <a name="remarks"></a>备注  
 `GetStockTextMetrics`函数将初始化`TEXTMETRIC`指向结构`lptm`与有效的度量值信息如果成功或填充零，如果不成功的结构。 使用此函数，而不是[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)时绘制控件，因为控件，像任何嵌入 OLE 对象，可能需要将自身呈现到图元文件。  
  
 `TEXTMETRIC`结构的默认字体是刷新时`SelectStockFont`调用函数。 仅后选择的常用字体，以确保它提供的信息无效，应调用此函数。  
  
##  <a name="gettext"></a>COleControl::GetText  
 实现常用的文本或标题属性的 Get 函数。  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>返回值  
 控件文本字符串或零长度字符串，如果不有任何字符串的当前值。  
  
> [!NOTE]
>  有关详细信息`BSTR`数据类型，请参阅[数据类型](../../mfc/reference/data-types-mfc.md)宏和全局函数部分中。  
  
### <a name="remarks"></a>备注  
 请注意，必须调用此函数的调用方`SysFreeString`对字符串返回以便免费资源。 在控件的实现，使用`InternalGetText`访问控件的常用的文本或标题属性。  
  
##  <a name="getwindowlessdroptarget"></a>Colecontrol:: Getwindowlessdroptarget  
 重写`GetWindowlessDropTarget`时您希望无窗口控件的目标的 ole 拖放操作。  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>返回值  
 指向对象的指针`IDropTarget`接口。 由于它不具有一个窗口，无窗口对象无法注册`IDropTarget`接口。 但是，若要参与拖放，无窗口对象仍可实现接口，以及返回在`GetWindowlessDropTarget`。  
  
### <a name="remarks"></a>备注  
 通常，这需要将该控件的窗口注册为放置目标。 但由于该控件没有自己的窗口，以容器将使用自己的窗口作为放置目标。 在控件只需要提供的一个实现`IDropTarget`接口到容器可以委托调用在适当的时间。 例如：  
  
 [!code-cpp[NVC_MFCAxCtl # 2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 通知控件将使用的 Iid 的基类。  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>参数  
 *piidPrimary*  
 指向控件的主要的调度接口的接口 ID 的指针。  
  
 *piidEvents*  
 指向控件的事件接口的接口 ID 的指针。  
  
### <a name="remarks"></a>备注  
 在控件的构造函数，以通知的接口 Id 将使用你的控件的基本类中调用此函数。  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 访问你的控件的常用字体属性  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>返回值  
 对引用[CFontHolder](../../mfc/reference/cfontholder-class.md)包含常用字体对象的对象。  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 访问控件的常用的文本或标题属性。  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>返回值  
 控件文本字符串的引用。  
  
##  <a name="internalsetreadystate"></a>Colecontrol:: Internalsetreadystate  
 设置控件的就绪状态。  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>参数  
 *lNewReadyState*  
 要设置进行控制，下列值之一的就绪状态︰  
  
 **READYSTATE_UNINITIALIZED**  
 默认初始化状态  
  
 **READYSTATE_LOADING**  
 控件当前正在加载其属性  
  
 **READYSTATE_LOADED**  
 初始化控件  
  
 **READYSTATE_INTERACTIVE**  
 控件具有足够的数据进行交互，但不是所有异步数据尚未加载  
  
 `READYSTATE_COMPLETE`  
 控件具有其所有数据  
  
### <a name="remarks"></a>备注  
 大多数简单控件永远不需要区分**LOADED**和`INTERACTIVE`。 但是，支持数据路径属性的控件可能不是准备好进行交互，直到异步接收至少部分数据。 控件应尝试尽可能快地变为交互模式。  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 强制控件重绘自己。  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向要失效的控件区域的指针。  
  
 `bErase`  
 指定是否处理更新区域时要消除更新区域内的背景。  
  
### <a name="remarks"></a>备注  
 如果`lpRect`具有**NULL**值，将重新绘制整个控件。 如果`lpRect`不**NULL**，这表示控件的矩形的是无效的部分。 在其中控件没有窗口中，或当前处于非活动状态，矩形将忽略，并且调用客户端站点的情况下[IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337)成员函数。 使用此函数，而不是`CWnd::InvalidateRect`或`InvalidateRect`。  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 使给定区域内的容器窗口工作区无效。  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `pRgn`  
 指向的指针[CRgn](../../mfc/reference/crgn-class.md)标识要使其无效，在包含窗口的工作区坐标的 OLE 对象的显示区域的对象。 如果此参数为**NULL**，范围是整个对象。  
  
 `bErase`  
 指定是否要消除失效区域内的背景。 如果**TRUE**，后台被擦除。 如果**FALSE**，后台保持不变。  
  
### <a name="remarks"></a>备注  
 这可用来重绘容器内的无窗口控件。 无效的区域，以及所有其他区域中的更新区域中，标记为绘制时的下一步[WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213)发送消息。  
  
 如果`bErase`是**TRUE**更新区域的任何部分，清除整个区域，而不仅仅是在给定的部分中中的背景。  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 允许 OLE 控件的专用的加载。  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>返回值  
 如果控件正在转换; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 当转换使用 VBX 的窗体控件添加到另一个使用 OLE 控件时，OLE 控件的特殊加载代码可能需要。 例如，如果要加载的 OLE 控件实例，则可能必须调用[PX_Font](persistence-of-ole-controls.md#px_font)中你`DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl # 3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 但是，将 VBX 控件没有字体的对象;已单独保存每个字体属性。 在这种情况下，将使用`IsConvertingVBX`来区分这两种情况︰  
  
 [!code-cpp[NVC_MFCAxCtl # 4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 另一个的情况下将为你将 VBX 控件如果保存专有的二进制数据 (在其**VBM_SAVEPROPERTY**消息处理程序)，并 OLE 控件将其二进制数据保存在另一种格式。 如果你想要在你 OLE 控制与 VBX 控件向后兼容，无法读取使用的这两种旧的和新格式`IsConvertingVBX`函数进行区分是否将 VBX 控件或 OLE 控件正在加载了。  
  
 在控件的`DoPropExchange`函数，你可以检查此条件并如果为 true，执行特定于此转换 （如前面的示例中） 的负载代码。 如果不转换控件，你可以执行的正常负载代码。 此功能仅适用于正在转换 VBX 对应项的控件。  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 启用自动化方法调用。  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>返回值  
 如果控件已初始化; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 框架的实现**idispatch:: Invoke**调用**IsInvokeAllowed**以确定给定函数 (由标识`dispid`) 可以调用。 OLE 控件的默认行为是允许仅当控件已初始化; 要调用自动化方法但是， **IsInvokeAllowed**是虚拟函数，可以被重写如有必要 （例如，当控件使用作为自动化服务器时）。 有关详细信息，请参阅知识库文章 Q166472，"如何︰ 使用作为自动化服务器的 OLE 控件。" 知识库文章位于[http://support.microsoft.com](http://support.microsoft.com/)。  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 确定控件的状态是否已被修改。  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>返回值  
 如果自上次保存; 控件的状态后经过修改则不为否则为 0。  
  
### <a name="remarks"></a>备注  
 属性更改值时，则修改控件的状态。  
  
##  <a name="isoptimizeddraw"></a>Colecontrol:: Isoptimizeddraw  
 确定容器是否支持当前绘图操作优化的绘制。  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>返回值  
 **TRUE**如果容器支持优化绘制当前绘图操作; 否则为**FALSE**。  
  
### <a name="remarks"></a>备注  
 如果支持优化的绘制，则然后控件需要未选择旧对象 （钢笔、 画笔、 字体、 等） 到设备上下文完成绘制。  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 由框架调用以确定是否控件子类化 Windows 控件。  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>返回值  
 如果该控件进行了子类化; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 你必须重写此函数并返回**TRUE**如果你 OLE 控制子类 Windows 控件。  
  
##  <a name="load"></a>COleControl::Load  
 重置异步加载的任何以前的数据，并启动新加载的控件的异步属性。  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>参数  
 *strNewPath*  
 指向包含引用异步控件属性的绝对位置的路径的字符串的指针。  
  
 *prop*  
 A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)实现异步控件属性的对象。  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 防止容器停用你的控件。  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>参数  
 `bLock`  
 **TRUE**处于就地活动状态的控件是否被锁定;**FALSE**是否要取消锁定它。  
  
### <a name="return-value"></a>返回值  
 如果锁成功; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 请注意必须与控件完成解锁成对每个控件的锁定。 你应仅锁定控件短，如触发事件时。  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 容器的环境属性已更改值时由框架调用。  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>参数  
 *dispID*  
 发生更改时，环境属性的调度 ID 或**DISPID_UNKNOWN**如果多个属性已发生更改。  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 常用的外观属性值更改时由框架调用。  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>备注  
 如果你想要在此属性更改后的通知，重写此函数。 默认实现调用`InvalidateControl`。  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 股票 BackColor 属性值更改时由框架调用。  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>备注  
 如果你想要在此属性更改后的通知，重写此函数。 默认实现调用`InvalidateControl`。  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 常用的边框样式属性值更改时由框架调用。  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`InvalidateControl`。  
  
 如果你想要在此属性更改后的通知，重写此函数。  
  
##  <a name="onclick"></a>COleControl::OnClick  
 单击鼠标按钮后，或已调用 DoClick 股票方法时，由框架调用。  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>参数  
 *iButton*  
 鼠标按钮的索引。 可以具有以下值之一︰  
  
- **LEFT_BUTTON**被单击鼠标左键。  
  
- **MIDDLE_BUTTON**单击了鼠标按钮。  
  
- **RIGHT_BUTTON**鼠标右键按钮被单击。  
  
### <a name="remarks"></a>备注  
 默认实现调用`COleControl::FireClick`。  
  
 重写该成员函数以修改或扩展默认的处理。  
  
##  <a name="onclose"></a>COleControl::OnClose  
 在容器已调用该控件时由框架调用**IOleControl::Close**函数。  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>参数  
 `dwSaveOption`  
 该标志指示是否应在加载前保存对象。 有效值为：  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>备注  
 默认情况下，`OnClose`保存控件对象，如果已修改和`dwSaveOption`是`OLECLOSE_SAVEIFDIRTY`或`OLECLOSE_PROMPTSAVE`。  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 当容器调用时由框架调用**IOleObject::DoVerb**成员函数。  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `iVerb`  
 要调用中控制谓词的索引。  
  
 `lpMsg`  
 指向导致要调用的谓词的 Windows 消息的指针。  
  
 `hWndParent`  
 控件的父窗口句柄。 如果该谓词的执行将创建一个窗口 （或 windows），`hWndParent`应使用与父项。  
  
 `lpRect`  
 指向的坐标，该控件，相对于容器，将复制到其中的 RECT 结构的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现使用`ON_OLEVERB`和`ON_STDOLEVERB`消息映射条目以确定要调用的适当函数。  
  
 重写此函数可更改的默认处理的谓词。  
  
##  <a name="ondraw"></a>COleControl::OnDraw  
 由框架调用以在使用指定的设备上下文的指定边界矩形中绘制 OLE 控件。  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 在其中绘制发生的设备上下文。  
  
 `rcBounds`  
 控件，包括边框的矩形区域。  
  
 `rcInvalid`  
 无效的控件的矩形区域。  
  
### <a name="remarks"></a>备注  
 `OnDraw`通常用于屏幕显示，将传递作为屏幕设备上下文调用`pDC`。 `rcBounds`参数标识 （相对于其当前的映射模式） 的目标设备上下文中的矩形。 `rcInvalid`参数是无效的实际矩形。 在某些情况下，这将是比较小的区域`rcBounds`。  
  
##  <a name="ondrawmetafile"></a>Colecontrol:: Ondrawmetafile  
 由框架调用以在使用指定的图元文件设备上下文的指定边界矩形中绘制 OLE 控件。  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 在其中绘制发生的设备上下文。  
  
 `rcBounds`  
 控件，包括边框的矩形区域。  
  
### <a name="remarks"></a>备注  
 默认实现调用[OnDraw](#ondraw)函数。  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 导致要激活的 UI 控件。  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpMsg`  
 指向调用此谓词的 Windows 消息的指针。  
  
 `hWndParent`  
 控件的父窗口的句柄。  
  
 `lpRect`  
 指向由容器中控件的矩形的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 此操作调用控件的相同效果`OLEIVERB_UIACTIVATE`谓词。  
  
 此函数通常用作的处理程序函数`ON_OLEVERB`消息映射条目。 这使"编辑"谓词出现在控件的"对象"菜单。 例如：  
  
 [!code-cpp[NVC_MFCAxCtl # 5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 股票 Enabled 属性值已更改时由框架调用。  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>备注  
 如果你想要在此属性更改后的通知，重写此函数。 默认实现调用[InvalidateControl](#invalidatecontrol)。  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 当容器调用时由框架调用**ioleobject:: Enumverbs**成员函数。  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>参数  
 `ppenumOleVerb`  
 指向的指针**IEnumOLEVERB**枚举控制的谓词的对象。  
  
### <a name="return-value"></a>返回值  
 如果谓词可用; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现枚举`ON_OLEVERB`中的消息映射条目。  
  
 重写此函数可更改枚举谓词的默认方式。  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 连接到或断开 OLE 控件的事件处理程序时，由框架调用。  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>参数  
 `bAdvise`  
 **TRUE**指示事件处理程序已连接到控件。 **FALSE**指示从控件断开连接事件处理程序。  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 常用字体属性值更改时由框架调用。  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`COleControl::InvalidateControl`。 如果该控件进行子类化 Windows 控件，还会发送默认实现**WM_SETFONT**消息发送到控件的窗口。  
  
 如果你想要在此属性更改后的通知，重写此函数。  
  
### <a name="example"></a>示例  
 [!code-cpp[NVC_MFCAxCtl # 6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 常用的前景色属性值更改时由框架调用。  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`InvalidateControl`。  
  
 如果你想要在此属性更改后的通知，重写此函数。  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 在容器调用由框架调用**IOleControl::FreezeEvents**。  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>参数  
 `bFreeze`  
 **TRUE**如果控件的事件处理即处于冻结; 否则为**FALSE**。  
  
### <a name="remarks"></a>备注  
 默认实现不执行任何操作。  
  
 重写此函数，如果冻结或解冻事件处理时，你需要额外的行为。  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 当容器调用时由框架调用**IViewObject::GetColorSet**成员函数。  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>参数  
 `ptd`  
 指向以图应呈现为其目标设备。 如果此值为**NULL**，应为默认目标设备，通常显示设备呈现图。  
  
 `hicTargetDev`  
 指示的目标设备上指定的信息上下文`ptd`。 此参数可以是设备上下文，但不是一定。 If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  
  
 *ppColorSet*  
 指向的一组将使用的颜色应复制到其中的位置的指针。 如果该函数不返回颜色组中， **NULL**返回。  
  
### <a name="return-value"></a>返回值  
 如果返回有效的颜色集; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 容器调用此函数可获取绘制 OLE 控件所需的所有颜色。 容器可以使用获取它需要设置总体调色板的颜色与结合使用的颜色集。 默认实现返回**FALSE**。  
  
 重写此函数可执行此请求的任何特殊处理。  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 当控件的容器已请求有关控件的信息时，由框架调用。  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>参数  
 `pControlInfo`  
 指向[CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734)结构填充的。  
  
### <a name="remarks"></a>备注  
 此信息主要由控件的助记键的说明。 默认实现填充`pControlInfo`与默认信息。  
  
 如果你的控件需要处理助记键，重写此函数。  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 由框架获取表示由标识的属性的当前值的字符串调用`dispid`。  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `strValue`  
 对引用[CString](../../atl-mfc-shared/reference/cstringt-class.md)通过返回的字符串对象。  
  
### <a name="return-value"></a>返回值  
 如果已在返回的字符串则为非 0 *strValue;*否则为 0。  
  
### <a name="remarks"></a>备注  
 如果控件具有其值不能直接转换为字符串属性，并且你想要在容器提供的属性浏览器中显示的属性的值，重写此函数。  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 在控件位于 UI 激活以获取要合并到容器的现有菜单的菜单时由框架调用。  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>返回值  
 控件的菜单的句柄或**NULL**如果控件有无。 默认实现返回**NULL**。  
  
### <a name="remarks"></a>备注  
 合并 OLE 资源的详细信息，请参阅文章[菜单和资源 (OLE)](../../mfc/menus-and-resources-ole.md)。  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 由以响应容器的框架调用**IViewObjectEx::GetNaturalExtent**请求。  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 指定要如何表示该对象。 表示形式之间实现包括内容、 图标、 一个缩略图或打印的文档。 有效的值，将从枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 *索引*  
 是感兴趣的对象的部分。 当前仅为-1 是有效的。  
  
 `ptd`  
 指向[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)结构定义目标设备应返回对象的大小。  
  
 `hicTargetDev`  
 指定由目标设备的信息上下文`ptd`参数对象可以从中提取设备量度并测试设备的功能。 如果`ptd`是**NULL**，该对象应忽略中的值`hicTargetDev`参数。  
  
 *pExtentInfo*  
 指向**DVEXTENTINFO**结构，它指定大小调整数据。 **DVEXTENTINFO**结构是︰  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 结构成员`dwExtentMode`可以采用两个值之一︰  
  
- **DVEXTENT_CONTENT** Inquire 多大的控件应以完全适应内容 （管理单元大小）  
  
- **DVEXTENT_INTEGRAL**在调整大小时，将建议的大小传递给控件  
  
 `psizel`  
 指向以调整大小由控件返回数据。 返回的大小调整数据设置为-1 表示不调整任何维度。  
  
### <a name="return-value"></a>返回值  
 如果成功返回，或调整大小; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 重写此函数可返回对象的显示大小接近中建议的大小和范围模式**DVEXTENTINFO**结构。 默认实现返回**FALSE**并不使任何调整大小。  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 由框架调用以获取一组预定义的字符串表示一个属性的可能值。  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `pStringArray`  
 一个字符串数组中用来填充返回的值。  
  
 `pCookieArray`  
 A`DWORD`要使用返回值填充数组。  
  
### <a name="return-value"></a>返回值  
 如果已将元素添加到非零`pStringArray`和`pCookieArray`。  
  
### <a name="remarks"></a>备注  
 如果控件具有具有一组可由字符串表示的可能值的属性，重写此函数。 每个元素添加到`pStringArray`，应添加到相应的"cookie"元素*pCookieArray。* 更高版本可在这些"cookie"值传递到框架`COleControl::OnGetPredefinedValue`函数。  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 由框架来获取对应于一个预定义的重写之前返回的字符串的值调用`COleControl::OnGetPredefinedStrings`。  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `dwCookie`  
 以前的重写通过返回的 cookie 值`COleControl::OnGetPredefinedStrings`。  
  
 `lpvarOut`  
 指向**VARIANT**结构通过返回的属性值。  
  
### <a name="return-value"></a>返回值  
 如果已在返回的值则为非 0 `lpvarOut`; 否则为 0。  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 由以响应容器的框架调用[IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032)请求。  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>参数  
 *dwDrawAspect*  
 `DWORD`描述哪个窗体或方面，对象的将用来显示。 有效的值，将从枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 *索引*  
 是感兴趣的对象的部分。 当前仅为-1 是有效的。  
  
 `ptd`  
 指向[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)结构定义目标设备应返回对象的大小。  
  
 *lpsizel*  
 指向将返回对象的大小的位置。  
  
### <a name="return-value"></a>返回值  
 如果成功返回扩展盘区信息; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 如果你的控件使用双步绘图，并且其不透明和透明部件具有不同维度，重写此函数。  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 由以响应容器的框架调用**IViewObjectEx::GetRect**请求。  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 `DWORD`描述哪个窗体或方面，对象的将用来显示。 有效的值，将从枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**:  
  
- `DVASPECT_CONTENT`整个对象的绑定矩形。 在对象的源和大小等于由扩展盘区的左上角**GetViewExtent***。*  
  
- **DVASPECT_OPAQUE**具有矩形不透明区域的对象返回该矩形。 其他失败。  
  
- **DVASPECT_TRANSPARENT**矩形涵盖所有透明的或异常部分。  
  
 `pRect`  
 指向[RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907)结构，它指定应在其中绘制对象的矩形。 此参数控制的位置和延伸的对象。  
  
### <a name="return-value"></a>返回值  
 如果成功返回的大小调整为该对象的矩形; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 对象的大小来转换`OnGetViewRect`在一个矩形的 （默认为显示左上的角） 的特定位置开始。 如果你的控件使用双步绘图，并且其不透明和透明部件具有不同维度，重写此函数。  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 由以响应容器的框架调用**IViewObjectEx::GetViewStatus**请求。  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>返回值  
 值之一**VIEWSTATUS**枚举如果成功; 否则为 0。 可能的值是以下任意组合︰  
  
 **VIEWSTATUS_OPAQUE**  
 对象是完全不透明的。 如果未设置此位，该对象包含透明的部分。 此位仅适用于与内容相关的方面和无关`DVASPECT_ICON`或`DVASPECT_DOCPRINT`。  
  
 **VIEWSTATUS_SOLIDBKGND**  
 对象具有纯色背景 （包含在纯色，而非画笔图案）。 此位是有意义才**VIEWSTATUS_OPAQUE**设置，并且仅适用于与内容相关的方面和无关`DVASPECT_ICON`或`DVASPECT_DOCPRINT`。  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 对象支持**DVASPECT_OPAQUE**。 所有**IViewObjectEx**进行绘制的方面，因为可以使用此方面调用参数的方法。  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 对象支持**DVASPECT_TRANSPARENT**。 所有**IViewObjectEx**进行绘制的方面，因为可以使用此方面调用参数的方法。  
  
### <a name="remarks"></a>备注  
 如果你的控件使用两次绘图，重写此函数。 默认实现返回**VIEWSTATUS_OPAQUE**。  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 停用的 UI 控件时由框架调用。  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>备注  
 实现应隐藏所有工具栏显示`OnShowToolbars`。  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 通过将鼠标指针悬停在收到下面的非活动对象的容器调用`WM_MOUSEMOVE`消息。  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 边界矩形，包含窗口的工作区坐标中的对象。 在屏幕上其确切的位置和大小告知对象时`WM_MOUSEMOVE`已接收到消息。  
  
 *x*  
 包含窗口工作区坐标中的鼠标位置的 x 坐标。  
  
 *y*  
 包含窗口工作区坐标中的鼠标位置的 y 坐标。  
  
 `dwKeyState`  
 标识键盘修改键键盘上的当前状态。 有效的值可以是任何标志的组合**MK_CONTROL**， **MK_SHIFT**， **MK_ALT**， **MK_BUTTON**， **MK_LBUTTON**， **MK_MBUTTON**，和**MK_RBUTTON**。  
  
### <a name="remarks"></a>备注  
 请注意，用于将鼠标光标位置传递窗口工作区坐标 （像素）。 这可通过还将相同的坐标系统中传递的对象的边框。  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 通过将鼠标指针悬停在收到下面的非活动对象的容器调用`WM_SETCURSOR`消息。  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 边界矩形，包含窗口的工作区坐标中的对象。 在屏幕上其确切的位置和大小告知对象时`WM_SETCURSOR`已接收到消息。  
  
 *x*  
 包含窗口工作区坐标中的鼠标位置的 x 坐标。  
  
 *y*  
 包含窗口工作区坐标中的鼠标位置的 y 坐标。  
  
 *dwMouseMsg*  
 为其鼠标消息的标识符`WM_SETCURSOR`发生。  
  
 *bSetAlways*  
 指定对象必须将光标放置。 如果**TRUE**，对象必须将光标放置; 如果**FALSE**，光标没有义务将光标放置，并应返回**S_FALSE**在这种情况下。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 请注意，用于将鼠标光标位置传递窗口工作区坐标 （像素）。 这可通过还将相同的坐标系统中传递的对象的边框。  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 处理的常用的 KeyDown 事件后，由框架调用。  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `nChar`  
 按下的键虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果你的控件需要访问密钥信息后激发事件，重写此函数。  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 由框架调用后激发 KeyPress 事件的库存。  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>参数  
 `nChar`  
 包含所按的键的虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
### <a name="remarks"></a>备注  
 请注意，`nChar`值可能已被修改的容器。  
  
 如果你想要通知，此事件发生后，重写此函数。  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 处理的常用的 KeyDown 事件后，由框架调用。  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>参数  
 `nChar`  
 按下的键虚拟键代码值。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
 `nShiftState`  
 包含的以下标志的组合︰  
  
- **SHIFT_MASK**在操作过程中曾按下 SHIFT 键。  
  
- **CTRL_MASK**操作期间曾按下 CTRL 键。  
  
- **ALT_MASK**操作期间曾按下 ALT 键。  
  
### <a name="remarks"></a>备注  
 如果你的控件需要访问密钥信息后激发事件，重写此函数。  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 由框架调用以获取实现编辑指定属性的属性页的类 ID。  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>参数  
 `dispid`  
 该控件的属性的调度 ID。  
  
 `lpclsid`  
 指向**CLSID**结构通过返回的类 ID。  
  
 *pbPageOptional*  
 返回是否使用指定的属性页是可选的指示器。  
  
### <a name="return-value"></a>返回值  
 如果返回的类 ID 后中则不为`lpclsid`; 否则为 0。  
  
### <a name="remarks"></a>备注  
 重写此函数可提供一种方法来调用从容器的属性浏览器控件的属性页。  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 容器已检测到已经按下 OLE 控件的助记键时，由框架调用。  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>参数  
 `pMsg`  
 一个指针，指向由助记键按键操作生成的 Windows 消息。  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 当容器调用控件的属性谓词时，由框架调用。  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpMsg`  
 指向调用此谓词的 Windows 消息的指针。  
  
 `hWndParent`  
 控件的父窗口的句柄。  
  
 `lpRect`  
 指向由容器中控件的矩形的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现显示模式属性对话框。  
  
 此函数还可用于导致控件的属性页的显示。 调用`OnProperties`函数，传递中的控件的父级的句柄`hWndParent`参数。 在此例中的值`lpMsg`和`lpRect`参数将被忽略。  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 由以响应容器的框架调用**IViewObjectEx::QueryHitPoint**请求。  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 指定对象的表示方式。 有效的值，将从枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 `pRectBounds`  
 指向`RECT`结构，它指定的 OLE 控件工作区的边框。  
  
 `ptlLoc`  
 指向**点**结构，它指定要检查的一次点击的点。 OLE 客户端区域坐标中指定的点。  
  
 `lCloseHint`  
 定义"关闭"到点检查一次点击的距离。  
  
 `pHitResult`  
 指向命中查询的结果。 以下值之一：  
  
- **HITRESULT_OUTSIDE** `ptlLoc`是外部 OLE 对象并不会关闭。  
  
- **HITRESULT_TRANSPARENT** *ptlLoc*是否在边界的 OLE 对象，但不是接近映像内。 例如，可能是中间透明圆点**HITRESULT_TRANSPARENT**。  
  
- **HITRESULT_CLOSE** `ptlLoc`内部或外部 OLE 对象但近到足以要被视为内部的对象。 小型、 精简，或详细对象可以使用此值。 即使点位于外部的边界矩形的对象，它可能仍然会关闭 （这所需达到小对象）。  
  
- **HITRESULT_HIT** `ptlLoc`内的对象的映像。  
  
### <a name="return-value"></a>返回值  
 如果成功返回命中的结果; 则为非 0否则为 0。 命中数是与 OLE 控件显示区域重叠。  
  
### <a name="remarks"></a>备注  
 查询对象的显示矩形是否与给定的点重叠 （命中点）。 `QueryHitPoint`可以重写以测试命中非矩形的对象。  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 由以响应容器的框架调用**IViewObjectEx::QueryHitRect**请求。  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>参数  
 `dwAspect`  
 指定要如何表示该对象。 有效的值，将从枚举[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 `pRectBounds`  
 指向`RECT`结构，它指定的 OLE 控件工作区的边框。  
  
 *prcLoc*  
 指向`RECT`结构，它指定要检查的命中 （与对象矩形的重叠），相对于该对象的左上角的矩形。  
  
 `lCloseHint`  
 未使用。  
  
 `pHitResult`  
 指向命中查询的结果。 以下值之一：  
  
- **HITRESULT_OUTSIDE**在矩形中的没有点命中由 OLE 对象。  
  
- **HITRESULT_HIT**在矩形中的至少一个点是在对象上的命中。  
  
### <a name="return-value"></a>返回值  
 如果成功返回命中的结果; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 查询对象的显示矩形是否与给定矩形中的任何点 （命中矩形） 重叠。 `QueryHitRect`可以重写以测试命中非矩形的对象。  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 由框架调用以检索指定的格式中的数据。  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定在其中请求信息的格式。  
  
 `lpStgMedium`  
 指向[STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)是用要返回的数据的结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 指定的格式是以前放置在控件对象使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成员函数被延迟呈现的。 此函数的默认实现调用`OnRenderFileData`或`OnRenderGlobalData`分别，如果提供的存储介质是文件或内存。 如果请求的格式是`CF_METAFILEPICT`或将持久性属性设置格式，默认实现呈现适当的数据，并返回非零值。 否则为它返回 0，且不执行任何操作。  
  
 如果*lpStgMedium-> tymed*是**TYMED_NULL**、 **STGMEDIUM**应分配和指定的填充*lpFormatEtc-> tymed*。 如果不是**TYMED_NULL**、 **STGMEDIUM**应填充了具有数据的位置。  
  
 重写此函数可提供的请求的格式和介质中的数据。 具体取决于你的数据，你可能想要改为重写此函数的其他版本之一。 如果你的数据较小，而且固定大小，重写`OnRenderGlobalData`。 如果你的数据是在文件中，或者是大小可变的重写`OnRenderFileData`。  
  
 有关详细信息，请参阅**FORMATETC**和**STGMEDIUM**结构中[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 由框架调用以检索指定的格式中的数据，当存储媒体文件。  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定在其中请求信息的格式。  
  
 `pFile`  
 指向[CFile](../../mfc/reference/cfile-class.md)对象是用要呈现的数据。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 指定的格式是以前放置在控件对象使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延迟呈现的成员函数。 此函数的默认实现只返回**FALSE**。  
  
 重写此函数可提供的请求的格式和介质中的数据。 具体取决于你的数据，你可能想要改为重写此函数的其他版本之一。 如果你想要处理多个存储媒介，重写`OnRenderData`。 如果你的数据是在文件中，或者是大小可变的重写`OnRenderFileData`。  
  
 有关详细信息，请参阅**FORMATETC**结构[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 由框架调用以检索指定的格式中的数据时指定的存储介质是全局内存。  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定在其中请求信息的格式。  
  
 `phGlobal`  
 指向全局内存在其中的数据是要返回的句柄。 如果已不分配任何内存，此参数可以为**NULL**。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 指定的格式是以前放置在控件对象使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延迟呈现的成员函数。 此函数的默认实现只返回**FALSE**。  
  
 如果`phGlobal`是**NULL**，然后新`HGLOBAL`应分配，并且在返回`phGlobal`。 否则为`HGLOBAL`指定的`phGlobal`应已填满数据。 数据量置于`HGLOBAL`不能超过内存块的当前大小。 此外，块不能重新分配给了更大的大小。  
  
 重写此函数可提供的请求的格式和介质中的数据。 具体取决于你的数据，你可能想要改为重写此函数的其他版本之一。 如果你想要处理多个存储媒介，重写`OnRenderData`。 如果你的数据是在文件中，或者是大小可变的重写`OnRenderFileData`。  
  
 有关详细信息，请参阅**FORMATETC**结构[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onresetstate"></a>COleControl::OnResetState  
 控件的属性应设置为其默认值时，由框架调用。  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用[DoPropExchange](#dopropexchange)，并传递`CPropExchange`导致属性设置为其默认值的对象。  
  
 控件的编写器可以在此插入初始化代码的 OLE 控件可重写。 时，将调用此函数[IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568)或[ipersiststorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557)失败，或[IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234)或[IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194)调用，而不是第一个调用**IPersistStream::Load**或**ipersiststorage:: Load**。  
  
##  <a name="onsetclientsite"></a>Colecontrol:: Onsetclientsite  
 在容器已调用该控件时由框架调用**IOleControl::SetClientSite**函数。  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>备注  
 默认情况下，`OnSetClientSite`检查是否加载数据路径属性，并且如果它们是，调用`DoDataPathPropExchange`。  
  
 重写此函数可执行此通知任何特殊处理。 具体而言，此函数的重写应调用的基类。  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 由框架调用以将控件的数据替换为指定的数据。  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>参数  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)结构，它指定的数据格式。  
  
 `lpStgMedium`  
 指向[STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)结构中的数据位于其中。  
  
 `bRelease`  
 **TRUE**如果控件应释放的存储介质;**FALSE**如果控件不应释放的存储介质。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 如果数据的持久性属性中设置格式，默认实现将相应地修改控件的状态。 否则，默认实现将执行执行任何操作。 如果`bRelease`是**TRUE**，然后调用**ReleaseStgMedium**进行; 否则为 not。  
  
 重写此函数可将控件的数据替换为指定的数据。  
  
 有关详细信息，请参阅**FORMATETC**和**STGMEDIUM**结构中[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 当控件的大小时需要因调用而更改时由框架调用[IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330)。  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>参数  
 `lpSizeL`  
 指向的指针**为原始大小**使用长整数来表示的宽度和高度中表示的控件的结构**HIMETRIC**单位。  
  
### <a name="return-value"></a>返回值  
 如果已接受了大小更改; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现处理控件的扩展盘区的大小调整。 如果控件是处于就地活动状态，对容器的调用**OnPosRectChanged**然后进行。  
  
 重写此函数可更改你的控件的默认大小调整。  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 由框架来实现对的调用调用[IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767)。  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>参数  
 *lpRectPos*  
 指向，该值指示控件的新的位置和大小相对于容器 RECT 结构的指针。  
  
 `lpRectClip`  
 指向的指针`RECT`，该值指示控件是以剪切的矩形区域的结构。  
  
### <a name="return-value"></a>返回值  
 如果重新定位已接受; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 默认实现自动处理重新定位和控件窗口的调整大小，并返回**TRUE**。  
  
 重写此函数可改变此函数的默认行为。  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 当控件已经被激活的用户界面时，由框架调用。  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>备注  
 默认实现不执行任何操作。  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 常用的标题或文本属性值更改时由框架调用。  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>备注  
 默认实现调用`InvalidateControl`。  
  
 如果你想要在此属性更改后的通知，重写此函数。  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 由以响应容器的框架调用**IOleInPlaceObjectWindowless::OnWindowMessage**请求。  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>参数  
 `msg`  
 所传递的 Windows 消息的标识符。  
  
 `wParam`  
 所传递的 Windows。 指定消息特定的附加信息。 此参数的内容依赖于的值`msg`参数。  
  
 `lParam`  
 所传递的 Windows。 指定消息特定的附加信息。 此参数的内容依赖于的值`msg`参数。  
  
 *plResult*  
 Windows 结果代码。 指定的消息处理的结果，并且依赖于发送的消息。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 处理无窗口控件的窗口消息。 `COleControl``OnWindowlessMessage`应使用的窗口消息以外鼠标消息和键盘消息。 `COleControl`提供[SetCapture](#setcapture)和[SetFocus](#setfocus)专门用于获取无窗口 OLE 对象的鼠标捕获和键盘焦点。  
  
 无窗口对象不具有一个窗口，因为它们需要一种机制，让它们的容器调度消息。 无窗口的 OLE 对象从其容器中，获取消息通过`OnWindowMessage`方法`IOleInPlaceObjectWindowless`接口 (的扩展[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)无窗口支持)。 `OnWindowMessage`不采用`HWND`参数。  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 将转换的坐标`pPoint`成工作区坐标。  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>参数  
 `lprcBounds`  
 于容器内的 OLE 控件的边界的指针。 不是工作区但包括边框和滚动条整个控件的区域。  
  
 `pPoint`  
 至父项 （容器） 的指针指向要转换为控件的客户端区域的坐标。  
  
 `bHitTest`  
 指定的命中测试进行点上。  
  
### <a name="return-value"></a>返回值  
 如果`bHitTest`是**FALSE**，返回**HTNOWHERE**。 如果`bHitTest`是**TRUE**、 返回父 （容器） 的点的位置登录到 OLE 控件的客户端区域和命中测试值是以下鼠标之一︰  
  
- **HTBORDER**在一个窗口，其中没有大小调整边框的边框。  
  
- **HTBOTTOM**在窗口的较低水平边框。  
  
- **HTBOTTOMLEFT**窗口边框的左下角。  
  
- **HTBOTTOMRIGHT**窗口边框的右下角。  
  
- **HTCAPTION**标题栏区域中。  
  
- **HTCLIENT**工作区中。  
  
- **HTERROR**屏幕背景上或在 windows 之间的分隔线上 (与相同**HTNOWHERE**只不过**DefWndProc** Windows 函数生成系统播放提示音以指示错误)。  
  
- **HTGROWBOX**大小框中。  
  
- **HTHSCROLL**水平滚动条中。  
  
- **HTLEFT**中窗口的左边框。  
  
- **HTMAXBUTTON**中最大化按钮。  
  
- **HTMENU**菜单区域中。  
  
- **HTMINBUTTON**中最小化按钮。  
  
- **HTNOWHERE**屏幕背景上或在 windows 之间的分隔线上。  
  
- **HTREDUCE**中最小化按钮。  
  
- **HTRIGHT**在窗口的右边框。  
  
- **HTSIZE**在大小中 (与相同**HTGROWBOX**)。  
  
- **HTSYSMENU**控件菜单中或在子窗口中的关闭按钮。  
  
- **HTTOP**在窗口的右上水平边框。  
  
- **HTTOPLEFT**窗口边框的左上角。  
  
- **HTTOPRIGHT**窗口边框的右上角。  
  
- **HTTRANSPARENT**当前受另一个窗口的窗口中。  
  
- **HTVSCROLL**垂直滚动条中。  
  
- **HTZOOM**中最大化按钮。  
  
### <a name="remarks"></a>备注  
 在输入`pPoint`是相对于父 （左上角的容器） 的源。 输出`pPoint`是相对于源的 OLE 控件 （左上角的控件的客户端区域） 的客户端区域。  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 通知容器模式对话框已关闭。  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>参数  
 `hWndParent`  
 模式对话框的父窗口的句柄。  
  
### <a name="remarks"></a>备注  
 在显示任何模式对话框后调用此函数。 您必须调用此函数，以便容器可以启用禁用的任何顶级窗口`PreModalDialog`。 此函数应通过调用配对`PreModalDialog`。  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 通知即将显示模式对话框的容器。  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>参数  
 `hWndParent`  
 模式对话框的父窗口的句柄。  
  
### <a name="remarks"></a>备注  
 显示任何模式对话框之前调用此函数。 您必须调用此函数，以便容器可以禁用所有顶级窗口。 已显示模式对话框后，必须调用`PostModalDialog`。  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 销毁并重新创建该控件的窗口。  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>备注  
 这可能有必要，如果你需要更改窗口的样式位。  
  
##  <a name="refresh"></a>COleControl::Refresh  
 会强行 OLE 控件重绘。  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>备注  
 此函数支持通过`COleControl`基类作为调用刷新的常用方法。 这允许 OLE 控件的用户重绘窗体控件在特定时间。 此方法的详细信息，请参阅文章[ActiveX 控件︰ 方法](../../mfc/mfc-activex-controls-methods.md)。  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 释放鼠标捕获。  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 如果控件当前具有鼠标捕获，则释放捕获。 否则，此函数不起任何作用。  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 释放无窗口控件，从而使其他应用程序使用的设备上下文的容器的显示设备上下文。  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 标识要释放的容器设备上下文。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 应用程序必须调用`ReleaseDC`每次调用[GetDC](#getdc)。  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 设置控件的父级。  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>参数  
 *hWndOuter*  
 控件窗口的句柄。  
  
 `hWndParent`  
 新的父窗口的句柄。  
  
### <a name="remarks"></a>备注  
 调用此函数可重置控件窗口的父级。  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 初始化的状态`COleControl`常用为其默认值的属性。  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>备注  
 属性是︰ 外观、 背景色、 边框样式、 标题、 已启用、 字体、 前景色，hWnd 和文本。 常用属性的说明，请参阅[ActiveX 控件︰ 添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。  
  
 你可以通过使用提高控件的二进制初始化性能`ResetStockProps`和`ResetVersion`重写`COleControl::OnResetState`。 请参见下面的示例。 有关优化初始化的进一步信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
### <a name="example"></a>示例  
 [!code-cpp[NVC_MFCAxCtl # 7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 初始化为指定值的版本号。  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>参数  
 `dwVersionDefault`  
 要分配给控件的版本号。  
  
### <a name="remarks"></a>备注  
 你可以通过使用提高控件的二进制初始化性能`ResetVersion`和`ResetStockProps`重写`COleControl::OnResetState`。 参阅位于以下示例[ResetStockProps](#resetstockprops)。 有关优化初始化的进一步信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 允许无窗口 OLE 对象进行滚动它在屏幕上的就地 active 映像内的某个区域。  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>参数  
 `xAmount`  
 指定量，以与设备单位，水平滚动。 此参数必须是负值可向左滚动。  
  
 `yAmount`  
 指定量，以与设备单位的垂直滚动。 此参数必须是负值可向上滚动。  
  
 `lpRect`  
 指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或 RECT 结构，它包含窗口的工作区坐标中指定要向下滚动，OLE 对象的客户端区域的部分。 如果`lpRect`是**NULL**，滚动整个 OLE 对象的工作区。  
  
 `lpClipRect`  
 指向`CRect`对象或`RECT`结构，它指定为到剪辑矩形。 滚动只有在该矩形内的像素。 外部矩形的 bits 不会受到影响，即使它们处于`lpRect`矩形。 如果`lpClipRect`是**NULL**，没有剪辑执行滚动矩形上。  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 选择到设备上下文的字体。  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 指向设备上下文对象的指针。  
  
 `fontHolder`  
 引用[CFontHolder](../../mfc/reference/cfontholder-class.md)对象表示要选择的字体。  
  
### <a name="return-value"></a>返回值  
 指向以前选定的字体的指针。 当调用方已完成所有使用的绘制操作*fontHolder，*它应重新以前选定的字体选择通过传递作为参数传递给[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)。  
  
##  <a name="selectstockfont"></a>COleControl::SelectStockFont  
 选择到设备上下文的常用字体属性。  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 `pDC`  
 将在其中选择字体的设备上下文。  
  
### <a name="return-value"></a>返回值  
 指向以前选择的指针`CFont`对象。 应使用[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)完成后恢复到的设备上下文选择此字体。  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 序列化或初始化分配给控件的显示空间的状态。  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>参数  
 `ar`  
 A`CArchive`要序列化或从对象。  
  
### <a name="remarks"></a>备注  
 你可以通过使用提高控件的二进制暂留性能`SerializeExtent`， `SerializeStockProps`，和`SerializeVersion`重写**COleControl::Serialize**。 请参见下面的示例。 有关优化初始化的进一步信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
### <a name="example"></a>示例  
 [!code-cpp[NVC_MFCAxCtl # 8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 序列化或初始化的状态`COleControl`常用属性︰ 外观、 BackColor、 BorderStyle、 标题、 已启用、 字体、 前景色和文本。  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>参数  
 `ar`  
 A`CArchive`要序列化或从对象。  
  
### <a name="remarks"></a>备注  
 常用属性的说明，请参阅[ActiveX 控件︰ 添加常用属性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。  
  
 你可以通过使用提高控件的二进制暂留性能`SerializeStockProps`， `SerializeExtent`，和`SerializeVersion`重写**COleControl::Serialize**。 有关示例，请参阅在代码[SerializeExtent](#serializeextent)。 有关优化初始化的进一步信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 序列化或初始化的控件的版本信息的状态。  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `ar`  
 A`CArchive`要序列化或从对象。  
  
 `dwVersionDefault`  
 控件的当前版本号。  
  
 `bConvert`  
 指示在保存，或在相同的格式中维护时加载后是否应将持久性数据转换为最新的格式。  
  
### <a name="return-value"></a>返回值  
 控件的版本号。 如果正在加载指定的存档，`SerializeVersion`返回从该存档加载的版本。 否则，它将返回当前加载的版本。  
  
### <a name="remarks"></a>备注  
 你可以通过使用提高控件的二进制暂留性能`SerializeVersion`， `SerializeExtent`，和`SerializeStockProps`重写**COleControl::Serialize**。 有关示例，请参阅在代码[SerializeExtent](#serializeextent)。 有关优化初始化的进一步信息，请参阅[ActiveX 控件︰ 优化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 设置控件的常用的外观属性值。  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>参数  
 *sAppearance*  
 A**短**( `VT_I2`) 值要用于你的控件的外观。 值为 0 到平面设置控件的外观和值为 1 到三维设置控件的外观。  
  
### <a name="remarks"></a>备注  
 有关常用属性的详细信息，请参阅[ActiveX 控件︰ 属性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 设置控件的常用 BackColor 属性值。  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>参数  
 *dwBackColor*  
 **OLE_COLOR**值要用于绘制的控件的背景。  
  
### <a name="remarks"></a>备注  
 使用此属性和其他详细信息与相关的属性，请参阅文章[ActiveX 控件︰ 属性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 设置控件的常用 BorderStyle 属性值。  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>参数  
 *sBorderStyle*  
 用于控制，新的边框样式0 表示无边框，而 1 表示正常的边框。  
  
### <a name="remarks"></a>备注  
 控制窗口将会重新创建和`OnBorderStyleChanged`调用。  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 将导致该控件的容器窗口，才能拥有鼠标捕获控件的代表。  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>返回值  
 指向的指针**CWnd**以前接收鼠标输入的窗口对象。  
  
### <a name="remarks"></a>备注  
 如果该控件已激活并无窗口，此函数会导致该控件的容器窗口，才能拥有鼠标捕获，控件的代表。 否则，此函数会导致该控件本身才能拥有鼠标捕获 (与相同`CWnd::SetCapture`)。  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 设置 OLE 控件窗口的大小，并通知更改控件所在位置的容器。  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>参数  
 `cx`  
 以像素为单位指定控件的新宽度。  
  
 `cy`  
 以像素为单位指定控件的新高度。  
  
### <a name="return-value"></a>返回值  
 如果调用成功; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 此函数不应在控件的构造函数中使用。  
  
 请注意，用于控制 windows 的所有坐标相对于控件的左上角。  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 设置常用已启用的控件的属性值。  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>参数  
 `bEnabled`  
 **TRUE**控件是否已启用; 否则为**FALSE**。  
  
### <a name="remarks"></a>备注  
 设置此属性后**OnEnabledChange**调用。  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 将导致该控件的容器窗口，才能拥有输入焦点的控件的代表。  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>返回值  
 指向的指针**CWnd**以前具有输入的焦点的窗口对象或**NULL**如果没有此类窗口。  
  
### <a name="remarks"></a>备注  
 如果该控件已激活并无窗口，此函数会导致该控件的容器窗口，才能拥有输入焦点的控件的代表。 输入的焦点将定向到容器的窗口的键盘输入，容器调度调用 OLE 对象的所有后续的键盘消息`SetFocus`。 任何以前具有输入的焦点的窗口失去它。  
  
 如果控件不无窗口，此函数会导致该控件本身才能拥有输入焦点 (与相同`CWnd::SetFocus`)。  
  
##  <a name="setfont"></a>COleControl::SetFont  
 设置控件的常用字体属性。  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>参数  
 *pFontDisp*  
 指向一个字体的调度接口的指针。  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 设置控件的常用的前景色属性值。  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>参数  
 *dwForeColor*  
 **OLE_COLOR**值要用于绘制的控件的前景色。  
  
### <a name="remarks"></a>备注  
 使用此属性和其他详细信息与相关的属性，请参阅文章[ActiveX 控件︰ 属性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 由框架调用以初始化控件支持的数据格式的列表。  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>备注  
 默认实现指定两种格式︰`CF_METAFILEPICT`和持久的属性设置。  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 设置当第一次显示容器中的 OLE 控件的大小。  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>参数  
 `cx`  
 以像素为单位 OLE 控件的初始宽度。  
  
 `cy`  
 以像素为单位 OLE 控件的初始高度。  
  
### <a name="remarks"></a>备注  
 若要设置控件的初始大小你构造函数中调用此函数。 初始大小的单位为设备单位或像素。 建议在控件的构造函数中进行此调用。  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 更改控件的已修改的状态。  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `bModified`  
 控件的新值的修改标志。 **TRUE**指示，已被修改控件的状态;**FALSE**指示控件的状态刚刚已保存。  
  
### <a name="remarks"></a>备注  
 当发生了更改，此函数会影响控件的持久状态时调用。 例如，如果是持久化属性的值发生更改，调用此函数带`bModified` **TRUE**。  
  
##  <a name="setnotpermitted"></a>COleControl::SetNotPermitted  
 指示编辑请求已失败。  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>备注  
 调用此函数时`BoundPropertyRequestEdit`失败。 此函数将引发类型的异常**COleDispScodeException**以指示不允许使用的设置操作。  
  
##  <a name="setnotsupported"></a>Colecontrol:: Setnotsupported  
 禁止到用户控件的属性值的修改。  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>备注  
 调用此函数来代替的 Set 函数中的任何属性不支持的控件的用户的属性值的修改。 一个示例是一个属性，为只读。  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 设置相对于容器，以设备的单位表示的控件的矩形的坐标。  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 `lpRect`  
 指向包含控件的新坐标相对于容器的矩形的指针。  
  
### <a name="return-value"></a>返回值  
 如果调用成功; 则为非 0否则为 0。  
  
### <a name="remarks"></a>备注  
 如果控件处于打开状态，它是调整大小;否则为容器的**OnPosRectChanged**调用函数。  
  
##  <a name="settext"></a>COleControl::SetText  
 设置控件的常用标题或文本属性的值。  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>参数  
 `pszText`  
 指向字符字符串的指针。  
  
### <a name="remarks"></a>备注  
 请注意，常用的标题和文本属性同时映射到相同的值。 这意味着对这两个属性所做任何更改将自动更改这两个属性。 一般情况下，控件应支持 stock 标题或文本属性，但不是两者。  
  
##  <a name="throwerror"></a>Colecontrol:: Throwerror  
 用信号通知控件中的错误的匹配项。  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>参数  
 `sc`  
 要报告的状态代码值。 可能的代码的完整列表，请参阅文章[ActiveX 控件︰ 高级主题](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `nDescriptionID`  
 字符串资源 ID 的异常报告。  
  
 `nHelpID`  
 要在其中进行报告主题的帮助 ID。  
  
 `pszDescription`  
 包含要报告的异常的说明的字符串。  
  
### <a name="remarks"></a>备注  
 此函数应仅从调用 Get 或 Set 函数中的 OLE 属性中，或 OLE 自动化方法的实现。 如果你需要指示在其他时间发生的错误，应激发常用的错误事件。  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 转换坐标之间的值**HIMETRIC**单位和容器的本机单位。  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>参数  
 *lpptlHimetric*  
 指向**POINTL**结构，它包含中的坐标**HIMETRIC**单位。  
  
 *lpptfContainer*  
 指向**POINTF**结构，它包含在容器的单元大小的坐标。  
  
 `flags`  
 以下值的组合︰  
  
- **XFORMCOORDS_POSITION**容器中的位置。  
  
- **XFORMCOORDS_SIZE**容器中的大小。  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER**转换**HIMETRIC**到容器的单位的单位。  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC**转换到的容器的单位**HIMETRIC**单位。  
  
### <a name="remarks"></a>备注  
 前两个标志， **XFORMCOORDS_POSITION**和**XFORMCOORDS_SIZE**，指示是否应视为坐标为位置或大小。 剩余的两个标志指示的方向的转换。  
  
##  <a name="translatecolor"></a>COleControl::TranslateColor  
 将转换从一个颜色值**OLE_COLOR**数据类型设置为[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)数据类型。  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>参数  
 `clrColor`  
 A **OLE_COLOR**数据类型。 有关详细信息，请参阅 Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353)函数。  
  
 `hpal`  
 可选的调色板; 句柄可以是**NULL**。  
  
### <a name="return-value"></a>返回值  
 RGB （红色、 绿色和蓝色） 32 位颜色值，该值定义实线颜色接近`clrColor`设备可以表示的值。  
  
### <a name="remarks"></a>备注  
 此函数可用于将转换到常用的前景色和背景色属性**COLORREF**使用的类型[CDC](../../mfc/reference/cdc-class.md)成员函数。  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 确定控件是否应作为默认值中使用的环境属性的值时从其持久状态随后加载它。  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>返回值  
 Nonzero 指示环境属性将会有效，则为否则环境属性将无效。  
  
### <a name="remarks"></a>备注  
 在某些容器中，你的控件可能没有可访问其环境属性在首次调用的重写过程`COleControl::DoPropExchange`。 这是这种情况，如果该容器调用[IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730)或[ipersiststorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557)之前调用[IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (即，如果它不会遵循**OLEMISC_SETCLIENTSITEFIRST**状态位)。  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 提供有关 Windows 过程`COleControl`对象。  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>参数  
 `message`  
 指定要处理的 Windows 消息。  
  
 `wParam`  
 提供用于处理消息的其他信息。 参数值取决于消息。  
  
 `lParam`  
 提供用于处理消息的其他信息。 参数值取决于消息。  
  
### <a name="return-value"></a>返回值  
 调度该消息返回值。  
  
### <a name="remarks"></a>备注  
 调用此函数可将特定消息通过控件的消息映射调度。  
  
## <a name="see-also"></a>另请参阅  
 [MFC 示例 CIRC3](../../visual-cpp-samples.md)   
 [MFC 示例 TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage 类](../../mfc/reference/colepropertypage-class.md)   
 [CWnd 类](../../mfc/reference/cwnd-class.md)   
 [层次结构图](../../mfc/hierarchy-chart.md)   
 [CFontHolder 类](../../mfc/reference/cfontholder-class.md)   
 [CPictureHolder 类](../../mfc/reference/cpictureholder-class.md)

