---
title: CMFCRibbonGallery 类 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
dev_langs:
- C++
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: de624d9775160d1cbe7f048baf2dd83a592cfbe3
ms.sourcegitcommit: 92f2fff4ce77387b57a4546de1bd4bd464fb51b6
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/17/2018
ms.locfileid: "45724747"
---
# <a name="cmfcribbongallery-class"></a>CMFCRibbonGallery 类
实现 Office 2007 样式功能区库。  
 有关更多详细信息，请参阅中的源代码**VC\\atlmfc\\src\\mfc**的 Visual Studio 安装文件夹。  
  
## <a name="syntax"></a>语法  
  
```  
class CMFCRibbonGallery : public CMFCRibbonButton  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|构造并初始化一个 `CMFCRibbonGallery` 对象。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCRibbonGallery::AddGroup](#addgroup)|将新的组添加到库。|  
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|将新的菜单项添加到下拉列表菜单。|  
|[CMFCRibbonGallery::Clear](#clear)|清除内容库。|  
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|启用或禁用菜单面板的大小调整。|  
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|启用或禁用弹出菜单左侧的侧栏。|  
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(重写[cmfcribbonbutton:: Getcompactsize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize)。)|  
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(重写[CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown)。)|  
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|返回位于指定索引处的组的名称。|  
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||  
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|功能区库的某一行中返回的项数。|  
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|返回与库中的项相关联的工具提示文本。|  
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|返回用户选择库中的最后一项的索引。|  
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|返回当前库的命令 ID。|  
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(重写[cmfcribbonbutton:: Getregularsize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize)。)|  
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||  
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(重写[CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu)。)|  
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|指定是否将库包含库按钮中。|  
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|指定启用还是禁用菜单调整大小。|  
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||  
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|指定是启用还是禁用侧栏。|  
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|（重写 `CMFCRibbonButton::OnAfterChangeRect`。）|  
|[CMFCRibbonGallery::OnDraw](#ondraw)|(重写[cmfcribbonbutton:: Ondraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw)。)|  
|[CMFCRibbonGallery::OnEnable](#onenable)|（重写 `CMFCRibbonBaseElement::OnEnable`。）|  
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(重写[CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged)。)|  
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|重绘库。|  
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|从库中的所有项中移除工具提示。|  
|[CMFCRibbonGallery::SelectItem](#selectitem)||  
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(重写[cmfcribbonbutton:: Setaccdata](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata)。)|  
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|指定是否显示功能区库作为下拉列表按钮或直接在功能区上的调色板。|  
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|设置组的名称。|  
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|在库中定义每个行项的数目。|  
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|在库中设置项的工具提示文本。|  
|[CMFCRibbonGallery::SetPalette](#setpalette)|将调色板附加到功能区库。|  
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|定义当选择库项发送 WM_COMMAND 消息中的命令 ID。|  
  
### <a name="protected-methods"></a>受保护的方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|绘制库图标时，由框架调用。|  
  
## <a name="remarks"></a>备注  
 库按钮行为就像常规菜单按钮一样，只不过它显示库，当用户打开它。 在库中选择某个项目，框架将与按钮的命令 ID 的 WM_COMMAND 消息发送。 在处理消息时，应调用[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)来确定从库中选择了哪一项。  
  
## <a name="example"></a>示例  
 下面的示例演示如何使用中的各种方法`CMFCRibbonGallery`类，以配置`CMFCRibbonGallery`对象。 该示例说明了如何在库中指定每个行项的数目、 启用菜单面板的大小调整、 启用侧栏左侧的弹出菜单和显示功能区库为直接在功能区栏上的调色板。 此代码片段属于 [Draw Client 示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)  
  
 [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)  
  
## <a name="requirements"></a>要求  
 **标头：** afxRibbonPaletteGallery.h  
  
##  <a name="addgroup"></a>  CMFCRibbonGallery::AddGroup  
 将新的组添加到库。  
  
```  
void AddGroup(
    LPCTSTR lpszGroupName,  
    UINT uiImagesPaletteResID,  
    int cxPaletteImage);

 
void AddGroup(
    LPCTSTR lpszGroupName,  
    CMFCToolBarImages& imagesGroup);

 
void AddGroup(
    LPCTSTR lpszGroupName,  
    int nIconsNum);
```  
  
### <a name="parameters"></a>参数  
*lpszGroupName*<br/>
[in]指定的组的名称。  
  
*uiImagesPaletteResID*<br/>
[in]指定包含组的图像的图像列表的资源 ID。  
  
*cxPaletteImage*<br/>
[in]指定以像素为单位的图像的宽度。  
  
*imagesGroup*<br/>
[in]对包含组图像的图像列表的引用。  
  
*nIconsNum*<br/>
[in]指定组中的图标数目。 应仅为自定义 （所有者描述的） 指定此参数组。  
  
### <a name="remarks"></a>备注  
 通过调用此方法，你可以将功能区库中的项划分为多个组。 每个组可以具有一个标题。  
  
##  <a name="addsubitem"></a>  CMFCRibbonGallery::AddSubItem  
 将新的菜单项添加到下拉列表菜单。  
  
```  
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,  
    int nIndex=-1,  
    BOOL bOnTop=FALSE);
```  
  
### <a name="parameters"></a>参数  
*pSubItem*<br/>
[in]指向要添加到菜单项的指针。  
  
*nIndex*<br/>
[in]指定的位置的从零开始的索引位置插入项。  
  
*bOnTop*<br/>
[in]若要指定应在功能区库中; 前插入项，则返回 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 通过调用此方法，您可以将弹出菜单项与弹出项库。 之前或之后库，可以放置菜单项。  
  
 若要插入之前库项，设置*bOnTop*为 TRUE。 设置*bOnTop*为 FALSE 可插入在库下面的项。  
  
> [!NOTE]
>  将参数*nIndex*指定插入索引库顶部和底部的库。 例如，如果您需要插入之前库项一个位置，则设置*nIndex*为 1 并*bOnTop*为 TRUE。 同样，如果您需要插入在库下面的项的一个位置，则设置*nIndex*为 1 并*bOnTop*为 FALSE。  
  
##  <a name="clear"></a>  CMFCRibbonGallery::Clear  
 清除内容库。  
  
```  
virtual void Clear();
```  
  
### <a name="remarks"></a>备注  
 调用此方法以从功能区库中删除所有内容。 必须将一个新的功能区库或组的一组附加到功能区库之前完成此操作。  
  
##  <a name="cmfcribbongallery"></a>  CMFCRibbonGallery::CMFCRibbonGallery  
 构造并初始化[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)对象。  
  
```  
CMFCRibbonGallery (
    UINT nID,  
    LPCTSTR lpszText,  
    int nSmallImageIndex,  
    int nLargeImageIndex,  
    CMFCToolBarImages& imagesPalette);

 
CMFCRibbonGallery (
    UINT nID,  
    LPCTSTR lpszText,  
    int nSmallImageIndex,  
    int nLargeImageIndex,  
    UINT uiImagesPaletteResID=0,  
    int cxPaletteImage=0);

 
CMFCRibbonGallery (
    UINT nID,  
    LPCTSTR lpszText,  
    int nSmallImageIndex,  
    int nLargeImageIndex,  
    CSize sizeIcon,  
    int nIconsNum,  
    BOOL bDefaultButtonStyle=TRUE);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 指定要在用户单击按钮时执行的命令的命令 ID。  
  
 *lpszText*  
 指定要在按钮上显示的文本。  
  
 *nSmallImageIndex*  
 要在按钮上显示的小图像的从零开始的索引。  
  
 *nLargeImageIndex*  
 要在按钮上显示的大型图像的从零开始的索引。  
  
 *imagesPalette*  
 对引用[CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)对象，其中包含出现在库上的映像。  
  
 *uiImagesPaletteResID*  
 要在库上显示的图像列表资源 ID。  
  
 *cxPaletteImage*  
 指定以像素为单位，库中的图像的宽度。  
  
 *sizeIcon*  
 指定大小，以像素为单位的库映像。  
  
 *nIconsNum*  
 在库中指定图标的数目。  
  
 *bDefaultButtonStyle*  
 指定是否使用默认值或所有者描述的按钮样式。  
  
### <a name="remarks"></a>备注  
  
##  <a name="enablemenuresize"></a>  CMFCRibbonGallery::EnableMenuResize  
 启用或禁用菜单面板的大小调整。  
  
```  
void EnableMenuResize(
    BOOL bEnable = TRUE,  
    BOOL bVertcalOnly = FALSE);
```  
  
### <a name="parameters"></a>参数  
*bEnable*<br/>
[in]若要启用菜单; 重设大小，则返回 TRUE否则为 FALSE。  
  
*bVertcalOnly*<br/>
[in]若要指定可仅垂直; 调整库，则返回 TRUE为 FALSE，则指定库可以调整大小，同时垂直和水平。  
  
### <a name="remarks"></a>备注  
 使用此方法启用或禁用功能区库重设大小。 启用重设大小后，功能区库将显示用户可用来重设其大小手柄。  
  
##  <a name="enablemenusidebar"></a>  CMFCRibbonGallery::EnableMenuSideBar  
 启用或禁用弹出菜单左侧的侧栏。  
  
```  
void EnablMenuSideBar(BOOL bEnable=TRUE);
```  
  
### <a name="parameters"></a>参数  
*bEnable*<br/>
[in]为 TRUE，则指定已启用侧栏;否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 调用此方法来启用或禁用在左侧和右侧的菜单中的 Office XP 样式侧栏。  
  
##  <a name="getcompactsize"></a>  CMFCRibbonGallery::GetCompactSize  

  
```  
virtual CSize GetCompactSize(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getdroppeddown"></a>  CMFCRibbonGallery::GetDroppedDown  

  
```  
virtual CMFCRibbonBaseElement* GetDroppedDown();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getgroupname"></a>  CMFCRibbonGallery::GetGroupName  
 返回位于指定索引处的组的名称。  
  
```  
LPCTSTR GetGroupName(int nGroupIndex) const;  
```  
  
### <a name="parameters"></a>参数  
*nGroupIndex*<br/>
[in]指定要检索其名称的组的从零开始索引。  
  
### <a name="return-value"></a>返回值  
 位于指定索引处的组的名称。 传递无效的索引将导致失败的断言。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getgroupoffset"></a>  CMFCRibbonGallery::GetGroupOffset  

  
```  
virtual int GetGroupOffset() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="geticonsinrow"></a>  CMFCRibbonGallery::GetIconsInRow  
 功能区库的某一行中返回的项数。  
  
```  
int GetIconsInRow() const;  
```  
  
### <a name="return-value"></a>返回值  
 在行中的项的数目。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getitemtooltip"></a>  CMFCRibbonGallery::GetItemToolTip  
 返回与库中的项相关联的工具提示文本。  
  
```  
LPCTSTR GetItemToolTip(int nItemIndex) const;  
```  
  
### <a name="parameters"></a>参数  
*nItemIndex*<br/>
[in]指定要检索的工具提示文本的项的从零开始索引。  
  
### <a name="return-value"></a>返回值  
 指向分配给功能区库中的项的工具提示字符串的指针。 如果没有工具提示分配到该项目，它可以为 NULL。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getlastselecteditem"></a>  CMFCRibbonGallery::GetLastSelectedItem  
 返回在用户选择了功能区库中的最后一项的索引。  
  
```  
static int GetLastSelectedItem(UINT uiCmdID);
```  
  
### <a name="parameters"></a>参数  
*uiCmdID*<br/>
[in]指定的菜单项，打开功能区库的命令 ID。  
  
### <a name="return-value"></a>返回值  
 用户在功能区库中选择任何项，库将以及打开功能区库菜单按钮的命令 ID 的 WM_COMMAND 消息发送。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getpaletteid"></a>  CMFCRibbonGallery::GetPaletteID  
 返回当前调色板的命令 ID。  
  
```  
int GetPaletteID() const;  
```  
  
### <a name="return-value"></a>返回值  
 当前所选的调色板的命令 ID。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getregularsize"></a>  CMFCRibbonGallery::GetRegularSize  

  
```  
virtual CSize GetRegularSize(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getselecteditem"></a>  CMFCRibbonGallery::GetSelectedItem  

  
```  
int GetSelectedItem() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="hasmenu"></a>  CMFCRibbonGallery::HasMenu  

  
```  
virtual BOOL HasMenu() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isbuttonmode"></a>  CMFCRibbonGallery::IsButtonMode  
 指定是否将调色板包含库按钮中。  
  
```  
BOOL IsButtonMode() const;  
```  
  
### <a name="return-value"></a>返回值  
 面板将显示为下拉列表菜单按钮; 如果为 TRUE如果直接在功能区上显示调色板，则为 FALSE。  
  
### <a name="remarks"></a>备注  
  
##  <a name="ismenuresizeenabled"></a>  CMFCRibbonGallery::IsMenuResizeEnabled  
 指定是否启用菜单调整大小。  
  
```  
BOOL IsMenuResizeEnabled() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果已启用菜单调整大小; 则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
  
##  <a name="ismenuresizevertical"></a>  CMFCRibbonGallery::IsMenuResizeVertical  

  
```  
BOOL IsMenuResizeVertical() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="ismenusidebar"></a>  CMFCRibbonGallery::IsMenuSideBar  
 指定是启用还是禁用侧栏。  
  
```  
BOOL IsMenuSideBar() const;  
```  
  
### <a name="return-value"></a>返回值  
 Office XP 样式侧栏绘制在左侧和右侧的弹出菜单中; 如果为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
  
##  <a name="onafterchangerect"></a>  CMFCRibbonGallery::OnAfterChangeRect  

  
```  
virtual void OnAfterChangeRect(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
  
### <a name="remarks"></a>备注  
  
##  <a name="ondraw"></a>  CMFCRibbonGallery::OnDraw  

  
```  
virtual void OnDraw(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 [in]*pDC*  
  
### <a name="remarks"></a>备注  
  
##  <a name="ondrawpaletteicon"></a>  CMFCRibbonGallery::OnDrawPaletteIcon  
 绘制库图标时，由框架调用。  
  
```  
virtual void OnDrawPaletteIcon(
    CDC* pDC,  
    CRect rectIcon,  
    int nIconIndex,  
    CMFCRibbonGalleryIcon* pIcon,  
    COLORREF clrText);
```  
  
### <a name="parameters"></a>参数  
*pDC*<br/>
[in]指向用于绘图的设备上下文的指针。  
  
*rectIcon*<br/>
[in]指定要绘制的图标的边框。  
  
*nIconIndex*<br/>
[in]指定库图标的图标可绘制的图像列表中的从零开始的索引。  
  
*pIcon*<br/>
[in]指向所绘制的图标的指针。  
  
*clrText*<br/>
[in]指定要绘制的项文本的颜色。  
  
### <a name="remarks"></a>备注  
 您可以重写此方法在派生类以自定义功能区库中。  
  
##  <a name="onenable"></a>  CMFCRibbonGallery::OnEnable  

  
```  
virtual void OnEnable(BOOL bEnable);
```  
  
### <a name="parameters"></a>参数  
 [in]*bEnable*  
  
### <a name="remarks"></a>备注  
  
##  <a name="onrtlchanged"></a>  CMFCRibbonGallery::OnRTLChanged  

  
```  
virtual void OnRTLChanged(BOOL bIsRTL);
```  
  
### <a name="parameters"></a>参数  
 [in]*bIsRTL*  
  
### <a name="remarks"></a>备注  
  
##  <a name="redrawicons"></a>  CMFCRibbonGallery::RedrawIcons  
 重绘库。  
  
```  
void RedrawIcons();
```  
  
### <a name="remarks"></a>备注  
 调用此函数重绘库。 如果您更改了在运行时库的内容，必须调用此方法。  
  
##  <a name="removeitemtooltips"></a>  CMFCRibbonGallery::RemoveItemToolTips  
 从库中的所有项中移除工具提示。  
  
```  
void RemoveItemToolTips();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="selectitem"></a>  CMFCRibbonGallery::SelectItem  

  
```  
void SelectItem(int nItemIndex);
```  
  
### <a name="parameters"></a>参数  
 [in]*nItemIndex*  
  
### <a name="remarks"></a>备注  
  
##  <a name="setaccdata"></a>  CMFCRibbonGallery::SetACCData  
 使用功能区库中的可访问性数据填充指定的 `CAccessibilityData` 对象。  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,   
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>参数  
*pParent*<br/>
[in]功能区库窗口的父窗口。  
  
*data*<br/>
[out]一个`CAccessibilityData`对象，它从功能区库接收可访问性数据。  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
 如果该方法成功，则为 TRUE否则为 FALSE。  
  
##  <a name="setbuttonmode"></a>  CMFCRibbonGallery::SetButtonMode  
 确定是否显示功能区库作为下拉列表按钮或直接在功能区上的调色板。  
  
```  
void SetButtonMode(BOOL bSet=TRUE);
```  
  
### <a name="parameters"></a>参数  
*bSet*<br/>
[in]为 TRUE，则显示为下拉列表菜单按钮; 的功能区库如果为 FALSE，以直接在功能区上显示的功能区库内容。  
  
### <a name="remarks"></a>备注  
  
##  <a name="setgroupname"></a>  CMFCRibbonGallery::SetGroupName  
 设置组的名称。  
  
```  
void SetGroupName(
    int nGroupIndex,  
    LPCTSTR lpszGroupName);
```  
  
### <a name="parameters"></a>参数  
*nGroupIndex*<br/>
[in]指定将名称更改的组的从零开始索引。  
  
*lpszGroupName*<br/>
[in]指定组的新名称。  
  
### <a name="remarks"></a>备注  
 正在更改其名称的组必须使用添加[CMFCRibbonGallery::AddGroup](#addgroup)方法。  
  
##  <a name="seticonsinrow"></a>  CMFCRibbonGallery::SetIconsInRow  
 指定在库中的每个行项的数目。  
  
```  
void SetIconsInRow(int nIconsInRow);
```  
  
### <a name="parameters"></a>参数  
*nIconsInRow*<br/>
[in]指定库的每一行中显示的项目数。  
  
### <a name="remarks"></a>备注  
 使用此方法以指定功能区库的宽度。  
  
##  <a name="setitemtooltip"></a>  CMFCRibbonGallery::SetItemToolTip  
 在库中设置项的工具提示文本。  
  
```  
void SetItemToolTip(
    int nItemIndex,  
    LPCTSTR lpszToolTip);
```  
  
### <a name="parameters"></a>参数  
*nItemIndex*<br/>
[in]若要将工具提示相关联的面板项的从零开始的索引。  
  
*lpszToolTip*<br/>
[in]要在工具提示上显示的文本。  
  
### <a name="remarks"></a>备注  
  
##  <a name="setpalette"></a>  CMFCRibbonGallery::SetPalette  
 将调色板附加到功能区库。  
  
```  
void SetPalette(CMFCToolBarImages& imagesPalette);

 
void SetPalette(
    UINT uiImagesPaletteResID,  
    int cxPaletteImage);
```  
  
### <a name="parameters"></a>参数  
*imagesPalette*<br/>
[in]指定包含要显示在库上的图标的图像列表。  
  
*uiImagesPaletteResID*<br/>
[in]指定包含要显示在库上的图标的图像列表的资源 ID。  
  
*cxPaletteImage*<br/>
[in]指定以像素为单位，库上的图像的宽度。  
  
### <a name="remarks"></a>备注  
  
##  <a name="setpaletteid"></a>  CMFCRibbonGallery::SetPaletteID  
 定义当用户选择库项时发送 WM_COMMAND 消息中的命令 ID。  
  
```  
void SetPaletteID(UINT nID);
```  
  
### <a name="parameters"></a>参数  
*nID*<br/>
[in]指定当用户选择库项时发送 WM_COMMAND 消息中的命令 ID。  
  
### <a name="remarks"></a>备注  
 若要确定用户选择了库中的特定项，请调用[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)静态方法。  
  
## <a name="see-also"></a>请参阅  
 [层次结构图表](../../mfc/hierarchy-chart.md)   
 [类](../../mfc/reference/mfc-classes.md)   
 [CMFCRibbonButton 类](../../mfc/reference/cmfcribbonbutton-class.md)   
 [CMFCRibbonGalleryMenuButton 类](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
