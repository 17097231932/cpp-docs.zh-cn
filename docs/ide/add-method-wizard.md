---
title: 添加方法向导 |Microsoft 文档
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-ide
ms.topic: conceptual
f1_keywords:
- vc.codewiz.method.overview
dev_langs:
- C++
helpviewer_keywords:
- Add Method Wizard [C++]
- methods [C++], adding using wizards
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: cc2ebd18640f0ab778cb45252691e63206861d53
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/04/2018
---
# <a name="add-method-wizard"></a>添加方法向导
使用此向导以向接口添加方法。 具体取决于项目类型或接口类型向其中添加一个方法中，向导将显示不同的选项。  
  
## <a name="names"></a>名称  
 **返回类型**  
 该方法返回的数据类型。 `HRESULT` 建议对于所有接口类型，因为它提供一种标准的方式，返回错误。  
  
|接口类型|描述|  
|--------------------|-----------------|  
|双重接口|`HRESULT`。 不可更改。|  
|自定义接口|`HRESULT`。 不可更改。|  
|本地自定义接口|提供你自己的返回类型或从列表中选择。|  
|调度接口|提供你自己的返回类型或从列表中选择。|  
|MFC ActiveX 控件调度接口|如果你实现常用方法，返回类型设置为适当的值，不可更改。 如果你选择一种方法从**方法名称**列表，然后单击**自定义**下**选择方法类型**，从列表中选择的返回类型。|  
  
 **方法名称**  
 设置的方法的名称。  
  
|接口类型|描述|  
|--------------------|-----------------|  
|ATL 双重接口、 自定义接口和本地自定义接口|提供您自己的方法名称。|  
|MFC 调度接口|提供你自己的方法名称或从列表中选择建议的方法名称。 如果从列表中选择一个名称，适当的值将出现在**返回类型**框中，而且它是不可更改。|  
|MFC ActiveX 控件调度接口|提供你自己或选择两种常用的方法之一[DoClick](../mfc/reference/colecontrol-class.md#doclick)和[刷新](../mfc/reference/colecontrol-class.md#refresh)。 请参阅[MFC ActiveX 控件： 添加常用方法](../mfc/mfc-activex-controls-adding-stock-methods.md)有关详细信息。|  
  
 **方法类型**  
 仅适用于 MFC ActiveX 控件。 如果你提供在方法名称**方法名称**框中，而不是从列表中选择一种方法，此框不可用。  
  
 如果你选择中的方法之一**方法名称**列表中，选择常用实现或自定义实现。  
  
|方法类型|描述|  
|-----------------|-----------------|  
|**常用**|默认值。 插入在您选择的方法的常用实现**方法名称**列表。 **返回类型**，则不可更改，如果你选择**Stock**。|  
|**自定义**|插入在所选的方法的存根实现**方法名称**列表。 对于自定义的方法类型，可以提供您自己的返回类型，也可以选择一个从**返回类型**列表。|  
  
 **内部名称**  
 可用于添加到 MFC 调度接口仅自定义的方法。 设置用于调度映射、 标头 (.h) 文件和实现 (.cpp) 文件的名称。 默认情况下，此名称是相同**方法名称**。 如果你正在使用 MFC 调度接口，或者如果要将自定义的方法添加到 MFC ActiveX 控件调度接口，你可以更改方法名称。  
  
|接口类型|描述|  
|--------------------|-----------------|  
|ATL 双重接口、 自定义接口和本地自定义接口|不可用|  
|MFC 调度接口|默认情况下，设置为的方法名称。 你可以编辑的内部名称。|  
|MFC ActiveX 控件调度接口|你可以设置仅对自定义方法的内部名称。 常用的方法不使用内部名称。|  
  
 **Parameter 特性**  
 设置个参数中指定任何其他属性**参数名称**。  
  
|参数属性|描述|允许的组合|  
|-------------------------|-----------------|--------------------------|  
|**In**|指示参数从调用过程传递到被调用的过程。|**在**仅<br /><br /> **在**和**出**|  
|**Out**|指示指针参数从调用的过程返回到调用过程 （从服务器到客户端）。|**out**仅<br /><br /> **在**和**出**<br /><br /> **out**和**retval**|  
|**retval**|指示参数接收成员的返回值。|**retval**和扩展|  
  
 **参数类型**  
 设置参数的数据类型。 从列表中选择类型。  
  
 **参数名称**  
 设置用于通过方法传递的参数的名称。 键入名称后，你必须单击**添加**将其添加到将通过你的方法传递的参数的列表。 如果你未提供参数名称，则向导将忽略任何参数特性 (仅适用于 ATL) 或**参数类型**选择。  
  
 单击后**添加**，参数名称将显示在**参数列表**。  
  
 **请注意**如果你提供参数名称，然后单击**完成**在单击之前**添加**，该参数不添加到该方法。 你必须找到方法，并手动将参数插入。  
  
 **添加**  
 添加你在中指定的参数**参数名称**，及其类型和参数的属性，到**参数列表**。 你必须单击**添加**将参数添加到列表。  
  
 **移除**  
 中移除在中选择的参数**参数列表**从列表中。  
  
 **参数列表**  
 显示所有参数及其修饰符和当前为该方法添加的类型。 添加参数时，向导将更新**参数列表**以显示每个参数，并具有其修饰符和类型。  
  
## <a name="see-also"></a>请参阅  
 [添加方法](../ide/adding-a-method-visual-cpp.md)   
 [IDL 特性，添加方法向导](../ide/idl-attributes-add-method-wizard.md)