---
title: "CMFCRibbonBar 类 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMFCRibbonBar
- AFXRIBBONBAR/CMFCRibbonBar
- AFXRIBBONBAR/CMFCRibbonBar::ActivateContextCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddContextCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddMainCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddPrintPreviewCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddQATOnlyCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddToTabs
- AFXRIBBONBAR/CMFCRibbonBar::CreateEx
- AFXRIBBONBAR/CMFCRibbonBar::Create
- AFXRIBBONBAR/CMFCRibbonBar::DeactivateKeyboardFocus
- AFXRIBBONBAR/CMFCRibbonBar::DrawMenuImage
- AFXRIBBONBAR/CMFCRibbonBar::DWMCompositionChanged
- AFXRIBBONBAR/CMFCRibbonBar::EnableKeyTips
- AFXRIBBONBAR/CMFCRibbonBar::EnablePrintPreview
- AFXRIBBONBAR/CMFCRibbonBar::EnableToolTips
- AFXRIBBONBAR/CMFCRibbonBar::FindByData
- AFXRIBBONBAR/CMFCRibbonBar::FindByID
- AFXRIBBONBAR/CMFCRibbonBar::FindCategoryIndexByData
- AFXRIBBONBAR/CMFCRibbonBar::ForceRecalcLayout
- AFXRIBBONBAR/CMFCRibbonBar::GetActiveCategory
- AFXRIBBONBAR/CMFCRibbonBar::GetCaptionHeight
- AFXRIBBONBAR/CMFCRibbonBar::GetCategory
- AFXRIBBONBAR/CMFCRibbonBar::GetCategoryCount
- AFXRIBBONBAR/CMFCRibbonBar::GetCategoryHeight
- AFXRIBBONBAR/CMFCRibbonBar::GetCategoryIndex
- AFXRIBBONBAR/CMFCRibbonBar::GetContextName
- AFXRIBBONBAR/CMFCRibbonBar::GetDroppedDown
- AFXRIBBONBAR/CMFCRibbonBar::GetElementsByID
- AFXRIBBONBAR/CMFCRibbonBar::GetApplicationButton
- AFXRIBBONBAR/CMFCRibbonBar::GetFocused
- AFXRIBBONBAR/CMFCRibbonBar::GetHideFlags
- AFXRIBBONBAR/CMFCRibbonBar::GetItemIDsList
- AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavigationLevel
- AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavLevelCurrent
- AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavLevelParent
- AFXRIBBONBAR/CMFCRibbonBar::GetMainCategory
- AFXRIBBONBAR/CMFCRibbonBar::GetQATCommandsLocation
- AFXRIBBONBAR/CMFCRibbonBar::GetQATDroppedDown
- AFXRIBBONBAR/CMFCRibbonBar::GetQuickAccessCommands
- AFXRIBBONBAR/CMFCRibbonBar::GetQuickAccessToolbarLocation
- AFXRIBBONBAR/CMFCRibbonBar::GetTabTrancateRatio
- AFXRIBBONBAR/CMFCRibbonBar::GetTooltipFixedWidthLargeImage
- AFXRIBBONBAR/CMFCRibbonBar::GetTooltipFixedWidthRegular
- AFXRIBBONBAR/CMFCRibbonBar::GetVisibleCategoryCount
- AFXRIBBONBAR/CMFCRibbonBar::HideAllContextCategories
- AFXRIBBONBAR/CMFCRibbonBar::HideKeyTips
- AFXRIBBONBAR/CMFCRibbonBar::HitTest
- AFXRIBBONBAR/CMFCRibbonBar::IsKeyTipEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsMainRibbonBar
- AFXRIBBONBAR/CMFCRibbonBar::IsPrintPreviewEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsQATEmpty
- AFXRIBBONBAR/CMFCRibbonBar::IsQuickAccessToolbarOnTop
- AFXRIBBONBAR/CMFCRibbonBar::IsReplaceFrameCaption
- AFXRIBBONBAR/CMFCRibbonBar::IsShowGroupBorder
- AFXRIBBONBAR/CMFCRibbonBar::IsToolTipDescrEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsToolTipEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsTransparentCaption
- AFXRIBBONBAR/CMFCRibbonBar::IsWindows7Look
- AFXRIBBONBAR/CMFCRibbonBar::LoadFromResource
- AFXRIBBONBAR/CMFCRibbonBar::OnClickButton
- AFXRIBBONBAR/CMFCRibbonBar::OnEditContextMenu
- AFXRIBBONBAR/CMFCRibbonBar::OnRTLChanged
- AFXRIBBONBAR/CMFCRibbonBar::OnSetAccData
- AFXRIBBONBAR/CMFCRibbonBar::OnShowRibbonContextMenu
- AFXRIBBONBAR/CMFCRibbonBar::OnShowRibbonQATMenu
- AFXRIBBONBAR/CMFCRibbonBar::OnSysKeyDown
- AFXRIBBONBAR/CMFCRibbonBar::OnSysKeyUp
- AFXRIBBONBAR/CMFCRibbonBar::PopTooltip
- AFXRIBBONBAR/CMFCRibbonBar::PreTranslateMessage
- AFXRIBBONBAR/CMFCRibbonBar::RecalcLayout
- AFXRIBBONBAR/CMFCRibbonBar::RemoveAllCategories
- AFXRIBBONBAR/CMFCRibbonBar::RemoveAllFromTabs
- AFXRIBBONBAR/CMFCRibbonBar::RemoveCategory
- AFXRIBBONBAR/CMFCRibbonBar::SaveToXMLBuffer
- AFXRIBBONBAR/CMFCRibbonBar::SaveToXMLFile
- AFXRIBBONBAR/CMFCRibbonBar::SetActiveCategory
- AFXRIBBONBAR/CMFCRibbonBar::SetActiveMDIChild
- AFXRIBBONBAR/CMFCRibbonBar::SetElementKeys
- AFXRIBBONBAR/CMFCRibbonBar::SetApplicationButton
- AFXRIBBONBAR/CMFCRibbonBar::SetKeyboardNavigationLevel
- AFXRIBBONBAR/CMFCRibbonBar::SetMaximizeMode
- AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessCommands
- AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessDefaultState
- AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessToolbarOnTop
- AFXRIBBONBAR/CMFCRibbonBar::SetTooltipFixedWidth
- AFXRIBBONBAR/CMFCRibbonBar::SetWindows7Look
- AFXRIBBONBAR/CMFCRibbonBar::ShowCategory
- AFXRIBBONBAR/CMFCRibbonBar::ShowContextCategories
- AFXRIBBONBAR/CMFCRibbonBar::ShowKeyTips
- AFXRIBBONBAR/CMFCRibbonBar::ToggleMimimizeState
- AFXRIBBONBAR/CMFCRibbonBar::TranslateChar
dev_langs:
- C++
helpviewer_keywords:
- CMFCRibbonBar class
ms.assetid: a65d06fa-1a28-4cc0-8971-bc9d7c9198fe
caps.latest.revision: 41
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: 48a7fbeb72257776d132785c985221b0e8148d72
ms.contentlocale: zh-cn
ms.lasthandoff: 02/24/2017

---
# <a name="cmfcribbonbar-class"></a>CMFCRibbonBar 类
`CMFCRibbonBar` 类实现与 Office 2007 中所使用的类似功能区栏。  

 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
   
## <a name="syntax"></a>语法  
  
```  
class CMFCRibbonBar : public CPane  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|说明|  
|----------|-----------------|  
|`CMFCRibbonBar::CMFCRibbonBar`|默认构造函数。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCRibbonBar::ActivateContextCategory](#activatecontextcategory)|激活已经可见的上下文类别。|  
|[CMFCRibbonBar::AddCategory](#addcategory)|向功能区添加新的功能区类别。|  
|[CMFCRibbonBar::AddContextCategory](#addcontextcategory)|添加上下文类别。|  
|[CMFCRibbonBar::AddMainCategory](#addmaincategory)|添加新的主功能区类别。|  
|[CMFCRibbonBar::AddPrintPreviewCategory](#addprintpreviewcategory)||  
|[CMFCRibbonBar::AddQATOnlyCategory](#addqatonlycategory)||  
|[CMFCRibbonBar::AddToTabs](#addtotabs)|将功能区元素添加到功能区栏的右侧。|  
|[CMFCRibbonBar::CreateEx](#createex)|创建的控件条，并将其附加到[CPane](../../mfc/reference/cpane-class.md)对象。 (重写[CPane::CreateEx](../../mfc/reference/cpane-class.md#createex)。)|  
|[CMFCRibbonBar::Create](#create)|创建功能区栏控件并将其附加到功能区栏。|  
|[CMFCRibbonBar::DeactivateKeyboardFocus](#deactivatekeyboardfocus)||  
|[CMFCRibbonBar::DrawMenuImage](#drawmenuimage)||  
|[CMFCRibbonBar::DWMCompositionChanged](#dwmcompositionchanged)||  
|[CMFCRibbonBar::EnableKeyTips](#enablekeytips)|启用或禁用功能区控件的键提示。|  
|[CMFCRibbonBar::EnablePrintPreview](#enableprintpreview)|启用**打印预览**选项卡。|  
|[CMFCRibbonBar::EnableToolTips](#enabletooltips)|启用或禁用功能区栏的工具提示或工具提示说明。|  
|[CMFCRibbonBar::FindByData](#findbydata)|使用用户指定的数据查找功能区元素。|  
|[CMFCRibbonBar::FindByID](#findbyid)|查找具有指定命令 ID 的功能区元素。|  
|[CMFCRibbonBar::FindCategoryIndexByData](#findcategoryindexbydata)|查找包含用户定义数据的功能区类别的索引。|  
|[CMFCRibbonBar::ForceRecalcLayout](#forcerecalclayout)||  
|[CMFCRibbonBar::GetActiveCategory](#getactivecategory)|获取指向活动类别的指针。|  
|[CMFCRibbonBar::GetCaptionHeight](#getcaptionheight)|返回标题高度。 (重写[CBasePane::GetCaptionHeight](../../mfc/reference/cbasepane-class.md#getcaptionheight)。)|  
|[CMFCRibbonBar::GetCategory](#getcategory)|获取指向位于指定索引处的类别的指针。|  
|[CMFCRibbonBar::GetCategoryCount](#getcategorycount)|获取功能区栏中功能区类别的数目。|  
|[CMFCRibbonBar::GetCategoryHeight](#getcategoryheight)||  
|[CMFCRibbonBar::GetCategoryIndex](#getcategoryindex)|返回功能区类别的索引。|  
|[CMFCRibbonBar::GetContextName](#getcontextname)|检索通过使用 ID 指定的上下文类别标题的名称。|  
|[CMFCRibbonBar::GetDroppedDown](#getdroppeddown)||  
|[CMFCRibbonBar::GetElementsByID](#getelementsbyid)|获取一个数组，该数组包含指向具有指定 ID 的所有功能区元素的指针。|  
|[CMFCRibbonBar::GetApplicationButton](#getapplicationbutton)|获取指向功能区按钮的指针。|  
|[CMFCRibbonBar::GetFocused](#getfocused)|返回焦点元素。|  
|[CMFCRibbonBar::GetHideFlags](#gethideflags)||  
|[CMFCRibbonBar::GetItemIDsList](#getitemidslist)||  
|[CMFCRibbonBar::GetKeyboardNavigationLevel](#getkeyboardnavigationlevel)||  
|[CMFCRibbonBar::GetKeyboardNavLevelCurrent](#getkeyboardnavlevelcurrent)||  
|[CMFCRibbonBar::GetKeyboardNavLevelParent](#getkeyboardnavlevelparent)||  
|[CMFCRibbonBar::GetMainCategory](#getmaincategory)|返回指向当前选定功能区类别的指针。|  
|[CMFCRibbonBar::GetQATCommandsLocation](#getqatcommandslocation)||  
|[CMFCRibbonBar::GetQATDroppedDown](#getqatdroppeddown)||  
|[CMFCRibbonBar::GetQuickAccessCommands](#getquickaccesscommands)|填充列表，该列表包含快速访问工具栏上显示的所有元素的命令 ID。|  
|[CMFCRibbonBar::GetQuickAccessToolbarLocation](#getquickaccesstoolbarlocation)||  
|[CMFCRibbonBar::GetTabTrancateRatio](#gettabtrancateratio)||  
|[CMFCRibbonBar::GetTooltipFixedWidthLargeImage](#gettooltipfixedwidthlargeimage)||  
|[CMFCRibbonBar::GetTooltipFixedWidthRegular](#gettooltipfixedwidthregular)||  
|[CMFCRibbonBar::GetVisibleCategoryCount](#getvisiblecategorycount)||  
|[CMFCRibbonBar::HideAllContextCategories](#hideallcontextcategories)|隐藏所有活动的且可见的类别。|  
|[CMFCRibbonBar::HideKeyTips](#hidekeytips)||  
|[CMFCRibbonBar::HitTest](#hittest)|查找一个指针，该指针指向位于功能区栏客户端坐标中指定点的功能区元素。|  
|[CMFCRibbonBar::IsKeyTipEnabled](#iskeytipenabled)|确定是否启用键提示。|  
|[CMFCRibbonBar::IsMainRibbonBar](#ismainribbonbar)||  
|[CMFCRibbonBar::IsPrintPreviewEnabled](#isprintpreviewenabled)|确定是否**打印预览**启用选项卡。|  
|[CMFCRibbonBar::IsQATEmpty](#isqatempty)||  
|[CMFCRibbonBar::IsQuickAccessToolbarOnTop](#isquickaccesstoolbarontop)|指定快速访问工具栏是否位于功能区栏上方。|  
|[CMFCRibbonBar::IsReplaceFrameCaption](#isreplaceframecaption)|确定功能区栏是替换主框架标题还是添加到框架标题的下方。|  
|[CMFCRibbonBar::IsShowGroupBorder](#isshowgroupborder)||  
|[CMFCRibbonBar::IsToolTipDescrEnabled](#istooltipdescrenabled)|确定是否启用工具提示说明。|  
|[CMFCRibbonBar::IsToolTipEnabled](#istooltipenabled)|确定是否禁用工具提示说明。|  
|[CMFCRibbonBar::IsTransparentCaption](#istransparentcaption)||  
|[CMFCRibbonBar::IsWindows7Look](#iswindows7look)|指示功能区是否具有 Windows 7 样式的外观（小型矩形应用程序按钮）。|  
|[Cmfcribbonbar:: Loadfromresource](#loadfromresource)|已重载。 从应用程序资源加载功能区栏。|  
|[CMFCRibbonBar::OnClickButton](#onclickbutton)||  
|[CMFCRibbonBar::OnEditContextMenu](#oneditcontextmenu)||  
|[CMFCRibbonBar::OnRTLChanged](#onrtlchanged)|（重写 `CPane::OnRTLChanged`。）|  
|[CMFCRibbonBar::OnSetAccData](#onsetaccdata)|(重写[CBasePane::OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata)。)|  
|[CMFCRibbonBar::OnShowRibbonContextMenu](#onshowribboncontextmenu)||  
|[CMFCRibbonBar::OnShowRibbonQATMenu](#onshowribbonqatmenu)||  
|[CMFCRibbonBar::OnSysKeyDown](#onsyskeydown)||  
|[CMFCRibbonBar::OnSysKeyUp](#onsyskeyup)||  
|[CMFCRibbonBar::PopTooltip](#poptooltip)||  
|[CMFCRibbonBar::PreTranslateMessage](#pretranslatemessage)|（重写 `CBasePane::PreTranslateMessage`。）|  
|[CMFCRibbonBar::RecalcLayout](#recalclayout)|(重写[CPane::RecalcLayout](../../mfc/reference/cpane-class.md#recalclayout)。)|  
|[CMFCRibbonBar::RemoveAllCategories](#removeallcategories)|从功能区栏删除所有功能区类别。|  
|[CMFCRibbonBar::RemoveAllFromTabs](#removeallfromtabs)|从选项卡区域删除所有功能区元素。|  
|[CMFCRibbonBar::RemoveCategory](#removecategory)|删除位于指定索引处的功能区类别。|  
|[CMFCRibbonBar::SaveToXMLBuffer](#savetoxmlbuffer)|将功能区栏保存到缓冲区。|  
|[CMFCRibbonBar::SaveToXMLFile](#savetoxmlfile)|将功能区栏保存到 XML 文件。|  
|[CMFCRibbonBar::SetActiveCategory](#setactivecategory)|将指定功能区类别设置为活动。|  
|[CMFCRibbonBar::SetActiveMDIChild](#setactivemdichild)||  
|[CMFCRibbonBar::SetElementKeys](#setelementkeys)|为具有指定命令 ID 的所有功能区元素设置指定键提示。|  
|[CMFCRibbonBar::SetApplicationButton](#setapplicationbutton)|向功能区栏分配应用程序功能区按钮。|  
|[CMFCRibbonBar::SetKeyboardNavigationLevel](#setkeyboardnavigationlevel)||  
|[CMFCRibbonBar::SetMaximizeMode](#setmaximizemode)||  
|[CMFCRibbonBar::SetQuickAccessCommands](#setquickaccesscommands)|向快速访问工具栏添加一个或多个功能区元素。|  
|[CMFCRibbonBar::SetQuickAccessDefaultState](#setquickaccessdefaultstate)|指定快速访问工具栏的默认状态。|  
|[CMFCRibbonBar::SetQuickAccessToolbarOnTop](#setquickaccesstoolbarontop)|将快速访问工具栏 (QAT) 定位在功能区栏上方或下方。|  
|[CMFCRibbonBar::SetTooltipFixedWidth](#settooltipfixedwidth)||  
|[CMFCRibbonBar::SetWindows7Look](#setwindows7look)|启用/禁用功能区的 Windows 7 样式的外观（小型矩形应用程序按钮）|  
|[CMFCRibbonBar::ShowCategory](#showcategory)|显示或隐藏指定的功能区类别。|  
|[CMFCRibbonBar::ShowContextCategories](#showcontextcategories)|显示或隐藏具有指定 ID 的上下文类别。|  
|[CMFCRibbonBar::ShowKeyTips](#showkeytips)||  
|[CMFCRibbonBar::ToggleMimimizeState](#togglemimimizestate)|在最小化和最大化状态之间切换功能区栏。|  
|[CMFCRibbonBar::TranslateChar](#translatechar)||  
  
## <a name="remarks"></a>备注  
 Microsoft 在发布 Microsoft Office 2007 时同时引入了 Office Fluent 功能区。 该功能区栏不仅仅是一个新控件。 它代表了一个新的用户界面范例。 功能区是一个包含一组称为类别的选项卡的窗格。 各类别以逻辑方式拆分为不同的功能区面板，而各面板可包含各种控件和命令按钮。  
  
 功能区栏上显示的元素可进行缩放以实现可用空间的最佳利用。 例如，如果一个功能区面板具有足够的空间来显示其元素，它便成为一个菜单按钮，可在一个弹出菜单上显示子项。 功能区栏的行为方式与静态（非浮点）控件栏一样，并可以停靠在框架顶部。  
  
 你可以使用 `CMFCRibbonStatusBar` 类来实现一个类似于 Office 2007 中所用的状态栏。 功能区类别包含 （并显示） 的一组[功能区面板](../../mfc/reference/cmfcribbonpanel-class.md)。 每个功能区面板包含一个或多个功能区元素，派生自[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)。  
  
 有关如何将功能区栏添加到现有的 MFC 应用程序的信息，请参阅[演练︰ 更新 MFC 自由曲线应用程序](../../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md)。  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CBasePane](../../mfc/reference/cbasepane-class.md)  
  
 [CPane](../../mfc/reference/cpane-class.md)  
  
 [CMFCRibbonBar](../../mfc/reference/cmfcribbonbar-class.md)  
  
## <a name="requirements"></a>要求  
 **标头：** afxribbonbar.h  
  
##  <a name="activatecontextcategory"></a>CMFCRibbonBar::ActivateContextCategory  
 激活已经可见的上下文类别。  
  
```  
BOOL ActivateContextCategory(UINT uiContextID);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiContextID`  
 上下文类别 id。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果具有子上下文类别`uiContextID`找到和激活; 否则为`FALSE`。  
  
##  <a name="addcategory"></a>CMFCRibbonBar::AddCategory  
 创建并初始化功能区栏的新功能区类别。  
  
```  
CMFCRibbonCategory* AddCategory(
    LPCTSTR lpszName,  
    UINT uiSmallImagesResID,  
    UINT uiLargeImagesResID,  
    CSize sizeSmallImage= CSize(16,
    16),  
    CSize sizeLargeImage= CSize(32,
    32),  
    int nInsertAt = -1,  
    CRuntimeClass* pRTI= NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszName`  
 功能区类别的名称。  
  
 [in] `uiSmallImagesResID`  
 功能区类别的小图像列表的资源 ID。  
  
 [in] `uiLargeImagesResID`  
 功能区类别的大图像列表的资源 ID。  
  
 [in] `sizeSmallImage`  
 指定为功能区类别的小图像的大小。  
  
 [in] `sizeLargeImage`  
 指定为功能区类别的大图像的大小。  
  
 [in] `nInsertAt`  
 零开始的类别位置的索引。  
  
 [in] `pRTI`  
 指向[CMFCRibbonCategory 类](../../mfc/reference/cmfcribboncategory-class.md)运行时类动态创建在运行时的一个功能区类别。  
  
### <a name="return-value"></a>返回值  
 如果此方法已成功，则新的功能区类别指向的指针否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 如果`pRTI`参数不是`NULL`，使用运行时类以动态方式创建新的功能区类别。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`AddCategory`中的方法`CMFCRibbonBar`类。  
  
 [!code-cpp[NVC_MFC_RibbonApp #&5;](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_1.cpp)]  
  
##  <a name="addcontextcategory"></a>CMFCRibbonBar::AddContextCategory  
 创建并初始化新的上下文类别为功能区栏。  
  
```  
CMFCRibbonCategory* AddContextCategory(
    LPCTSTR lpszName,  
    LPCTSTR lpszContextName,  
    UINT uiContextID,  
    AFX_RibbonCategoryColor clrContext,  
    UINT uiSmallImagesResID,  
    UINT uiLargeImagesResID,  
    CSize sizeSmallImage = CSize(16,
    16),  
    CSize sizeLargeImage = CSize(32,
    32),  
    CRuntimeClass* pRTI = NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszName`  
 类别的名称。  
  
 [in] `lpszContextName`  
 上下文类别标题的名称。  
  
 [in] `uiContextID`  
 上下文 id。  
  
 [in] `clrContext`  
 上下文类别标题的颜色。  
  
 [in] `uiSmallImagesResID`  
 上下文类别的小图像的资源 ID。  
  
 [in] `uiLargeImagesResID`  
 上下文类别大图像的资源 ID。  
  
 [in] `sizeSmallImage`  
 小图像的大小。  
  
 [in] `sizeLargeImage`  
 较大的图像的大小。  
  
 [in] `pRTI`  
 为运行时类的指针。  
  
### <a name="return-value"></a>返回值  
 指向新创建的类别中，或`NULL`如果`CreateObject`方法`pRTI`无法创建指定的类别。  
  
### <a name="remarks"></a>备注  
 使用此函数添加上下文类别。 上下文类别是类别的一种特殊类型可以显示或隐藏在运行时，具体取决于当前的应用程序上下文。 例如，当用户选择一个对象，您可以显示与上下文类别可用于更改所选的特定对象的特殊选项卡。  
  
 上下文类别的颜色可以是下列值之一︰  
  
-   AFX_CategoryColor_None  
  
-   AFX_CategoryColor_Red  
  
-   AFX_CategoryColor_Orange  
  
-   AFX_CategoryColor_Yellow  
  
-   AFX_CategoryColor_Green  
  
-   AFX_CategoryColor_Blue  
  
-   AFX_CategoryColor_Indigo  
  
-   AFX_CategoryColor_Violet  
  
##  <a name="addmaincategory"></a>CMFCRibbonBar::AddMainCategory  
 创建一个新的主功能区类别功能区栏。  
  
```  
CMFCRibbonMainPanel* AddMainCategory(
    LPCTSTR lpszName,  
    UINT uiSmallImagesResID,  
    UINT uiLargeImagesResID,  
    CSize sizeSmallImage = CSize(16,
    16),  
    CSize sizeLargeImage = CSize(32,
    32));
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszName`  
 主要的功能区类别的名称。  
  
 [in] `uiSmallImagesResID`  
 较小的图像资源 ID。  
  
 [in] `uiLargeImagesResID`  
 大图像的资源 ID。  
  
 [in] `sizeSmallImage`  
 较小的图像的大小。  
  
 [in] `sizeLargeImage`  
 大图像的大小。  
  
### <a name="return-value"></a>返回值  
 指向新的主功能区类别如果此方法已成功，则指针否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 如果主要的功能区类别已存在，则删除它。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`AddMainCategory`中的方法`CMFCRibbonBar`类。  
  
 [!code-cpp[NVC_MFC_RibbonApp #&4;](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_2.cpp)]  
  
##  <a name="addprintpreviewcategory"></a>CMFCRibbonBar::AddPrintPreviewCategory  
 在功能区栏上创建一个打印预览类别。  
  
```  
CMFCRibbonCategory* AddPrintPreviewCategory();
```  
  
### <a name="return-value"></a>返回值  
 如果此方法已成功，则新的功能区类别指向的指针否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 此方法创建一个功能区类别和提供打印预览所需的控件。  
  
##  <a name="addqatonlycategory"></a>CMFCRibbonBar::AddQATOnlyCategory  
 创建一个快速访问工具栏功能区类别。  
  
```  
CMFCRibbonCategory* AddQATOnlyCategory(
    LPCTSTR lpszName,  
    UINT uiSmallImagesResID,  
    CSize sizeSmallImage = CSize(16,
    16));
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszName`  
 类别的名称。  
  
 [in] `uiSmallImagesResID`  
 图像列表类别资源 ID。  
  
 [in] `sizeSmallImage`  
 类别中的功能区元素的图像的大小。  
  
### <a name="return-value"></a>返回值  
 如果此方法已成功，则新的类别指向的指针否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 快速访问工具栏自定义对话框中仅用于快速访问工具栏功能区类别。  
  
##  <a name="addtotabs"></a>CMFCRibbonBar::AddToTabs  
 将指定的功能区元素添加到功能区栏的选项卡行。  
  
```  
void AddToTabs(CMFCRibbonBaseElement* pElement);
```  
  
### <a name="parameters"></a>参数  
 [in] `pElement`  
 指向功能区元素的指针。  
  
### <a name="remarks"></a>备注  
 功能区元素定位系统的所有按钮的前面。  
  
##  <a name="cmfcribbonbar"></a>CMFCRibbonBar::CMFCRibbonBar  
 构造并初始化[CMFCRibbonBar](../../mfc/reference/cmfcribbonbar-class.md)对象。  
  
```  
CMFCRibbonBar(BOOL bReplaceFrameCaption = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bReplaceFrameCaption`  
 `TRUE`功能区栏来替换的主框架窗口; 标题`FALSE`来查找在主框架窗口的标题下的功能区栏。  
  
### <a name="remarks"></a>备注  
  
##  <a name="create"></a>CMFCRibbonBar::Create  
 创建功能区栏的窗口。  
  
```  
BOOL Create(
    CWnd* pParentWnd,  
    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,  
    UINT nID = AFX_IDW_RIBBON_BAR);
```  
  
### <a name="parameters"></a>参数  
 [in] `pParentWnd`  
 功能区栏的父级窗口的指针。  
  
 [in] `dwStyle`  
 新窗口的样式逻辑组合。  
  
 [in] `nID`  
 新窗口中的 ID。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果该窗口创建;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`Create`方法`CMFCRibbonBar`类。  
  
 [!code-cpp[NVC_MFC_RibbonApp #&1;](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_3.cpp)]  
  
##  <a name="createex"></a>CMFCRibbonBar::CreateEx  
 创建功能区栏的窗口。  
  
```  
BOOL CreateEx(
    CWnd* pParentWnd,  
    DWORD dwCtrlStyle = 0,  
    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,  
    UINT nID = AFX_IDW_RIBBON_BAR);
```  
  
### <a name="parameters"></a>参数  
 [in] `pParentWnd`  
 功能区栏的父级窗口的指针。  
  
 [in] `dwCtrlStyle`  
 未使用此参数。  
  
 [in] `dwStyle`  
 新窗口的样式逻辑组合。  
  
 [in] `nID`  
 新窗口中的 ID。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果该窗口创建;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="deactivatekeyboardfocus"></a>CMFCRibbonBar::DeactivateKeyboardFocus  
 关闭功能区栏上的所有快捷键提示控件。  
  
```  
void DeactivateKeyboardFocus(BOOL bSetFocus = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bSetFocus`  
 `TRUE`若要将焦点设置到功能区栏与父窗口。  
  
### <a name="remarks"></a>备注  
  
##  <a name="drawmenuimage"></a>CMFCRibbonBar::DrawMenuImage  
 绘制菜单按钮的图像。  
  
```  
BOOL DrawMenuImage(
    CDC* pDC,  
    const CMFCToolBarMenuButton* pMenuItem,  
    const CRect& rectImage);
```  
  
### <a name="parameters"></a>参数  
 [in] `pDC`  
 指针，指向设备上下文菜单按钮。  
  
 [in] `pMenuItem`  
 指针，指向工具栏菜单按钮。  
  
 [in] `rectImage`  
 菜单按钮显示矩形。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果已绘制图像;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="dwmcompositionchanged"></a>CMFCRibbonBar::DWMCompositionChanged  
 启用或禁用桌面窗口管理器 (DWM) 复合时可调整显示效果的功能区栏。  
  
```  
virtual void DWMCompositionChanged();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="enablekeytips"></a>CMFCRibbonBar::EnableKeyTips  
 启用或禁用功能区栏的上方的键提示功能。  
  
```  
void EnableKeyTips(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要启用的键提示功能;`FALSE`若要禁用的键提示功能。  
  
### <a name="remarks"></a>备注  
 当启用此功能时，在用户按 ALT 或 F10 按钮时显示的关键技巧。 当用户按下 ALT 键时，将以 200 毫秒延迟显示的关键技巧。 这种延迟允许快捷方式可用于执行，以便按下 ALT 键不会干扰其他包括 ALT 键的组合。  
  
##  <a name="enableprintpreview"></a>CMFCRibbonBar::EnablePrintPreview  
 启用或禁用**打印预览**功能。  
  
```  
void EnablePrintPreview(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要启用**打印预览**功能;`FALSE`禁用**打印预览**功能。  
  
### <a name="remarks"></a>备注  
 如果`bEnable`是`FALSE`并且打印预览类别存在，则删除它。  
  
 默认情况下**打印预览**启用功能。  
  
##  <a name="enabletooltips"></a>CMFCRibbonBar::EnableToolTips  
 启用或禁用工具提示和可选的工具提示功能区栏上的说明。  
  
```  
void EnableToolTips(
    BOOL bEnable = TRUE,  
    BOOL bEnableDescr = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要启用的功能区栏; 上的工具提示`FALSE`若要禁用的工具提示在功能区栏。  
  
 [in] `bEnableDescr`  
 `TRUE`若要启用工具提示; 上的工具提示说明`FALSE`禁用工具提示上的工具提示说明。  
  
### <a name="remarks"></a>备注  
 `bEnable`参数确定当鼠标悬停在功能区元素上时是否显示工具提示。 `bEnableDescr`参数确定是否附加的说明性文本显示为具有工具提示文本。  
  
##  <a name="findbydata"></a>CMFCRibbonBar::FindByData  
 检索指向功能区元素的指针，如果它具有指定的数据和可见性。  
  
```  
CMFCRibbonBaseElement* FindByData(
    DWORD_PTR dwData,  
    BOOL bVisibleOnly = TRUE) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `dwData`  
 与功能区元素关联的数据。  
  
 [in] `bVisibleOnly`  
 `TRUE`若要搜索; 可见的功能区元素`FALSE`来搜索所有的功能区元素。  
  
### <a name="return-value"></a>返回值  
 指向具有所指定的数据的可见性; 如果的功能区元素的指针否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 功能区元素是任何控件，您可以将其添加到功能区中，如功能区按钮，或功能区类别或功能区滑块。  
  
##  <a name="findbyid"></a>CMFCRibbonBar::FindByID  
 检索指向具有指定的命令 ID 和搜索值的功能区元素的指针。  
  
```  
CMFCRibbonBaseElement* FindByID(
    UINT uiCmdID,  
    BOOL bVisibleOnly = TRUE,  
    BOOL bExcludeQAT = FALSE) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmdID`  
 功能区元素的命令 ID。  
  
 [in] `bVisibleOnly`  
 `TRUE`若要搜索; 可见的功能区元素`FALSE`来搜索所有的功能区元素。  
  
 [in] `bExcludeQAT`  
 `TRUE`若要从搜索; 排除快速访问工具栏元素否则为`FALSE`。  
  
### <a name="return-value"></a>返回值  
 指向具有指定的命令 ID 和搜索值; 如果的功能区元素的指针否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 功能区元素是可以添加到功能区中，如功能区按钮，或功能区类别或功能区滑块任何功能区控件。  
  
 一般情况下，可以有多个功能区元素具有相同的命令 id。 如果您想要获取指向使用指定的命令 ID，则使用的所有功能区元素的指针[CMFCRibbonBar::GetElementsByID](#getelementsbyid)方法。  
  
##  <a name="findcategoryindexbydata"></a>CMFCRibbonBar::FindCategoryIndexByData  
 检索包含指定的数据的功能区类别的索引。  
  
```  
int FindCategoryIndexByData(DWORD dwData) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `dwData`  
 与功能区类别关联的数据。  
  
### <a name="return-value"></a>返回值  
 如果此方法已成功，则为功能区类别的从零开始的索引否则为-1。  
  
##  <a name="forcerecalclayout"></a>CMFCRibbonBar::ForceRecalcLayout  
 调整在功能区栏和父窗口和重绘次数表示的所有项的布局的整个窗口。  
  
```  
void ForceRecalcLayout();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="getactivecategory"></a>CMFCRibbonBar::GetActiveCategory  
 检索指向活动的功能区类别。  
  
```  
CMFCRibbonCategory* GetActiveCategory() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向该活动的功能区类别。或`NULL`如果无类别处于活动状态。  
  
### <a name="remarks"></a>备注  
 一种类别处于活动状态，如果它具有焦点。 默认情况下，活动的类别是功能区栏左侧的第一个类别。  
  
 当用户按下应用程序按钮并不能是活动的类别，将显示主类别。  
  
##  <a name="getapplicationbutton"></a>CMFCRibbonBar::GetApplicationButton  
 检索指向应用程序按钮。  
  
```  
CMFCRibbonApplicationButton* GetApplicationButton() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向应用程序按钮;或`NULL`如果尚未设置按钮。  
  
##  <a name="getcaptionheight"></a>CMFCRibbonBar::GetCaptionHeight  
 检索功能区栏的标题区域的高度。  
  
```  
int GetCaptionHeight() const;  
```  
  
### <a name="return-value"></a>返回值  
 以像素为单位，功能区栏的标题区域的高度。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getcategory"></a>CMFCRibbonBar::GetCategory  
 检索指向指定索引处的功能区类别。  
  
```  
CMFCRibbonCategory* GetCategory(int nIndex) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 功能区类别在功能区栏中包含的功能区类别列表中从零开始索引。  
  
### <a name="return-value"></a>返回值  
 一个指向指定的索引; 处的功能区类别否则为`NULL`如果`nIndex`超出范围。  
  
##  <a name="getcategorycount"></a>CMFCRibbonBar::GetCategoryCount  
 检索在功能区栏中的功能区类别的数目。  
  
```  
int GetCategoryCount() const;  
```  
  
### <a name="return-value"></a>返回值  
 功能区栏中的功能区类别数。  
  
##  <a name="getcategoryheight"></a>CMFCRibbonBar::GetCategoryHeight  
 检索类别的高度。  
  
```  
int GetCategoryHeight() const;  
```  
  
### <a name="return-value"></a>返回值  
 类别的高度。  
  
### <a name="remarks"></a>备注  
 类别高度包括类别选项卡的高度。  
  
##  <a name="getcategoryindex"></a>CMFCRibbonBar::GetCategoryIndex  
 检索指定的功能区类别的索引。  
  
```  
int GetCategoryIndex(CMFCRibbonCategory* pCategory) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `pCategory`  
 指向功能区类别。  
  
### <a name="return-value"></a>返回值  
 指定的一个功能区类别的从零开始索引`pCategory`; 否则为-1 找不到功能区类别。  
  
##  <a name="getcontextname"></a>CMFCRibbonBar::GetContextName  
 检索由上下文 id。 指定的上下文类别标题的名称  
  
```  
BOOL GetContextName(
    UINT uiContextID,  
    CString& strName) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `uiContextID`  
 功能区类别上下文 id。  
  
 [out] `strName`  
 上下文类别标题的名称。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果此方法已成功，则否则为`FALSE`如果`uiContextID`为零或找不到上下文类别标题。  
  
##  <a name="getdroppeddown"></a>CMFCRibbonBar::GetDroppedDown  
 检索当前已关闭中删除的功能区元素。  
  
```  
virtual CMFCRibbonBaseElement* GetDroppedDown();
```  
  
### <a name="return-value"></a>返回值  
 当前已关闭; 中删除该功能区元素或`NULL`如果当前已中不删除任何功能区元素。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getelementsbyid"></a>CMFCRibbonBar::GetElementsByID  
 检索所有具有特定的命令 id。 的功能区元素的指针的数组  
  
```  
void GetElementsByID(
    UINT uiCmdID,  
    CArray<CMFCRibbonBaseElement*,CMFCRibbonBaseElement*>& arButtons);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmdID`  
 命令 ID 的功能区元素。  
  
 [out] `arButtons`  
 指针到功能区元素的数组。  
  
### <a name="remarks"></a>备注  
 多个功能区元素可以具有同一命令 ID，因为可以将某些功能区元素复制到快速访问工具栏。  
  
##  <a name="gethideflags"></a>CMFCRibbonBar::GetHideFlags  
 检索指示可见功能区栏的标志。  
  
```  
DWORD GetHideFlags() const;  
```  
  
### <a name="return-value"></a>返回值  
 指示可见功能区栏的标志。  
  
### <a name="remarks"></a>备注  
 下表列出了可能的返回值的标志的组合︰  
  
 `AFX_RIBBONBAR_HIDE_ELEMENTS`  
 功能区栏最小化垂直方向和类别选项卡、 主按钮和快速访问工具栏都可见。  
  
 `AFX_RIBBONBAR_HIDE_ALL`  
 功能区栏的宽度小于最小宽度和完全隐藏。  
  
##  <a name="getitemidslist"></a>CMFCRibbonBar::GetItemIDsList  
 检索指定的功能区栏上的功能区元素集合的命令 Id。  
  
```  
void GetItemIDsList(CList<UINT, UINT>& lstItems,  
    BOOL bHiddenOnly = FALSE) const;  
```  
  
### <a name="parameters"></a>参数  
 [out] `lstItems`  
 在功能区栏中包含的功能区元素的命令 Id 的列表。  
  
 [in] `bHiddenOnly`  
 `TRUE`若要排除显示，则功能区元素`FALSE`要包含在功能区栏中的所有功能区元素。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getkeyboardnavigationlevel"></a>CMFCRibbonBar::GetKeyboardNavigationLevel  
 在用户按下键提示包含在功能区栏上，则检索当前导航级别。  
  
```  
int GetKeyboardNavigationLevel() const;  
```  
  
### <a name="return-value"></a>返回值  
 当前导航级别与用户按下键提示包含在功能区栏上。 下表列出可能的返回值︰  
  
 -1  
 不显示键提示。  
  
 0  
 显示键提示。  
  
 1  
 用户按下显示的快捷键提示。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getkeyboardnavlevelcurrent"></a>CMFCRibbonBar::GetKeyboardNavLevelCurrent  
 检索在功能区栏上的当前键盘导航对象。  
  
```  
CObject* GetKeyboardNavLevelCurrent() const;  
```  
  
### <a name="return-value"></a>返回值  
 在功能区栏; 上当前的键盘导航对象否则为`NULL`当没有任何对象当前显示的键提示。  
  
### <a name="remarks"></a>备注  
 显示当前的键提示的对象是当前的键盘导航对象。  
  
##  <a name="getkeyboardnavlevelparent"></a>CMFCRibbonBar::GetKeyboardNavLevelParent  
 检索在功能区栏上的父键盘导航对象。  
  
```  
CObject* GetKeyboardNavLevelParent() const;  
```  
  
### <a name="return-value"></a>返回值  
 对功能区栏; 的父键盘导航对象否则为`NULL`。  
  
### <a name="remarks"></a>备注  
 当用户按快捷键提示在功能区栏上时，当前的键盘导航对象将成为父键盘导航对象。  
  
##  <a name="getmaincategory"></a>CMFCRibbonBar::GetMainCategory  
 检索指向主要的功能区类别。  
  
```  
CMFCRibbonCategory* GetMainCategory() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向主要的功能区类别。  
  
### <a name="remarks"></a>备注  
 主要的功能区类别包含主要的功能区面板。  
  
##  <a name="getqatcommandslocation"></a>CMFCRibbonBar::GetQATCommandsLocation  
 检索快速访问工具栏的命令部分显示矩形。  
  
```  
CRect GetQATCommandsLocation() const;  
```  
  
### <a name="return-value"></a>返回值  
 快速访问工具栏的命令部分显示矩形。  
  
### <a name="remarks"></a>备注  
 显示矩形的命令部分不包括自定义按钮。  
  
##  <a name="getqatdroppeddown"></a>CMFCRibbonBar::GetQATDroppedDown  
 检索指向已删除其弹出菜单的快速访问工具栏上的功能区元素的指针。  
  
```  
CMFCRibbonBaseElement* GetQATDroppedDown();
```  
  
### <a name="return-value"></a>返回值  
 指向已删除其弹出菜单的快速访问工具栏上的功能区元素的指针。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getquickaccesscommands"></a>CMFCRibbonBar::GetQuickAccessCommands  
 检索快速访问工具栏上的功能区元素的命令 Id 的列表。  
  
```  
void GetQuickAccessCommands(CList<UINT,UINT>& lstCommands);
```  
  
### <a name="parameters"></a>参数  
 [out] `lstCommands`  
 快速访问工具栏上的功能区元素的命令 Id 的列表。  
  
### <a name="remarks"></a>备注  
 列表不包含控制分隔符的功能区元素。  
  
##  <a name="getquickaccesstoolbarlocation"></a>CMFCRibbonBar::GetQuickAccessToolbarLocation  
 检索用于快速访问工具栏的显示矩形。  
  
```  
CRect GetQuickAccessToolbarLocation() const;  
```  
  
### <a name="return-value"></a>返回值  
 快速访问工具栏上显示矩形。  
  
### <a name="remarks"></a>备注  
  
##  <a name="gettabtrancateratio"></a>CMFCRibbonBar::GetTabTrancateRatio  
 检索类别选项卡的显示宽度的百分比大小减少。  
  
```  
int GetTabTrancateRatio() const;  
```  
  
### <a name="return-value"></a>返回值  
 百分比调整大小类别选项卡可的减少的显示宽度。  
  
### <a name="remarks"></a>备注  
 在功能区栏上没有足够的宽度时，类别选项卡会缩小宽度。  
  
##  <a name="gettooltipfixedwidthlargeimage"></a>CMFCRibbonBar::GetTooltipFixedWidthLargeImage  
 检索到的工具提示功能区栏的宽度大小。  
  
```  
int GetTooltipFixedWidthLargeImage() const;  
```  
  
### <a name="return-value"></a>返回值  
 工具提示宽度以像素为单位的大小。  
  
### <a name="remarks"></a>备注  
 如果工具提示宽度的最大大小为 0，宽度会有所变化。  
  
##  <a name="gettooltipfixedwidthregular"></a>CMFCRibbonBar::GetTooltipFixedWidthRegular  
 检索工具提示功能区栏的宽度的常规大小。  
  
```  
int GetTooltipFixedWidthRegular() const;  
```  
  
### <a name="return-value"></a>返回值  
 正则工具提示宽度以像素为单位的大小。  
  
### <a name="remarks"></a>备注  
 如果工具提示宽度的常规大小为 0，宽度会有所变化。  
  
##  <a name="getvisiblecategorycount"></a>CMFCRibbonBar::GetVisibleCategoryCount  
 检索功能区栏上可见的类别的数。  
  
```  
int GetVisibleCategoryCount() const;  
```  
  
### <a name="return-value"></a>返回值  
 在功能区栏上可见的类别的数目。  
  
### <a name="remarks"></a>备注  
  
##  <a name="hideallcontextcategories"></a>CMFCRibbonBar::HideAllContextCategories  
 隐藏功能区栏上的所有上下文类别。  
  
```  
BOOL HideAllContextCategories();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果至少一个上下文类别隐藏的;，否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 如果上下文类别处于活动状态，则会将活动类别重置为类别列表中的第一个可见类别。  
  
##  <a name="hidekeytips"></a>CMFCRibbonBar::HideKeyTips  
 隐藏功能区栏上的所有键提示。  
  
```  
void HideKeyTips();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="hittest"></a>CMFCRibbonBar::HitTest  
 检索指向指定点的位置的功能区元素的指针。  
  
```  
virtual CMFCRibbonBaseElement* HitTest(
    CPoint point,  
    BOOL bCheckActiveCategory= FALSE,  
    BOOL bCheckPanelCaption= FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `point`  
 在功能区栏坐标点的位置。  
  
 [in] `bCheckActiveCategory`  
 `TRUE`若要搜索该活动的类别。`FALSE`无法搜索活动的类别。  
  
 [in] `bCheckPanelCaption`  
 `TRUE`若要与位于; 点测试功能区面板的标题`FALSE`无法使用位于在其中的点进行测试的功能区面板的标题。 有关详细信息，请参阅备注部分。  
  
### <a name="return-value"></a>返回值  
 指向位于指定点，则功能区元素的指针否则为`NULL`如果点不在功能区元素中。  
  
### <a name="remarks"></a>备注  
 除非未测试与位于该点的功能区面板的标题`bCheckActiveCategory`参数是`TRUE`。  
  
##  <a name="iskeytipenabled"></a>CMFCRibbonBar::IsKeyTipEnabled  
 指示是否启用的键提示功能。  
  
```  
BOOL IsKeyTipEnabled() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果键提示功能已启用;否则为`FALSE`。  
  
##  <a name="ismainribbonbar"></a>CMFCRibbonBar::IsMainRibbonBar  
 表示功能区栏是否是主功能区栏。  
  
```  
virtual BOOL IsMainRibbonBar() const;  
```  
  
### <a name="return-value"></a>返回值  
 始终返回 `TRUE`。  
  
### <a name="remarks"></a>备注  
 默认情况下此方法始终返回`TRUE`。 重写此方法来指示功能区栏是主功能区栏。  
  
##  <a name="isprintpreviewenabled"></a>CMFCRibbonBar::IsPrintPreviewEnabled  
 指示是否**打印预览**启用功能。  
  
```  
BOOL IsPrintPreviewEnabled() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果**打印预览**功能是已启用; 否则为`FALSE`。  
  
##  <a name="isqatempty"></a>CMFCRibbonBar::IsQATEmpty  
 指示是否在快速访问工具栏包含命令按钮。  
  
```  
BOOL IsQATEmpty() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果快速访问工具栏包含命令按钮;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="isquickaccesstoolbarontop"></a>CMFCRibbonBar::IsQuickAccessToolbarOnTop  
 该值指示是否位于超出或低于功能区栏快速访问工具栏。  
  
```  
BOOL IsQuickAccessToolbarOnTop() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果快速访问工具栏是否位于功能区栏;`FALSE`如果快速访问工具栏位于功能区栏。  
  
##  <a name="isreplaceframecaption"></a>CMFCRibbonBar::IsReplaceFrameCaption  
 表示功能区栏是替换还是低于主框架窗口的标题。  
  
```  
BOOL IsReplaceFrameCaption() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果功能区栏取代主框架窗口; 的标题`FALSE`如果功能区栏下的主框架窗口的标题。  
  
##  <a name="isshowgroupborder"></a>CMFCRibbonBar::IsShowGroupBorder  
 指示是否位于功能区栏上的按钮组显示组边框。  
  
```  
virtual BOOL IsShowGroupBorder(CMFCRibbonButtonsGroup* pGroup) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `pGroup`  
 未使用此参数。  
  
### <a name="return-value"></a>返回值  
 始终返回 `FALSE`。  
  
### <a name="remarks"></a>备注  
 默认情况下此方法始终返回`FALSE`。 重写此方法以指示是否位于功能区栏上的按钮组将显示组边框。  
  
##  <a name="istooltipdescrenabled"></a>CMFCRibbonBar::IsToolTipDescrEnabled  
 指示是否启用工具提示说明。  
  
```  
BOOL IsToolTipDescrEnabled() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果已启用工具提示说明;`FALSE`如果禁用了工具提示说明。  
  
### <a name="remarks"></a>备注  
 工具提示说明是具有工具提示文本显示的其他说明性文本。  
  
##  <a name="istooltipenabled"></a>CMFCRibbonBar::IsToolTipEnabled  
 指示是否启用或禁用功能区栏的工具提示。  
  
```  
BOOL IsToolTipEnabled() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果启用了工具提示，则`FALSE`如果禁用了工具提示。  
  
##  <a name="istransparentcaption"></a>CMFCRibbonBar::IsTransparentCaption  
 指示是否为 Windows Aero 配色方案设置显示。  
  
```  
BOOL IsTransparentCaption() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果这种配色方案是 Windows Aero;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="onclickbutton"></a>CMFCRibbonBar::OnClickButton  
 此方法保留以备向后兼容现有应用程序并不用于新的开发。  
  
```  
virtual void OnClickButton(
    CMFCRibbonButton* pButton,  
    CPoint point);
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 指针，指向被单击的按钮。  
  
 [in] `point`  
 未使用此参数。  
  
### <a name="remarks"></a>备注  
  
##  <a name="oneditcontextmenu"></a>CMFCRibbonBar::OnEditContextMenu  

  
```  
virtual void OnEditContextMenu(
    CMFCRibbonRichEditCtrl* pEdit,  
    CPoint point);
```  
  
### <a name="parameters"></a>参数  
 [in] `pEdit`  
 [in] `point`  
  
### <a name="remarks"></a>备注  
  
##  <a name="onrtlchanged"></a>CMFCRibbonBar::OnRTLChanged  
 在布局更改方向时由框架调用。  
  
```  
virtual void OnRTLChanged(BOOL bIsRTL);
```  
  
### <a name="parameters"></a>参数  
 [in] `bIsRTL`  
 `TRUE`如果布局，则从右到左;`FALSE`如果是从左到右的布局。  
  
### <a name="remarks"></a>备注  
 此方法调整新的布局方向的功能区栏上的所有控件的布局。  
  
##  <a name="onsetaccdata"></a>CMFCRibbonBar::OnSetAccData  
 此方法是 Framework 的内部方法，不可从用户代码中调用。  
  
```  
BOOL OnSetAccData(long lVal);
```  
  
### <a name="parameters"></a>参数  
 长时间`lVal`  
 可访问对象的索引。  
  
### <a name="return-value"></a>返回值  
 如果成功则为 S_OK；否则为 FALSE 或 S_FALSE。  
  
### <a name="remarks"></a>备注  
  
##  <a name="onshowribboncontextmenu"></a>CMFCRibbonBar::OnShowRibbonContextMenu  

  
```  
virtual BOOL OnShowRibbonContextMenu(
    CWnd* pWnd,  
    int x,  
    int y,  
    CMFCRibbonBaseElement* pHit);
```  
  
### <a name="parameters"></a>参数  
 [in] `pWnd`  
 [in] `x`  
 [in] `y`  
 [in] `pHit`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="onshowribbonqatmenu"></a>CMFCRibbonBar::OnShowRibbonQATMenu  

  
```  
virtual BOOL OnShowRibbonQATMenu(
    CWnd* pWnd,  
    int x,  
    int y,  
    CMFCRibbonBaseElement* pHit);
```  
  
### <a name="parameters"></a>参数  
 [in] `pWnd`  
 [in] `x`  
 [in] `y`  
 [in] `pHit`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="onsyskeydown"></a>CMFCRibbonBar::OnSysKeyDown  
 当用户按 F10 键，或按住 ALT 键，然后按另一个键时由框架调用。  
  
```  
BOOL OnSysKeyDown(
    CFrameWnd* pFrameWnd,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>参数  
 [in] `pFrameWnd`  
 功能区栏的父级的主框架窗口的指针。  
  
 [in] `wParam`  
 已按下键虚拟键代码。  
  
 [in] `lParam`  
 当按下了键键盘状态标志。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果已处理按键事件;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="onsyskeyup"></a>CMFCRibbonBar::OnSysKeyUp  
 由框架调用，当用户释放 F10 键、 ALT 键或时按住 ALT 键已按下的键。  
  
```  
BOOL OnSysKeyUp(
    CFrameWnd* pFrameWnd,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>参数  
 [in] `pFrameWnd`  
 功能区栏的父级的主框架窗口的指针。  
  
 [in] `wParam`  
 释放键虚拟键代码。  
  
 [in] `lParam`  
 未使用此参数。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果已处理按键事件;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="poptooltip"></a>CMFCRibbonBar::PopTooltip  
 从视图中移除一个工具提示。  
  
```  
void PopTooltip();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="pretranslatemessage"></a>CMFCRibbonBar::PreTranslateMessage  
 确定指定的消息通过功能区栏。  
  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>参数  
 [in] `pMsg`  
 指针，指向一条消息。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果消息已处理的功能区栏;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="recalclayout"></a>CMFCRibbonBar::RecalcLayout  
 调整功能区栏上的所有控件的布局。  
  
```  
virtual void RecalcLayout();
```  
  
### <a name="remarks"></a>备注  
 布局调整后，会更新的功能区栏显示。  
  
##  <a name="removeallcategories"></a>CMFCRibbonBar::RemoveAllCategories  
 从功能区栏中删除所有的功能区类别。  
  
```  
void RemoveAllCategories();
```  
  
### <a name="remarks"></a>备注  
 此方法从内存和类别列表中删除所有的功能区类别。  
  
##  <a name="removeallfromtabs"></a>CMFCRibbonBar::RemoveAllFromTabs  
 从选项卡区域删除所有功能区元素。  
  
```  
void RemoveAllFromTabs();
```  
  
### <a name="remarks"></a>备注  
 如果你想要删除你使用添加到选项卡区域的所有元素，请使用此函数[CMFCRibbonBar::AddToTabs](#addtotabs)方法。  
  
##  <a name="removecategory"></a>CMFCRibbonBar::RemoveCategory  
 从功能区栏中删除指定的功能区类别。  
  
```  
BOOL RemoveCategory(int nIndex);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 在功能区栏中包含的功能区类别列表类别的从零开始的索引。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果指定的功能区类别被删除;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 从内存和类别列表中将删除指定的功能区类别。  
  
##  <a name="setactivecategory"></a>CMFCRibbonBar::SetActiveCategory  
 将指定的功能区类别设置为活动的类别。  
  
```  
BOOL SetActiveCategory(
    CMFCRibbonCategory* pCategory,  
    BOOL bForceRestore= FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `pCategory`  
 功能区栏中包含一个功能区类别。  
  
 [in] `bForceRestore`  
 `TRUE`若要最大化功能区栏，如果它最小化;`FALSE`以最小化功能区栏时的弹出窗口中显示活动的类别。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果指定的类别被设置为该活动的类别。否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 主要的功能区类别不能为活动的类别。  
  
 如果所指定的类别`pCategory`是未显示，它不能设置为活动的类别。  
  
##  <a name="setactivemdichild"></a>CMFCRibbonBar::SetActiveMDIChild  
 将属于多文档界面 (MDI) 子窗口到指定的 MDI 子窗口功能区栏上的系统按钮相关联。  
  
```  
void SetActiveMDIChild(CWnd* pWnd);
```  
  
### <a name="parameters"></a>参数  
 [in] `pWnd`  
 指向指针的 MDI 子窗口。  
  
### <a name="remarks"></a>备注  
  
##  <a name="setapplicationbutton"></a>CMFCRibbonBar::SetApplicationButton  
 向功能区栏分配应用程序功能区按钮。  
  
```  
void SetApplicationButton(
    CMFCRibbonApplicationButton* pButton,  
    CSize sizeButton);
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 一个指向应用程序功能区按钮。  
  
 [in] `sizeButton`  
 应用程序功能区按钮的大小。  
  
### <a name="remarks"></a>备注  
 应用程序功能区按钮是位于功能区控件的左上角的大圆的按钮。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`SetApplicationButton`中的方法`CMFCRibbonBar`类。  
  
 [!code-cpp[NVC_MFC_RibbonApp #&3;](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_4.cpp)]  
  
##  <a name="setelementkeys"></a>CMFCRibbonBar::SetElementKeys  
 设置具有指定的命令 ID 的所有功能区元素的键提示  
  
```  
BOOL SetElementKeys(
    UINT uiCmdID,  
    LPCTSTR lpszKeys,  
    LPCTSTR lpszMenuKeys= NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmdID`  
 功能区元素命令 ID。  
  
 [in] `lpszKeys`  
 快捷键提示。  
  
 [in] `lpszMenuKeys`  
 菜单快捷键提示。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果设置了至少一个功能区元素的键提示;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 对于具有将打开一个弹出菜单的拆分按钮的功能区元素是可选菜单快捷键提示。  
  
##  <a name="setkeyboardnavigationlevel"></a>CMFCRibbonBar::SetKeyboardNavigationLevel  
 设置键盘导航级别与该用户按下键提示包含在功能区栏上。  
  
```  
void SetKeyboardNavigationLevel(
    CObject* pLevel,  
    BOOL bSetFocus = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `pLevel`  
 与当前的键盘导航对象的指针。  
  
 [in] `bSetFocus`  
 `TRUE`若要将键盘焦点设置为功能区栏。  
  
### <a name="remarks"></a>备注  
 当用户按 ALT 或 F10 键时，将启动键盘导航的功能区栏。 用户按快捷键提示在功能区栏上选择下一步导航级别。 用户可以通过按 esc 键返回到上一个导航级别。  
  
##  <a name="setmaximizemode"></a>CMFCRibbonBar::SetMaximizeMode  
 调整功能区栏时的多文档界面 (MDI) 子窗口的窗口大小进入或离开最大化的状态。  
  
```  
void SetMaximizeMode(
    BOOL bMax,  
    CWnd* pWnd = NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `bMax`  
 `TRUE`若要在功能区栏; 上显示的 MDI 子窗口的系统按钮`FALSE`从功能区栏中删除的 MDI 子窗口的系统按钮。  
  
 [in] `pWnd`  
 指向功能区栏的主框架窗口的指针。  
  
### <a name="remarks"></a>备注  
 最大化的 MDI 子窗口时，功能区栏选项卡行中显示的 MDI 子窗口的系统按钮。  
  
##  <a name="setquickaccesscommands"></a>CMFCRibbonBar::SetQuickAccessCommands  
 向快速访问工具栏添加一个或多个功能区元素。  
  
```  
void SetQuickAccessCommands(
    const CList<UINT,UINT>& lstCommands,  
    BOOL bRecalcLayout=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `lstCommands`  
 要放置在快速访问工具栏上的命令列表。  
  
 [in] `bRecalcLayout`  
 `TRUE`如果想要添加的功能区元素; 后重绘功能区`FALSE`否则为。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`SetQuickAccessCommands`中的方法`CMFCRibbonBar`类。  
  
 [!code-cpp[NVC_MFC_RibbonApp #&8;](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_5.cpp)]  
  
##  <a name="setquickaccessdefaultstate"></a>CMFCRibbonBar::SetQuickAccessDefaultState  
 将快速访问工具栏设置为默认状态。  
  
```  
void SetQuickAccessDefaultState(const CMFCRibbonQuickAccessToolBarDefaultState& state);
```  
  
### <a name="parameters"></a>参数  
 [in] `state`  
 快速访问工具栏默认状态。  
  
### <a name="remarks"></a>备注  
 快速访问工具栏状态列出的命令和它们的可见性。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`SetQuickAccessDefaultState`中的方法`CMFCRibbonBar`类。  
  
 [!code-cpp[NVC_MFC_RibbonApp #&9;](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_6.cpp)]  
  
##  <a name="setquickaccesstoolbarontop"></a>CMFCRibbonBar::SetQuickAccessToolbarOnTop  
 将快速访问工具栏上方或下方的功能区栏。  
  
```  
void SetQuickAccessToolbarOnTop(BOOL bOnTop);
```  
  
### <a name="parameters"></a>参数  
 [in] `bOnTop`  
 `TRUE`若要定位上方功能区栏; 的快速访问工具栏`FALSE`定位快速访问工具栏功能区栏的下方。  
  
##  <a name="settooltipfixedwidth"></a>CMFCRibbonBar::SetTooltipFixedWidth  
 设置工具提示的功能区栏固定宽度的常规和较大大小。  
  
```  
void SetTooltipFixedWidth(
    int nWidthRegular,  
    int nWidthLargeImage);
```  
  
### <a name="parameters"></a>参数  
 [in] `nWidthRegular`  
 宽度，以像素为单位的正则表达式的固定大小的工具提示。  
  
 [in] `nWidthLargeImage`  
 宽度，以像素为单位，一个较大，固定的大小调整工具提示。  
  
### <a name="remarks"></a>备注  
 将参数设置为 0 会导致相应的宽度，以改变。  
  
##  <a name="showcategory"></a>CMFCRibbonBar::ShowCategory  
 显示或隐藏指定的功能区类别。  
  
```  
void ShowCategory(
    int nIndex,  
    BOOL bShow=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 功能区类别的索引。  
  
 [in] `bShow`  
 如果`TRUE`，显示功能区类别; 否则，隐藏功能区类别。  
  
##  <a name="showcontextcategories"></a>CMFCRibbonBar::ShowContextCategories  
 显示或隐藏具有指定 ID 的上下文类别。  
  
```  
void ShowContextCategories(
    UINT uiContextID,  
    BOOL bShow=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiContextID`  
 上下文类别 id。  
  
 [in] `bShow`  
 如果`TRUE`，显示具有指定的 ID 的类别; 否则，隐藏的类别的具有指定 id。  
  
##  <a name="showkeytips"></a>CMFCRibbonBar::ShowKeyTips  
 在功能区栏上显示每个功能区元素的键提示。  
  
```  
void ShowKeyTips();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="togglemimimizestate"></a>CMFCRibbonBar::ToggleMimimizeState  
 在最小化和最大化状态之间切换功能区栏。  
  
```  
void ToggleMimimizeState();
```  
  
### <a name="remarks"></a>备注  
 方法名称中的拼写错误为已知问题。  
  
 在最小化状态下，将隐藏功能区控件并只显示选项卡。 当用户单击选项卡时，功能区控件将显示为弹出窗口。 当用户单击或执行命令时，该窗口将关闭。  
  
##  <a name="translatechar"></a>CMFCRibbonBar::TranslateChar  
 确定是否通过功能区栏来处理指定的键击字符代码。  
  
```  
virtual BOOL TranslateChar(UINT nChar);
```  
  
### <a name="parameters"></a>参数  
 [in] `nChar`  
 用户击键字符代码。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果已处理的字符代码，通过功能区栏;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 键提示功能使用户能够通过使用键盘导航功能区栏。  
  
##  <a name="getfocused"></a>CMFCRibbonBar::GetFocused  
 返回焦点元素。  
  
```  
virtual CMFCRibbonBaseElement* GetFocused();
```  
  
### <a name="return-value"></a>返回值  
 指向具有焦点的元素的指针或`NULL`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="iswindows7look"></a>CMFCRibbonBar::IsWindows7Look  
 指示在功能区是否有 Windows 7 查找 （矩形的小型应用程序按钮）。  
  
```  
BOOL IsWindows7Look() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果功能区具有看起来; Windows 7否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="loadfromresource"></a>Cmfcribbonbar:: Loadfromresource  
 已重载。 从应用程序资源加载功能区栏。  
  
```  
virtual BOOL LoadFromResource(
    UINT uiXMLResID,  
    LPCTSTR lpszResType = RT_RIBBON,  
    HINSTANCE hInstance = NULL);

 
virtual BOOL LoadFromResource(
    LPCTSTR lpszXMLResID,  
    LPCTSTR lpszResType = RT_RIBBON,  
    HINSTANCE hInstance = NULL);
```  
  
### <a name="parameters"></a>参数  
 `uiXMLResID`  
 指定资源 ID 的 XML 字符串包含的功能区栏信息。  
  
 `lpszResType`  
 指定位于的资源类型`uiXMLResID`。  
  
 `hInstance`  
 其可执行文件中包含该资源的模块的句柄。 如果`hInstance`是`NULL`，系统从用于创建当前进程的模块加载资源。  
  
 `lpszXMLResID`  
 指定包含的功能区栏信息 （以字符串形式） 的资源 ID。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果加载成功，则否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="savetoxmlbuffer"></a>CMFCRibbonBar::SaveToXMLBuffer  
 将功能区栏保存到缓冲区。  
  
```  
UINT SaveToXMLBuffer(LPBYTE* ppBuffer) const;  
```  
  
### <a name="parameters"></a>参数  
 `ppBuffer`  
 此函数返回时，`ppBuffer`指向由此方法分配的缓冲区并以 XML 格式介绍功能区栏。  
  
### <a name="return-value"></a>返回值  
 如果成功，则为 `TRUE`；否则为 `FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="savetoxmlfile"></a>CMFCRibbonBar::SaveToXMLFile  
 将功能区栏保存到 XML 文件。  
  
```  
BOOL SaveToXMLFile(LPCTSTR lpszFilePath) const;  
```  
  
### <a name="parameters"></a>参数  
 `lpszFilePath`  
 指定输出文件。  
  
### <a name="return-value"></a>返回值  
 如果成功，则为 `TRUE`；否则为 `FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="setwindows7look"></a>CMFCRibbonBar::SetWindows7Look  
 启用或禁用 Windows 7 的外观 （矩形的小型应用程序按钮） 的功能区。  
  
```  
void SetWindows7Look(
    BOOL bWindows7Look,  
    BOOL bRecalc = TRUE);
```  
  
### <a name="parameters"></a>参数  
 `bWindows7Look`  
 `TRUE`设置 Windows 7 的外观;`FALSE`否则为。  
  
 `bRecalc`  
 `TRUE`重新计算的功能区布局;`FALSE`否则为。  
  
### <a name="remarks"></a>备注  
  
## <a name="see-also"></a>另请参阅  
 [层次结构图](../../mfc/hierarchy-chart.md)   
 [类](../../mfc/reference/mfc-classes.md)   
 [CPane 类](../../mfc/reference/cpane-class.md)   
 [CMFCRibbonCategory 类](../../mfc/reference/cmfcribboncategory-class.md)   
 [CMFCRibbonPanel 类](../../mfc/reference/cmfcribbonpanel-class.md)   
 [CMFCRibbonBaseElement 类](../../mfc/reference/cmfcribbonbaseelement-class.md)   
 [演练︰ 更新 MFC 随意画图应用程序](../../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md)




