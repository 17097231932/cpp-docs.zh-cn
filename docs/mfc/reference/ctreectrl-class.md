---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: eda7a2430aa13bb8d30649d796d9f72f900b9097
ms.sourcegitcommit: 27d9db019f6d84c94de9e6aff0170d918cee6738
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/06/2020
ms.locfileid: "75676972"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

提供 Windows 公共树视图控件的功能。

## <a name="syntax"></a>语法

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>Members

### <a name="public-constructors"></a>公用建構函式

|Name|描述|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|构造 `CTreeCtrl` 对象。|

### <a name="public-methods"></a>公共方法

|Name|描述|
|----------|-----------------|
|[CTreeCtrl::Create](#create)|创建树视图控件，并将其附加到 `CTreeCtrl` 对象上。|
|[CTreeCtrl::CreateDragImage](#createdragimage)|为指定的树视图项创建拖动位图。|
|[CTreeCtrl::CreateEx](#createex)|创建具有指定 Windows 扩展样式的树控件，并将其附加到 `CTreeCtrl` 的对象。|
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|删除树视图控件中的所有项。|
|[CTreeCtrl::DeleteItem](#deleteitem)|删除树视图控件中的新项。|
|[CTreeCtrl::EditLabel](#editlabel)|就地编辑指定树视图项。|
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|取消对当前树视图控件中的树视图项的标签的编辑操作。|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|确保树视图项在其树视图控件中可见。|
|[CTreeCtrl::Expand](#expand)|展开或折叠指定树视图项的子项。|
|[CTreeCtrl::GetBkColor](#getbkcolor)|检索控件的当前背景色。|
|[CTreeCtrl::GetCheck](#getcheck)|检索树控件项的检查状态。|
|[CTreeCtrl::GetChildItem](#getchilditem)|检索指定树视图项的子。|
|[CTreeCtrl::GetCount](#getcount)|检索与树视图控件关联的树项的数目。|
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|检索拖放操作的目标。|
|[CTreeCtrl::GetEditControl](#geteditcontrol)|检索用于编辑指定树视图项的编辑控件的句柄。|
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|检索当前树视图控件所使用的扩展样式。|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|检索指定树视图项的第一个可见项。|
|[CTreeCtrl::GetImageList](#getimagelist)|检索与树视图控件关联的图像列表的句柄。|
|[CTreeCtrl::GetIndent](#getindent)|从其父级检索树视图项的偏移量（以像素为单位）。|
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|检索用于绘制树视图的插入标记的颜色。|
|[CTreeCtrl::GetItem](#getitem)|检索指定树视图项的特性。|
|[CTreeCtrl::GetItemData](#getitemdata)|返回与项关联的应用程序特定的值。|
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|检索当当前树视图控件的指定项处于展开状态时要显示的图像的索引。|
|[CTreeCtrl::GetItemHeight](#getitemheight)|检索树视图项的当前高度。|
|[CTreeCtrl::GetItemImage](#getitemimage)|检索与项关联的图像。|
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|检索当前树视图控件中指定项的指定部分的边框。|
|[CTreeCtrl::GetItemRect](#getitemrect)|检索树视图项的边框。|
|[CTreeCtrl::GetItemState](#getitemstate)|返回项的状态。|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|检索当前树视图控件中指定项的扩展状态。|
|[CTreeCtrl::GetItemText](#getitemtext)|返回项的文本。|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|检索当前树视图控件中的最后一个扩展项。|
|[CTreeCtrl::GetLineColor](#getlinecolor)|检索树视图控件的当前线条颜色。|
|[CTreeCtrl::GetNextItem](#getnextitem)|检索匹配指定关系的下一个树视图项。|
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|检索指定树视图项的下一个同级。|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|检索指定树视图项的下一个可见项。|
|[CTreeCtrl::GetParentItem](#getparentitem)|检索指定树视图项的父级。|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|检索指定树视图项的上一个同级。|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|检索指定树视图项的上一个可见项。|
|[CTreeCtrl::GetRootItem](#getrootitem)|检索指定树视图项的根。|
|[CTreeCtrl::GetScrollTime](#getscrolltime)|检索树视图控件的最长滚动时间。|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|检索当前树视图控件中选定项的数目。|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|检索当前选定的树视图项。|
|[CTreeCtrl::GetTextColor](#gettextcolor)|检索控件的当前文本颜色。|
|[CTreeCtrl::GetToolTips](#gettooltips)|检索树视图控件使用的子工具提示控件的句柄。|
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|检索与树视图控件关联的可见树项的数目。|
|[CTreeCtrl::HitTest](#hittest)|返回与 `CTreeCtrl` 对象相关的光标当前位置。|
|[CTreeCtrl::InsertItem](#insertitem)|在树视图控件中插入新项。|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|如果指定的项具有子项，则返回非零值。|
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|将指定的可访问性标识符映射到当前树视图控件中的树视图项的句柄。|
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|将指定的句柄映射到当前树视图控件中的树视图项的辅助功能标识符。|
|[CTreeCtrl::Select](#select)|选择、滚动到视图或重绘指定的树视图项。|
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|将树项重绘为拖放操作的目标。|
|[CTreeCtrl::SelectItem](#selectitem)|选择指定的树视图项。|
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|选择指定的树视图项作为第一个可见项。|
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|设置当前树视图控件的自动滚动速率。|
|[CTreeCtrl::SetBkColor](#setbkcolor)|设置控件的背景色。|
|[CTreeCtrl::SetCheck](#setcheck)|设置树控件项的检查状态。|
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|设置当前树视图控件的扩展样式。|
|[CTreeCtrl::SetImageList](#setimagelist)|设置与树视图控件关联的图像列表的句柄。|
|[CTreeCtrl::SetIndent](#setindent)|设置树视图项与其父级的偏移量（以像素为单位）。|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|设置树视图控件中的插入标记。|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|设置用于绘制树视图插入标记的颜色。|
|[CTreeCtrl::SetItem](#setitem)|设置指定树视图项的特性。|
|[CTreeCtrl::SetItemData](#setitemdata)|设置与项关联的应用程序特定的值。|
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|设置在当前树视图控件的指定项处于展开状态时要显示的图像的索引。|
|[CTreeCtrl::SetItemHeight](#setitemheight)|设置树视图项的高度。|
|[CTreeCtrl::SetItemImage](#setitemimage)|将图像与项关联。|
|[CTreeCtrl::SetItemState](#setitemstate)|设置项的状态。|
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|设置当前树视图控件中指定项的扩展状态。|
|[CTreeCtrl::SetItemText](#setitemtext)|设置项的文本。|
|[CTreeCtrl::SetLineColor](#setlinecolor)|设置树视图控件的当前线条颜色。|
|[CTreeCtrl::SetScrollTime](#setscrolltime)|设置树视图控件的最长滚动时间。|
|[CTreeCtrl::SetTextColor](#settextcolor)|设置控件的文本颜色。|
|[CTreeCtrl::SetToolTips](#settooltips)|设置树视图控件的子工具提示控件。|
|[CTreeCtrl::ShowInfoTip](#showinfotip)|显示当前树视图控件中指定项的信息提示。|
|[CTreeCtrl::SortChildren](#sortchildren)|对给定父项的子级进行排序。|
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|使用应用程序定义的排序函数对给定父项的子级进行排序。|

## <a name="remarks"></a>备注

"树视图控件" 是显示项的分层列表的窗口，例如文档中的标题、索引中的条目或磁盘上的文件和目录。 每个项包含一个标签和一个可选位图图像，且每个项可以有一个与之关联的子项列表。 通过单击项，用户可以展开和折叠关联的子项列表。

此控件（因此 `CTreeCtrl` 类）仅适用于在 Windows 98 和 Windows NT 版本4及更高版本下运行的程序。

有关使用 `CTreeCtrl`的详细信息，请参阅：

- [控件](../../mfc/controls-mfc.md)

- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)

- Windows SDK 中的[树视图控件引用](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>需求

**标头：** afxcmn.h

##  <a name="create"></a>CTreeCtrl::Create

如果在对话框模板中指定树控件，或者使用的是[CTreeView](../../mfc/reference/ctreeview-class.md)，则在创建该对话框或视图时，将自动创建树控件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwStyle*<br/>
指定树视图控件的样式。 如 Windows SDK 中所述，应用窗口样式，如[CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)中所述，以及任何[树视图控件样式](/windows/win32/Controls/tree-view-control-window-styles)组合。

*rect*<br/>
指定树视图控件的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](/previous-versions/dd162897\(v=vs.85\))结构。

*pParentWnd*<br/>
指定树视图控件的父窗口，通常为 `CDialog`。 值不得为 NULL。

*nID*<br/>
指定树视图控件的 ID。

### <a name="return-value"></a>返回值

如果初始化成功，则为非零值;否则为0。

### <a name="remarks"></a>备注

如果要将树控件创建为某个其他窗口的子窗口，请使用 `Create` 成员函数。 如果使用 `Create`创建树控件，则除了其他树视图样式以外，还必须将其传递 WS_VISIBLE。

可以通过两个步骤构造 `CTreeCtrl`。 首先调用构造函数，然后调用 `Create`，这将创建树视图控件，并将其附加到 `CTreeCtrl` 对象。

若要创建具有扩展窗口样式的树控件， 请调用 [CreateEx](#createex) 而不是`Create`。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

##  <a name="createex"></a>CTreeCtrl::CreateEx

调用此函数可创建控件（子窗口），并将其与 `CTreeCtrl` 对象相关联。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>参数

*dwExStyle*<br/>
指定正在创建的控件的扩展样式。 有关扩展 Windows 样式的列表，请参阅 Windows SDK 中[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*参数。

*dwStyle*<br/>
指定树视图控件的样式。 如 Windows SDK 中所述，应用窗口样式，如[CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)中所述，以及任何[树视图控件样式](/windows/win32/Controls/tree-view-control-window-styles)组合。

*rect*<br/>
对[矩形](/previous-versions/dd162897\(v=vs.85\))结构的引用，该结构描述要创建的窗口的大小和位置（以*pParentWnd*的工作区坐标表示）。

*pParentWnd*<br/>
指向作为控件的父级的窗口的指针。

*nID*<br/>
控件的子窗口 ID。

### <a name="return-value"></a>返回值

如果成功，则为非零; 否则为0。

### <a name="remarks"></a>备注

使用 `CreateEx` 而不是[Create](#create)来应用扩展的 windows 样式，该样式由 Windows 扩展样式指定的前言**WS_EX_** 开头。

##  <a name="createdragimage"></a>CTreeCtrl::CreateDragImage

调用此函数可为树视图控件中的给定项创建拖动位图，为位图创建图像列表，并将位图添加到图像列表。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要拖动的树项的句柄。

### <a name="return-value"></a>返回值

指向将拖动位图添加到的图像列表的指针，如果成功，则为; 否则为。否则为 NULL。

### <a name="remarks"></a>备注

应用程序使用图像列表函数在拖动项时显示图像。

`CImageList` 对象是永久性的，并且必须在完成后将其删除。 例如：

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

##  <a name="ctreectrl"></a>CTreeCtrl::CTreeCtrl

构造 `CTreeCtrl` 对象。

```
CTreeCtrl();
```

##  <a name="deleteallitems"></a>CTreeCtrl::DeleteAllItems

调用此函数可从树视图控件中删除所有项。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

##  <a name="deleteitem"></a>CTreeCtrl::DeleteItem

调用此函数可从树视图控件中删除项。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要删除的树项的句柄。 如果*hitem*具有 TVI_ROOT 值，则将从树视图控件中删除所有项。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

##  <a name="editlabel"></a>CTreeCtrl::EditLabel

调用此函数可开始就地编辑指定项的文本。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要编辑的树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则为指向用于编辑项文本的 `CEdit` 对象的指针;否则为 NULL。

### <a name="remarks"></a>备注

编辑是通过使用包含文本的单行编辑控件替换项的文本来完成的。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

##  <a name="endeditlabelnow"></a>CTreeCtrl::EndEditLabelNow

在当前树视图控件中的树视图项的标签上结束编辑操作。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*fCancelWithoutSave*|中如果为 TRUE，则在结束编辑操作之前放弃对树视图项所做的更改; 如果为 FALSE，则在结束操作之前保存对树视图项所做的更改。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow)消息。

##  <a name="ensurevisible"></a>CTreeCtrl::Ensurevisible\

调用此函数可确保树视图项可见。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要使其可见的树项的句柄。

### <a name="return-value"></a>返回值

如果系统滚动树视图控件中的项以确保指定的项可见，则返回 TRUE。 否则，返回值为 FALSE。

### <a name="remarks"></a>备注

如果需要，函数将扩展父项或滚动树视图控件，使该项可见。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

##  <a name="expand"></a>CTreeCtrl::Expand

调用此函数可展开或折叠与给定父项关联的子项列表（如果有）。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要展开的树项的句柄。

*nCode*<br/>
一个标志，用于指示要执行的操作的类型。 此标志可以具有以下值之一：

- TVE_COLLAPSE 折叠列表。

- TVE_COLLAPSERESET 折叠列表并删除子项目。 已重置 TVIS_EXPANDEDONCE 状态标志。 此标志必须与 TVE_COLLAPSE 标志一起使用。

- TVE_EXPAND 扩展列表。

- TVE_TOGGLE 如果列表当前处于展开状态，则折叠该列表; 如果当前处于折叠状态，则展开它。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::ensurevisible\](#ensurevisible)的示例。

##  <a name="getbkcolor"></a>CTreeCtrl::GetBkColor

此成员函数实现 Win32 消息[TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>返回值

一个 COLORREF 值，该值表示控件的当前窗口背景色。 如果此值为-1，则控件使用系统窗口颜色。 在这种情况下，可以使用 `::GetSysColor(COLOR_WINDOW)` 获取控件所使用的当前系统颜色。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetTextColor](#settextcolor)的示例。

##  <a name="getcheck"></a>CTreeCtrl::GetCheck

调用此成员函数以检索项的检查状态。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要接收其状态信息的 HTREEITEM。

### <a name="return-value"></a>返回值

如果选中了树控件项，则为非零值;否则为0。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetCheck](#setcheck)的示例。

##  <a name="getchilditem"></a>CTreeCtrl::GetChildItem

调用此函数可检索作为*hItem*指定的项的子树视图项。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则为子项的句柄;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

##  <a name="getcount"></a>CTreeCtrl::GetCount

调用此函数可在树视图控件中检索项的计数。

```
UINT GetCount() const;
```

### <a name="return-value"></a>返回值

树视图控件中的项数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

##  <a name="getdrophilightitem"></a>CTreeCtrl::GetDropHilightItem

调用此函数可检索作为拖放操作的目标的项。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>返回值

如果成功，则为该项的句柄;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="geteditcontrol"></a>CTreeCtrl::GetEditControl

调用此函数可检索用于编辑树视图项文本的编辑控件的句柄。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>返回值

一个指针，指向用于编辑项文本的编辑控件（如果成功）;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

##  <a name="getextendedstyle"></a>CTreeCtrl::GetExtendedStyle

检索当前树视图控件所使用的扩展样式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>返回值

一个值，该值包含当前树视图控件的扩展样式的按位组合（OR）。 有关详细信息，请参阅[树形视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle)消息。

##  <a name="getfirstvisibleitem"></a>CTreeCtrl::GetFirstVisibleItem

调用此函数可检索树视图控件的第一个可见项。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>返回值

第一个可见项的句柄;否则为 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetCheck](#setcheck)的示例。

##  <a name="getimagelist"></a>CTreeCtrl::GetImageList

调用此函数可检索与树视图控件关联的法线或状态图像列表的句柄。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>参数

*nImageList*<br/>
要检索的图像列表的类型。 图像列表可以为下列值之一：

- TVSIL_NORMAL 检索普通图像列表，其中包含树视图项的所选和 nonselected 图像。

- TVSIL_STATE 检索状态图像列表，其中包含处于用户定义状态的树视图项的图像。

### <a name="return-value"></a>返回值

如果成功，则为指向控件的图像列表的指针;否则为 NULL。

### <a name="remarks"></a>备注

树视图控件中的每一项都可以有一对关联的位图图像。 选择项时，将显示一个图像，而当项处于未选中状态时显示另一个图像。 例如，当某个项处于选中状态时，它可能会显示一个打开的文件夹，并显示未选择的关闭文件夹。

有关图像列表的详细信息，请参阅[CImageList](../../mfc/reference/cimagelist-class.md)类。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

##  <a name="getindent"></a>CTreeCtrl::GetIndent

调用此函数可检索子项相对于其父项的缩进量（以像素为单位）。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>返回值

以像素为单位的缩进量。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

##  <a name="getinsertmarkcolor"></a>CTreeCtrl::GetInsertMarkColor

此成员函数实现 Win32 消息[TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>返回值

包含当前插入标记颜色的 COLORREF 值。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

##  <a name="getitem"></a>CTreeCtrl::GetItem

调用此函数可检索指定树视图项的特性。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>参数

*pItem*<br/>
指向[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构的指针，如 Windows SDK 中所述。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

  请参阅[CTreeCtrl：:D eleteitem](#deleteitem)的示例。

##  <a name="getitemdata"></a>CTreeCtrl::GetItemData

调用此函数可检索与指定项关联的特定于应用程序的值。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其数据的项的句柄。

### <a name="return-value"></a>返回值

与*hItem*指定的项关联的特定于应用程序的指针大小的值。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

##  <a name="getitemexpandedimageindex"></a>CTreeCtrl::GetItemExpandedImageIndex

检索当当前树视图控件的指定项处于展开状态时要显示的图像的索引。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中树视图控件项的句柄。|

### <a name="return-value"></a>返回值

指定项处于展开状态时要显示的图像的索引。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)消息。 该消息将返回描述树视图控件项的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构，然后此方法将从该结构中检索 `iExpandedImage` 成员。

##  <a name="getitemheight"></a>CTreeCtrl::GetItemHeight

此成员函数实现 Win32 消息[TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)的行为，如 Windows SDK 中所述。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>返回值

项的高度（以像素为单位）。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

##  <a name="getitemimage"></a>CTreeCtrl::GetItemImage

树视图控件中的每一项都可以有一对关联的位图图像。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其图像的项的句柄。

*nImage*<br/>
一个整数，用于接收树视图控件的图像列表中项的图像的索引。

*nSelectedImage*<br/>
一个整数，用于接收树视图控件的图像列表中项的选定图像的索引。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

图像显示在项标签的左侧。 选择项时，将显示一个图像，而当项处于未选中状态时显示另一个图像。 例如，当某个项处于选中状态时，它可能会显示一个打开的文件夹，并显示未选择的关闭文件夹。

调用此函数可在树视图控件的图像列表中检索该项的图像的索引及其选定的图像。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

##  <a name="getitempartrect"></a>CTreeCtrl::GetItemPartRect

检索当前树视图控件中指定项的指定部分的边框。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中树视图控件项的句柄。|
|*nPart*|中部件的标识符。 必须设置为 TVGIPR_BUTTON。|
|*lpRect*|弄指向[RECT](/previous-versions/dd162897\(v=vs.85\))结构的指针。 如果此方法成功，则结构将接收由*hItem*和*nPart*指定的部分的矩形坐标。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

每个树控件项都由一个图形矩形界定。 只要单击该矩形中的某个点，就会被称为 "*命中*"。 此方法返回最大的矩形，以便在单击矩形中的某个点时，将命中由*hItem*参数标识的项。

此方法发送 Windows SDK 中描述的 TVM_GETITEMPARTRECT 消息。 有关详细信息，请参阅[TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)宏。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例使用可访问性标识符，使用[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)方法检索根树视图项的句柄。 然后，该示例使用该句柄和[CTreeCtrl::GetItemPartRect](#getitempartrect)方法在该项周围绘制一个三维矩形。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。 使用[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)方法将根树视图项与可访问性标识符相关联。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="getitemrect"></a>CTreeCtrl::GetItemRect

调用此函数可检索*hItem*的边框，并确定它是否可见。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树视图控件项的句柄。

*lpRect*<br/>
指向接收边框的[RECT](/previous-versions/dd162897\(v=vs.85\))结构的指针。 坐标相对于树视图控件的左上角。

*bTextOnly*<br/>
如果此参数为非零，则边框仅包含项的文本。 否则，它包括项在树视图控件中所占的整行。

### <a name="return-value"></a>返回值

如果该项可见，则为非零，其中包含*lpRect*中的边框。 否则为0， *lpRect*未初始化。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

##  <a name="getitemstate"></a>CTreeCtrl::GetItemState

返回由*hItem*指定的项的状态。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其状态的项的句柄。

*nStateMask*<br/>
指示要检索的一个或多个状态的掩码。 有关*nStateMask*的可能值的详细信息，请参阅 Windows SDK 中的 [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) 结构的`state`和`stateMask`成员的讨论。

### <a name="return-value"></a>返回值

一个 UINT，保存 nStateMask 指定的值的按位 "或"。 有关可能值的信息，请参阅[CTreeCtrl::GetItem](#getitem)。 若要查找特定状态的值，请对状态值和返回值执行按位 "与" 运算，如下面的示例中所示。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

##  <a name="getitemstateex"></a>CTreeCtrl::GetItemStateEx

检索当前树视图控件中指定项的扩展状态。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中树视图控件项的句柄。|

### <a name="return-value"></a>返回值

项的扩展状态。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的 `uStateEx` 成员。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)消息。 该消息返回描述树视图控件项的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构，此方法从该结构检索 `uStateEx` 成员。

##  <a name="getitemtext"></a>  CTreeCtrl::GetItemText

返回由*hItem*指定的项的文本。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其文本的项的句柄。

### <a name="return-value"></a>返回值

一个包含项文本的 `CString` 对象。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetNextItem](#getnextitem)的示例。

##  <a name="getlastvisibleitem"></a>CTreeCtrl::GetLastVisibleItem

检索当前树视图控件中的最后一个未展开的节点项。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>返回值

如果方法成功，则为最后一个未展开节点项的句柄;否则为 NULL。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem)消息。 有关详细信息，请参阅该消息的*标记*参数中的 TVGN_LASTVISIBLE 标志。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下一个示例中使用了这些变量中的一个或多个。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例检索最后未展开的树视图节点项的句柄，然后在该项的周围绘制一个三维矩形。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

##  <a name="getlinecolor"></a>CTreeCtrl::GetLineColor

此成员函数实现 Win32 消息[TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>返回值

当前线条的颜色。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

##  <a name="getnextitem"></a>CTreeCtrl::GetNextItem

调用此函数可检索具有指定关系的树视图项（由*nCode*参数指示）到*hItem*。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

*nCode*<br/>
一个标志，用于指示与*hItem*的关系的类型。 此标志可以是下列值之一：

- TVGN_CARET 检索当前选定的项。

- TVGN_CHILD 检索由*hItem*参数指定的项的第一个子项。

- TVGN_DROPHILITE 检索作为拖放操作目标的项。

- TVGN_FIRSTVISIBLE 检索第一个可见项。

- TVGN_LASTVISIBLE 检索树中最后一个展开的项。 这不会检索树视图窗口中显示的最后一项。

- TVGN_NEXT 检索下一个同级项。

- TVGN_NEXTVISIBLE 检索指定项之后的下一个可见项。

- TVGN_PARENT 检索指定项的父项。

- TVGN_PREVIOUS 检索上一个同级项。

- TVGN_PREVIOUSVISIBLE 检索指定项之前的第一个可见项。

- TVGN_ROOT 检索指定项所属的根项的第一个子项。

### <a name="return-value"></a>返回值

如果成功，则为下一项的句柄;否则为 NULL。

### <a name="remarks"></a>备注

如果要检索的项是树的根节点，则此函数将返回 NULL。 例如，如果您将此消息与树视图根节点的第一级子节点上的 TVGN_PARENT 标志一起使用，则该消息将返回 NULL。

### <a name="example"></a>示例

有关在循环中使用 `GetNextItem` 的示例，请参阅[CTreeCtrl：:D eleteitem](#deleteitem)。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

##  <a name="getnextsiblingitem"></a>CTreeCtrl::GetNextSiblingItem

调用此函数可检索*hItem*的下一个同级元素。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

下一个同级项的句柄;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

##  <a name="getnextvisibleitem"></a>CTreeCtrl::GetNextVisibleItem

调用此函数可检索*hItem*的下一个可见项。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

下一个可见项的句柄;否则为 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetCheck](#setcheck)的示例。

##  <a name="getparentitem"></a>CTreeCtrl::GetParentItem

调用此函数可检索*hItem*的父对象。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

父项的句柄;否则为 NULL。

### <a name="remarks"></a>备注

如果指定项的父项为树的根节点，则此函数将返回 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::ensurevisible\](#ensurevisible)的示例。

##  <a name="getprevsiblingitem"></a>CTreeCtrl::GetPrevSiblingItem

调用此函数可检索*hItem*的上一个同级元素。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

上一个同级的句柄;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

##  <a name="getprevvisibleitem"></a>CTreeCtrl::GetPrevVisibleItem

调用此函数可检索*hItem*的上一个可见项。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

上一个可见项的句柄;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

##  <a name="getrootitem"></a>CTreeCtrl::GetRootItem

调用此函数可检索树视图控件的根项。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>返回值

根项的句柄;否则为 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::EditLabel](#editlabel)的示例。

##  <a name="getscrolltime"></a>CTreeCtrl::GetScrollTime

调用此成员函数以检索树视图控件的最长滚动时间。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>返回值

最长滚动时间（以毫秒为单位）。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)的行为，如 Windows SDK 中所述。

##  <a name="getselectedcount"></a>CTreeCtrl::GetSelectedCount

检索当前树视图控件中选定项的数目。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>返回值

选定项的数目。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount)消息。

##  <a name="getselecteditem"></a>CTreeCtrl::GetSelectedItem

调用此函数可检索树视图控件的当前选定项。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>返回值

选定项的句柄;否则为 NULL。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

##  <a name="gettextcolor"></a>CTreeCtrl::GetTextColor

此成员函数实现 Win32 消息[TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)的行为，如 Windows SDK 中所述。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>返回值

一个表示当前文本颜色的 COLORREF 值。 如果此值为-1，则控件使用文本颜色的系统颜色。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetTextColor](#settextcolor)的示例。

##  <a name="gettooltips"></a>CTreeCtrl::GetToolTips

此成员函数实现 Win32 消息[TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)的行为，如 Windows SDK 中所述。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>返回值

指向要由树控件使用的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针。 如果[Create](#create)成员函数使用样式 TVS_NOTOOLTIPS，则不会使用任何工具提示，并返回 NULL。

### <a name="remarks"></a>备注

`GetToolTips` 的 MFC 实现将返回一个 `CToolTipCtrl` 对象，该对象由树控件使用，而不是工具提示控件的句柄。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

##  <a name="getvisiblecount"></a>CTreeCtrl::GetVisibleCount

调用此函数可在树视图控件中检索可见项的计数。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>返回值

树视图控件中可见项的数目;否则为-1。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetCheck](#setcheck)的示例。

##  <a name="hittest"></a>CTreeCtrl::System.windows.media.visualtreehelper.hittest

调用此函数可确定指定点相对于树视图控件的工作区的位置。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>参数

*pt*<br/>
要测试的点的工作区坐标。

*pFlags*<br/>
指向一个整数的指针，该整数接收有关命中测试结果的信息。 它可以是 "备注" 部分中 "`flags`" 成员下列出的一个或多个值。

*pHitTestInfo*<br/>
[TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)结构的地址，该结构包含要进行命中测试的位置并接收有关命中测试结果的信息。

### <a name="return-value"></a>返回值

占用指定点的树视图项的句柄; 如果没有项占据点，则为 NULL。

### <a name="remarks"></a>备注

调用此函数时， *pt*参数指定要测试的点的坐标。 该函数返回位于指定点处的项的句柄; 如果没有项，则返回 NULL。 此外， *pFlags*参数包含一个值，该值指示指定点的位置。 可能的值有：

|||
|-|-|
|{2&gt;值&lt;2}|含义|
|TVHT_ABOVE|工作区之上。|
|TVHT_BELOW|低于工作区。|
|TVHT_NOWHERE|在工作区中，但在最后一项下。|
|TVHT_ONITEM|与项关联的位图或标签。|
|TVHT_ONITEMBUTTON|与项关联的按钮上的。|
|TVHT_ONITEMICON|与项关联的位图。|
|TVHT_ONITEMINDENT|与项关联的缩进。|
|TVHT_ONITEMLABEL|与项关联的标签（字符串）。|
|TVHT_ONITEMRIGHT|项的右侧区域中。|
|TVHT_ONITEMSTATEICON|处于用户定义状态的树视图项的状态图标上。|
|TVHT_TOLEFT|工作区的左侧。|
|TVHT_TORIGHT|到工作区右侧。|
|||

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="insertitem"></a>CTreeCtrl::InsertItem

调用此函数可在树视图控件中插入新项。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>参数

*lpInsertStruct*<br/>
一个指向 `TVINSERTSTRUCT` 的指针，该指针指定要插入的树视图项的特性。

*nMask*<br/>
整数，用于指定要设置的特性。 请参阅 Windows SDK 中的 `TVITEM` 结构。

*lpszItem*<br/>
包含该项文本的字符串的地址。

*nImage*<br/>
树视图控件的图像列表中项的图像的索引。

*nSelectedImage*<br/>
树视图控件的图像列表中项的选定图像的索引。

*nState*<br/>
指定项的状态值。 有关相应状态的列表，请参阅 Windows SDK 中的树视图控件项目状态。

*nStateMask*<br/>
指定要设置的状态。 请参阅 Windows SDK 中的 `TVITEM` 结构。

*lParam*<br/>
与项关联的指针大小的特定于应用程序的值。

*hParent*<br/>
插入项的父项的句柄。

*hInsertAfter*<br/>
要在其后插入新项的项的句柄。

### <a name="return-value"></a>返回值

如果成功，则为新项的句柄;否则为 NULL。

### <a name="remarks"></a>备注

该示例显示了在插入树控件项时可能需要使用该函数的每个版本的情况。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

##  <a name="itemhaschildren"></a>CTreeCtrl::ItemHasChildren

使用此函数可确定*hItem*指定的树项是否具有子项。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果由*hItem*指定的树项具有子项，则为非零值;如果不是，则为0。

### <a name="remarks"></a>备注

如果是这样，则可以使用[CTreeCtrl::GetChildItem](#getchilditem)来检索这些子项目。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetSelectedItem](#getselecteditem)的示例。

##  <a name="mapaccidtoitem"></a>CTreeCtrl::MapAccIdToItem

将指定的可访问性标识符映射到当前树视图控件中的树视图项的句柄。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*uAccId*|中树视图项中元素的辅助功能标识符。|

### <a name="return-value"></a>返回值

与*uAccId*参数相对应的树视图项（`HTREEITEM`）的句柄。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的*hItem*成员。

### <a name="remarks"></a>备注

辅助功能辅助工具是帮助残障人士使用计算机的应用程序。 辅助功能标识符由 `IAccessible` 接口用于在窗口中唯一指定元素。 有关辅助功能标识符的详细信息，请在[Microsoft 开发人员网络](https://go.microsoft.com/fwlink/p/?linkid=56322)中搜索 "关于 Active Accessibility 支持" 主题。

此方法发送 Windows SDK 中描述的[TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem)消息。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例使用可访问性标识符，使用[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)方法检索根树视图项的句柄。 该示例使用了句柄和[CTreeCtrl::GetItemPartRect](#getitempartrect)方法在该项周围绘制一个三维矩形。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。 使用[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)方法将根树视图项与可访问性标识符相关联。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="mapitemtoaccid"></a>CTreeCtrl::MapItemToAccID

将当前树视图控件中的树视图项的指定句柄映射到辅助功能标识符。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中控件中的树视图项的句柄。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的*hItem*成员。|

### <a name="return-value"></a>返回值

与*hItem*参数相对应的可访问性标识符。

### <a name="remarks"></a>备注

辅助功能辅助工具是帮助残障人士使用计算机的应用程序。 辅助功能标识符由 `IAccessible` 接口用于在窗口中唯一指定元素。 有关辅助功能标识符的详细信息，请在[Microsoft 开发人员网络](https://go.microsoft.com/fwlink/p/?linkid=56322)中搜索 "关于 Active Accessibility 支持" 主题。

此方法发送 Windows SDK 中描述的[TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid)消息。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例获取树视图控件项的标识号。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。 此代码示例获取根国家/地区节点的唯一标识号。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

##  <a name="select"></a>CTreeCtrl::Select

调用此函数以选择给定的树视图项，将该项滚动到视图中，或重新绘制样式中用于指示拖放操作目标的项。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

*nCode*<br/>
要执行的操作的类型。 此参数可以是下列值之一：

- TVGN_CARET 将所选内容设置为给定项。

- TVGN_DROPHILITE 重绘样式中指定的项，该样式用于指示拖放操作的目标。

- TVGN_FIRSTVISIBLE 垂直滚动树视图，以便给定项是第一个可见项。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果*nCode*包含 TVGN_CARET 的值，则父窗口将接收 TVN_SELCHANGING 并 TVN_SELCHANGED 通知消息。 此外，如果指定的项是折叠的父项的子项，则将展开其父项列表以显示指定项。 在这种情况下，父窗口会接收 TVN_ITEMEXPANDING 并 TVN_ITEMEXPANDED 通知消息。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::system.windows.media.visualtreehelper.hittest](#hittest)的示例。

##  <a name="selectdroptarget"></a>  CTreeCtrl::SelectDropTarget

调用此函数可重绘样式中用于指示拖放操作目标的项。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="selectitem"></a>CTreeCtrl::SelectItem

调用此函数可选择给定的树视图项。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果*hItem*为 NULL，则此函数不选择任何项。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="selectsetfirstvisible"></a>CTreeCtrl::SelectSetFirstVisible

调用此函数可垂直滚动树视图，以便给定的项是第一个可见项。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置为第一个可见项的树项的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

函数向窗口发送一条消息，其中包含 TVM_SELECTITEM 和 TVGN_FIRSTVISIBLE 消息参数。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

##  <a name="setautoscrollinfo"></a>  CTreeCtrl::SetAutoscrollInfo

设置当前树视图控件的自动滚动速率。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*uPixelsPerSec*|中每秒滚动的像素数。|
|*uUpdateTime*|中控件更新之间的时间间隔。|

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

自动滚动参数用于滚动查看当前不可见的项。 树视图控件必须具有 TVS_EX_AUTOHSCROLL 扩展样式，该样式在[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)中进行了介绍。

此方法发送 Windows SDK 中描述的[TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo)消息。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例设置当前树视图控件的自动滚动行为。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。 我们有意使树视图控件变窄，使其必须自动滚动显示具有焦点的树项。 此代码示例将树视图控件设置为每隔5秒自动滚动30个像素，直到树项处于视图状态。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

##  <a name="setbkcolor"></a>CTreeCtrl::SetBkColor

此成员函数实现 Win32 消息[TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>参数

*clr*<br/>
一个包含新背景色的 COLORREF 值。 如果此值为-1，则控件将恢复为使用背景色的系统颜色。

### <a name="return-value"></a>返回值

一个表示当前文本颜色的 COLORREF 值。 如果此值为-1，则控件使用文本颜色的系统颜色。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::SetTextColor](#settextcolor)的示例。

##  <a name="setcheck"></a>CTreeCtrl::SetCheck

调用此成员函数以设置树控件项的检查状态。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要接收检查状态更改的 HTREEITEM。

*fCheck*<br/>
指示是否选中或取消选中树控件项。 默认情况下，`SetCheck` 设置要检查的项。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果选中了树控件项（*查看*设置为 TRUE），则该项将显示旁边的复选标记。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>示例

若要使用 checkbox，请在填充树控件之前设置 TVS_CHECKBOXES。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

##  <a name="setextendedstyle"></a>CTreeCtrl::SetExtendedStyle

设置当前树视图控件的扩展样式。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*dwExMask*|中一个位掩码，指定当前树视图控件中的哪些样式受此方法的影响。 如果此参数为零，则将其忽略，并将*dwExStyles*参数的值分配给树视图控件。<br /><br /> 指定[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所述样式的零个或一个按位组合（or）。|
|*dwExStyles*|中一个位掩码，指定当前树视图控件中要设置或清除的样式。<br /><br /> 若要设置样式组合，请指定[树视图控件扩展样式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所述样式的按位组合（OR）。 若要清除一组样式，请指定0。|

### <a name="return-value"></a>返回值

一个值，该值包含以前的扩展控件样式。

### <a name="remarks"></a>备注

此方法清除*dwExMask*参数中指定的样式，并设置*dwExStyles*参数中指定的样式。 只有与*dwExMask*中的位相对应的扩展样式发生更改。

此方法发送 Windows SDK 中描述的[TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle)消息。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例将 TVS_EX_AUTOHSCROLL 扩展样式添加到当前树视图控件。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。 我们有意使树视图控件变窄，使其必须自动滚动显示具有焦点的树项。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

##  <a name="setimagelist"></a>CTreeCtrl::SetImageList

调用此函数可设置树视图控件的正常或状态图像列表，并使用新图像重绘控件。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>参数

*pImageList*<br/>
指向要分配的图像列表的指针。 如果*pImageList*为 NULL，则将从树视图控件中删除所有图像。

*nImageListType*<br/>
要设置的图像列表的类型。 图像列表可以为下列值之一：

- TVSIL_NORMAL 设置 "普通图像" 列表，其中包含树视图项的所选和 nonselected 图像。 必须为覆盖映像使用此状态。

- TVSIL_STATE 设置状态图像列表，其中包含处于用户定义状态的树视图项的图像。

### <a name="return-value"></a>返回值

指向上一个图像列表的指针（如果有）;否则为 NULL。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetImageList](#getimagelist)的示例。

##  <a name="setindent"></a>CTreeCtrl::SetIndent

调用此函数可设置树视图控件的缩进宽度，并重新绘制控件以反映新的宽度。

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>参数

*nIndent*<br/>
缩进的宽度（以像素为单位）。 如果*nIndent*小于系统定义的最小宽度，则新的宽度设置为系统定义的最小值。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetIndent](#getindent)的示例。

##  <a name="setinsertmark"></a>CTreeCtrl::SetInsertMark

此成员函数实现 Win32 消息[TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)的行为，如 Windows SDK 中所述。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>参数

*hItem*<br/>
HTREEITEM，指定插入标记的放置位置。 如果此参数为 NULL，则删除插入标记。

*fAfter*<br/>
指定在指定项之前还是之后放置插入标记的布尔值。 如果此参数为非零，则插入标记将被置于该项之后。 如果此参数为零，则插入标记将放在项的前面。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

##  <a name="setinsertmarkcolor"></a>CTreeCtrl::SetInsertMarkColor

此成员函数实现 Win32 消息[TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)的行为，如 Windows SDK 中所述。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>参数

*clrNew*<br/>
一个包含新插入标记颜色的 COLORREF 值。

### <a name="return-value"></a>返回值

一个包含前一插入标记颜色的 COLORREF 值。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)的示例。

##  <a name="setitem"></a>CTreeCtrl::SetItem

调用此函数可设置指定树视图项的特性。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>参数

*pItem*<br/>
指向[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构的指针，该结构包含新的项特性，如 Windows SDK 中所述。

*hItem*<br/>
要设置其属性的项的句柄。 请参阅 Windows SDK 中 `TVITEM` 结构的 `hItem` 成员。

*nMask*<br/>
整数，用于指定要设置的特性。 查看 `TVITEM` 结构的 `mask` 成员。

*lpszItem*<br/>
包含该项文本的字符串的地址。

*nImage*<br/>
树视图控件的图像列表中项的图像的索引。 查看 `TVITEM` 结构的 `iImage` 成员。

*nSelectedImage*<br/>
树视图控件的图像列表中项的选定图像的索引。 查看 `TVITEM` 结构的 `iSelectedImage` 成员。

*nState*<br/>
指定项的状态值。 查看 `TVITEM` 结构的 `State` 成员。

*nStateMask*<br/>
指定要设置的状态。 查看 `TVITEM` 结构的 `stateMask` 成员。

*lParam*<br/>
与项关联的指针大小的特定于应用程序的值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

在 `TVITEM` 结构中，`hItem` 成员标识项，`mask` 成员指定要设置的特性。

如果 `mask` 成员或*nMask*参数指定了 TVIF_TEXT 值，则 `pszText` 成员或*lpszItem*为以 null 结尾的字符串的地址，并且忽略 `cchTextMax` 成员。 如果 `mask` （或*nMask*）指定 TVIF_STATE 值，则 `stateMask` 成员或*nStateMask*参数指定要更改的项状态，并且 `state` 成员或*nState*参数包含这些状态的值。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

##  <a name="setitemdata"></a>CTreeCtrl::SetItemData

调用此函数可设置与指定项关联的应用程序特定的值。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要检索其数据的项的句柄。

*dwData*<br/>
与*hItem*指定的项关联的特定于应用程序的指针大小的值。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

##  <a name="setitemexpandedimageindex"></a>CTreeCtrl::SetItemExpandedImageIndex

设置在当前树视图控件的指定项处于展开状态时要显示的图像的索引。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中树视图控件项的句柄。|
|*iExpandedImage*|中指定项处于展开状态时要显示的图像的索引。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)消息。 此方法将*iExpandedImage*参数分配给[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的 `iExpandedImage` 成员，然后在消息中使用该结构。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例是一个简单的测试，用于确定[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)方法是否返回由[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)方法设置的值。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

##  <a name="setitemheight"></a>CTreeCtrl::SetItemHeight

此成员函数实现 Win32 消息[TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)的行为，如 Windows SDK 中所述。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>参数

*cyHeight*<br/>
指定树视图中每个项的新高度（以像素为单位）。 如果此参数小于图像的高度，则将其设置为图像的高度。 如果此参数不为偶数，则将向下舍入到最接近的偶数值。 如果此参数为-1，则控件将恢复为使用其默认项高度。

### <a name="return-value"></a>返回值

项的上一高度（以像素为单位）。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetItemHeight](#getitemheight)的示例。

##  <a name="setitemimage"></a>CTreeCtrl::SetItemImage

将图像与项关联。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置其图像的项的句柄。

*nImage*<br/>
树视图控件的图像列表中项的图像的索引。

*nSelectedImage*<br/>
树视图控件的图像列表中项的选定图像的索引。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

树视图控件中的每一项都可以有一对关联的位图图像。 图像显示在项标签的左侧。 选择项时，将显示一个图像，而当项处于未选中状态时显示另一个图像。 例如，当某个项处于选中状态时，它可能会显示一个打开的文件夹，并显示未选择的关闭文件夹。

调用此函数可在树视图控件的图像列表中设置该项的图像的索引及其选定的图像。

有关映像的详细信息，请参阅[CImageList](../../mfc/reference/cimagelist-class.md)。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetItemImage](#getitemimage)的示例。

##  <a name="setitemstate"></a>CTreeCtrl::SetItemState

设置*hItem*指定的项的状态。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置其状态的项的句柄。

*nState*<br/>
指定项的新状态。

*nStateMask*<br/>
指定要更改的状态。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

有关状态的信息，请参阅[CTreeCtrl::GetItem](#getitem)。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetItemState](#getitemstate)的示例。

##  <a name="setitemstateex"></a>CTreeCtrl::SetItemStateEx

设置当前树视图控件中指定项的扩展状态。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中树视图控件项的句柄。|
|*uStateEx*|中项的扩展状态。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的 `uStateEx` 成员。|

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

此方法发送 Windows SDK 中描述的[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)消息。 此方法将*uStateEx*参数分配给[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的 `uStateEx` 成员，然后在消息中使用该结构。

### <a name="example"></a>示例

下面的代码示例定义了一个用于访问当前树视图控件的变量 `m_treeCtrl`。 此代码示例还定义了一个无符号整数和多个 HTREEITEM 变量。 下面的示例中使用了这些变量。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>示例

下面的代码示例将树视图项设置为 "已禁用" 状态。 在代码示例的前面部分（未显示）中，我们创建了一个树视图，其中包含用于美国的根国家/地区节点、用于表示宾夕法尼亚州和华盛顿州的子节点，以及处于这些状态的城市的树项。 此代码示例将宾夕法尼亚节点设置为已禁用状态。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

##  <a name="setitemtext"></a>  CTreeCtrl::SetItemText

设置*hItem*指定的项的文本。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要设置其文本的项的句柄。

*lpszItem*<br/>
包含项的新文本的字符串的地址

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

##  <a name="setlinecolor"></a>CTreeCtrl::SetLineColor

调用此成员函数可设置树视图控件的当前线条颜色。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>参数

*clrNew*<br/>
新线条的颜色。

### <a name="return-value"></a>返回值

上一行的颜色。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)的行为，如 Windows SDK 中所述。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

##  <a name="setscrolltime"></a>CTreeCtrl::SetScrollTime

调用此成员函数可设置树视图控件的最长滚动时间。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>参数

*uScrollTime*<br/>
新的最大滚动时间（以毫秒为单位）。 如果此值小于100，则将向上舍入到100。

### <a name="return-value"></a>返回值

上一个最长滚动时间（以毫秒为单位）。

### <a name="remarks"></a>备注

此成员函数实现 Win32 消息[TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)的行为，如 Windows SDK 中所述。

##  <a name="settextcolor"></a>CTreeCtrl::SetTextColor

此成员函数实现 Win32 消息[TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)的行为，如 Windows SDK 中所述。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>参数

*clr*<br/>
一个包含新文本颜色的 COLORREF 值。 如果此参数为-1，则控件将恢复为使用文本颜色的系统颜色。

### <a name="return-value"></a>返回值

表示以前的文本颜色的 COLORREF 值。 如果此值为-1，则控件使用的是文本颜色的系统颜色。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

##  <a name="settooltips"></a>CTreeCtrl::SetToolTips

此成员函数实现 Win32 消息[TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)的行为，如 Windows SDK 中所述。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>参数

*pWndTip*<br/>
指向树控件将使用的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针。

### <a name="return-value"></a>返回值

指向[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象的指针，该对象包含控件以前使用的工具提示; 如果以前未使用任何工具提示，则为 NULL。

### <a name="remarks"></a>备注

若要使用工具提示，请在创建 `CTreeCtrl` 对象时指示 TVS_NOTOOLTIPS 样式。

### <a name="example"></a>示例

  请参阅[CTreeCtrl::GetToolTips](#gettooltips)的示例。

##  <a name="showinfotip"></a>CTreeCtrl::ShowInfoTip

显示当前树视图控件中指定项的信息提示。

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

|参数|描述|
|---------------|-----------------|
|*hItem*|中控件中的树视图项的句柄。 有关详细信息，请参阅[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)结构的 `hItem` 成员。|

### <a name="remarks"></a>备注

有关 tooltip 和信息提示之间的区别的详细信息，请在[Microsoft 开发人员网络](https://go.microsoft.com/fwlink/p/?linkid=56322)上搜索 "Tooltip 和信息提示" 主题。

此方法发送 Windows SDK 中描述的[TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip)消息。

##  <a name="sortchildren"></a>CTreeCtrl::SortChildren

调用此函数可在树视图控件中按字母顺序排序给定父项的子项。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>参数

*hItem*<br/>
要对其子项进行排序的父项的句柄。 如果*hItem*为 NULL，则将从树的根开始进行排序。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

`SortChildren` 不会通过树递归;只有*hItem*的直接子项才会进行排序。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

##  <a name="sortchildrencb"></a>CTreeCtrl::SortChildrenCB

使用应用程序定义的、用于比较项的回调函数调用此函数对树视图项进行排序。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>参数

*pSort*<br/>
指向[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)结构的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果第一个项应在第二个项的前面，则结构的比较函数 `lpfnCompare`返回一个负值; 如果第一项应在第二个项后，则返回正值; 如果两个项相等，则返回零。

*LParam1*和*lParam2*参数对应于所比较的两个项的[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)结构的 `lParam` 成员。 *LParamSort*参数对应于 `TV_SORTCB` 结构的 `lParam` 成员。

### <a name="example"></a>示例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>另请参阅

[MFC 示例 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd 类](../../mfc/reference/cwnd-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[CImageList 类](../../mfc/reference/cimagelist-class.md)
