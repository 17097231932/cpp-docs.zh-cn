---
title: "CMFCPopupMenu 类 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
dev_langs: C++
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
caps.latest.revision: "40"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.openlocfilehash: 36057304130150dbd12cf33f708d1d82cd52e0c4
ms.sourcegitcommit: ebec1d449f2bd98aa851667c2bfeb7e27ce657b2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/24/2017
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu 类
实现 Windows 弹出菜单功能，并通过添加可拖曳菜单和工具提示等功能进行扩展。
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]    
  
## <a name="syntax"></a>语法  
  
```  
class CMFCPopupMenu : public CMiniFrameWnd  
```  
  
## <a name="members"></a>成员  
  
### <a name="protected-constructors"></a>受保护的构造函数  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCPopupMenu::CMFCPopupMenu](#cmfcpopupmenu)|构造 `CMFCPopupMenu` 对象。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||  
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|设置是否启用弹出菜单以显示用户定义的工具的空项。|  
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||  
|[CMFCPopupMenu::CheckArea](#checkarea)|确定相对于弹出菜单的点的位置。|  
|[CMFCPopupMenu::CloseMenu](#closemenu)||  
|[CMFCPopupMenu::Create](#create)|创建弹出菜单，并将其附加到`CMFCPopupMenu`对象。|  
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||  
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|初始化一个弹出菜单的徽标。|  
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|启用菜单声音。|  
|[CMFCPopupMenu::EnableResize](#enableresize)||  
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||  
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||  
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||  
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|返回当前处于活动状态的菜单。|  
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|返回对于弹出菜单的动画速度。|  
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|返回弹出菜单动画的当前类型。|  
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||  
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|指示是否将焦点返回到菜单栏中显示一个弹出菜单时。|  
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||  
|[CMFCPopupMenu::GetHMenu](#gethmenu)|返回附加的菜单资源的句柄。|  
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|返回[CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md)嵌入网络模块内的弹出菜单。|  
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|将指针返回到指定索引处的菜单项。|  
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|在弹出菜单中返回的项数。|  
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|返回指向其中框架将传送的弹出菜单消息窗口的指针。|  
|[CMFCPopupMenu::GetParentArea](#getparentarea)||  
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|将指针返回到父工具栏按钮。|  
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|返回指向父弹出菜单的指针。|  
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||  
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|将指针返回到父工具栏。|  
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||  
|[CMFCPopupMenu::GetSelItem](#getselitem)|将指针返回到当前选定的菜单命令。|  
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||  
|[CMFCPopupMenu::HideRarelyUsedCommands](#hiderarelyusedcommands)|指示弹出菜单是否可以隐藏很少使用的命令。|  
|[CMFCPopupMenu::InCommand](#incommand)||  
|[CMFCPopupMenu::InsertItem](#insertitem)|将新项插入到指定位置的弹出菜单。|  
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|位于指定位置的弹出菜单中插入分隔符。|  
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||  
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||  
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|指示弹出菜单充当**QuickCustomizePane**。|  
|[CMFCPopupMenu::IsEscClose](#isescclose)||  
|[CMFCPopupMenu::IsIdle](#isidle)|指示弹出菜单是否当前处于空闲状态。|  
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||  
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|确定是否关联[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)处于 QuickCustomize 模式。|  
|[CMFCPopupMenu::IsResizeble](#isresizeble)||  
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|指示菜单是右对齐还是左对齐。|  
|[CMFCPopupMenu::IsScrollable](#isscrollable)||  
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|指示当用户从弹出菜单中选择命令时，框架是否通知的父框架。|  
|[CMFCPopupMenu::IsShown](#isshown)|指示弹出菜单是否处于当前可见。|  
|[CMFCPopupMenu::MoveTo](#moveto)||  
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|（重写 `CFrameWnd::OnCmdMsg`。）|  
|[CMFCPopupMenu::PostCommand](#postcommand)||  
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|（重写 `CFrameWnd::PreTranslateMessage`。）|  
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|标准控件条打开或关闭时或在框架窗口调整大小时，由框架调用。 (重写[CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。)|  
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|清除弹出菜单中的所有项。|  
|[CMFCPopupMenu::RemoveItem](#removeitem)|从弹出菜单中删除指定的项。|  
|[CMFCPopupMenu::SaveState](#savestate)||  
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|设置对于弹出菜单的动画速度。|  
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|将弹出菜单的动画类型的设置。|  
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||  
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|设置的弹出菜单的默认命令。|  
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|强制在输入的焦点返回到菜单栏中显示一个弹出菜单时。|  
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|强制外主框架显示弹出菜单时绘制菜单阴影的框架。|  
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|设置的弹出菜单的最大宽度。|  
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||  
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||  
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||  
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||  
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|设置弹出菜单的菜单对齐方式。|  
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|设置用于控制是否弹出菜单通知其父框架，当用户选择命令的标志。|  
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|强制弹出菜单以显示所有命令。|  
|[CMFCPopupMenu::TriggerResize](#triggerresize)||  
|[CMFCPopupMenu::UpdateAllShadows](#updateallshadows)|更新所有打开的弹出菜单的阴影。|  
|[CMFCPopupMenu::UpdateShadow](#updateshadow)|更新个弹出菜单的阴影。|  
  
### <a name="protected-methods"></a>受保护的方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||  
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||  
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||  
  
### <a name="remarks"></a>备注  
 通常情况下，MFC 将自动创建弹出菜单。 如果你想要创建`CMFCPopupMenu`手动对象，一个在堆分配，然后调用[CMFCPopupMenu::Create](#create)。  
  
## <a name="example"></a>示例  
 下面的示例演示如何配置的弹出菜单对象。 该示例演示如何设置徽标和弹出菜单的声音、 设置动画速度和类型、 外部主框架显示的弹出菜单时绘制菜单阴影、 设置的最大宽度和设置的弹出菜单的右菜单对齐方式。 此代码片段属于[自定义页示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CFrameWnd](../../mfc/reference/cframewnd-class.md)  
  
 [CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)  
  
 `CMFCPopupMenu`  
  
## <a name="requirements"></a>要求  
 **标头：** afxpopupmenu.h  
  
##  <a name="activatepopupmenu"></a>CMFCPopupMenu::ActivatePopupMenu  

  
```  
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,  
    CMFCPopupMenu* pPopupMenu);
```  
  
### <a name="parameters"></a>参数  
 [in] `pTopFrame`  
 [in] `pPopupMenu`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="alwaysshowemptytoolsentry"></a>CMFCPopupMenu::AlwaysShowEmptyToolsEntry  
 设置是否启用弹出菜单以显示用户定义的工具的空项。  
  
```  
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bShow`  
 `TRUE`如果弹出菜单可以显示空条目;`FALSE`否则为。  
  
##  <a name="areallcommandsshown"></a>CMFCPopupMenu::AreAllCommandsShown  

  
```  
BOOL AreAllCommandsShown() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="checkarea"></a>CMFCPopupMenu::CheckArea  
 确定相对于弹出菜单的点的位置。  
  
```  
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `ptScreen`  
 屏幕坐标中的点。  
  
### <a name="return-value"></a>返回值  
 表示点弹出菜单相对其中一个 MENUAREA_TYPE 参数。  
  
### <a name="remarks"></a>备注  
 MENUAREA_TYPE 参数可以具有以下值之一。  
  
-   外部-`ptScreen`弹出菜单之外。  
  
-   徽标-`ptScreen`是段徽标区域。  
  
-   TEAROFF_CAPTION-`ptScreen`高于拖曳标题。  
  
-   SHADOW_BOTTOM-`ptScreen`是段底部阴影的弹出菜单。  
  
-   SHADOW_RIGHT-`ptScreen`是段右阴影的弹出菜单。  
  
-   菜单-`ptScreen`高于命令。  
  
##  <a name="closemenu"></a>CMFCPopupMenu::CloseMenu  

  
```  
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bSetFocusToBar`  
  
### <a name="remarks"></a>备注  
  
##  <a name="cmfcpopupmenu"></a>CMFCPopupMenu::CMFCPopupMenu  
 构造[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)对象。  
  
```  
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,  
    LPCTSTR lpszTitle);
```  
  
### <a name="parameters"></a>参数  
 [in] `pCustPage`  
 指向自定义页的指针。  
  
 [in] `lpszTitle`  
 包含菜单标题的字符串。  
  
### <a name="remarks"></a>备注  
 此方法分配的资源`CMFCPopupMenu`。 若要创建弹出菜单项，请调用[CMFCPopupMenu::Create](#create)。  
  
##  <a name="create"></a>CMFCPopupMenu::Create  
 创建弹出菜单，并将其附加到[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)对象。  
  
```  
virtual BOOL Create(
    CWnd* pWndParent,  
    int x,  
    int y,  
    HMENU hMenu,  
    BOOL bLocked = FALSE,  
    BOOL bOwnMessage = FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `pWndParent`  
 父窗口`CMFCPopupMenu`。  
  
 [in] `x`  
 水平屏幕坐标的弹出菜单位置  
  
 [in] `y`  
 弹出菜单的位置垂直屏幕坐标。  
  
 [in] `hMenu`  
 菜单资源的句柄。  
  
 [in] `bLocked`  
 一个布尔型参数，该值指示是否可自定义菜单。 `FALSE`指示弹出菜单是可自定义。  
  
 [in] `bOwnMessage`  
 一个布尔型参数，该值指示该框架将菜单消息的路由。 请参阅备注部分以了解更多信息。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果此方法成功，则否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 如果`bOwnMessage`是`TRUE`，框架将传送到任何菜单消息`pWndParent`。 `pWndParent`不能`NULL`如果`bOwnMessage`是`TRUE.`如果`bOwnMessage`是`FALSE`，框架将传送到父弹出菜单的菜单消息。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`Create`方法`CMFCPopuMenu`类。 此代码片段属于[自定义页示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]  
  
##  <a name="createtearoffbar"></a>CMFCPopupMenu::CreateTearOffBar  

  
```  
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,  
    UINT uiID,  
    LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>参数  
 [in] `pWndMain`  
 [in] `uiID`  
 [in] `lpszName`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="defaultmouseclickonclose"></a>CMFCPopupMenu::DefaultMouseClickOnClose  

  
```  
virtual BOOL DefaultMouseClickOnClose() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="enablemenulogo"></a>CMFCPopupMenu::EnableMenuLogo  
 初始化一个弹出菜单的徽标。  
  
```  
void EnableMenuLogo(
    int iLogoSize,  
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```  
  
### <a name="parameters"></a>参数  
 [in] `iLogoSize`  
 徽标，以像素为单位的大小。  
  
 [in] `nLogoLocation`  
 枚举的数据类型，该值指示徽标的位置。  
  
### <a name="remarks"></a>备注  
 若要显示徽标，实现方法[CFrameWndEx::OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo)主框架窗口中。  
  
 可能值`nLogoLocation`是 MENU_LOGO_LEFT、 MENU_LOGO_RIGHT、 MENU_LOGO_TOP 和 MENU_LOGO_BOTTOM。  
  
##  <a name="enablemenusound"></a>CMFCPopupMenu::EnableMenuSound  
 启用菜单声音。  
  
```  
static void EnableMenuSound(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要启用声音，`FALSE`否则为。  
  
### <a name="remarks"></a>备注  
 如果启用声音，框架将调用[PlaySound](http://msdn.microsoft.com/library/windows/desktop/bb774426)当用户打开一个弹出菜单或选择菜单命令的方法。 默认情况下，启用此功能。  
  
##  <a name="enableresize"></a>CMFCPopupMenu::EnableResize  

  
```  
void EnableResize(CSize sizeMinResize);
```  
  
### <a name="parameters"></a>参数  
 [in] `sizeMinResize`  
  
### <a name="remarks"></a>备注  
  
##  <a name="enablescrolling"></a>CMFCPopupMenu::EnableScrolling  

  
```  
void EnableScrolling(BOOL = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `BOOL`  
  
### <a name="remarks"></a>备注  
  
##  <a name="enablevertresize"></a>CMFCPopupMenu::EnableVertResize  

  
```  
void EnableVertResize(int nMinResize);
```  
  
### <a name="parameters"></a>参数  
 [in] `nMinResize`  
  
### <a name="remarks"></a>备注  
  
##  <a name="findsubitembycommand"></a>CMFCPopupMenu::FindSubItemByCommand  

  
```  
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getactivemenu"></a>CMFCPopupMenu::GetActiveMenu  
 返回当前处于活动状态的菜单。  
  
```  
static CMFCPopupMenu* GetActiveMenu();
```  
  
### <a name="return-value"></a>返回值  
 活动的弹出菜单或如果没有弹出菜单当前处于活动状态则为 NULL 的指针。  
  
### <a name="remarks"></a>备注  
 每个应用程序可以具有最多一个活动的弹出菜单。  
  
##  <a name="getanimationspeed"></a>CMFCPopupMenu::GetAnimationSpeed  
 返回对于弹出菜单的动画速度。  
  
```  
static UINT GetAnimationSpeed();
```  
  
### <a name="return-value"></a>返回值  
 一个整数，指示的时间，以毫秒为单位，完成所需的弹出菜单动画。  
  
### <a name="remarks"></a>备注  
 动画速度是全局值。 使用[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)要更改对于弹出菜单的动画速度。  
  
##  <a name="getanimationtype"></a>CMFCPopupMenu::GetAnimationType  
 返回弹出动画的当前类型。  
  
```  
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bNoSystem`  
 一个布尔型参数，该值指示此方法是否检查全局值。 如果您希望此方法以返回此实例的动画样式 FALSE [CMFCPopupMenu 类](../../mfc/reference/cmfcpopupmenu-class.md)。  
  
### <a name="return-value"></a>返回值  
 描述动画类型一个枚举的值。  
  
### <a name="remarks"></a>备注  
 对于弹出菜单的样式是动画的全局应用程序。 使用[CMFCPopupMenu::SetAnimationType](#setanimationtype)以设置动画样式。  
  
 下表列出可能的动画类型。  
  
 NO_ANIMATION  
 弹出菜单不进行动画处理，并且会立即出现。  
  
 展开  
 框架将显示从左上角到右下角的弹出菜单。  
  
 幻灯片  
 弹出菜单将从顶部到底部。  
  
 淡入淡出  
 弹出菜单第一次出现透明和逐渐固化。  
  
##  <a name="getdropdirection"></a>CMFCPopupMenu::GetDropDirection  

  
```  
DROP_DIRECTION GetDropDirection() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getforcemenufocus"></a>CMFCPopupMenu::GetForceMenuFocus  
 指示是否将焦点返回到菜单栏中显示一个弹出菜单时。  
  
```  
static BOOL GetForceMenuFocus();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果显示一个弹出菜单; 时，将输入的焦点返回到菜单栏`FALSE`如果弹出菜单保留焦点。  
  
### <a name="remarks"></a>备注  
 默认情况下，你的应用程序不返回到菜单栏的焦点。 若要更改此设置，请使用[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)。  
  
##  <a name="getforceshadow"></a>CMFCPopupMenu::GetForceShadow  

  
```  
static BOOL __stdcall GetForceShadow();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="gethmenu"></a>CMFCPopupMenu::GetHMenu  
 返回附加的菜单资源的句柄。  
  
```  
HMENU GetHMenu();
```  
  
##  <a name="getmenubar"></a>CMFCPopupMenu::GetMenuBar  
 返回[CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md)嵌入网络模块内的弹出菜单。  
  
```  
virtual CMFCPopupMenuBar* GetMenuBar();
```  
  
### <a name="return-value"></a>返回值  
 指向嵌入的`CMFCPopupMenuBar`。  
  
### <a name="remarks"></a>备注  
 弹出菜单还拥有一个嵌入`CMFCPopupMenuBar`对象。 如果你使用不同的嵌入的类，必须重写此方法在派生类。  
  
##  <a name="getmenuitem"></a>CMFCPopupMenu::GetMenuItem  
 将指针返回到指定索引处的菜单项。  
  
```  
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `iIndex`  
 菜单项的从零开始索引。  
  
### <a name="return-value"></a>返回值  
 指向菜单项的指针。 `NULL`如果该索引无效。  
  
### <a name="remarks"></a>备注  
 菜单项都由[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)。 在调用此方法时，它将指针返回到相应`CMFCToolBarMenuButton`。  
  
##  <a name="getmenuitemcount"></a>CMFCPopupMenu::GetMenuItemCount  
 在弹出菜单中返回的项数。  
  
```  
int GetMenuItemCount() const;  
```  
  
### <a name="return-value"></a>返回值  
 在菜单项的数目。  
  
##  <a name="getmessagewnd"></a>CMFCPopupMenu::GetMessageWnd  
 返回指向其中框架将传送的弹出菜单消息窗口的指针。  
  
```  
CWnd* GetMessageWnd() const;  
```  
  
### <a name="return-value"></a>返回值  
 指向接收的弹出菜单消息; 窗口的指针`NULL`如果未窗口。  
  
### <a name="remarks"></a>备注  
 当你使用该方法[CMFCPopupMenu::Create](#create)若要创建弹出菜单，你指定哪些窗口收到菜单消息。  
  
##  <a name="getparentarea"></a>CMFCPopupMenu::GetParentArea  

  
```  
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```  
  
### <a name="parameters"></a>参数  
 [in] `rectParentBtn`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getparentbutton"></a>CMFCPopupMenu::GetParentButton  
 将指针返回到父工具栏按钮。  
  
```  
CMFCToolBarMenuButton* GetParentButton() const;  
```  
  
### <a name="return-value"></a>返回值  
 指向父工具栏按钮的指针。 `NULL`如果弹出菜单没有父工具栏按钮。  
  
### <a name="remarks"></a>备注  
 A`CMFCPopupMenu`可以与菜单上的按钮相关联。 在此方案中，弹出菜单会显示在用户选择父工具栏按钮时。  
  
 如果弹出菜单快捷菜单，它将具有没有父工具栏按钮。  
  
##  <a name="getparentpopupmenu"></a>CMFCPopupMenu::GetParentPopupMenu  
 返回指向父弹出菜单的指针。  
  
```  
CMFCPopupMenu* GetParentPopupMenu() const;  
```  
  
### <a name="return-value"></a>返回值  
 指向父`CMFCPopupMenu`对象;`NULL`如果没有父弹出菜单。  
  
### <a name="remarks"></a>备注  
 弹出菜单具有父`CMFCPopupMenu`仅对象是否子菜单。  
  
##  <a name="getparentribbonelement"></a>CMFCPopupMenu::GetParentRibbonElement  

  
```  
CMFCRibbonBaseElement* GetParentRibbonElement() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getparenttoolbar"></a>CMFCPopupMenu::GetParentToolBar  
 将指针返回到父工具栏。  
  
```  
CMFCToolBar* GetParentToolBar() const;  
```  
  
### <a name="return-value"></a>返回值  
 指向在父级工具栏的指针。 `NULL`如果弹出菜单还拥有不在父级工具栏。  
  
### <a name="remarks"></a>备注  
 如果`CMFCPopupMenu`为快捷菜单，则它具有不在父级工具栏。  
  
##  <a name="getquickcustomizetype"></a>CMFCPopupMenu::GetQuickCustomizeType  

  
```  
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="getselitem"></a>CMFCPopupMenu::GetSelItem  
 将指针返回到当前选定的菜单命令。  
  
```  
CMFCToolBarMenuButton* GetSelItem();
```  
  
### <a name="return-value"></a>返回值  
 指向当前选定的菜单命令中;`NULL`如果未不选定任何项。  
  
### <a name="remarks"></a>备注  
 上一个弹出菜单的菜单命令都由[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)，或从派生的类`CMFCToolBarMenuButton`。  
  
##  <a name="hasbeenresized"></a>CMFCPopupMenu::HasBeenResized  

  
```  
BOOL HasBeenResized() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="hiderarelyusedcommands"></a>CMFCPopupMenu::HideRarelyUsedCommands  
 指示弹出菜单是否可以隐藏很少使用的命令。  
  
```  
BOOL HideRarelyUsedCommands() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果弹出菜单可以隐藏很少使用的命令中;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法指定是否可以隐藏弹出菜单仅很少使用的命令，不如果启用了该配置。 弹出菜单可以隐藏很少使用的命令，如果它有一个父按钮和父窗口派生自[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)。 使用[CMFCMenuBar::SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus)若要启用此功能和[CMFCMenuBar::IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus)以确定是否当前启用此功能。 你必须为父窗口调用这两种方法。  
  
##  <a name="incommand"></a>CMFCPopupMenu::InCommand  

  
```  
virtual BOOL InCommand();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="insertitem"></a>CMFCPopupMenu::InsertItem  
 将新项插入到指定位置的弹出菜单。  
  
```  
int InsertItem(
    const CMFCToolBarMenuButton& button,  
    int iInsertA = -1);
```  
  
### <a name="parameters"></a>参数  
 [in] `button`  
 对要添加的菜单项的引用。  
  
 [in] `iInsertAt`  
 新项的从零开始索引。 如果`iInsertAt`为-1，项添加到菜单的末尾。  
  
### <a name="return-value"></a>返回值  
 已插入项的位置的从零开始的索引。 如果此方法失败，则为-1。  
  
### <a name="remarks"></a>备注  
 如果你提供的值无效，此方法将失败`iInsertAt`，如整数大于当前上弹出菜单项的数量。  
  
##  <a name="insertseparator"></a>CMFCPopupMenu::InsertSeparator  
 位于指定位置的弹出菜单中插入分隔符。  
  
```  
int InsertSeparator(int iInsertAt = -1);
```  
  
### <a name="parameters"></a>参数  
 [in] `iInsertAt`  
 此方法将在其中插入分隔符的位置的从零开始的索引。  
  
### <a name="return-value"></a>返回值  
 已插入分隔符中的位置的从零开始的索引。 如果此方法失败，则为-1。  
  
### <a name="remarks"></a>备注  
 值为-1`iInsertAt`表示此方法会将分隔符添加到弹出菜单的末尾。  
  
 如果此方法将失败`iInsertAt`是无效值。  
  
##  <a name="isalwaysclose"></a>CMFCPopupMenu::IsAlwaysClose  

  
```  
virtual BOOL IsAlwaysClose() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isalwaysshowemptytoolsentry"></a>CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry  

  
```  
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="iscustomizepane"></a>CMFCPopupMenu::IsCustomizePane  
 指示弹出菜单充当**QuickCustomizePane**。  
  
```  
BOOL IsCustomizePane();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果在弹出框处于**QuckCustomizePane**; 否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 使用**QuickCustomizePane** ，使用户能够直接自定义的弹出菜单。 **QuickCustomizePane**是`CMFCPopupMenu`用户单击工具栏按钮直接进行编辑时出现。  
  
 你的应用程序应调用此方法期间[CMDIFrameWndEx::OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane)。  
  
##  <a name="isescclose"></a>CMFCPopupMenu::IsEscClose  

  
```  
BOOL IsEscClose();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isidle"></a>CMFCPopupMenu::IsIdle  
 指示弹出菜单是否当前处于空闲状态。  
  
```  
virtual BOOL IsIdle() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果弹出菜单处于空闲模式;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 默认情况下，弹出菜单处于空闲模式是，如果显示动画，则完成并且用户不滚动弹出菜单的。  
  
##  <a name="ismenusound"></a>CMFCPopupMenu::IsMenuSound  

  
```  
static UINT __stdcall IsMenuSound();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isquickcustomize"></a>CMFCPopupMenu::IsQuickCustomize  
 确定是否关联[CMFCToolBarMenuButton 类](../../mfc/reference/cmfctoolbarmenubutton-class.md)处于 QuickCustomize 模式。  
  
```  
BOOL IsQuickCustomize();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果关联的菜单按钮处于 QuickCustomize 模式;否则为`FALSE`。 此方法还将返回`FALSE`弹出菜单是否不与关联`CMFCToolBarMenuButton`。  
  
### <a name="remarks"></a>备注  
 在 QuickCustomize 模式用户选择要直接自定义按钮的工具栏上的按钮。  
  
##  <a name="isresizeble"></a>CMFCPopupMenu::IsResizeble  

  
```  
BOOL IsResizeble() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isrightalign"></a>CMFCPopupMenu::IsRightAlign  
 指示菜单是右对齐还是左对齐。  
  
```  
BOOL IsRightAlign() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果菜单是右对齐;`FALSE`如果菜单左对齐。  
  
### <a name="remarks"></a>备注  
 你可以使用[CMFCPopupMenu::SetRightAlign](#setrightalign)设置菜单对齐方式。 默认情况下，弹出菜单使用左对齐。  
  
 菜单对齐不是全局设置和弹出菜单会有所不同。  
  
##  <a name="isscrollable"></a>CMFCPopupMenu::IsScrollable  

  
```  
BOOL IsScrollable() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="issendmenuselectmsg"></a>CMFCPopupMenu::IsSendMenuSelectMsg  
 指示当用户从弹出菜单中选择命令时，框架是否通知的父框架。  
  
```  
static BOOL IsSendMenuSelectMsg();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果框架通知父帧的值。否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 框架通过将其发送通知的父框架`WM_MENUSELECT`消息时使用的选择菜单命令。  
  
##  <a name="isshown"></a>CMFCPopupMenu::IsShown  
 指示弹出菜单是否处于当前可见。  
  
```  
BOOL IsShown() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果弹出菜单可见;否则为`FALSE`。  
  
##  <a name="moveto"></a>CMFCPopupMenu::MoveTo  

  
```  
void MoveTo(const CPoint& pt);
```  
  
### <a name="parameters"></a>参数  
 [in] `pt`  
  
### <a name="remarks"></a>备注  
  
##  <a name="onchangehot"></a>CMFCPopupMenu::OnChangeHot  

  
```  
virtual void OnChangeHot(int nHot);
```  
  
### <a name="parameters"></a>参数  
 [in] `nHot`  
  
### <a name="remarks"></a>备注  
  
##  <a name="onchooseitem"></a>CMFCPopupMenu::OnChooseItem  

  
```  
virtual void OnChooseItem(UINT uidCmdID);
```  
  
### <a name="parameters"></a>参数  
 [in] `uidCmdID`  
  
### <a name="remarks"></a>备注  
  
##  <a name="oncmdmsg"></a>CMFCPopupMenu::OnCmdMsg  

  
```  
virtual BOOL OnCmdMsg(
    UINT nID,  
    int nCode,  
    void* pExtra,  
    AFX_CMDHANDLERINFO* pHandlerInfo);
```  
  
### <a name="parameters"></a>参数  
 [in] `nID`  
 [in] `nCode`  
 [in] `pExtra`  
 [in] `pHandlerInfo`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="postcommand"></a>CMFCPopupMenu::PostCommand  

  
```  
BOOL PostCommand(UINT uiCommandID);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCommandID`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="pretranslatemessage"></a>CMFCPopupMenu::PreTranslateMessage  

  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>参数  
 [in] `pMsg`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="recalclayout"></a>CMFCPopupMenu::RecalcLayout  

  
```  
virtual void RecalcLayout(BOOL bNotify = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bNotify`  
  
### <a name="remarks"></a>备注  
  
##  <a name="removeallitems"></a>CMFCPopupMenu::RemoveAllItems  
 清除弹出菜单中的所有项。  
  
```  
void RemoveAllItems();
```  
  
##  <a name="removeitem"></a>CMFCPopupMenu::RemoveItem  
 从弹出菜单中删除指定的项。  
  
```  
BOOL RemoveItem(int iIndex);
```  
  
### <a name="parameters"></a>参数  
 [in] `iIndex`  
 要删除的项的从零开始的索引。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果此方法成功，则否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法自动排列受某项删除任何分隔符。 有关框架如何重新排列分隔符的详细信息，请参阅[CMFCToolBar::RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton)。  
  
##  <a name="savestate"></a>CMFCPopupMenu::SaveState  

  
```  
virtual void SaveState();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="setanimationspeed"></a>CMFCPopupMenu::SetAnimationSpeed  
 设置对于弹出菜单的动画速度。  
  
```  
static void SetAnimationSpeed(UINT nElapse);
```  
  
### <a name="parameters"></a>参数  
 [in] `nElapse`  
 新动画速度，以毫秒为单位。  
  
### <a name="remarks"></a>备注  
 动画速度的全局值并影响应用程序中的所有弹出菜单。 此值指定了多长时间完成弹出菜单的动画。  
  
 默认情况下，此参数设置为 30 毫秒。 有效值范围`nElapse`是从 0 到 200。  
  
##  <a name="setanimationtype"></a>CMFCPopupMenu::SetAnimationType  
 设置此弹出菜单的动画类型。  
  
```  
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```  
  
### <a name="parameters"></a>参数  
 [in] `type`  
 枚举的数据类型，指定动画的类型。  
  
### <a name="remarks"></a>备注  
 请参阅[CMFCPopupMenu::GetAnimationType](#getanimationtype)有关有效值的列表`type`。  
  
##  <a name="setautodestroy"></a>CMFCPopupMenu::SetAutoDestroy  

  
```  
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bAutoDestroy`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setdefaultitem"></a>CMFCPopupMenu::SetDefaultItem  
 设置的弹出菜单的默认命令。  
  
```  
void SetDefaultItem(UINT uiCmd);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 新的默认命令的菜单命令 ID。  
  
### <a name="remarks"></a>备注  
 弹出菜单中的默认命令是时显示的弹出菜单选择的命令。  
  
##  <a name="setforcemenufocus"></a>CMFCPopupMenu::SetForceMenuFocus  
 强制在输入的焦点返回到菜单栏中显示一个弹出菜单时。  
  
```  
static void SetForceMenuFocus(BOOL bValue);
```  
  
### <a name="parameters"></a>参数  
 [in] `bValue`  
 `TRUE`如果你想要强制转换为时弹出菜单的菜单栏输入的焦点的框架将显示。 `FALSE`如果你想要保留焦点的弹出菜单。  
  
### <a name="remarks"></a>备注  
 此方法设置为对于应用程序中的所有弹出菜单全局标志。 默认情况下，不启用此功能。  
  
##  <a name="setforceshadow"></a>CMFCPopupMenu::SetForceShadow  
 强制外主框架显示弹出菜单时绘制菜单阴影的框架。  
  
```  
static void SetForceShadow(BOOL bValue);
```  
  
### <a name="parameters"></a>参数  
 [in] `bValue`  
 `TRUE`如果你想要绘制菜单阴影的框架`FALSE`否则为。  
  
### <a name="remarks"></a>备注  
 在调用此方法时，它在你的应用程序中设置全局标志。 此标志会影响应用程序中的所有弹出菜单。  
  
##  <a name="setmaxwidth"></a>CMFCPopupMenu::SetMaxWidth  
 设置的弹出菜单的最大宽度。  
  
```  
void SetMaxWidth(int iMaxWidth);
```  
  
### <a name="parameters"></a>参数  
 [in] `iMaxWidth`  
 弹出菜单中，以像素为单位的最大宽度。  
  
### <a name="remarks"></a>备注  
 如果菜单命令与关联的文本将不能容纳的最大宽度，则将被截断并不能容纳的部分替换为三个点。  
  
##  <a name="setmessagewnd"></a>CMFCPopupMenu::SetMessageWnd  

  
```  
void SetMessageWnd(CWnd* pMsgWnd);
```  
  
### <a name="parameters"></a>参数  
 [in] `pMsgWnd`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setparentribbonelement"></a>CMFCPopupMenu::SetParentRibbonElement  

  
```  
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```  
  
### <a name="parameters"></a>参数  
 [in] `pElem`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setquickcustomizetype"></a>CMFCPopupMenu::SetQuickCustomizeType  

  
```  
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```  
  
### <a name="parameters"></a>参数  
 [in] `Type`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setquickmode"></a>CMFCPopupMenu::SetQuickMode  

  
```  
void SetQuickMode();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="setrightalign"></a>CMFCPopupMenu::SetRightAlign  
 设置弹出菜单的菜单对齐方式。  
  
```  
void SetRightAlign(BOOL bRightAlign = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bRightAlign`  
 一个布尔值，该值指示菜单对齐方式。 `TRUE`指示右对齐，`FALSE`指示左对齐方式。  
  
### <a name="remarks"></a>备注  
 默认情况下，所有的弹出菜单是左对齐。  
  
##  <a name="setsendmenuselectmsg"></a>CMFCPopupMenu::SetSendMenuSelectMsg  
 设置用于控制是否弹出菜单通知其父框架，当用户选择命令的标志。  
  
```  
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bSet`  
 `TRUE`如果弹出菜单通知其父框架，`FALSE`否则为。  
  
### <a name="remarks"></a>备注  
 这是应用程序中的所有弹出菜单的全局选项。 如果启用，将发送弹出菜单`WM_MENUSELECT`当用户选择命令的父框架的消息。  
  
##  <a name="showallcommands"></a>CMFCPopupMenu::ShowAllCommands  
 强制弹出菜单以显示所有命令。  
  
```  
void ShowAllCommands();
```  
  
### <a name="remarks"></a>备注  
 这不是全局设置，并会影响当前弹出菜单。  
  
##  <a name="triggerresize"></a>CMFCPopupMenu::TriggerResize  

  
```  
void TriggerResize();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="updateallshadows"></a>CMFCPopupMenu::UpdateAllShadows  
 更新所有打开的弹出菜单的阴影。  
  
```  
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lprectScreen`  
 在屏幕坐标中指定要更新的区域的矩形。  
  
### <a name="remarks"></a>备注  
 动画的控件或其他具有动态内容的窗口上方显示弹出菜单时，此方法很有用。  
  
##  <a name="updateshadow"></a>CMFCPopupMenu::UpdateShadow  
 更新个弹出菜单的阴影。  
  
```  
void UpdateShadow(LPRECT lprectScreen = NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lprectScreen`  
 矩形，在屏幕坐标中，指定要更新的区域的边界。  
  
### <a name="remarks"></a>备注  
 当有阴影的弹出菜单重叠动画的图像时，请调用此方法。  
  
## <a name="see-also"></a>另请参阅  
 [层次结构图](../../mfc/hierarchy-chart.md)   
 [类](../../mfc/reference/mfc-classes.md)   
 [CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)
