---
title: CHtmlView 类
ms.date: 11/04/2016
f1_keywords:
- CHtmlView
- AFXHTML/CHtmlView
- AFXHTML/CHtmlView::Create
- AFXHTML/CHtmlView::CreateControlSite
- AFXHTML/CHtmlView::ExecFormsCommand
- AFXHTML/CHtmlView::ExecWB
- AFXHTML/CHtmlView::GetAddressBar
- AFXHTML/CHtmlView::GetApplication
- AFXHTML/CHtmlView::GetBusy
- AFXHTML/CHtmlView::GetContainer
- AFXHTML/CHtmlView::GetFullName
- AFXHTML/CHtmlView::GetFullScreen
- AFXHTML/CHtmlView::GetHeight
- AFXHTML/CHtmlView::GetHtmlDocument
- AFXHTML/CHtmlView::GetLeft
- AFXHTML/CHtmlView::GetLocationName
- AFXHTML/CHtmlView::GetLocationURL
- AFXHTML/CHtmlView::GetMenuBar
- AFXHTML/CHtmlView::GetOffline
- AFXHTML/CHtmlView::GetParentBrowser
- AFXHTML/CHtmlView::GetProperty
- AFXHTML/CHtmlView::GetReadyState
- AFXHTML/CHtmlView::GetRegisterAsBrowser
- AFXHTML/CHtmlView::GetRegisterAsDropTarget
- AFXHTML/CHtmlView::GetSilent
- AFXHTML/CHtmlView::GetSource
- AFXHTML/CHtmlView::GetStatusBar
- AFXHTML/CHtmlView::GetTheaterMode
- AFXHTML/CHtmlView::GetToolBar
- AFXHTML/CHtmlView::GetTop
- AFXHTML/CHtmlView::GetTopLevelContainer
- AFXHTML/CHtmlView::GetType
- AFXHTML/CHtmlView::GetVisible
- AFXHTML/CHtmlView::GetWidth
- AFXHTML/CHtmlView::GoBack
- AFXHTML/CHtmlView::GoForward
- AFXHTML/CHtmlView::GoHome
- AFXHTML/CHtmlView::GoSearch
- AFXHTML/CHtmlView::LoadFromResource
- AFXHTML/CHtmlView::Navigate
- AFXHTML/CHtmlView::Navigate2
- AFXHTML/CHtmlView::OnBeforeNavigate2
- AFXHTML/CHtmlView::OnCommandStateChange
- AFXHTML/CHtmlView::OnDocumentComplete
- AFXHTML/CHtmlView::OnDocWindowActivate
- AFXHTML/CHtmlView::OnDownloadBegin
- AFXHTML/CHtmlView::OnDownloadComplete
- AFXHTML/CHtmlView::OnEnableModeless
- AFXHTML/CHtmlView::OnFilterDataObject
- AFXHTML/CHtmlView::OnFrameWindowActivate
- AFXHTML/CHtmlView::OnFullScreen
- AFXHTML/CHtmlView::OnGetDropTarget
- AFXHTML/CHtmlView::OnGetExternal
- AFXHTML/CHtmlView::OnGetHostInfo
- AFXHTML/CHtmlView::OnGetOptionKeyPath
- AFXHTML/CHtmlView::OnHideUI
- AFXHTML/CHtmlView::OnMenuBar
- AFXHTML/CHtmlView::OnNavigateComplete2
- AFXHTML/CHtmlView::OnNavigateError
- AFXHTML/CHtmlView::OnNewWindow2
- AFXHTML/CHtmlView::OnProgressChange
- AFXHTML/CHtmlView::OnPropertyChange
- AFXHTML/CHtmlView::OnQuit
- AFXHTML/CHtmlView::OnResizeBorder
- AFXHTML/CHtmlView::OnShowContextMenu
- AFXHTML/CHtmlView::OnShowUI
- AFXHTML/CHtmlView::OnStatusBar
- AFXHTML/CHtmlView::OnStatusTextChange
- AFXHTML/CHtmlView::OnTheaterMode
- AFXHTML/CHtmlView::OnTitleChange
- AFXHTML/CHtmlView::OnToolBar
- AFXHTML/CHtmlView::OnTranslateAccelerator
- AFXHTML/CHtmlView::OnTranslateUrl
- AFXHTML/CHtmlView::OnUpdateUI
- AFXHTML/CHtmlView::OnVisible
- AFXHTML/CHtmlView::PutProperty
- AFXHTML/CHtmlView::QueryFormsCommand
- AFXHTML/CHtmlView::QueryStatusWB
- AFXHTML/CHtmlView::Refresh
- AFXHTML/CHtmlView::Refresh2
- AFXHTML/CHtmlView::SetAddressBar
- AFXHTML/CHtmlView::SetFullScreen
- AFXHTML/CHtmlView::SetHeight
- AFXHTML/CHtmlView::SetLeft
- AFXHTML/CHtmlView::SetMenuBar
- AFXHTML/CHtmlView::SetOffline
- AFXHTML/CHtmlView::SetRegisterAsBrowser
- AFXHTML/CHtmlView::SetRegisterAsDropTarget
- AFXHTML/CHtmlView::SetSilent
- AFXHTML/CHtmlView::SetStatusBar
- AFXHTML/CHtmlView::SetTheaterMode
- AFXHTML/CHtmlView::SetToolBar
- AFXHTML/CHtmlView::SetTop
- AFXHTML/CHtmlView::SetVisible
- AFXHTML/CHtmlView::SetWidth
- AFXHTML/CHtmlView::Stop
helpviewer_keywords:
- CHtmlView [MFC], Create
- CHtmlView [MFC], CreateControlSite
- CHtmlView [MFC], ExecFormsCommand
- CHtmlView [MFC], ExecWB
- CHtmlView [MFC], GetAddressBar
- CHtmlView [MFC], GetApplication
- CHtmlView [MFC], GetBusy
- CHtmlView [MFC], GetContainer
- CHtmlView [MFC], GetFullName
- CHtmlView [MFC], GetFullScreen
- CHtmlView [MFC], GetHeight
- CHtmlView [MFC], GetHtmlDocument
- CHtmlView [MFC], GetLeft
- CHtmlView [MFC], GetLocationName
- CHtmlView [MFC], GetLocationURL
- CHtmlView [MFC], GetMenuBar
- CHtmlView [MFC], GetOffline
- CHtmlView [MFC], GetParentBrowser
- CHtmlView [MFC], GetProperty
- CHtmlView [MFC], GetReadyState
- CHtmlView [MFC], GetRegisterAsBrowser
- CHtmlView [MFC], GetRegisterAsDropTarget
- CHtmlView [MFC], GetSilent
- CHtmlView [MFC], GetSource
- CHtmlView [MFC], GetStatusBar
- CHtmlView [MFC], GetTheaterMode
- CHtmlView [MFC], GetToolBar
- CHtmlView [MFC], GetTop
- CHtmlView [MFC], GetTopLevelContainer
- CHtmlView [MFC], GetType
- CHtmlView [MFC], GetVisible
- CHtmlView [MFC], GetWidth
- CHtmlView [MFC], GoBack
- CHtmlView [MFC], GoForward
- CHtmlView [MFC], GoHome
- CHtmlView [MFC], GoSearch
- CHtmlView [MFC], LoadFromResource
- CHtmlView [MFC], Navigate
- CHtmlView [MFC], Navigate2
- CHtmlView [MFC], OnBeforeNavigate2
- CHtmlView [MFC], OnCommandStateChange
- CHtmlView [MFC], OnDocumentComplete
- CHtmlView [MFC], OnDocWindowActivate
- CHtmlView [MFC], OnDownloadBegin
- CHtmlView [MFC], OnDownloadComplete
- CHtmlView [MFC], OnEnableModeless
- CHtmlView [MFC], OnFilterDataObject
- CHtmlView [MFC], OnFrameWindowActivate
- CHtmlView [MFC], OnFullScreen
- CHtmlView [MFC], OnGetDropTarget
- CHtmlView [MFC], OnGetExternal
- CHtmlView [MFC], OnGetHostInfo
- CHtmlView [MFC], OnGetOptionKeyPath
- CHtmlView [MFC], OnHideUI
- CHtmlView [MFC], OnMenuBar
- CHtmlView [MFC], OnNavigateComplete2
- CHtmlView [MFC], OnNavigateError
- CHtmlView [MFC], OnNewWindow2
- CHtmlView [MFC], OnProgressChange
- CHtmlView [MFC], OnPropertyChange
- CHtmlView [MFC], OnQuit
- CHtmlView [MFC], OnResizeBorder
- CHtmlView [MFC], OnShowContextMenu
- CHtmlView [MFC], OnShowUI
- CHtmlView [MFC], OnStatusBar
- CHtmlView [MFC], OnStatusTextChange
- CHtmlView [MFC], OnTheaterMode
- CHtmlView [MFC], OnTitleChange
- CHtmlView [MFC], OnToolBar
- CHtmlView [MFC], OnTranslateAccelerator
- CHtmlView [MFC], OnTranslateUrl
- CHtmlView [MFC], OnUpdateUI
- CHtmlView [MFC], OnVisible
- CHtmlView [MFC], PutProperty
- CHtmlView [MFC], QueryFormsCommand
- CHtmlView [MFC], QueryStatusWB
- CHtmlView [MFC], Refresh
- CHtmlView [MFC], Refresh2
- CHtmlView [MFC], SetAddressBar
- CHtmlView [MFC], SetFullScreen
- CHtmlView [MFC], SetHeight
- CHtmlView [MFC], SetLeft
- CHtmlView [MFC], SetMenuBar
- CHtmlView [MFC], SetOffline
- CHtmlView [MFC], SetRegisterAsBrowser
- CHtmlView [MFC], SetRegisterAsDropTarget
- CHtmlView [MFC], SetSilent
- CHtmlView [MFC], SetStatusBar
- CHtmlView [MFC], SetTheaterMode
- CHtmlView [MFC], SetToolBar
- CHtmlView [MFC], SetTop
- CHtmlView [MFC], SetVisible
- CHtmlView [MFC], SetWidth
- CHtmlView [MFC], Stop
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
ms.openlocfilehash: 9956537dbbbc34c69f6f6a6da8174ab594418386
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752659"
---
# <a name="chtmlview-class"></a>CHtmlView 类

提供 MFC 文档/视图体系结构上下文中的 Web 浏览器控件功能。

## <a name="syntax"></a>语法

```
class CHtmlView : public CFormView
```

## <a name="members"></a>成员

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CHtmlView：创建](#create)|创建 WebBrowser 控件。|
|[CHtmlView：创建控制网站](#createcontrolsite)|可重写，用于创建控件站点实例以承载窗体上的控件。|
|[CHtmlView：：执行形式命令](#execformscommand)|使用 `IOleCommandTarget::Exec` 方法执行指定的命令。|
|[CHtmlView：：执行WB](#execwb)|执行命令。|
|[CHtmlView：获取地址栏](#getaddressbar)|确定 Internet Explorer 对象的地址栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：获取应用程序](#getapplication)|检索一个应用程序对象，该对象表示包含 Internet Explorer 应用程序的当前实例的应用程序。|
|[CHtmlView：获取忙碌](#getbusy)|检索一个值，该值指示下载或其他活动是否仍在进行中。|
|[CHtmlView：获取容器](#getcontainer)|检索 WebBrowser 控件的容器。|
|[CHtmlView：获取全名](#getfullname)|检索 web 浏览器中显示的资源的完整名称，包括路径。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：获取全屏](#getfullscreen)|指示 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。|
|[CHtmlView：获取高度](#getheight)|检索 Internet Explorer 主窗口的高度。|
|[CHtmlView：获取Html文档](#gethtmldocument)|检索活动的 HTML 文档。|
|[CHtmlView：获得左](#getleft)|检索 Internet Explorer 主窗口左边缘的屏幕坐标。|
|[CHtmlView：获取位置名称](#getlocationname)|检索 WebBrowser 当前正在显示的资源的名称。|
|[CHtmlView：获取位置URL](#getlocationurl)|检索 WebBrowser 当前正在显示的资源的 URL。|
|[CHtmlView：获取菜单栏](#getmenubar)|检索一个值，该值确定菜单栏是否可见。|
|[CHtmlView：离线](#getoffline)|检索一个值，该值确定控件是否处于脱机状态。|
|[CHtmlView：获取父浏览器](#getparentbrowser)|检索指向 `IDispatch` 接口的指针。 有关详细信息，请参阅 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。|
|[CHtmlView：获取属性](#getproperty)|检索与给定对象关联的属性的当前值。|
|[CHtmlView：：准备状态](#getreadystate)|检索 web 浏览器对象的就绪状态。|
|[CHtmlView：获取注册浏览器](#getregisterasbrowser)|指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。|
|[CHtmlView：：获取注册作为删除目标](#getregisterasdroptarget)|指示是否将 WebBrowser 控件注册为导航的放置目标。|
|[CHtmlView：获得沉默](#getsilent)|指示是否可以显示任何对话框。|
|[CHtmlView：获取来源](#getsource)|网页的 HTML 源代码。|
|[CHtmlView：获取状态栏](#getstatusbar)|指示 Internet Explorer 的状态栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：获取剧场模式](#gettheatermode)|指示 WebBrowser 控件是否处于影院模式。|
|[CHtmlView：获取工具栏](#gettoolbar)|检索一个值，该值确定工具栏是否可见。|
|[CHtmlView：获取顶部](#gettop)|检索 Internet Explorer 主窗口顶部边缘的屏幕坐标。|
|[CHtmlView：获取顶级容器](#gettoplevelcontainer)|检索一个值，该值指示当前对象是否为 WebBrowser 控件的顶级容器。|
|[CHtmlView：获取类型](#gettype)|检索文档对象的类型名称。|
|[CHtmlView：获取可见](#getvisible)|检索一个值，该值指示对象是可见还是隐藏。|
|[CHtmlView：获取宽度](#getwidth)|检索 Internet Explorer 主窗口的宽度。|
|[CHtmlView：返回](#goback)|导航至历史记录列表中的上一项。|
|[CHtmlView：前进](#goforward)|导航至历史记录列表中的下一项。|
|[CHtmlView::GoHome](#gohome)|导航至当前主页或起始页。|
|[CHtmlView：GoSearch](#gosearch)|导航至当前搜索页。|
|[CHtmlView：从资源加载](#loadfromresource)|加载 WebBrowser 控件中的资源。|
|[CHtmlView：导航](#navigate)|导航至由 URL 标识的资源。|
|[CHtmlView：导航2](#navigate2)|导航至由 URL 标识的资源或由完整路径标识的文件。|
|[CHtmlView：：在导航前2](#onbeforenavigate2)|在给定 WebBrowser 中发生导航之前调用（在窗口或框架集元素上）|
|[CHtmlView：在命令状态更改](#oncommandstatechange)|调用以通知应用程序 Web 浏览器命令的启用状态已更改。|
|[CHtmlView：在文档完成](#ondocumentcomplete)|调用 以通知应用程序文档已达到READYSTATE_COMPLETE状态。|
|[CHtmlView：在DocWindow激活](#ondocwindowactivate)|从[IOleInPlaceActiveObject](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)的 Internet Explorer 或 MSHTML 实现调用：OnDocWindowActivate ，在激活或停用容器的文档窗口时通知活动就地对象。|
|[CHtmlView：：下载开始](#ondownloadbegin)|调用以通知应用程序将开始导航操作|
|[CHtmlView：下载完成](#ondownloadcomplete)|在导航操作完成、暂停或失败时调用。|
|[CHtmlView：启用无模式](#onenablemodeless)|调用以在容器创建或销毁模式对话框时启用或禁用无模式对话框。|
|[CHtmlView：在筛选数据对象上](#onfilterdataobject)|由 Internet Explorer 或 MSHTML 对主机调用，以允许主机替换 Internet Explorer 或 MSHTML 的数据对象。|
|[CHtmlView：在框架窗口激活](#onframewindowactivate)|从[IOleInPlaceActiveObject 调用：在FrameWindow激活上](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate)，以便在激活或停用容器的顶级框架窗口时通知对象。|
|[CHtmlView：全屏](#onfullscreen)|当 FullScreen 属性已更改时调用。|
|[CHtmlView：：OnGetDropTarget](#ongetdroptarget)|调用 Internet 资源管理器或 MSHTML 时，它正用作放置目标，以允许主机提供替代[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)。|
|[CHtmlView：：打开外部](#ongetexternal)|由 Internet Explorer 或 MSHTML 调用以获取主机的 `IDispatch` 接口。|
|[CHtmlView：：OngetHostinfo](#ongethostinfo)|检索 Internet Explorer 或 MSHTML 主机的用户界面功能。|
|[CHtmlView：：在获取选项关键路径](#ongetoptionkeypath)|返回 Internet Explorer 或 MSHTML 在其下存储用户首选项的注册表项。|
|[CHtmlView：：打开隐藏UI](#onhideui)|当 Internet Explorer 或 MSHTML 删除其菜单和工具栏时调用。|
|[CHtmlView：：在Menubar上](#onmenubar)|当 MenuBar 属性已更改时调用。|
|[CHtmlView：：导航完成2](#onnavigatecomplete2)|完成到超链接的导航后调用（在窗口或框架集元素上）。|
|[CHtmlView：在导航错误](#onnavigateerror)|当导航到超链接失败时由框架调用。|
|[CHtmlView：：打开新窗口2](#onnewwindow2)|当要创建新窗口以显示资源时调用。|
|[CHtmlView：：在进度更改上](#onprogresschange)|调用以通知应用程序下载操作的进度已更新。|
|[CHtmlView：：在属性更改上](#onpropertychange)|调用以通知应用程序 [PutProperty](#putproperty) 方法已更改一个属性的值。|
|[CHtmlView：：打开](#onquit)|调用以通知应用程序 Internet Explorer 应用程序已准备退出。 （仅适用于 Internet Explorer）|
|[CHtmlView：在重调整边界](#onresizeborder)|从[IOleInPlaceActiveObject：：调整边框](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)的 Internet 资源管理器或 MSHTML 实现调用，该函数会提醒需要调整其边框空间的大小的对象。|
|[CHtmlView：：在显示上下文菜单](#onshowcontextmenu)|当 Internet Explorer 或 MSHTML 将要显示其上下文菜单时，从其调用。|
|[CHtmlView：：在ShowUI上](#onshowui)|在 Internet Explorer 或 MSHTML 显示其菜单和工具栏之前调用。|
|[CHtmlView："打开状态栏"](#onstatusbar)|当 StatusBar 属性已更改时调用。|
|[CHtmlView：：在状态文本更改上](#onstatustextchange)|调用以通知应用程序与 WebBrowser 控件相关联的状态栏的文本已更改。|
|[CHtmlView：在剧场模式](#ontheatermode)|当 TheaterMode 属性已更改时调用。|
|[CHtmlView：：打开标题更改](#ontitlechange)|调用以通知应用程序 WebBrowser 控件中的文档的标题是否变为可用或是否更改。|
|[CHtmlView：：在工具栏上](#ontoolbar)|当 ToolBar 属性已更改时调用。|
|[CHtmlView：在翻译加速器上](#ontranslateaccelerator)|当[IOleInPlaceActiveObject：：翻译加速器](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator)或[IOleControlSite：：翻译加速器](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator)调用时，由 Internet Explorer 或 MSHTML 调用，以处理来自容器消息队列的菜单加速器键消息。|
|[CHtmlView：在翻译上](#ontranslateurl)|由 Internet Explorer 或 MSHTML 调用以允许主机有机会修改要加载的 URL。|
|[CHtmlView：关于更新的信息](#onupdateui)|通知主机命令状态已更改。|
|[CHtmlView：：在可见](#onvisible)|当应该显示/隐藏 WebBrowser 控件的窗口时调用。|
|[CHtmlView：:P](#putproperty)|检索与给定对象关联的属性的值。|
|[CHtmlView：：查询表单命令](#queryformscommand)|查询由用户界面事件生成的一个或多个命令的状态。|
|[CHtmlView：查询状态WB](#querystatuswb)|查询正在由 WebBrowser 控件进行处理的命令的状态。|
|[CHtmlView：刷新](#refresh)|重新加载当前文件。|
|[CHtmlView：刷新2](#refresh2)|重新加载当前文件并选择性地阻止 `pragma:nocache` 标头被发送。|
|[CHtmlView：设置地址栏](#setaddressbar)|显示 或隐藏 Internet Explorer 对象的地址栏。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：设置全屏](#setfullscreen)|设置一个值，用于确定 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：设置高度](#setheight)|设置 Internet Explorer 主窗口的高度。|
|[CHtmlView：：设置左](#setleft)|设置 Internet Explorer 主窗口的水平位置。|
|[CHtmlView：设置菜单栏](#setmenubar)|设置一个值，用以确定控件的菜单栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：：设置离线](#setoffline)|设置一个值，用以确定控件是否处于脱机状态。|
|[CHtmlView：：设置注册浏览器](#setregisterasbrowser)|设置一个值，指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。|
|[CHtmlView：：设置注册作为删除目标](#setregisterasdroptarget)|设置一个值，指示是否将 WebBrowser 控件注册为导航的放置目标。|
|[CHtmlView：设置静音](#setsilent)|设置一个值，用以确定控件是否将显示对话框。|
|[CHtmlView：设置状态栏](#setstatusbar)|设置一个值，用以确定 Internet Explorer 的状态栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：设置剧场模式](#settheatermode)|设置一个值，指示 WebBrowser 控件是否处于影院模式。|
|[CHtmlView：设置工具栏](#settoolbar)|设置一个值，用以确定控件的工具栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：：设置顶部](#settop)|设置 Internet Explorer 主窗口的垂直位置。|
|[CHtmlView：：设置可见](#setvisible)|设置一个值，该值指示对象是可见还是隐藏。|
|[CHtmlView：：设置宽度](#setwidth)|设置 Internet Explorer 主窗口的宽度。|
|[CHtmlView：停止](#stop)|停止打开文件。|

## <a name="remarks"></a>备注

WebBrowser 控件是一个窗口，其中用户可以浏览万维网上的站点以及本地文件系统中和网络上的文件夹。 WebBrowser 控件支持超级链接、统一资源定位器 (URL) 导航，并维护历史记录列表。

## <a name="using-the-chtmlview-class-in-an-mfc-application"></a>在 MFC 应用程序中使用 CHtmlView 类

在标准 MFC 框架应用程序（基于 SDI 或 MDI）中，视图对象通常派生自专用的一组类。 这些类全部派生自 `CView`，它们提供 `CView`所没有提供的专用功能。

将 `CHtmlView` 作为应用程序的视图类的基础可向视图提供 WebBrowser 控件。 这将有效地使应用程序成为一个 Web 浏览器。 创建一个 Web 浏览器样式的应用程序的首选方法是使用 MFC 应用程序向导，并将 `CHtmlView` 指定为视图类。 有关在 MFC 应用程序内实现和使用 WebBrowser 控件的详细信息，请参阅 [创建 Web 浏览器样式的应用程序](../../mfc/reference/creating-a-web-browser-style-mfc-application.md)。

> [!NOTE]
> WebBrowser ActiveX 控件（因此 `CHtmlView`）仅可用于在 Windows NT 4.0 版或更高版本（其中安装了 Internet Explorer 4.0 版或更高版本）下运行的程序。

`CHtmlView` 用于可访问 Web（和/或 HTML 文档）的应用程序。 以下 `CHtmlView` 成员函数仅适用于 Internet Explorer 应用程序。 这些函数将在 WebBrowser 控件上成功运行，但不会有明显的效果。

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## <a name="requirements"></a>要求

**标头：** afxhtml.h

## <a name="chtmlviewcreate"></a><a name="create"></a>CHtmlView：创建

调用此成员函数为 Internet 资源管理器可执行文件创建 Web 浏览器控件或容器。

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>参数

*lpszClass名称*<br/>
指向命名 Windows 类的 null 端接字符串。 类名称可以是注册到[AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass)全局函数或`RegisterClass`Windows 函数的任何名称。 如果为 NULL，则使用预定义的默认[CFramewnd](../../mfc/reference/cframewnd-class.md)属性。

*lpsz窗口名称*<br/>
指向表示窗口名称的 null 端接字符串。

*dwStyle*<br/>
指定窗口样式属性。 默认情况下，将设置WS_VISIBLE和WS_CHILD Windows 样式。

*矩形*<br/>
对[RECT](/windows/win32/api/windef/ns-windef-rect)结构的引用，指定窗口的大小和位置。 *rectDefault*值允许 Windows 指定新窗口的大小和位置。

*pparentwnd*<br/>
指向控件的父窗口的指针。

*nID*<br/>
视图的 ID 号。 默认情况下，设置为AFX_IDW_PANE_FIRST。

*pContext*<br/>
指向[CCreateContext](../../mfc/reference/ccreatecontext-structure.md)的指针。 默认情况下为 NULL。

## <a name="chtmlviewcreatecontrolsite"></a><a name="createcontrolsite"></a>CHtmlView：创建控制网站

可重写，用于创建控件站点实例以承载窗体上的控件。

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### <a name="parameters"></a>参数

*pContainer*<br/>
指向包含控件的[COleControl 容器](../../mfc/reference/colecontrolcontainer-class.md)对象的指针。

*ppSite*<br/>
指向[指向 COleControlSite](../../mfc/reference/colecontrolsite-class.md)对象的指针，为控件提供站点。

*nID*<br/>
要托管的控件的标识符。

*Clsid*<br/>
要托管的控件的 CLSID

### <a name="return-value"></a>返回值

成功时返回 TRUE，在失败时返回 FALSE。

### <a name="remarks"></a>备注

您可以重写此成员函数以返回您自己的控件站点类的实例。

## <a name="chtmlviewexecformscommand"></a><a name="execformscommand"></a>CHtmlView：：执行形式命令

使用 `IOleCommandTarget::Exec` 方法执行指定的命令。

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### <a name="parameters"></a>参数

*dwCommandID*<br/>
要执行的命令。 此命令必须属于CMDSETID3_Forms3组。

*普瓦林*<br/>
指向包含输入`VARIANT`参数的结构的指针。 可以为 NULL。

*pVarOut*<br/>
指向接收`VARIANT`命令输出的结构的指针。 可以为 NULL。

### <a name="return-value"></a>返回值

标准 HRESULT 值。 有关可能值的完整列表，请参阅[IOleCommandTarget：：执行](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec)在 Windows SDK 中。

### <a name="remarks"></a>备注

`ExecFormsCommand`实现[IOleCommandTarget：：Exec](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec)方法的行为。

## <a name="chtmlviewexecwb"></a><a name="execwb"></a>CHtmlView：：执行WB

调用此成员函数以在 Web 浏览器或 Internet 资源管理器中执行命令。

```cpp
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### <a name="parameters"></a>参数

*cmdID*<br/>
要执行的命令。

*cmdexecopt*<br/>
用于执行命令的选项集。

*普瓦因*<br/>
用于指定命令输入参数的变体。

*pvaOut*<br/>
用于指定命令输出参数的变体。

### <a name="remarks"></a>备注

请参阅[IWeb 浏览器2：：在](/previous-versions//aa752117\(v=vs.85\))Windows SDK 中执行WB。

## <a name="chtmlviewgetaddressbar"></a><a name="getaddressbar"></a>CHtmlView：获取地址栏

调用此成员函数以检索 Internet 资源管理器的地址栏。

```
BOOL GetAddressBar() const;
```

### <a name="return-value"></a>返回值

如果地址栏可见，则非零;否则为零。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewgetapplication"></a><a name="getapplication"></a>CHtmlView：获取应用程序

调用此成员函数以检索包含 WebBrowser 控件的应用程序支持的自动化对象。

```
LPDISPATCH GetApplication() const;
```

### <a name="return-value"></a>返回值

指向活动文档对象的`IDispatch`接口的指针。 有关详细信息，请参阅 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetbusy"></a><a name="getbusy"></a>CHtmlView：获取忙碌

调用此成员函数以确定 WebBrowser 控件是否参与导航或下载操作。

```
BOOL GetBusy() const;
```

### <a name="return-value"></a>返回值

如果 Web 浏览器繁忙，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetcontainer"></a><a name="getcontainer"></a>CHtmlView：获取容器

调用此成员函数以检索评估到 Web 浏览器容器的对象。

```
LPDISPATCH GetContainer() const;
```

### <a name="return-value"></a>返回值

指向活动文档对象的`IDispatch`接口的指针。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetfullname"></a><a name="getfullname"></a>CHtmlView：获取全名

调用此成员函数以检索 Internet 资源管理器当前显示的文件的完整路径。

```
CString GetFullName() const;
```

### <a name="return-value"></a>返回值

包含当前显示文件的路径和名称的[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象。 如果不存在路径和文件名，`GetFullName`请返回空`CString`。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewgetfullscreen"></a><a name="getfullscreen"></a>CHtmlView：获取全屏

调用此成员函数以确定 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。

```
BOOL GetFullScreen() const;
```

### <a name="return-value"></a>返回值

如果 Web 浏览器在全屏模式下运行，则非零;否则为零。

### <a name="remarks"></a>备注

在全屏模式下，Internet Explorer 主窗口最大化，并隐藏状态栏、工具栏、菜单栏和标题栏。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetheight"></a><a name="getheight"></a>CHtmlView：获取高度

调用此成员函数以检索 WebBrowser 控件的帧窗口的高度（以像素为单位）。

```
long GetHeight() const;
```

### <a name="return-value"></a>返回值

控件的帧窗口高度（以像素为单位）。

## <a name="chtmlviewgethtmldocument"></a><a name="gethtmldocument"></a>CHtmlView：获取Html文档

调用此成员函数以检索活动文档的 HTML 文档。

```
LPDISPATCH GetHtmlDocument() const;
```

### <a name="return-value"></a>返回值

指向活动文档对象的`IDispatch`接口的指针。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetleft"></a><a name="getleft"></a>CHtmlView：获得左

调用此成员函数以检索 WebBrowser 控件的内部左边缘与其容器左边缘之间的距离。

```
long GetLeft() const;
```

### <a name="return-value"></a>返回值

左边缘距离（以像素为单位）。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetlocationname"></a><a name="getlocationname"></a>CHtmlView：获取位置名称

调用此成员函数以获取 Web 浏览器中显示的资源的名称。

```
CString GetLocationName() const;
```

### <a name="return-value"></a>返回值

包含当前在 Web 浏览器中显示的资源名称的[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象。

### <a name="remarks"></a>备注

如果资源是万维网上的 HTML 页，则名称是该页的标题。 如果资源是网络或本地计算机上的文件夹或文件，则名称是 UNC 或文件夹或文件的完整路径。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetlocationurl"></a><a name="getlocationurl"></a>CHtmlView：获取位置URL

调用此成员函数以检索 WebBrowser 控件当前显示的资源的 URL。

```
CString GetLocationURL() const;
```

### <a name="return-value"></a>返回值

包含当前显示在 Web 浏览器中的资源的 URL 的[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象。

### <a name="remarks"></a>备注

如果资源是网络或本地计算机上的文件夹或文件，则名称是 UNC 或文件夹或文件的完整路径。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetmenubar"></a><a name="getmenubar"></a>CHtmlView：获取菜单栏

调用此成员函数以确定菜单栏是否可见。

```
BOOL GetMenuBar() const;
```

### <a name="return-value"></a>返回值

如果菜单栏可见，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetoffline"></a><a name="getoffline"></a>CHtmlView：离线

调用此成员函数以确定 Web 浏览器是否脱机运行。

```
BOOL GetOffline() const;
```

### <a name="return-value"></a>返回值

如果 Web 浏览器当前处于脱机状态，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetparentbrowser"></a><a name="getparentbrowser"></a>CHtmlView：获取父浏览器

调用此成员函数以检索指向 WebBrowser 控件的父对象的指针。

```
LPDISPATCH GetParentBrowser() const;
```

### <a name="return-value"></a>返回值

指向对象`IDispatch`接口的指针，该接口是 WebBrowser 控件的父级。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetproperty"></a><a name="getproperty"></a>CHtmlView：获取属性

调用此成员函数获取当前与控件关联的属性的值。

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>参数

*lpsz属性*<br/>
指向包含要检索的属性的字符串的指针。

*strValue*<br/>
对接收属性的当前值的[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象的引用。

### <a name="return-value"></a>返回值

在第一个版本中，如果成功完成，则非零;否则为零。 在第二个版本中，一个[COleVariant](../../mfc/reference/colevariant-class.md)对象。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetreadystate"></a><a name="getreadystate"></a>CHtmlView：：准备状态

调用此成员函数以检索 Web 浏览器对象的就绪状态。

```
READYSTATE GetReadyState() const;
```

### <a name="return-value"></a>返回值

如 Windows SDK 中所述的[READYSTATE](/previous-versions//aa768362\(v=vs.85\))值。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetregisterasbrowser"></a><a name="getregisterasbrowser"></a>CHtmlView：获取注册浏览器

调用此成员函数以确定 WebBrowser 对象是否注册为目标名称解析的顶级浏览器。

```
BOOL GetRegisterAsBrowser() const;
```

### <a name="return-value"></a>返回值

如果浏览器注册为顶级浏览器，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetregisterasdroptarget"></a><a name="getregisterasdroptarget"></a>CHtmlView：：获取注册作为删除目标

调用此成员函数以确定 WebBrowser 控件是否注册为导航放置目标。

```
BOOL GetRegisterAsDropTarget() const;
```

### <a name="return-value"></a>返回值

如果浏览器注册为放置目标，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetsilent"></a><a name="getsilent"></a>CHtmlView：获得沉默

调用此成员函数以确定是否可以在 Web 浏览器控件中显示任何对话框。

```
BOOL GetSilent() const;
```

### <a name="return-value"></a>返回值

如果无法从 Web 浏览器控件显示对话框，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetsource"></a><a name="getsource"></a>CHtmlView：获取来源

调用此成员函数以检索网页的 HTML 源代码。

```
BOOL GetSource(CString& strRef);
```

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="parameters"></a>参数

*refString*<br/>
将保存源代码的[CString。](../../atl-mfc-shared/reference/cstringt-class.md)

### <a name="remarks"></a>备注

此功能等效于 Internet 资源管理器中的"视图源"命令，只不过源代码在 中`CString`返回。

## <a name="chtmlviewgetstatusbar"></a><a name="getstatusbar"></a>CHtmlView：获取状态栏

调用此成员函数以确定 Web 浏览器控件是否显示状态栏。

```
BOOL GetStatusBar() const;
```

### <a name="return-value"></a>返回值

如果可以显示状态栏，则非零;否则为零。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewgettheatermode"></a><a name="gettheatermode"></a>CHtmlView：获取剧场模式

调用此成员函数以确定 Web 浏览器是否处于影院模式。

```
BOOL GetTheaterMode() const;
```

### <a name="return-value"></a>返回值

如果 Web 浏览器处于影院模式，则非零;否则为零。

### <a name="remarks"></a>备注

当 Web 浏览器处于影院模式时，浏览器主窗口将填满整个屏幕，此时将显示一个工具栏，其中将显示一组最少的导航工具，并且状态栏将显示在屏幕的右上角。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettoolbar"></a><a name="gettoolbar"></a>CHtmlView：获取工具栏

调用此成员函数以确定工具栏是否可见。

```
int GetToolBar() const;
```

### <a name="return-value"></a>返回值

指示工具栏是否可见的值。 如果工具栏可见，则非零;否则为零。

## <a name="chtmlviewgettop"></a><a name="gettop"></a>CHtmlView：获取顶部

调用此成员函数以检索 WebBrowser 控件主窗口顶边缘的屏幕坐标。

```
long GetTop() const;
```

### <a name="return-value"></a>返回值

接收主窗口顶边缘的屏幕坐标的变量的地址。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettoplevelcontainer"></a><a name="gettoplevelcontainer"></a>CHtmlView：获取顶级容器

调用此成员函数以确定 Internet Explorer 是否是 Web 浏览器控件的顶级容器。

```
BOOL GetTopLevelContainer() const;
```

### <a name="return-value"></a>返回值

非零容器是顶级容器;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettype"></a><a name="gettype"></a>CHtmlView：获取类型

调用此成员函数以检索包含的活动文档的类型名称。

```
CString GetType() const;
```

### <a name="return-value"></a>返回值

包含包含活动文档的类型名称的[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetvisible"></a><a name="getvisible"></a>CHtmlView：获取可见

调用此成员函数以确定包含的对象是否可见。

```
BOOL GetVisible() const;
```

### <a name="return-value"></a>返回值

如果对象可见，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetwidth"></a><a name="getwidth"></a>CHtmlView：获取宽度

检索 Internet Explorer 主窗口的宽度。

```
long GetWidth() const;
```

### <a name="return-value"></a>返回值

窗口的当前宽度（以像素为单位）。

## <a name="chtmlviewgoback"></a><a name="goback"></a>CHtmlView：返回

在历史记录列表中向后导航一个项目。

```cpp
void GoBack();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgoforward"></a><a name="goforward"></a>CHtmlView：前进

向前导航历史记录列表中的一个项目。

```cpp
void GoForward();
```

## <a name="chtmlviewgohome"></a><a name="gohome"></a>CHtmlView：GoHome

导航到当前主页，或者启动“Internet Explorer Internet 选项”对话框或“Internet 属性”对话框（可从“控制面板”访问）中指定的网页。

```cpp
void GoHome();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgosearch"></a><a name="gosearch"></a>CHtmlView：GoSearch

导航到当前搜索页，如"Internet Explorer Internet 选项"对话框或"Internet 属性"对话框中指定的"Internet 属性"对话框中从"控制面板"访问。

```cpp
void GoSearch();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewloadfromresource"></a><a name="loadfromresource"></a>CHtmlView：从资源加载

调用此成员函数将指定的资源加载到 Web 浏览器控件中。

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### <a name="parameters"></a>参数

*lpsz资源*<br/>
指向包含要加载的资源名称的字符串的指针。

*nRes*<br/>
包含要加载的资源名称的缓冲区的 ID。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewnavigate"></a><a name="navigate"></a>CHtmlView：导航

调用此成员函数以导航到 URL 标识的资源。

```cpp
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### <a name="parameters"></a>参数

*URL*<br/>
包含要导航到的 URL 的调用方分配的字符串，或要显示的文件的完整路径。

dwFlags**<br/>
变量的标志，用于指定是将资源添加到历史记录列表、是读取还是写入缓存，以及是否在新窗口中显示资源。 变量可以是[浏览器导航常点](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))枚举定义的值的组合。

*lpsz目标帧名称*<br/>
指向字符串的指针，其中包含要在其中显示资源的框架的名称。

*lpszHeaders*<br/>
指向指定要发送到服务器的 HTTP 标头的值的指针。 这些标头将添加到默认的 Internet 资源管理器标头中。 标头可以指定服务器所需的操作、传递给服务器的数据类型或状态代码等内容。 如果*URL*不是 HTTP URL，则忽略此参数。

*lpvPostData*<br/>
指向要随 HTTP POST 事务发送的数据的指针。 例如，POST 事务用于发送 HTML 表单收集的数据。 如果此参数未指定任何发布数据，则`Navigate`发出 HTTP GET 事务。 如果*URL*不是 HTTP URL，则忽略此参数。

*德沃斯特数据伦*<br/>
与 HTTP POST 事务一起发送的数据。 例如，POST 事务用于发送 HTML 表单收集的数据。 如果此参数未指定任何发布数据，则`Navigate`发出 HTTP GET 事务。 如果*URL*不是 HTTP URL，则忽略此参数。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewnavigate2"></a><a name="navigate2"></a>CHtmlView：导航2

调用此成员函数以导航到 URL 标识的资源或完整路径标识的文件。

```cpp
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### <a name="parameters"></a>参数

*pIDL*<br/>
指向[ITEMIDLIST](/windows/win32/api/shtypes/ns-shtypes-itemidlist)结构的指针。

dwFlags**<br/>
变量的标志，用于指定是将资源添加到历史记录列表、是读取还是写入缓存，以及是否在新窗口中显示资源。 变量可以是[浏览器导航常点](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))枚举定义的值的组合。

*lpsz目标帧名称*<br/>
指向字符串的指针，其中包含要在其中显示资源的框架的名称。

*lpszURL*<br/>
指向包含 URL 的字符串的指针。

*lpvPostData*<br/>
与 HTTP POST 事务一起发送的数据。 例如，POST 事务用于发送 HTML 表单收集的数据。 如果此参数未指定任何发布数据，则`Navigate2`发出 HTTP GET 事务。 如果*URL*不是 HTTP 或 HTTPS URL，则忽略此参数。

*德沃斯特数据伦*<br/>
*lpvPostData*参数指向的数据的长度（以字节为单位）。

*lpszHeaders*<br/>
指向指定要发送到服务器的 HTTP 或 HTTPS 标头的值的指针。 这些标头将添加到默认的 Internet 资源管理器标头中。 标头可以指定服务器所需的操作、传递给服务器的数据类型或状态代码等内容。 如果*URL*不是 HTTP 或 HTTPS URL，则忽略此参数。

*baPostedData*<br/>
对[CByteArray](../../mfc/reference/cbytearray-class.md)对象的引用。

### <a name="remarks"></a>备注

此成员函数通过支持`Navigate`在参数*pIDL*表示的特殊文件夹（如桌面和我的计算机）上浏览来扩展成员功能。

适用于 Internet Explorer 和 WebBrowser。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

## <a name="chtmlviewonbeforenavigate2"></a><a name="onbeforenavigate2"></a>CHtmlView：：在导航前2

框架将调用此成员函数，以在 Web 浏览器中发生导航之前触发事件。

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### <a name="parameters"></a>参数

*lpszURL*<br/>
指向包含要导航到的 URL 的字符串的指针。

*nFlags*<br/>
保留供将来使用。

*lpsz目标帧名称*<br/>
包含要在其中显示资源的框架名称的字符串;如果资源没有指定帧，则 NULL。

*baPostedData*<br/>
对包含要发送到`CByteArray`服务器的对象的引用，如果正在使用 HTTP POST 事务。

*lpszHeaders*<br/>
指向包含要发送到服务器的其他 HTTP 标头的字符串的指针（仅限 HTTP URL）。 标头可以指定服务器所需的操作、传递给服务器的数据类型或状态代码等内容。

*pb取消*<br/>
指向取消标志的指针。 应用程序可以将此参数设置为非零以取消导航操作，也可以设置为零以允许它继续。

## <a name="chtmlviewoncommandstatechange"></a><a name="oncommandstatechange"></a>CHtmlView：在命令状态更改

框架调用此成员函数以通知应用程序 Web 浏览器命令的启用状态已更改。

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### <a name="parameters"></a>参数

*nCommand*<br/>
已启用状态已更改的命令的标识符。

*b 启用*<br/>
已启用状态。 如果启用了命令，则此参数为非零;如果禁用该参数，则为零。

## <a name="chtmlviewondocumentcomplete"></a><a name="ondocumentcomplete"></a>CHtmlView：在文档完成

框架调用此成员函数以通知应用程序文档已达到READYSTATE_COMPLETE状态。

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### <a name="parameters"></a>参数

*lpszURL*<br/>
指向计算到 URL、UNC 文件名或导航到的 PIDL（指向项标识符列表的指针）的字符串的指针。

### <a name="remarks"></a>备注

并不是每个帧都会触发此事件，但触发[OnDownloadBegin](#ondownloadbegin)事件的每个帧都将触发相应的`OnDocumentComplete`事件。

*lpszURL*指示的 URL 可能不同于浏览器被告知要导航到的 URL，因为此 URL 是规范化且限定的 URL。 例如，如果应用程序在导航或`"www.microsoft.com"`[导航2](#navigate2)的调用中指定[Navigate](#navigate)的 URL，则传递的`OnNavigateComplete2`URL`"<https://www.microsoft.com/>"`将为 。 此外，如果服务器将浏览器重定向到其他 URL，则重定向的 URL 将在此处反映出来。

## <a name="chtmlviewondocwindowactivate"></a><a name="ondocwindowactivate"></a>CHtmlView：在DocWindow激活

从 的 Internet Explorer 或`IOleInPlaceActiveObject::OnDocWindowActivate`MSHTML 实现调用 ，当激活或停用容器的文档窗口时，该实现会通知活动就地对象。

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>参数

*f 激活*<br/>
指示文档窗口的状态。 如果此值为非零，则窗口正在激活。 如果此值为零，则窗口将停用。

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnDocWindowActivate`以响应来自`OnDocWindowActivate`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：Windows](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\)) SDK 中的 OnDocWindow 激活。

## <a name="chtmlviewondownloadbegin"></a><a name="ondownloadbegin"></a>CHtmlView：：下载开始

框架调用此成员函数以开始下载文档。

```
virtual void OnDownloadBegin();
```

### <a name="remarks"></a>备注

除非取消导航，否则此事件在[On前导航2](#onbeforenavigate2)事件后不久触发。 容器需要显示的任何动画或"忙"指示都应连接到此事件。

## <a name="chtmlviewondownloadcomplete"></a><a name="ondownloadcomplete"></a>CHtmlView：下载完成

框架调用此成员函数以指示导航操作已完成、已停止或失败。

```
virtual void OnDownloadComplete();
```

## <a name="chtmlviewonenablemodeless"></a><a name="onenablemodeless"></a>CHtmlView：启用无模式

当 Internet 资源管理器或 MSHTML 显示模式 UI 时调用。

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### <a name="parameters"></a>参数

*f 启用*<br/>
指示主机的无模式对话框是启用还是禁用。 如果此值是非零，则启用无模式对话框。 如果此值为零，则禁用无模式对话框。

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

当容器创建或销毁模式对话框时，启用或禁用无模式对话框。 覆盖`OnEnableModeless`以响应来自`EnableModeless`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：：在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\))Windows SDK 中启用无模式。

## <a name="chtmlviewonfilterdataobject"></a><a name="onfilterdataobject"></a>CHtmlView：在筛选数据对象上

由 Internet Explorer 或 MSHTML 对主机调用，以允许主机替换 Internet Explorer 或 MSHTML 的数据对象。

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
由 Internet 资源管理器或 MSHTML 提供的[IDataObject](/windows/win32/api/objidl/nn-objidl-idataobject)接口的地址。

*ppDataObject*<br/>
接收主机提供的`IDataObject`接口指针的地址。 此参数的内容应始终初始化为 NULL，即使该方法失败也是如此。

### <a name="return-value"></a>返回值

S_OK如果替换了数据对象，则S_FALSE未替换数据对象，或者发生错误时使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnFilterDataObject`以响应来自`FilterDataObject`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：：在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\))Windows SDK 中筛选数据对象。

## <a name="chtmlviewonframewindowactivate"></a><a name="onframewindowactivate"></a>CHtmlView：在框架窗口激活

从[IOleInPlaceActiveObject 调用：在FrameWindow激活上](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate)，以便在激活或停用容器的顶级框架窗口时通知对象。

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>参数

*f 激活*<br/>
指示容器的顶层框架窗口的状态。 如果此值为非零，则窗口正在激活。 如果此值为零，则窗口将停用。

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnFrameWindowActivate`以响应来自`OnFrameWindowActivate`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：Windows SDK 中的"帧窗口激活](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\))"。

## <a name="chtmlviewonfullscreen"></a><a name="onfullscreen"></a>CHtmlView：全屏

[当 FullScreen](/previous-versions/aa752119\(v=vs.85\))属性发生更改时，框架将调用此成员函数。

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### <a name="parameters"></a>参数

*b 全屏幕*<br/>
如果 Internet 资源管理器处于全屏模式，则非零;零否则。

## <a name="chtmlviewongetdroptarget"></a><a name="ongetdroptarget"></a>CHtmlView：：OnGetDropTarget

当用作放置目标时由 Internet Explorer 或 MSHTML 调用以允许主机提供替代的 `IDropTarget`。

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### <a name="parameters"></a>参数

*pDropTarget*<br/>
[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)互联网浏览器或MSHTML建议使用。

*ppDrop目标*<br/>
`IDropTarget`接收主机希望提供的`IDropTarget`接口指针的地址。

### <a name="return-value"></a>返回值

有关返回代码的列表，请参阅[IDocHostUIHandler：获取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\))Windows SDK 中的DropTarget。

### <a name="remarks"></a>备注

覆盖`OnGetDropTarget`以响应来自`GetDropTarget`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：获取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\))Windows SDK 中的DropTarget。

## <a name="chtmlviewongetexternal"></a><a name="ongetexternal"></a>CHtmlView：：打开外部

由 Internet Explorer 或 MSHTML 调用以获取主机的 `IDispatch` 接口。

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### <a name="parameters"></a>参数

*lppDispatch*<br/>
指向接收主机应用程序的`IDispatch`接口指针的地址的指针。 如果主机公开了自动化接口，则可以通过此参数提供对 Internet 资源管理器或 MSHTML 的引用。 此参数的内容应始终初始化为 NULL，即使该方法失败也是如此。

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnGetExternal`以响应来自`GetExternal`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：获取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\))Windows SDK 中的外部信息。

## <a name="chtmlviewongethostinfo"></a><a name="ongethostinfo"></a>CHtmlView：：OngetHostinfo

检索 Internet Explorer 或 MSHTML 主机的用户界面功能。

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### <a name="parameters"></a>参数

*pInfo*<br/>
接收主机 UI 功能的[DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\))结构的地址。

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnGetHostInfo`以响应来自`GetHostInfo`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：获取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\))Windows SDK 中的HostInfo。

## <a name="chtmlviewongetoptionkeypath"></a><a name="ongetoptionkeypath"></a>CHtmlView：：在获取选项关键路径

调用此成员函数获取 Internet 资源管理器或 MSHTML 存储用户首选项的注册表项。

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### <a name="parameters"></a>参数

*pchKey*<br/>
`LPOLESTR`接收主机存储其默认选项的注册表子键字符串的地址。 此子键将HKEY_CURRENT_USER键下。 使用[CoTaskMeaalloc](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc)分配此内存。 调用应用程序负责释放此内存使用[CoTaskMemFree](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree)。 应始终将此参数初始化为 NULL，即使该方法失败也是如此。

*dw保留*<br/>
保留供将来使用。 当前未使用。

### <a name="return-value"></a>返回值

S_OK成功，或S_FALSE。 如果S_FALSE，Internet 资源管理器或 MSHTML 将默认为其自己的用户选项。

### <a name="remarks"></a>备注

覆盖`OnGetOptionKeyPath`以响应来自`GetOptionKeyPath`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：获取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\))Windows SDK 中的OptionKeyPath。

## <a name="chtmlviewonhideui"></a><a name="onhideui"></a>CHtmlView：：打开隐藏UI

当 Internet 资源管理器或 MSHTML 删除其菜单和工具栏时，框架将调用此成员函数。

```
virtual HRESULT OnHideUI();
```

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnHideUI`以响应来自`HideUI`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：：在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\))Windows SDK 中隐藏 UI。

## <a name="chtmlviewonmenubar"></a><a name="onmenubar"></a>CHtmlView：：在Menubar上

当[MenuBar](/previous-versions/aa752131\(v=vs.85\))属性发生更改时，框架将调用此成员函数。

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### <a name="parameters"></a>参数

*bMenuBar*<br/>
如果 Internet Explorer 菜单栏可见，则非零;零否则。

## <a name="chtmlviewonnavigatecomplete2"></a><a name="onnavigatecomplete2"></a>CHtmlView：：导航完成2

在导航到超链接（在窗口或框架集元素上）后，框架将调用此成员函数。

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### <a name="parameters"></a>参数

*strURL*<br/>
计算到导航到的 URL、UNC 文件名或 PIDL（指向项标识符列表的指针）的字符串表达式。

### <a name="remarks"></a>备注

对于没有 URL 表示形式的 shell 名称空间实体，URL 参数可以是 PIDL。

请注意 *，strURL*中包含的 URL 可能不同于浏览器被告知要导航到的 URL，因为此 URL 是规范化且限定的 URL。 例如，如果应用程序在导航或`"www.microsoft.com"`[导航2](#navigate2)的调用中指定[Navigate](#navigate)的 URL，则传递的`OnNavigateComplete2`URL`"<https://www.microsoft.com/>"`将为 。 此外，如果服务器将浏览器重定向到其他 URL，则重定向的 URL 将在此处反映出来。

## <a name="chtmlviewonnavigateerror"></a><a name="onnavigateerror"></a>CHtmlView：在导航错误

当导航到超链接失败时由框架调用。

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### <a name="parameters"></a>参数

*lpszURL*<br/>
导航失败的 URL。

*lpsz框架*<br/>
要显示资源的帧的名称，如果资源没有指定帧，则为 NULL。

*dwError*<br/>
错误状态代码（如果可用）。 有关可能的 HRESULT 和 HTTP 状态代码的列表，请参阅[导航错误事件状态代码。 .](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768365\(v=vs.85\))

*pb取消*<br/>
指定是取消对错误页的导航还是任何进一步的自动搜索。 如果 TRUE（默认值），请继续导航到错误页或自动搜索;如果 FALSE，则取消对错误页面的导航或自动搜索。

### <a name="remarks"></a>备注

重写此方法以提供自定义导航错误处理。

有关详细信息，请参阅[DWeb 浏览器事件2：：导航错误](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768286\(v=vs.85\))

## <a name="chtmlviewonnewwindow2"></a><a name="onnewwindow2"></a>CHtmlView：：打开新窗口2

当为显示资源而创建新窗口时，框架将调用此成员函数。

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### <a name="parameters"></a>参数

*ppDisp*<br/>
指向接口指针的指针，该指针可以选择接收新 WebBrowser`IDispatch`或 Internet 资源管理器对象的接口指针。

*取消*<br/>
指向取消标志的指针。 应用程序可以将此参数设置为非零以取消导航操作，也可以设置为零以允许它继续。

### <a name="remarks"></a>备注

此事件先于从 Web 浏览器中创建新窗口。

## <a name="chtmlviewonprogresschange"></a><a name="onprogresschange"></a>CHtmlView：：在进度更改上

框架调用此成员函数以通知应用程序下载操作的进度已更新。

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### <a name="parameters"></a>参数

*n进步*<br/>
要显示的总进度量，或进度完成后的 -1。

*n进步马克斯*<br/>
最大进度值。

### <a name="remarks"></a>备注

容器可以使用此事件提供的信息来显示到目前为止下载的字节数或更新进度指示器。

## <a name="chtmlviewonpropertychange"></a><a name="onpropertychange"></a>CHtmlView：：在属性更改上

框架调用此成员函数以通知应用程序[PutProperty](#putproperty)已更改属性的值。

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>参数

*lpsz属性*<br/>
指向包含属性名称的字符串的指针。

## <a name="chtmlviewonquit"></a><a name="onquit"></a>CHtmlView：：打开

框架调用此成员函数以通知应用程序 Internet Explorer 应用程序已准备好退出。

```
virtual void OnQuit();
```

## <a name="chtmlviewonresizeborder"></a><a name="onresizeborder"></a>CHtmlView：在重调整边界

从[IOleInPlaceActiveObject：：调整边框](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)的 Internet 资源管理器或 MSHTML 实现调用，该函数会提醒需要调整其边框空间的大小的对象。

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### <a name="parameters"></a>参数

*prc边界*<br/>
边框空间的新外部矩形。

*pUI窗口*<br/>
指向边框已更改的框架或文档窗口对象的接口的指针。

*fFrame 窗口*<br/>
如果帧窗口正在调用[IOleInPlace 活动对象：：：调整边框大小](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)，否则为 FALSE。

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnResizeBorder`以响应来自`ResizeBorder`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：：调整](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\))Windows SDK 中的边框大小。

## <a name="chtmlviewonshowcontextmenu"></a><a name="onshowcontextmenu"></a>CHtmlView：：在显示上下文菜单

当 Internet Explorer 或 MSHTML 将要显示其上下文菜单时，从其调用。

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### <a name="parameters"></a>参数

*dwID*<br/>
要显示的上下文菜单的标识符。 有关`IDocHostUIHandler::ShowContextMenu`值列表，请参阅 Windows SDK。

*Ppt*<br/>
菜单的屏幕坐标。

*pcmdt保留*<br/>
[IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget)接口用于查询命令状态并在此对象上执行命令。

*pdisp保留*<br/>
屏幕坐标处对象的 IDispatch 接口。 这允许主机区分特定对象以提供更具体的上下文。

### <a name="return-value"></a>返回值

有关值列表，请参阅[IDocHostUIHandler：：](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\))在 Windows SDK 中显示上下文菜单。

### <a name="remarks"></a>备注

覆盖`OnShowContextMenu`以响应来自`ShowContextMenu`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\))Windows SDK 中显示上下文菜单。

## <a name="chtmlviewonshowui"></a><a name="onshowui"></a>CHtmlView：：在ShowUI上

在 Internet Explorer 或 MSHTML 显示其菜单和工具栏之前调用。

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### <a name="parameters"></a>参数

*dwID*<br/>
保留供将来使用。

*p活动对象*<br/>
[当前活动对象的 IOleInPlace 活动对象](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceactiveobject)接口。

*pCommand目标*<br/>
[对象的 IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget)接口。

*pFrame*<br/>
[对象的 IOleInPlaceFrame](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceframe)接口。 菜单和工具栏需要这样做。

*pDoc*<br/>
[对象的 IOleInPlaceUI 窗口](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceuiwindow)接口。 工具栏需要这样做。

### <a name="return-value"></a>返回值

有关值列表，请参阅[IDocHostUIHandler：：](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\))在 Windows SDK 中显示 UI。

### <a name="remarks"></a>备注

覆盖`OnShowUI`以响应来自`ShowUI`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：Windows](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) SDK 中的显示 UI。

## <a name="chtmlviewonstatusbar"></a><a name="onstatusbar"></a>CHtmlView："打开状态栏"

当[StatusBar](/previous-versions//aa768270\(v=vs.85\))属性发生更改时，框架将调用此成员函数。

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### <a name="parameters"></a>参数

*bStatusBar*<br/>
如果 Internet Explorer 的状态栏可见或为零，则非零。

## <a name="chtmlviewonstatustextchange"></a><a name="onstatustextchange"></a>CHtmlView：：在状态文本更改上

框架调用此成员函数以通知应用程序与 WebBrowser 控件关联的状态栏的文本已更改。

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
包含新状态栏文本的字符串。

## <a name="chtmlviewontheatermode"></a><a name="ontheatermode"></a>CHtmlView：在剧场模式

当[TheaterMode](/previous-versions/aa768273\(v=vs.85\))属性发生更改时，框架将调用此成员函数。

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### <a name="parameters"></a>参数

*bTheater模式*<br/>
如果 Internet 资源管理器处于影院模式，则非零;零否则。

## <a name="chtmlviewontitlechange"></a><a name="ontitlechange"></a>CHtmlView：：打开标题更改

如果 WebBrowser 控件中的文档标题可用或更改，则框架将调用此成员函数以通知应用程序。

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>参数

*lpszText*<br/>
新文档标题。

### <a name="remarks"></a>备注

对于 HTML，标题可能会更改;对于 HTML，标题可能会更改。当 HTML 仍在下载时，文档的 URL 设置为标题。 从 HTML 解析真实标题（如果有）后，将更改标题以反映实际标题。

## <a name="chtmlviewontoolbar"></a><a name="ontoolbar"></a>CHtmlView：：在工具栏上

[当工具栏](/previous-versions/aa768274\(v=vs.85\))属性发生更改时，框架将调用此成员函数。

```
virtual void OnToolBar(BOOL bToolBar);
```

### <a name="parameters"></a>参数

*bToolBar*<br/>
如果 Internet Explorer 的工具栏可见或为零，则非零。

## <a name="chtmlviewontranslateaccelerator"></a><a name="ontranslateaccelerator"></a>CHtmlView：在翻译加速器上

当[IOleInPlaceActiveObject：：翻译加速器](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator)或[IOleControlSite：：翻译加速器](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator)调用时，由 Internet Explorer 或 MSHTML 调用，以处理来自容器消息队列的菜单加速器键消息。

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### <a name="parameters"></a>参数

*lpMsg*<br/>
指向可能需要翻译的消息。

*普吉德集团*<br/>
命令组标识符。

*nCmdID*<br/>
命令标识符。

### <a name="return-value"></a>返回值

S_OK成功，或S_FALSE。

### <a name="remarks"></a>备注

覆盖`OnTranslateAccelerator`以响应来自`TranslateAccelerator`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：翻译](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\))Windows SDK 中的加速器。

## <a name="chtmlviewontranslateurl"></a><a name="ontranslateurl"></a>CHtmlView：在翻译上

由 Internet Explorer 或 MSHTML 调用以允许主机有机会修改要加载的 URL。

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### <a name="parameters"></a>参数

*dwTranslate*<br/>
保留供将来使用。

*普乔林*<br/>
Internet Explorer 或 MSHTML 提供的字符串的地址，该字符串表示要翻译的 URL。

*ppchURLOut*<br/>
接收已翻译 URL 地址的字符串指针的地址。 主机使用任务内存分配器分配缓冲区。 此参数的内容应始终初始化为 NULL，即使 URL 未翻译或方法失败也是如此。

### <a name="return-value"></a>返回值

`S_OK`如果 URL 已翻译，则S_FALSE未翻译 URL，如果发生错误，则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

覆盖`OnTranslateUrl`以响应来自`TranslateUrl`Microsoft Web 浏览器控件的通知。 有关详细信息[，请参阅 IDocHostUIHandler：翻译 Windows](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) SDK 中的 Url。

## <a name="chtmlviewonupdateui"></a><a name="onupdateui"></a>CHtmlView：关于更新的信息

通知主机命令状态已更改。

```
virtual HRESULT OnUpdateUI();
```

### <a name="return-value"></a>返回值

S_OK如果成功，或否则使用 OLE 定义的错误代码。

### <a name="remarks"></a>备注

主机应更新工具栏按钮的状态。 无论返回`ShowUI`值如何，都将调用此方法。 覆盖`OnUpdateUI`以响应来自`UpdateUI`Microsoft Web 浏览器控件的通知。

## <a name="chtmlviewonvisible"></a><a name="onvisible"></a>CHtmlView：：在可见

当显示或隐藏 Web 浏览器的窗口时，框架将调用此成员函数。

```
virtual void OnVisible(BOOL bVisible);
```

### <a name="parameters"></a>参数

*b可见*<br/>
如果对象可见或为零，则非零。

### <a name="remarks"></a>备注

这允许对象控件主机窗口的做同 Internet 资源管理器窗口的一样。

## <a name="chtmlviewputproperty"></a><a name="putproperty"></a>CHtmlView：:P

调用此成员函数以设置与给定对象关联的属性。

```cpp
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### <a name="parameters"></a>参数

*lpsz属性*<br/>
包含要设置的属性的字符串。

*vtValue*<br/>
*lpszProperty*指示的属性的新值。

*lpsz属性名称*<br/>
指向要设置的属性名称的字符串的指针。

*dValue*<br/>
属性的新值。

*lValue*<br/>
属性的新值。

*lpszValue*<br/>
指向包含属性新值的字符串的指针。

*n值*<br/>
属性的新值。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewqueryformscommand"></a><a name="queryformscommand"></a>CHtmlView：：查询表单命令

查询由用户界面事件生成的一个或多个命令的状态。

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### <a name="parameters"></a>参数

*dwCommandID*<br/>
要查询的命令的标识符。

*pb 支持*<br/>
指向 BOOL 的指针，指定命令（由*dwCommandID*标识）是否受支持。 如果为 TRUE，则支持该命令;如果为 TRUE，则为该命令。否则 FALSE。

*pb 启用*<br/>
指向 BOOL 的指针，指定命令（由*dwCommandID*标识）是否启用。 如果为 TRUE，则支持该命令;如果为 TRUE，则为该命令。否则 FALSE。

*pbChecked*<br/>
指向 BOOL 的指针，指定是否选中命令（由*dwCommandID*标识）。 如果为 TRUE，则支持该命令;如果为 TRUE，则为该命令。否则 FALSE。

### <a name="return-value"></a>返回值

标准 HRESULT 值。 有关可能值的完整列表，请参阅[IOleCommandTarget：：Windows](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) SDK 中的查询状态。

### <a name="remarks"></a>备注

`QueryFormsCommand`实现[IOleCommandTarget：：查询状态](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法的行为。

## <a name="chtmlviewquerystatuswb"></a><a name="querystatuswb"></a>CHtmlView：查询状态WB

调用此成员函数以查询命令状态。

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### <a name="parameters"></a>参数

*cmdID*<br/>
调用方需要状态信息的命令的[OLECMDID](/windows/win32/api/docobj/ne-docobj-olecmdid)值。

### <a name="return-value"></a>返回值

接收命令状态的[OLECMDF](/windows/win32/api/docobj/ne-docobj-olecmdf)值的地址。

### <a name="remarks"></a>备注

`QueryStatusWB`实现[IOleCommandTarget：：查询状态](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法的行为。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewrefresh"></a><a name="refresh"></a>CHtmlView：刷新

重新加载 Web 浏览器当前显示的 URL 或文件。

```cpp
void Refresh();
```

### <a name="remarks"></a>备注

`Refresh`不包含用于设置刷新级别的参数。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewrefresh2"></a><a name="refresh2"></a>CHtmlView：刷新2

重新加载 Internet 资源管理器当前显示的文件。

```cpp
void Refresh2(int nLevel);
```

### <a name="parameters"></a>参数

*n 级别*<br/>
指定刷新级别的变量的地址。 可能的变量在 Windows SDK 中"[刷新常点"](/previous-versions/aa768363\(v=vs.85\))中定义。

### <a name="remarks"></a>备注

与[刷新](#refresh)不同`Refresh2`，包含指定刷新级别的参数。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetaddressbar"></a><a name="setaddressbar"></a>CHtmlView：设置地址栏

调用此成员函数以显示或隐藏 Internet Explorer 对象的地址栏。

```cpp
void SetAddressBar(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
非零显示地址栏;否则为零。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewsetfullscreen"></a><a name="setfullscreen"></a>CHtmlView：设置全屏

调用此成员函数将 Internet 资源管理器设置为全屏或正常窗口模式。

```cpp
void SetFullScreen(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
全屏模式的非零;否则为零。

### <a name="remarks"></a>备注

在全屏模式下，Internet Explorer 主窗口最大化，并隐藏状态栏、工具栏、菜单栏和标题栏。

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewsetheight"></a><a name="setheight"></a>CHtmlView：设置高度

调用此成员函数以设置 Internet 资源管理器主窗口的高度。

```cpp
void SetHeight(long nNewValue);
```

### <a name="parameters"></a>参数

*n 新值*<br/>
主窗口的高度（以像素为单位）。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetleft"></a><a name="setleft"></a>CHtmlView：：设置左

设置 Internet Explorer 主窗口的水平位置。

```cpp
void SetLeft(long nNewValue);
```

### <a name="parameters"></a>参数

*n 新值*<br/>
主窗口左边缘的屏幕坐标。

## <a name="chtmlviewsetmenubar"></a><a name="setmenubar"></a>CHtmlView：设置菜单栏

调用此成员函数以显示或隐藏 Internet Explorer 菜单栏。

```cpp
void SetMenuBar(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
非零显示菜单栏;否则为零。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewsetoffline"></a><a name="setoffline"></a>CHtmlView：：设置离线

调用此成员函数以设置指示 WebBrowser 控件当前是否处于脱机模式的值。

```cpp
void SetOffline(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
从本地缓存读取的非零;否则为零。

### <a name="remarks"></a>备注

在脱机模式下，浏览器从本地缓存而不是源文档读取 HTML 页面。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetregisterasbrowser"></a><a name="setregisterasbrowser"></a>CHtmlView：：设置注册浏览器

调用此成员函数以设置一个值，指示 WebBrowser 控件是否已注册为目标名称解析的顶级浏览器。

```cpp
void SetRegisterAsBrowser(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
确定 Internet 资源管理器是否注册为顶级浏览器。 如果为非零，则 Web 浏览器将注册为顶级浏览器;如果为非零，则将 Web 浏览器注册为顶级浏览器。如果为零，则它不是顶级浏览器。 默认值为零。

### <a name="remarks"></a>备注

顶级浏览器是注册表中设置为默认浏览器的浏览器。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetregisterasdroptarget"></a><a name="setregisterasdroptarget"></a>CHtmlView：：设置注册作为删除目标

调用此成员函数以设置一个值，指示 WebBrowser 控件是否已注册为导航放置目标。

```cpp
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
确定 WebBrowser 控件是否注册为导航的放置目标。 如果非零，则对象注册为放置目标;如果为非零，则对象将注册为放置目标。如果为零，则它不是放置目标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetsilent"></a><a name="setsilent"></a>CHtmlView：设置静音

调用此成员函数以设置指示是否可以显示任何对话框的值。

```cpp
void SetSilent(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
如果未为零，将不会显示对话框;如果为零，则不会显示对话框。如果为零，将显示对话框。 默认值为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetstatusbar"></a><a name="setstatusbar"></a>CHtmlView：设置状态栏

调用此成员函数以显示状态栏。

```cpp
void SetStatusBar(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
如果状态栏可见，则非零;否则为零。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewsettheatermode"></a><a name="settheatermode"></a>CHtmlView：设置剧场模式

调用此成员函数以设置指示 Web 浏览器控件是否处于影院模式的值。

```cpp
void SetTheaterMode(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
将 Web 浏览器控件设置为影院模式的非零;否则为零。 默认值为零。

### <a name="remarks"></a>备注

当 Web 浏览器处于影院模式时，浏览器主窗口将填满整个屏幕，此时将显示一个工具栏，其中将显示一组最少的导航工具，并且状态栏将显示在屏幕的右上角。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsettoolbar"></a><a name="settoolbar"></a>CHtmlView：设置工具栏

调用此成员函数以显示或隐藏 Internet Explorer 工具栏。

```cpp
void SetToolBar(int nNewValue);
```

### <a name="parameters"></a>参数

*n 新值*<br/>
指示是否显示工具栏。 如果要显示工具栏，则非零;否则为零。

### <a name="remarks"></a>备注

适用于互联网浏览器。 如果使用此调用与 Web 浏览器控件一起，它将不会返回任何错误，但它将忽略此调用。

## <a name="chtmlviewsettop"></a><a name="settop"></a>CHtmlView：：设置顶部

调用此成员函数以设置 Web 浏览器控件的内部上边缘与其容器顶部边缘之间的距离

```cpp
void SetTop(long nNewValue);
```

### <a name="parameters"></a>参数

*n 新值*<br/>
主窗口上边缘的屏幕坐标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetvisible"></a><a name="setvisible"></a>CHtmlView：：设置可见

调用此成员函数以设置 Web 浏览器控件的可见性状态。

```cpp
void SetVisible(BOOL bNewValue);
```

### <a name="parameters"></a>参数

*b 新值*<br/>
如果控件可见，则非零;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetwidth"></a><a name="setwidth"></a>CHtmlView：：设置宽度

设置 Internet Explorer 主窗口的宽度。

```cpp
void SetWidth(long nNewValue);
```

### <a name="parameters"></a>参数

*n 新值*<br/>
Internet 资源管理器主窗口的宽度（以像素为单位）。

## <a name="chtmlviewstop"></a><a name="stop"></a>CHtmlView：停止

调用此成员函数以取消任何挂起的导航或下载操作，并停止任何动态页面元素，如背景声音和动画。

```cpp
void Stop();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="see-also"></a>请参阅

[MFC 示例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CFormView 类](../../mfc/reference/cformview-class.md)<br/>
[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/win32/api/exdisp/nn-exdisp-iwebbrowser2)
