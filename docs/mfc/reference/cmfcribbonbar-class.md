---
title: CMFC剪条类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonBar
- AFXRIBBONBAR/CMFCRibbonBar
- AFXRIBBONBAR/CMFCRibbonBar::ActivateContextCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddContextCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddMainCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddPrintPreviewCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddQATOnlyCategory
- AFXRIBBONBAR/CMFCRibbonBar::AddToTabs
- AFXRIBBONBAR/CMFCRibbonBar::CreateEx
- AFXRIBBONBAR/CMFCRibbonBar::Create
- AFXRIBBONBAR/CMFCRibbonBar::DeactivateKeyboardFocus
- AFXRIBBONBAR/CMFCRibbonBar::DrawMenuImage
- AFXRIBBONBAR/CMFCRibbonBar::DWMCompositionChanged
- AFXRIBBONBAR/CMFCRibbonBar::EnableKeyTips
- AFXRIBBONBAR/CMFCRibbonBar::EnablePrintPreview
- AFXRIBBONBAR/CMFCRibbonBar::EnableToolTips
- AFXRIBBONBAR/CMFCRibbonBar::FindByData
- AFXRIBBONBAR/CMFCRibbonBar::FindByID
- AFXRIBBONBAR/CMFCRibbonBar::FindCategoryIndexByData
- AFXRIBBONBAR/CMFCRibbonBar::ForceRecalcLayout
- AFXRIBBONBAR/CMFCRibbonBar::GetActiveCategory
- AFXRIBBONBAR/CMFCRibbonBar::GetCaptionHeight
- AFXRIBBONBAR/CMFCRibbonBar::GetCategory
- AFXRIBBONBAR/CMFCRibbonBar::GetCategoryCount
- AFXRIBBONBAR/CMFCRibbonBar::GetCategoryHeight
- AFXRIBBONBAR/CMFCRibbonBar::GetCategoryIndex
- AFXRIBBONBAR/CMFCRibbonBar::GetContextName
- AFXRIBBONBAR/CMFCRibbonBar::GetDroppedDown
- AFXRIBBONBAR/CMFCRibbonBar::GetElementsByID
- AFXRIBBONBAR/CMFCRibbonBar::GetApplicationButton
- AFXRIBBONBAR/CMFCRibbonBar::GetFocused
- AFXRIBBONBAR/CMFCRibbonBar::GetHideFlags
- AFXRIBBONBAR/CMFCRibbonBar::GetItemIDsList
- AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavigationLevel
- AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavLevelCurrent
- AFXRIBBONBAR/CMFCRibbonBar::GetKeyboardNavLevelParent
- AFXRIBBONBAR/CMFCRibbonBar::GetMainCategory
- AFXRIBBONBAR/CMFCRibbonBar::GetQATCommandsLocation
- AFXRIBBONBAR/CMFCRibbonBar::GetQATDroppedDown
- AFXRIBBONBAR/CMFCRibbonBar::GetQuickAccessCommands
- AFXRIBBONBAR/CMFCRibbonBar::GetQuickAccessToolbarLocation
- AFXRIBBONBAR/CMFCRibbonBar::GetTabTrancateRatio
- AFXRIBBONBAR/CMFCRibbonBar::GetTooltipFixedWidthLargeImage
- AFXRIBBONBAR/CMFCRibbonBar::GetTooltipFixedWidthRegular
- AFXRIBBONBAR/CMFCRibbonBar::GetVisibleCategoryCount
- AFXRIBBONBAR/CMFCRibbonBar::HideAllContextCategories
- AFXRIBBONBAR/CMFCRibbonBar::HideKeyTips
- AFXRIBBONBAR/CMFCRibbonBar::HitTest
- AFXRIBBONBAR/CMFCRibbonBar::IsKeyTipEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsMainRibbonBar
- AFXRIBBONBAR/CMFCRibbonBar::IsPrintPreviewEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsQATEmpty
- AFXRIBBONBAR/CMFCRibbonBar::IsQuickAccessToolbarOnTop
- AFXRIBBONBAR/CMFCRibbonBar::IsReplaceFrameCaption
- AFXRIBBONBAR/CMFCRibbonBar::IsShowGroupBorder
- AFXRIBBONBAR/CMFCRibbonBar::IsToolTipDescrEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsToolTipEnabled
- AFXRIBBONBAR/CMFCRibbonBar::IsTransparentCaption
- AFXRIBBONBAR/CMFCRibbonBar::IsWindows7Look
- AFXRIBBONBAR/CMFCRibbonBar::LoadFromResource
- AFXRIBBONBAR/CMFCRibbonBar::OnClickButton
- AFXRIBBONBAR/CMFCRibbonBar::OnEditContextMenu
- AFXRIBBONBAR/CMFCRibbonBar::OnRTLChanged
- AFXRIBBONBAR/CMFCRibbonBar::OnSetAccData
- AFXRIBBONBAR/CMFCRibbonBar::OnShowRibbonContextMenu
- AFXRIBBONBAR/CMFCRibbonBar::OnShowRibbonQATMenu
- AFXRIBBONBAR/CMFCRibbonBar::OnSysKeyDown
- AFXRIBBONBAR/CMFCRibbonBar::OnSysKeyUp
- AFXRIBBONBAR/CMFCRibbonBar::PopTooltip
- AFXRIBBONBAR/CMFCRibbonBar::PreTranslateMessage
- AFXRIBBONBAR/CMFCRibbonBar::RecalcLayout
- AFXRIBBONBAR/CMFCRibbonBar::RemoveAllCategories
- AFXRIBBONBAR/CMFCRibbonBar::RemoveAllFromTabs
- AFXRIBBONBAR/CMFCRibbonBar::RemoveCategory
- AFXRIBBONBAR/CMFCRibbonBar::SaveToXMLBuffer
- AFXRIBBONBAR/CMFCRibbonBar::SaveToXMLFile
- AFXRIBBONBAR/CMFCRibbonBar::SetActiveCategory
- AFXRIBBONBAR/CMFCRibbonBar::SetActiveMDIChild
- AFXRIBBONBAR/CMFCRibbonBar::SetElementKeys
- AFXRIBBONBAR/CMFCRibbonBar::SetApplicationButton
- AFXRIBBONBAR/CMFCRibbonBar::SetKeyboardNavigationLevel
- AFXRIBBONBAR/CMFCRibbonBar::SetMaximizeMode
- AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessCommands
- AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessDefaultState
- AFXRIBBONBAR/CMFCRibbonBar::SetQuickAccessToolbarOnTop
- AFXRIBBONBAR/CMFCRibbonBar::SetTooltipFixedWidth
- AFXRIBBONBAR/CMFCRibbonBar::SetWindows7Look
- AFXRIBBONBAR/CMFCRibbonBar::ShowCategory
- AFXRIBBONBAR/CMFCRibbonBar::ShowContextCategories
- AFXRIBBONBAR/CMFCRibbonBar::ShowKeyTips
- AFXRIBBONBAR/CMFCRibbonBar::ToggleMimimizeState
- AFXRIBBONBAR/CMFCRibbonBar::TranslateChar
helpviewer_keywords:
- CMFCRibbonBar [MFC], ActivateContextCategory
- CMFCRibbonBar [MFC], AddCategory
- CMFCRibbonBar [MFC], AddContextCategory
- CMFCRibbonBar [MFC], AddMainCategory
- CMFCRibbonBar [MFC], AddPrintPreviewCategory
- CMFCRibbonBar [MFC], AddQATOnlyCategory
- CMFCRibbonBar [MFC], AddToTabs
- CMFCRibbonBar [MFC], CreateEx
- CMFCRibbonBar [MFC], Create
- CMFCRibbonBar [MFC], DeactivateKeyboardFocus
- CMFCRibbonBar [MFC], DrawMenuImage
- CMFCRibbonBar [MFC], DWMCompositionChanged
- CMFCRibbonBar [MFC], EnableKeyTips
- CMFCRibbonBar [MFC], EnablePrintPreview
- CMFCRibbonBar [MFC], EnableToolTips
- CMFCRibbonBar [MFC], FindByData
- CMFCRibbonBar [MFC], FindByID
- CMFCRibbonBar [MFC], FindCategoryIndexByData
- CMFCRibbonBar [MFC], ForceRecalcLayout
- CMFCRibbonBar [MFC], GetActiveCategory
- CMFCRibbonBar [MFC], GetCaptionHeight
- CMFCRibbonBar [MFC], GetCategory
- CMFCRibbonBar [MFC], GetCategoryCount
- CMFCRibbonBar [MFC], GetCategoryHeight
- CMFCRibbonBar [MFC], GetCategoryIndex
- CMFCRibbonBar [MFC], GetContextName
- CMFCRibbonBar [MFC], GetDroppedDown
- CMFCRibbonBar [MFC], GetElementsByID
- CMFCRibbonBar [MFC], GetApplicationButton
- CMFCRibbonBar [MFC], GetFocused
- CMFCRibbonBar [MFC], GetHideFlags
- CMFCRibbonBar [MFC], GetItemIDsList
- CMFCRibbonBar [MFC], GetKeyboardNavigationLevel
- CMFCRibbonBar [MFC], GetKeyboardNavLevelCurrent
- CMFCRibbonBar [MFC], GetKeyboardNavLevelParent
- CMFCRibbonBar [MFC], GetMainCategory
- CMFCRibbonBar [MFC], GetQATCommandsLocation
- CMFCRibbonBar [MFC], GetQATDroppedDown
- CMFCRibbonBar [MFC], GetQuickAccessCommands
- CMFCRibbonBar [MFC], GetQuickAccessToolbarLocation
- CMFCRibbonBar [MFC], GetTabTrancateRatio
- CMFCRibbonBar [MFC], GetTooltipFixedWidthLargeImage
- CMFCRibbonBar [MFC], GetTooltipFixedWidthRegular
- CMFCRibbonBar [MFC], GetVisibleCategoryCount
- CMFCRibbonBar [MFC], HideAllContextCategories
- CMFCRibbonBar [MFC], HideKeyTips
- CMFCRibbonBar [MFC], HitTest
- CMFCRibbonBar [MFC], IsKeyTipEnabled
- CMFCRibbonBar [MFC], IsMainRibbonBar
- CMFCRibbonBar [MFC], IsPrintPreviewEnabled
- CMFCRibbonBar [MFC], IsQATEmpty
- CMFCRibbonBar [MFC], IsQuickAccessToolbarOnTop
- CMFCRibbonBar [MFC], IsReplaceFrameCaption
- CMFCRibbonBar [MFC], IsShowGroupBorder
- CMFCRibbonBar [MFC], IsToolTipDescrEnabled
- CMFCRibbonBar [MFC], IsToolTipEnabled
- CMFCRibbonBar [MFC], IsTransparentCaption
- CMFCRibbonBar [MFC], IsWindows7Look
- CMFCRibbonBar [MFC], LoadFromResource
- CMFCRibbonBar [MFC], OnClickButton
- CMFCRibbonBar [MFC], OnEditContextMenu
- CMFCRibbonBar [MFC], OnRTLChanged
- CMFCRibbonBar [MFC], OnSetAccData
- CMFCRibbonBar [MFC], OnShowRibbonContextMenu
- CMFCRibbonBar [MFC], OnShowRibbonQATMenu
- CMFCRibbonBar [MFC], OnSysKeyDown
- CMFCRibbonBar [MFC], OnSysKeyUp
- CMFCRibbonBar [MFC], PopTooltip
- CMFCRibbonBar [MFC], PreTranslateMessage
- CMFCRibbonBar [MFC], RecalcLayout
- CMFCRibbonBar [MFC], RemoveAllCategories
- CMFCRibbonBar [MFC], RemoveAllFromTabs
- CMFCRibbonBar [MFC], RemoveCategory
- CMFCRibbonBar [MFC], SaveToXMLBuffer
- CMFCRibbonBar [MFC], SaveToXMLFile
- CMFCRibbonBar [MFC], SetActiveCategory
- CMFCRibbonBar [MFC], SetActiveMDIChild
- CMFCRibbonBar [MFC], SetElementKeys
- CMFCRibbonBar [MFC], SetApplicationButton
- CMFCRibbonBar [MFC], SetKeyboardNavigationLevel
- CMFCRibbonBar [MFC], SetMaximizeMode
- CMFCRibbonBar [MFC], SetQuickAccessCommands
- CMFCRibbonBar [MFC], SetQuickAccessDefaultState
- CMFCRibbonBar [MFC], SetQuickAccessToolbarOnTop
- CMFCRibbonBar [MFC], SetTooltipFixedWidth
- CMFCRibbonBar [MFC], SetWindows7Look
- CMFCRibbonBar [MFC], ShowCategory
- CMFCRibbonBar [MFC], ShowContextCategories
- CMFCRibbonBar [MFC], ShowKeyTips
- CMFCRibbonBar [MFC], ToggleMimimizeState
- CMFCRibbonBar [MFC], TranslateChar
ms.assetid: a65d06fa-1a28-4cc0-8971-bc9d7c9198fe
ms.openlocfilehash: 51d7ad249d3f3a2556f461aea1a33dd7cbc787eb
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/22/2020
ms.locfileid: "81749750"
---
# <a name="cmfcribbonbar-class"></a>CMFC剪条类

`CMFCRibbonBar` 类实现与 Office 2007 中所使用的类似功能区栏。

有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCRibbonBar : public CPane
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|`CMFCRibbonBar::CMFCRibbonBar`|默认构造函数。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFCRibbonBar::ActivateContextCategory](#activatecontextcategory)|激活已经可见的上下文类别。|
|[CMFCRibbonBar::AddCategory](#addcategory)|向功能区添加新的功能区类别。|
|[CMFCRibbonBar::AddContextCategory](#addcontextcategory)|添加上下文类别。|
|[CMFCRibbonBar::AddMainCategory](#addmaincategory)|添加新的主功能区类别。|
|[CMFCRibbonBar::AddPrintPreviewCategory](#addprintpreviewcategory)||
|[CMFCRibbonBar::AddQATOnlyCategory](#addqatonlycategory)||
|[CMFCRibbonBar::AddToTabs](#addtotabs)|将功能区元素添加到功能区栏的右侧。|
|[CMFCRibbonBar::CreateEx](#createex)|创建控制栏并将其附加到[CPane](../../mfc/reference/cpane-class.md)对象。 （覆盖[CPane：createEx](../../mfc/reference/cpane-class.md#createex).）|
|[CMFCRibbonBar::Create](#create)|创建功能区栏控件并将其附加到功能区栏。|
|[CMFCRibbonBar::DeactivateKeyboardFocus](#deactivatekeyboardfocus)||
|[CMFCRibbonBar::DrawMenuImage](#drawmenuimage)||
|[CMFCRibbonBar::DWMCompositionChanged](#dwmcompositionchanged)||
|[CMFCRibbonBar::EnableKeyTips](#enablekeytips)|启用或禁用功能区控件的键提示。|
|[CMFCRibbonBar::EnablePrintPreview](#enableprintpreview)|启用 **"打印预览"** 选项卡。|
|[CMFCRibbonBar::EnableToolTips](#enabletooltips)|启用或禁用功能区栏的工具提示或工具提示说明。|
|[CMFCRibbonBar::FindByData](#findbydata)|使用用户指定的数据查找功能区元素。|
|[CMFCRibbonBar::FindByID](#findbyid)|查找具有指定命令 ID 的功能区元素。|
|[CMFCRibbonBar::FindCategoryIndexByData](#findcategoryindexbydata)|查找包含用户定义数据的功能区类别的索引。|
|[CMFCRibbonBar::ForceRecalcLayout](#forcerecalclayout)||
|[CMFC 功能栏：获取活动类别](#getactivecategory)|获取指向活动类别的指针。|
|[CMFC 功能栏：获取标题高度](#getcaptionheight)|返回标题高度。 （覆盖[CBasePane：：获取标题高度](../../mfc/reference/cbasepane-class.md#getcaptionheight).）|
|[CMFC 功能栏：获取类别](#getcategory)|获取指向位于指定索引处的类别的指针。|
|[CMFC 功能栏：获取类别计数](#getcategorycount)|获取功能区栏中功能区类别的数目。|
|[CMFC 功能栏：获取类别高度](#getcategoryheight)||
|[CMFC 功能栏：获取类别索引](#getcategoryindex)|返回功能区类别的索引。|
|[CMFCRibbonBar::GetContextName](#getcontextname)|检索通过使用 ID 指定的上下文类别标题的名称。|
|[CMFC 功能栏：获取向下](#getdroppeddown)||
|[CMFC 功能栏：获取元素 ByID](#getelementsbyid)|获取一个数组，该数组包含指向具有指定 ID 的所有功能区元素的指针。|
|[CMFC功能栏：获取应用按钮](#getapplicationbutton)|获取指向功能区按钮的指针。|
|[CMFC功能栏：获得重点](#getfocused)|返回焦点元素。|
|[CMFC 功能栏：获取隐藏标志](#gethideflags)||
|[CMFC功能栏：获取项目Ids列表](#getitemidslist)||
|[CMFCRibbonBar::GetKeyboardNavigationLevel](#getkeyboardnavigationlevel)||
|[CMFC 功能栏：获取键盘导航水平电流](#getkeyboardnavlevelcurrent)||
|[CMFC 功能栏：获取键盘导航级别父级](#getkeyboardnavlevelparent)||
|[CMFC 功能栏：获取主要类别](#getmaincategory)|返回指向当前选定功能区类别的指针。|
|[CMFC 功能栏：获取QAT命令位置](#getqatcommandslocation)||
|[CMFC 功能栏：获取丢弃](#getqatdroppeddown)||
|[CMFC 功能栏：获取快速访问命令](#getquickaccesscommands)|填充列表，该列表包含快速访问工具栏上显示的所有元素的命令 ID。|
|[CMFC 功能栏：获取快速访问工具栏位置](#getquickaccesstoolbarlocation)||
|[CMFC 功能栏：获取 Tabtran](#gettabtrancateratio)||
|[CMFC 功能栏：：获取工具提示固定宽度大图像](#gettooltipfixedwidthlargeimage)||
|[CMFC 功能栏：获取工具提示固定宽度常规](#gettooltipfixedwidthregular)||
|[CMFC 功能栏：获取可见类别计数](#getvisiblecategorycount)||
|[CMFCRibbonBar::HideAllContextCategories](#hideallcontextcategories)|隐藏所有活动的且可见的类别。|
|[CMFCRibbonBar::HideKeyTips](#hidekeytips)||
|[CMFCRibbonBar::HitTest](#hittest)|查找一个指针，该指针指向位于功能区栏客户端坐标中指定点的功能区元素。|
|[CMFCRibbonBar::IsKeyTipEnabled](#iskeytipenabled)|确定是否启用键提示。|
|[CMFCRibbonBar::IsMainRibbonBar](#ismainribbonbar)||
|[CMFCRibbonBar::IsPrintPreviewEnabled](#isprintpreviewenabled)|确定是否启用**了"打印预览"** 选项卡。|
|[CMFCRibbonBar::IsQATEmpty](#isqatempty)||
|[CMFCRibbonBar::IsQuickAccessToolbarOnTop](#isquickaccesstoolbarontop)|指定快速访问工具栏是否位于功能区栏上方。|
|[CMFCRibbonBar::IsReplaceFrameCaption](#isreplaceframecaption)|确定功能区栏是替换主框架标题还是添加到框架标题的下方。|
|[CMFCRibbonBar::IsShowGroupBorder](#isshowgroupborder)||
|[CMFCRibbonBar::IsToolTipDescrEnabled](#istooltipdescrenabled)|确定是否启用工具提示说明。|
|[CMFCRibbonBar::IsToolTipEnabled](#istooltipenabled)|确定是否禁用工具提示说明。|
|[CMFCRibbonBar::IsTransparentCaption](#istransparentcaption)||
|[CMFCRibbonBar::IsWindows7Look](#iswindows7look)|指示功能区是否具有 Windows 7 样式的外观（小型矩形应用程序按钮）。|
|[CMFCRibbonBar::LoadFromResource](#loadfromresource)|已重载。 从应用程序资源加载功能区栏。|
|[CMFCRibbonBar::OnClickButton](#onclickbutton)||
|[CMFCRibbonBar::OnEditContextMenu](#oneditcontextmenu)||
|[CMFCRibbonBar::OnRTLChanged](#onrtlchanged)|（重写 `CPane::OnRTLChanged`。）|
|[CMFCRibbonBar::OnSetAccData](#onsetaccdata)|（覆盖[CBasePane：onSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).）|
|[CMFCRibbonBar::OnShowRibbonContextMenu](#onshowribboncontextmenu)||
|[CMFCRibbonBar::OnShowRibbonQATMenu](#onshowribbonqatmenu)||
|[CMFCRibbonBar::OnSysKeyDown](#onsyskeydown)||
|[CMFCRibbonBar::OnSysKeyUp](#onsyskeyup)||
|[CMFCRibbonBar::PopTooltip](#poptooltip)||
|[CMFCRibbonBar::PreTranslateMessage](#pretranslatemessage)|（重写 `CBasePane::PreTranslateMessage`。）|
|[CMFCRibbonBar::RecalcLayout](#recalclayout)|（覆盖[CPane：Recalclayout](../../mfc/reference/cpane-class.md#recalclayout).）|
|[CMFCRibbonBar::RemoveAllCategories](#removeallcategories)|从功能区栏删除所有功能区类别。|
|[CMFCRibbonBar::RemoveAllFromTabs](#removeallfromtabs)|从选项卡区域删除所有功能区元素。|
|[CMFCRibbonBar::RemoveCategory](#removecategory)|删除位于指定索引处的功能区类别。|
|[CMFCRibbonBar::SaveToXMLBuffer](#savetoxmlbuffer)|将功能区栏保存到缓冲区。|
|[CMFCRibbonBar::SaveToXMLFile](#savetoxmlfile)|将功能区栏保存到 XML 文件。|
|[CMFCRibbonBar::SetActiveCategory](#setactivecategory)|将指定功能区类别设置为活动。|
|[CMFCRibbonBar::SetActiveMDIChild](#setactivemdichild)||
|[CMFCRibbonBar::SetElementKeys](#setelementkeys)|为具有指定命令 ID 的所有功能区元素设置指定键提示。|
|[CMFCRibbonBar::SetApplicationButton](#setapplicationbutton)|向功能区栏分配应用程序功能区按钮。|
|[CMFCRibbonBar::SetKeyboardNavigationLevel](#setkeyboardnavigationlevel)||
|[CMFCRibbonBar::SetMaximizeMode](#setmaximizemode)||
|[CMFCRibbonBar::SetQuickAccessCommands](#setquickaccesscommands)|向快速访问工具栏添加一个或多个功能区元素。|
|[CMFCRibbonBar::SetQuickAccessDefaultState](#setquickaccessdefaultstate)|指定快速访问工具栏的默认状态。|
|[CMFCRibbonBar::SetQuickAccessToolbarOnTop](#setquickaccesstoolbarontop)|将快速访问工具栏 (QAT) 定位在功能区栏上方或下方。|
|[CMFCRibbonBar::SetTooltipFixedWidth](#settooltipfixedwidth)||
|[CMFCRibbonBar::SetWindows7Look](#setwindows7look)|启用/禁用功能区的 Windows 7 样式的外观（小型矩形应用程序按钮）|
|[CMFCRibbonBar::ShowCategory](#showcategory)|显示或隐藏指定的功能区类别。|
|[CMFCRibbonBar::ShowContextCategories](#showcontextcategories)|显示或隐藏具有指定 ID 的上下文类别。|
|[CMFCRibbonBar::ShowKeyTips](#showkeytips)||
|[CMFCRibbonBar::ToggleMimimizeState](#togglemimimizestate)|在最小化和最大化状态之间切换功能区栏。|
|[CMFCRibbonBar::TranslateChar](#translatechar)||

## <a name="remarks"></a>备注

Microsoft 在发布 Microsoft Office 2007 时同时引入了 Office Fluent 功能区。 该功能区栏不仅仅是一个新控件。 它代表了一个新的用户界面范例。 功能区是一个包含一组称为类别的选项卡的窗格。 各类别以逻辑方式拆分为不同的功能区面板，而各面板可包含各种控件和命令按钮。

功能区栏上显示的元素可进行缩放以实现可用空间的最佳利用。 例如，如果一个功能区面板具有足够的空间来显示其元素，它便成为一个菜单按钮，可在一个弹出菜单上显示子项。 功能区栏的行为方式与静态（非浮点）控件栏一样，并可以停靠在框架顶部。

你可以使用 `CMFCRibbonStatusBar` 类来实现一个类似于 Office 2007 中所用的状态栏。 功能区类别包含（并显示）一组[功能区面板](../../mfc/reference/cmfcribbonpanel-class.md)。 每个功能区面板包含一个或多个功能区元素，这些元素派生自[CMFC 功能区基元素](../../mfc/reference/cmfcribbonbaseelement-class.md)。

有关如何向现有 MFC 应用程序添加功能区栏的信息，请参阅[演练：更新 MFC 涂鸦应用程序](../../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md)。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCRibbonBar](../../mfc/reference/cmfcribbonbar-class.md)

## <a name="requirements"></a>要求

**标头：** afxribbonbar.h

## <a name="cmfcribbonbaractivatecontextcategory"></a><a name="activatecontextcategory"></a>CMFC 功能栏：激活上下文类别

激活已经可见的上下文类别。

```
BOOL ActivateContextCategory(UINT uiContextID);
```

### <a name="parameters"></a>参数

*uiContextID*<br/>
[在]上下文类别 ID。

### <a name="return-value"></a>返回值

如果找到并激活了具有*uiContextID*的上下文类别，则为 TRUE;否则 FALSE。

## <a name="cmfcribbonbaraddcategory"></a><a name="addcategory"></a>CMFC 功能栏：添加类别

为功能区栏创建和初始化新的功能区类别。

```
CMFCRibbonCategory* AddCategory(
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage= CSize(16,
    16),
    CSize sizeLargeImage= CSize(32,
    32),
    int nInsertAt = -1,
    CRuntimeClass* pRTI= NULL);
```

### <a name="parameters"></a>参数

*lpsz名称*<br/>
[在]功能区类别的名称。

*ui 小图像雷斯ID*<br/>
[在]功能区类别的小图像列表的资源 ID。

*uiLargeImagesResID*<br/>
[在]功能区类别的大图像列表的资源 ID。

*大小 小图像*<br/>
[在]指定功能区类别的小图像的大小。

*大小大图像*<br/>
[在]指定功能区类别的大图像大小。

*n 插入At*<br/>
[在]类别位置的基于零的索引。

*pRTI*<br/>
[在]指向[CMFC 功能区类别类](../../mfc/reference/cmfcribboncategory-class.md)运行时类的指针，以在运行时动态创建功能区类别。

### <a name="return-value"></a>返回值

如果方法成功，则指向新功能区类别的指针;否则，NULL。

### <a name="remarks"></a>备注

如果*pRTI*参数不是 NULL，则使用运行时类动态创建新功能区类别。

### <a name="example"></a>示例

下面的示例演示如何在`AddCategory``CMFCRibbonBar`类中使用 方法。

[!code-cpp[NVC_MFC_RibbonApp#5](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_1.cpp)]

## <a name="cmfcribbonbaraddcontextcategory"></a><a name="addcontextcategory"></a>CMFC 功能栏：添加上下文类别

为功能区栏创建和初始化新的上下文类别。

```
CMFCRibbonCategory* AddContextCategory(
    LPCTSTR lpszName,
    LPCTSTR lpszContextName,
    UINT uiContextID,
    AFX_RibbonCategoryColor clrContext,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage = CSize(16,
    16),
    CSize sizeLargeImage = CSize(32,
    32),
    CRuntimeClass* pRTI = NULL);
```

### <a name="parameters"></a>参数

*lpsz名称*<br/>
[在]类别的名称。

*lpszContext名称*<br/>
[在]上下文类别标题的名称。

*uiContextID*<br/>
[在]上下文 ID。

*clrContext*<br/>
[在]上下文类别标题的颜色。

*ui 小图像雷斯ID*<br/>
[在]上下文类别的小图像的资源 ID。

*uiLargeImagesResID*<br/>
[在]上下文类别的大图像的资源 ID。

*大小 小图像*<br/>
[在]小图像的大小。

*大小大图像*<br/>
[在]大图像的大小。

*pRTI*<br/>
[在]指向运行时类的指针。

### <a name="return-value"></a>返回值

指向新创建的类别的指针，如果`CreateObject`*pRTI*的方法无法创建指定的类别，则指向 NULL。

### <a name="remarks"></a>备注

使用此函数可以添加上下文类别。 上下文类别是一种特殊类型的类别，可在运行时显示或隐藏，具体取决于当前应用程序上下文。 例如，当用户选择对象时，可以显示具有上下文类别的特殊选项卡，用于更改特定选定对象。

上下文类别的颜色可以是以下值之一：

- AFX_CategoryColor_None

- AFX_CategoryColor_Red

- AFX_CategoryColor_Orange

- AFX_CategoryColor_Yellow

- AFX_CategoryColor_Green

- AFX_CategoryColor_Blue

- AFX_CategoryColor_Indigo

- AFX_CategoryColor_Violet

## <a name="cmfcribbonbaraddmaincategory"></a><a name="addmaincategory"></a>CMFC 功能栏：：添加主类别

为功能区栏创建新的主功能区类别。

```
CMFCRibbonMainPanel* AddMainCategory(
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    UINT uiLargeImagesResID,
    CSize sizeSmallImage = CSize(16,
    16),
    CSize sizeLargeImage = CSize(32,
    32));
```

### <a name="parameters"></a>参数

*lpsz名称*<br/>
[在]主功能区类别的名称。

*ui 小图像雷斯ID*<br/>
[在]小图像的资源 ID。

*uiLargeImagesResID*<br/>
[在]大型图像的资源 ID。

*大小 小图像*<br/>
[在]小图像的大小。

*大小大图像*<br/>
[在]大图像的大小。

### <a name="return-value"></a>返回值

如果方法成功，则指向新的主功能区类别;否则，NULL。

### <a name="remarks"></a>备注

如果主功能区类别已存在，则删除该类别。

### <a name="example"></a>示例

下面的示例演示如何在`AddMainCategory``CMFCRibbonBar`类中使用 方法。

[!code-cpp[NVC_MFC_RibbonApp#4](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_2.cpp)]

## <a name="cmfcribbonbaraddprintpreviewcategory"></a><a name="addprintpreviewcategory"></a>CMFC 功能栏：：添加打印预览类别

在功能区栏上创建打印预览类别。

```
CMFCRibbonCategory* AddPrintPreviewCategory();
```

### <a name="return-value"></a>返回值

如果方法成功，则指向新功能区类别的指针;否则，NULL。

### <a name="remarks"></a>备注

此方法创建功能区类别及其所需的控件，以便提供打印预览。

## <a name="cmfcribbonbaraddqatonlycategory"></a><a name="addqatonlycategory"></a>CMFC 功能栏：：仅添加QAT类别

创建快速访问工具栏功能区类别。

```
CMFCRibbonCategory* AddQATOnlyCategory(
    LPCTSTR lpszName,
    UINT uiSmallImagesResID,
    CSize sizeSmallImage = CSize(16,
    16));
```

### <a name="parameters"></a>参数

*lpsz名称*<br/>
[在]类别的名称。

*ui 小图像雷斯ID*<br/>
[在]类别的图像列表的资源 ID。

*大小 小图像*<br/>
[在]类别中功能区元素的图像大小。

### <a name="return-value"></a>返回值

如果方法成功，则指向新类别的指针;否则，NULL。

### <a name="remarks"></a>备注

快速访问工具栏功能区类别仅在快速访问工具栏自定义对话框中使用。

## <a name="cmfcribbonbaraddtotabs"></a><a name="addtotabs"></a>CMFC 功能栏：：添加标签

将指定的功能区元素添加到功能区栏的选项卡行。

```cpp
void AddToTabs(CMFCRibbonBaseElement* pElement);
```

### <a name="parameters"></a>参数

*p元素*<br/>
[在]指向功能区元素的指针。

### <a name="remarks"></a>备注

功能区元素位于任何系统按钮之前。

## <a name="cmfcribbonbarcmfcribbonbar"></a><a name="cmfcribbonbar"></a>CMFC剪条栏：CMFC剪条栏

构造并初始化[CMFCRibbonBar](../../mfc/reference/cmfcribbonbar-class.md)对象。

```
CMFCRibbonBar(BOOL bReplaceFrameCaption = TRUE);
```

### <a name="parameters"></a>参数

*b 替换框架标题*<br/>
[在]TRUE，用于替换主框架窗口的标题的功能区栏;FALSE 以在主框架窗口的标题下定位功能区栏。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarcreate"></a><a name="create"></a>CMFC 功能栏：创建

为功能区栏创建一个窗口。

```
BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,
    UINT nID = AFX_IDW_RIBBON_BAR);
```

### <a name="parameters"></a>参数

*pparentwnd*<br/>
[在]指向功能区栏的父窗口。

*dwStyle*<br/>
[在]新窗口样式的逻辑组合。

*nID*<br/>
[在]新窗口的 ID。

### <a name="return-value"></a>返回值

如果创建了窗口，则为 TRUE;如果创建了窗口，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

### <a name="example"></a>示例

下面的示例演示如何使用`Create``CMFCRibbonBar`类的方法。

[!code-cpp[NVC_MFC_RibbonApp#1](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_3.cpp)]

## <a name="cmfcribbonbarcreateex"></a><a name="createex"></a>CMFC 功能栏：创建Ex

为功能区栏创建一个窗口。

```
BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle = 0,
    DWORD dwStyle = WS_CHILD | WS_VISIBLE | CBRS_TOP,
    UINT nID = AFX_IDW_RIBBON_BAR);
```

### <a name="parameters"></a>参数

*pparentwnd*<br/>
[在]指向功能区栏的父窗口。

*dwCtrl风格*<br/>
[在]不使用此参数。

*dwStyle*<br/>
[在]新窗口样式的逻辑组合。

*nID*<br/>
[在]新窗口的 ID。

### <a name="return-value"></a>返回值

如果创建了窗口，则为 TRUE;如果创建了窗口，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbardeactivatekeyboardfocus"></a><a name="deactivatekeyboardfocus"></a>CMFC功能栏：:D激活键盘焦点

关闭功能区栏上的所有键尖控件。

```cpp
void DeactivateKeyboardFocus(BOOL bSetFocus = TRUE);
```

### <a name="parameters"></a>参数

*bSetFocus*<br/>
[在]TRUE 将焦点设置为功能区栏的父窗口。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbardrawmenuimage"></a><a name="drawmenuimage"></a>CMFC功能栏：:D原始菜单图像

绘制菜单按钮的图像。

```
BOOL DrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuItem,
    const CRect& rectImage);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向菜单按钮的设备上下文。

*pMenu项目*<br/>
[在]指向工具栏菜单按钮的指针。

*rectImage*<br/>
[在]菜单按钮的显示矩形。

### <a name="return-value"></a>返回值

如果绘制了图像，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbardwmcompositionchanged"></a><a name="dwmcompositionchanged"></a>CMFC 功能栏：:DWM 组合已更改

启用或禁用桌面窗口管理器 （DWM） 合成时调整功能区栏的显示。

```
virtual void DWMCompositionChanged();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarenablekeytips"></a><a name="enablekeytips"></a>CMFC 功能栏：：启用关键提示

启用或禁用功能区栏的键尖功能。

```cpp
void EnableKeyTips(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 启用关键提示功能;FALSE 以禁用钥匙提示功能。

### <a name="remarks"></a>备注

启用此功能时，当用户按下 ALT 或 F10 按钮时，将显示关键提示。 当用户按下 ALT 键时，键提示将显示 200 毫秒的延迟。 此延迟允许执行快捷方式，以便按下的 ALT 键不会干扰包括 ALT 键的其他组合。

## <a name="cmfcribbonbarenableprintpreview"></a><a name="enableprintpreview"></a>CMFC 功能栏：：启用打印预览

启用或禁用**打印预览**功能。

```cpp
void EnablePrintPreview(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 以启用**打印预览**功能;FALSE 以禁用**打印预览**功能。

### <a name="remarks"></a>备注

如果*bEnable*是 FALSE，并且存在打印预览类别，则删除它。

默认情况下，**启用了"打印预览"** 功能。

## <a name="cmfcribbonbarenabletooltips"></a><a name="enabletooltips"></a>CMFC 功能栏：启用工具提示

启用或禁用功能区栏上的工具提示和可选工具提示说明。

```cpp
void EnableToolTips(
    BOOL bEnable = TRUE,
    BOOL bEnableDescr = TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 在功能区栏上启用工具提示;FALSE 禁用功能区栏上的工具提示。

*bEnableDescr*<br/>
[在]TRUE 启用工具提示上的工具提示说明;FALSE 禁用工具提示上的工具提示说明。

### <a name="remarks"></a>备注

*bEnable*参数确定当鼠标悬停在功能区元素上时是否显示工具提示。 *bEnableDescr*参数确定工具提示文本是否显示其他描述性文本。

## <a name="cmfcribbonbarfindbydata"></a><a name="findbydata"></a>CMFC 功能栏：查找数据

如果功能区元素具有指定的数据和可见性，则检索指向功能区元素的指针。

```
CMFCRibbonBaseElement* FindByData(
    DWORD_PTR dwData,
    BOOL bVisibleOnly = TRUE) const;
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]与功能区元素关联的数据。

*仅可见*<br/>
[在]仅搜索可见功能区元素的 TRUE;FALSE 以搜索所有功能区元素。

### <a name="return-value"></a>返回值

如果功能区元素具有指定的数据和可见性，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

功能区元素是可以添加到功能区的任何控件，例如功能区按钮、功能区类别或功能区滑块。

## <a name="cmfcribbonbarfindbyid"></a><a name="findbyid"></a>CMFC 功能栏：查找ByID

检索指向具有指定命令 ID 和搜索值的功能区元素的指针。

```
CMFCRibbonBaseElement* FindByID(
    UINT uiCmdID,
    BOOL bVisibleOnly = TRUE,
    BOOL bExcludeQAT = FALSE) const;
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

*仅可见*<br/>
[在]仅搜索可见功能区元素的 TRUE;FALSE 以搜索所有功能区元素。

*b 排除QAT*<br/>
[在]TRUE 从搜索中排除快速访问工具栏元素;否则，FALSE。

### <a name="return-value"></a>返回值

指向功能区元素的指针（如果具有指定的命令 ID 和搜索值）;否则，NULL。

### <a name="remarks"></a>备注

功能区元素是可添加到功能区的任何功能区控件，如功能区按钮、功能区类别或功能区滑块。

通常，可以有多个功能区元素具有相同的命令 ID。 如果要获取指向使用指定命令 ID 的所有功能区元素的指针，请使用[CMFCRibbonBar：：GetElementsByID](#getelementsbyid)方法。

## <a name="cmfcribbonbarfindcategoryindexbydata"></a><a name="findcategoryindexbydata"></a>CMFC 功能栏：查找类别索引数据

检索包含指定数据的功能区类别的索引。

```
int FindCategoryIndexByData(DWORD dwData) const;
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]与功能区类别关联的数据。

### <a name="return-value"></a>返回值

如果方法成功，则功能区类别的零基索引;否则 -1。

## <a name="cmfcribbonbarforcerecalclayout"></a><a name="forcerecalclayout"></a>CMFC 功能栏：强制重钙布局

调整功能区栏和父窗口中所有项的布局，然后重绘整个窗口。

```cpp
void ForceRecalcLayout();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargetactivecategory"></a><a name="getactivecategory"></a>CMFC 功能栏：获取活动类别

检索指向活动功能区类别的指针。

```
CMFCRibbonCategory* GetActiveCategory() const;
```

### <a name="return-value"></a>返回值

指向活动功能区类别的指针;指向活动功能区类别的指针。或 NULL，如果没有类别处于活动状态。

### <a name="remarks"></a>备注

如果类别具有焦点，则该类别处于活动状态。 默认情况下，活动类别是功能区栏左侧的第一个类别。

当用户按下应用程序按钮时，将显示主类别，它不能是活动类别。

## <a name="cmfcribbonbargetapplicationbutton"></a><a name="getapplicationbutton"></a>CMFC功能栏：获取应用按钮

检索指向应用程序按钮的指针。

```
CMFCRibbonApplicationButton* GetApplicationButton() const;
```

### <a name="return-value"></a>返回值

指向应用程序按钮的指针;或 NULL，如果按钮尚未设置。

## <a name="cmfcribbonbargetcaptionheight"></a><a name="getcaptionheight"></a>CMFC 功能栏：获取标题高度

检索功能区栏的标题区域的高度。

```
int GetCaptionHeight() const;
```

### <a name="return-value"></a>返回值

功能区栏的标题区域的高度（以像素为单位）。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargetcategory"></a><a name="getcategory"></a>CMFC 功能栏：获取类别

检索指向指定索引处的功能区类别的指针。

```
CMFCRibbonCategory* GetCategory(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]功能区栏中包含的功能区类别列表中的功能区类别的零基索引。

### <a name="return-value"></a>返回值

指向指定索引处的功能区类别的指针;否则，如果*nIndex*不在范围内，则 NULL。

## <a name="cmfcribbonbargetcategorycount"></a><a name="getcategorycount"></a>CMFC 功能栏：获取类别计数

检索功能区栏中的功能区类别数。

```
int GetCategoryCount() const;
```

### <a name="return-value"></a>返回值

功能区栏中的功能区类别数。

## <a name="cmfcribbonbargetcategoryheight"></a><a name="getcategoryheight"></a>CMFC 功能栏：获取类别高度

检索类别的高度。

```
int GetCategoryHeight() const;
```

### <a name="return-value"></a>返回值

类别的高度。

### <a name="remarks"></a>备注

类别高度包括类别选项卡的高度。

## <a name="cmfcribbonbargetcategoryindex"></a><a name="getcategoryindex"></a>CMFC 功能栏：获取类别索引

检索指定功能区类别的索引。

```
int GetCategoryIndex(CMFCRibbonCategory* pCategory) const;
```

### <a name="parameters"></a>参数

*p 类别*<br/>
[在]指向功能区类别的指针。

### <a name="return-value"></a>返回值

pCategory 指定的功能区类别的零基索引*pCategory*;或 -1，如果未找到功能区类别。

## <a name="cmfcribbonbargetcontextname"></a><a name="getcontextname"></a>CMFC 功能栏：获取上下文名称

检索上下文 ID 指定的上下文类别标题的名称。

```
BOOL GetContextName(
    UINT uiContextID,
    CString& strName) const;
```

### <a name="parameters"></a>参数

*uiContextID*<br/>
[在]功能区类别上下文 ID。

*strName*<br/>
[出]上下文类别标题的名称。

### <a name="return-value"></a>返回值

如果方法成功，则为 TRUE;否则，如果*uiContextID*为零或未找到上下文类别标题，则 FALSE。

## <a name="cmfcribbonbargetdroppeddown"></a><a name="getdroppeddown"></a>CMFC 功能栏：获取向下

检索当前向下丢弃的功能区元素。

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>返回值

当前下落的功能区元素;或 NULL，如果当前没有功能区元素下拉。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargetelementsbyid"></a><a name="getelementsbyid"></a>CMFC 功能栏：获取元素 ByID

检索指向具有特定命令 ID 的所有功能区元素的指针数组。

```cpp
void GetElementsByID(
    UINT uiCmdID,
    CArray<CMFCRibbonBaseElement*,CMFCRibbonBaseElement*>& arButtons);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

*arButtons*<br/>
[出]指向功能区元素的指针数组。

### <a name="remarks"></a>备注

多个功能区元素可以具有相同的命令 ID，因为某些功能区元素可以复制到快速访问工具栏。

## <a name="cmfcribbonbargethideflags"></a><a name="gethideflags"></a>CMFC 功能栏：获取隐藏标志

检索指示功能区条可见量的标志。

```
DWORD GetHideFlags() const;
```

### <a name="return-value"></a>返回值

指示功能区条可见的数量的标志。

### <a name="remarks"></a>备注

下表列出了返回值的标志的可能组合：

|||
|-|-|
|AFX_RIBBONBAR_HIDE_ELEMENTS|功能区栏垂直最小化，只有类别选项卡、主按钮和快速访问工具栏可见。  |
|AFX_RIBBONBAR_HIDE_ALL|功能区条的宽度小于最小宽度，完全隐藏。  |

## <a name="cmfcribbonbargetitemidslist"></a><a name="getitemidslist"></a>CMFC功能栏：获取项目Ids列表

检索功能区栏上指定功能区元素集合的命令指示。

```cpp
void GetItemIDsList(CList<UINT, UINT>& lstItems,
    BOOL bHiddenOnly = FALSE) const;
```

### <a name="parameters"></a>参数

*lstItem*<br/>
[出]功能区栏中包含的功能区元素的命令指示指示列表。

*仅隐藏*<br/>
[在]TRUE 以排除显示的功能区元素;FALSE 以在功能区栏中包含所有功能区元素。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargetkeyboardnavigationlevel"></a><a name="getkeyboardnavigationlevel"></a>CMFC功能栏：获取键盘导航级别

当用户按下功能区栏中包含的键提示时，检索当前导航级别。

```
int GetKeyboardNavigationLevel() const;
```

### <a name="return-value"></a>返回值

当用户按下功能区栏中包含的键提示时，当前导航级别。 下表列出了可能的返回值：

|||
|-|-|
|-1|不显示关键提示。|
|0|将显示关键提示。|
|1|用户已按下显示的键尖。|

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargetkeyboardnavlevelcurrent"></a><a name="getkeyboardnavlevelcurrent"></a>CMFC 功能栏：获取键盘导航水平电流

检索功能区栏上的当前键盘导航对象。

```
CObject* GetKeyboardNavLevelCurrent() const;
```

### <a name="return-value"></a>返回值

功能区栏上的当前键盘导航对象;否则 NULL，如果当前没有对象显示键尖。

### <a name="remarks"></a>备注

当前显示键提示的对象是当前键盘导航对象。

## <a name="cmfcribbonbargetkeyboardnavlevelparent"></a><a name="getkeyboardnavlevelparent"></a>CMFC 功能栏：获取键盘导航级别父级

检索功能区栏上的父键盘导航对象。

```
CObject* GetKeyboardNavLevelParent() const;
```

### <a name="return-value"></a>返回值

功能区栏上的父键盘导航对象;否则 NULL。

### <a name="remarks"></a>备注

当用户按功能区栏上的键尖时，当前键盘导航对象将成为父键盘导航对象。

## <a name="cmfcribbonbargetmaincategory"></a><a name="getmaincategory"></a>CMFC 功能栏：获取主要类别

检索指向主功能区类别的指针。

```
CMFCRibbonCategory* GetMainCategory() const;
```

### <a name="return-value"></a>返回值

指向主功能区类别的指针。

### <a name="remarks"></a>备注

主功能区类别包含主功能区面板。

## <a name="cmfcribbonbargetqatcommandslocation"></a><a name="getqatcommandslocation"></a>CMFC 功能栏：获取QAT命令位置

检索快速访问工具栏的命令部分的显示矩形。

```
CRect GetQATCommandsLocation() const;
```

### <a name="return-value"></a>返回值

快速访问工具栏的命令部分的显示矩形。

### <a name="remarks"></a>备注

显示矩形的命令部分不包括自定义按钮。

## <a name="cmfcribbonbargetqatdroppeddown"></a><a name="getqatdroppeddown"></a>CMFC 功能栏：获取丢弃

检索指向快速访问工具栏上的功能区元素的指针，该工具栏的弹出式菜单已下拉。

```
CMFCRibbonBaseElement* GetQATDroppedDown();
```

### <a name="return-value"></a>返回值

指向快速访问工具栏上的功能区元素的指针，该工具栏的弹出式菜单已下拉。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargetquickaccesscommands"></a><a name="getquickaccesscommands"></a>CMFC 功能栏：获取快速访问命令

检索快速访问工具栏上功能区元素的命令指示指示列表。

```cpp
void GetQuickAccessCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>参数

*lstCommands*<br/>
[出]快速访问工具栏上功能区元素的命令指示指示列表。

### <a name="remarks"></a>备注

该列表不包含控件分隔符的功能区元素。

## <a name="cmfcribbonbargetquickaccesstoolbarlocation"></a><a name="getquickaccesstoolbarlocation"></a>CMFC 功能栏：获取快速访问工具栏位置

检索快速访问工具栏的显示矩形。

```
CRect GetQuickAccessToolbarLocation() const;
```

### <a name="return-value"></a>返回值

快速访问工具栏的显示矩形。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbargettabtrancateratio"></a><a name="gettabtrancateratio"></a>CMFC 功能栏：获取 Tabtran

检索类别选项卡的显示宽度中减小的百分比。

```
int GetTabTrancateRatio() const;
```

### <a name="return-value"></a>返回值

类别选项卡的显示宽度中减小的百分比。

### <a name="remarks"></a>备注

当功能区栏上的宽度不足时，类别选项卡的宽度会减小。

## <a name="cmfcribbonbargettooltipfixedwidthlargeimage"></a><a name="gettooltipfixedwidthlargeimage"></a>CMFC 功能栏：：获取工具提示固定宽度大图像

检索功能区条的工具提示宽度的较大大小。

```
int GetTooltipFixedWidthLargeImage() const;
```

### <a name="return-value"></a>返回值

工具提示宽度的大小时（以像素为单位）。

### <a name="remarks"></a>备注

如果工具提示宽度的大尺寸为 0，则宽度会有所不同。

## <a name="cmfcribbonbargettooltipfixedwidthregular"></a><a name="gettooltipfixedwidthregular"></a>CMFC 功能栏：获取工具提示固定宽度常规

检索功能区条的工具提示宽度的常规大小。

```
int GetTooltipFixedWidthRegular() const;
```

### <a name="return-value"></a>返回值

工具提示宽度（以像素为单位）的常规大小。

### <a name="remarks"></a>备注

如果工具提示宽度的常规大小为 0，则宽度会有所不同。

## <a name="cmfcribbonbargetvisiblecategorycount"></a><a name="getvisiblecategorycount"></a>CMFC 功能栏：获取可见类别计数

检索功能区栏上的可见类别数。

```
int GetVisibleCategoryCount() const;
```

### <a name="return-value"></a>返回值

功能区栏上的可见类别数。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarhideallcontextcategories"></a><a name="hideallcontextcategories"></a>CMFC 功能栏：隐藏所有上下文类别

隐藏功能区栏上的所有上下文类别。

```
BOOL HideAllContextCategories();
```

### <a name="return-value"></a>返回值

如果至少隐藏了一个上下文类别，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

如果上下文类别处于活动状态，则活动类别将重置为类别列表中的第一个可见类别。

## <a name="cmfcribbonbarhidekeytips"></a><a name="hidekeytips"></a>CMFC 剪贴栏：隐藏关键提示

隐藏功能区栏上的所有关键提示。

```cpp
void HideKeyTips();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarhittest"></a><a name="hittest"></a>CMFC功能栏：HitTest

检索指向点位置指定的功能区元素的指针。

```
virtual CMFCRibbonBaseElement* HitTest(
    CPoint point,
    BOOL bCheckActiveCategory= FALSE,
    BOOL bCheckPanelCaption= FALSE);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]带色带条坐标中点的位置。

*b 检查活动类别*<br/>
[在]TRUE 以搜索活动类别;FALSE 不搜索活动类别。

*b检查面板标题*<br/>
[在]TRUE 以测试带功能区面板的标题，其中的点位于其中;FALSE 不要使用其中的点测试功能区面板的标题。 有关详细信息，请参阅“备注”部分。

### <a name="return-value"></a>返回值

指向指定点的功能区元素的指针;否则 NULL，如果点不位于功能区元素中。

### <a name="remarks"></a>备注

除非*bCheckActiveCategory 参数*为 TRUE，否则不会测试包含其点的功能区面板的标题。

## <a name="cmfcribbonbariskeytipenabled"></a><a name="iskeytipenabled"></a>CMFC 功能栏：即启用密钥提示

指示是否启用了关键提示功能。

```
BOOL IsKeyTipEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用了钥匙提示功能，则为 TRUE;否则 FALSE。

## <a name="cmfcribbonbarismainribbonbar"></a><a name="ismainribbonbar"></a>CMFC功能栏：是主带栏

指示功能区条是否是主功能区栏。

```
virtual BOOL IsMainRibbonBar() const;
```

### <a name="return-value"></a>返回值

始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 TRUE。 重写此方法以指示功能区条是否是主功能区栏。

## <a name="cmfcribbonbarisprintpreviewenabled"></a><a name="isprintpreviewenabled"></a>CMFC 功能栏：已启用打印预览

指示是否启用**了"打印预览"** 功能。

```
BOOL IsPrintPreviewEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用了 **"打印预览"** 功能，则为 TRUE;如果启用了"打印预览"功能，则为 TRUE。否则 FALSE。

## <a name="cmfcribbonbarisqatempty"></a><a name="isqatempty"></a>CMFC 功能栏：IsQAT空

指示快速访问工具栏是否包含命令按钮。

```
BOOL IsQATEmpty() const;
```

### <a name="return-value"></a>返回值

如果快速访问工具栏包含命令按钮，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarisquickaccesstoolbarontop"></a><a name="isquickaccesstoolbarontop"></a>CMFC 功能栏：：是快速访问工具栏顶部

指示快速访问工具栏位于功能区栏的上还是下方。

```
BOOL IsQuickAccessToolbarOnTop() const;
```

### <a name="return-value"></a>返回值

如果快速访问工具栏位于功能区栏上，则为 TRUE;如果快速访问工具栏位于功能区栏上，则为 TRUE。如果快速访问工具栏位于功能区栏下方，则 FALSE。

## <a name="cmfcribbonbarisreplaceframecaption"></a><a name="isreplaceframecaption"></a>CMFC 功能栏：：正在替换框架标题

指示功能区条是替换还是位于主框架窗口的标题下。

```
BOOL IsReplaceFrameCaption() const;
```

### <a name="return-value"></a>返回值

如果功能区栏替换了主框架窗口的标题，则为 TRUE;如果功能区栏替换了主框架窗口的标题，则为 TRUE。如果功能区栏位于主框架窗口的标题下，则 FALSE。

## <a name="cmfcribbonbarisshowgroupborder"></a><a name="isshowgroupborder"></a>CMFC 功能栏：：IsShowGroup 边框

指示位于功能区栏上的按钮组是否显示组边框。

```
virtual BOOL IsShowGroupBorder(CMFCRibbonButtonsGroup* pGroup) const;
```

### <a name="parameters"></a>参数

*p组*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法始终返回 FALSE。 重写此方法以指示位于功能区栏上的按钮组是否显示组边框。

## <a name="cmfcribbonbaristooltipdescrenabled"></a><a name="istooltipdescrenabled"></a>CMFC 功能栏：已启用"小工具提示"功能

指示是否启用了工具提示说明。

```
BOOL IsToolTipDescrEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用了工具提示说明，则为 TRUE;如果禁用工具提示说明，则 FALSE。

### <a name="remarks"></a>备注

工具提示说明是工具提示文本中显示的其他描述性文本。

## <a name="cmfcribbonbaristooltipenabled"></a><a name="istooltipenabled"></a>CMFC 功能栏：启用"功能提示"

指示功能区栏是启用还是禁用工具提示。

```
BOOL IsToolTipEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用了工具提示，则为 TRUE;如果禁用工具提示，则 FALSE。

## <a name="cmfcribbonbaristransparentcaption"></a><a name="istransparentcaption"></a>CMFC 功能栏：：透明标题

指示是否为 Windows Aero 配色方案设置了显示。

```
BOOL IsTransparentCaption() const;
```

### <a name="return-value"></a>返回值

如果配色方案为 Windows Aero，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaronclickbutton"></a><a name="onclickbutton"></a>CMFC 功能栏：单击按钮

此方法保留用于与现有应用程序的向后兼容性，不应用于新开发。

```
virtual void OnClickButton(
    CMFCRibbonButton* pButton,
    CPoint point);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向单击的按钮的指针。

*点*<br/>
[在]不使用此参数。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaroneditcontextmenu"></a><a name="oneditcontextmenu"></a>CMFC 功能栏：：在编辑上下文菜单

```
virtual void OnEditContextMenu(
    CMFCRibbonRichEditCtrl* pEdit,
    CPoint point);
```

### <a name="parameters"></a>参数

[在]*pEdit*<br/>
[在]*点*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaronrtlchanged"></a><a name="onrtlchanged"></a>CMFC 剪条：在RTL改变

当布局更改方向时由框架调用。

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>参数

*比塞尔*<br/>
[在]如果布局从右到左，则为 TRUE;如果布局从右到左，则为 TRUE。如果布局从左到右，则 FALSE。

### <a name="remarks"></a>备注

此方法调整功能区栏上所有控件的布局，以用于新的布局方向。

## <a name="cmfcribbonbaronsetaccdata"></a><a name="onsetaccdata"></a>CMFC 功能栏：OnSetAccData

此方法是 Framework 的内部方法，不可从用户代码中调用。

```
BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>参数

长*lVal*可访问对象的索引。

### <a name="return-value"></a>返回值

如果成功则为 S_OK；否则为 FALSE 或 S_FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaronshowribboncontextmenu"></a><a name="onshowribboncontextmenu"></a>CMFC 功能栏：：在显示功能上下文菜单

```
virtual BOOL OnShowRibbonContextMenu(
    CWnd* pWnd,
    int x,
    int y,
    CMFCRibbonBaseElement* pHit);
```

### <a name="parameters"></a>参数

[在]*pwnd*<br/>
[在]*x*<br/>
[在]*y*<br/>
[在]*pHit*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaronshowribbonqatmenu"></a><a name="onshowribbonqatmenu"></a>CMFC功能栏：上秀卡塔梅

```
virtual BOOL OnShowRibbonQATMenu(
    CWnd* pWnd,
    int x,
    int y,
    CMFCRibbonBaseElement* pHit);
```

### <a name="parameters"></a>参数

[在]*pwnd*<br/>
[在]*x*<br/>
[在]*y*<br/>
[在]*pHit*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaronsyskeydown"></a><a name="onsyskeydown"></a>CMFC功能栏：onsysKeyDown

当用户按下 F10 键或按下 ALT 键，然后按下另一个键时，由框架调用。

```
BOOL OnSysKeyDown(
    CFrameWnd* pFrameWnd,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>参数

*pFramewnd*<br/>
[在]指向功能区栏的父主框架窗口。

*wParam*<br/>
[在]正在按下的密钥的虚拟密钥代码。

*lParam*<br/>
[在]按下键时键盘状态标志。

### <a name="return-value"></a>返回值

如果处理了击键事件，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbaronsyskeyup"></a><a name="onsyskeyup"></a>CMFC功能栏：onsysKeyup

当用户释放 F10 密钥、ALT 键或按住 ALT 键时按下的键时，由框架调用。

```
BOOL OnSysKeyUp(
    CFrameWnd* pFrameWnd,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>参数

*pFramewnd*<br/>
[在]指向功能区栏的父主框架窗口。

*wParam*<br/>
[在]要释放的密钥的虚拟密钥代码。

*lParam*<br/>
[在]不使用此参数。

### <a name="return-value"></a>返回值

如果处理了击键事件，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarpoptooltip"></a><a name="poptooltip"></a>CMFC功能栏：:PopTooltip

从视图中删除工具提示。

```cpp
void PopTooltip();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarpretranslatemessage"></a><a name="pretranslatemessage"></a>CMFC功能栏：:P重新翻译消息

确定指定的消息是否由功能区栏处理。

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>参数

*pMsg*<br/>
[在]指向消息的指针。

### <a name="return-value"></a>返回值

如果消息由功能区栏处理，则为 TRUE;如果消息由功能区栏处理，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarrecalclayout"></a><a name="recalclayout"></a>CMFC 功能栏：Recalclayout

调整功能区栏上所有控件的布局。

```
virtual void RecalcLayout();
```

### <a name="remarks"></a>备注

布局调整后，功能区栏的显示将更新。

## <a name="cmfcribbonbarremoveallcategories"></a><a name="removeallcategories"></a>CMFC 功能栏：删除所有类别

从功能区栏中删除所有功能区类别。

```cpp
void RemoveAllCategories();
```

### <a name="remarks"></a>备注

此方法从内存和类别列表中删除所有功能区类别。

## <a name="cmfcribbonbarremoveallfromtabs"></a><a name="removeallfromtabs"></a>CMFC 功能栏：删除所有从标签

从选项卡区域删除所有功能区元素。

```cpp
void RemoveAllFromTabs();
```

### <a name="remarks"></a>备注

如果要使用[CMFCRibbonBar：：addToTabs](#addtotabs)方法删除添加到选项卡区域的所有元素，请使用此功能。

## <a name="cmfcribbonbarremovecategory"></a><a name="removecategory"></a>CMFC 功能栏：删除类别

从功能区栏中删除指定的功能区类别。

```
BOOL RemoveCategory(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]功能区栏中包含的功能区类别列表中的类别的零基索引。

### <a name="return-value"></a>返回值

如果删除了指定的功能区类别，则为 TRUE;如果已删除指定的功能区类别，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

指定的功能区类别将从内存和类别列表中删除。

## <a name="cmfcribbonbarsetactivecategory"></a><a name="setactivecategory"></a>CMFC 功能栏：设置活动类别

将指定的功能区类别设置为活动类别。

```
BOOL SetActiveCategory(
    CMFCRibbonCategory* pCategory,
    BOOL bForceRestore= FALSE);
```

### <a name="parameters"></a>参数

*p 类别*<br/>
[在]功能区栏中包含的功能区类别。

*bForce还原*<br/>
[在]如果功能区条最小化，则 TRUE 可最大化其如果功能区条最小化，则 FALSE 在弹出窗口中显示活动类别。

### <a name="return-value"></a>返回值

如果指定类别设置为活动类别，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

主功能区类别不能是活动类别。

如果未显示*pCategory*指定的类别，则无法将其设置为活动类别。

## <a name="cmfcribbonbarsetactivemdichild"></a><a name="setactivemdichild"></a>CMFC 功能栏：设置活动 MDI 子级

将属于多文档接口 （MDI） 子窗口的功能区栏上的系统按钮关联到指定的 MDI 子窗口。

```cpp
void SetActiveMDIChild(CWnd* pWnd);
```

### <a name="parameters"></a>参数

*pwnd*<br/>
[在]指向 MDI 子窗口的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarsetapplicationbutton"></a><a name="setapplicationbutton"></a>CMFC 功能栏：设置应用程序按钮

向功能区栏分配应用程序功能区按钮。

```cpp
void SetApplicationButton(
    CMFCRibbonApplicationButton* pButton,
    CSize sizeButton);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向应用程序功能区按钮的指针。

*大小按钮*<br/>
[在]应用程序功能区按钮的大小。

### <a name="remarks"></a>备注

应用程序功能区按钮是位于功能区控件左上角的大型圆角按钮。

### <a name="example"></a>示例

下面的示例演示如何在`SetApplicationButton``CMFCRibbonBar`类中使用 方法。

[!code-cpp[NVC_MFC_RibbonApp#3](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_4.cpp)]

## <a name="cmfcribbonbarsetelementkeys"></a><a name="setelementkeys"></a>CMFC 功能栏：设置元素键

设置具有指定命令 ID 的所有功能区元素的键提示。

```
BOOL SetElementKeys(
    UINT uiCmdID,
    LPCTSTR lpszKeys,
    LPCTSTR lpszMenuKeys= NULL);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

*lpszKeys*<br/>
[在]钥匙尖。

*lpszMenuKeys*<br/>
[在]菜单键提示。

### <a name="return-value"></a>返回值

如果至少设置了一个功能区元素的键尖，则为 TRUE;如果至少设置了一个功能区元素的键尖。否则 FALSE。

### <a name="remarks"></a>备注

可选菜单键提示适用于带功能区元素，带有一个拆分按钮，该按钮可打开弹出菜单。

## <a name="cmfcribbonbarsetkeyboardnavigationlevel"></a><a name="setkeyboardnavigationlevel"></a>CMFC 功能栏：设置键盘导航级别

在用户按下功能区栏中包含的键提示时设置键盘导航级别。

```cpp
void SetKeyboardNavigationLevel(
    CObject* pLevel,
    BOOL bSetFocus = TRUE);
```

### <a name="parameters"></a>参数

*p 级别*<br/>
[在]指向当前键盘导航对象的指针。

*bSetFocus*<br/>
[在]TRUE 将键盘焦点设置为功能区栏。

### <a name="remarks"></a>备注

当用户按下 ALT 或 F10 键时，功能区栏的键盘导航将启动。 用户通过按功能区栏上的键尖来选择下一个导航级别。 用户可以通过按转义键返回到以前的导航级别。

## <a name="cmfcribbonbarsetmaximizemode"></a><a name="setmaximizemode"></a>CMFC 功能栏：：设置最大化模式

当多文档接口 （MDI） 子窗口的窗口大小进入或离开最大化状态时，调整功能区栏。

```cpp
void SetMaximizeMode(
    BOOL bMax,
    CWnd* pWnd = NULL);
```

### <a name="parameters"></a>参数

*bMax*<br/>
[在]TRUE 显示在功能区栏上 MDI 子窗口的系统按钮;FALSE 从功能区栏中删除 MDI 子窗口的系统按钮。

*pwnd*<br/>
[在]指向功能区栏的主框架窗口。

### <a name="remarks"></a>备注

当最大化 MDI 子窗口时，功能区栏在选项卡行中显示 MDI 子窗口的系统按钮。

## <a name="cmfcribbonbarsetquickaccesscommands"></a><a name="setquickaccesscommands"></a>CMFC 功能栏：设置快速访问命令

向快速访问工具栏添加一个或多个功能区元素。

```cpp
void SetQuickAccessCommands(
    const CList<UINT,UINT>& lstCommands,
    BOOL bRecalcLayout=TRUE);
```

### <a name="parameters"></a>参数

*lstCommands*<br/>
[在]要放置在"快速访问"工具栏上的命令列表。

*bRecalcLayout*<br/>
[在]如果要在添加功能区元素后重新绘制功能区，则为 TRUE;否则。

### <a name="example"></a>示例

下面的示例演示如何在`SetQuickAccessCommands``CMFCRibbonBar`类中使用 方法。

[!code-cpp[NVC_MFC_RibbonApp#8](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_5.cpp)]

## <a name="cmfcribbonbarsetquickaccessdefaultstate"></a><a name="setquickaccessdefaultstate"></a>CMFC 功能栏：：设置快速访问默认状态

将快速访问工具栏设置为默认状态。

```cpp
void SetQuickAccessDefaultState(const CMFCRibbonQuickAccessToolBarDefaultState& state);
```

### <a name="parameters"></a>参数

State <br/>
[在]快速访问工具栏默认状态。

### <a name="remarks"></a>备注

快速访问工具栏状态包括命令列表及其可见性。

### <a name="example"></a>示例

下面的示例演示如何在`SetQuickAccessDefaultState``CMFCRibbonBar`类中使用 方法。

[!code-cpp[NVC_MFC_RibbonApp#9](../../mfc/reference/codesnippet/cpp/cmfcribbonbar-class_6.cpp)]

## <a name="cmfcribbonbarsetquickaccesstoolbarontop"></a><a name="setquickaccesstoolbarontop"></a>CMFC 功能栏：设置快速访问工具栏顶部

将快速访问工具栏定位在功能区栏上方或下方。

```cpp
void SetQuickAccessToolbarOnTop(BOOL bOnTop);
```

### <a name="parameters"></a>参数

*蓬托普*<br/>
[在]TRUE 将快速访问工具栏放置在功能区栏上方;FALSE 将快速访问工具栏放置在功能区栏下方。

## <a name="cmfcribbonbarsettooltipfixedwidth"></a><a name="settooltipfixedwidth"></a>CMFC 功能栏：：设置工具提示固定宽度

设置功能区栏的固定宽度的正尺寸和大尺寸工具提示固定宽度。

```cpp
void SetTooltipFixedWidth(
    int nWidthRegular,
    int nWidthLargeImage);
```

### <a name="parameters"></a>参数

*nWidth 常规*<br/>
[在]常规固定大小的工具尖的宽度（以像素为单位）。

*nWidth 大型图像*<br/>
[在]大型固定大小的工具提示的宽度（以像素为单位）。

### <a name="remarks"></a>备注

将参数设置为 0 会导致相应的宽度发生变化。

## <a name="cmfcribbonbarshowcategory"></a><a name="showcategory"></a>CMFC 功能栏：显示类别

显示或隐藏指定的功能区类别。

```cpp
void ShowCategory(
    int nIndex,
    BOOL bShow=TRUE);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]功能区类别的索引。

*b显示*<br/>
[在]如果为 TRUE，则显示功能区类别;如果为 TRUE，则显示功能区类别。否则，隐藏功能区类别。

## <a name="cmfcribbonbarshowcontextcategories"></a><a name="showcontextcategories"></a>CMFC 功能栏：显示上下文类别

显示或隐藏具有指定 ID 的上下文类别。

```cpp
void ShowContextCategories(
    UINT uiContextID,
    BOOL bShow=TRUE);
```

### <a name="parameters"></a>参数

*uiContextID*<br/>
[在]上下文类别 ID。

*b显示*<br/>
[在]如果为 TRUE，则显示具有指定 ID 的类别;如果为 TRUE，则显示具有指定 ID 的类别。否则，隐藏具有指定 ID 的类别。

## <a name="cmfcribbonbarshowkeytips"></a><a name="showkeytips"></a>CMFC剪贴栏：显示关键提示

在功能区栏上显示每个功能区元素的键提示。

```cpp
void ShowKeyTips();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbonbartogglemimimizestate"></a><a name="togglemimimizestate"></a>CMFC 功能栏：：切换米米米泽州

在最小化和最大化状态之间切换功能区栏。

```cpp
void ToggleMimimizeState();
```

### <a name="remarks"></a>备注

方法名称中的拼写错误为已知问题。

在最小化状态下，将隐藏功能区控件并只显示选项卡。 当用户单击选项卡时，功能区控件将显示为弹出窗口。 当用户单击或执行命令时，该窗口将关闭。

## <a name="cmfcribbonbartranslatechar"></a><a name="translatechar"></a>CMFC功能栏：翻译查尔

确定指定的击键字符代码是否由功能区栏处理。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>参数

*n查尔*<br/>
[在]用户击键字符代码。

### <a name="return-value"></a>返回值

如果字符代码由功能区栏处理，则为 TRUE;如果字符代码由功能区栏处理，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

关键提示功能使用户能够使用键盘导航功能区栏。

## <a name="cmfcribbonbargetfocused"></a><a name="getfocused"></a>CMFC功能栏：获得重点

返回焦点元素。

```
virtual CMFCRibbonBaseElement* GetFocused();
```

### <a name="return-value"></a>返回值

指向焦点元素或 NULL 的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbariswindows7look"></a><a name="iswindows7look"></a>CMFC 功能栏：：是 Windows7 查看

指示功能区是否具有 Windows 7 外观（小型矩形应用程序按钮）。

```
BOOL IsWindows7Look() const;
```

### <a name="return-value"></a>返回值

如果功能区具有 Windows 7 外观，则为 TRUE;如果功能区具有 Windows 7 外观，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarloadfromresource"></a><a name="loadfromresource"></a>CMFC 功能栏：从资源加载

已重载。 从应用程序资源加载功能区栏。

```
virtual BOOL LoadFromResource(
    UINT uiXMLResID,
    LPCTSTR lpszResType = RT_RIBBON,
    HINSTANCE hInstance = NULL);

virtual BOOL LoadFromResource(
    LPCTSTR lpszXMLResID,
    LPCTSTR lpszResType = RT_RIBBON,
    HINSTANCE hInstance = NULL);
```

### <a name="parameters"></a>参数

*uiXMLResID*<br/>
使用功能区栏信息指定 XML 字符串的资源 ID。

*lpszRes类型*<br/>
指定位于*uiXMLResID*的资源类型。

*hInstance*<br/>
处理其可执行文件包含资源的模块。 如果*hAA*为 NULL，则系统将从用于创建当前进程的模块中加载资源。

*lpszXMLResID*<br/>
使用功能区栏信息指定资源 ID（以字符串形式）。

### <a name="return-value"></a>返回值

如果负载成功，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarsavetoxmlbuffer"></a><a name="savetoxmlbuffer"></a>CMFC 功能栏：：保存到XML缓冲区

将功能区栏保存到缓冲区。

```
UINT SaveToXMLBuffer(LPBYTE* ppBuffer) const;
```

### <a name="parameters"></a>参数

*ppBuffer*<br/>
当此函数返回时 *，ppBuffer*指向此方法分配的缓冲区，并包含 XML 格式的功能区条信息。

### <a name="return-value"></a>返回值

若成功，则为 TRUE；否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarsavetoxmlfile"></a><a name="savetoxmlfile"></a>CMFC 功能栏：：保存到XML文件

将功能区栏保存到 XML 文件。

```
BOOL SaveToXMLFile(LPCTSTR lpszFilePath) const;
```

### <a name="parameters"></a>参数

*lpsz文件路径*<br/>
指定输出文件。

### <a name="return-value"></a>返回值

若成功，则为 TRUE；否则为 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonbarsetwindows7look"></a><a name="setwindows7look"></a>CMFC 功能栏：设置 Windows7 查看

启用或禁用功能区 Windows 7 外观（小型矩形应用程序按钮）。

```cpp
void SetWindows7Look(
    BOOL bWindows7Look,
    BOOL bRecalc = TRUE);
```

### <a name="parameters"></a>参数

*bWindows7 看*<br/>
TRUE 设置 Windows 7 外观;否则。

*bRecalc*<br/>
TRUE 重新计算功能区布局;否则。

### <a name="remarks"></a>备注

## <a name="see-also"></a>请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CPane Class](../../mfc/reference/cpane-class.md)<br/>
[CMFCRibbonCategory 类](../../mfc/reference/cmfcribboncategory-class.md)<br/>
[CMFCRibbonPanel 类](../../mfc/reference/cmfcribbonpanel-class.md)<br/>
[CMFCRibbonBaseElement 类](../../mfc/reference/cmfcribbonbaseelement-class.md)<br/>
[演练：更新 MFC 涂鸦应用程序](../../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md)
