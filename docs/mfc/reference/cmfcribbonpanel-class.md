---
title: CMFCRibbonPanel 类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonPanel
- AFXRIBBONPANEL/CMFCRibbonPanel
- AFXRIBBONPANEL/CMFCRibbonPanel::CMFCRibbonPanel
- AFXRIBBONPANEL/CMFCRibbonPanel::Add
- AFXRIBBONPANEL/CMFCRibbonPanel::AddSeparator
- AFXRIBBONPANEL/CMFCRibbonPanel::AddToolBar
- AFXRIBBONPANEL/CMFCRibbonPanel::FindByData
- AFXRIBBONPANEL/CMFCRibbonPanel::FindByID
- AFXRIBBONPANEL/CMFCRibbonPanel::GetCaptionHeight
- AFXRIBBONPANEL/CMFCRibbonPanel::GetCount
- AFXRIBBONPANEL/CMFCRibbonPanel::GetData
- AFXRIBBONPANEL/CMFCRibbonPanel::GetDefaultButton
- AFXRIBBONPANEL/CMFCRibbonPanel::GetDroppedDown
- AFXRIBBONPANEL/CMFCRibbonPanel::GetElement
- AFXRIBBONPANEL/CMFCRibbonPanel::GetElements
- AFXRIBBONPANEL/CMFCRibbonPanel::GetElementsByID
- AFXRIBBONPANEL/CMFCRibbonPanel::GetFocused
- AFXRIBBONPANEL/CMFCRibbonPanel::GetGalleryRect
- AFXRIBBONPANEL/CMFCRibbonPanel::GetHighlighted
- AFXRIBBONPANEL/CMFCRibbonPanel::GetIndex
- AFXRIBBONPANEL/CMFCRibbonPanel::GetItemIDsList
- AFXRIBBONPANEL/CMFCRibbonPanel::GetName
- AFXRIBBONPANEL/CMFCRibbonPanel::GetParentButton
- AFXRIBBONPANEL/CMFCRibbonPanel::GetParentCategory
- AFXRIBBONPANEL/CMFCRibbonPanel::GetParentMenuBar
- AFXRIBBONPANEL/CMFCRibbonPanel::GetPreferedMenuLocation
- AFXRIBBONPANEL/CMFCRibbonPanel::GetPressed
- AFXRIBBONPANEL/CMFCRibbonPanel::GetRect
- AFXRIBBONPANEL/CMFCRibbonPanel::GetVisibleElements
- AFXRIBBONPANEL/CMFCRibbonPanel::HasElement
- AFXRIBBONPANEL/CMFCRibbonPanel::HitTest
- AFXRIBBONPANEL/CMFCRibbonPanel::HitTestEx
- AFXRIBBONPANEL/CMFCRibbonPanel::Insert
- AFXRIBBONPANEL/CMFCRibbonPanel::InsertSeparator
- AFXRIBBONPANEL/CMFCRibbonPanel::IsCenterColumnVert
- AFXRIBBONPANEL/CMFCRibbonPanel::IsCollapsed
- AFXRIBBONPANEL/CMFCRibbonPanel::IsHighlighted
- AFXRIBBONPANEL/CMFCRibbonPanel::IsJustifyColumns
- AFXRIBBONPANEL/CMFCRibbonPanel::IsMainPanel
- AFXRIBBONPANEL/CMFCRibbonPanel::IsMenuMode
- AFXRIBBONPANEL/CMFCRibbonPanel::MakeGalleryItemVisible
- AFXRIBBONPANEL/CMFCRibbonPanel::OnKey
- AFXRIBBONPANEL/CMFCRibbonPanel::RecalcWidths
- AFXRIBBONPANEL/CMFCRibbonPanel::Remove
- AFXRIBBONPANEL/CMFCRibbonPanel::RemoveAll
- AFXRIBBONPANEL/CMFCRibbonPanel::Replace
- AFXRIBBONPANEL/CMFCRibbonPanel::ReplaceByID
- AFXRIBBONPANEL/CMFCRibbonPanel::SetCenterColumnVert
- AFXRIBBONPANEL/CMFCRibbonPanel::SetData
- AFXRIBBONPANEL/CMFCRibbonPanel::SetElementMenu
- AFXRIBBONPANEL/CMFCRibbonPanel::SetElementRTC
- AFXRIBBONPANEL/CMFCRibbonPanel::SetElementRTCByID
- AFXRIBBONPANEL/CMFCRibbonPanel::SetFocused
- AFXRIBBONPANEL/CMFCRibbonPanel::SetJustifyColumns
- AFXRIBBONPANEL/CMFCRibbonPanel::SetKeys
- AFXRIBBONPANEL/CMFCRibbonPanel::ShowPopup
helpviewer_keywords:
- CMFCRibbonPanel [MFC], CMFCRibbonPanel
- CMFCRibbonPanel [MFC], Add
- CMFCRibbonPanel [MFC], AddSeparator
- CMFCRibbonPanel [MFC], AddToolBar
- CMFCRibbonPanel [MFC], FindByData
- CMFCRibbonPanel [MFC], FindByID
- CMFCRibbonPanel [MFC], GetCaptionHeight
- CMFCRibbonPanel [MFC], GetCount
- CMFCRibbonPanel [MFC], GetData
- CMFCRibbonPanel [MFC], GetDefaultButton
- CMFCRibbonPanel [MFC], GetDroppedDown
- CMFCRibbonPanel [MFC], GetElement
- CMFCRibbonPanel [MFC], GetElements
- CMFCRibbonPanel [MFC], GetElementsByID
- CMFCRibbonPanel [MFC], GetFocused
- CMFCRibbonPanel [MFC], GetGalleryRect
- CMFCRibbonPanel [MFC], GetHighlighted
- CMFCRibbonPanel [MFC], GetIndex
- CMFCRibbonPanel [MFC], GetItemIDsList
- CMFCRibbonPanel [MFC], GetName
- CMFCRibbonPanel [MFC], GetParentButton
- CMFCRibbonPanel [MFC], GetParentCategory
- CMFCRibbonPanel [MFC], GetParentMenuBar
- CMFCRibbonPanel [MFC], GetPreferedMenuLocation
- CMFCRibbonPanel [MFC], GetPressed
- CMFCRibbonPanel [MFC], GetRect
- CMFCRibbonPanel [MFC], GetVisibleElements
- CMFCRibbonPanel [MFC], HasElement
- CMFCRibbonPanel [MFC], HitTest
- CMFCRibbonPanel [MFC], HitTestEx
- CMFCRibbonPanel [MFC], Insert
- CMFCRibbonPanel [MFC], InsertSeparator
- CMFCRibbonPanel [MFC], IsCenterColumnVert
- CMFCRibbonPanel [MFC], IsCollapsed
- CMFCRibbonPanel [MFC], IsHighlighted
- CMFCRibbonPanel [MFC], IsJustifyColumns
- CMFCRibbonPanel [MFC], IsMainPanel
- CMFCRibbonPanel [MFC], IsMenuMode
- CMFCRibbonPanel [MFC], MakeGalleryItemVisible
- CMFCRibbonPanel [MFC], OnKey
- CMFCRibbonPanel [MFC], RecalcWidths
- CMFCRibbonPanel [MFC], Remove
- CMFCRibbonPanel [MFC], RemoveAll
- CMFCRibbonPanel [MFC], Replace
- CMFCRibbonPanel [MFC], ReplaceByID
- CMFCRibbonPanel [MFC], SetCenterColumnVert
- CMFCRibbonPanel [MFC], SetData
- CMFCRibbonPanel [MFC], SetElementMenu
- CMFCRibbonPanel [MFC], SetElementRTC
- CMFCRibbonPanel [MFC], SetElementRTCByID
- CMFCRibbonPanel [MFC], SetFocused
- CMFCRibbonPanel [MFC], SetJustifyColumns
- CMFCRibbonPanel [MFC], SetKeys
- CMFCRibbonPanel [MFC], ShowPopup
ms.assetid: 51d70749-1140-4386-b103-f14082049ba6
ms.openlocfilehash: fa07132ace37074effb02802353fc82d3e338be0
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81368881"
---
# <a name="cmfcribbonpanel-class"></a>CMFCRibbonPanel 类

实现包含一组功能区元素的面板。 在绘制面板时，系统将根据面板的大小显示尽可能多的元素。

有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCRibbonPanel : public CObject
```

## <a name="members"></a>成员

### <a name="protected-constructors"></a>受保护的构造函数

|名称|说明|
|----------|-----------------|
|[CMFC剪彩面板：CMFC剪彩面板](#cmfcribbonpanel)|构造并初始化一个 `CMFCRibbonPanel` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFC 剪彩面板：添加](#add)|向面板添加功能区元素。|
|[CMFC剪彩面板：添加分离器](#addseparator)|向功能区面板添加分隔符。|
|[CMFC 功能面板：添加工具栏](#addtoolbar)|向功能区面板添加工具栏。|
|[CMFC 功能面板：查找数据](#findbydata)||
|[CMFC 功能面板：：查找ByID](#findbyid)|返回由指定命令 ID 标识的元素。|
|[CMFC 功能面板：：获取标题高度](#getcaptionheight)||
|[CMFC剪彩面板：获取计数](#getcount)|返回功能区面板中的元素数。|
|[CMFC功能面板：获取数据](#getdata)|返回与面板关联的用户定义的数据。|
|[CMFC 功能面板：：获取默认按钮](#getdefaultbutton)||
|[CMFC 功能面板：获取向下](#getdroppeddown)||
|[CMFC功能面板：获取元素](#getelement)|返回位于指定索引的功能区元素。|
|[CMFC 功能面板：获取元素](#getelements)|检索功能区面板中包含的所有元素。|
|[CMFC 功能面板：获取元素 ByID](#getelementsbyid)||
|[CMFC功能面板：获得重点](#getfocused)|返回焦点元素。|
|[CMFC 剪彩面板：：获取画廊Rect](#getgalleryrect)|返回库元素的边界矩形。|
|[CMFC 功能面板：获得突出显示](#gethighlighted)||
|[CMFC功能面板：获取索引](#getindex)||
|[CMFC 剪彩面板：获取项目 Id 列表](#getitemidslist)||
|[CMFC 剪彩面板：获取名称](#getname)||
|[CMFC 功能面板：获取家长按钮](#getparentbutton)||
|[CMFC 功能面板：获取父项类别](#getparentcategory)|返回功能区面板的父类别。|
|[CMFC功能面板：获取家长菜单栏](#getparentmenubar)||
|[CMFC 功能面板：获取首选菜单位置](#getpreferedmenulocation)||
|[CMFC 剪彩面板：获取压榨](#getpressed)||
|[CMFC 剪彩面板：获取 Rect](#getrect)||
|[CMFC 功能面板：获取可见元素](#getvisibleelements)|获取可见元素的数组。|
|[CMFC 功能面板：：元素](#haselement)||
|[CMFC功能面板：HitTest](#hittest)||
|[CMFC剪彩面板：hitTestEx](#hittestex)||
|[CMFC 剪彩面板：插入](#insert)|在给定位置插入功能区元素。|
|[CMFC剪彩面板：插入分离器](#insertseparator)|在给定位置插入分离器。|
|[CMFC 功能面板：：IsCenterColumnvert](#iscentercolumnvert)|指定是否应按列垂直居中（对齐）所有面板元素。|
|[CMFC 功能面板：已折叠](#iscollapsed)||
|[CMFC 功能面板：已突出显示](#ishighlighted)||
|[CMFC 功能面板：：正对齐列](#isjustifycolumns)|指定所有面板列是否具有相同的宽度。|
|[CMFC 功能面板：：主面板](#ismainpanel)||
|[CMFC 功能面板：：即菜单模式](#ismenumode)||
|[CMFC 功能面板：：使画廊项目可见](#makegalleryitemvisible)|滚动库以使指定的功能区元素可见。|
|[CMFC 剪彩面板：：打开键](#onkey)||
|[CMFC 功能面板：Recalc 宽度](#recalcwidths)||
|[CMFC 剪彩面板：删除](#remove)|删除并选择性地删除位于指定索引的元素。|
|[CMFC 功能面板：删除所有](#removeall)|从功能区面板中删除所有元素。|
|[CMFC剪彩面板：更换](#replace)|根据一个元素各自的索引值将一个元素替换为另一个元素。|
|[CMFC 功能面板：替换 ByID](#replacebyid)|根据指定的命令 ID 将一个元素替换为另一个元素。|
|[CMFC 功能面板：：设置中心柱形](#setcentercolumnvert)|命令面板按列垂直对齐元素。|
|[CMFC 功能面板：：数据集](#setdata)|将用户定义的数据与功能区面板关联。|
|[CMFC功能面板：设置元素菜单](#setelementmenu)|将弹出菜单分配给具有给定命令 ID 的元素。|
|[CMFC功能面板：setElementRTC](#setelementrtc)|将提供的运行时类信息指定的功能区元素添加到功能区面板中。|
|[CMFC 功能面板：：SetElementRTCByID](#setelementrtcbyid)|将提供的运行时类信息指定的功能区元素添加到功能区面板中。|
|[CMFC功能面板：集中](#setfocused)|将焦点设置到指定的功能区元素。|
|[CMFC 功能面板：：设置对齐列](#setjustifycolumns)|启用或禁用列对齐。|
|[CMFC 功能面板：：设置键](#setkeys)|设置显示功能区面板的键盘快捷方式。|
|[CMFC 剪彩面板：显示弹出](#showpopup)||

## <a name="remarks"></a>备注

功能区面板是您在功能区类别中创建的相关任务的逻辑分组。 随着功能区大小的更改，面板布局会自动调整以显示尽可能多的元素。

通过调用[CMFC 功能区类别：：getPanel](../../mfc/reference/cmfcribboncategory-class.md#getpanel)方法，可以获取功能区类别中包含的功能区面板。

## <a name="example"></a>示例

下面的示例演示如何使用`CMFCRibbonPanel``CMFCRibbonPanel`类中的各种方法配置对象。 该示例演示如何设置显示功能区面板的键盘快捷方式、按列垂直对齐面板中的元素以及启用列对齐。 此代码段是 MS [Office 2007 演示示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_MSOffice2007Demo#10](../../mfc/reference/codesnippet/cpp/cmfcribbonpanel-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonPanel](../../mfc/reference/cmfcribbonpanel-class.md)

## <a name="requirements"></a>要求

**标题：** afxRibbonPanel.h

## <a name="cmfcribbonpaneladd"></a><a name="add"></a>CMFC 剪彩面板：添加

将指定的功能区元素追加到功能区面板中包含的功能区元素数组中。

```
virtual void Add(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>参数

*佩莱姆*<br/>
[进出]指向功能区元素的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpaneladdseparator"></a><a name="addseparator"></a>CMFC剪彩面板：添加分离器

向功能区面板添加分隔符。

```
virtual void AddSeparator();
```

### <a name="remarks"></a>备注

调用此方法以向功能区面板添加分隔符。 分隔符将添加到上一个调用[CMFCRibbonPanel：：：添加](#add)的功能区元素旁边。 要在给定位置插入分隔符，请致电[CMFCRibbonPanel：：插入分离器](#insertseparator)。

## <a name="cmfcribbonpaneladdtoolbar"></a><a name="addtoolbar"></a>CMFC 功能面板：添加工具栏

向功能区面板添加工具栏。

```
CMFCRibbonButtonsGroup* AddToolBar(
UINT uiToolbarResID,
UINT uiColdResID = 0,
UINT uiHotResID = 0,
UINT uiDisabledResID = 0);
```

### <a name="parameters"></a>参数

*uiToolbarResID*<br/>
[在]指定要添加的工具栏的资源 ID。

*乌伊库德雷斯ID*<br/>
[在]指定工具栏冷图像的资源 ID。

*乌霍特雷斯ID*<br/>
[在]指定工具栏热图像的资源 ID。

*ui禁用雷斯ID*<br/>
[在]指定工具栏禁用图像的资源 ID。

### <a name="return-value"></a>返回值

调用此方法以向功能区面板添加工具栏。 工具栏将添加到上一次调用[CMFCRibbonPanel 添加](#add)的功能区元素旁边：：添加 。

### <a name="remarks"></a>备注

有关工具栏、热图像、冷图像和禁用图像的详细信息，请参阅[CMFCToolBar 类](../../mfc/reference/cmfctoolbar-class.md)。

## <a name="cmfcribbonpanelcmfcribbonpanel"></a><a name="cmfcribbonpanel"></a>CMFC剪彩面板：CMFC剪彩面板

构造并初始化[CMFC 功能面板](../../mfc/reference/cmfcribbonpanel-class.md)对象。

```
CMFCRibbonPanel(
LPCTSTR lpszName = NULL,
HICON hIcon = NULL);

CMFCRibbonPanel(CMFCRibbonGallery* pPaletteButton);
```

### <a name="parameters"></a>参数

*lpsz名称*<br/>
[在]功能区面板的名称。

*hIcon*<br/>
[在]处理功能区面板的默认按钮的图标。

*pPalette按钮*<br/>
[在]指向功能区面板的功能库。

## <a name="cmfcribbonpanelfindbydata"></a><a name="findbydata"></a>CMFC 功能面板：查找数据

检索与指定数据关联的功能区元素。

```
CMFCRibbonBaseElement* FindByData(DWORD_PTR dwData) const;
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]与功能区元素关联的数据。

### <a name="return-value"></a>返回值

如果方法成功，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelfindbyid"></a><a name="findbyid"></a>CMFC 功能面板：：查找ByID

检索由指定的命令 ID 标识的功能区元素。

```
CMFCRibbonBaseElement* FindByID(UINT uiCmdID) const;
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

### <a name="return-value"></a>返回值

由指定的命令 ID 标识的功能区元素;否则 NULL，如果没有使用指定的命令 ID 标识功能区元素。

## <a name="cmfcribbonpanelgetcaptionheight"></a><a name="getcaptionheight"></a>CMFC 功能面板：：获取标题高度

检索功能区面板的标题高度。

```
int GetCaptionHeight() const;
```

### <a name="return-value"></a>返回值

功能区面板的标题的高度（以像素为单位）。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetcount"></a><a name="getcount"></a>CMFC剪彩面板：获取计数

检索功能区面板中包含的功能区元素数。

```
int GetCount() const;
```

### <a name="return-value"></a>返回值

功能区面板中包含的功能区元素数。

## <a name="cmfcribbonpanelgetdata"></a><a name="getdata"></a>CMFC功能面板：获取数据

返回与面板关联的用户定义的数据。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

与面板关联的用户定义的数据。

## <a name="cmfcribbonpanelgetdefaultbutton"></a><a name="getdefaultbutton"></a>CMFC 功能面板：：获取默认按钮

检索功能区面板的默认按钮。

```
CMFCRibbonButton& GetDefaultButton();
```

### <a name="return-value"></a>返回值

功能区面板的默认按钮。

### <a name="remarks"></a>备注

当功能区面板没有足够的空间来显示其功能区元素时，将显示默认按钮。

## <a name="cmfcribbonpanelgetdroppeddown"></a><a name="getdroppeddown"></a>CMFC 功能面板：获取向下

如果功能区元素的弹出菜单被下拉，则检索指向功能区元素的指针。

```
CMFCRibbonBaseElement* GetDroppedDown() const;
```

### <a name="return-value"></a>返回值

指向其弹出菜单下落的功能区元素的指针;否则 NULL，如果没有功能区元素的弹出菜单下拉。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

## <a name="cmfcribbonpanelgetelement"></a><a name="getelement"></a>CMFC功能面板：获取元素

返回位于指定索引的功能区元素。

```
CMFCRibbonBaseElement* GetElement(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定要检索的元素的零基索引。

### <a name="return-value"></a>返回值

指向位于功能区面板中位置*nIndex*的基本功能区元素的有效指针，如果指定索引中没有元素，则指向 NULL。

## <a name="cmfcribbonpanelgetelements"></a><a name="getelements"></a>CMFC 功能面板：获取元素

检索功能区面板中包含的所有功能区元素。

```
void GetElements(CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>参数

*ar元素*<br/>
[出]要填充功能区面板中包含的所有功能区元素的数组。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetelementsbyid"></a><a name="getelementsbyid"></a>CMFC 功能面板：获取元素 ByID

将具有指定命令 ID 的功能区元素添加到指定的数组中。

```
void GetElementsByID(
UINT uiCmdID,
CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]功能区元素的命令 ID。

*ar元素*<br/>
[在]功能区元素的数组。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

## <a name="cmfcribbonpanelgethighlighted"></a><a name="gethighlighted"></a>CMFC 功能面板：获得突出显示

检索功能区面板上突出显示的功能区元素。

```
CMFCRibbonBaseElement* GetHighlighted() const;
```

### <a name="return-value"></a>返回值

指向功能区面板上突出显示的功能区元素的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetindex"></a><a name="getindex"></a>CMFC功能面板：获取索引

从功能区面板中包含的功能区元素数组中检索指定功能区元素的零基索引。

```
virtual int GetIndex(CMFCRibbonBaseElement* pElem) const;
```

### <a name="parameters"></a>参数

*佩莱姆*<br/>
[在]指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果方法成功，则指定功能区元素的零基索引;否则 -1。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetitemidslist"></a><a name="getitemidslist"></a>CMFC 剪彩面板：获取项目 Id 列表

检索功能区面板中所有功能区元素的命令指示。

```
void GetItemIDsList(CList<UINT, UINT>& lstItems) const;
```

### <a name="parameters"></a>参数

*lstItem*<br/>
[出]功能区面板中包含的功能区元素的命令指示指示列表。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetname"></a><a name="getname"></a>CMFC 剪彩面板：获取名称

检索功能区面板的名称。

```
LPCTSTR GetName() const;
```

### <a name="return-value"></a>返回值

功能区面板的名称。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetparentbutton"></a><a name="getparentbutton"></a>CMFC 功能面板：获取家长按钮

```
CMFCRibbonBaseElement* GetParentButton() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetparentcategory"></a><a name="getparentcategory"></a>CMFC 功能面板：获取父项类别

返回功能区面板的父类别。

```
CMFCRibbonCategory* GetParentCategory() const;
```

### <a name="return-value"></a>返回值

指向包含此功能区面板的功能区类别的指针。

## <a name="cmfcribbonpanelgetparentmenubar"></a><a name="getparentmenubar"></a>CMFC功能面板：获取家长菜单栏

```
CMFCRibbonPanelMenuBar* GetParentMenuBar() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetpreferedmenulocation"></a><a name="getpreferedmenulocation"></a>CMFC 功能面板：获取首选菜单位置

检索功能区面板的弹出式菜单的首选显示矩形。

```
virtual BOOL GetPreferedMenuLocation(CRect& rect);
```

### <a name="parameters"></a>参数

*矩形*<br/>
[出]不使用此参数。

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

此方法始终返回 FALSE。 重写此方法以检索功能区面板的弹出式菜单的首选显示矩形。

## <a name="cmfcribbonpanelgetpressed"></a><a name="getpressed"></a>CMFC 剪彩面板：获取压榨

如果用户当前按下功能区面板上的功能区元素，则检索指向该功能区元素的指针。

```
CMFCRibbonBaseElement* GetPressed() const;
```

### <a name="return-value"></a>返回值

如果用户当前按下功能区元素，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetrect"></a><a name="getrect"></a>CMFC 剪彩面板：获取 Rect

检索功能区面板的显示矩形。

```
const CRect& GetRect() const;
```

### <a name="return-value"></a>返回值

功能区面板的显示矩形。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelhaselement"></a><a name="haselement"></a>CMFC 功能面板：：元素

指示功能区面板是否包含指定的功能区元素。

```
BOOL HasElement(const CMFCRibbonBaseElement* pElem) const;
```

### <a name="parameters"></a>参数

*佩莱姆*<br/>
[在]指向功能区元素的指针。

### <a name="return-value"></a>返回值

如果功能区面板包含指定的功能区元素，则为 TRUE;如果功能区面板包含指定的功能区元素，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelhighlight"></a><a name="highlight"></a>CMFC剪彩面板：亮点

设置所选功能区面板和点指定的功能区元素的高光颜色。

```
virtual void Highlight(
BOOL bHighlight,
CPoint point);
```

### <a name="parameters"></a>参数

*b 高光*<br/>
[在]TRUE 以突出显示功能区面板;FALSE 以取消突出显示功能区面板。

*点*<br/>
[在]指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelhittest"></a><a name="hittest"></a>CMFC功能面板：HitTest

如果指定的点位于其中，则检索功能区元素。

```
virtual CMFCRibbonBaseElement* HitTest(
CPoint point,
BOOL bCheckPanelCaption = FALSE);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]指针的 x 和 y 坐标，相对于窗口的左上角。

*b检查面板标题*<br/>
[在]TRUE 以测试功能区面板标题;否则 FALSE。

### <a name="return-value"></a>返回值

如果指定点位于功能区元素中，则指向功能区元素的指针;否则 NULL。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

## <a name="cmfcribbonpanelhittestex"></a><a name="hittestex"></a>CMFC剪彩面板：hitTestEx

检索包含指定点的功能区元素的零基索引。

```
virtual int HitTestEx(CPoint point) const;
```

### <a name="parameters"></a>参数

*点*<br/>
[在]指针的 x 和 y 坐标，相对于窗口的左上角。

### <a name="return-value"></a>返回值

功能区元素的零基索引，其中具有指定点;否则 -1。

### <a name="remarks"></a>备注

仅测试功能区面板中包含的功能区元素。

## <a name="cmfcribbonpanelinsert"></a><a name="insert"></a>CMFC 剪彩面板：插入

在功能区面板中包含的功能区元素数组中，将指定的功能区元素插入指定位置。

```
virtual BOOL Insert(
CMFCRibbonBaseElement* pElem,
int nIndex);
```

### <a name="parameters"></a>参数

*佩莱姆*<br/>
[进出]指向功能区元素的指针。

*nIndex*<br/>
[在]从 -1 到数组中包含的功能区元素数的零基值。

### <a name="return-value"></a>返回值

如果功能区元素已成功插入，则为 TRUE;如果功能区元素已成功插入，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

如果*nIndex*的值为 -1，或者如果*nIndex*等于数组中的功能区元素数，则指定的功能区元素将添加到数组的末尾。 如果*nIndex*的值超过范围，则该方法将失败。

## <a name="cmfcribbonpanelinsertseparator"></a><a name="insertseparator"></a>CMFC剪彩面板：插入分离器

在给定位置插入分离器。

```
virtual BOOL InsertSeparator(int nIndex);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定插入分隔符的零基索引。

### <a name="return-value"></a>返回值

如果分离器已成功插入，则为 TRUE;如果分离器已成功插入。否则，FALSE。

### <a name="remarks"></a>备注

调用此方法在*nIndex*指定的位置插入分隔符。 要在最近添加的功能区元素旁边插入分隔符，请致电[CMFCRibbonPanel：：addSeparor](#addseparator)。

## <a name="cmfcribbonpaneliscentercolumnvert"></a><a name="iscentercolumnvert"></a>CMFC 功能面板：：IsCenterColumnvert

指示功能区元素的垂直位置是否居中于其显示矩形内。

```
BOOL IsCenterColumnVert() const;
```

### <a name="return-value"></a>返回值

如果功能区元素的垂直位置居中，则为 TRUE;如果功能区元素的垂直位置位于其显示矩形内，则为 TRUE;否则 FALSE。

## <a name="cmfcribbonpaneliscollapsed"></a><a name="iscollapsed"></a>CMFC 功能面板：已折叠

指示功能区面板的显示大小是否以水平方向最小化。

```
BOOL IsCollapsed() const;
```

### <a name="return-value"></a>返回值

如果功能区面板的显示大小在水平方向上最小化，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

当功能区面板折叠时，它只显示其默认按钮、名称和下拉箭头。

## <a name="cmfcribbonpanelishighlighted"></a><a name="ishighlighted"></a>CMFC 功能面板：已突出显示

指示功能区面板的显示是否突出显示。

```
BOOL IsHighlighted() const;
```

### <a name="return-value"></a>返回值

如果功能区面板的显示突出显示，则为 TRUE;如果功能区面板的显示突出显示，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

当指针位于其上时，功能区面板的显示将突出显示。

## <a name="cmfcribbonpanelisjustifycolumns"></a><a name="isjustifycolumns"></a>CMFC 功能面板：：正对齐列

指示功能区面板中同一列中的功能区元素的显示尺寸是否设置为相同的宽度。

```
BOOL IsJustifyColumns() const;
```

### <a name="return-value"></a>返回值

如果功能区面板中同一列中的功能区元素的显示尺寸设置为相同的宽度，则为 TRUE;如果功能区面板中同一列中的功能区元素的显示尺寸设置为相同宽度。"否则 FALSE。

## <a name="cmfcribbonpanelismainpanel"></a><a name="ismainpanel"></a>CMFC 功能面板：：主面板

指示功能区面板是否是主功能区面板。

```
virtual BOOL IsMainPanel() const;
```

### <a name="return-value"></a>返回值

始终返回 FALSE。

### <a name="remarks"></a>备注

此方法始终返回 FALSE。 重写此方法以指示功能区面板是否是主功能区面板。

当用户选择应用程序按钮时，将显示主功能区面板。

## <a name="cmfcribbonpanelismenumode"></a><a name="ismenumode"></a>CMFC 功能面板：：即菜单模式

```
BOOL IsMenuMode() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelonkey"></a><a name="onkey"></a>CMFC 剪彩面板：：打开键

```
virtual BOOL OnKey(UINT nChar);
```

### <a name="parameters"></a>参数

[在]*n查尔*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelrecalcwidths"></a><a name="recalcwidths"></a>CMFC 功能面板：Recalc 宽度

重新计算功能区面板的每个显示布局配置的宽度。

```
virtual void RecalcWidths(
CDC* pDC,
int nHeight);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向功能区面板的设备上下文。

*nHeight*<br/>
[在]功能区面板的高度。

### <a name="remarks"></a>备注

功能区面板会随着可用宽度的变化更改其布局配置。

## <a name="cmfcribbonpanelremove"></a><a name="remove"></a>CMFC 剪彩面板：删除

删除并选择性地删除位于指定索引的元素。

```
BOOL Remove(
int nIndex,
BOOL bDelete = TRUE);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定从功能区面板中删除的元素的零基索引。

*b 删除*<br/>
[在]TRUE 以删除要删除的元素;否则，FALSE。

### <a name="return-value"></a>返回值

如果元素已被删除并被删除（如果*bDelete*为 TRUE），则为 TRUE;如果未删除元素或*nIndex*上没有功能区元素，则 FALSE

### <a name="remarks"></a>备注

调用此方法从功能区面板中删除元素。

## <a name="cmfcribbonpanelremoveall"></a><a name="removeall"></a>CMFC 功能面板：删除所有

从功能区面板中删除所有功能区元素。

```
void RemoveAll();
```

### <a name="remarks"></a>备注

所有功能区元素都将从功能区面板中删除并销毁。

## <a name="cmfcribbonpanelreplace"></a><a name="replace"></a>CMFC剪彩面板：更换

根据一个元素的索引值将一个元素替换为另一个元素。

```
BOOL Replace(
int nIndex,
CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定要替换的元素的零基索引。

*佩莱姆*<br/>
[进出]指向替换原始元素的元素的有效指针。

### <a name="return-value"></a>返回值

如果原始功能区元素已成功替换为新的功能区元素，则为 TRUE;如果原始功能区元素已成功替换为新功能区元素，则为 TRUE。如果未替换功能区元素或指定索引中没有元素，则 FALSE。

### <a name="remarks"></a>备注

要用命令 ID 替换功能区元素，请致电[CMFC 功能面板：：替换 ByID](#replacebyid)。

## <a name="cmfcribbonpanelreplacebyid"></a><a name="replacebyid"></a>CMFC 功能面板：替换 ByID

根据指定的命令 ID 将一个元素替换为另一个元素。

```
BOOL ReplaceByID(
UINT uiCmdID,
CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]指定要替换的元素的命令 ID。

*佩莱姆*<br/>
[进出]指向将替换原始元素的元素的有效指针。

### <a name="return-value"></a>返回值

如果原始功能区元素已成功替换为新的功能区元素，则为 TRUE;如果原始功能区元素已成功替换为新功能区元素，则为 TRUE。如果未替换功能区元素或实际上不存在具有指定命令 ID 的元素，则 FALSE。

### <a name="remarks"></a>备注

要根据位置替换功能区元素，请致电[CMFCRibbonPanel：：：替换](#replace)。

## <a name="cmfcribbonpanelsetcentercolumnvert"></a><a name="setcentercolumnvert"></a>CMFC 功能面板：：设置中心柱形

启用或禁用功能区元素在其显示矩形中的垂直位置的中心。

```
void SetCenterColumnVert(BOOL bSet = TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]TRUE 以中心功能区元素在其显示矩形内的垂直位置;FALSE 以禁用此功能。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelsetdata"></a><a name="setdata"></a>CMFC 功能面板：：数据集

将用户定义的数据与功能区面板关联。

```
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]指定要设置的用户定义数据。

### <a name="remarks"></a>备注

调用此方法将用户定义的数据与功能区面板相关联。

## <a name="cmfcribbonpanelsetelementmenu"></a><a name="setelementmenu"></a>CMFC功能面板：设置元素菜单

将弹出菜单分配给具有给定命令 ID 的元素。

```
BOOL SetElementMenu(
UINT uiCmdID,
HMENU hMenu,
BOOL bIsDefautCommand = FALSE,
BOOL bRightAlign = FALSE);

BOOL SetElementMenu(
UINT uiCmdID,
UINT uiMenuResID,
BOOL bIsDefautCommand = FALSE,
BOOL bRightAlign = FALSE);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]指定添加菜单的功能区元素的命令 ID。

*hMenu*<br/>
[在]指定要添加到功能区面板的 Windows 菜单的句柄。

*bIsDefaut命令*<br/>
[在]TRUE 指定在单击功能区元素时应执行与功能区元素关联的命令。 在这种情况下，仅当用户单击功能区元素旁边的箭头时，才会打开菜单。 FALSE 指定在单击功能区元素时不应执行与功能区元素关联的命令。 在这种情况下，无论用户单击元素的位置，都会显示弹出菜单。

*b 右对齐*<br/>
[在]TRUE 指定弹出菜单正确对齐;否则，FALSE。

*uiMenuResID*<br/>
[在]指定要添加到功能区面板的菜单的资源 ID。

### <a name="return-value"></a>返回值

如果菜单已分配给功能区元素，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

调用此方法以将弹出菜单分配给具有给定命令 ID 的功能区元素。

## <a name="cmfcribbonpanelsetelementrtc"></a><a name="setelementrtc"></a>CMFC功能面板：setElementRTC

将提供的运行时类信息指定的功能区元素添加到功能区面板中。

```
CMFCRibbonBaseElement* SetElementRTC(
int nIndex,
CRuntimeClass* pRTC);
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]指定要添加的功能区元素的零基索引。

*pRTC*<br/>
[进出]指向添加到功能区面板的功能区元素的运行时类信息的指针。

### <a name="return-value"></a>返回值

通过使用指定的运行时类信息创建的功能区元素。

### <a name="remarks"></a>备注

如果要向功能区面板添加自定义元素（例如颜色按钮），则必须指定自定义元素的运行时类信息。 功能区存储此信息、创建自定义元素并替换位于（标识）指定命令 ID 的现有元素。 然后，功能区返回指向新创建元素的指针。

## <a name="cmfcribbonpanelsetelementrtcbyid"></a><a name="setelementrtcbyid"></a>CMFC 功能面板：：SetElementRTCByID

将由提供的运行时类信息指定的功能区元素添加到功能区面板中。

```
CMFCRibbonBaseElement* SetElementRTCByID(
UINT uiCmdID,
CRuntimeClass* pRTC);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]指定要添加的功能区元素的命令 ID。

*pRTC*<br/>
[进出]指向与添加到功能区面板的功能区元素关联的运行时类信息的指针。

### <a name="return-value"></a>返回值

通过使用指定的运行时类信息创建的功能区元素。

### <a name="remarks"></a>备注

如果要向功能区面板添加自定义元素（例如颜色按钮），则必须指定自定义元素的运行时类信息。 功能区存储此信息、创建自定义元素并替换由指定命令 ID 定位的现有元素。 然后，它返回指向新创建元素的指针。

### <a name="example"></a>示例

下面的示例演示如何使用 方法`SetElementRTCByID`：

```

// Load and add toolbar with standard buttons. This toolbar
// should display a custom color button with id ID_CHAR_COLOR:

pPanel->AddToolBar(IDR_MAINFRAME,
    IDB_MAINFRAME256);

CMFCRibbonColorButton* pColorButton =
(CMFCRibbonColorButton*)pPanel->SetElementRTCByID(
ID_CHAR_COLOR,
    RUNTIME_CLASS (CMFCRibbonColorButton));

// SetElementRTCByID sets runtime class and returns a pointer
// to the newly created custom button,
    which can be set up immediately:
pColorButton->EnableAutomaticButton(_T("Automatic"),
    RGB (0,
    0,
    0));
```

## <a name="cmfcribbonpanelsetjustifycolumns"></a><a name="setjustifycolumns"></a>CMFC 功能面板：：设置对齐列

启用或禁用同一列中功能区元素宽度的调整。

```
void SetJustifyColumns(BOOL bSet = TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]TRUE 将同一列中的功能区元素的宽度调整为列中最大功能区元素的宽度;FALSE 以禁用此宽度调整。

### <a name="remarks"></a>备注

在功能区面板中启用此功能时，同一列中的功能区元素的宽度将调整为同一列中最大的功能区元素的宽度。

## <a name="cmfcribbonpanelsetkeys"></a><a name="setkeys"></a>CMFC 功能面板：：设置键

设置功能区面板的默认按钮的键尖。

```
void SetKeys(LPCTSTR lpszKeys);
```

### <a name="parameters"></a>参数

*lpszKeys*<br/>
[在]功能区面板的默认按钮的键尖。

### <a name="remarks"></a>备注

当功能区面板没有足够的空间来显示其功能区元素时，将显示默认按钮。

## <a name="cmfcribbonpanelshowpopup"></a><a name="showpopup"></a>CMFC 剪彩面板：显示弹出

创建并显示功能区面板的弹出式菜单。

```
CMFCRibbonPanelMenu* ShowPopup(CMFCRibbonDefaultPanelButton* pButton = NULL);
```

### <a name="parameters"></a>参数

*pButton*<br/>
[在]指向功能区面板的默认按钮。

### <a name="return-value"></a>返回值

如果方法成功，则指向功能区面板的弹出菜单;否则 NULL。

### <a name="remarks"></a>备注

功能区面板的弹出菜单仅在功能区面板的显示折叠时可用。

## <a name="cmfcribbonpanelsetfocused"></a><a name="setfocused"></a>CMFC功能面板：集中

将焦点设置到指定的功能区元素。

```
void SetFocused(CMFCRibbonBaseElement* pNewFocus);
```

### <a name="parameters"></a>参数

*p 新焦点*<br/>
指向接收焦点的功能区元素的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelmakegalleryitemvisible"></a><a name="makegalleryitemvisible"></a>CMFC 功能面板：：使画廊项目可见

滚动库以使指定的功能区元素可见。

```
void MakeGalleryItemVisible(CMFCRibbonBaseElement* pItem);
```

### <a name="parameters"></a>参数

*pItem*<br/>
指向要显示的功能区元素的指针。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpaneliswindows7look"></a><a name="iswindows7look"></a>CMFC 功能面板：：是 Windows7 查看

指示父功能区是否具有 Windows 7 外观（小型矩形应用程序按钮）。

```
BOOL IsWindows7Look() const;
```

### <a name="return-value"></a>返回值

如果父功能区具有 Windows 7 外观，则为 TRUE;如果父功能区具有 Windows 7 外观，则为 TRUE。否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetvisibleelements"></a><a name="getvisibleelements"></a>CMFC 功能面板：获取可见元素

检索可见元素的数组。

```
void GetVisibleElements(
CArray<CMFCRibbonBaseElement*,
CMFCRibbonBaseElement*>& arElements);
```

### <a name="parameters"></a>参数

*ar元素*<br/>
当函数返回时，此参数包含可见元素数组。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetgalleryrect"></a><a name="getgalleryrect"></a>CMFC 剪彩面板：：获取画廊Rect

返回库元素的边界矩形。

```
CRect GetGalleryRect();
```

### <a name="return-value"></a>返回值

库元素在此面板中的大小和位置。

### <a name="remarks"></a>备注

## <a name="cmfcribbonpanelgetfocused"></a><a name="getfocused"></a>CMFC功能面板：获得重点

返回焦点元素。

```
CMFCRibbonBaseElement* GetFocused() const;
```

### <a name="return-value"></a>返回值

指向焦点元素或 NULL 的指针。

### <a name="remarks"></a>备注

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CObject 类](../../mfc/reference/cobject-class.md)<br/>
[CMFCRibbonCategory 类](../../mfc/reference/cmfcribboncategory-class.md)<br/>
[CMFCRibbonBaseElement 类](../../mfc/reference/cmfcribbonbaseelement-class.md)
