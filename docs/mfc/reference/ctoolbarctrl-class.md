---
title: CToolBarCtrl 类 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
dev_langs:
- C++
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 4e8a958ac670f91edfccdfced43fce311bc29c04
ms.sourcegitcommit: a41c4d096afca1e9b619bbbce045b77135d32ae2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/14/2018
ms.locfileid: "42541195"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl 类
提供 Windows 工具栏公共控件的功能。  
  
## <a name="syntax"></a>语法  
  
```  
class CToolBarCtrl : public CWnd  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|描述|  
|----------|-----------------|  
|[CToolBarCtrl::CToolBarCtrl](#ctoolbarctrl)|构造 `CToolBarCtrl` 对象。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|描述|  
|----------|-----------------|  
|[CToolBarCtrl::AddBitmap](#addbitmap)|将一个或多个位图按钮图像添加到按钮映像可用于工具栏控件的列表。|  
|[CToolBarCtrl::AddButtons](#addbuttons)|将一个或多个按钮添加到工具栏控件。|  
|[CToolBarCtrl::AddString](#addstring)|添加一个新字符串，作为资源 ID，到工具栏的内部列表的字符串传递。|  
|[CToolBarCtrl::AddStrings](#addstrings)|将添加一个新的字符串或字符串，作为指针传递给 null 分隔字符串，转换为工具栏的内部列表的字符串的缓冲区。|  
|[CToolBarCtrl::AutoSize](#autosize)|调整工具栏控件的大小。|  
|[CToolBarCtrl::ChangeBitmap](#changebitmap)|更改当前的工具栏控件中的按钮的位图。|  
|[CToolBarCtrl::CheckButton](#checkbutton)|选中或清除给定的按钮在工具栏控件中。|  
|[CToolBarCtrl::CommandToIndex](#commandtoindex)|检索与指定的命令标识符关联的按钮的从零开始索引。|  
|[CToolBarCtrl::Create](#create)|创建工具栏控件，并将其附加到`CToolBarCtrl`对象。|  
|[CToolBarCtrl::CreateEx](#createex)|使用指定的 Windows 扩展样式创建工具栏控件，并将其附加到`CToolBarCtrl`对象。|  
|[CToolBarCtrl::Customize](#customize)|自定义工具栏对话框中显示。|  
|[CToolBarCtrl::DeleteButton](#deletebutton)|从工具栏控件中删除一个按钮。|  
|[CToolBarCtrl::EnableButton](#enablebutton)|启用或禁用工具栏控件中指定的按钮。|  
|[CToolBarCtrl::GetAnchorHighlight](#getanchorhighlight)|检索设置工具栏的定位点突出显示。|  
|[CToolBarCtrl::GetBitmap](#getbitmap)|检索与按钮在工具栏中关联的位图的索引。|  
|[CToolBarCtrl::GetBitmapFlags](#getbitmapflags)|获取与工具栏的位图关联的标志。|  
|[CToolBarCtrl::GetButton](#getbutton)|检索有关指定的按钮在工具栏中的信息。|  
|[CToolBarCtrl::GetButtonCount](#getbuttoncount)|检索当前在工具栏控件中的按钮的计数。|  
|[CToolBarCtrl::GetButtonInfo](#getbuttoninfo)|检索一个按钮在工具栏中的信息。|  
|[CToolBarCtrl::GetButtonSize](#getbuttonsize)|检索的当前宽度和高度的工具栏按钮，以像素为单位。|  
|[CToolBarCtrl::GetColorScheme](#getcolorscheme)|检索当前的工具栏控件的配色方案。|  
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|检索工具栏控件使用于显示禁用的按钮的图像列表。|  
|[CToolBarCtrl::GetDropTarget](#getdroptarget)|检索[IDropTarget](http://msdn.microsoft.com/library/windows/desktop/ms679679)工具栏控件的接口。|  
|[CToolBarCtrl::GetExtendedStyle](#getextendedstyle)|检索工具栏控件的扩展的样式。|  
|[CToolBarCtrl::GetHotImageList](#gethotimagelist)|检索工具栏控件用于显示"热"按钮的图像列表。 当鼠标指针位于其上方时突出显示热按钮。|  
|[CToolBarCtrl::GetHotItem](#gethotitem)|检索在工具栏中的热项的索引。|  
|[CToolBarCtrl::GetImageList](#getimagelist)|检索工具栏控件用于在其默认状态中显示按钮的图像列表。|  
|[CToolBarCtrl::GetInsertMark](#getinsertmark)|检索当前插入标记的工具栏。|  
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|检索用来绘制工具栏插入标记的颜色。|  
|[CToolBarCtrl::GetItemRect](#getitemrect)|检索工具栏控件中的按钮的边框。|  
|[CToolBarCtrl::GetMaxSize](#getmaxsize)|检索所有可见的按钮并在工具栏中的分隔符的总大小。|  
|[CToolBarCtrl::GetMaxTextRows](#getmaxtextrows)|检索的最大的工具栏按钮上显示的文本行数。|  
|[CToolBarCtrl::GetMetrics](#getmetrics)|检索工具栏控件的指标。|  
|[CToolBarCtrl::GetPadding](#getpadding)|检索当前的工具栏控件的水平和垂直填充。|  
|[CToolBarCtrl::GetPressedImageList](#getpressedimagelist)|检索当前的工具栏控件使用以表示处于按下状态的按钮的图像列表。|  
|[CToolBarCtrl::GetRect](#getrect)|检索指定的工具栏按钮的边框。|  
|[CToolBarCtrl::GetRows](#getrows)|检索当前显示在工具栏中的按钮的行数。|  
|[CToolBarCtrl::GetState](#getstate)|检索有关指定的按钮在工具栏控件，如是否启用、 按下时，或检查的状态信息。|  
|[CToolBarCtrl::GetString](#getstring)|检索工具栏字符串。|  
|[CToolBarCtrl::GetStyle](#getstyle)|检索当前正在使用工具栏控件样式。|  
|[CToolBarCtrl::GetToolTips](#gettooltips)|如果任何，与工具栏控件相关联，请检索工具提示控件，句的柄。|  
|[CToolBarCtrl::HideButton](#hidebutton)|隐藏或显示指定的按钮在工具栏控件中。|  
|[CToolBarCtrl::HitTest](#hittest)|确定其中一个点存在于工具栏控件中。|  
|[CToolBarCtrl::Indeterminate](#indeterminate)|设置或清除指定的按钮在工具栏中的不确定 （灰色） 状态。|  
|[CToolBarCtrl::InsertButton](#insertbutton)|在工具栏控件中插入一个按钮。|  
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|检索在工具栏中的点的插入标记信息。|  
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|指示是否检查指定的按钮在工具栏控件中。|  
|[CToolBarCtrl::IsButtonEnabled](#isbuttonenabled)|指示是否启用工具栏控件中指定的按钮。|  
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|指示是否隐藏工具栏控件中指定的按钮。|  
|[CToolBarCtrl::IsButtonHighlighted](#isbuttonhighlighted)|检查工具栏按钮的突出显示状态。|  
|[CToolBarCtrl::IsButtonIndeterminate](#isbuttonindeterminate)|指示指定的按钮在工具栏中的状态是否是不确定 （灰色）。|  
|[CToolBarCtrl::IsButtonPressed](#isbuttonpressed)|指示是否按下工具栏控件中指定的按钮。|  
|[CToolBarCtrl::LoadImages](#loadimages)|将位图加载到工具栏控件的图像列表。|  
|[CToolBarCtrl::MapAccelerator](#mapaccelerator)|将快捷键字符映射到工具栏按钮。|  
|[CToolBarCtrl::MarkButton](#markbutton)|在工具栏控件中设置给定按钮的突出显示状态。|  
|[CToolBarCtrl::MoveButton](#movebutton)|将一个按钮从一个索引移到另一个。|  
|[CToolBarCtrl::PressButton](#pressbutton)|按下或释放指定的按钮在工具栏控件中。|  
|[CToolBarCtrl::ReplaceBitmap](#replacebitmap)|使用新的位图替换当前的工具栏控件中现有的位图。|  
|[CToolBarCtrl::RestoreState](#restorestate)|还原工具栏控件的状态。|  
|[CToolBarCtrl::SaveState](#savestate)|保存工具栏控件的状态。|  
|[CToolBarCtrl::SetAnchorHighlight](#setanchorhighlight)|设置设置为工具栏的定位点突出显示。|  
|[CToolBarCtrl::SetBitmapSize](#setbitmapsize)|设置要添加到工具栏控件的位图化图像的大小。|  
|[CToolBarCtrl::SetButtonInfo](#setbuttoninfo)|在工具栏中设置的现有按钮的信息。|  
|[CToolBarCtrl::SetButtonSize](#setbuttonsize)|设置要添加到工具栏控件的按钮的大小。|  
|[CToolBarCtrl::SetButtonStructSize](#setbuttonstructsize)|指定的大小`TBBUTTON`结构。|  
|[CToolBarCtrl::SetButtonWidth](#setbuttonwidth)|工具栏控件中设置的最小值和最大按钮宽度。|  
|[CToolBarCtrl::SetCmdID](#setcmdid)|设置指定的按钮按下时要发送到所有者窗口的命令标识符。|  
|[CToolBarCtrl::SetColorScheme](#setcolorscheme)|设置当前的工具栏控件的颜色方案。|  
|[CToolBarCtrl::SetDisabledImageList](#setdisabledimagelist)|将工具栏控件将使用的图像列表设置为显示禁用按钮。|  
|[CToolBarCtrl::SetDrawTextFlags](#setdrawtextflags)|Win32 函数中设置标志[DrawText](http://msdn.microsoft.com/library/windows/desktop/dd162498)，用于根据标志的设置方式设置格式的指定矩形中绘制文本。|  
|[CToolBarCtrl::SetExtendedStyle](#setextendedstyle)|设置工具栏控件的扩展的样式。|  
|[CToolBarCtrl::SetHotImageList](#sethotimagelist)|设置工具栏控件将显示"热"按钮的图像列表。|  
|[CToolBarCtrl::SetHotItem](#sethotitem)|在工具栏中设置的热项。|  
|[CToolBarCtrl::SetImageList](#setimagelist)|设置工具栏将显示处于其默认状态的按钮的图像列表。|  
|[CToolBarCtrl::SetIndent](#setindent)|设置工具栏控件中的第一个按钮的缩进。|  
|[CToolBarCtrl::SetInsertMark](#setinsertmark)|设置当前插入标记的工具栏。|  
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|设置用于绘制的工具栏插入标记的颜色。|  
|[CToolBarCtrl::SetMaxTextRows](#setmaxtextrows)|设置最大的工具栏按钮上显示的文本行数。|  
|[CToolBarCtrl::SetMetrics](#setmetrics)|设置工具栏控件的指标。|  
|[CToolBarCtrl::SetOwner](#setowner)|设置要从工具栏控件接收通知消息的窗口。|  
|[CToolBarCtrl::SetPadding](#setpadding)|设置当前的工具栏控件的水平和垂直填充。|  
|[CToolBarCtrl::SetPressedImageList](#setpressedimagelist)|设置当前的工具栏控件使用以表示处于按下状态的按钮的图像列表。|  
|[CToolBarCtrl::SetRows](#setrows)|设置按钮的工具栏中显示的行数。|  
|[CToolBarCtrl::SetState](#setstate)|在工具栏控件中设置指定的按钮的状态。|  
|[CToolBarCtrl::SetStyle](#setstyle)|设置工具栏控件的样式。|  
|[CToolBarCtrl::SetToolTips](#settooltips)|将工具提示控件与工具栏控件相关联。|  
|[CToolBarCtrl::SetWindowTheme](#setwindowtheme)|设置工具栏控件的视觉样式。|  
  
## <a name="remarks"></a>备注  
 此控件 (并因此`CToolBarCtrl`类) 仅适用于 Windows 95/98 和 Windows NT 版本 3.51 下运行的程序和更高版本。  
  
 Windows 工具栏公共控件是包含一个或多个按钮的矩形的子窗口。 这些按钮可以显示位图图像、 一个字符串，或两者。 当用户选择按钮时，它将命令消息发送到工具栏的所有者窗口。 通常情况下，在工具栏中的按钮对应于应用程序的菜单; 中的项它们提供更直接的方式，供用户访问应用程序的命令。  
  
 `CToolBarCtrl` 对象包含几个重要的内部数据结构： 一系列按钮图像位图或图像列表、 一系列按钮标签字符串和一系列`TBBUTTON`结构的关联映像和/或字符串的位置，样式，使用状态，并且命令 ID按钮。 每个元素的这些数据结构称为按从零开始的索引。 可以使用之前`CToolBarCtrl`对象，你必须设置了这些数据结构。 字符串的列表可以仅用于按钮标签;从工具栏中，无法检索字符串。  
  
 为了使用 `CToolBarCtrl` 对象，您通常将执行下列步骤：  
  
1.  构造 `CToolBarCtrl` 对象。  
  
2.  调用[创建](#create)若要创建 Windows 工具栏公共控件并将其附加到`CToolBarCtrl`对象。 通过使用样式，如透明工具栏 TBSTYLE_TRANSPARENT 或支持下拉列表样式按钮的工具栏的 TBSTYLE_DROPDOWN 指示工具栏的样式。  
  
3.  确定要如何显示在工具栏上的按钮：  
  
    -   若要使用位图图像按钮，按钮位图向工具栏添加通过调用[AddBitmap](#addbitmap)。  
  
    -   若要使用从图像列表的按钮显示的图像，通过调用指定的图像列表[SetImageList](#setimagelist)， [SetHotImageList](#sethotimagelist)，或[SetDisabledImageList](#setdisabledimagelist)。  
  
    -   若要使用按钮字符串标签，将字符串添加到工具栏通过调用[AddString](#addstring)和/或[AddStrings](#addstrings)。  
  
4.  通过调用向工具栏添加按钮结构[AddButtons](#addbuttons)。  
  
5.  如果想要在不是所有者窗口的工具栏按钮的工具提示`CFrameWnd`，您需要处理工具栏的所有者窗口中的 TTN_NEEDTEXT 消息中所述[处理工具提示通知](../../mfc/handling-tool-tip-notifications.md)。 如果工具栏的父窗口派生自`CFrameWnd`，而无需任何额外工作从您显示工具提示，因为`CFrameWnd`提供默认处理程序。  
  
6.  如果您想让用户能够自定义工具栏，处理所有者窗口中的自定义通知消息中所述[处理自定义通知](../../mfc/handling-customization-notifications.md)。  
  
 可以使用[SaveState](#savestate)以保存在注册表中的工具栏控件的当前状态并[RestoreState](#restorestate)来根据信息存储在注册表中以前的状态还原。 除了保存工具栏状态之间的应用程序使用，应用程序通常存储状态之前用户开始自定义工具栏，以防用户稍后想要还原到其原始状态的工具栏。  
  
## <a name="support-for-internet-explorer-version-40-and-later"></a>对 Internet 资源管理器版本 4.0 及更高版本的支持  
 若要支持 Internet Explorer 中，版本 4.0 以及更高版本中引入的功能 MFC 提供映像列表支持和透明和平面样式工具栏控件。  
  
 透明工具栏允许客户端的工具栏下方显示。 若要创建透明工具栏，请使用 TBSTYLE_FLAT 和 TBSTYLE_TRANSPARENT 样式。 透明工具栏功能热跟踪;也就是说，当鼠标指针移到热按钮在工具栏上，按钮的外观会发生变化。 只需 TBSTYLE_FLAT 样式创建的工具栏将包含按钮不透明的。  
  
 图像列表支持允许的默认行为、 热映像和禁用的图像控件更大的灵活性。 使用[GetImageList](#getimagelist)， [GetHotImageList](#gethotimagelist)，并[GetDisabledImageList](#getdisabledimagelist)与透明工具栏来操作其状态根据在映像：  
  
 有关使用的详细信息`CToolBarCtrl`，请参阅[控件](../../mfc/controls-mfc.md)并[使用 CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)。  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `CToolBarCtrl`  
  
## <a name="requirements"></a>要求  
 **标头：** afxcmn.h  
  
##  <a name="addbitmap"></a>  CToolBarCtrl::AddBitmap  
 将一个或多个按钮图像添加到存储在工具栏控件中的按钮图像的列表。  
  
```  
int AddBitmap(
    int nNumButtons,  
    UINT nBitmapID);

 
int AddBitmap(
    int nNumButtons,  
    CBitmap* pBitmap);
```  
  
### <a name="parameters"></a>参数  
 *nNumButtons*  
 在位图中的按钮图像数量。  
  
 *nBitmapID*  
 包含要添加的按钮图像的位图的资源标识符。  
  
 *pBitmap*  
 指向`CBitmap`对象，其中包含要添加的按钮图像。  
  
### <a name="return-value"></a>返回值  
 如果成功，则第一个的新图像的从零开始的索引否则为-1。  
  
### <a name="remarks"></a>备注  
 可以使用 Windows API [CreateMappedBitmap](http://msdn.microsoft.com/library/windows/desktop/bb787467)映射之前添加到工具栏的位图的颜色。 如果传递一个指向`CBitMap`对象，则必须确保工具栏被销毁后，位图不销毁之前。  
  
##  <a name="addbuttons"></a>  CToolBarCtrl::AddButtons  
 将一个或多个按钮添加到工具栏控件。  
  
```  
BOOL AddButtons(
    int nNumButtons,  
    LPTBBUTTON lpButtons);
```  
  
### <a name="parameters"></a>参数  
 *nNumButtons*  
 要添加的按钮数。  
  
 *lpButtons*  
 数组的地址`TBBUTTON`包含要添加的按钮有关的信息的结构。 必须为按钮指定数组中元素的数量*nNumButtons*。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 *LpButtons*指针指向的数组`TBBUTTON`结构。 每个`TBBUTTON`结构将被添加为按钮的样式、 映像和/或字符串，命令 ID、 状态和用户定义数据的按钮相关联：  
  
 `typedef struct _TBBUTTON {`  
  
 `int iBitmap;// zero-based index of button image`  
  
 `int idCommand;  // command to be sent when button pressed`  
  
 `BYTE fsState;   // button state--see below`  
  
 `BYTE fsStyle;   // button style--see below`  
  
 `DWORD dwData;   // application-defined value`  
  
 `int iString;// zero-based index of button label string`  
  
 `} TBBUTTON;`  
  
 成员是按如下所示：  
  
 `iBitmap`  
 按钮图像，则此按钮没有图像为-1 的从零开始的索引。  
  
 `idCommand`  
 与按钮关联的命令标识符。 选择该按钮时，此标识符将发送 WM_COMMAND 消息中。 如果`fsStyle`成员具有 TBSTYLE_SEP 的值，此成员必须为零。  
  
 `fsState`  
 按钮状态标志。 它可以是下面列出的值的组合：  
  
- TBSTATE_CHECKED 按钮具有 TBSTYLE_CHECKED 样式和已按下。  
  
- TBSTATE_ENABLED 按钮接受用户输入。 不具有此状态的按钮不接受用户输入，并就会变灰。  
  
- TBSTATE_HIDDEN 按钮不可见，并且不能接受用户输入。  
  
- TBSTATE_INDETERMINATE 按钮就会变灰。  
  
- TBSTATE_PRESSED 已按下按钮。  
  
- 该按钮后跟 TBSTATE_WRAP 一个换行符。 该按钮还必须具有 TBSTATE_ENABLED 状态。  
  
 `fsStyle`  
 按钮样式。 它可以是下面列出的值的组合：  
  
- TBSTYLE_BUTTON 创建标准的推送按钮。  
  
- TBSTYLE_CHECK 创建一个按钮，每次按下和未按下状态之间切换用户单击它。 该按钮处于按下状态时具有不同的背景色。  
  
- TBSTYLE_CHECKGROUP 创建直到按下的组中的另一个按钮，按下保持复选按钮。  
  
- TBSTYLE_GROUP 创建直到按下的组中的另一个按钮，按下某个按钮保持。  
  
- TBSTYLE_SEP 创建分隔符，提供按钮组较小的差异。 包含此样式的按钮不会接收用户输入。  
  
 `dwData`  
 用户定义的数据。  
  
 `iString`  
 要用作按钮的字符串的从零开始的索引的标签，则此按钮没有字符串为-1。  
  
 映像和/或你提供的索引必须之前已添加到工具栏控件的字符串列表使用[AddBitmap](#addbitmap)， [AddString](#addstring)，和/或[AddStrings](#addstrings)。  
  
##  <a name="addstring"></a>  CToolBarCtrl::AddString  
 添加一个新字符串，作为资源 ID，到工具栏的内部列表的字符串传递。  
  
```  
int AddString(UINT nStringID);
```  
  
### <a name="parameters"></a>参数  
 *nStringID*  
 若要添加到工具栏控件的字符串列表的字符串资源的资源标识符。  
  
### <a name="return-value"></a>返回值  
 如果成功，则添加的第一个新字符串的从零开始的索引否则为-1。  
  
##  <a name="addstrings"></a>  CToolBarCtrl::AddStrings  
 将一个新的字符串添加到可用的工具栏控件的字符串列表。  
  
```  
int AddStrings(LPCTSTR lpszStrings);
```  
  
### <a name="parameters"></a>参数  
 *lpszStrings*  
 包含要添加到工具栏的字符串列表的一个或多个 null 值结束字符串的缓冲区的地址。 最后一个字符串，必须具有两个 null 字符终止。  
  
### <a name="return-value"></a>返回值  
 如果成功，则添加的第一个新字符串的从零开始的索引否则为-1。  
  
### <a name="remarks"></a>备注  
 必须由 null 字符分隔字符串缓冲区中。 您必须确保最后一个字符串具有两个 null 终止符。 要正确设置格式的常量字符串，你可以编写为：  
  
 [!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]  
  
 或：  
  
 [!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]  
  
 您不应传递`CString`对象对此函数由于无法在有多个空字符`CString`。  
  
##  <a name="autosize"></a>  CToolBarCtrl::AutoSize  
 整个工具栏控件的大小调整。  
  
```  
void AutoSize();
```  
  
### <a name="remarks"></a>备注  
 当父窗口的大小发生更改时或工具栏的大小更改 （例如当您设置按钮或位图的大小，或添加字符串） 时，应调用此函数。  
  
##  <a name="changebitmap"></a>  CToolBarCtrl::ChangeBitmap  
 更改当前的工具栏控件中的按钮的位图。  
  
```  
BOOL ChangeBitmap(
    int idButton,   
    int iBitmap);
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[in]*idButton*|要接收新的位图按钮的命令标识符。|  
|[in]*iBitmap*|当前工具栏控件的图像列表中的图像的从零开始的索引。|  
  
### <a name="return-value"></a>返回值  
 如果此方法成功，则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 如果此方法成功，系统将显示在指定的按钮中指定的图像。  
  
 此方法将发送[TB_CHANGEBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb787301)消息，Windows SDK 中所述。  
  
### <a name="example"></a>示例  
 下面的代码示例将更改的位图**文件保存**的位图按钮**有关**按钮。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]  
  
##  <a name="checkbutton"></a>  CToolBarCtrl::CheckButton  
 选中或清除给定的按钮在工具栏控件中。  
  
```  
BOOL CheckButton(
    int nID,  
    BOOL bCheck = TRUE);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 若要选中或清除的按钮命令标识符。  
  
 *bCheck*  
 为 true，则复选按钮，为 FALSE，则将其清除。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 如果已选中按钮，它似乎已按下。 如果你想要更改多个按钮的状态，请考虑调用[SetState](#setstate)相反。  
  
##  <a name="commandtoindex"></a>  CToolBarCtrl::CommandToIndex  
 检索与指定的命令标识符关联的按钮的从零开始索引。  
  
```  
UINT CommandToIndex(UINT nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 命令 ID 的按钮索引你想要查找。  
  
### <a name="return-value"></a>返回值  
 与命令 id。 关联的按钮的从零开始的索引  
  
### <a name="remarks"></a>备注  
  
##  <a name="create"></a>  CToolBarCtrl::Create  
 创建工具栏控件，并将其附加到`CToolBarCtrl`对象。  
  
```  
virtual BOOL Create(
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>参数  
 *dwStyle*  
 指定工具栏控件的样式。 工具栏必须始终具有 WS_CHILD 样式。 此外，可以指定 toolbar 样式和窗口样式的任意组合，如下所述**备注**。  
  
 *rect*  
 （可选） 指定工具栏控件的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)结构。  
  
 *pParentWnd*  
 指定工具栏控件的父窗口。 它不能为 NULL。  
  
 *nID*  
 指定工具栏控件的 id。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 构造`CToolBarCtrl`中两个步骤。 首先，调用构造函数中，，然后调用`Create`，它创建工具栏控件并将其附加到`CToolBarCtrl`对象。 将下面的窗口样式应用于工具栏控件。  
  
- WS_CHILD 始终  
  
- WS_VISIBLE 通常  
  
- WS_DISABLED 很少  
  
 请参阅[CreateWindow](http://msdn.microsoft.com/library/windows/desktop/ms632679)的窗口样式说明 Windows SDK 中。  
  
 （可选） 将应用的组合[常见控件样式](http://msdn.microsoft.com/library/windows/desktop/bb775498)，如 Windows SDK 中所述。  
  
 将工具栏样式的组合应用于控件或按钮本身。 主题中所述样式[工具栏控件和按钮样式](http://msdn.microsoft.com/library/windows/desktop/bb760439)Windows SDK 中。  
  
 若要使用扩展的工具栏样式，请调用[SetExtendedStyle](#setextendedstyle)调用后`Create`。 若要创建具有扩展的窗口样式的一个工具栏，请调用[CToolBarCtrl::CreateEx](#createex)而不是`Create`。  
  
 工具栏控件自动设置的大小和位置工具栏窗口中。 高度基于在工具栏中按钮的高度。 宽度是与父窗口的工作区的宽度相同。 CCS_TOP 和 CCS_BOTTOM 样式确定工具栏是否位于顶部或底部的工作区。 默认情况下，工具栏时 CCS_TOP 样式。  
  
##  <a name="createex"></a>  CToolBarCtrl::CreateEx  
 创建控件 （子窗口），并将其与`CToolBarCtrl`对象。  
  
```  
virtual BOOL CreateEx(
    DWORD dwExStyle,  
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>参数  
 *dwExStyle*  
 指定要创建的控件的扩展的样式。 扩展 Windows 样式的列表，请参阅*dwExStyle*参数[CreateWindowEx](http://msdn.microsoft.com/library/windows/desktop/ms632680) Windows SDK 中。  
  
 *dwStyle*  
 指定工具栏控件的样式。 工具栏必须始终具有 WS_CHILD 样式。 此外，可以指定 toolbar 样式和窗口样式的任意组合，如中所述**备注**一部分[创建](#create)。  
  
 *rect*  
 对引用[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)结构的结构描述的大小和窗口的工作区中创建的位置*pParentWnd*。  
  
 *pParentWnd*  
 指向控件的父级的窗口的指针。  
  
 *nID*  
 控件的子窗口 id。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 使用`CreateEx`而不是[创建](#create)若要将应用扩展的 Windows 样式，指定的 Windows 扩展的样式加**WS_EX_**。 `CreateEx` 创建使用指定的扩展 Windows 样式的控件*dwExStyle*。 设置扩展样式特定于控件使用[SetExtendedStyle](#setextendedstyle)。 例如，使用`CreateEx`来将此类样式设置为 WS_EX_CONTEXTHELP，但使用`SetExtendedStyle`若要将此类样式设置为 TBSTYLE_EX_DRAWDDARROWS。 有关详细信息，请参阅中所述的样式[工具栏扩展样式](http://msdn.microsoft.com/library/windows/desktop/bb760430)Windows SDK 中。  
  
##  <a name="ctoolbarctrl"></a>  CToolBarCtrl::CToolBarCtrl  
 构造 `CToolBarCtrl` 对象。  
  
```  
CToolBarCtrl();
```  
  
### <a name="remarks"></a>备注  
 必须调用[创建](#create)以使工具栏上可用。  
  
##  <a name="customize"></a>  CToolBarCtrl::Customize  
 自定义工具栏对话框中显示。  
  
```  
void Customize();
```  
  
### <a name="remarks"></a>备注  
 此对话框允许用户自定义工具栏，通过添加和删除按钮。 若要支持自定义，工具栏的父窗口必须处理自定义通知消息中所述[处理自定义通知](../../mfc/handling-customization-notifications.md)。 您的工具栏必须也已创建具有 CCS_ADJUSTABLE 样式中所述[CToolBarCtrl::Create](#create)。  
  
 有关详细信息，请参阅知识库文章 Q241850: PRB: CToolBarCtrl::Customize 不会保留到自定义对话框可见调用。  
  
##  <a name="deletebutton"></a>  CToolBarCtrl::DeleteButton  
 从工具栏控件中删除一个按钮。  
  
```  
BOOL DeleteButton(int nIndex);
```  
  
### <a name="parameters"></a>参数  
 *nIndex*  
 若要删除的按钮的从零开始索引。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
  
##  <a name="enablebutton"></a>  CToolBarCtrl::EnableButton  
 启用或禁用工具栏控件中指定的按钮。  
  
```  
BOOL EnableButton(
    int nID,  
    BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 若要启用或禁用的按钮的命令标识符。  
  
 *bEnable*  
 为 TRUE，则启用该按钮;如果为 FALSE 禁用该按钮。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 已启用一个按钮，它可以按下并选中。 如果你想要更改多个按钮的状态，请考虑调用[SetState](#setstate)相反。  
  
##  <a name="getanchorhighlight"></a>  CToolBarCtrl::GetAnchorHighlight  
 检索设置工具栏的定位点突出显示。  
  
```  
BOOL GetAnchorHighlight() const;  
```  
  
### <a name="return-value"></a>返回值  
 如果非零值，则启用定位点突出显示。 如果为零，定位点突出显示已禁用。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETANCHORHIGHLIGHT](http://msdn.microsoft.com/library/windows/desktop/bb787313)，如 Windows SDK 中所述。  
  
##  <a name="getbitmap"></a>  CToolBarCtrl::GetBitmap  
 检索与按钮在工具栏中关联的位图的索引。  
  
```  
int GetBitmap(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 位图索引是要检索的按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 返回位图，如果成功，则否则为零的索引。  
  
### <a name="remarks"></a>备注  
 实现的功能[TB_GETBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb787315) Windows SDK 中。  
  
##  <a name="getbitmapflags"></a>  CToolBarCtrl::GetBitmapFlags  
 检索从工具栏的位图标志。  
  
```  
UINT GetBitmapFlags() const;  
```  
  
### <a name="return-value"></a>返回值  
 显示可支持大型工具栏位图，如果设置了 TBBF_LARGE 标志 UINT 否则清除。  
  
### <a name="remarks"></a>备注  
 创建工具栏后但在将位图添加到工具栏之前，应调用它。 返回值指示是否显示是否支持大型位图。 如果显示器支持大型位图，并选择要使用它们，请调用[SetBitmapSize](#setbitmapsize)并[SetButtonSize](#setbuttonsize)之前添加对大型位图使用[AddBitmap](#addbitmap)。  
  
##  <a name="getbutton"></a>  CToolBarCtrl::GetButton  
 检索有关指定的按钮在工具栏中的信息。  
  
```  
BOOL GetButton(
    int nIndex,  
    LPTBBUTTON lpButton) const;  
```  
  
### <a name="parameters"></a>参数  
 *nIndex*  
 要为其检索信息的按钮的从零开始索引。  
  
 *lpButton*  
 地址`TBBUTTON`结构，它是以接收按钮信息的副本。 请参阅[CToolBarCtrl::AddButtons](#addbuttons)有关`TBBUTTON`结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
##  <a name="getbuttoncount"></a>  CToolBarCtrl::GetButtonCount  
 检索当前在工具栏控件中的按钮的计数。  
  
```  
int GetButtonCount() const;  
```  
  
### <a name="return-value"></a>返回值  
 按钮的计数。  
  
##  <a name="getbuttoninfo"></a>  CToolBarCtrl::GetButtonInfo  
 检索一个按钮在工具栏中的信息。  
  
```  
int GetButtonInfo(
    int nID,  
    TBBUTTONINFO* ptbbi) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 按钮标识符。  
  
 *ptbbi*  
 一个指向[TBBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb760478)接收按钮信息的结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则按钮的从零开始的索引否则为-1。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb787321)，如 Windows SDK 中所述。  
  
##  <a name="getbuttonsize"></a>  CToolBarCtrl::GetButtonSize  
 获取工具栏按钮的大小。  
  
```  
DWORD GetButtonSize() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个 DWORD 值，分别包含在使用 LOWORD 和 HIWORD，宽度和高度值。  
  
##  <a name="getbuttontext"></a>  CToolBarCtrl::GetButtonText  
 检索当前的工具栏控件上指定的按钮的显示文本。  
  
```  
CString GetButtonText(int idButton) const;  
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[in]*idButton*|检索其显示文本的按钮的标识符。|  
  
### <a name="return-value"></a>返回值  
 一个[CString](../../atl-mfc-shared/using-cstring.md) ，包含指定的按钮的显示文本。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_GETBUTTONTEXT](http://msdn.microsoft.com/library/windows/desktop/bb787325)消息，Windows SDK 中所述。  
  
##  <a name="getcolorscheme"></a>  CToolBarCtrl::GetColorScheme  
 检索当前的工具栏控件的配色方案。  
  
```  
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;  
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[out]*lpColorScheme*|指向[要添加的配色](http://msdn.microsoft.com/library/windows/desktop/bb775502)结构，它接收的颜色方案信息。 此方法返回时，该结构描述的突出显示颜色和阴影颜色的工具栏控件。|  
  
### <a name="return-value"></a>返回值  
如果此方法成功，则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_GETCOLORSCHEME](http://msdn.microsoft.com/library/windows/desktop/bb787327)消息，Windows SDK 中所述。  
  
##  <a name="getdisabledimagelist"></a>  CToolBarCtrl::GetDisabledImageList  
 检索工具栏控件使用于显示禁用的按钮的图像列表。  
  
```  
CImageList* GetDisabledImageList() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向[CImageList](../../mfc/reference/cimagelist-class.md)对象，或者如果没有禁用的图像列表设置为 NULL。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETDISABLEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787329)，如 Windows SDK 中所述。 MFC 实现`GetDisabledImageList`使用`CImageList`对象，包含工具栏控件的按钮映像，而不是图像列表的句柄。  
  
##  <a name="getdroptarget"></a>  CToolBarCtrl::GetDropTarget  
 检索[IDropTarget](http://msdn.microsoft.com/library/windows/desktop/ms679679)工具栏控件的接口。  
  
```  
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;  
```  
  
### <a name="parameters"></a>参数  
 *ppDropTarget*  
 一个指向[IDropTarget](http://msdn.microsoft.com/library/windows/desktop/ms679679)接口指针。 如果发生错误，则将为 NULL 指针放置在该地址。  
  
### <a name="return-value"></a>返回值  
 返回一个 HRESULT 值，指示成功或失败的操作。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETOBJECT](http://msdn.microsoft.com/library/windows/desktop/bb787343)，如 Windows SDK 中所述。  
  
##  <a name="getextendedstyle"></a>  CToolBarCtrl::GetExtendedStyle  
 检索工具栏控件的扩展的样式。  
  
```  
DWORD GetExtendedStyle() const;  
```  
  
### <a name="return-value"></a>返回值  
 表示当前正在使用工具栏控件的扩展的样式 DWORD。 有关样式的列表，请参阅[工具栏扩展样式](http://msdn.microsoft.com/library/windows/desktop/bb760430)，Windows SDK 中。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb787331)，如 Windows SDK 中所述。  
  
##  <a name="gethotimagelist"></a>  CToolBarCtrl::GetHotImageList  
 检索工具栏控件用于显示"热"按钮的图像列表。 当鼠标指针位于其上方时突出显示热按钮。  
  
```  
CImageList* GetHotImageList() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向[CImageList](../../mfc/reference/cimagelist-class.md)对象，或者如果没有禁用的图像列表设置为 NULL。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETHOTIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787334)，如 Windows SDK 中所述。 当鼠标指针位于其上方时突出显示热按钮。  
  
##  <a name="gethotitem"></a>  CToolBarCtrl::GetHotItem  
 检索在工具栏中的热项的索引。  
  
```  
int GetHotItem() const;  
```  
  
### <a name="return-value"></a>返回值  
 在工具栏中的热项的从零开始的索引。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETHOTITEM](http://msdn.microsoft.com/library/windows/desktop/bb787336)，如 Windows SDK 中所述。  
  
##  <a name="getimagelist"></a>  CToolBarCtrl::GetImageList  
 检索工具栏控件用于在其默认状态中显示按钮的图像列表。  
  
```  
CImageList* GetImageList() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向[CImageList](../../mfc/reference/cimagelist-class.md)对象，或者如果没有图像列表设置为 NULL。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787337)，如 Windows SDK 中所述。  
  
##  <a name="getinsertmark"></a>  CToolBarCtrl::GetInsertMark  
 检索当前插入标记的工具栏。  
  
```  
void GetInsertMark(TBINSERTMARK* ptbim) const;  
```  
  
### <a name="parameters"></a>参数  
 *ptbim*  
 一个指向[TBINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb760480)接收插入标记的结构。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb787338)，如 Windows SDK 中所述。  
  
##  <a name="getinsertmarkcolor"></a>  CToolBarCtrl::GetInsertMarkColor  
 检索用来绘制工具栏插入标记的颜色。  
  
```  
COLORREF GetInsertMarkColor() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个 COLORREF 值，该值包含当前插入标记颜色。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb787339)，如 Windows SDK 中所述。  
  
##  <a name="getitemrect"></a>  CToolBarCtrl::GetItemRect  
 检索工具栏控件中的按钮的边框。  
  
```  
BOOL GetItemRect(
    int nIndex,  
    LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>参数  
 *nIndex*  
 要为其检索信息的按钮的从零开始索引。  
  
 *lpRect*  
 地址[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)结构或[CRect](../../atl-mfc-shared/reference/crect-class.md)对象，它接收的边框的坐标。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 此函数不会检索其状态设置为 TBSTATE_HIDDEN 的按钮的边框。  
  
##  <a name="getmaxsize"></a>  CToolBarCtrl::GetMaxSize  
 检索所有可见的按钮并在工具栏中的分隔符的总大小。  
  
```  
BOOL GetMaxSize(LPSIZE pSize) const;  
```  
  
### <a name="parameters"></a>参数  
 *pSize*  
 一个指向[大小](http://msdn.microsoft.com/library/windows/desktop/dd145106)结构，它接收的项的大小。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETMAXSIZE](http://msdn.microsoft.com/library/windows/desktop/bb787341)，如 Windows SDK 中所述。  
  
##  <a name="getmaxtextrows"></a>  CToolBarCtrl::GetMaxTextRows  
 检索的最大的工具栏按钮上显示的文本行数。  
  
```  
int GetMaxTextRows() const;  
```  
  
### <a name="return-value"></a>返回值  
 最大的工具栏按钮上显示的文本行数。  
  
##  <a name="getmetrics"></a>  CToolBarCtrl::GetMetrics  
 检索的指标`CToolBarCtrl`对象。  
  
```  
void GetMetrics(LPTBMETRICS ptbm) const;  
```  
  
### <a name="parameters"></a>参数  
 *ptbm*  
 一个指向[TBMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb760482)的结构`CToolBarCtrl`对象。  
  
### <a name="remarks"></a>备注  
 此成员函数模拟的功能[TB_GETMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb787342)消息，如 Windows SDK 中所述。  
  
##  <a name="getpadding"></a>  CToolBarCtrl::GetPadding  
 检索当前的工具栏控件的水平和垂直填充。  
  
```  
BOOL GetPadding(
    int* pnHorzPadding,   
    int* pnVertPadding) const;  
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[out]*pnHorzPadding*|一个整数，以像素为单位接收工具栏控件的水平填充。|  
|[out]*pnVertPadding*|一个整数，以像素为单位接收工具栏控件的垂直边距。|  
  
### <a name="return-value"></a>返回值  
 如果此方法成功，则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_GETPADDING](http://msdn.microsoft.com/library/windows/desktop/bb787344)消息，Windows SDK 中所述。  
  
##  <a name="getpressedimagelist"></a>  CToolBarCtrl::GetPressedImageList  
 检索当前的工具栏控件使用以表示处于按下状态的按钮的图像列表。  
  
```  
CImageList* GetPressedImageList();
```  
  
### <a name="return-value"></a>返回值  
 指向[CImageList](../../mfc/reference/cimagelist-class.md)其中包含当前控件，则为 NULL 的映像列表，如果没有此类图像列表设置。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_GETPRESSEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787345)消息，Windows SDK 中所述。  
  
##  <a name="getrect"></a>  CToolBarCtrl::GetRect  
 检索指定的工具栏按钮的边框。  
  
```  
BOOL GetRect(
    int nID,  
    LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 按钮标识符。  
  
 *lpRect*  
 一个指向[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)结构接收边界矩形信息。  
  
### <a name="return-value"></a>返回值  
 若成功，则为 TRUE；否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETRECT](http://msdn.microsoft.com/library/windows/desktop/bb787346)，如 Windows SDK 中所述。  
  
##  <a name="getrows"></a>  CToolBarCtrl::GetRows  
 检索由工具栏控件当前显示的按钮的行数。  
  
```  
int GetRows() const;  
```  
  
### <a name="return-value"></a>返回值  
 当前显示在工具栏上的按钮的行数。  
  
### <a name="remarks"></a>备注  
 请注意，行数将始终是一个除非 TBSTYLE_WRAPABLE 样式创建工具栏。  
  
##  <a name="getstate"></a>  CToolBarCtrl::GetState  
 检索有关指定的按钮在工具栏控件，如是否启用、 按下时，或检查的状态信息。  
  
```  
int GetState(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 要为其检索信息的按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 如果成功，则按钮状态信息或者-1 以其他方式。 按钮状态信息可以是所列的值的组合[CToolBarCtrl::AddButtons](#addbuttons)。  
  
### <a name="remarks"></a>备注  
 此函数是如果你想要检索多个按钮状态之一时尤为方便。 若要只检索一个状态，请使用以下成员函数之一： [IsButtonEnabled](#isbuttonenabled)， [IsButtonChecked](#isbuttonchecked)， [IsButtonPressed](#isbuttonpressed)， [IsButtonHidden](#isbuttonhidden)，或[IsButtonIndeterminate](#isbuttonindeterminate)。 但是，`GetState`成员函数是检测 TBSTATE_WRAP 按钮状态的唯一方法。  
  
##  <a name="getstring"></a>  CToolBarCtrl::GetString  
 检索工具栏字符串。  
  
```  
int GetString(
    int nString,  
    LPTSTR lpstrString,  
    int cchMaxLen) const;  
  
int GetString(
    int nString,  
    CString& str) const;  
```  
  
### <a name="parameters"></a>参数  
 *n 字符串的结尾*  
 字符串的索引。  
  
 *lpstrString*  
 指向用于返回字符串的缓冲区。  
  
 *cchMaxLen*  
 以字节为单位的缓冲区的长度。  
  
 *str*  
 字符串。  
  
### <a name="return-value"></a>返回值  
 如果成功，该字符串的长度则不为-1。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_GETSTRING](http://msdn.microsoft.com/library/windows/desktop/bb787349)，如 Windows SDK 中所述。  
  
##  <a name="getstyle"></a>  CToolBarCtrl::GetStyle  
 获取当前应用于工具栏控件的样式。  
  
```  
DWORD GetStyle() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个 dword 值，其中包含组成[工具栏控件样式](http://msdn.microsoft.com/library/windows/desktop/bb760439)，如 Windows SDK 中所述。  
  
##  <a name="gettooltips"></a>  CToolBarCtrl::GetToolTips  
 如果任何，与工具栏控件相关联，请检索工具提示控件，句的柄。  
  
```  
CToolTipCtrl* GetToolTips() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)如果该工具栏不具有任何关联的工具提示控件使用此工具栏或 NULL 关联的对象。  
  
### <a name="remarks"></a>备注  
 通常，工具栏控件创建和维护其自己的工具提示控件，因为大多数程序无需调用此函数。  
  
##  <a name="hittest"></a>  CToolBarCtrl::HitTest  
 确定其中一个点存在于工具栏控件中。  
  
```  
int HitTest(LPPOINT ppt) const;  
```  
  
### <a name="parameters"></a>参数  
 *ppt*  
 一个指向[点](http://msdn.microsoft.com/library/windows/desktop/dd162805)结构，它包含中的命中测试的 x 坐标`x`成员和 y 坐标的命中测试中`y`成员。 坐标是相对于工具栏的工作区。  
  
### <a name="return-value"></a>返回值  
 一个整数值，该值指示工具栏上的点的位置。 如果值为零或正数，则此返回值是点存在于 nonseparator 项的从零开始的索引。  
  
 如果返回值为负，点不位于其中一个按钮。 返回值的绝对值是分隔符项或最接近的 nonseparator 项的索引。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_HITTEST](http://msdn.microsoft.com/library/windows/desktop/bb787360)，如 Windows SDK 中所述。  
  
##  <a name="hidebutton"></a>  CToolBarCtrl::HideButton  
 隐藏或显示指定的按钮在工具栏控件中。  
  
```  
BOOL HideButton(
    int nID,  
    BOOL bHide = TRUE);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 若要隐藏或显示的按钮的命令标识符。  
  
 *bHide*  
 若要隐藏按钮，则返回 FALSE 来显示它，则为 TRUE。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 如果你想要更改多个按钮的状态，请考虑调用[SetState](#setstate)相反。  
  
##  <a name="indeterminate"></a>  CToolBarCtrl::Indeterminate  
 设置或清除指定的按钮在工具栏中的不确定状态。  
  
```  
BOOL Indeterminate(
    int nID,  
    BOOL bIndeterminate = TRUE);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 其不确定状态是要设置或清除的按钮的命令标识符。  
  
 *bIndeterminate*  
 指定的按钮，为 FALSE，则将其清除将不确定状态设置为 TRUE。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 不确定显示按钮灰显，如字处理器的方式在工具栏上的加粗按钮时所选的文本包含粗体和常规字符的外观。 如果你想要更改多个按钮的状态，请考虑调用[SetState](#setstate)相反。  
  
##  <a name="insertbutton"></a>  CToolBarCtrl::InsertButton  
 在工具栏控件中插入一个按钮。  
  
```  
BOOL InsertButton(
    int nIndex,  
    LPTBBUTTON lpButton);
```  
  
### <a name="parameters"></a>参数  
 *nIndex*  
 一个按钮的从零开始索引。 此函数将插入到此按钮的左侧新建按钮。  
  
 *lpButton*  
 地址`TBBUTTON`结构，它包含要插入的按钮有关的信息。 请参阅[CToolBarCtrl::AddButtons](#addbuttons)有关的说明`TBBUTTON`结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 映像和/或你提供的索引必须之前已添加到工具栏控件的字符串列表使用[AddBitmap](#addbitmap)， [AddString](#addstring)，和/或[AddStrings](#addstrings)。  
  
##  <a name="insertmarkhittest"></a>  CToolBarCtrl::InsertMarkHitTest  
 检索在工具栏中的点的插入标记信息。  
  
```  
BOOL InsertMarkHitTest(
    LPPOINT ppt,  
    LPTBINSERTMARK ptbim) const;  
```  
  
### <a name="parameters"></a>参数  
 *ppt*  
 一个指向[点](http://msdn.microsoft.com/library/windows/desktop/dd162805)结构，其中包含了点击的测试协调，相对于客户端区域的工具栏。  
  
 *ptbim*  
 一个指向[TBINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb760480)接收插入标记信息的结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_INSERTMARKHITTEST](http://msdn.microsoft.com/library/windows/desktop/bb787367)，如 Windows SDK 中所述。  
  
##  <a name="isbuttonchecked"></a>  CToolBarCtrl::IsButtonChecked  
 确定工具栏控件中指定的按钮是否被选中。  
  
```  
BOOL IsButtonChecked(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 在工具栏中按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 如果按钮被选中; 非零值否则为零。  
  
### <a name="remarks"></a>备注  
 请考虑调用[GetState](#getstate)如果你想要检索多个按钮的状态。  
  
##  <a name="isbuttonenabled"></a>  CToolBarCtrl::IsButtonEnabled  
 确定是否启用工具栏控件中指定的按钮。  
  
```  
BOOL IsButtonEnabled(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 在工具栏中按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 如果启用该按钮，则非零值否则为零。  
  
### <a name="remarks"></a>备注  
 请考虑调用[GetState](#getstate)如果你想要检索多个按钮的状态。  
  
##  <a name="isbuttonhidden"></a>  CToolBarCtrl::IsButtonHidden  
 确定是否隐藏工具栏控件中指定的按钮。  
  
```  
BOOL IsButtonHidden(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 在工具栏中按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 如果该按钮处于隐藏状态; 非零值否则为零。  
  
### <a name="remarks"></a>备注  
 请考虑调用[GetState](#getstate)如果你想要检索多个按钮的状态。  
  
##  <a name="isbuttonhighlighted"></a>  CToolBarCtrl::IsButtonHighlighted  
 检查的工具栏按钮的突出显示状态。  
  
```  
BOOL IsButtonHighlighted(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 [in]*nID*  
 工具栏按钮的命令 ID。  
  
### <a name="return-value"></a>返回值  
 如果按钮突出显示的正整数，如果不突出显示按钮，则为 0 或-1 如果检测到错误发生。  
  
##  <a name="isbuttonindeterminate"></a>  CToolBarCtrl::IsButtonIndeterminate  
 确定指定的按钮在工具栏控件中是不确定。  
  
```  
BOOL IsButtonIndeterminate(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 [in]*nID*  
 在工具栏中按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 正整数如果按钮是不确定的则为零如果按钮不是不确定的或为-1 如果检测到错误发生。  
  
### <a name="remarks"></a>备注  
 不确定显示按钮灰显，如字处理器的方式在工具栏上的加粗按钮时所选的文本中包含粗体和常规字符的外观。 请考虑调用[GetState](#getstate)如果你想要检索多个按钮的状态。  
  
##  <a name="isbuttonpressed"></a>  CToolBarCtrl::IsButtonPressed  
 确定是否按下工具栏控件中指定的按钮。  
  
```  
BOOL IsButtonPressed(int nID) const;  
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 在工具栏中按钮的命令标识符。  
  
### <a name="return-value"></a>返回值  
 如果按下按钮，否则为零，非零值。  
  
### <a name="remarks"></a>备注  
 请考虑调用[GetState](#getstate)如果你想要检索多个按钮的状态。  
  
##  <a name="loadimages"></a>  CToolBarCtrl::LoadImages  
 将位图加载到工具栏控件的图像列表。  
  
```  
void LoadImages(
    int iBitmapID,  
    HINSTANCE hinst);
```  
  
### <a name="parameters"></a>参数  
 *iBitmapID*  
 包含要加载的图像的位图的 ID。 若要指定自己的位图资源，请将此参数设置为位图资源的 ID，并设置*hInst*为 NULL。 位图资源将作为单个映像添加到图像列表。 可以通过设置添加标准的系统定义位图*hinst* HINST_COMMCTRL 和此参数设置为以下 Id 之一：  
  
|位图 ID|描述|  
|---------------|-----------------|  
|IDB_HIST_LARGE_COLOR|资源管理器中较大的大小的位图|  
|IDB_HIST_SMALL_COLOR|资源管理器中较小的位图|  
|IDB_STD_LARGE_COLOR|标准位图中较大的大小|  
|IDB_STD_SMALL_COLOR|标准位图以小的尺寸|  
|IDB_VIEW_LARGE_COLOR|视图位图中较大的大小|  
|IDB_VIEW_SMALL_COLOR|视图中较小的位图|  
  
 *hinst*  
 程序实例句柄调用应用程序。 此参数可以是 HINST_COMMCTRL 加载标准映像列表。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_LOADIMAGES](http://msdn.microsoft.com/library/windows/desktop/bb787381)，如 Windows SDK 中所述。  
  
##  <a name="mapaccelerator"></a>  CToolBarCtrl::MapAccelerator  
 将快捷键字符映射到工具栏按钮。  
  
```  
BOOL MapAccelerator(
    TCHAR chAccel,  
    UINT* pIDBtn);
```  
  
### <a name="parameters"></a>参数  
 *chAccel*  
 要映射的加速器字符。 该字符为按钮的文本中带下划线的相同字符。  
  
 *pIDBtn*  
 指向接收到加速器中指定对应的按钮的命令标识符 UINT *chAccel*。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_MAPACCELERATOR](http://msdn.microsoft.com/library/windows/desktop/bb787383)，如 Windows SDK 中所述。  
  
##  <a name="markbutton"></a>  CToolBarCtrl::MarkButton  
 在工具栏控件中设置给定按钮的突出显示状态。  
  
```  
BOOL MarkButton(
    int nID,  
    BOOL fHighlight = TRUE);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 按钮标识符。  
  
 *fHighlight*  
 指定要设置的突出显示状态。 默认情况下，则为 TRUE。 如果设置为 FALSE，该按钮设置为其默认状态。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_MARKBUTTON](http://msdn.microsoft.com/library/windows/desktop/bb787385)，如 Windows SDK 中所述。  
  
##  <a name="movebutton"></a>  CToolBarCtrl::MoveButton  
 将一个按钮从一个索引移到另一个。  
  
```  
BOOL MoveButton(
    UINT nOldPos,  
    UINT nNewPos);
```  
  
### <a name="parameters"></a>参数  
 *nOldPos*  
 要移动的按钮的从零开始的索引。  
  
 *nNewPos*  
 按钮的目标的从零开始的索引。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_MOVEBUTTON](http://msdn.microsoft.com/library/windows/desktop/bb787387)，如 Windows SDK 中所述。  
  
##  <a name="pressbutton"></a>  CToolBarCtrl::PressButton  
 按下或释放指定的按钮在工具栏控件中。  
  
```  
BOOL PressButton(int nID, BOOL bPress = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in]*nID*  
 若要按下或释放该按钮的命令标识符。  
  
 [in]*bPress*  
 为 TRUE，则按指定的按钮;为 FALSE，则释放指定的按钮。 默认值为 TRUE。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 如果你想要更改多个按钮的状态，请考虑调用[SetState](#setstate)相反。  
  
 此方法将发送[TB_PRESSBUTTON](http://msdn.microsoft.com/library/windows/desktop/bb787389)消息，Windows SDK 中所述。  
  
##  <a name="replacebitmap"></a>  CToolBarCtrl::ReplaceBitmap  
 使用新的位图替换当前的工具栏控件中现有的位图。  
  
```  
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[in]*pReplaceBitmap*|指向[TBREPLACEBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb760484)结构描述要替换的位图和新的位图。|  
  
### <a name="return-value"></a>返回值  
 如果此方法成功，则为 TRUE否则为 FALSE。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_REPLACEBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb787391)消息，Windows SDK 中所述。  
  
### <a name="example"></a>示例  
 下面的代码示例使用不同的位图替换标准工具栏的位图。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]  
  
##  <a name="restorestate"></a>  CToolBarCtrl::RestoreState  
 从指定的参数在注册表中的位置还原工具栏控件的状态。  
  
```  
void RestoreState(
    HKEY hKeyRoot,  
    LPCTSTR lpszSubKey,  
    LPCTSTR lpszValueName);
```  
  
### <a name="parameters"></a>参数  
 *hKeyRoot*  
 标识注册表或任何以下预定义保留句柄值中的当前打开的密钥：  
  
- HKEY_CLASSES_ROOT  
  
- HKEY_CURRENT_USER  
  
- HKEY_LOCAL_MACHINE  
  
- HKEY_USERS  
  
 *lpszSubKey*  
 指向包含的值与之关联的子项名称的以 null 结尾的字符串。 此参数可以为 null 或为空字符串的指针。 如果参数为 NULL，值将添加到由标识的键*hKeyRoot*参数。  
  
 *lpszValueName*  
 指向包含要检索的值的名称的字符串。 如果具有此名称的值已不存在键中，该函数会将其添加到该密钥。  
  
##  <a name="savestate"></a>  CToolBarCtrl::SaveState  
 将工具栏控件的状态保存在由参数指定的注册表中的位置。  
  
```  
void SaveState(
    HKEY hKeyRoot,  
    LPCTSTR lpszSubKey,  
    LPCTSTR lpszValueName);
```  
  
### <a name="parameters"></a>参数  
 *hKeyRoot*  
 标识注册表或任何以下预定义保留句柄值中的当前打开的密钥：  
  
- HKEY_CLASSES_ROOT  
  
- HKEY_CURRENT_USER  
  
- HKEY_LOCAL_MACHINE  
  
- HKEY_USERS  
  
 *lpszSubKey*  
 指向包含的值与之关联的子项名称的以 null 结尾的字符串。 此参数可以为 null 或为空字符串的指针。 如果参数为 NULL，值将添加到由标识的键*hKeyRoot*参数。  
  
 *lpszValueName*  
 指向包含要设置的值的名称的字符串。 如果具有此名称的值已不存在键中，该函数会将其添加到该密钥。  
  
##  <a name="setanchorhighlight"></a>  CToolBarCtrl::SetAnchorHighlight  
 设置设置为工具栏的定位点突出显示。  
  
```  
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in]*fAnchor*  
 指定是否定位点突出显示是启用还是禁用状态。 如果此值为非零值，则将启用突出显示的定位点。 如果此值为零，将禁用定位点突出显示  
  
### <a name="return-value"></a>返回值  
 以前的定位点设置。 如果启用了突出显示，此值不为零。 如果未启用突出显示，此值为零。  
  
### <a name="remarks"></a>备注  
 此方法实现的 Win32 消息的行为[TB_SETANCHORHIGHLIGHT](http://msdn.microsoft.com/library/windows/desktop/bb787396)，如 Windows SDK 中所述。  
  
##  <a name="setbitmapsize"></a>  CToolBarCtrl::SetBitmapSize  
 设置要添加到工具栏控件的实际位图化图像的大小。  
  
```  
BOOL SetBitmapSize(CSize size);
```  
  
### <a name="parameters"></a>参数  
 *size*  
 宽度和高度，单位为像素的位图化图像。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 必须仅在将任何位图添加到工具栏之前调用此函数。 如果应用程序未显式设置位图大小，则默认为 16 x 15 像素。  
  
##  <a name="setbuttoninfo"></a>  CToolBarCtrl::SetButtonInfo  
 在工具栏中设置的现有按钮的信息。  
  
```  
BOOL SetButtonInfo(
    int nID,  
    TBBUTTONINFO* ptbbi);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 按钮标识符。  
  
 *ptbbi*  
 一个指向[TBBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb760478)接收按钮信息的结构。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 成员函数可实现 Win32 消息的行为[TB_SETBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb787413)，如 Windows SDK 中所述。  
  
##  <a name="setbuttonsize"></a>  CToolBarCtrl::SetButtonSize  
 工具栏控件中设置按钮的大小。  
  
```  
BOOL SetButtonSize(CSize size);
```  
  
### <a name="parameters"></a>参数  
 *size*  
 宽度和高度，以像素为单位的按钮。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 该按钮的大小始终必须至少与它包含的位图大小一样大。 必须仅在将任何位图添加到工具栏之前调用此函数。 如果应用程序未显式设置该按钮的大小，则默认为 24 x 22 像素。  
  
### <a name="example"></a>示例  
  有关示例，请参阅[CToolBar::GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)。  
  
##  <a name="setbuttonstructsize"></a>  CToolBarCtrl::SetButtonStructSize  
 指定的大小`TBBUTTON`结构。  
  
```  
void SetButtonStructSize(int nSize);
```  
  
### <a name="parameters"></a>参数  
 *nSize*  
 大小 （字节） 的`TBBUTTON`结构。  
  
### <a name="remarks"></a>备注  
 如果你想要存储中的额外数据`TBBUTTON`结构，您无法派生新结构从`TBBUTTON`，添加成员需要也可以创建新的结构，其中包含`TBBUTTON`结构作为其第一个成员。 然后将调用此函数可告知工具栏控件的新结构的大小。  
  
 请参阅[CToolBarCtrl::AddButtons](#addbuttons)有关详细信息`TBBUTTON`结构。  
  
##  <a name="setbuttonwidth"></a>  CToolBarCtrl::SetButtonWidth  
 工具栏控件中设置的最小值和最大按钮宽度。  
  
```  
BOOL SetButtonWidth(
    int cxMin,  
    int cxMax);
```  
  
### <a name="parameters"></a>参数  
 *cxMin*  
 最小按钮宽度，以像素为单位。 工具栏按钮将永远不会超过此值更窄。  
  
 *cxMax*  
 最大按钮宽度，以像素为单位。 如果太宽按钮文本，该控件将显示其与省略号点。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为 0；否则为 0。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETBUTTONWIDTH](http://msdn.microsoft.com/library/windows/desktop/bb787417)，如 Windows SDK 中所述。  
  
##  <a name="setcmdid"></a>  CToolBarCtrl::SetCmdID  
 设置指定的按钮按下时将发送到所有者窗口的命令标识符。  
  
```  
BOOL SetCmdID(
    int nIndex,  
    UINT nID);
```  
  
### <a name="parameters"></a>参数  
 *nIndex*  
 其命令 ID，将按钮的从零开始的索引。  
  
 *nID*  
 要设置为选定的按钮的命令 ID。  
  
### <a name="return-value"></a>返回值  
 如果成功，则非零返回否则为零。  
  
##  <a name="setcolorscheme"></a>  CToolBarCtrl::SetColorScheme  
 设置当前的工具栏控件的颜色方案。  
  
```  
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[in]*lpColorScheme*|指向[要添加的配色](http://msdn.microsoft.com/library/windows/desktop/bb775502)介绍突出显示颜色和阴影颜色的工具栏控件的结构。|  
  
### <a name="remarks"></a>备注  
 如果 Windows Vista 视觉主题设置，则此方法无效。  
  
 此方法将发送[TB_SETCOLORSCHEME](http://msdn.microsoft.com/library/windows/desktop/bb787421)消息，Windows SDK 中所述。  
  
### <a name="example"></a>示例  
 下面的代码示例设置为当前的工具栏控件的颜色方案。 代码示例将右侧和底部边缘和红色的每个工具按钮的左侧和顶部边缘蓝色。 当用户按下按钮时，按钮的红色边缘变为蓝色和其蓝色边缘变为红色。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]  
  
##  <a name="setdisabledimagelist"></a>  CToolBarCtrl::SetDisabledImageList  
 将工具栏控件将使用的图像列表设置为显示禁用按钮。  
  
```  
CImageList* SetDisabledImageList(CImageList* pImageList);
```  
  
### <a name="parameters"></a>参数  
 *pImageList*  
 一个指向`CImageList`对象，其中包含用于显示禁用按钮图像的工具栏控件的图像。  
  
### <a name="return-value"></a>返回值  
 一个指向[CImageList](../../mfc/reference/cimagelist-class.md)以前使用过显示禁用按钮图像的工具栏控件的对象。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETDISABLEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787423)，如 Windows SDK 中所述。 MFC 实现`SetDisabledImageList`使用`CImageList`对象，包含工具栏控件的禁用的按钮映像，而不是图像列表的句柄。  
  
##  <a name="setdrawtextflags"></a>  CToolBarCtrl::SetDrawTextFlags  
 Win32 函数中设置标志[DrawText](http://msdn.microsoft.com/library/windows/desktop/dd162498)，用于根据标志的设置方式设置格式的指定矩形中绘制文本。  
  
```  
DWORD SetDrawTextFlags(
    DWORD dwMask,  
    DWORD dwDTFlags);
```  
  
### <a name="parameters"></a>参数  
 *dwMask*  
 一个或多个 Win32 函数中指定的 DT_ 标志的组合[DrawText](http://msdn.microsoft.com/library/windows/desktop/dd162498)，，该值指示在这位*dwDTFlags*将绘制文本时使用。  
  
 *dwDTFlags*  
 一个或多个 Win32 函数中指定的 DT_ 标志的组合`DrawText`，指示将如何绘制按钮文本。 此值传递给`DrawText`时绘制按钮文本。  
  
### <a name="return-value"></a>返回值  
 包含上一个绘制的文本的 DWORD 标记。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETDRAWTEXTFLAGS](http://msdn.microsoft.com/library/windows/desktop/bb787425)，如 Windows SDK 中所述。 此成员函数的 Win32 函数中设置标志`DrawText`，它可根据标志的设置方式设置格式的指定矩形中绘制文本。  
  
##  <a name="setextendedstyle"></a>  CToolBarCtrl::SetExtendedStyle  
 设置工具栏控件的扩展的样式。  
  
```  
DWORD SetExtendedStyle(DWORD dwExStyle);
```  
  
### <a name="parameters"></a>参数  
 *dwExStyle*  
 指定新的扩展的样式的值。 此参数可以是工具栏扩展样式的组合。  
  
### <a name="return-value"></a>返回值  
 表示上一个扩展样式 DWORD。 有关样式的列表，请参阅[工具栏扩展样式](http://msdn.microsoft.com/library/windows/desktop/bb760430)，Windows SDK 中。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb787427)，如 Windows SDK 中所述。  
  
##  <a name="sethotimagelist"></a>  CToolBarCtrl::SetHotImageList  
 设置工具栏控件将显示"热"按钮的图像列表。  
  
```  
CImageList* SetHotImageList(CImageList* pImageList);
```  
  
### <a name="parameters"></a>参数  
 *pImageList*  
 一个指向`CImageList`对象，其中包含由工具栏控件用于显示热按钮图像的图像。  
  
### <a name="return-value"></a>返回值  
 一个指向[CImageList](../../mfc/reference/cimagelist-class.md)以前用由工具栏控件来显示热按钮图像的对象。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETHOTIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787429)，如 Windows SDK 中所述。  
  
 MFC 实现`SetHotImageList`使用`CImageList`对象，包含工具栏控件的热按钮映像，而不是图像列表的句柄。 当指针位于其上方时突出显示热按钮。  
  
##  <a name="sethotitem"></a>  CToolBarCtrl::SetHotItem  
 在工具栏中设置的热项。  
  
```  
int SetHotItem(int nHot);
```  
  
### <a name="parameters"></a>参数  
 *nHot*  
 将成为热项的从零开始的索引号。 如果此值为-1 的任何项目处于高温状态。  
  
### <a name="return-value"></a>返回值  
 上一热项，则为-1 如果没有任何热项的索引。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETHOTITEM](http://msdn.microsoft.com/library/windows/desktop/bb787431)，如 Windows SDK 中所述。  
  
##  <a name="setimagelist"></a>  CToolBarCtrl::SetImageList  
 设置工具栏将显示处于其默认状态的按钮的图像列表。  
  
```  
CImageList* SetImageList(CImageList* pImageList);
```  
  
### <a name="parameters"></a>参数  
 *pImageList*  
 一个指向`CImageList`对象，其中包含用于通过工具栏控件将在其默认状态中显示的按钮图像的图像。  
  
### <a name="return-value"></a>返回值  
 一个指向[CImageList](../../mfc/reference/cimagelist-class.md)以前用由工具栏控件来显示其默认状态的按钮的图像的对象。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787433)，如 Windows SDK 中所述。  
  
 MFC 实现`SetImageList`使用`CImageList`对象，包含工具栏控件的按钮映像，而不是图像列表的句柄。  
  
##  <a name="setindent"></a>  CToolBarCtrl::SetIndent  
 设置工具栏控件中的第一个按钮的缩进。  
  
```  
BOOL SetIndent(int iIndent);
```  
  
### <a name="parameters"></a>参数  
 *iIndent*  
 指定缩进，以像素为单位的值。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
##  <a name="setinsertmark"></a>  CToolBarCtrl::SetInsertMark  
 设置当前插入标记的工具栏。  
  
```  
void SetInsertMark(TBINSERTMARK* ptbim);
```  
  
### <a name="parameters"></a>参数  
 *ptbim*  
 一个指向[TBINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb760480)结构，其中包含插入标记。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb787437)，如 Windows SDK 中所述。  
  
##  <a name="setinsertmarkcolor"></a>  CToolBarCtrl::SetInsertMarkColor  
 设置用于绘制的工具栏插入标记的颜色。  
  
```  
COLORREF SetInsertMarkColor(COLORREF clrNew);
```  
  
### <a name="parameters"></a>参数  
 *clrNew*  
 一个包含新插入标记颜色的 COLORREF 值。  
  
### <a name="return-value"></a>返回值  
 一个 COLORREF 值，该值包含以前的插入标记颜色。  
  
### <a name="remarks"></a>备注  
 此成员函数可实现 Win32 消息的行为[TB_SETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb787439)，如 Windows SDK 中所述。  
  
##  <a name="setmaxtextrows"></a>  CToolBarCtrl::SetMaxTextRows  
 设置最大的工具栏按钮上显示的文本行数。  
  
```  
BOOL SetMaxTextRows(int iMaxRows);
```  
  
### <a name="parameters"></a>参数  
 *iMaxRows*  
 要设置的行的最大数目。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
##  <a name="setmetrics"></a>  CToolBarCtrl::SetMetrics  
 设置指标的`CToolBarCtrl`对象。  
  
```  
void SetMetrics(LPTBMETRICS ptbm);
```  
  
### <a name="parameters"></a>参数  
 *ptbm*  
 一个指向[TBMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb760482)的结构`CToolBarCtrl`对象。  
  
### <a name="remarks"></a>备注  
 此成员函数模拟的功能[TB_SETMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb787446)消息，如 Windows SDK 中所述。  
  
##  <a name="setowner"></a>  CToolBarCtrl::SetOwner  
 设置工具栏控件的所有者窗口。  
  
```  
void SetOwner(CWnd* pWnd);
```  
  
### <a name="parameters"></a>参数  
 *pWnd*  
 指向`CWnd`或`CWnd`-派生的对象将成为新的所有者窗口的工具栏控件。  
  
### <a name="remarks"></a>备注  
 所有者窗口处于从工具栏中接收通知的窗口。  
  
##  <a name="setpadding"></a>  CToolBarCtrl::SetPadding  
 设置当前的工具栏控件的水平和垂直填充。  
  
```  
DWORD SetPadding(
    int nHorzPadding,   
    int nVertPadding);
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[in]*nHorzPadding*|以像素为单位指定工具栏控件的水平的填充。|  
|[in]*nVertPadding*|以像素为单位指定工具栏控件的垂直的填充。|  
  
### <a name="return-value"></a>返回值  
 一个 dword 值，其低位字包含以前的水平填充值，而其高位字包含以前的垂直填充值。 以像素为单位测量的空白值。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_SETPADDING](http://msdn.microsoft.com/library/windows/desktop/bb787448)消息，Windows SDK 中所述。  
  
### <a name="example"></a>示例  
 下面的代码示例将当前的工具栏控件的水平和垂直填充设置为 20 像素。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]  
  
##  <a name="setpressedimagelist"></a>  CToolBarCtrl::SetPressedImageList  
 设置当前的工具栏控件使用以表示处于按下状态的按钮的图像列表。  
  
```  
CImagelist* SetPressedImageList(
    int iImageID,   
    CImageList* pImageList);
```  
  
### <a name="parameters"></a>参数  
  
|参数|描述|  
|---------------|-----------------|  
|[in]*iImageID*|图像列表的从零开始的索引。 如果使用只有一个图像列表，请将此参数设置为零。|  
|[in]*pImageList*|指向[CImageList](../../mfc/reference/cimagelist-class.md) ，其中包含新的映像列表。|  
  
### <a name="return-value"></a>返回值  
 指向[CImageList](../../mfc/reference/cimagelist-class.md)如果不设置了任何此类图像列表包含当前控件，则为 NULL 的上一个图像列表。  
  
### <a name="remarks"></a>备注  
 此方法将发送[TB_SETPRESSEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787453)消息，Windows SDK 中所述。  
  
### <a name="example"></a>示例  
 下面的代码示例设置要默认图像列表相同的按下的图像列表。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]  
  
##  <a name="setrows"></a>  CToolBarCtrl::SetRows  
 要求工具栏控件调整大小本身为请求的行数。  
  
```  
void SetRows(
    int nRows,  
    BOOL bLarger,  
    LPRECT lpRect);
```  
  
### <a name="parameters"></a>参数  
 *nRows*  
 请求的行数。  
  
 *bLarger*  
 指示是否使用更多的行或更少的行，如果不能将工具栏大小调整至请求的行数。  
  
 *lpRect*  
 指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)结构，它将接收工具栏的新边框。  
  
### <a name="remarks"></a>备注  
 如果工具栏不能调整自身大小为请求的数或行中，它将调整自身大小为下一个更大或下一个较小有效的大小，具体取决于值*bLarger*。 如果*bLarger*为 TRUE 时，新的行数将大于请求的数目。 如果*bLarger*为 FALSE 时，新的行数会小于请求的数目。  
  
 如果按钮可以排列的所有行具有相同数量的按钮 （除可能的最后一行），给定的数量的行是有效的工具栏。 例如，包含四个按钮的工具栏可以不进行大小调整为三行因为必须更短的时间的最后两行。 如果你尝试其大小设置为三个行，则会得到四行，如果*bLarger*如果是 TRUE，并且两个行*bLarger*是 FALSE。  
  
 如果在工具栏中分隔符，用于给定的数量的行时有效的规则是更复杂。 布局是计算出使按钮组 （带分隔符之前第一个按钮） 和最后一个按钮组中要永远不会断开，多个行上除非组无法容纳一行。  
  
 如果组不适合在一行上下, 一个组将启动在下一行中，即使它适合大型组结束的位置的行。 此规则旨在使更明显的大型组之间的分离。 生成的垂直分隔符将计为行。  
  
 另请注意，`SetRows`成员函数将始终选择最小的工具栏大小会导致的布局。 使用 TBSTYLE_WRAPABLE 创建工具栏样式和控件只需将应用上述方法然后大小调整给定控件的宽度。  
  
 仅可以为已使用 TBSTYLE_WRAPABLE 样式创建的工具栏中调用此函数。  
  
##  <a name="setstate"></a>  CToolBarCtrl::SetState  
 在工具栏控件中设置指定的按钮的状态。  
  
```  
BOOL SetState(
    int nID,  
    UINT nState);
```  
  
### <a name="parameters"></a>参数  
 *nID*  
 按钮的命令标识符。  
  
 *nState*  
 状态标志。 它可以是下列按钮状态的值的组合[CToolBarCtrl::AddButtons](#addbuttons)。  
  
### <a name="return-value"></a>返回值  
 如果成功，则不为零，否则为零。  
  
### <a name="remarks"></a>备注  
 此函数是如果你想要设置多个按钮状态之一时尤为方便。 若要只需设置一个状态，使用以下成员函数之一： [EnableButton](#enablebutton)， [CheckButton](#checkbutton)， [HideButton](#hidebutton)，[不确定](#indeterminate)，或[PressButton](#pressbutton)。  
  
##  <a name="setstyle"></a>  CToolBarCtrl::SetStyle  
 设置工具栏控件的样式。  
  
```  
void SetStyle(DWORD dwStyle);
```  
  
### <a name="parameters"></a>参数  
 *dwStyle*  
 一个 dword 值，其中包含组成[工具栏控件样式](http://msdn.microsoft.com/library/windows/desktop/bb760439)，如 Windows SDK 中所述。  
  
##  <a name="settooltips"></a>  CToolBarCtrl::SetToolTips  
 将工具提示控件与工具栏控件相关联。  
  
```  
void SetToolTips(CToolTipCtrl* pTip);
```  
  
### <a name="parameters"></a>参数  
 *pTip*  
 指向[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)对象。  
  
##  <a name="setwindowtheme"></a>  CToolBarCtrl::SetWindowTheme  
 设置的视觉样式`CToolBarCtrl`对象。  
  
```  
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```  
  
### <a name="parameters"></a>参数  
 *pszSubAppName*  
 指向包含工具栏视觉样式设置的 Unicode 字符串的指针。  
  
### <a name="return-value"></a>返回值  
 不使用返回的值。  
  
### <a name="remarks"></a>备注  
 此成员函数模拟的功能[TB_SETWINDOWTHEME](http://msdn.microsoft.com/library/windows/desktop/bb787465)消息，如 Windows SDK 中所述。  
  
## <a name="see-also"></a>请参阅  
 [MFC 示例 CMNCTRL1](../../visual-cpp-samples.md)   
 [MFC 示例 MFCIE](../../visual-cpp-samples.md)   
 [CWnd 类](../../mfc/reference/cwnd-class.md)   
 [层次结构图表](../../mfc/hierarchy-chart.md)   
 [CToolBar 类](../../mfc/reference/ctoolbar-class.md)
