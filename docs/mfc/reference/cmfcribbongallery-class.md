---
title: CMFCRibbonGallery 类
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: f1ef68cba0012ad5b5d0eb6d3322acc6a1c6555c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375154"
---
# <a name="cmfcribbongallery-class"></a>CMFCRibbonGallery 类

实现 Office 2007 样式功能区库。
有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```cpp
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CMFC功能画廊：CMFC剪彩画廊](#cmfcribbongallery)|构造并初始化一个 `CMFCRibbonGallery` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFC功能库：添加组](#addgroup)|向库添加新组。|
|[CMFC 功能库：：添加子项](#addsubitem)|将新的菜单项添加到下拉菜单。|
|[CMFC功能放大缩小字体功能 放大缩小字体功能](#clear)|清除库的内容。|
|[CMFC 功能库：：启用菜单重新大小](#enablemenuresize)|启用或禁用调整菜单面板的大小。|
|[CMFC功能库：启用菜单边栏](#enablemenusidebar)|启用或禁用弹出菜单左侧的侧栏。|
|[CMFC 功能库：获取压缩尺寸](#getcompactsize)|（覆盖[CMFC 功能按钮：获取压缩大小](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize).）|
|[CMFC功能库：获取向下](#getdroppeddown)|（覆盖[CMFC 功能基础元素：：获取向下](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown). ）|
|[CMFC 功能库：获取组名](#getgroupname)|返回位于指定索引的组的名称。|
|[CMFC 功能库：获取集团偏移](#getgroupoffset)||
|[CMFC功能库：获取图标](#geticonsinrow)|返回功能区库行中的项目数。|
|[CMFC 功能库：：获取项目工具提示](#getitemtooltip)|返回与库中项目关联的工具提示文本。|
|[CMFC 功能库：获取最后选择项目](#getlastselecteditem)|返回用户选择的库中最后一个项目的索引。|
|[CMFC功能库：获取PaletteID](#getpaletteid)|返回当前库的命令 ID。|
|[CMFC 功能库：获取常规大小](#getregularsize)|（覆盖[CMFC 功能按钮：获取常规大小](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize).）|
|[CMFC功能库：获取选定项目](#getselecteditem)||
|[CMFC功能库：哈斯梅因](#hasmenu)|（覆盖[CMFC 功能按钮：：哈斯梅因](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu).）|
|[CMFC功能库：：正按钮模式](#isbuttonmode)|指定库是否包含在库按钮中。|
|[CMFC 功能库：已启用"已启用"菜单](#ismenuresizeenabled)|指定是启用还是禁用菜单调整大小。|
|[CMFC 功能库：：正选垂直](#ismenuresizevertical)||
|[CMFC功能库：isMenusideBar](#ismenusidebar)|指定侧栏是启用还是禁用。|
|[CMFC 功能库：在转换后](#onafterchangerect)|（重写 `CMFCRibbonButton::OnAfterChangeRect`。）|
|[CMFC功能画廊：OnDraw](#ondraw)|（覆盖[CMFC 功能按钮：onDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw).）|
|[CMFC功能库：启用](#onenable)|（重写 `CMFCRibbonBaseElement::OnEnable`。）|
|[CMFC 功能库：：打开](#onrtlchanged)|（覆盖[CMFC 功能基础元素：OnRTL 已更改](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged).）|
|[CMFC功能库：重绘图标](#redrawicons)|重绘图库。|
|[CMFC 功能库：：删除项目工具提示](#removeitemtooltips)|从库中的所有项目中删除工具提示。|
|[CMFC 功能库：选择项目](#selectitem)||
|[CMFC功能库：：设置ACC数据](#setaccdata)|（覆盖[CMFC 功能按钮：设置ACC数据](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata).）|
|[CMFC 功能库：：设置按钮模式](#setbuttonmode)|指定是将功能区库显示为下拉按钮还是直接在功能区上作为调色板显示。|
|[CMFC 功能库：：组名](#setgroupname)|设置组的名称。|
|[CMFC功能库：setIconsinrow](#seticonsinrow)|定义库中每行的项目数。|
|[CMFC 功能库：：设置项目工具提示](#setitemtooltip)|设置库中项目的工具提示文本。|
|[CMFC功能库：：设置调色板](#setpalette)|将调色板附加到功能区库。|
|[CMFC功能库：：设置调色板ID](#setpaletteid)|定义在选择库项时在WM_COMMAND消息中发送的命令 ID。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CMFC功能库：在DrawPaletteIcon](#ondrawpaletteicon)|绘制库图标时由框架调用。|

## <a name="remarks"></a>备注

库按钮的功能与常规菜单按钮类似，只不过当用户打开库时，它将显示它。 当您在库中选择项目时，框架会将WM_COMMAND消息与按钮的命令 ID 一起发送。 处理邮件时，应调用[CMFCRibbonGallery：getLast选择项目](#getlastselecteditem)，以确定从库中选择了哪个项目。

## <a name="example"></a>示例

下面的示例演示如何在`CMFCRibbonGallery`类中使用各种方法来配置`CMFCRibbonGallery`对象。 该示例演示如何在库中指定每行项目数、启用菜单面板大小、启用弹出式菜单左侧的侧栏以及直接在功能区栏上作为调色板显示功能区库。 此代码片段属于 [Draw Client 示例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)\
•&nbsp;[CMFC功能基础元素](../../mfc/reference/cmfcribbonbaseelement-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;[CMFC功能按钮](../../mfc/reference/cmfcribbonbutton-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;[CMFC剪彩画廊](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>要求

**标题：** afxRibbonPaletteGallery.h

## <a name="cmfcribbongalleryaddgroup"></a><a name="addgroup"></a>CMFC功能库：添加组

向库添加新组。

```cpp
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>参数

*lpszGroup名称*<br/>
[在]指定组的名称。

*uiImagesPaletteResID*<br/>
[在]指定包含组图像的图像列表的资源 ID。

*cxPalette图像*<br/>
[在]指定图像的宽度（以像素为单位）。

*图片组*<br/>
[在]对包含组图像的图像列表的引用。

*n图标Num*<br/>
[在]指定组中的图标数。 此参数应仅为自定义（绘制的所有者）组指定。

### <a name="remarks"></a>备注

通过调用此方法，可以将功能区库中的项目划分为多个组。 每个组可以有一个标题。

## <a name="cmfcribbongalleryaddsubitem"></a><a name="addsubitem"></a>CMFC 功能库：：添加子项

将新的菜单项添加到下拉菜单。

```cpp
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>参数

*p 子项目*<br/>
[在]要添加到菜单的项的指针。

*nIndex*<br/>
[在]指定要插入项目的位置的零基索引。

*蓬托普*<br/>
[在]TRUE 指定应在功能区库之前插入项目;如果为 TRUE，请指定项目应插入到功能区库之前。否则，FALSE。

### <a name="remarks"></a>备注

您可以通过调用此方法将弹出式图库与弹出式菜单项组合。 菜单项可以放置在库之前或之后。

若要在库之前插入项目，请将*bonTop*设置为 TRUE。 将 *"bonTop"* 设置为 FALSE 以将项目插入库下方。

> [!NOTE]
> 参数*nIndex*在库顶部和库底部指定插入索引。 例如，如果需要在库之前插入项目 1 个位置，请将*nIndex*设置为*1，将 bonTop*设置为 TRUE。 同样，如果需要在库下方插入项目 1 个位置，请将*nIndex*设置为*1，将 bonTop*设置为 FALSE。

## <a name="cmfcribbongalleryclear"></a><a name="clear"></a>CMFC功能放大缩小字体功能 放大缩小字体功能

清除库的内容。

```cpp
virtual void Clear();
```

### <a name="remarks"></a>备注

调用此方法从功能区库中删除所有内容。 在将新的功能区库或组集附加到功能区库之前，必须完成此操作。

## <a name="cmfcribbongallerycmfcribbongallery"></a><a name="cmfcribbongallery"></a>CMFC功能画廊：CMFC剪彩画廊

构造并初始化[CMFC 功能区库](../../mfc/reference/cmfcribbongallery-class.md)对象。

```cpp
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>参数

*nID*<br/>
指定在用户单击按钮时要执行的命令 ID。

*lpszText*<br/>
指定要显示在按钮上的文本。

*n 小图像索引*<br/>
要显示在按钮上的小图像的零基索引。

*nLargeImageIndex*<br/>
要显示在按钮上的大图像的零基索引。

*图像调色板*<br/>
对包含要显示在库中的图像的[CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)对象的引用。

*uiImagesPaletteResID*<br/>
要在库中显示的图像列表的资源 ID。

*cxPalette图像*<br/>
指定库中图像的宽度（以像素为单位）。

*大小图标*<br/>
指定库图像的大小（以像素为单位）。

*n图标Num*<br/>
指定库中的图标数。

*b默认按钮样式*<br/>
指定是使用默认按钮样式还是所有者绘制的按钮样式。

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryenablemenuresize"></a><a name="enablemenuresize"></a>CMFC 功能库：：启用菜单重新大小

启用或禁用调整菜单面板的大小。

```cpp
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 以启用调整菜单大小;否则，FALSE。

*bVertcal*<br/>
[在]TRUE 指定库只能垂直调整大小;FALSE 指定库可以垂直和水平调整大小。

### <a name="remarks"></a>备注

使用此方法启用或禁用调整功能区库大小。 启用调整大小时，功能区库将显示一个抓手，用户可以用它来调整其大小。

## <a name="cmfcribbongalleryenablemenusidebar"></a><a name="enablemenusidebar"></a>CMFC功能库：启用菜单边栏

启用或禁用弹出菜单左侧的侧栏。

```cpp
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 以指定已启用侧栏;否则，FALSE。

### <a name="remarks"></a>备注

调用此方法以启用或禁用菜单左侧的 Office XP 样式侧栏。

## <a name="cmfcribbongallerygetcompactsize"></a><a name="getcompactsize"></a>CMFC 功能库：获取压缩尺寸

```cpp
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetdroppeddown"></a><a name="getdroppeddown"></a>CMFC功能库：获取向下

```cpp
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetgroupname"></a><a name="getgroupname"></a>CMFC 功能库：获取组名

返回位于指定索引的组的名称。

```cpp
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>参数

*n组索引*<br/>
[在]指定要检索其名称的组的零基索引。

### <a name="return-value"></a>返回值

位于指定索引的组的名称。 传递无效的索引将导致断言失败。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetgroupoffset"></a><a name="getgroupoffset"></a>CMFC 功能库：获取集团偏移

```cpp
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygeticonsinrow"></a><a name="geticonsinrow"></a>CMFC功能库：获取图标

返回功能区库行中的项目数。

```cpp
int GetIconsInRow() const;
```

### <a name="return-value"></a>返回值

行中的项数。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetitemtooltip"></a><a name="getitemtooltip"></a>CMFC 功能库：：获取项目工具提示

返回与库中项目关联的工具提示文本。

```cpp
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>参数

*n项目索引*<br/>
[在]指定要为其检索工具提示文本的项的零基索引。

### <a name="return-value"></a>返回值

指向分配给功能区库中项目的工具提示字符串的指针。 如果未向该项目分配工具提示，则它可以为 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetlastselecteditem"></a><a name="getlastselecteditem"></a>CMFC 功能库：获取最后选择项目

返回用户选择的功能区库中最后一个项目的索引。

```cpp
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>参数

*乌伊CmdID*<br/>
[在]指定打开功能区库的菜单项的命令 ID。

### <a name="return-value"></a>返回值

当用户选择功能区库中的任何项目时，库将发送WM_COMMAND消息以及打开功能区库的菜单按钮的命令 ID。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetpaletteid"></a><a name="getpaletteid"></a>CMFC功能库：获取PaletteID

返回当前调色板的命令 ID。

```cpp
int GetPaletteID() const;
```

### <a name="return-value"></a>返回值

当前所选调色板的命令 ID。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetregularsize"></a><a name="getregularsize"></a>CMFC 功能库：获取常规大小

```cpp
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerygetselecteditem"></a><a name="getselecteditem"></a>CMFC功能库：获取选定项目

```cpp
int GetSelectedItem() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryhasmenu"></a><a name="hasmenu"></a>CMFC功能库：哈斯梅因

```cpp
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryisbuttonmode"></a><a name="isbuttonmode"></a>CMFC功能库：：正按钮模式

指定调色板是否包含在库按钮中。

```cpp
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>返回值

如果调色板显示为下拉菜单按钮，则为 TRUE;如果调色板显示为下拉菜单按钮，则为 TRUE。如果调色板直接显示在功能区上，则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryismenuresizeenabled"></a><a name="ismenuresizeenabled"></a>CMFC 功能库：已启用"已启用"菜单

指定是否启用了菜单调整大小。

```cpp
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>返回值

如果已启用菜单调整大小，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryismenuresizevertical"></a><a name="ismenuresizevertical"></a>CMFC 功能库：：正选垂直

```cpp
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryismenusidebar"></a><a name="ismenusidebar"></a>CMFC功能库：isMenusideBar

指定侧栏是启用还是禁用。

```cpp
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>返回值

如果 Office XP 风格的侧栏在弹出式菜单的左侧绘制，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryonafterchangerect"></a><a name="onafterchangerect"></a>CMFC 功能库：在转换后

```cpp
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryondraw"></a><a name="ondraw"></a>CMFC功能画廊：OnDraw

```cpp
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>参数

[在]*pDC*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryondrawpaletteicon"></a><a name="ondrawpaletteicon"></a>CMFC功能库：在DrawPaletteIcon

绘制库图标时由框架调用。

```cpp
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向用于绘图的设备上下文的指针。

*整形图标*<br/>
[在]指定要绘制的图标的边界矩形。

*nIconIndex*<br/>
[在]指定要绘制的图标的图库图标的图像列表中的零基索引。

*pIcon*<br/>
[在]指向正在绘制的图标的指针。

*clrText*<br/>
[在]指定要绘制的项文本的颜色。

### <a name="remarks"></a>备注

可以在派生类中重写此方法，以自定义功能区库的外观。

## <a name="cmfcribbongalleryonenable"></a><a name="onenable"></a>CMFC功能库：启用

```cpp
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>参数

[在]*b 启用*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryonrtlchanged"></a><a name="onrtlchanged"></a>CMFC 功能库：：打开

```cpp
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>参数

[在]*比塞尔*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryredrawicons"></a><a name="redrawicons"></a>CMFC功能库：重绘图标

重绘图库。

```cpp
void RedrawIcons();
```

### <a name="remarks"></a>备注

调用此函数以重绘库。 如果在运行时更改了库的内容，则必须调用此方法。

## <a name="cmfcribbongalleryremoveitemtooltips"></a><a name="removeitemtooltips"></a>CMFC 功能库：：删除项目工具提示

从库中的所有项目中删除工具提示。

```cpp
void RemoveItemToolTips();
```

### <a name="remarks"></a>备注

## <a name="cmfcribbongalleryselectitem"></a><a name="selectitem"></a>CMFC 功能库：选择项目

```cpp
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>参数

[在]*n项目索引*<br/>

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerysetaccdata"></a><a name="setaccdata"></a>CMFC功能库：：设置ACC数据

使用功能区库中的可访问性数据填充指定的 `CAccessibilityData` 对象。

```cpp
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>参数

*p 父级*<br/>
[在]功能区库窗口的父窗口。

*数据*<br/>
[出]从`CAccessibilityData`功能区库接收辅助功能数据的对象。

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

如果方法成功，则为 TRUE;否则，FALSE。

## <a name="cmfcribbongallerysetbuttonmode"></a><a name="setbuttonmode"></a>CMFC 功能库：：设置按钮模式

确定是将功能区库显示为下拉按钮还是直接在功能区上作为调色板显示。

```cpp
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>参数

*bSet*<br/>
[在]TRUE 将功能区库显示为下拉菜单按钮;FALSE 直接显示在功能区上功能区库的内容。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerysetgroupname"></a><a name="setgroupname"></a>CMFC 功能库：：组名

设置组的名称。

```cpp
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>参数

*n组索引*<br/>
[在]指定要为其更改名称的组的从零开始索引。

*lpszGroup名称*<br/>
[在]指定组的新名称。

### <a name="remarks"></a>备注

必须使用[CMFC 功能区库：：addGroup](#addgroup)方法添加其名称的组。

## <a name="cmfcribbongalleryseticonsinrow"></a><a name="seticonsinrow"></a>CMFC功能库：setIconsinrow

指定库中每行的项目数。

```cpp
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>参数

*内辛内罗*<br/>
[在]指定要在库的每一行中显示的项目数。

### <a name="remarks"></a>备注

使用此方法指定功能区库的宽度。

## <a name="cmfcribbongallerysetitemtooltip"></a><a name="setitemtooltip"></a>CMFC 功能库：：设置项目工具提示

设置库中项目的工具提示文本。

```cpp
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>参数

*n项目索引*<br/>
[在]要与哪个选项关联的调色板项的零基索引。

*lpszToolTip*<br/>
[在]要显示在工具提示上的文本。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerysetpalette"></a><a name="setpalette"></a>CMFC功能库：：设置调色板

将调色板附加到功能区库。

```cpp
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>参数

*图像调色板*<br/>
[在]指定包含要显示在库中的图标的图像列表。

*uiImagesPaletteResID*<br/>
[在]指定包含要显示在库中的图标的图像列表的资源 ID。

*cxPalette图像*<br/>
[在]指定库中图像的宽度（以像素为单位）。

### <a name="remarks"></a>备注

## <a name="cmfcribbongallerysetpaletteid"></a><a name="setpaletteid"></a>CMFC功能库：：设置调色板ID

定义用户选择库项时在WM_COMMAND消息中发送的命令 ID。

```cpp
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>参数

*nID*<br/>
[在]指定用户选择库项时在WM_COMMAND消息中发送的命令 ID。

### <a name="remarks"></a>备注

要确定用户从库中选择的特定项，请调用[CMFC 功能区库：：GetLast选择项目](#getlastselecteditem)静态方法。

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFC 功能按钮类](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[CMFC功能放大缩小字体功能 放大缩小字体功能](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
