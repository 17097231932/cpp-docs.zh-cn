---
title: COleClientItem 类
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: c880b1fb724b533bb049666460948c6df661a03c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376286"
---
# <a name="coleclientitem-class"></a>COleClientItem 类

定义 OLE 项的容器接口。

## <a name="syntax"></a>语法

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[COleClient项目：COleClient项目](#coleclientitem)|构造 `COleClientItem` 对象。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[COleClient项目：激活](#activate)|打开操作的 OLE 项，然后执行指定的谓词。|
|[COleClient项目：激活As](#activateas)|将该项目激活为另一种类型。|
|[COleClient项目：附加数据对象](#attachdataobject)|访问 OLE 对象中的数据。|
|[COleClient项目：可以从数据创建](#cancreatefromdata)|指示容器应用程序是否可以创建嵌入对象。|
|[COleClient项目：可以从数据创建链接](#cancreatelinkfromdata)|指示容器应用程序是否可以创建链接对象。|
|[COleClient项目：可以粘贴](#canpaste)|指示剪贴板是否包含可嵌入或静态 OLE 项目。|
|[COleClient项目：：可以粘贴链接](#canpastelink)|指示剪贴板是否包含可链接的 OLE 项目。|
|[COleClient项目：关闭](#close)|关闭指向服务器的链接，但不会销毁 OLE 项。|
|[COleClient项目：转换到](#convertto)|将项目转换为其他类型。|
|[COleClient项目：：复制到剪贴板](#copytoclipboard)|将 OLE 项目复制到剪贴板。|
|[COleClient项目：从创建克隆](#createclonefrom)|创建现有项的重复项。|
|[COleClient项目：从剪贴板创建](#createfromclipboard)|从剪贴板创建嵌入的项目。|
|[COleClient项目：从数据创建](#createfromdata)|从数据对象创建嵌入项。|
|[COleClient项目：从文件创建](#createfromfile)|从文件创建嵌入的项。|
|[COleClient项目：从剪贴板创建链接](#createlinkfromclipboard)|从剪贴板创建链接项目。|
|[COleClient项目：从数据创建链接](#createlinkfromdata)|从数据对象创建链接项。|
|[COleClient项目：从文件创建链接](#createlinkfromfile)|从文件创建链接项。|
|[COleClient项目：创建新项目](#createnewitem)|通过启动服务器应用程序创建新的嵌入项。|
|[COleClient项目：从剪贴板创建静态](#createstaticfromclipboard)|从剪贴板创建静态项目。|
|[COleClient项目：从数据创建静态](#createstaticfromdata)|从数据对象创建静态项。|
|[COleClient项目：:D激活](#deactivate)|停用该项目。|
|[COleClient项目：:D激活UI](#deactivateui)|将容器应用程序的用户界面还原到其原始状态。|
|[COleClient项目：:Delete](#delete)|如果 OLE 项是链接项，则删除或关闭该项目。|
|[COleClient项目：:DoDragDrop](#dodragdrop)|执行拖放操作。|
|[COleClient项目：:DoVerb](#doverb)|执行指定的谓词。|
|[COleClient项目：:D生](#draw)|绘制 OLE 项。|
|[COleClient项目：获取活动视图](#getactiveview)|获取在位处激活项目的视图。|
|[COleClient项目：获取缓存范围](#getcachedextent)|返回 OLE 项矩形的边界。|
|[COleClient项目：获取类ID](#getclassid)|获取当前项的类 ID。|
|[COleClient项目：获取剪贴板数据](#getclipboarddata)|通过调用`CopyToClipboard`成员函数获取将放置在剪贴板上的数据。|
|[COleClient项目：获取文档](#getdocument)|返回包含`COleDocument`当前项的对象。|
|[COleClient项目：获取绘制方面](#getdrawaspect)|获取项的当前视图以进行渲染。|
|[COleClient项目：获取范围](#getextent)|返回 OLE 项矩形的边界。|
|[COleClient项目：从注册处获取图标](#geticonfromregistry)|检索与特定 CLSID 服务器关联的图标的句柄。|
|[COleClient项目：获取图标Meta文件](#geticonicmetafile)|获取用于绘制项目图标的元文件。|
|[COleClient项目：获取位置窗口](#getinplacewindow)|返回指向项目就地编辑窗口的指针。|
|[COleClient项目：获取项目状态](#getitemstate)|获取项的当前状态。|
|[COleClient项目：获取"状态"](#getlaststatus)|返回最后一个 OLE 操作的状态。|
|[COleClient项目：获取链接更新选项](#getlinkupdateoptions)|返回链接项（高级功能）的更新模式。|
|[COleClient项目：获取类型](#gettype)|返回 OLE 项的类型（嵌入、链接或静态）。|
|[COleClient项目：获取用户类型](#getusertype)|获取描述项类型的字符串。|
|[COleClient项目：在原位激活](#isinplaceactive)|如果项目处于活动位置，则返回 TRUE。|
|[COleClient项目：islinkup到日期](#islinkuptodate)|如果链接的项与其源文档是最新的，则返回 TRUE。|
|[COleClient项目：已修改](#ismodified)|如果项目自上次保存以来已被修改，则返回 TRUE。|
|[COleClient项目：是打开的](#isopen)|如果项目当前在服务器应用程序中打开，则返回 TRUE。|
|[COleClient项目：正在运行](#isrunning)|如果项目的服务器应用程序正在运行，则返回 TRUE。|
|[COleClient项目：打开激活](#onactivate)|由框架调用，以通知项目已激活。|
|[COleClient项目：在激活 UI 上](#onactivateui)|由框架调用，以通知项目已激活，并应显示其用户界面。|
|[COleClient项目：打开更改](#onchange)|当服务器更改 OLE 项时调用。 需要实施。|
|[COleClient项目：打开激活](#ondeactivate)|当项目停用时由框架调用。|
|[COleClient项目：打开停用UI](#ondeactivateui)|当服务器删除其就地用户界面时，由框架调用。|
|[COleClient项目：在获取剪贴板数据](#ongetclipboarddata)|由框架调用，以将数据复制到剪贴板。|
|[COleClient项目：在插入菜单上](#oninsertmenus)|由框架调用以创建复合菜单。|
|[COleClient项目：打开删除菜单](#onremovemenus)|由框架调用，从复合菜单中删除容器的菜单。|
|[COleClient项目：打开菜单](#onsetmenu)|由框架调用以安装和删除复合菜单。|
|[COleClient项目：在显示控制栏](#onshowcontrolbars)|由框架调用以显示和隐藏控制栏。|
|[COleClient项目：更新帧标题](#onupdateframetitle)|由框架调用以更新框架窗口的标题栏。|
|[COleClient项目：重新激活和Undo](#reactivateandundo)|重新激活项目并撤消最后一个就地编辑操作。|
|[COleClient项目：发布](#release)|释放与 OLE 链接项的连接，并在打开时关闭它。 不销毁客户端项。|
|[COleClient项目：重新加载](#reload)|调用 后重新加载项`ActivateAs`。|
|[COleClient项目：运行](#run)|运行与项关联的应用程序。|
|[COleClient项目：：设置绘制方面](#setdrawaspect)|设置项目的当前视图以进行渲染。|
|[COleClient项目：设置范围](#setextent)|设置 OLE 项的边界矩形。|
|[COleClient项目：设置主机名](#sethostnames)|设置服务器在编辑 OLE 项时显示的名称。|
|[COleClient项目：：设置图标元文件](#seticonicmetafile)|缓存用于绘制项目图标的元文件。|
|[COleClient项目：设置项目已重](#setitemrects)|设置项的边界矩形。|
|[COleClient项目：设置链接更新选项](#setlinkupdateoptions)|设置链接项（高级功能）的更新模式。|
|[COleClient项目：设置打印设备](#setprintdevice)|设置此客户端项的打印目标设备。|
|[COleClient项目：更新链接](#updatelink)|更新项目的演示文稿缓存。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[COleClient项目：可以激活](#canactivate)|由框架调用以确定是否允许就地激活。|
|[COleClient项目：在更改项目位置上](#onchangeitemposition)|当项目的位置发生变化时，由框架调用。|
|[COleClient项目：ondededeandundo](#ondeactivateandundo)|由框架调用以在激活后撤消。|
|[COleClient项目：在放弃Undostate](#ondiscardundostate)|由框架调用以丢弃项目的撤消状态信息。|
|[COleClient项目：ongetCliprect](#ongetcliprect)|由框架调用以获取项目的裁剪矩形坐标。|
|[COleClient项目：在获取项目位置](#ongetitemposition)|由框架调用，以获取有关视图的项目的位置。|
|[COleClient项目：打开窗口上下文](#ongetwindowcontext)|当项目就地激活时，由框架调用。|
|[COleClient项目：OnScrollby](#onscrollby)|由框架调用以将项目滚动到视图中。|
|[COleClient项目：在显示项目](#onshowitem)|由框架调用以显示 OLE 项。|

## <a name="remarks"></a>备注

OLE 项表示由服务器应用程序创建和维护的数据，这些数据可以"无缝"合并到文档中，以便用户看起来是单个文档。 结果是由 OLE 项目和包含文档组成的"复合文档"。

OLE 项可以嵌入或链接。 如果它被嵌入，则其数据将作为复合文档的一部分存储。 如果链接，其数据将作为服务器应用程序创建的单独文件的一部分存储，并且复合文档中仅存储指向该文件的链接。 所有 OLE 项都包含指定应调用以编辑它们的服务器应用程序的信息。

`COleClientItem`定义响应来自服务器应用程序的请求调用的几个可重写函数;这些不可重写通常充当通知。 这允许服务器应用程序通知容器用户在编辑 OLE 项时所做的更改，或者检索编辑过程中所需的信息。

`COleClientItem`可与[COleDocument、COle](../../mfc/reference/coledocument-class.md)[链接文档](../../mfc/reference/colelinkingdoc-class.md)或[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)类一起使用。 要使用`COleClientItem`派生类并实现[OnChange](#onchange)成员函数，该函数定义容器如何响应对项所做的更改。 要支持就地激活，要覆盖[OnGetItem位置](#ongetitemposition)成员函数。 此功能提供有关 OLE 项的显示位置的信息。

有关使用容器接口的详细信息，请参阅文章[容器：实现容器](../../mfc/containers-implementing-a-container.md)和[激活](../../mfc/activation-cpp.md)。

> [!NOTE]
> Windows SDK 将嵌入和链接的项目称为"对象"，并将项类型称为"类"。 此引用使用术语"item"来区分 OLE 实体与相应的C++对象和术语"类型"来区分 OLE 类别与 C++ 类。

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>要求

**标题：** afxole.h

## <a name="coleclientitemactivate"></a><a name="activate"></a>COleClient项目：激活

调用此函数以执行指定的谓词而不是[DoVerb，](#doverb)以便在引发异常时执行自己的处理。

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>参数

*nVerb*<br/>
指定要执行的谓词。 该参数可以是下列值之一：

|“值”|含义|符号|
|-----------|-------------|------------|
|- 0|主谓词|OLEIVERB_PRIMARY|
|- 1|次要动词|（无）|
|- 1|显示要编辑的项目|OLEIVERB_SHOW|
|- 2|在单独的窗口中编辑项目|OLEIVERB_OPEN|
|- 3|隐藏项目|OLEIVERB_HIDE|

-1 值通常是另一个谓词的别名。 如果不支持打开编辑，-2 的效果与 -1 相同。 有关其他值，请参阅 Windows SDK 中的[IOleObject：:DoVerb。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

*pView*<br/>
指向包含 OLE 项的容器视图窗口;服务器应用程序使用此激活进行就地激活。 如果容器不支持就地激活，则此参数应为 NULL。

*lpMsg*<br/>
指向导致项目被激活的消息的指针。

### <a name="remarks"></a>备注

如果服务器应用程序是使用 Microsoft 基础类库编写的，则此函数会导致执行相应`COleServerItem`对象的[OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb)成员函数。

如果主谓词为"编辑"，*并在 nVerb*参数中指定零，则启动服务器应用程序以允许编辑 OLE 项。 如果容器应用程序支持就地激活，则可以就地进行编辑。 如果容器不支持就地激活（或者指定了 Open 谓词），则服务器将在单独的窗口中启动，并可以在那里进行编辑。 通常，当容器应用程序的用户双击 OLE 项时 *，nVerb*参数中主谓词的值将确定用户可以执行的操作。 但是，如果服务器仅支持一个操作，则无论*nVerb*参数中指定哪个值，它都执行该操作。

有关详细信息，请参阅 Windows SDK 中的[IOleObject：:DoVerb。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

## <a name="coleclientitemactivateas"></a><a name="activateas"></a>COleClient项目：激活As

使用 OLE 的对象转换工具来激活该项目，就好像它是*clsidNew*指定的类型的项一样。

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>参数

*lpszUser 类型*<br/>
指向表示目标用户类型的字符串的指针，如"Word 文档"。

*克西德德*<br/>
对项当前类 ID 的引用。 类 ID 应表示存储的实际对象的类型，除非它是链接。 在这种情况下，它应该是链接引用的项的 CLSID。 [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)会自动为该项目提供正确的类标识。

*克西德新*<br/>
对目标类 ID 的引用。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

这是自动调用[COleConvertDialog：:DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)。 它通常不直接调用。

## <a name="coleclientitemattachdataobject"></a><a name="attachdataobject"></a>COleClient项目：附加数据对象

调用此函数以初始化[COleDataObject](../../mfc/reference/coledataobject-class.md)以访问 OLE 项目中的数据。

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>参数

*rDataObject*<br/>
引用将初始`COleDataObject`化以允许访问 OLE 项中的数据的对象。

## <a name="coleclientitemcanactivate"></a><a name="canactivate"></a>COleClient项目：可以激活

当用户请求就地激活 OLE 项时，由框架调用;此函数的返回值确定是否允许就地激活。

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>返回值

如果允许就地激活，则非零;否则 0。

### <a name="remarks"></a>备注

如果容器具有有效的窗口，则默认实现允许就地激活。 重写此函数以实现接受或拒绝激活请求的特殊逻辑。 例如，如果 OLE 项太小或当前不可见，则可以拒绝激活请求。

有关详细信息，请参阅[IOleInPlace 网站：可在](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate)Windows SDK 中激活。

## <a name="coleclientitemcancreatefromdata"></a><a name="cancreatefromdata"></a>COleClient项目：可以从数据创建

检查容器应用程序是否可以从给定`COleDataObject`对象创建嵌入对象。

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject 对象](../../mfc/reference/coledataobject-class.md)。

### <a name="return-value"></a>返回值

如果容器可以从`COleDataObject`对象创建嵌入对象，则非零;否则 0。

### <a name="remarks"></a>备注

该`COleDataObject`类用于数据传输，用于从剪贴板、拖放或从嵌入 OLE 项检索各种格式的数据。

容器可以使用此函数决定启用或禁用其编辑粘贴和编辑粘贴特殊命令。

有关详细信息，请参阅文章["数据对象和数据源 "（OLE）](../../mfc/data-objects-and-data-sources-ole.md)"。

## <a name="coleclientitemcancreatelinkfromdata"></a><a name="cancreatelinkfromdata"></a>COleClient项目：可以从数据创建链接

检查容器应用程序是否可以从给定`COleDataObject`对象创建链接对象。

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject 对象](../../mfc/reference/coledataobject-class.md)。

### <a name="return-value"></a>返回值

如果容器可以从`COleDataObject`对象创建链接对象，则非零。

### <a name="remarks"></a>备注

该`COleDataObject`类用于数据传输，用于从剪贴板、拖放或从嵌入 OLE 项检索各种格式的数据。

容器可以使用此函数决定启用或禁用其编辑粘贴特殊和编辑粘贴链接命令。

有关详细信息，请参阅文章["数据对象和数据源 "（OLE）](../../mfc/data-objects-and-data-sources-ole.md)"。

## <a name="coleclientitemcanpaste"></a><a name="canpaste"></a>COleClient项目：可以粘贴

调用此函数以查看是否可以从剪贴板粘贴嵌入的 OLE 项。

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>返回值

如果可以从剪贴板粘贴嵌入的 OLE 项目，则非零;否则 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅 Windows SDK 中的[OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard)和[OleQuery 创建从数据](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata)。

## <a name="coleclientitemcanpastelink"></a><a name="canpastelink"></a>COleClient项目：：可以粘贴链接

调用此函数以查看是否可以从剪贴板粘贴链接的 OLE 项目。

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>返回值

如果可以从剪贴板粘贴链接的 OLE 项目，则非零;否则 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅 Windows SDK 中的[OleGetClipboard](/windows/win32/api/ole2/nf-ole2-olegetclipboard)和[OleQueryLinkFromData。](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata)

## <a name="coleclientitemclose"></a><a name="close"></a>COleClient项目：关闭

调用此函数可将 OLE 项的状态从运行状态更改为加载状态，即在其内存中加载其处理程序，但服务器未运行。

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>参数

*dwCloseOption*<br/>
标记指定在哪些情况下，当 OLE 项返回到加载状态时，它保存它。 可以具有以下一个值：

- OLECLOSE_SAVEIFDIRTY保存 OLE 项。

- OLECLOSE_NOSAVE不要保存 OLE 项。

- OLECLOSE_PROMPTSAVE提示用户是否保存 OLE 项。

### <a name="remarks"></a>备注

当 OLE 项未运行时，此功能不起作用。

有关详细信息，请参阅[IOleObject：：关闭](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close)在 Windows SDK 中。

## <a name="coleclientitemcoleclientitem"></a><a name="coleclientitem"></a>COleClient项目：COleClient项目

构造对象`COleClientItem`并将其添加到容器文档的文档项集合中，该对象仅构造C++对象，不执行任何 OLE 初始化。

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>参数

*p集装箱文件*<br/>
指向将包含此项的容器文档的指针。 这可以是任何[COleDocument](../../mfc/reference/coledocument-class.md)衍生物。

### <a name="remarks"></a>备注

如果传递 NULL 指针，则不添加容器文档。 您必须显式调用[COleDocument：：添加项目](../../mfc/reference/coledocument-class.md#additem)。

在使用 OLE 项之前，必须调用以下创建成员函数之一：

- [创建从剪板](#createfromclipboard)

- [创建来自数据](#createfromdata)

- [创建从文件](#createfromfile)

- [从剪贴板创建静态](#createstaticfromclipboard)

- [从数据创建静态](#createstaticfromdata)

- [创建链接从剪贴板](#createlinkfromclipboard)

- [创建链接数据](#createlinkfromdata)

- [创建链接从文件](#createlinkfromfile)

- [创建新项目](#createnewitem)

- [从创建克隆](#createclonefrom)

## <a name="coleclientitemconvertto"></a><a name="convertto"></a>COleClient项目：转换到

调用此成员函数将项转换为*clsidNew*指定的类型。

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>参数

*克西德新*<br/>
目标类型的类 ID。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

这是自动调用[COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)。 不必直接调用它。

## <a name="coleclientitemcopytoclipboard"></a><a name="copytoclipboard"></a>COleClient项目：：复制到剪贴板

调用此函数以将 OLE 项复制到剪贴板。

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>参数

*bInclude链接*<br/>
如果链接信息应复制到剪贴板，则为 TRUE，允许粘贴链接的项目;否则 FALSE。

### <a name="remarks"></a>备注

通常，在为"编辑"菜单中为"复制"或"剪切"命令编写消息处理程序时，可以调用此函数。 如果要实现"复制"或"剪切"命令，则必须在容器应用程序中实现项目选择。

有关详细信息，请参阅 Windows SDK 中的[OleSetClip 板](/windows/win32/api/ole2/nf-ole2-olesetclipboard)。

## <a name="coleclientitemcreateclonefrom"></a><a name="createclonefrom"></a>COleClient项目：从创建克隆

调用此函数以创建指定的 OLE 项的副本。

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>参数

*pSrcItem*<br/>
指向要复制的 OLE 项的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

副本与源项相同。 您可以使用此函数支持撤消操作。

## <a name="coleclientitemcreatefromclipboard"></a><a name="createfromclipboard"></a>COleClient项目：从剪贴板创建

调用此函数从剪贴板的内容创建嵌入项。

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

通常，您通常从"编辑"菜单上的"粘贴"命令的消息处理程序调用此函数。 （如果[CanPaste](#canpaste)成员函数返回非零，则框架将启用"粘贴"命令。

有关详细信息，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc)

## <a name="coleclientitemcreatefromdata"></a><a name="createfromdata"></a>COleClient项目：从数据创建

调用此函数从对象创建嵌入项`COleDataObject`。

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject 对象](../../mfc/reference/coledataobject-class.md)。

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

数据传输操作（如从剪贴板粘贴或拖放操作）提供`COleDataObject`包含服务器应用程序提供的信息的对象。 它通常用于您的覆盖[CView：：onDrop](../../mfc/reference/cview-class.md#ondrop)。

有关详细信息，请参阅 Windows SDK 中的[OleCreate 数据](/windows/win32/api/ole2/nf-ole2-olecreatefromdata)[、OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc)

## <a name="coleclientitemcreatefromfile"></a><a name="createfromfile"></a>COleClient项目：从文件创建

调用此函数从文件创建嵌入的 OLE 项。

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*lpszFile名称*<br/>
指向要从中创建 OLE 项的文件的名称的指针。

*Clsid*<br/>
保留供将来使用。

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

框架从[COleInsertDialog：：如果用户](../../mfc/reference/coleinsertdialog-class.md#createitem)在选择"从文件创建"按钮时从"插入对象"对话框中选择"确定"，则框架将调用此函数。

有关详细信息，请参阅 Windows SDK 中的[OleCreate 文件](/windows/win32/api/ole/nf-ole-olecreatefromfile)[、OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc)

## <a name="coleclientitemcreatelinkfromclipboard"></a><a name="createlinkfromclipboard"></a>COleClient项目：从剪贴板创建链接

调用此函数从剪贴板的内容创建链接项。

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

通常，您通常从"编辑"菜单上的"粘贴链接"命令的消息处理程序调用此函数。 （如果剪贴板包含可链接到的 OLE 项，则在[COleDocument](../../mfc/reference/coledocument-class.md)的默认实现中启用粘贴链接命令。

有关详细信息，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc)

## <a name="coleclientitemcreatelinkfromdata"></a><a name="createlinkfromdata"></a>COleClient项目：从数据创建链接

调用此函数从对象创建链接项`COleDataObject`。

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject 对象](../../mfc/reference/coledataobject-class.md)。

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

当用户指示应创建链接时，在放置操作期间调用此选项。 它还可用于处理"编辑粘贴"命令。 它由`COleClientItem::CreateLinkFromClipboard`[COlePaste 特别对话框](../../mfc/reference/colepastespecialdialog-class.md#createitem)中的 和 中的框架调用：：在选择链接选项时创建项目。

有关详细信息，请参阅 Windows SDK 中的[OleCreateLinkFromData、OLERENDER](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)

## <a name="coleclientitemcreatelinkfromfile"></a><a name="createlinkfromfile"></a>COleClient项目：从文件创建链接

调用此函数从文件创建链接的 OLE 项。

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*lpszFile名称*<br/>
指向要从中创建 OLE 项的文件的名称的指针。

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果用户在选择"从文件创建"按钮并选中"链接"复选框时从"插入对象"对话框中选择"确定"，则框架将调用此功能。 它调用从[COleInsertDialog：：创建项目](../../mfc/reference/coleinsertdialog-class.md#createitem)。

有关详细信息，请参阅 Windows SDK 中的[OleCreateLinkToFile、OLERENDER](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)

## <a name="coleclientitemcreatenewitem"></a><a name="createnewitem"></a>COleClient项目：创建新项目

调用此函数以创建嵌入的项;此函数启动允许用户创建 OLE 项的服务器应用程序。

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*Clsid*<br/>
唯一标识要创建的 OLE 项类型的 ID。

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果用户在选择"新建"按钮时从"插入对象"对话框中选择"确定"，则框架将调用此功能。

有关详细信息，请参阅 Windows SDK 中的[OleCreate、OleRENDER](/windows/win32/api/ole/nf-ole-olecreate)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc) [OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)

## <a name="coleclientitemcreatestaticfromclipboard"></a><a name="createstaticfromclipboard"></a>COleClient项目：从剪贴板创建静态

调用此函数从剪贴板的内容创建静态项。

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

静态项包含表示数据，但不包含本机数据;因此，无法对其进行编辑。 如果[CreateFromClipboard](#createfromclipboard)成员函数失败，通常调用此函数。

有关详细信息，请参阅 Windows SDK 中的[OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc)

## <a name="coleclientitemcreatestaticfromdata"></a><a name="createstaticfromdata"></a>COleClient项目：从数据创建静态

调用此函数从`COleDataObject`对象创建静态项。

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>参数

*pDataObject*<br/>
指向要从中创建 OLE 项的[COleDataObject 对象](../../mfc/reference/coledataobject-class.md)。

*呈现*<br/>
指定服务器如何呈现 OLE 项的标志。 有关可能的值，请参阅 Windows SDK 中的[OLERENDER。](/windows/win32/api/oleidl/ne-oleidl-olerender)

*cfFormat*<br/>
指定创建 OLE 项时要缓存的剪贴板数据格式。

*lpFormatEtc*<br/>
如果*渲染*为OLERENDER_FORMAT或OLERENDER_DRAW，则指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)结构的指针。 仅当要指定*cfFormat*指定的剪贴板格式之外的其他格式信息时，才为此参数提供值。 如果省略此参数，则默认值将用于`FORMATETC`结构中的其他字段。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

静态项包含表示数据，但不包含本机数据;因此，无法对其进行编辑。 这基本上与[创建 StaticFromClipboard](#createstaticfromclipboard)相同，只不过静态项可以从任意`COleDataObject`项（而不仅仅是从剪贴板）创建。

在[COlePaste 特殊对话框中使用：：](../../mfc/reference/colepastespecialdialog-class.md#createitem)选择静态时创建项目。

有关详细信息，请参阅 Windows SDK 中的[OleCreateStaticFrom 数据](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata)[、OLERENDER](/windows/win32/api/oleidl/ne-oleidl-olerender)和[FORMATETC。](/windows/win32/api/objidl/ns-objidl-formatetc)

## <a name="coleclientitemdeactivate"></a><a name="deactivate"></a>COleClient项目：:D激活

调用此函数以停用 OLE 项并释放任何关联的资源。

```
void Deactivate();
```

### <a name="remarks"></a>备注

当用户单击鼠标在项目边界外的工作区上时，通常会停用就地活动 OLE 项。 请注意，停用 OLE 项将放弃其撤消状态，因此无法调用[重新激活和Undo](#reactivateandundo)成员函数。

如果应用程序支持撤消，请不要调用`Deactivate`而是调用[停用 UI](#deactivateui)。

有关详细信息，请参阅[IOleInPlace 对象：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate)Windows SDK 中原地停用。

## <a name="coleclientitemdeactivateui"></a><a name="deactivateui"></a>COleClient项目：:D激活UI

当用户停用已激活的项时，调用此功能。

```
void DeactivateUI();
```

### <a name="remarks"></a>备注

此函数将容器应用程序的用户界面还原到其原始状态，隐藏为就地激活而创建的任何菜单和其他控件。

此函数不刷新项的撤消状态信息。 保留该信息，以便[ReactivateAndUndo](#reactivateandundo)以后可用于在服务器应用程序中执行撤消命令，以防在停用项后立即选择容器的撤消命令。

有关详细信息，请参阅[IOleInPlace 对象：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate)Windows SDK 中原地停用。

## <a name="coleclientitemdelete"></a><a name="delete"></a>COleClient项目：:Delete

调用此函数从容器文档中删除 OLE 项。

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>参数

*b自动删除*<br/>
指定是否要从文档中删除该项目。

### <a name="remarks"></a>备注

此函数调用["释放"](#release)成员函数，该函数又删除项C++对象，从而从文档中永久删除 OLE 项。 如果嵌入了 OLE 项，则删除该项目的本机数据。 它始终关闭正在运行的服务器;因此，如果项目是打开的链接，则此函数将关闭它。

## <a name="coleclientitemdodragdrop"></a><a name="dodragdrop"></a>COleClient项目：:DoDragDrop

调用`DoDragDrop`成员函数以执行拖放操作。

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>参数

*lpItemrect*<br/>
在客户端坐标（像素）的屏幕上的项矩形。

*pt偏移*<br/>
鼠标位置在拖动时所在的*lpItemRect*的偏移量。

*bInclude链接*<br/>
如果链接数据应复制到剪贴板，则将其设置为 TRUE。 如果服务器应用程序不支持链接，请将其设置为 FALSE。

*dwEffects*<br/>
确定拖动源在拖动操作中允许的效果。

*lpRect开始拖动*<br/>
指向定义拖动实际开始位置的矩形的指针。 有关更多信息，请参见下面的“备注”部分。

### <a name="return-value"></a>返回值

DROPVALUE 值。 如果DROPEFFECT_MOVE，则应删除原始数据。

### <a name="remarks"></a>备注

拖放操作不会立即启动。 它等待鼠标光标离开*lpRectStartDrag 指定的*矩形或直到经过指定数量的毫秒。 如果*lpRectStartDrag*是 NULL，则矩形的大小为一个像素。

延迟时间由注册表键设置指定。 您可以通过调用[CWinApp：：WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)或[CWinApp：：WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint)来更改延迟时间。 如果不指定延迟时间，则使用默认值 200 毫秒。 拖动延迟时间存储如下：

- Windows NT 拖动延迟时间存储在HKEY_LOCAL_MACHINE_SOFTWARE_微软\Windows_NT_当前版本\iniFile映射\win.ini_Windows_Dragdelay。

- Windows 3.x 拖动延迟时间存储在 WIN 中。INI 文件，在 [Windows] 部分下。

- Windows 95/98 拖动延迟时间存储在 WIN 的缓存版本中。Ini。

有关拖动延迟信息如何存储在注册表或 中的详细信息。INI 文件，请参阅 Windows SDK 中的[写入配置文件字符串](/windows/win32/api/winbase/nf-winbase-writeprofilestringw)。

## <a name="coleclientitemdoverb"></a><a name="doverb"></a>COleClient项目：:DoVerb

调用`DoVerb`以执行指定的谓词。

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>参数

*nVerb*<br/>
指定要执行的谓词。 它可以包括以下之一：

|“值”|含义|符号|
|-----------|-------------|------------|
|- 0|主谓词|OLEIVERB_PRIMARY|
|- 1|次要动词|（无）|
|- 1|显示要编辑的项目|OLEIVERB_SHOW|
|- 2|在单独的窗口中编辑项目|OLEIVERB_OPEN|
|- 3|隐藏项目|OLEIVERB_HIDE|

-1 值通常是另一个谓词的别名。 如果不支持打开编辑，-2 的效果与 -1 相同。 有关其他值，请参阅 Windows SDK 中的[IOleObject：:DoVerb。](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb)

*pView*<br/>
指向视图窗口的指针;服务器使用此激活进行就地激活。 如果容器应用程序不允许就地激活，则此参数应为 NULL。

*lpMsg*<br/>
指向导致项目被激活的消息的指针。

### <a name="return-value"></a>返回值

如果成功执行谓词，则非零;否则 0。

### <a name="remarks"></a>备注

此函数调用[Activate](#activate)成员函数来执行谓词。 它还捕获异常，并在引发异常时向用户显示消息框。

如果主谓词为"编辑"，*并在 nVerb*参数中指定零，则启动服务器应用程序以允许编辑 OLE 项。 如果容器应用程序支持就地激活，则可以就地进行编辑。 如果容器不支持就地激活（或者指定了 Open 谓词），则服务器将在单独的窗口中启动，并可以在那里进行编辑。 通常，当容器应用程序的用户双击 OLE 项时 *，nVerb*参数中主谓词的值将确定用户可以执行的操作。 但是，如果服务器仅支持一个操作，则无论*nVerb*参数中指定哪个值，它都执行该操作。

## <a name="coleclientitemdraw"></a><a name="draw"></a>COleClient项目：:D生

调用此函数使用指定的设备上下文将 OLE 项绘制到指定的边界矩形中。

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>参数

*pDC*<br/>
指向用于绘制 OLE 项的[CDC](../../mfc/reference/cdc-class.md)对象的指针。

*lpBounds*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)对象或`RECT`结构的指针，该对象或结构定义要在其中绘制 OLE 项的边界矩形（以由设备上下文确定的逻辑单位）。

*nDrawAspect*<br/>
指定 OLE 项的方面，即应该如何显示它。 如果*nDrawAspect*为 -1，则使用[SetDrawAspect](#setdrawaspect)设置的最后一个方面。 有关此标志的可能值的详细信息，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

该函数可以使用 由[的 OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)成员函数创建的 OLE 项的`COleServerItem`元文件表示形式。

通常用于`Draw`屏幕显示，将屏幕设备上下文传递为*pDC*。 在这种情况下，只需指定前两个参数。

*lpBounds*参数标识目标设备上下文中的矩形（相对于其当前映射模式）。 渲染可能涉及缩放图片，容器应用程序可以使用该视图在显示的视图和最终打印图像之间缩放。

有关详细信息，请参阅 Windows SDK 中的[IViewObject：:Draw。](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)

## <a name="coleclientitemgetactiveview"></a><a name="getactiveview"></a>COleClient项目：获取活动视图

返回项目就地激活的视图。

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>返回值

指向视图的指针;指向视图的指针否则 NULL，如果项目未就地激活。

## <a name="coleclientitemgetcachedextent"></a><a name="getcachedextent"></a>COleClient项目：获取缓存范围

调用此函数以检索 OLE 项的大小。

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>参数

*lpSize*<br/>
指向将接收`SIZE`大小信息的结构或[CSize](../../atl-mfc-shared/reference/csize-class.md)对象的指针。

*nDrawAspect*<br/>
指定要检索其边界的 OLE 项的方面。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则非零;如果 OLE 项目为空，则为 0。

### <a name="remarks"></a>备注

此函数提供的信息与[GetA.提供](#getextent)相同。 但是，您可以在处理其他`GetCachedExtent`OLE 处理程序（如[OnChange](#onchange)）期间调用以获取范围信息。 尺寸以MM_HIMETRIC单位为单位。

之所以有可能，是因为`GetCachedExtent`使用[IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2)界面而不是使用[IOleObject](/windows/win32/api/oleidl/nn-oleidl-ioleobject)接口来获取此项目的范围。 `IViewObject2` COM 对象缓存上一次调用[IViewObject：:Draw](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw)中使用的范围信息。

有关详细信息，请参阅[IViewObject2：：获取](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)Windows SDK 中的范围。

## <a name="coleclientitemgetclassid"></a><a name="getclassid"></a>COleClient项目：获取类ID

将项的类 ID 返回到*pClassID*指向的内存中。

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>参数

*pClassID*<br/>
指向[CLSID](/windows/win32/com/clsid-key-hklm)类型的标识符以检索类 ID 的指针。 有关 CLSID 的信息，请参阅 Windows SDK。

### <a name="remarks"></a>备注

类 ID 是一个 128 位数字，唯一标识编辑项的应用程序。

有关详细信息，请参阅[IPersist：获取](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid)Windows SDK 中的 ClassID。

## <a name="coleclientitemgetclipboarddata"></a><a name="getclipboarddata"></a>COleClient项目：获取剪贴板数据

调用此函数获取包含`COleDataSource`通过调用[CopyToClipboard](#copytoclipboard)成员函数在剪贴板上放置的所有数据的对象。

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>参数

*pData来源*<br/>
指向将接收 OLE 项中包含的数据的[COleDataSource](../../mfc/reference/coledatasource-class.md)对象的指针。

*bInclude链接*<br/>
如果应包含链接数据，则为 TRUE;否则 FALSE。

*lpOffset*<br/>
鼠标光标与对象原点的偏移量（以像素为单位）。

*lpSize*<br/>
对象的大小（以像素为单位）。

### <a name="remarks"></a>备注

`GetClipboardData`称为[OnGetClipboard 数据的](#ongetclipboarddata)默认实现。 仅当`OnGetClipboardData`除了提供的数据格式外，才需要覆盖`CopyToClipboard`。 `COleDataSource`在调用`CopyToClipboard`之前或之后将这些格式放在对象中，然后将`COleDataSource`该对象传递给[COleDataSource：：setClipboard](../../mfc/reference/coledatasource-class.md#setclipboard)函数。 例如，如果您希望 OLE 项在其容器文档中的位置伴随到剪贴板上，则可以定义自己的格式以传递该信息，并将其放在 调用`COleDataSource``CopyToClipboard`之前。

## <a name="coleclientitemgetdocument"></a><a name="getdocument"></a>COleClient项目：获取文档

调用此函数以获取指向包含 OLE 项的文档的指针。

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>返回值

指向包含 OLE 项的文档的指针。 如果项目不是文档的一部分，则 NULL。

### <a name="remarks"></a>备注

此指针允许访问作为参数`COleDocument`传递给`COleClientItem`构造函数的对象。

## <a name="coleclientitemgetdrawaspect"></a><a name="getdrawaspect"></a>COleClient项目：获取绘制方面

调用`GetDrawAspect`成员函数以确定项的当前"方面"或视图。

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>返回值

DVASPECT 枚举中的值，其值列在[SetDrawAspect](#setdrawaspect)的引用中。

### <a name="remarks"></a>备注

该方面指定如何呈现项。

## <a name="coleclientitemgetextent"></a><a name="getextent"></a>COleClient项目：获取范围

调用此函数以检索 OLE 项的大小。

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>参数

*lpSize*<br/>
指向将接收`SIZE`大小信息的结构`CSize`或对象的指针。

*nDrawAspect*<br/>
指定要检索其边界的 OLE 项的方面。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="return-value"></a>返回值

如果成功，则非零;如果 OLE 项目为空，则为 0。

### <a name="remarks"></a>备注

如果服务器应用程序是使用 Microsoft 基础类库编写的，则此函数会导致调用相应`COleServerItem`对象的[OnGetA.成员](../../mfc/reference/coleserveritem-class.md#ongetextent)函数。 请注意，检索的大小可能与[SetA.00](#setextent)成员函数上次设置的大小不同;指定`SetExtent`的大小被视为建议。 尺寸以MM_HIMETRIC单位为单位。

> [!NOTE]
> 在处理 OLE`GetExtent`处理程序（如[OnChange ）](#onchange)时，不要调用 。 请改为呼叫[GetCached 范围](#getcachedextent)。

有关详细信息，请参阅[IOleObject：获取](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent)Windows SDK 中的范围。

## <a name="coleclientitemgeticonfromregistry"></a><a name="geticonfromregistry"></a>COleClient项目：从注册处获取图标

调用此成员函数以检索与特定 CLSID 服务器关联的图标资源的句柄。

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>参数

*Clsid*<br/>
对与图标关联的服务器的 CLSID 的引用。

### <a name="return-value"></a>返回值

找不到图标资源的有效句柄，或找不到服务器图标或默认图标时为 NULL。

### <a name="remarks"></a>备注

此成员函数不会动态启动服务器或获取图标，即使服务器已在运行。 相反，此成员函数将打开服务器的可执行映像，并在服务器注册时检索与服务器关联的静态图标。

## <a name="coleclientitemgeticonicmetafile"></a><a name="geticonicmetafile"></a>COleClient项目：获取图标Meta文件

检索用于绘制项目图标的元文件。

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>返回值

如果成功，则对元文件的句柄;否则 NULL。

### <a name="remarks"></a>备注

如果没有当前图标，则返回默认图标。 MFC/OLE 对话框会自动调用此功能，通常不直接调用。

此功能还调用[SetIconicMetafile](#seticonicmetafile)来缓存元文件，以便以后使用。

## <a name="coleclientitemgetinplacewindow"></a><a name="getinplacewindow"></a>COleClient项目：获取位置窗口

调用`GetInPlaceWindow`成员函数以获取指向已打开项目的窗口进行就地编辑的窗口的指针。

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>返回值

指向项目就地编辑窗口的指针;如果项目未处于活动状态或其服务器不可用，则为 NULL。

### <a name="remarks"></a>备注

应仅对就地活动的项目调用此函数。

## <a name="coleclientitemgetitemstate"></a><a name="getitemstate"></a>COleClient项目：获取项目状态

调用此函数以获取 OLE 项的当前状态。

```
UINT GetItemState() const;
```

### <a name="return-value"></a>返回值

`COleClientItem::ItemState`枚举的值，可以是以下值之`emptyState`一： `loadedState`、 `openState`、 `activeState`、 `activeUIState`、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 有关这些状态的信息，请参阅文章[容器：客户端项目状态](../../mfc/containers-client-item-states.md)。

### <a name="remarks"></a>备注

要在 OLE 项的状态更改时收到通知，请使用[OnChange](#onchange)成员函数。

有关详细信息，请参阅文章[容器：客户端项目状态](../../mfc/containers-client-item-states.md)。

## <a name="coleclientitemgetlaststatus"></a><a name="getlaststatus"></a>COleClient项目：获取"状态"

返回最后一个 OLE 操作的状态代码。

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>返回值

SCODE 值。

### <a name="remarks"></a>备注

对于返回 FALSE BOOL 值的成员函数或返回 NULL 的其他成员函数，`GetLastStatus`将返回更详细的故障信息。 请注意，大多数 OLE 成员函数都会引发更严重的错误异常。 有关 SCODE 解释的特定信息取决于上次返回 SCODE 值的基础 OLE 调用。

有关 SCODE 的详细信息，请参阅 Windows SDK 文档中[的 COM 错误代码结构](/windows/win32/com/structure-of-com-error-codes)。

## <a name="coleclientitemgetlinkupdateoptions"></a><a name="getlinkupdateoptions"></a>COleClient项目：获取链接更新选项

调用此函数以获取 OLE 项的链接更新选项的当前值。

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>返回值

以下值之一：

- OLEUPDATE_ALWAYS尽可能更新链接的项目。 此选项支持"链接"对话框中的"自动链接更新单选"按钮。

- OLEUPDATE_ONCALL 仅在容器应用程序的请求下更新链接项（在调用[UpdateLink](#updatelink)成员函数时）。 此选项支持"链接"对话框中的"手动链接更新单选"按钮。

### <a name="remarks"></a>备注

这是一个高级操作。

[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)类会自动调用此功能。

有关详细信息，请参阅[IOleLink：获取](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions)Windows SDK 中的更新选项。

## <a name="coleclientitemgettype"></a><a name="gettype"></a>COleClient项目：获取类型

调用此函数以确定 OLE 项是嵌入还是链接，还是静态。

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>返回值

具有以下值之一的无符号整数：

- OT_LINK OLE 项是链接。

- OT_EMBEDDED OLE 项已嵌入。

- OT_STATIC OLE 项是静态的，也就是说，它只包含表示数据，而不是本机数据，因此无法编辑。

## <a name="coleclientitemgetusertype"></a><a name="getusertype"></a>COleClient项目：获取用户类型

调用此函数以获取描述 OLE 项类型的用户可见字符串，例如"Word 文档"。

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>参数

*nUser 类类型*<br/>
指示描述 OLE 项类型的字符串所需变体的值。 这可以具有以下值之一：

- USERCLASSTYPE_FULL向用户显示的完整类型名称。

- USERCLASSTYPE_SHORT短名称（最多 15 个字符）用于弹出式菜单和"编辑链接"对话框。

- USERCLASSTYPE_APPNAME为类提供服务的应用程序的名称。

*rString*<br/>
对[CString](../../atl-mfc-shared/reference/cstringt-class.md)对象的引用，要返回描述 OLE 项类型的字符串。

### <a name="remarks"></a>备注

这通常是系统注册数据库中的条目。

如果请求完整类型名称但不可用，则改为使用短名称。 如果在注册数据库中找不到 OLE 项类型的条目，或者没有为 OLE 项类型注册的用户类型，则使用当前存储在 OLE 项中的用户类型。 如果用户类型名称为空字符串，则使用"未知对象"。

有关详细信息，请参阅[IOleObject：获取](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype)Windows SDK 中的UserType。

## <a name="coleclientitemisinplaceactive"></a><a name="isinplaceactive"></a>COleClient项目：在原位激活

调用此函数以查看 OLE 项是否就地处于活动状态。

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项目处于活动位置，则非零;否则 0。

### <a name="remarks"></a>备注

根据是否对项目进行就地编辑，执行不同的逻辑是很常见的。 函数检查当前项状态是否等于 或`activeState`。 `activeUIState`

## <a name="coleclientitemislinkuptodate"></a><a name="islinkuptodate"></a>COleClient项目：islinkup到日期

调用此函数以查看 OLE 项是否是最新的。

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项目是最新的，则非零;否则 0。

### <a name="remarks"></a>备注

如果链接的源文档已更新，则链接项可能已过期。 包含其中链接的嵌入项同样可能过时。 函数对 OLE 项执行递归检查。 请注意，确定 OLE 项目是否过期可能与实际执行更新一样昂贵。

这由[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)实现自动调用。

有关详细信息，请参阅[IOleObject：：Windows](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) SDK 中的 IsUpDate。

## <a name="coleclientitemismodified"></a><a name="ismodified"></a>COleClient项目：已修改

调用此函数以查看 OLE 项是否脏（自上次保存以来已修改）。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项脏，则非零;否则 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅[IPersist 存储：Windows SDK 中"是脏的](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty)"。

## <a name="coleclientitemisopen"></a><a name="isopen"></a>COleClient项目：是打开的

调用此函数以查看 OLE 项是否打开;请调用此函数，以查看 OLE 项是否打开。即，在独立窗口中运行的服务器应用程序的实例中打开。

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项目处于打开状态，则非零;否则 0。

### <a name="remarks"></a>备注

它用于确定何时使用阴影图案绘制对象。 打开的对象应具有在对象顶部绘制的剖面线图案。 您可以使用[CRectTracker](../../mfc/reference/crecttracker-class.md)对象来实现此目的。

## <a name="coleclientitemisrunning"></a><a name="isrunning"></a>COleClient项目：正在运行

调用此函数以查看 OLE 项是否正在运行;请调用此函数，以查看 OLE 项是否正在运行。即，项目是否在服务器应用程序中加载和运行。

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>返回值

如果 OLE 项正在运行，则非零;否则 0。

### <a name="remarks"></a>备注

有关详细信息，请参阅在 Windows SDK 中[运行的 OleIs。](/windows/win32/api/ole2/nf-ole2-oleisrunning)

## <a name="coleclientitemonactivate"></a><a name="onactivate"></a>COleClient项目：打开激活

由框架调用，以通知项目刚刚激活到位。

```
virtual void OnActivate();
```

### <a name="remarks"></a>备注

请注意，调用此函数是为了指示服务器正在运行，而不是指示其用户界面已安装在容器应用程序中。 此时，对象没有活动用户界面（不是`activeUIState`）。 它尚未安装其菜单或工具栏。 发生这种情况时调用[OnActivateUI](#onactivateui)成员函数。

默认实现调用作为参数的[onChange](#onchange)成员函数，OLE_CHANGEDSTATE。 重写此函数，在项目变为就地活动时执行自定义处理。

## <a name="coleclientitemonactivateui"></a><a name="onactivateui"></a>COleClient项目：在激活 UI 上

当对象输入`OnActivateUI`活动 UI 状态时，框架将调用。

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>备注

对象现已安装其工具栏和菜单。

默认实现会记住服务器的 HWND，以便以后`GetServerWindow`调用。

## <a name="coleclientitemonchange"></a><a name="onchange"></a>COleClient项目：打开更改

当用户修改、保存或关闭 OLE 项时，框架调用。

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>参数

*n代码*<br/>
服务器更改此项目的原因。 可以具有以下一个值：

- OLE_CHANGED OLE 项目的外观已更改。

- OLE_SAVED已保存 OLE 项。

- OLE_CLOSED OLE 项目已关闭。

- OLE_CHANGED_STATE OLE 项从一种状态更改为另一种状态。

*德帕拉姆*<br/>
如果*nCode* OLE_SAVED或OLE_CLOSED，则不使用此参数。 如果*nCode* OLE_CHANGED，则此参数指定已更改的 OLE 项的方面。 有关可能的值，请参阅[COleClientItem 的](#draw) *dwParam*参数：:D原始 。 如果*nCode* OLE_CHANGED_STATE，则此参数`COleClientItem::ItemState`是枚举值，并描述正在输入的状态。 它可以`emptyState`具有以下值之一： 、 `loadedState`、 `openState` `activeState`、 `activeUIState`、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、 、

### <a name="remarks"></a>备注

（如果服务器应用程序是使用 Microsoft 基础类库编写的，则调用此函数是为了响应`Notify``COleServerDoc`或`COleServerItem`的成员函数。如果*nCode*是OLE_CHANGED或OLE_SAVED，则默认实现将容器文档标记为已修改。

对于OLE_CHANGED_STATE，从[GetItemState](#getitemstate)返回的当前状态仍将是旧状态，这意味着此状态更改之前的状态。

重写此函数以响应 OLE 项状态中的更改。 通常，通过使项目显示的区域无效来更新项目的外观。 在重写开始时调用基类实现。

## <a name="coleclientitemonchangeitemposition"></a><a name="onchangeitemposition"></a>COleClient项目：在更改项目位置上

由框架调用，以通知容器 OLE 项的扩展盘范围在就地激活期间已更改。

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>参数

*rectPos*<br/>
指示物料相对于容器应用程序的工作区的位置。

### <a name="return-value"></a>返回值

如果项目的位置已成功更改，则非零;否则 0。

### <a name="remarks"></a>备注

默认实现确定 OLE 项的新可见矩形，并且使用新值调用[SetItemRects。](#setitemrects) 默认实现计算项的可见矩形，并将该信息传递给服务器。

重写此函数以对调整大小/移动操作应用特殊规则。 如果应用程序是在 MFC 中编写的，则此调用将由于服务器名为[COleServerDoc：：请求位置更改](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)。

## <a name="coleclientitemondeactivate"></a><a name="ondeactivate"></a>COleClient项目：打开激活

当 OLE 项从就地活动状态 （ `activeState`） 转换到加载状态时，由框架调用，这意味着在就地激活后将其停用。

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>备注

请注意，调用此函数是为了指示 OLE 项已关闭，而不是其用户界面已从容器应用程序中删除。 发生这种情况时，将调用[OnDeactivateUI](#ondeactivateui)成员函数。

默认实现调用作为参数的[onChange](#onchange)成员函数，OLE_CHANGEDSTATE。 重写此函数，在停用就地活动项时执行自定义处理。 例如，如果支持容器应用程序中的撤消命令，则可以重写此函数以丢弃撤消状态，指示在取消该项目后无法撤消对 OLE 项执行的最后一个操作。

## <a name="coleclientitemondeactivateandundo"></a><a name="ondeactivateandundo"></a>COleClient项目：ondededeandundo

当用户在就地激活 OLE 项后调用撤消命令时，由框架调用。

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>备注

默认实现调用[停用 UI](#deactivateui)以停用服务器的用户界面。 如果要在容器应用程序中实现撤消命令，请重写此函数。 在重写中，调用函数的基类版本，然后撤消应用程序中执行的最后一个命令。

有关详细信息，请参阅[IOleInPlaceSite：:D在](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo)Windows SDK 中激活和Undo。

## <a name="coleclientitemondeactivateui"></a><a name="ondeactivateui"></a>COleClient项目：打开停用UI

当用户停用就地激活的项目时调用。

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>参数

*不可多做*<br/>
指定编辑更改是否可撤消。

### <a name="remarks"></a>备注

此函数将容器应用程序的用户界面还原到其原始状态，隐藏为就地激活而创建的任何菜单和其他控件。

如果*bUnable*是 FALSE，则容器应禁用撤消命令，实际上将丢弃容器的撤消状态，因为它指示服务器执行的最后一个操作不可撤消。

## <a name="coleclientitemondiscardundostate"></a><a name="ondiscardundostate"></a>COleClient项目：在放弃Undostate

当用户执行在编辑 OLE 项时放弃撤消状态的操作时，由框架调用。

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>备注

默认实现不执行任何操作。 如果要在容器应用程序中实现撤消命令，请重写此函数。 在重写中，丢弃容器应用程序的撤消状态。

如果服务器是使用 Microsoft 基础类库编写的，则服务器可以通过调用[COleServerDoc：:DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate)来调用此函数。

有关详细信息，请参阅 Windows SDK 中的[iOleInPlaceSite：:DiscardUndoState。](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate)

## <a name="coleclientitemongetclipboarddata"></a><a name="ongetclipboarddata"></a>COleClient项目：在获取剪贴板数据

由框架调用，获取包含`COleDataSource`通过调用[CopyToClipboard](#copytoclipboard)或[DoDragDrop](#dodragdrop)成员函数在剪贴板上放置的所有数据的对象。

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>参数

*bInclude链接*<br/>
如果链接数据应复制到剪贴板，则将其设置为 TRUE。 如果服务器应用程序不支持链接，请将此设置为 FALSE。

*lpOffset*<br/>
指向鼠标光标与对象原点（以像素为单位）的偏移量的指针。

*lpSize*<br/>
指向对象大小（以像素为单位）。

### <a name="return-value"></a>返回值

指向包含剪贴板数据的[COleDataSource](../../mfc/reference/coledatasource-class.md)对象的指针。

### <a name="remarks"></a>备注

此函数的默认实现调用[GetClipboardData](#getclipboarddata)。

## <a name="coleclientitemongetcliprect"></a><a name="ongetcliprect"></a>COleClient项目：ongetCliprect

框架调用`OnGetClipRect`成员函数以获取正在编辑的项的裁剪矩形坐标。

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>参数

*rClipRect*<br/>
指向类[CRect](../../atl-mfc-shared/reference/crect-class.md)对象的指针，该对象将保存项目的裁剪矩形坐标。

### <a name="remarks"></a>备注

坐标相对于容器应用程序窗口的工作区以像素为单位。

默认实现仅返回该项就地处于活动状态的视图的客户端矩形。

## <a name="coleclientitemongetitemposition"></a><a name="ongetitemposition"></a>COleClient项目：在获取项目位置

框架调用`OnGetItemPosition`成员函数以获取正在编辑的项的坐标。

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>参数

*r定位*<br/>
引用将包含项位置坐标的[CRect](../../atl-mfc-shared/reference/crect-class.md)对象。

### <a name="remarks"></a>备注

坐标相对于容器应用程序窗口的工作区以像素为单位。

此函数的默认实现不执行任何操作。 支持就地编辑的应用程序需要实现。

## <a name="coleclientitemongetwindowcontext"></a><a name="ongetwindowcontext"></a>COleClient项目：打开窗口上下文

当项目就地激活时，由框架调用。

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>参数

*ppMainFrame*<br/>
指向主框架窗口的指针。

*ppDocFrame*<br/>
指向指向文档框架窗口的指针。

*lpFrameInfo*<br/>
指向将接收帧窗口信息的[OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)结构的指针。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

此功能用于检索有关 OLE 项的父窗口的信息。

如果容器是 MDI 应用程序，则默认实现返回指向*ppMainFrame*中的[CMDIFramewnd](../../mfc/reference/cmdiframewnd-class.md)对象的指针，以及*指向 ppDocFrame*中活动[CMDIChildwnd](../../mfc/reference/cmdichildwnd-class.md)对象的指针。 如果容器是 SDI 应用程序，则默认实现返回指向*ppMainFrame*中的[CFramewnd](../../mfc/reference/cframewnd-class.md)对象的指针，并在*ppDocFrame*中返回 NULL。 默认实现还填充*lpFrameInfo*的成员。

仅当默认实现不适合您的应用程序时，才重写此函数;例如，如果应用程序具有不同于 SDI 或 MDI 的用户界面范例。 这是一个高级的可重写。

有关详细信息，请参阅[IOleInPlaceSite：获取 Windows](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) SDK 中的 Windows 中的窗口上下文和[OLEINPLACEFRAMEINFO](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo)结构。

## <a name="coleclientitemoninsertmenus"></a><a name="oninsertmenus"></a>COleClient项目：在插入菜单上

在就地激活期间由框架调用，以将容器应用程序的菜单插入到空菜单中。

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>参数

*pMenu共享*<br/>
指向空菜单。

*lpMenu 宽度*<br/>
指向六个 LONG 值的数组，指示以下每个菜单组中的菜单数：文件、编辑、容器、对象、窗口、帮助。 容器应用程序负责与该数组的元素 0、2 和 4 对应的文件、容器和窗口菜单组。

### <a name="remarks"></a>备注

然后，此菜单将传递到服务器，服务器插入自己的菜单，创建复合菜单。 可以重复调用此功能以生成多个复合菜单。

默认实现将插入到*pMenu 共享*就地容器菜单;即"文件"、"容器"和"窗口"菜单组。 [CDocTemplate：：设置容器信息](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo)用于设置此菜单资源。 默认实现还会根据菜单资源将适当的值分配给*lpMenuWidths*中的元素 0、2 和 4。 如果默认实现不适合您的应用程序，请覆盖此函数;例如，如果应用程序不使用文档模板将资源与文档类型相关联。 如果重写此函数，还应重写[OnSetMenu](#onsetmenu)和[OnRemoveMenu。](#onremovemenus) 这是一个高级的可重写。

有关详细信息，请参阅[IOleInPlaceFrame：：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus)Windows SDK 中插入菜单。

## <a name="coleclientitemonremovemenus"></a><a name="onremovemenus"></a>COleClient项目：打开删除菜单

由框架调用，在就地激活结束时从指定的复合菜单中删除容器的菜单。

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>参数

*pMenu共享*<br/>
指向由调用[OnInsertMenus](#oninsertmenus)成员函数构造的复合菜单。

### <a name="remarks"></a>备注

默认实现从*pMenu 共享*就地容器菜单（即文件、容器和窗口菜单组）中删除。 如果默认实现不适合您的应用程序，请覆盖此函数;例如，如果应用程序不使用文档模板将资源与文档类型相关联。 如果重写此函数，则可能还应覆盖["插入菜单](#oninsertmenus)"和["打开"菜单](#onsetmenu)。 这是一个高级的可重写。

如果服务器反复调用`OnInsertMenus`，则*pMenuShared*上的子菜单可能由多个复合菜单共享。 因此，不应删除 重写 中的任何子菜单`OnRemoveMenus`。你应该只分离它们。

有关详细信息，请参阅[IOleInPlaceFrame：：删除](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus)Windows SDK 中的菜单。

## <a name="coleclientitemonscrollby"></a><a name="onscrollby"></a>COleClient项目：OnScrollby

由框架调用以滚动 OLE 项以响应来自服务器的请求。

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>参数

*大小范围*<br/>
指定以 x 和 y 方向滚动的距离（以像素为单位）。

### <a name="return-value"></a>返回值

如果项目已滚动，则非零;如果无法滚动项目，则为 0。

### <a name="remarks"></a>备注

例如，如果 OLE 项部分可见，并且用户在执行就地编辑时移动到可见区域之外，则调用此函数以保持光标可见。 默认实现不执行任何操作。 重写此函数以按指定数量滚动项目。 请注意，由于滚动，OLE 项的可见部分可能会更改。 调用[SetItemRects](#setitemrects)以更新项目的可见矩形。

有关详细信息，请参阅[IOleInPlaceSite：：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll)Windows SDK 中滚动。

## <a name="coleclientitemonsetmenu"></a><a name="onsetmenu"></a>COleClient项目：打开菜单

当就地激活开始和结束时，框架调用两次;第一次安装复合菜单和第二次（*孔菜单*等于 NULL）以将其删除。

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>参数

*pMenu共享*<br/>
指针指向由调用[OnInsertMenus](#oninsertmenus)成员函数和函数构造的`InsertMenu`复合菜单。

*孔菜单*<br/>
处理函数返回的`OleCreateMenuDescriptor`菜单描述符，如果要删除调度代码，则处理 NULL。

*hwndActiveObject*<br/>
处理 OLE 项的编辑窗口。 这是将从 OLE 接收编辑命令的窗口。

### <a name="remarks"></a>备注

默认实现安装或删除复合菜单，然后调用[OleSetMenu 描述器](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)功能来安装或删除调度代码。 如果默认实现不适合您的应用程序，请覆盖此函数。 如果重写此函数，则可能还应覆盖["插入菜单](#oninsertmenus)"和["打开删除菜单](#onremovemenus)"。 这是一个高级的可重写。

有关详细信息，请参阅[OleCreateMenu 描述器](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor)[、OleSetMenu 描述器](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)和[IOleInPlaceFrame：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu)Windows SDK 中设置Menu。

## <a name="coleclientitemonshowcontrolbars"></a><a name="onshowcontrolbars"></a>COleClient项目：在显示控制栏

由框架调用以显示和隐藏容器应用程序的控制栏。

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>参数

*pFramewnd*<br/>
指向容器应用程序的帧窗口的指针。 这可以是主框架窗口或 MDI 子窗口。

*b显示*<br/>
指定是显示还是隐藏控制栏。

### <a name="return-value"></a>返回值

如果函数调用导致控制栏状态发生变化，则非零;0 如果调用未引起任何更改，或者*pFrameWnd*未指向容器的帧窗口。

### <a name="remarks"></a>备注

如果控制栏已处于 bShow 指定的状态，则此功能返回*0。* 例如，如果控制栏处于隐藏状态，*并且 bShow*为 FALSE，则会发生这种情况。

默认实现从顶层框架窗口中删除工具栏。

## <a name="coleclientitemonshowitem"></a><a name="onshowitem"></a>COleClient项目：在显示项目

由框架调用以显示 OLE 项，使其在编辑期间完全可见。

```
virtual void OnShowItem();
```

### <a name="remarks"></a>备注

当容器应用程序支持指向嵌入项的链接（即，如果您从[COleLinksDoc](../../mfc/reference/colelinkingdoc-class.md)派生了文档类），则使用它。 当 OLE 项目是链接源且用户希望对其进行编辑时，将在就地激活期间调用此功能。 默认实现激活容器文档上的第一个视图。 重写此函数以滚动文档，以便 OLE 项可见。

## <a name="coleclientitemonupdateframetitle"></a><a name="onupdateframetitle"></a>COleClient项目：更新帧标题

在就地激活期间由框架调用以更新框架窗口的标题栏。

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>返回值

如果此函数成功更新框架标题，则为非零，否则为零。

### <a name="remarks"></a>备注

默认实现不会更改框架窗口标题。 如果需要应用程序的不同框架标题，例如"*文档名*中的*服务器应用* - *项*"（如"Microsoft Excel - 报表中的电子表格"），请覆盖此函数。DOC"）。 这是一个高级的可重写。

## <a name="coleclientitemreactivateandundo"></a><a name="reactivateandundo"></a>COleClient项目：重新激活和Undo

调用此函数以重新激活 OLE 项并撤消用户在就地编辑期间执行的最后一个操作。

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

如果容器应用程序支持撤消命令，如果用户在停用 OLE 项后立即选择撤消命令，请调用此函数。

如果服务器应用程序是使用 Microsoft 基础类库编写的，则此函数会导致服务器调用[COleServerDoc：：on 重新激活并撤消](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)。

有关详细信息，请参阅[IOleInPlace 对象：：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo)Windows SDK 中重新激活和撤消。

## <a name="coleclientitemrelease"></a><a name="release"></a>COleClient项目：发布

调用此函数以清理 OLE 项使用的资源。

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>参数

*dwCloseOption*<br/>
标记指定在哪些情况下，当 OLE 项返回到加载状态时，它保存它。 有关可能值的列表，请参阅[COleClientItemItem：：关闭](#close)。

### <a name="remarks"></a>备注

`Release`由`COleClientItem`析构函数调用。

有关详细信息，请参阅[I 未知：：在](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)Windows SDK 中发布。

## <a name="coleclientitemreload"></a><a name="reload"></a>COleClient项目：重新加载

关闭并重新加载项目。

```
BOOL Reload();
```

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

通过调用`Reload` [ActivateAs](#activateas)将项激活为另一种类型的项后调用该函数。

## <a name="coleclientitemrun"></a><a name="run"></a>COleClient项目：运行

运行与此项关联的应用程序。

```
void Run();
```

### <a name="remarks"></a>备注

在`Run`激活该项目之前调用成员函数以启动服务器应用程序。 这是自动由[激活](#activate)和[DoVerb](#doverb)完成的，因此通常没有必要调用此函数。 如果需要运行服务器以便在执行[DoVerb](#doverb)之前设置项属性（如[SetExtent），](#setextent)请调用此函数。

## <a name="coleclientitemsetdrawaspect"></a><a name="setdrawaspect"></a>COleClient项目：：设置绘制方面

调用`SetDrawAspect`成员函数以设置项的"方面"或视图。

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>参数

*nDrawAspect*<br/>
DVASPECT 枚举中的值。 此参数可以具有下列值之一：

- DVASPECT_CONTENT项的表示方式可以将其显示为容器内的嵌入对象。

- DVASPECT_THUMBNAIL项目以"缩略图"表示形式呈现，以便它可以显示在浏览工具中。

- DVASPECT_ICON项由图标表示。

- DVASPECT_DOCPRINT项表示，就好像它是使用"文件"菜单中的"打印"命令一样。

### <a name="remarks"></a>备注

该方面指定在使用该函数的*nDrawAspect*参数的默认值时，如何通过[Draw](#draw)呈现项。

此函数由"更改图标"（以及直接调用更改图标对话框的其他对话框）自动调用，以便在用户请求时启用标志性的显示方面。

## <a name="coleclientitemsetextent"></a><a name="setextent"></a>COleClient项目：设置范围

调用此函数以指定 OLE 项可用的空间量。

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>参数

*大小*<br/>
包含大小信息的[CSize](../../atl-mfc-shared/reference/csize-class.md)对象。

*nDrawAspect*<br/>
指定要设置其边界的 OLE 项的方面。 有关可能的值，请参阅[SetDrawAspect](#setdrawaspect)。

### <a name="remarks"></a>备注

如果服务器应用程序是使用 Microsoft 基础类库编写的，则这将导致调用相应`COleServerItem`对象的[OnSetA0e](../../mfc/reference/coleserveritem-class.md#onsetextent)成员函数。 然后，OLE 项目可以相应地调整其显示。 尺寸必须以MM_HIMETRIC单位为单位。 当用户调整 OLE 项的大小或支持某种形式的布局协商时，请调用此功能。

有关详细信息，请参阅[IOleObject：：在](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)Windows SDK 中设置范围。

## <a name="coleclientitemsethostnames"></a><a name="sethostnames"></a>COleClient项目：设置主机名

调用此函数以指定容器应用程序的名称和嵌入 OLE 项的容器名称。

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>参数

*lpszHost*<br/>
指向容器应用程序的用户可见名称的指针。

*lpszHostObj*<br/>
指向包含 OLE 项的容器标识字符串的指针。

### <a name="remarks"></a>备注

如果服务器应用程序是使用 Microsoft 基础类库编写的，则此函数将调用包含 OLE 项的文档的`COleServerDoc` [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames)成员函数。 在编辑 OLE 项时，此信息用于窗口标题。 每次加载容器文档时，框架都会为文档中的所有 OLE 项调用此函数。 `SetHostNames`仅适用于嵌入的项目。 每次激活嵌入的 OLE 项进行编辑时，都不必调用此函数。

当加载对象或以其他名称保存文件时，也会使用应用程序名称和文档名称自动调用此选项。 因此，通常不需要直接调用此函数。

有关详细信息，请参阅[IOleObject：：在](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames)Windows SDK 中设置主机名。

## <a name="coleclientitemseticonicmetafile"></a><a name="seticonicmetafile"></a>COleClient项目：：设置图标元文件

缓存用于绘制项目图标的元文件。

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>参数

*哈梅塔皮克特*<br/>
用于绘制项目图标的元文件的句柄。

### <a name="return-value"></a>返回值

如果成功，则不为 0；否则为 0。

### <a name="remarks"></a>备注

使用[GetIconicMeta 文件](#geticonicmetafile)检索元文件。

hMetaPict 参数复制到项中;因此，将*hMetaPict*参数复制到项中。因此 *，hMetaPict*必须由调用方释放。

## <a name="coleclientitemsetitemrects"></a><a name="setitemrects"></a>COleClient项目：设置项目已重

调用此函数以设置边界矩形或 OLE 项的可见矩形。

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>参数

*利普斯雷克*<br/>
指向在客户端坐标中包含 OLE 项相对于其父窗口的边界的矩形的指针。

*lprcClipRect*<br/>
指向在客户端坐标中包含 OLE 项相对于其父窗口的可见部分边界的矩形的指针。

### <a name="return-value"></a>返回值

如果成功，则非零;否则，0。

### <a name="remarks"></a>备注

此函数由[OnChangeItem位置](#onchangeitemposition)成员函数的默认实现调用。 每当 OLE 项目的位置或可见部分发生更改时，都应调用此函数。 通常，这意味着您从视图的[OnSize](../../mfc/reference/cwnd-class.md#onsize)和[OnScrollBy](../../mfc/reference/cview-class.md#onscrollby)成员函数调用它。

有关详细信息，请参阅[IOleInPlace 对象：：在](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)Windows SDK 中设置对象重新对象。

## <a name="coleclientitemsetlinkupdateoptions"></a><a name="setlinkupdateoptions"></a>COleClient项目：设置链接更新选项

调用此函数以设置链接更新选项以表示指定的链接项。

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>参数

*dwUpdateOpt*<br/>
此项目的链接更新选项的值。 此值必须是以下值之一：

- OLEUPDATE_ALWAYS尽可能更新链接的项目。 此选项支持"链接"对话框中的"自动链接更新单选"按钮。

- OLEUPDATE_ONCALL 仅在容器应用程序的请求下更新链接项（在调用[UpdateLink](#updatelink)成员函数时）。 此选项支持"链接"对话框中的"手动链接更新单选"按钮。

### <a name="remarks"></a>备注

通常，不应更改用户在"链接"对话框中选择的更新选项。

有关详细信息，请参阅[IOleLink：设置](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions)Windows SDK 中的更新选项。

## <a name="coleclientitemsetprintdevice"></a><a name="setprintdevice"></a>COleClient项目：设置打印设备

调用此函数以更改此项目的打印目标设备。

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>参数

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)数据结构的指针，其中包含有关新打印目标设备的信息。 可以为 NULL。

*Ppd*<br/>
指向[PRINTDLG](/windows/win32/api/commdlg/ns-commdlg-printdlga)数据结构的指针，该结构包含有关新打印目标设备的信息。 可以为 NULL。

### <a name="return-value"></a>返回值

如果函数成功，则非零;否则 0。

### <a name="remarks"></a>备注

此函数更新项目的打印目标设备，但不会刷新演示文稿缓存。 要更新项目的演示文稿缓存，请调用[UpdateLink](#updatelink)。

此函数的参数包含 OLE 系统用于标识目标设备的信息。 该`PRINTDLG`结构包含 Windows 用于初始化公共打印对话框的信息。 用户关闭对话框后，Windows 将返回有关用户在此结构中选择的信息。 `m_pd` [CPrintDialog](../../mfc/reference/cprintdialog-class.md)对象的成员是一个`PRINTDLG`结构。

有关此结构的详细信息，请参阅 Windows SDK 中的[PRINTDLG。](/windows/win32/api/commdlg/ns-commdlg-printdlga)

有关详细信息，请参阅 Windows SDK 中的[DVTARGETDEVICE。](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)

## <a name="coleclientitemupdatelink"></a><a name="updatelink"></a>COleClient项目：更新链接

调用此函数以立即更新 OLE 项的表示数据。

```
BOOL UpdateLink();
```

### <a name="return-value"></a>返回值

若成功，则为非零；否则为 0。

### <a name="remarks"></a>备注

对于链接项，函数查找链接源以获取 OLE 项的新演示文稿。 此过程可能涉及运行一个或多个服务器应用程序，这可能非常耗时。 对于嵌入项，函数以递归方式操作，检查嵌入项是否包含可能过期的链接并更新它们。 用户还可以使用"链接"对话框手动更新各个链接。

有关详细信息，请参阅[IOleLink：：在](/windows/win32/api/oleidl/nf-oleidl-iolelink-update)Windows SDK 中更新。

## <a name="see-also"></a>另请参阅

[MFC 样品 MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[MFC 样品 OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[CDocItem 类](../../mfc/reference/cdocitem-class.md)<br/>
[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[COleServer 项目类](../../mfc/reference/coleserveritem-class.md)
