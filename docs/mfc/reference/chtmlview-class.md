---
description: 了解详细信息： CHtmlView 类
title: CHtmlView 类
ms.date: 11/04/2016
f1_keywords:
- CHtmlView
- AFXHTML/CHtmlView
- AFXHTML/CHtmlView::Create
- AFXHTML/CHtmlView::CreateControlSite
- AFXHTML/CHtmlView::ExecFormsCommand
- AFXHTML/CHtmlView::ExecWB
- AFXHTML/CHtmlView::GetAddressBar
- AFXHTML/CHtmlView::GetApplication
- AFXHTML/CHtmlView::GetBusy
- AFXHTML/CHtmlView::GetContainer
- AFXHTML/CHtmlView::GetFullName
- AFXHTML/CHtmlView::GetFullScreen
- AFXHTML/CHtmlView::GetHeight
- AFXHTML/CHtmlView::GetHtmlDocument
- AFXHTML/CHtmlView::GetLeft
- AFXHTML/CHtmlView::GetLocationName
- AFXHTML/CHtmlView::GetLocationURL
- AFXHTML/CHtmlView::GetMenuBar
- AFXHTML/CHtmlView::GetOffline
- AFXHTML/CHtmlView::GetParentBrowser
- AFXHTML/CHtmlView::GetProperty
- AFXHTML/CHtmlView::GetReadyState
- AFXHTML/CHtmlView::GetRegisterAsBrowser
- AFXHTML/CHtmlView::GetRegisterAsDropTarget
- AFXHTML/CHtmlView::GetSilent
- AFXHTML/CHtmlView::GetSource
- AFXHTML/CHtmlView::GetStatusBar
- AFXHTML/CHtmlView::GetTheaterMode
- AFXHTML/CHtmlView::GetToolBar
- AFXHTML/CHtmlView::GetTop
- AFXHTML/CHtmlView::GetTopLevelContainer
- AFXHTML/CHtmlView::GetType
- AFXHTML/CHtmlView::GetVisible
- AFXHTML/CHtmlView::GetWidth
- AFXHTML/CHtmlView::GoBack
- AFXHTML/CHtmlView::GoForward
- AFXHTML/CHtmlView::GoHome
- AFXHTML/CHtmlView::GoSearch
- AFXHTML/CHtmlView::LoadFromResource
- AFXHTML/CHtmlView::Navigate
- AFXHTML/CHtmlView::Navigate2
- AFXHTML/CHtmlView::OnBeforeNavigate2
- AFXHTML/CHtmlView::OnCommandStateChange
- AFXHTML/CHtmlView::OnDocumentComplete
- AFXHTML/CHtmlView::OnDocWindowActivate
- AFXHTML/CHtmlView::OnDownloadBegin
- AFXHTML/CHtmlView::OnDownloadComplete
- AFXHTML/CHtmlView::OnEnableModeless
- AFXHTML/CHtmlView::OnFilterDataObject
- AFXHTML/CHtmlView::OnFrameWindowActivate
- AFXHTML/CHtmlView::OnFullScreen
- AFXHTML/CHtmlView::OnGetDropTarget
- AFXHTML/CHtmlView::OnGetExternal
- AFXHTML/CHtmlView::OnGetHostInfo
- AFXHTML/CHtmlView::OnGetOptionKeyPath
- AFXHTML/CHtmlView::OnHideUI
- AFXHTML/CHtmlView::OnMenuBar
- AFXHTML/CHtmlView::OnNavigateComplete2
- AFXHTML/CHtmlView::OnNavigateError
- AFXHTML/CHtmlView::OnNewWindow2
- AFXHTML/CHtmlView::OnProgressChange
- AFXHTML/CHtmlView::OnPropertyChange
- AFXHTML/CHtmlView::OnQuit
- AFXHTML/CHtmlView::OnResizeBorder
- AFXHTML/CHtmlView::OnShowContextMenu
- AFXHTML/CHtmlView::OnShowUI
- AFXHTML/CHtmlView::OnStatusBar
- AFXHTML/CHtmlView::OnStatusTextChange
- AFXHTML/CHtmlView::OnTheaterMode
- AFXHTML/CHtmlView::OnTitleChange
- AFXHTML/CHtmlView::OnToolBar
- AFXHTML/CHtmlView::OnTranslateAccelerator
- AFXHTML/CHtmlView::OnTranslateUrl
- AFXHTML/CHtmlView::OnUpdateUI
- AFXHTML/CHtmlView::OnVisible
- AFXHTML/CHtmlView::PutProperty
- AFXHTML/CHtmlView::QueryFormsCommand
- AFXHTML/CHtmlView::QueryStatusWB
- AFXHTML/CHtmlView::Refresh
- AFXHTML/CHtmlView::Refresh2
- AFXHTML/CHtmlView::SetAddressBar
- AFXHTML/CHtmlView::SetFullScreen
- AFXHTML/CHtmlView::SetHeight
- AFXHTML/CHtmlView::SetLeft
- AFXHTML/CHtmlView::SetMenuBar
- AFXHTML/CHtmlView::SetOffline
- AFXHTML/CHtmlView::SetRegisterAsBrowser
- AFXHTML/CHtmlView::SetRegisterAsDropTarget
- AFXHTML/CHtmlView::SetSilent
- AFXHTML/CHtmlView::SetStatusBar
- AFXHTML/CHtmlView::SetTheaterMode
- AFXHTML/CHtmlView::SetToolBar
- AFXHTML/CHtmlView::SetTop
- AFXHTML/CHtmlView::SetVisible
- AFXHTML/CHtmlView::SetWidth
- AFXHTML/CHtmlView::Stop
helpviewer_keywords:
- CHtmlView [MFC], Create
- CHtmlView [MFC], CreateControlSite
- CHtmlView [MFC], ExecFormsCommand
- CHtmlView [MFC], ExecWB
- CHtmlView [MFC], GetAddressBar
- CHtmlView [MFC], GetApplication
- CHtmlView [MFC], GetBusy
- CHtmlView [MFC], GetContainer
- CHtmlView [MFC], GetFullName
- CHtmlView [MFC], GetFullScreen
- CHtmlView [MFC], GetHeight
- CHtmlView [MFC], GetHtmlDocument
- CHtmlView [MFC], GetLeft
- CHtmlView [MFC], GetLocationName
- CHtmlView [MFC], GetLocationURL
- CHtmlView [MFC], GetMenuBar
- CHtmlView [MFC], GetOffline
- CHtmlView [MFC], GetParentBrowser
- CHtmlView [MFC], GetProperty
- CHtmlView [MFC], GetReadyState
- CHtmlView [MFC], GetRegisterAsBrowser
- CHtmlView [MFC], GetRegisterAsDropTarget
- CHtmlView [MFC], GetSilent
- CHtmlView [MFC], GetSource
- CHtmlView [MFC], GetStatusBar
- CHtmlView [MFC], GetTheaterMode
- CHtmlView [MFC], GetToolBar
- CHtmlView [MFC], GetTop
- CHtmlView [MFC], GetTopLevelContainer
- CHtmlView [MFC], GetType
- CHtmlView [MFC], GetVisible
- CHtmlView [MFC], GetWidth
- CHtmlView [MFC], GoBack
- CHtmlView [MFC], GoForward
- CHtmlView [MFC], GoHome
- CHtmlView [MFC], GoSearch
- CHtmlView [MFC], LoadFromResource
- CHtmlView [MFC], Navigate
- CHtmlView [MFC], Navigate2
- CHtmlView [MFC], OnBeforeNavigate2
- CHtmlView [MFC], OnCommandStateChange
- CHtmlView [MFC], OnDocumentComplete
- CHtmlView [MFC], OnDocWindowActivate
- CHtmlView [MFC], OnDownloadBegin
- CHtmlView [MFC], OnDownloadComplete
- CHtmlView [MFC], OnEnableModeless
- CHtmlView [MFC], OnFilterDataObject
- CHtmlView [MFC], OnFrameWindowActivate
- CHtmlView [MFC], OnFullScreen
- CHtmlView [MFC], OnGetDropTarget
- CHtmlView [MFC], OnGetExternal
- CHtmlView [MFC], OnGetHostInfo
- CHtmlView [MFC], OnGetOptionKeyPath
- CHtmlView [MFC], OnHideUI
- CHtmlView [MFC], OnMenuBar
- CHtmlView [MFC], OnNavigateComplete2
- CHtmlView [MFC], OnNavigateError
- CHtmlView [MFC], OnNewWindow2
- CHtmlView [MFC], OnProgressChange
- CHtmlView [MFC], OnPropertyChange
- CHtmlView [MFC], OnQuit
- CHtmlView [MFC], OnResizeBorder
- CHtmlView [MFC], OnShowContextMenu
- CHtmlView [MFC], OnShowUI
- CHtmlView [MFC], OnStatusBar
- CHtmlView [MFC], OnStatusTextChange
- CHtmlView [MFC], OnTheaterMode
- CHtmlView [MFC], OnTitleChange
- CHtmlView [MFC], OnToolBar
- CHtmlView [MFC], OnTranslateAccelerator
- CHtmlView [MFC], OnTranslateUrl
- CHtmlView [MFC], OnUpdateUI
- CHtmlView [MFC], OnVisible
- CHtmlView [MFC], PutProperty
- CHtmlView [MFC], QueryFormsCommand
- CHtmlView [MFC], QueryStatusWB
- CHtmlView [MFC], Refresh
- CHtmlView [MFC], Refresh2
- CHtmlView [MFC], SetAddressBar
- CHtmlView [MFC], SetFullScreen
- CHtmlView [MFC], SetHeight
- CHtmlView [MFC], SetLeft
- CHtmlView [MFC], SetMenuBar
- CHtmlView [MFC], SetOffline
- CHtmlView [MFC], SetRegisterAsBrowser
- CHtmlView [MFC], SetRegisterAsDropTarget
- CHtmlView [MFC], SetSilent
- CHtmlView [MFC], SetStatusBar
- CHtmlView [MFC], SetTheaterMode
- CHtmlView [MFC], SetToolBar
- CHtmlView [MFC], SetTop
- CHtmlView [MFC], SetVisible
- CHtmlView [MFC], SetWidth
- CHtmlView [MFC], Stop
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
ms.openlocfilehash: 2bd6b1fde083b4b14c7ce149aeaa35868bbd28b3
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/11/2020
ms.locfileid: "97143658"
---
# <a name="chtmlview-class"></a>CHtmlView 类

提供 MFC 文档/视图体系结构上下文中的 Web 浏览器控件功能。

## <a name="syntax"></a>语法

```
class CHtmlView : public CFormView
```

## <a name="members"></a>成员

### <a name="public-methods"></a>公共方法

|“属性”|描述|
|----------|-----------------|
|[CHtmlView：： Create](#create)|创建 WebBrowser 控件。|
|[CHtmlView：： CreateControlSite](#createcontrolsite)|可重写，用于创建控件站点实例以承载窗体上的控件。|
|[CHtmlView：： ExecFormsCommand](#execformscommand)|使用 `IOleCommandTarget::Exec` 方法执行指定的命令。|
|[CHtmlView：： ExecWB](#execwb)|执行命令。|
|[CHtmlView：： GetAddressBar](#getaddressbar)|确定 Internet Explorer 对象的地址栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： GetApplication](#getapplication)|检索一个应用程序对象，该对象表示包含 Internet Explorer 应用程序的当前实例的应用程序。|
|[CHtmlView：： GetBusy](#getbusy)|检索一个值，该值指示下载或其他活动是否仍在进行中。|
|[CHtmlView：： GetContainer](#getcontainer)|检索 WebBrowser 控件的容器。|
|[CHtmlView：： GetFullName](#getfullname)|检索 web 浏览器中显示的资源的完整名称，包括路径。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： GetFullScreen](#getfullscreen)|指示 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。|
|[CHtmlView：： GetHeight](#getheight)|检索 Internet Explorer 主窗口的高度。|
|[CHtmlView：： GetHtmlDocument](#gethtmldocument)|检索活动的 HTML 文档。|
|[CHtmlView：： Shapes.getleft](#getleft)|检索 Internet Explorer 主窗口左边缘的屏幕坐标。|
|[CHtmlView：： GetLocationName](#getlocationname)|检索 WebBrowser 当前正在显示的资源的名称。|
|[CHtmlView：： GetLocationURL](#getlocationurl)|检索 WebBrowser 当前正在显示的资源的 URL。|
|[CHtmlView：： GetMenuBar](#getmenubar)|检索一个值，该值确定菜单栏是否可见。|
|[CHtmlView：： GetOffline](#getoffline)|检索一个值，该值确定控件是否处于脱机状态。|
|[CHtmlView：： GetParentBrowser](#getparentbrowser)|检索指向 `IDispatch` 接口的指针。 有关详细信息，请参阅 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。|
|[CHtmlView：： GetProperty](#getproperty)|检索与给定对象关联的属性的当前值。|
|[CHtmlView：： GetReadyState](#getreadystate)|检索 web 浏览器对象的就绪状态。|
|[CHtmlView：： GetRegisterAsBrowser](#getregisterasbrowser)|指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。|
|[CHtmlView：： GetRegisterAsDropTarget](#getregisterasdroptarget)|指示是否将 WebBrowser 控件注册为导航的放置目标。|
|[CHtmlView：： GetSilent](#getsilent)|指示是否可以显示任何对话框。|
|[CHtmlView：： GetSource](#getsource)|网页的 HTML 源代码。|
|[CHtmlView：： GetStatusBar](#getstatusbar)|指示 Internet Explorer 的状态栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： GetTheaterMode](#gettheatermode)|指示 WebBrowser 控件是否处于影院模式。|
|[CHtmlView：： GetToolBar](#gettoolbar)|检索一个值，该值确定工具栏是否可见。|
|[CHtmlView：： Shapes.gettop](#gettop)|检索 Internet Explorer 主窗口顶部边缘的屏幕坐标。|
|[CHtmlView：： GetTopLevelContainer](#gettoplevelcontainer)|检索一个值，该值指示当前对象是否为 WebBrowser 控件的顶级容器。|
|[CHtmlView：： GetType](#gettype)|检索文档对象的类型名称。|
|[CHtmlView：： GetVisible](#getvisible)|检索一个值，该值指示对象是可见还是隐藏。|
|[CHtmlView：： GetWidth](#getwidth)|检索 Internet Explorer 主窗口的宽度。|
|[CHtmlView：： GoBack](#goback)|导航至历史记录列表中的上一项。|
|[CHtmlView：： GoForward](#goforward)|导航至历史记录列表中的下一项。|
|[CHtmlView::GoHome](#gohome)|导航至当前主页或起始页。|
|[CHtmlView：： GoSearch](#gosearch)|导航至当前搜索页。|
|[CHtmlView：： LoadFromResource](#loadfromresource)|加载 WebBrowser 控件中的资源。|
|[CHtmlView：：导航](#navigate)|导航至由 URL 标识的资源。|
|[CHtmlView：： Navigate2](#navigate2)|导航至由 URL 标识的资源或由完整路径标识的文件。|
|[CHtmlView：： OnBeforeNavigate2](#onbeforenavigate2)|在给定 WebBrowser 中发生导航之前调用（在窗口或框架集元素上）|
|[CHtmlView：： OnCommandStateChange](#oncommandstatechange)|调用以通知应用程序 Web 浏览器命令的启用状态已更改。|
|[CHtmlView：： OnDocumentComplete](#ondocumentcomplete)|调用以通知应用程序文档已达到 READYSTATE_COMPLETE 状态。|
|[CHtmlView：： OnDocWindowActivate](#ondocwindowactivate)|从 [IOleInPlaceActiveObject：： OnDocWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)的 Internet EXPLORER 或 MSHTML 实现调用，它在激活或停用容器的文档窗口时通知活动的就地对象。|
|[CHtmlView：： OnDownloadBegin](#ondownloadbegin)|调用以通知应用程序将开始导航操作|
|[CHtmlView：： OnDownloadComplete](#ondownloadcomplete)|在导航操作完成、暂停或失败时调用。|
|[CHtmlView：： OnEnableModeless](#onenablemodeless)|调用以在容器创建或销毁模式对话框时启用或禁用无模式对话框。|
|[CHtmlView：： OnFilterDataObject](#onfilterdataobject)|由 Internet Explorer 或 MSHTML 对主机调用，以允许主机替换 Internet Explorer 或 MSHTML 的数据对象。|
|[CHtmlView：： Onframewindowactivate 调用](#onframewindowactivate)|当容器的顶级框架窗口被激活或停用时，从 [IOleInPlaceActiveObject：： onframewindowactivate 调用](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 调用以通知对象。|
|[CHtmlView：： OnFullScreen](#onfullscreen)|当 FullScreen 属性已更改时调用。|
|[CHtmlView：： OnGetDropTarget](#ongetdroptarget)|当用作放置目标时由 Internet Explorer 或 MSHTML 调用，以允许主机提供替代的 [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)。|
|[CHtmlView：： OnGetExternal](#ongetexternal)|由 Internet Explorer 或 MSHTML 调用以获取主机的 `IDispatch` 接口。|
|[CHtmlView：： OnGetHostInfo](#ongethostinfo)|检索 Internet Explorer 或 MSHTML 主机的用户界面功能。|
|[CHtmlView：： OnGetOptionKeyPath](#ongetoptionkeypath)|返回 Internet Explorer 或 MSHTML 在其下存储用户首选项的注册表项。|
|[CHtmlView：： OnHideUI](#onhideui)|当 Internet Explorer 或 MSHTML 删除其菜单和工具栏时调用。|
|[CHtmlView：： OnMenuBar](#onmenubar)|当 MenuBar 属性已更改时调用。|
|[CHtmlView：： OnNavigateComplete2](#onnavigatecomplete2)|完成到超链接的导航后调用（在窗口或框架集元素上）。|
|[CHtmlView：： OnNavigateError](#onnavigateerror)|当导航到超链接失败时由框架调用。|
|[CHtmlView：： OnNewWindow2](#onnewwindow2)|当要创建新窗口以显示资源时调用。|
|[CHtmlView：： OnProgressChange](#onprogresschange)|调用以通知应用程序下载操作的进度已更新。|
|[CHtmlView：： OnPropertyChange](#onpropertychange)|调用以通知应用程序 [PutProperty](#putproperty) 方法已更改一个属性的值。|
|[CHtmlView：： OnQuit](#onquit)|调用以通知应用程序 Internet Explorer 应用程序已准备退出。 （仅适用于 Internet Explorer）|
|[CHtmlView：： OnResizeBorder](#onresizeborder)|从 [IOleInPlaceActiveObject：： ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)的 Internet EXPLORER 或 MSHTML 实现调用，它会警告对象调整其边框空间的大小。|
|[CHtmlView：： OnShowContextMenu](#onshowcontextmenu)|当 Internet Explorer 或 MSHTML 将要显示其上下文菜单时，从其调用。|
|[CHtmlView：： OnShowUI](#onshowui)|在 Internet Explorer 或 MSHTML 显示其菜单和工具栏之前调用。|
|[CHtmlView：： OnStatusBar](#onstatusbar)|当 StatusBar 属性已更改时调用。|
|[CHtmlView：： OnStatusTextChange](#onstatustextchange)|调用以通知应用程序与 WebBrowser 控件相关联的状态栏的文本已更改。|
|[CHtmlView：： OnTheaterMode](#ontheatermode)|当 TheaterMode 属性已更改时调用。|
|[CHtmlView：： OnTitleChange](#ontitlechange)|调用以通知应用程序 WebBrowser 控件中的文档的标题是否变为可用或是否更改。|
|[CHtmlView：： OnToolBar](#ontoolbar)|当 ToolBar 属性已更改时调用。|
|[CHtmlView：： OnTranslateAccelerator](#ontranslateaccelerator)|调用 [IOleInPlaceActiveObject：： TranslateAccelerator](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite：： TranslateAccelerator](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 时由 Internet Explorer 或 MSHTML 调用，以处理来自容器的消息队列的菜单快捷键。|
|[CHtmlView：： OnTranslateUrl](#ontranslateurl)|由 Internet Explorer 或 MSHTML 调用以允许主机有机会修改要加载的 URL。|
|[CHtmlView：： OnUpdateUI](#onupdateui)|通知主机命令状态已更改。|
|[CHtmlView：： OnVisible](#onvisible)|当应该显示/隐藏 WebBrowser 控件的窗口时调用。|
|[CHtmlView：:P utProperty](#putproperty)|检索与给定对象关联的属性的值。|
|[CHtmlView：： QueryFormsCommand](#queryformscommand)|查询由用户界面事件生成的一个或多个命令的状态。|
|[CHtmlView：： QueryStatusWB](#querystatuswb)|查询正在由 WebBrowser 控件进行处理的命令的状态。|
|[CHtmlView：： Refresh](#refresh)|重新加载当前文件。|
|[CHtmlView：： Refresh2](#refresh2)|重新加载当前文件并选择性地阻止 `pragma:nocache` 标头被发送。|
|[CHtmlView：： SetAddressBar](#setaddressbar)|显示 或隐藏 Internet Explorer 对象的地址栏。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： SetFullScreen](#setfullscreen)|设置一个值，用于确定 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： SetHeight](#setheight)|设置 Internet Explorer 主窗口的高度。|
|[CHtmlView：： Canvas.setleft](#setleft)|设置 Internet Explorer 主窗口的水平位置。|
|[CHtmlView：： SetMenuBar](#setmenubar)|设置一个值，用以确定控件的菜单栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： SetOffline](#setoffline)|设置一个值，用以确定控件是否处于脱机状态。|
|[CHtmlView：： SetRegisterAsBrowser](#setregisterasbrowser)|设置一个值，指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。|
|[CHtmlView：： SetRegisterAsDropTarget](#setregisterasdroptarget)|设置一个值，指示是否将 WebBrowser 控件注册为导航的放置目标。|
|[CHtmlView：： SetSilent](#setsilent)|设置一个值，用以确定控件是否将显示对话框。|
|[CHtmlView：： SetStatusBar](#setstatusbar)|设置一个值，用以确定 Internet Explorer 的状态栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： SetTheaterMode](#settheatermode)|设置一个值，指示 WebBrowser 控件是否处于影院模式。|
|[CHtmlView：： SetToolBar](#settoolbar)|设置一个值，用以确定控件的工具栏是否可见。 （WebBrowser 控件仅忽略；Internet Explorer。）|
|[CHtmlView：： Canvas.settop](#settop)|设置 Internet Explorer 主窗口的垂直位置。|
|[CHtmlView：： SetVisible](#setvisible)|设置一个值，该值指示对象是可见还是隐藏。|
|[CHtmlView：： SetWidth](#setwidth)|设置 Internet Explorer 主窗口的宽度。|
|[CHtmlView：： Stop](#stop)|停止打开文件。|

## <a name="remarks"></a>备注

WebBrowser 控件是一个窗口，其中用户可以浏览万维网上的站点以及本地文件系统中和网络上的文件夹。 WebBrowser 控件支持超级链接、统一资源定位器 (URL) 导航，并维护历史记录列表。

## <a name="using-the-chtmlview-class-in-an-mfc-application"></a>在 MFC 应用程序中使用 CHtmlView 类

在标准 MFC 框架应用程序（基于 SDI 或 MDI）中，视图对象通常派生自专用的一组类。 这些类全部派生自 `CView`，它们提供 `CView`所没有提供的专用功能。

将 `CHtmlView` 作为应用程序的视图类的基础可向视图提供 WebBrowser 控件。 这将有效地使应用程序成为一个 Web 浏览器。 创建一个 Web 浏览器样式的应用程序的首选方法是使用 MFC 应用程序向导，并将 `CHtmlView` 指定为视图类。 有关在 MFC 应用程序内实现和使用 WebBrowser 控件的详细信息，请参阅 [创建 Web 浏览器样式的应用程序](../../mfc/reference/creating-a-web-browser-style-mfc-application.md)。

> [!NOTE]
> WebBrowser ActiveX 控件（因此 `CHtmlView`）仅可用于在 Windows NT 4.0 版或更高版本（其中安装了 Internet Explorer 4.0 版或更高版本）下运行的程序。

`CHtmlView` 用于可访问 Web（和/或 HTML 文档）的应用程序。 以下 `CHtmlView` 成员函数仅适用于 Internet Explorer 应用程序。 这些函数将在 WebBrowser 控件上成功运行，但不会有明显的效果。

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## <a name="requirements"></a>要求

**标头：** afxhtml.h

## <a name="chtmlviewcreate"></a><a name="create"></a> CHtmlView：： Create

调用此成员函数可为 Internet Explorer 可执行文件创建 WebBrowser 控件或容器。

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>parameters

*lpszClassName*<br/>
指向以 null 结尾的字符串，该字符串对 Windows 类进行命名。 类名称可以是任何注册到 [AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass) global 函数或 Windows 函数的名称 `RegisterClass` 。 如果为 NULL，则使用预定义的默认 [CFrameWnd](../../mfc/reference/cframewnd-class.md) 属性。

*lpszWindowName*<br/>
指向以 null 结尾的字符串，该字符串表示窗口名称。

*dwStyle*<br/>
指定窗口样式特性。 默认情况下，将设置 WS_VISIBLE 和 WS_CHILD Windows 样式。

*rect*<br/>
对 [矩形](/windows/win32/api/windef/ns-windef-rect) 结构的引用，该结构指定窗口的大小和位置。 *RectDefault* 值允许 Windows 指定新窗口的大小和位置。

*pParentWnd*<br/>
指向控件的父窗口的指针。

*nID*<br/>
视图的 ID 号。 默认情况下，设置为 AFX_IDW_PANE_FIRST。

*pContext*<br/>
指向 [CCreateContext](../../mfc/reference/ccreatecontext-structure.md)的指针。 默认值为 NULL。

## <a name="chtmlviewcreatecontrolsite"></a><a name="createcontrolsite"></a> CHtmlView：： CreateControlSite

可重写，用于创建控件站点实例以承载窗体上的控件。

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### <a name="parameters"></a>parameters

*pContainer*<br/>
指向包含控件的 [COleControlContainer](../../mfc/reference/colecontrolcontainer-class.md) 对象的指针。

*ppSite*<br/>
指向 [COleControlSite](../../mfc/reference/colecontrolsite-class.md) 对象的指针的指针，该对象为控件提供站点。

*nID*<br/>
要承载的控件的标识符。

*clsid*<br/>
要承载的控件的 CLSID

### <a name="return-value"></a>返回值

如果成功，则返回 TRUE，否则返回 FALSE。

### <a name="remarks"></a>备注

您可以重写此成员函数以返回您自己的控件站点类的实例。

## <a name="chtmlviewexecformscommand"></a><a name="execformscommand"></a> CHtmlView：： ExecFormsCommand

使用 `IOleCommandTarget::Exec` 方法执行指定的命令。

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### <a name="parameters"></a>parameters

*dwCommandID*<br/>
要执行的命令。 此命令必须属于 CMDSETID3_Forms3 组。

*pVarIn*<br/>
指向 `VARIANT` 包含输入参数的结构的指针。 可以为 NULL。

*pVarOut*<br/>
指向用于 `VARIANT` 接收命令输出的结构的指针。 可以为 NULL。

### <a name="return-value"></a>返回值

标准的 HRESULT 值。 有关可能值的完整列表，请参阅 Windows SDK 中的 [IOleCommandTarget：： Exec](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec) 。

### <a name="remarks"></a>备注

`ExecFormsCommand` 实现 [IOleCommandTarget：： Exec](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec) 方法的行为。

## <a name="chtmlviewexecwb"></a><a name="execwb"></a> CHtmlView：： ExecWB

调用此成员函数以在 WebBrowser 或 Internet Explorer 中执行命令。

```cpp
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### <a name="parameters"></a>parameters

*cmdID*<br/>
要执行的命令。

*cmdexecopt*<br/>
用于执行命令的选项。

*pvaIn*<br/>
用于指定命令输入参数的变量。

*pvaOut*<br/>
用于指定命令输出参数的变量。

### <a name="remarks"></a>备注

请参阅 Windows SDK 中的 [IWebBrowser2：： ExecWB](/previous-versions//aa752117\(v=vs.85\)) 。

## <a name="chtmlviewgetaddressbar"></a><a name="getaddressbar"></a> CHtmlView：： GetAddressBar

调用此成员函数以检索 Internet Explorer 的地址栏。

```
BOOL GetAddressBar() const;
```

### <a name="return-value"></a>返回值

如果地址栏可见，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewgetapplication"></a><a name="getapplication"></a> CHtmlView：： GetApplication

调用此成员函数以检索包含 WebBrowser 控件的应用程序支持的自动化对象。

```
LPDISPATCH GetApplication() const;
```

### <a name="return-value"></a>返回值

指向 `IDispatch` 活动文档对象的接口的指针。 有关详细信息，请参阅 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetbusy"></a><a name="getbusy"></a> CHtmlView：： GetBusy

调用此成员函数以确定 WebBrowser 控件是否参与导航或下载操作。

```
BOOL GetBusy() const;
```

### <a name="return-value"></a>返回值

如果 web 浏览器繁忙，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetcontainer"></a><a name="getcontainer"></a> CHtmlView：： GetContainer

调用此成员函数以检索对象，该对象的计算结果为 web 浏览器的容器。

```
LPDISPATCH GetContainer() const;
```

### <a name="return-value"></a>返回值

指向 `IDispatch` 活动文档对象的接口的指针。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetfullname"></a><a name="getfullname"></a> CHtmlView：： GetFullName

调用此成员函数以检索 Internet Explorer 当前正在显示的文件的完整路径。

```
CString GetFullName() const;
```

### <a name="return-value"></a>返回值

一个 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 对象，其中包含当前显示的文件的路径和名称。 如果不存在任何路径和文件名，则 `GetFullName` 返回空 `CString` 。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewgetfullscreen"></a><a name="getfullscreen"></a> CHtmlView：： GetFullScreen

调用此成员函数以确定 WebBrowser 控件是在全屏模式下还是在正常窗口模式下运行。

```
BOOL GetFullScreen() const;
```

### <a name="return-value"></a>返回值

如果 WebBrowser 在全屏模式下运行，则为非零;否则为零。

### <a name="remarks"></a>备注

在全屏模式下，Internet Explorer 主窗口处于最大化状态，并且状态栏、工具栏、菜单栏和标题栏处于隐藏状态。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetheight"></a><a name="getheight"></a> CHtmlView：： GetHeight

调用此成员函数以检索 WebBrowser 控件的框架窗口的高度（以像素为单位）。

```
long GetHeight() const;
```

### <a name="return-value"></a>返回值

控件的框架窗口高度（以像素为单位）。

## <a name="chtmlviewgethtmldocument"></a><a name="gethtmldocument"></a> CHtmlView：： GetHtmlDocument

调用此成员函数以检索活动文档的 HTML 文档。

```
LPDISPATCH GetHtmlDocument() const;
```

### <a name="return-value"></a>返回值

指向 `IDispatch` 活动文档对象的接口的指针。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetleft"></a><a name="getleft"></a> CHtmlView：： Shapes.getleft

调用此成员函数以检索 WebBrowser 控件的内部左边缘与其容器左边缘之间的距离。

```
long GetLeft() const;
```

### <a name="return-value"></a>返回值

左边缘的距离（以像素为单位）。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetlocationname"></a><a name="getlocationname"></a> CHtmlView：： GetLocationName

调用此成员函数以获取在 WebBrowser 中显示的资源的名称。

```
CString GetLocationName() const;
```

### <a name="return-value"></a>返回值

一个 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 对象，其中包含当前在 WebBrowser 中显示的资源的名称。

### <a name="remarks"></a>备注

如果资源是万维网上的 HTML 页面，则该名称是该页面的标题。 如果资源是网络或本地计算机上的文件夹或文件，则该名称是文件夹或文件的 UNC 或完整路径。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetlocationurl"></a><a name="getlocationurl"></a> CHtmlView：： GetLocationURL

调用此成员函数以检索 WebBrowser 控件当前正在显示的资源的 URL。

```
CString GetLocationURL() const;
```

### <a name="return-value"></a>返回值

一个 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 对象，其中包含当前在 WebBrowser 中显示的资源的 URL。

### <a name="remarks"></a>备注

如果资源是网络或本地计算机上的文件夹或文件，则该名称是文件夹或文件的 UNC 或完整路径。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetmenubar"></a><a name="getmenubar"></a> CHtmlView：： GetMenuBar

调用此成员函数以确定菜单栏是否可见。

```
BOOL GetMenuBar() const;
```

### <a name="return-value"></a>返回值

如果菜单栏可见，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetoffline"></a><a name="getoffline"></a> CHtmlView：： GetOffline

调用此成员函数以确定 web 浏览器是否处于脱机操作状态。

```
BOOL GetOffline() const;
```

### <a name="return-value"></a>返回值

如果 web 浏览器当前处于脱机状态，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetparentbrowser"></a><a name="getparentbrowser"></a> CHtmlView：： GetParentBrowser

调用此成员函数以检索指向 WebBrowser 控件的父对象的指针。

```
LPDISPATCH GetParentBrowser() const;
```

### <a name="return-value"></a>返回值

指向对象的接口的指针 `IDispatch` ，该对象为 WebBrowser 控件的父级。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetproperty"></a><a name="getproperty"></a> CHtmlView：： GetProperty

调用此成员函数以获取当前与该控件关联的属性的值。

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>parameters

*lpszProperty*<br/>
指向字符串的指针，该字符串包含要检索的属性。

*strValue*<br/>
对 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 对象的引用，该对象接收属性的当前值。

### <a name="return-value"></a>返回值

在第一个版本中，如果成功完成，则为非零值;否则为零。 在第二个版本中，是一个 [COleVariant](../../mfc/reference/colevariant-class.md) 对象。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetreadystate"></a><a name="getreadystate"></a> CHtmlView：： GetReadyState

调用此成员函数以检索 WebBrowser 对象的就绪状态。

```
READYSTATE GetReadyState() const;
```

### <a name="return-value"></a>返回值

[READYSTATE](/previous-versions//aa768362\(v=vs.85\))值，如 Windows SDK 中所述。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetregisterasbrowser"></a><a name="getregisterasbrowser"></a> CHtmlView：： GetRegisterAsBrowser

调用此成员函数以确定是否已将 WebBrowser 对象注册为目标名称解析的顶级浏览器。

```
BOOL GetRegisterAsBrowser() const;
```

### <a name="return-value"></a>返回值

如果浏览器注册为顶级浏览器，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetregisterasdroptarget"></a><a name="getregisterasdroptarget"></a> CHtmlView：： GetRegisterAsDropTarget

调用此成员函数以确定是否已将 WebBrowser 控件注册为导航的放置目标。

```
BOOL GetRegisterAsDropTarget() const;
```

### <a name="return-value"></a>返回值

如果浏览器注册为拖放目标，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetsilent"></a><a name="getsilent"></a> CHtmlView：： GetSilent

调用此成员函数以确定是否可以在 WebBrowser 控件中显示任何对话框。

```
BOOL GetSilent() const;
```

### <a name="return-value"></a>返回值

如果无法从 WebBrowser 控件显示对话框，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetsource"></a><a name="getsource"></a> CHtmlView：： GetSource

调用此成员函数以检索网页的 HTML 源代码。

```
BOOL GetSource(CString& strRef);
```

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="parameters"></a>parameters

*refString*<br/>
将保存源代码的 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 。

### <a name="remarks"></a>备注

此函数等效于 Internet Explorer 中的 "View Source" 命令，不同之处在于源代码是在中返回的 `CString` 。

## <a name="chtmlviewgetstatusbar"></a><a name="getstatusbar"></a> CHtmlView：： GetStatusBar

调用此成员函数以确定 WebBrowser 控件是否显示状态栏。

```
BOOL GetStatusBar() const;
```

### <a name="return-value"></a>返回值

如果可显示状态栏，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewgettheatermode"></a><a name="gettheatermode"></a> CHtmlView：： GetTheaterMode

调用此成员函数以确定 web 浏览器是否处于影院模式。

```
BOOL GetTheaterMode() const;
```

### <a name="return-value"></a>返回值

如果 web 浏览器处于电影院模式，则为非零值;否则为零。

### <a name="remarks"></a>备注

当 web 浏览器处于电影院模式时，浏览器主窗口会填充整个屏幕，并显示一组最小的导航工具的工具栏，状态栏将显示在屏幕的右上角。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettoolbar"></a><a name="gettoolbar"></a> CHtmlView：： GetToolBar

调用此成员函数来确定工具栏是否可见。

```
int GetToolBar() const;
```

### <a name="return-value"></a>返回值

一个值，该值指示工具栏是否可见。 如果工具栏可见，则为非零值;否则为零。

## <a name="chtmlviewgettop"></a><a name="gettop"></a> CHtmlView：： Shapes.gettop

调用此成员函数以检索 WebBrowser 控件主窗口上边缘的屏幕坐标。

```
long GetTop() const;
```

### <a name="return-value"></a>返回值

一个变量的地址，该变量接收主窗口顶部边缘的屏幕坐标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettoplevelcontainer"></a><a name="gettoplevelcontainer"></a> CHtmlView：： GetTopLevelContainer

调用此成员函数以确定 Internet Explorer 是否为 WebBrowser 控件的顶级容器。

```
BOOL GetTopLevelContainer() const;
```

### <a name="return-value"></a>返回值

非零：容器是顶级容器;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettype"></a><a name="gettype"></a> CHtmlView：： GetType

调用此成员函数以检索包含的活动文档的类型名称。

```
CString GetType() const;
```

### <a name="return-value"></a>返回值

一个 [CString](../../atl-mfc-shared/reference/cstringt-class.md) 对象，其中包含所包含的活动文档的类型名称。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetvisible"></a><a name="getvisible"></a> CHtmlView：： GetVisible

调用此成员函数来确定包含的对象是否可见。

```
BOOL GetVisible() const;
```

### <a name="return-value"></a>返回值

如果对象可见，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetwidth"></a><a name="getwidth"></a> CHtmlView：： GetWidth

检索 Internet Explorer 主窗口的宽度。

```
long GetWidth() const;
```

### <a name="return-value"></a>返回值

窗口的当前宽度（以像素为单位）。

## <a name="chtmlviewgoback"></a><a name="goback"></a> CHtmlView：： GoBack

向后导航历史记录列表中的一个项。

```cpp
void GoBack();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgoforward"></a><a name="goforward"></a> CHtmlView：： GoForward

在历史记录列表中向前导航一项。

```cpp
void GoForward();
```

## <a name="chtmlviewgohome"></a><a name="gohome"></a> CHtmlView：： GoHome

导航到当前主页，或者启动“Internet Explorer Internet 选项”对话框或“Internet 属性”对话框（可从“控制面板”访问）中指定的网页。

```cpp
void GoHome();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgosearch"></a><a name="gosearch"></a> CHtmlView：： GoSearch

导航到 "Internet Explorer Internet 选项" 对话框或 "Internet 属性" 对话框（可从 "控制面板" 访问）中指定的当前搜索页面。

```cpp
void GoSearch();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewloadfromresource"></a><a name="loadfromresource"></a> CHtmlView：： LoadFromResource

调用此成员函数以将指定的资源加载到 WebBrowser 控件中。

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### <a name="parameters"></a>parameters

*lpszResource*<br/>
指向字符串的指针，该字符串包含要加载的资源的名称。

*nRes*<br/>
包含要加载的资源的名称的缓冲区的 ID。

### <a name="return-value"></a>返回值

如果成功，则不为零，否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewnavigate"></a><a name="navigate"></a> CHtmlView：：导航

调用此成员函数以导航到由 URL 标识的资源。

```cpp
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### <a name="parameters"></a>parameters

*URL*<br/>
调用方分配的字符串，其中包含要导航到的 URL 或要显示的文件的完整路径。

dwFlags <br/>
变量的标志，它指定是否将资源添加到历史记录列表中、是从缓存中读取还是写入，以及是否在新窗口中显示资源。 变量可以是 [BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\)) 枚举定义的值的组合。

*lpszTargetFrameName*<br/>
指向字符串的指针，该字符串包含要在其中显示资源的帧的名称。

*lpszHeaders*<br/>
一个指向值的指针，该值指定要发送到服务器的 HTTP 标头。 这些标头将添加到默认的 Internet Explorer 标头。 标头可以指定此类操作，如服务器所需的操作、要传递给服务器的数据类型或状态代码。 如果 *URL* 不是 HTTP url，则忽略此参数。

*lpvPostData*<br/>
指向要通过 HTTP POST transaction 发送的数据的指针。 例如，POST transaction 用于发送 HTML 窗体收集的数据。 如果此参数未指定任何 post 数据，则 `Navigate` 发出 HTTP GET transaction。 如果 *URL* 不是 HTTP url，则忽略此参数。

*dwPostDataLen*<br/>
要连同 HTTP POST transaction 一起发送的数据。 例如，POST transaction 用于发送 HTML 窗体收集的数据。 如果此参数未指定任何 post 数据，则 `Navigate` 发出 HTTP GET transaction。 如果 *URL* 不是 HTTP url，则忽略此参数。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewnavigate2"></a><a name="navigate2"></a> CHtmlView：： Navigate2

调用此成员函数以导航到由 URL 标识的资源或由完整路径标识的文件。

```cpp
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### <a name="parameters"></a>parameters

*pIDL*<br/>
指向 [ITEMIDLIST](/windows/win32/api/shtypes/ns-shtypes-itemidlist) 结构的指针。

dwFlags <br/>
变量的标志，它指定是否将资源添加到历史记录列表中、是从缓存中读取还是写入，以及是否在新窗口中显示资源。 变量可以是 [BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\)) 枚举定义的值的组合。

*lpszTargetFrameName*<br/>
指向字符串的指针，该字符串包含要在其中显示资源的帧的名称。

*lpszURL*<br/>
指向包含 URL 的字符串的指针。

*lpvPostData*<br/>
要连同 HTTP POST transaction 一起发送的数据。 例如，POST transaction 用于发送 HTML 窗体收集的数据。 如果此参数未指定任何 post 数据，则 `Navigate2` 发出 HTTP GET transaction。 如果 *url* 不是 HTTP 或 HTTPS url，则忽略此参数。

*dwPostDataLen*<br/>
*LpvPostData* 参数指向的数据的长度（以字节为单位）。

*lpszHeaders*<br/>
一个指向值的指针，该值指定要发送到服务器的 HTTP 或 HTTPS 标头。 这些标头将添加到默认的 Internet Explorer 标头。 标头可以指定此类操作，如服务器所需的操作、要传递给服务器的数据类型或状态代码。 如果 *url* 不是 HTTP 或 HTTPS url，则忽略此参数。

*baPostedData*<br/>
对 [CByteArray](../../mfc/reference/cbytearray-class.md) 对象的引用。

### <a name="remarks"></a>备注

此成员函数 `Navigate` 通过支持对参数 *pIDL* 表示的特殊文件夹（如 Desktop 和我的电脑）进行浏览来扩展成员函数。

适用于 Internet Explorer 和 WebBrowser。

### <a name="example"></a>示例

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

## <a name="chtmlviewonbeforenavigate2"></a><a name="onbeforenavigate2"></a> CHtmlView：： OnBeforeNavigate2

此成员函数由框架调用，导致事件在 web 浏览器中发生导航之前激发。

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### <a name="parameters"></a>parameters

*lpszURL*<br/>
指向字符串的指针，该字符串包含要导航到的 URL。

*nFlags*<br/>
留待将来使用。

*lpszTargetFrameName*<br/>
一个字符串，其中包含要在其中显示资源的帧的名称; 如果没有命名框架针对资源，则为 NULL。

*baPostedData*<br/>
对对象的引用， `CByteArray` 该对象包含要在使用 HTTP POST 事务时发送到服务器的数据。

*lpszHeaders*<br/>
一个指向字符串的指针，该字符串包含要发送到服务器 (HTTP Url 仅) 的附加 HTTP 标头。 标头可以指定此类操作，如服务器所需的操作、要传递给服务器的数据类型或状态代码。

*pbCancel*<br/>
指向取消标志的指针。 应用程序可以将此参数设置为非零值以取消导航操作，或设置为零以允许它继续。

## <a name="chtmlviewoncommandstatechange"></a><a name="oncommandstatechange"></a> CHtmlView：： OnCommandStateChange

此成员函数由框架调用，以通知应用程序 web 浏览器命令的启用状态已更改。

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### <a name="parameters"></a>parameters

*N 命令*<br/>
启用状态已更改的命令的标识符。

*bEnable*<br/>
已启用状态。 如果启用该命令，则此参数为非零; 如果已禁用，则为零。

## <a name="chtmlviewondocumentcomplete"></a><a name="ondocumentcomplete"></a> CHtmlView：： OnDocumentComplete

框架调用此成员函数以通知应用程序文档已到达 READYSTATE_COMPLETE 状态。

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### <a name="parameters"></a>parameters

*lpszURL*<br/>
指向字符串的指针，该字符串的计算结果为 URL、UNC 文件名或 PIDL (指向导航到的项标识符列表) 的指针。

### <a name="remarks"></a>备注

并非每个帧都将激发此事件，但触发 [OnDownloadBegin](#ondownloadbegin) 事件的每个帧都将触发相应的 `OnDocumentComplete` 事件。

*LpszURL* 指示的 url 可能不同于浏览器要导航到的 url，因为此 url 是规范化和限定的 url。 例如，如果应用程序 `"www.microsoft.com"` 在调用 [导航](#navigate) 或 [Navigate2](#navigate2)时指定了的 URL，则传递的 url `OnNavigateComplete2` 将为 `"<https://www.microsoft.com/>"` 。 此外，如果服务器已将浏览器重定向到不同的 URL，则重定向的 URL 将反映在此处。

## <a name="chtmlviewondocwindowactivate"></a><a name="ondocwindowactivate"></a> CHtmlView：： OnDocWindowActivate

从的 Internet Explorer 或 MSHTML 实现调用 `IOleInPlaceActiveObject::OnDocWindowActivate` ，它在激活或停用容器的文档窗口时通知活动的就地对象。

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>parameters

*fActivate*<br/>
指示文档窗口的状态。 如果此值为非零值，则将激活窗口。 如果此值为零，则将停用窗口。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnDocWindowActivate` 来响应 `OnDocWindowActivate` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： OnDocWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\)) 。

## <a name="chtmlviewondownloadbegin"></a><a name="ondownloadbegin"></a> CHtmlView：： OnDownloadBegin

此成员函数由框架调用以开始下载文档。

```
virtual void OnDownloadBegin();
```

### <a name="remarks"></a>备注

此事件将在 [OnBeforeNavigate2](#onbeforenavigate2) 事件之后不久触发，除非取消导航。 容器需要显示的任何动画或 "忙" 指示都应连接到此事件。

## <a name="chtmlviewondownloadcomplete"></a><a name="ondownloadcomplete"></a> CHtmlView：： OnDownloadComplete

框架调用此成员函数以指示导航操作已完成、已停止或失败。

```
virtual void OnDownloadComplete();
```

## <a name="chtmlviewonenablemodeless"></a><a name="onenablemodeless"></a> CHtmlView：： OnEnableModeless

当 Internet Explorer 或 MSHTML 显示模式 UI 时调用。

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### <a name="parameters"></a>parameters

*fEnable*<br/>
指示是否启用或禁用宿主的无模式对话框。 如果此值为非零值，则将启用无模式对话框。 如果此值为零，则禁用无模式对话框。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

当容器创建或销毁模式对话框时启用或禁用无模式对话框。 通过重写 `OnEnableModeless` 来响应 `EnableModeless` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： EnableModeless](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\)) 。

## <a name="chtmlviewonfilterdataobject"></a><a name="onfilterdataobject"></a> CHtmlView：： OnFilterDataObject

由 Internet Explorer 或 MSHTML 对主机调用，以允许主机替换 Internet Explorer 或 MSHTML 的数据对象。

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### <a name="parameters"></a>parameters

*pDataObject*<br/>
Internet Explorer 或 MSHTML 提供的 [IDataObject](/windows/win32/api/objidl/nn-objidl-idataobject) 接口的地址。

*ppDataObject*<br/>
接收 `IDataObject` 主机提供的接口指针的地址。 即使方法失败，也应始终将此参数的内容初始化为 NULL。

### <a name="return-value"></a>返回值

S_OK 如果数据对象被替换，则 S_FALSE 如果不替换数据对象，则为; 如果发生错误，则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnFilterDataObject` 来响应 `FilterDataObject` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： FilterDataObject](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\)) 。

## <a name="chtmlviewonframewindowactivate"></a><a name="onframewindowactivate"></a> CHtmlView：： Onframewindowactivate 调用

当容器的顶级框架窗口被激活或停用时，从 [IOleInPlaceActiveObject：： onframewindowactivate 调用](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 调用以通知对象。

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>parameters

*fActivate*<br/>
指示容器的顶级框架窗口的状态。 如果此值为非零值，则将激活窗口。 如果此值为零，则将停用窗口。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnFrameWindowActivate` 来响应 `OnFrameWindowActivate` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： onframewindowactivate 调用](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\)) 。

## <a name="chtmlviewonfullscreen"></a><a name="onfullscreen"></a> CHtmlView：： OnFullScreen

当 " [全屏](/previous-versions/aa752119\(v=vs.85\)) " 属性更改时，框架会调用此成员函数。

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### <a name="parameters"></a>parameters

*bFullScreen*<br/>
如果 Internet Explorer 处于全屏模式，则为非零值;否则为零。

## <a name="chtmlviewongetdroptarget"></a><a name="ongetdroptarget"></a> CHtmlView：： OnGetDropTarget

当用作放置目标时由 Internet Explorer 或 MSHTML 调用以允许主机提供替代的 `IDropTarget`。

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### <a name="parameters"></a>parameters

*pDropTarget*<br/>
[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) 要使用的 Internet Explorer 或 MSHTML 建议使用。

*ppDropTarget*<br/>
的地址 `IDropTarget` ，接收 `IDropTarget` 主机要提供的接口指针。

### <a name="return-value"></a>返回值

有关返回代码的列表，请参阅 Windows SDK 中的 [IDocHostUIHandler：： GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) 。

### <a name="remarks"></a>备注

通过重写 `OnGetDropTarget` 来响应 `GetDropTarget` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) 。

## <a name="chtmlviewongetexternal"></a><a name="ongetexternal"></a> CHtmlView：： OnGetExternal

由 Internet Explorer 或 MSHTML 调用以获取主机的 `IDispatch` 接口。

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### <a name="parameters"></a>parameters

*lppDispatch*<br/>
指向接收 `IDispatch` 主机应用程序的接口指针的地址的指针。 如果主机公开自动化接口，则它可以通过此参数提供对 Internet Explorer 或 MSHTML 的引用。 即使方法失败，也应始终将此参数的内容初始化为 NULL。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnGetExternal` 来响应 `GetExternal` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： GetExternal](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\)) 。

## <a name="chtmlviewongethostinfo"></a><a name="ongethostinfo"></a> CHtmlView：： OnGetHostInfo

检索 Internet Explorer 或 MSHTML 主机的用户界面功能。

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### <a name="parameters"></a>parameters

*pInfo*<br/>
接收宿主 UI 功能的 [DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\)) 结构的地址。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnGetHostInfo` 来响应 `GetHostInfo` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： GetHostInfo](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\)) 。

## <a name="chtmlviewongetoptionkeypath"></a><a name="ongetoptionkeypath"></a> CHtmlView：： OnGetOptionKeyPath

调用此成员函数以获取 Internet Explorer 或 MSHTML 在其下存储用户首选项的注册表项。

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### <a name="parameters"></a>parameters

*pchKey*<br/>
的地址 `LPOLESTR` ，接收注册表子项字符串，其中主机存储其默认选项。 此子项将位于 HKEY_CURRENT_USER 键下。 使用 [CoTaskMemAlloc](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc)分配此内存。 调用应用程序负责使用 [CoTaskMemFree](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree)释放此内存。 即使方法失败，也应始终将此参数初始化为 NULL。

*dwReserved*<br/>
留待将来使用。 当前未使用。

### <a name="return-value"></a>返回值

如果成功，则 S_OK; 否则 S_FALSE。 如果 S_FALSE，Internet Explorer 或 MSHTML 将默认为其自己的用户选项。

### <a name="remarks"></a>备注

通过重写 `OnGetOptionKeyPath` 来响应 `GetOptionKeyPath` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： GetOptionKeyPath](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\)) 。

## <a name="chtmlviewonhideui"></a><a name="onhideui"></a> CHtmlView：： OnHideUI

当 Internet Explorer 或 MSHTML 删除其菜单和工具栏时，框架会调用此成员函数。

```
virtual HRESULT OnHideUI();
```

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnHideUI` 来响应 `HideUI` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： HideUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\)) 。

## <a name="chtmlviewonmenubar"></a><a name="onmenubar"></a> CHtmlView：： OnMenuBar

当 [MenuBar](/previous-versions/aa752131\(v=vs.85\)) 属性已更改时，框架会调用此成员函数。

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### <a name="parameters"></a>parameters

*bMenuBar*<br/>
如果 Internet Explorer 菜单栏可见，则为非零值;否则为零。

## <a name="chtmlviewonnavigatecomplete2"></a><a name="onnavigatecomplete2"></a> CHtmlView：： OnNavigateComplete2

在导航到超链接后，框架将调用此成员函数) 的窗口或框架集元素 (完成。

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### <a name="parameters"></a>parameters

*strURL*<br/>
一个字符串表达式，该表达式的计算结果为 URL、UNC 文件名或 PIDL (指向导航到的项标识符列表) 的指针。

### <a name="remarks"></a>备注

对于没有 URL 表示形式的 shell 命名空间实体，URL 参数可以是 PIDL。

请注意， *strURL* 中包含的 url 可能不同于浏览器要导航到的 url，因为此 url 是规范化和限定的 url。 例如，如果应用程序 `"www.microsoft.com"` 在调用 [导航](#navigate) 或 [Navigate2](#navigate2)时指定了的 URL，则传递的 url `OnNavigateComplete2` 将为 `"<https://www.microsoft.com/>"` 。 此外，如果服务器已将浏览器重定向到不同的 URL，则重定向的 URL 将反映在此处。

## <a name="chtmlviewonnavigateerror"></a><a name="onnavigateerror"></a> CHtmlView：： OnNavigateError

当导航到超链接失败时由框架调用。

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### <a name="parameters"></a>parameters

*lpszURL*<br/>
导航失败的 URL。

*lpszFrame*<br/>
要在其中显示资源的帧的名称; 如果没有任何命名框架针对资源，则为 NULL。

*dwError*<br/>
错误状态代码（如果可用）。 有关可能的 HRESULT 和 HTTP 状态代码的列表，请参阅[NavigateError 事件状态代码。](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768365\(v=vs.85\))

*pbCancel*<br/>
指定是否取消导航到错误页或其他 autosearch。 如果 (默认) 为 TRUE，则继续导航到错误页或 autosearch;如果为 FALSE，则取消导航到错误页或 autosearch。

### <a name="remarks"></a>备注

重写此方法以提供自定义导航错误处理。

有关详细信息，请参阅 [DWebBrowserEvents2：： NavigateError](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768286\(v=vs.85\))

## <a name="chtmlviewonnewwindow2"></a><a name="onnewwindow2"></a> CHtmlView：： OnNewWindow2

当要创建新窗口以显示资源时，框架会调用此成员函数。

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### <a name="parameters"></a>parameters

*ppDisp*<br/>
指向接口指针的指针，该指针可以接收新的 `IDispatch` WebBrowser 或 Internet Explorer 对象的接口指针。

*取消*<br/>
指向取消标志的指针。 应用程序可以将此参数设置为非零值以取消导航操作，或设置为零以允许它继续。

### <a name="remarks"></a>备注

此事件先于在 WebBrowser 中创建新窗口。

## <a name="chtmlviewonprogresschange"></a><a name="onprogresschange"></a> CHtmlView：： OnProgressChange

此成员函数由框架调用，以通知应用程序下载操作的进度已更新。

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### <a name="parameters"></a>parameters

*nProgress*<br/>
要显示的总进度量，或在进度完成时为-1。

*nProgressMax*<br/>
最大进度值。

### <a name="remarks"></a>备注

容器可以使用此事件提供的信息来显示到目前为止下载的字节数，或更新进度指示器。

## <a name="chtmlviewonpropertychange"></a><a name="onpropertychange"></a> CHtmlView：： OnPropertyChange

此成员函数由框架调用，以通知应用程序 [PutProperty](#putproperty) 已更改属性的值。

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>parameters

*lpszProperty*<br/>
指向包含属性名称的字符串的指针。

## <a name="chtmlviewonquit"></a><a name="onquit"></a> CHtmlView：： OnQuit

此成员函数由框架调用，以通知应用程序 Internet Explorer 应用程序已准备好退出。

```
virtual void OnQuit();
```

## <a name="chtmlviewonresizeborder"></a><a name="onresizeborder"></a> CHtmlView：： OnResizeBorder

从 [IOleInPlaceActiveObject：： ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)的 Internet EXPLORER 或 MSHTML 实现调用，它会警告对象调整其边框空间的大小。

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### <a name="parameters"></a>parameters

*prcBorder*<br/>
边框空间的新外部矩形。

*pUIWindow*<br/>
一个指针，指向其边框已更改的框架或文档窗口对象的接口。

*fFrameWindow*<br/>
如果框架窗口正在调用 [IOleInPlaceActiveObject：： ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)，则为 TRUE; 否则为 FALSE。

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnResizeBorder` 来响应 `ResizeBorder` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： ResizeBorder](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\)) 。

## <a name="chtmlviewonshowcontextmenu"></a><a name="onshowcontextmenu"></a> CHtmlView：： OnShowContextMenu

当 Internet Explorer 或 MSHTML 将要显示其上下文菜单时，从其调用。

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### <a name="parameters"></a>parameters

*dwID*<br/>
要显示的上下文菜单的标识符。 有关值的列表，请参阅 `IDocHostUIHandler::ShowContextMenu` 中的 Windows SDK。

*ppt*<br/>
菜单的屏幕坐标。

*pcmdtReserved*<br/>
[IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget) 接口，用于查询命令状态并在此对象上执行命令。

*pdispReserved*<br/>
对象的 IDispatch 接口，以屏幕坐标表示。 这允许宿主区分特定对象，以提供更具体的上下文。

### <a name="return-value"></a>返回值

有关值的列表，请参阅 Windows SDK 中的 [IDocHostUIHandler：： ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) 。

### <a name="remarks"></a>备注

通过重写 `OnShowContextMenu` 来响应 `ShowContextMenu` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) 。

## <a name="chtmlviewonshowui"></a><a name="onshowui"></a> CHtmlView：： OnShowUI

在 Internet Explorer 或 MSHTML 显示其菜单和工具栏之前调用。

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### <a name="parameters"></a>parameters

*dwID*<br/>
留待将来使用。

*pActiveObject*<br/>
当前处于活动状态的对象的[IOleInPlaceActiveObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceactiveobject)接口。

*pCommandTarget*<br/>
对象的[IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget)接口。

*pFrame*<br/>
对象的[IOleInPlaceFrame](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceframe)接口。 这对于菜单和工具栏是必需的。

*pDoc*<br/>
对象的[IOleInPlaceUIWindow](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceuiwindow)接口。 这对于工具栏是必需的。

### <a name="return-value"></a>返回值

有关值的列表，请参阅 Windows SDK 中的 [IDocHostUIHandler：： ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) 。

### <a name="remarks"></a>备注

通过重写 `OnShowUI` 来响应 `ShowUI` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) 。

## <a name="chtmlviewonstatusbar"></a><a name="onstatusbar"></a> CHtmlView：： OnStatusBar

当 [状态栏](/previous-versions//aa768270\(v=vs.85\)) 属性更改时，框架会调用此成员函数。

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### <a name="parameters"></a>parameters

*bStatusBar*<br/>
如果 Internet Explorer 的状态栏可见，则为非零; 否则为零。

## <a name="chtmlviewonstatustextchange"></a><a name="onstatustextchange"></a> CHtmlView：： OnStatusTextChange

此成员函数由框架调用，以通知应用程序与 WebBrowser 控件相关联的状态栏的文本已更改。

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>parameters

*lpszText*<br/>
一个字符串，其中包含新的状态栏文本。

## <a name="chtmlviewontheatermode"></a><a name="ontheatermode"></a> CHtmlView：： OnTheaterMode

当 [TheaterMode](/previous-versions/aa768273\(v=vs.85\)) 属性已更改时，框架会调用此成员函数。

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### <a name="parameters"></a>parameters

*bTheaterMode*<br/>
如果 Internet Explorer 处于电影院模式，则为非零值;否则为零。

## <a name="chtmlviewontitlechange"></a><a name="ontitlechange"></a> CHtmlView：： OnTitleChange

此成员函数由框架调用，以通知应用程序 WebBrowser 控件中的文档的标题是否变为可用或更改。

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>parameters

*lpszText*<br/>
新文档标题。

### <a name="remarks"></a>备注

对于 HTML，标题可能会更改;当 HTML 仍在下载时，文档的 URL 将设置为标题。 在真实标题之后 (如果有一个) 从 HTML 进行了分析，则标题将更改以反映实际的标题。

## <a name="chtmlviewontoolbar"></a><a name="ontoolbar"></a> CHtmlView：： OnToolBar

当 [ToolBar](/previous-versions/aa768274\(v=vs.85\)) 属性已更改时，框架会调用此成员函数。

```
virtual void OnToolBar(BOOL bToolBar);
```

### <a name="parameters"></a>parameters

*bToolBar*<br/>
如果 Internet Explorer 的工具栏可见，则为非零; 否则为零。

## <a name="chtmlviewontranslateaccelerator"></a><a name="ontranslateaccelerator"></a> CHtmlView：： OnTranslateAccelerator

调用 [IOleInPlaceActiveObject：： TranslateAccelerator](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite：： TranslateAccelerator](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 时由 Internet Explorer 或 MSHTML 调用，以处理来自容器的消息队列的菜单快捷键。

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### <a name="parameters"></a>parameters

*lpMsg*<br/>
指向可能需要转换的消息。

*pguidCmdGroup*<br/>
命令组标识符。

*nCmdID*<br/>
命令标识符。

### <a name="return-value"></a>返回值

如果成功，则 S_OK; 否则 S_FALSE。

### <a name="remarks"></a>备注

通过重写 `OnTranslateAccelerator` 来响应 `TranslateAccelerator` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： TranslateAccelerator](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\)) 。

## <a name="chtmlviewontranslateurl"></a><a name="ontranslateurl"></a> CHtmlView：： OnTranslateUrl

由 Internet Explorer 或 MSHTML 调用以允许主机有机会修改要加载的 URL。

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### <a name="parameters"></a>parameters

*dwTranslate*<br/>
留待将来使用。

*pchURLIn*<br/>
Internet Explorer 或 MSHTML 提供的用于表示要转换的 URL 的字符串的地址。

*ppchURLOut*<br/>
接收翻译 URL 地址的字符串指针的地址。 主机使用任务内存分配器分配缓冲区。 即使未翻译 URL 或方法失败，也应始终将此参数的内容初始化为 NULL。

### <a name="return-value"></a>返回值

`S_OK` 如果 URL 已转换，S_FALSE 如果未转换 URL，则为; 如果出现错误，则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

通过重写 `OnTranslateUrl` 来响应 `TranslateUrl` 来自 Microsoft Web 浏览器控件的通知。 有关详细信息，请参阅 Windows SDK 中的 [IDocHostUIHandler：： TranslateUrl](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) 。

## <a name="chtmlviewonupdateui"></a><a name="onupdateui"></a> CHtmlView：： OnUpdateUI

通知主机命令状态已更改。

```
virtual HRESULT OnUpdateUI();
```

### <a name="return-value"></a>返回值

如果成功，则为 S_OK; 否则为 OLE 定义的错误代码。

### <a name="remarks"></a>备注

宿主应更新工具栏按钮的状态。 无论返回值是什么，都将调用此方法 `ShowUI` 。 通过重写 `OnUpdateUI` 来响应 `UpdateUI` 来自 Microsoft Web 浏览器控件的通知。

## <a name="chtmlviewonvisible"></a><a name="onvisible"></a> CHtmlView：： OnVisible

当显示或隐藏 WebBrowser 窗口时，框架会调用此成员函数。

```
virtual void OnVisible(BOOL bVisible);
```

### <a name="parameters"></a>parameters

*bVisible*<br/>
如果对象可见，则为非零; 否则为零。

### <a name="remarks"></a>备注

这允许 "对象控制主机" 窗口的行为方式与 Internet Explorer 窗口的行为方式相同。

## <a name="chtmlviewputproperty"></a><a name="putproperty"></a> CHtmlView：:P utProperty

调用此成员函数以设置与给定对象关联的属性。

```cpp
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### <a name="parameters"></a>parameters

*lpszProperty*<br/>
一个字符串，其中包含要设置的属性。

*vtValue*<br/>
*LpszProperty* 指示的属性的新值。

*lpszPropertyName*<br/>
指向字符串的指针，该字符串包含要设置的属性的名称。

*dValue*<br/>
属性的新值。

*左值*<br/>
属性的新值。

*lpszValue*<br/>
指向字符串的指针，该字符串包含属性的新值。

*N 值*<br/>
属性的新值。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewqueryformscommand"></a><a name="queryformscommand"></a> CHtmlView：： QueryFormsCommand

查询由用户界面事件生成的一个或多个命令的状态。

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### <a name="parameters"></a>parameters

*dwCommandID*<br/>
正在查询的命令的标识符。

*pbSupported*<br/>
一个指向布尔值的指针，该指针指定是否支持由 *dwCommandID*) 标识的命令 (。 如果为 TRUE，则支持命令;否则为 FALSE。

*pbEnabled*<br/>
一个指向布尔值的指针，该指针指定是否启用 *dwCommandID*) 标识的命令 (。 如果为 TRUE，则支持命令;否则为 FALSE。

*pbChecked*<br/>
一个指向布尔值的指针，该指针指定 *dwCommandID*) 标识的命令 (是否选中。 如果为 TRUE，则支持命令;否则为 FALSE。

### <a name="return-value"></a>返回值

标准的 HRESULT 值。 有关可能值的完整列表，请参阅 Windows SDK 中的 [IOleCommandTarget：： QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) 。

### <a name="remarks"></a>备注

`QueryFormsCommand` 实现 [IOleCommandTarget：： QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) 方法的行为。

## <a name="chtmlviewquerystatuswb"></a><a name="querystatuswb"></a> CHtmlView：： QueryStatusWB

调用此成员函数以查询命令状态。

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### <a name="parameters"></a>parameters

*cmdID*<br/>
调用方需要其状态信息的命令的 [OLECMDID](/windows/win32/api/docobj/ne-docobj-olecmdid) 值。

### <a name="return-value"></a>返回值

接收命令状态的 [OLECMDF](/windows/win32/api/docobj/ne-docobj-olecmdf) 值的地址。

### <a name="remarks"></a>备注

`QueryStatusWB` 实现 [IOleCommandTarget：： QueryStatus](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) 方法的行为。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewrefresh"></a><a name="refresh"></a> CHtmlView：： Refresh

重新加载 web 浏览器当前显示的 URL 或文件。

```cpp
void Refresh();
```

### <a name="remarks"></a>备注

`Refresh` 不包含用于设置刷新级别的参数。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewrefresh2"></a><a name="refresh2"></a> CHtmlView：： Refresh2

重新加载 Internet Explorer 当前正在显示的文件。

```cpp
void Refresh2(int nLevel);
```

### <a name="parameters"></a>parameters

*nLevel*<br/>
指定刷新级别的变量的地址。 可能的变量是在 [RefreshConstants](/previous-versions/aa768363\(v=vs.85\))中的 Windows SDK 中定义的。

### <a name="remarks"></a>备注

与 [refresh](#refresh)不同， `Refresh2` 包含一个指定刷新级别的参数。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetaddressbar"></a><a name="setaddressbar"></a> CHtmlView：： SetAddressBar

调用此成员函数以显示或隐藏 Internet Explorer 对象的地址栏。

```cpp
void SetAddressBar(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
非零值表示地址栏;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewsetfullscreen"></a><a name="setfullscreen"></a> CHtmlView：： SetFullScreen

调用此成员函数可将 Internet Explorer 设置为全屏或正常窗口模式。

```cpp
void SetFullScreen(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
对于全屏模式为非零;否则为零。

### <a name="remarks"></a>备注

在全屏模式下，Internet Explorer 主窗口处于最大化状态，并且状态栏、工具栏、菜单栏和标题栏处于隐藏状态。

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewsetheight"></a><a name="setheight"></a> CHtmlView：： SetHeight

调用此成员函数可设置 Internet Explorer 主窗口的高度。

```cpp
void SetHeight(long nNewValue);
```

### <a name="parameters"></a>parameters

*nNewValue*<br/>
主窗口的高度（以像素为单位）。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetleft"></a><a name="setleft"></a> CHtmlView：： Canvas.setleft

设置 Internet Explorer 主窗口的水平位置。

```cpp
void SetLeft(long nNewValue);
```

### <a name="parameters"></a>parameters

*nNewValue*<br/>
主窗口左边缘的屏幕坐标。

## <a name="chtmlviewsetmenubar"></a><a name="setmenubar"></a> CHtmlView：： SetMenuBar

调用此成员函数以显示或隐藏 Internet Explorer 菜单栏。

```cpp
void SetMenuBar(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
非零显示菜单栏;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewsetoffline"></a><a name="setoffline"></a> CHtmlView：： SetOffline

调用此成员函数以设置一个值，该值指示 WebBrowser 控件当前是否在脱机模式下运行。

```cpp
void SetOffline(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
从本地缓存中读取非零值;否则为零。

### <a name="remarks"></a>备注

在脱机模式下，浏览器从本地缓存（而不是源文档）读取 HTML 页面。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetregisterasbrowser"></a><a name="setregisterasbrowser"></a> CHtmlView：： SetRegisterAsBrowser

调用此成员函数以设置一个值，该值指示是否将 WebBrowser 控件注册为目标名称解析的顶级浏览器。

```cpp
void SetRegisterAsBrowser(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
确定是否将 Internet Explorer 注册为顶级浏览器。 如果为非零，则将 web 浏览器注册为顶级浏览器;如果为零，则它不是顶级浏览器。 默认值为零。

### <a name="remarks"></a>备注

顶级浏览器是在注册表中设置为默认浏览器的浏览器。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetregisterasdroptarget"></a><a name="setregisterasdroptarget"></a> CHtmlView：： SetRegisterAsDropTarget

调用此成员函数以设置一个值，该值指示是否将 WebBrowser 控件注册为导航的放置目标。

```cpp
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
确定是否将 WebBrowser 控件注册为导航的放置目标。 如果为非零值，则将对象注册为拖放目标;如果为零，则它不是拖放目标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetsilent"></a><a name="setsilent"></a> CHtmlView：： SetSilent

调用此成员函数以设置一个值，该值指示是否可以显示任何对话框。

```cpp
void SetSilent(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
如果非零，则不会显示对话框;如果为零，则将显示对话框。 默认值为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetstatusbar"></a><a name="setstatusbar"></a> CHtmlView：： SetStatusBar

调用此成员函数以显示状态栏。

```cpp
void SetStatusBar(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
如果状态栏可见，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewsettheatermode"></a><a name="settheatermode"></a> CHtmlView：： SetTheaterMode

调用此成员函数以设置一个值，该值指示 WebBrowser 控件是否处于影院模式。

```cpp
void SetTheaterMode(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
若要将 WebBrowser 控件设置为剧院模式，则为非零值;否则为零。 默认值为零。

### <a name="remarks"></a>备注

当 web 浏览器处于电影院模式时，浏览器主窗口会填充整个屏幕，并显示一组最小的导航工具的工具栏，状态栏将显示在屏幕的右上角。

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsettoolbar"></a><a name="settoolbar"></a> CHtmlView：： SetToolBar

调用此成员函数以显示或隐藏 Internet Explorer 工具栏。

```cpp
void SetToolBar(int nNewValue);
```

### <a name="parameters"></a>parameters

*nNewValue*<br/>
指示是否显示工具栏。 如果要显示工具栏，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer。 如果将此调用与 WebBrowser 控件一起使用，则它将不会返回任何错误，但会忽略此调用。

## <a name="chtmlviewsettop"></a><a name="settop"></a> CHtmlView：： Canvas.settop

调用此成员函数以设置 WebBrowser 控件的内部上边缘与其容器上边缘之间的距离

```cpp
void SetTop(long nNewValue);
```

### <a name="parameters"></a>parameters

*nNewValue*<br/>
主窗口上边缘的屏幕坐标。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetvisible"></a><a name="setvisible"></a> CHtmlView：： SetVisible

调用此成员函数可设置 WebBrowser 控件的可见性状态。

```cpp
void SetVisible(BOOL bNewValue);
```

### <a name="parameters"></a>parameters

*bNewValue*<br/>
如果控件可见，则为非零值;否则为零。

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetwidth"></a><a name="setwidth"></a> CHtmlView：： SetWidth

设置 Internet Explorer 主窗口的宽度。

```cpp
void SetWidth(long nNewValue);
```

### <a name="parameters"></a>parameters

*nNewValue*<br/>
Internet Explorer 主窗口的宽度（以像素为单位）。

## <a name="chtmlviewstop"></a><a name="stop"></a> CHtmlView：： Stop

调用此成员函数可取消任何挂起的导航或下载操作，并停止所有动态页元素（如背景声音和动画）。

```cpp
void Stop();
```

### <a name="remarks"></a>备注

适用于 Internet Explorer 和 WebBrowser。

## <a name="see-also"></a>请参阅

[MFC 示例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CFormView 类](../../mfc/reference/cformview-class.md)<br/>
[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/win32/api/exdisp/nn-exdisp-iwebbrowser2)
