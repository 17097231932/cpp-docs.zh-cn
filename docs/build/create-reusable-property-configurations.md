---
title: 共享或重复使用 Visual Studio 项目设置-C++
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], reusable
ms.openlocfilehash: 451e22997f81753abf0c8d55d3b9e8d097cc6d5d
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/21/2020
ms.locfileid: "80078703"
---
# <a name="share-or-reuse-visual-studio-project-settings"></a>共享或重用 Visual Studio 项目设置

若要创建可与他人共享或在多个项目中重复使用的自定义设置组，请使用**属性管理器**来创建*属性表*（属性文件），以存储希望能够重复使用或与他人共享的每种项目的设置。 与其他创建 "全局" 设置的方法相比，使用属性表并不容易出错。

> [!IMPORTANT]
> **.user 文件以及它们存在问题的原因**
>
> 过去的 Visual Studio 版本使用了全局属性表，此表包含 .user 文件名扩展，并且位于\<userprofile>\AppData\Local\Microsoft\MSBuild\v4.0\ folder。 我们不再推荐这些文件，因为它们是针对每个用户、每台计算机来设置项目配置属性的。 特别是如果你在生成计算机上面向多个平台，此类“全局”设置会影响生成。 例如，如果你同时拥有一个 MFC 项目和 Windows Phone 项目，则其中一个项目的 .user 属性将会无效。 可重用的属性表更为灵活，而且更加可靠。
>
> 尽管 Visual Studio 仍安装 .user 文件并参与属性继承，但默认情况下，这些文件为空。 最佳做法是删除项目在“属性管理器”中的引用，以确保项目按每个计算机设置和每个用户独立运行。这对确保 SCC（源代码管理）环境中的正确行为来说非常重要。

若要显示**属性管理器**，请在菜单栏上选择 "**查看** > **属性管理器** **或 > ** **其他 Windows** > **属性管理器**中，具体取决于您的设置。

如果你想将经常使用的属性集应用于多个项目，则可以使用“属性管理器”在可重用的属性表文件中捕获，按照惯例，文件的扩展名为 .props。 你可以将一张或多张表应用于新项目，这样就不必从零开始设置属性。

![属性管理器快捷菜单](media/sharingnew.png "SharingNew")

在每个配置节点下，将看到适用于该配置的每个属性表的节点。 创建项目时，此系统添加了属性表，该表基于在应用向导中所选的选项来设置值。 右键单击任何节点并选择“属性”来查看适用于该节点的属性。 所有属性表都自动导入到项目的“主”属性表 (ms.cpp.props) 中并进行评估，以便在属性管理器中显示。 可以移动它们来更改评估顺序。 稍后评估的属性表将覆盖之前已评估表中的值。 有关计算顺序的详细信息，[请参阅 .vcxproj](project-property-inheritance.md)文件、属性和 .targets 文件、环境变量和命令行。

如果选择“添加新项目属性表”，然后进行选择（例如 MyProps.props 属性表），将显示属性页对话框。 请注意，适用于 MyProps 属性表；你所做的任何更改都将写入表中，而非属性文件 (.vcxproj) 中。

如果直接在 .vcxproj 文件中设置同一属性，属性表中的属性将被重写。

你可以按所需的频率导入属性表。 一个解决方案中的多个项目可从同一个属性表继承设置，一个项目可有多个表。 属性表自身可以从另一个属性表继承设置。

你还可以为多个配置创建一个属性表。 为此，请为每个配置创建属性表，打开其中一个配置的快捷菜单，选择“添加现有属性表”，然后添加其他表。 但是，如果使用一个常用属性表，请注意在设置属性时，该属性将设置为适用于该工作表的所有配置，并且 IDE 不会显示从给定属性表继承的项目或其他属性表。

在具有多个项目的大型解决方案中，创建解决方案级别的属性表非常有用。 在将项目添加到解决方案时，请使用“属性管理器”将该属性表添加到项目中。 如果项目级别为必填字段，则可以添加一个新属性表以设置指定的项目值。

> [!IMPORTANT]
> 默认情况下，属性文件不参与源代码管理，因为它不是作为项目项创建的。 如果你希望将文件加入源代码管理，则可以手动添加文件作为解决方案项。

#### <a name="to-create-a-property-sheet"></a>创建属性表

1. 在菜单栏上，选择 "**查看** > **属性管理器**或 > **其他 Windows** > **属性管理器**中**查看**。 此时将打开“属性管理器”。

2. 若要定义属性表的范围，请选择属性表适用的项。 这可能是一个特殊配置，或另一个属性表。 打开该项的快捷菜单，然后选择“添加新项目属性表”。 指定名称和位置。

3. 在“属性管理器”中，打开新的属性表然后设置要包括的属性。
