---
title: CMFCPropertyGridProperty 类
ms.date: 11/04/2016
f1_keywords:
- CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AddOption
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AddSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AdjustButtonRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AdjustInPlaceEditRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AllowEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateInPlaceEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateSpinControl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Enable
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::EnableSpinControl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Expand
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::FormatProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetExpandedSubItems
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetHierarchyLevel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetNameTooltip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOption
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOptionCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetParent
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetSubItemsCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetValueTooltip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::HitTest
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsAllowEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsEnabled
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsExpanded
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsGroup
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsInPlaceEditing
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsModified
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsParentExpanded
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsSelected
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsVisible
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnCloseCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDblClk
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawExpandBox
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnEndEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnKillSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnPosSizeChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnRClickName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnRClickValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSelectCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSetCursor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSetSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnUpdateValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::PushChar
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Redraw
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::RemoveAllOptions
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::RemoveSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::ResetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Show
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::HasButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Init
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsValueChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnCtlColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDestroyWindow
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnKillFocus
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatDouble
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatFloat
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatLong
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatShort
helpviewer_keywords:
- CMFCPropertyGridProperty [MFC], CMFCPropertyGridProperty
- CMFCPropertyGridProperty [MFC], AddOption
- CMFCPropertyGridProperty [MFC], AddSubItem
- CMFCPropertyGridProperty [MFC], AdjustButtonRect
- CMFCPropertyGridProperty [MFC], AdjustInPlaceEditRect
- CMFCPropertyGridProperty [MFC], AllowEdit
- CMFCPropertyGridProperty [MFC], CreateInPlaceEdit
- CMFCPropertyGridProperty [MFC], CreateSpinControl
- CMFCPropertyGridProperty [MFC], Enable
- CMFCPropertyGridProperty [MFC], EnableSpinControl
- CMFCPropertyGridProperty [MFC], Expand
- CMFCPropertyGridProperty [MFC], FormatProperty
- CMFCPropertyGridProperty [MFC], GetData
- CMFCPropertyGridProperty [MFC], GetDescription
- CMFCPropertyGridProperty [MFC], GetExpandedSubItems
- CMFCPropertyGridProperty [MFC], GetHierarchyLevel
- CMFCPropertyGridProperty [MFC], GetName
- CMFCPropertyGridProperty [MFC], GetNameTooltip
- CMFCPropertyGridProperty [MFC], GetOption
- CMFCPropertyGridProperty [MFC], GetOptionCount
- CMFCPropertyGridProperty [MFC], GetOriginalValue
- CMFCPropertyGridProperty [MFC], GetParent
- CMFCPropertyGridProperty [MFC], GetRect
- CMFCPropertyGridProperty [MFC], GetSubItem
- CMFCPropertyGridProperty [MFC], GetSubItemsCount
- CMFCPropertyGridProperty [MFC], GetValue
- CMFCPropertyGridProperty [MFC], GetValueTooltip
- CMFCPropertyGridProperty [MFC], HitTest
- CMFCPropertyGridProperty [MFC], IsAllowEdit
- CMFCPropertyGridProperty [MFC], IsEnabled
- CMFCPropertyGridProperty [MFC], IsExpanded
- CMFCPropertyGridProperty [MFC], IsGroup
- CMFCPropertyGridProperty [MFC], IsInPlaceEditing
- CMFCPropertyGridProperty [MFC], IsModified
- CMFCPropertyGridProperty [MFC], IsParentExpanded
- CMFCPropertyGridProperty [MFC], IsSelected
- CMFCPropertyGridProperty [MFC], IsVisible
- CMFCPropertyGridProperty [MFC], OnClickButton
- CMFCPropertyGridProperty [MFC], OnClickName
- CMFCPropertyGridProperty [MFC], OnClickValue
- CMFCPropertyGridProperty [MFC], OnCloseCombo
- CMFCPropertyGridProperty [MFC], OnDblClk
- CMFCPropertyGridProperty [MFC], OnDrawButton
- CMFCPropertyGridProperty [MFC], OnDrawDescription
- CMFCPropertyGridProperty [MFC], OnDrawExpandBox
- CMFCPropertyGridProperty [MFC], OnDrawName
- CMFCPropertyGridProperty [MFC], OnDrawValue
- CMFCPropertyGridProperty [MFC], OnEdit
- CMFCPropertyGridProperty [MFC], OnEndEdit
- CMFCPropertyGridProperty [MFC], OnKillSelection
- CMFCPropertyGridProperty [MFC], OnPosSizeChanged
- CMFCPropertyGridProperty [MFC], OnRClickName
- CMFCPropertyGridProperty [MFC], OnRClickValue
- CMFCPropertyGridProperty [MFC], OnSelectCombo
- CMFCPropertyGridProperty [MFC], OnSetCursor
- CMFCPropertyGridProperty [MFC], OnSetSelection
- CMFCPropertyGridProperty [MFC], OnUpdateValue
- CMFCPropertyGridProperty [MFC], PushChar
- CMFCPropertyGridProperty [MFC], Redraw
- CMFCPropertyGridProperty [MFC], RemoveAllOptions
- CMFCPropertyGridProperty [MFC], RemoveSubItem
- CMFCPropertyGridProperty [MFC], ResetOriginalValue
- CMFCPropertyGridProperty [MFC], SetData
- CMFCPropertyGridProperty [MFC], SetDescription
- CMFCPropertyGridProperty [MFC], SetName
- CMFCPropertyGridProperty [MFC], SetOriginalValue
- CMFCPropertyGridProperty [MFC], SetValue
- CMFCPropertyGridProperty [MFC], Show
- CMFCPropertyGridProperty [MFC], CreateCombo
- CMFCPropertyGridProperty [MFC], HasButton
- CMFCPropertyGridProperty [MFC], Init
- CMFCPropertyGridProperty [MFC], IsSubItem
- CMFCPropertyGridProperty [MFC], IsValueChanged
- CMFCPropertyGridProperty [MFC], OnCtlColor
- CMFCPropertyGridProperty [MFC], OnDestroyWindow
- CMFCPropertyGridProperty [MFC], OnKillFocus
- CMFCPropertyGridProperty [MFC], m_strFormatDouble
- CMFCPropertyGridProperty [MFC], m_strFormatFloat
- CMFCPropertyGridProperty [MFC], m_strFormatLong
- CMFCPropertyGridProperty [MFC], m_strFormatShort
ms.assetid: 36f3fabe-0efe-468b-8a0b-5a7956db38a2
ms.openlocfilehash: a5ac8fec691a3bf8ba3725aa5be0ac9da5ef34b4
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/14/2020
ms.locfileid: "81361817"
---
# <a name="cmfcpropertygridproperty-class"></a>CMFCPropertyGridProperty 类

对象`CMFCPropertyGridProperty`表示属性列表控件中的列表项。

   有关详细信息，请参阅位于 Visual Studio 安装的**VC\\\\atlmfc src\\mfc**文件夹中的源代码。

## <a name="syntax"></a>语法

```
class CMFCPropertyGridProperty : public CObject
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|说明|
|----------|-----------------|
|[CMFC财产网格属性：CMFC财产网格属性](#cmfcpropertygridproperty)|构造 `CMFCPropertyGridProperty` 对象。|
|`CMFCPropertyGridProperty::~CMFCPropertyGridProperty`|析构函数。|

### <a name="public-methods"></a>公共方法

|名称|说明|
|----------|-----------------|
|[CMFC财产网格属性：添加选项](#addoption)|将新的列表项添加到属性列表控件。|
|[CMFC 属性网格属性：：添加子项](#addsubitem)|将子项添加到属性。|
|[CMFC财产网格属性：：调整按钮](#adjustbuttonrect)|由父属性列表控件调用，以告诉属性调整嵌入按钮的边界矩形的大小。|
|[CMFC财产网格属性：：调整位置编辑](#adjustinplaceeditrect)|检索用于设置属性值的文本框和可选旋转按钮控件的边界。|
|[CMFC财产网格属性：：允许编辑](#allowedit)|使属性可编辑或只读。|
|[CMFC财产网格属性：：创建原位编辑](#createinplaceedit)|由框架调用，以创建属性的可编辑控件。|
|[CMFC属性网格属性：：创建斯宾控制](#createspincontrol)|由框架调用以创建可编辑的旋转按钮控件。|
|[CMFC财产网格属性：启用](#enable)|启用或禁用属性。|
|[CMFC属性网格属性：：启用斯宾控制](#enablespincontrol)|启用或禁用用于修改属性值的旋转按钮控件。|
|[CMFC财产网格属性：：展开](#expand)|展开或折叠包含子属性的属性。|
|[CMFC财产网格属性：格式属性](#formatproperty)|设置属性值的文本表示形式的格式。|
|[CMFC财产网格属性：获取数据](#getdata)|检索与属性关联的 DWORD 值。|
|[CMFC财产网格属性：获取描述](#getdescription)|检索属性描述。|
|[CMFC 属性网格属性：获取扩展子项目](#getexpandedsubitems)|检索展开的子项的数量。|
|[CMFC属性网格属性：获取层次结构级别](#gethierarchylevel)|检索属性层次结构级别的零基索引。|
|[CMFC财产网格属性：获取名称](#getname)|检索属性的名称。|
|[CMFC财产网格属性：：获取名称工具提示](#getnametooltip)|由框架调用以在工具提示中显示属性的名称。|
|[CMFC财产网格属性：获取选项](#getoption)|检索由索引指定的选项的文本。|
|[CMFC财产网格属性：获取期权计数](#getoptioncount)|检索属于属性的选项数。|
|[CMFC财产网格属性：获取原始价值](#getoriginalvalue)|检索当前属性的初始值。|
|[CMFC财产网格属性：获取父项](#getparent)|检索指向父属性的指针。|
|[CMFC财产网格属性：获取 Rect](#getrect)|检索属性的边界矩形。|
|[CMFC财产网格属性：获取子项目](#getsubitem)|检索由零基索引标识的子属性。|
|[CMFC属性网格属性：获取子项目计数](#getsubitemscount)|检索子项的数量。|
|`CMFCPropertyGridProperty::GetThisClass`|框架用于获取指向与此类类型关联的[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)对象的指针。|
|[CMFC财产网格属性：获取价值](#getvalue)|检索属性值。|
|[CMFC财产网格属性：获取价值工具提示](#getvaluetooltip)|由框架调用以检索属性值的文本表示形式，然后显示在工具提示中。|
|[CMFC财产网格属性：hitTest](#hittest)|指向对应于点的属性列表项的属性对象。|
|[CMFC财产网格属性：：允许编辑](#isallowedit)|指示属性是否可编辑。|
|[CMFC 属性网格属性：已启用](#isenabled)|指示属性是启用还是禁用。|
|[CMFC财产网格属性：：已扩展](#isexpanded)|指示属性是展开还是折叠。|
|[CMFC财产网格属性：：IsGroup](#isgroup)|指示当前属性是否表示组。|
|[CMFC财产网格属性：：位置编辑](#isinplaceediting)|指示当前属性是否可编辑。|
|[CMFC财产网格属性：已修改](#ismodified)|指示是否修改当前属性。|
|[CMFC财产网格属性：：父级扩展](#isparentexpanded)|指示是否展开当前属性的父项。|
|[CMFC财产网格属性：已选定](#isselected)|指示是否选择了当前属性。|
|[CMFC财产网格属性：可见](#isvisible)|指示当前属性是否可见。|
|[CMFC财产网格属性：：点击按钮](#onclickbutton)|当用户单击属性中包含的按钮时，由框架调用。|
|[CMFC财产网格属性：：点击名称](#onclickname)|当用户单击属性的名称字段时，由父属性列表控件调用。|
|[CMFC财产网格属性：：点击值](#onclickvalue)|当用户单击属性的值字段时，由父属性列表控件调用。|
|[CMFC财产网格属性：：在关闭Combo](#onclosecombo)|当属性中包含的组合框关闭时，由框架调用。|
|[CMFC财产网格属性：：OnDblClk](#ondblclk)|当用户双击属性时，由框架调用。|
|[CMFC财产网格属性：：在绘制按钮](#ondrawbutton)|由框架调用以绘制包含在属性中的按钮。|
|[CMFC财产网格属性：：画中的描述](#ondrawdescription)|由框架调用以显示属性描述。|
|[CMFC财产网格属性：：OnDraw 扩展框](#ondrawexpandbox)|由框架调用，以在包含子属性的属性附近绘制展开框控件。|
|[CMFC财产网格属性：：画名](#ondrawname)|由框架调用以显示属性名称。|
|[CMFC财产网格属性：：拉平价值](#ondrawvalue)|由框架调用以显示属性值。|
|[CMFC财产网格属性：：编辑](#onedit)|当用户要修改属性值时由框架调用。|
|[CMFC财产网格属性：：结束编辑](#onendedit)|当用户完成修改属性值时，由框架调用。|
|[CMFC财产网格属性：：在基尔选择](#onkillselection)||
|[CMFC财产网格属性：：在Possize上更改](#onpossizechanged)||
|[CMFC财产网格属性：：点击名称](#onrclickname)|当用户单击属性名称区域中的鼠标右键时，由框架调用。|
|[CMFC财产网格属性：：点击价值](#onrclickvalue)|当用户单击属性值区域中的鼠标右键时，由框架调用。|
|[CMFC财产网格属性：：在选择Combo](#onselectcombo)|当用户从可编辑组合框中选择项目时，由框架调用。|
|[CMFC财产网格属性：：打开游标](#onsetcursor)|当鼠标指针移动到属性项时，由框架调用。|
|[CMFC财产网格属性：：打开选择](#onsetselection)||
|[CMFC财产网格属性：更新值](#onupdatevalue)|当可编辑属性值已更改时由框架调用。|
|[CMFC财产网格属性：:P](#pushchar)|选择属性并且用户输入新字符时从属性列表控件调用。|
|[CMFC财产网格属性：重绘](#redraw)|重绘属性。|
|[CMFC属性网格属性：：删除所有选项](#removealloptions)|从属性中删除所有选项（项目）。|
|[CMFC 属性网格属性：：删除子项目](#removesubitem)|删除指定的子项。|
|[CMFC财产网格属性：重置原始值](#resetoriginalvalue)|还原编辑属性的原始值。|
|[CMFC财产网格属性：：数据集](#setdata)|将 DWORD 值与属性关联。|
|[CMFC属性网格属性：：设置描述](#setdescription)|指定描述当前属性的文本。|
|[CMFC 属性网格属性：：设置名称](#setname)|设置属性的名称。|
|[CMFC财产网格属性：：设置原始价值](#setoriginalvalue)|设置可编辑属性的原始值。|
|[CMFC财产网格属性：：设置价值](#setvalue)|设置属性网格属性的值。|
|[CMFC财产网格属性：显示](#show)|显示或隐藏属性。|

### <a name="protected-methods"></a>受保护的方法

|名称|说明|
|----------|-----------------|
|[CMFC财产网格属性：创建Combo](#createcombo)|由框架调用，以向属性添加组合框。|
|[CMFC财产网格属性：：哈斯按钮](#hasbutton)|指示属性是否包含按钮。|
|[CMFC财产网格属性：：Init](#init)|由框架调用以初始化属性对象。|
|[CMFC财产网格属性：：是子项目](#issubitem)|指示指定的属性是否是当前属性的子项。|
|[CMFC财产网格属性：：已更改价值](#isvaluechanged)|指示当前属性的值是否已更改。|
|[CMFC财产网格属性：：在CtlColor上](#onctlcolor)|当必须检索画笔以填充属性的背景颜色时，由框架调用。|
|[CMFC财产网格属性：：在销毁窗口上](#ondestroywindow)|当属性被销毁或编辑完成时，由框架调用。|
|[CMFC财产网格属性：：在基尔焦点](#onkillfocus)|当属性失去输入焦点时，由框架调用。|

### <a name="data-members"></a>数据成员

|名称|说明|
|----------|-----------------|
|[CMFCPropertyGridProperty::m_strFormatDouble](#m_strformatdouble)|为类型为双精度值设置字符串的格式。|
|[CMFCPropertyGridProperty::m_strFormatFloat](#m_strformatfloat)|为类型浮点的值格式化字符串。|
|[CMFCPropertyGridProperty::m_strFormatLong](#m_strformatlong)|格式化长类型值的字符串。|
|[CMFCPropertyGridProperty::m_strFormatShort](#m_strformatshort)|格式化短类型值的字符串。|

## <a name="remarks"></a>备注

使用对象`CMFCPropertyGridProperty`表示属性，然后将其添加到属性列表控件。 有关详细信息，请参阅[CMFC财产网格Ctrl 类](../../mfc/reference/cmfcpropertygridctrl-class.md)。

属性对象可以表示数据类型，如字符串、日期和布尔值或整数值。 它可以包含子属性，也可以包含控件，如组合框或按钮控件。

## <a name="example"></a>示例

下面的示例演示如何构造`CMFCPropertyGridProperty`对象。 该示例还演示如何在`CMFCPropertyGridProperty`类中使用各种方法添加选项、添加子项、启用属性以及显示属性。 此示例是["新控件"示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_NewControls#27](../../mfc/reference/codesnippet/cpp/cmfcpropertygridproperty-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)

[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)

## <a name="requirements"></a>要求

**标题：** afxpropertygridctrl.h

## <a name="cmfcpropertygridpropertyaddoption"></a><a name="addoption"></a>CMFC财产网格属性：添加选项

将新的列表项添加到属性列表控件。

```
BOOL AddOption(
    LPCTSTR lpszOption,
    BOOL bInsertUnique=TRUE);
```

### <a name="parameters"></a>参数

*lpszOption*<br/>
[在]要添加的列表项（选项）。

*bInsert 唯一*<br/>
[在]仅在列表项不存在时添加列表项;如果列表项不存在，则仅添加它。否则，FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

TRUE，这意味着将添加列表项。 否则，FALSE，这意味着不会添加列表项，因为*bInsert 唯一*参数为 TRUE，*并且 lpszOption*参数指定的列表项已存在。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyaddsubitem"></a><a name="addsubitem"></a>CMFC 属性网格属性：：添加子项

将子项添加到属性。

```
BOOL AddSubItem(CMFCPropertyGridProperty* pProp);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[在]指向要添加的属性的指针。

### <a name="return-value"></a>返回值

如果指定属性成功添加为子属性，则为 TRUE。 如果未添加该属性，则 FALSE，因为它已在父属性中发生。

### <a name="remarks"></a>备注

使用此方法可以创建父属性和子属性的分层列表。 添加子属性后，父属性将自动显示由加号 （*） 指定的展开框控件。 当用户单击加号时，父属性将展开并显示任何子属性项。

## <a name="cmfcpropertygridpropertyadjustbuttonrect"></a><a name="adjustbuttonrect"></a>CMFC财产网格属性：：调整按钮

由父属性列表控件调用，以告诉属性调整嵌入按钮的边界矩形的大小。

```
virtual void AdjustButtonRect();
```

### <a name="remarks"></a>备注

默认情况下，此方法：

- 调整按钮的宽度等于按钮的高度加上 3 个像素。

- 将按钮的边界矩形移动到属性的右边缘

- 将按钮移至属性上边缘以下 1 像素。

## <a name="cmfcpropertygridpropertyadjustinplaceeditrect"></a><a name="adjustinplaceeditrect"></a>CMFC财产网格属性：：调整位置编辑

检索用于设置属性值的文本框和可选旋转按钮控件的边界。

```
virtual void AdjustInPlaceEditRect(
    CRect& rectEdit,
    CRect& rectSpin);
```

### <a name="parameters"></a>参数

*整编*<br/>
[出]当此方法返回时，一个矩形指定属性值的文本框的边界。

*雷平斯平*<br/>
[出]当此方法返回时，一个矩形指定属性值的旋转按钮控件的边界。 或者，如果属性不支持旋转按钮，则为空矩形。

### <a name="remarks"></a>备注

属性的值区域由文本框和可能*的选项按钮*组成，例如旋转按钮控件。 此方法计算文本框和选项按钮的尺寸，然后在指定的参数中返回这些值。

## <a name="cmfcpropertygridpropertyallowedit"></a><a name="allowedit"></a>CMFC财产网格属性：：允许编辑

使属性可编辑或只读。

```
void AllowEdit(BOOL bAllow=TRUE);
```

### <a name="parameters"></a>参数

*bAllow*<br/>
[在]TRUE 使属性可编辑;FALSE 使属性为只读。 默认值为 TRUE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertycmfcpropertygridproperty"></a><a name="cmfcpropertygridproperty"></a>CMFC财产网格属性：CMFC财产网格属性

构造 `CMFCPropertyGridProperty` 对象。

```
CMFCPropertyGridProperty(
    const CString& strGroupName,
    DWORD_PTR dwData=0,
    BOOL bIsValueList=FALSE);

CMFCPropertyGridProperty(
    const CString& strName,
    const _variant_t& varValue,
    LPCTSTR lpszDescr=NULL,
    DWORD_PTR dwData=0,
    LPCTSTR lpszEditMask=NULL,
    LPCTSTR lpszEditTemplate=NULL,
    LPCTSTR lpszValidChars=NULL);
```

### <a name="parameters"></a>参数

*strGroup名称*<br/>
[在]组名称。 *组*是属性网格控件中相关属性的集合。 如果控件以分层方式显示，*则组名称*将显示为组上方的行中的类别标题。

*dwData*<br/>
[在]特定于应用程序的数据，例如整数或指向与属性关联的其他数据的指针。 默认值为 0。

*strName*<br/>
[在]属性的名称。

*varValue*<br/>
[在]属性值。

*lpszDescr*<br/>
[在]属性描述。 默认值为 NULL。

*lpszEditMask*<br/>
[在]编辑掩码（如果属性是蒙版编辑控件）。 默认值为 NULL。

*lpszEditTemplate*<br/>
[在]编辑模板（如果属性是蒙版编辑控件）。 默认值为 NULL。

*lpszValidChars*<br/>
[在]有效字符的列表（如果属性是蒙版编辑控件）。 默认值为 NULL。

*bIsValueList*<br/>
[在]如果属性表示值列表，则为 TRUE;如果属性表示值列表，则为 TRUE。如果属性表示单个值，则 FALSE。 默认值是 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertycreatecombo"></a><a name="createcombo"></a>CMFC财产网格属性：创建Combo

由框架调用，以向属性添加组合框。

```
virtual CComboBox* CreateCombo(
    CWnd* pWndParent,
    CRect rect);
```

### <a name="parameters"></a>参数

*pwnd 父级*<br/>
[在]指向组合框的父窗口。

*矩形*<br/>
[在]组合框的边界矩形。

### <a name="return-value"></a>返回值

指向新[CComboBox](../../mfc/reference/ccombobox-class.md)对象的指针。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertycreateinplaceedit"></a><a name="createinplaceedit"></a>CMFC财产网格属性：：创建原位编辑

由框架调用，以创建属性的可编辑控件。

```
virtual CWnd* CreateInPlaceEdit(
    CRect rectEdit,
    BOOL& bDefaultFormat);
```

### <a name="parameters"></a>参数

*整编*<br/>
[在]可编辑控件的边界矩形。

*b默认格式*<br/>
[在]TRUE 使用默认属性格式设置可编辑控件的文本;否则，FALSE。

### <a name="return-value"></a>返回值

如果此方法成功，则指向可编辑控件的指针;否则，NULL。

### <a name="remarks"></a>备注

此方法使用[在 CMFCPropertyGrid属性](../../mfc/reference/cmfcpropertygridproperty-class.md)类构造函数中指定的 varValue、lpszEditMask、lpszEditTemplate 和*lpszValidChars*参数的值。 *varValue* *lpszEditMask* *lpszEditTemplate* 默认情况下，此方法支持*varValue*变体类型。 这包括VT_BSTR、VT_R4、VT_R8、VT_UI1、VT_I2、VT_INT、VT_UINT、VT_I4、VT_UI2、VT_UI4和VT_BOOL。

如果指定了一个或多个*lpszEditMask、lpszEditTemplate*或*lpszValidChar 参数*，则此方法将创建一个[CMFCMaskedEdit 控件](../../mfc/reference/cmfcmaskededit-class.md); *lpszEditTemplate*否则，它将创建一个[CEdit](../../mfc/reference/cedit-class.md)控件。

## <a name="cmfcpropertygridpropertycreatespincontrol"></a><a name="createspincontrol"></a>CMFC属性网格属性：：创建斯宾控制

由框架调用以创建可编辑的旋转按钮控件。

```
virtual CSpinButtonCtrl* CreateSpinControl(CRect rectSpin);
```

### <a name="parameters"></a>参数

*雷平斯平*<br/>
[在]定义可编辑旋转按钮控件的矩形。

### <a name="return-value"></a>返回值

指向新的[CMFCSpinButtonCtrl](../../mfc/reference/cmfcspinbuttonctrl-class.md)对象的指针，该对象作为指向[CSpinButtonCtrl](../../mfc/reference/cspinbuttonctrl-class.md)对象的指针进行强制转换。

### <a name="remarks"></a>备注

调用[CMFC 属性网格属性：：启用SpinControl](#enablespincontrol)方法，以在属性的右边缘显示可编辑的旋转按钮控件。

## <a name="cmfcpropertygridpropertyenable"></a><a name="enable"></a>CMFC财产网格属性：启用

启用或禁用属性。

```
void Enable(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 以启用属性;FALSE 以禁用该属性。 禁用的属性不响应鼠标或键盘输入。 默认值为 TRUE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyenablespincontrol"></a><a name="enablespincontrol"></a>CMFC属性网格属性：：启用斯宾控制

启用或禁用用于修改属性值的旋转按钮控件。

```
void EnableSpinControl(
    BOOL bEnable=TRUE,
    int nMin=0,
    int nMax=0);
```

### <a name="parameters"></a>参数

*b 启用*<br/>
[在]TRUE 启用旋转按钮控件;FALSE 以禁用旋转按钮控件。 默认值为 TRUE。

*nMin*<br/>
[在]旋转按钮控件的最小值。 默认值为 0。

*nMax*<br/>
[在]旋转按钮控件的最大值。 默认值为 0。

### <a name="remarks"></a>备注

当要编辑属性时，框架会自动创建旋转按钮控件。

属性类型（由 CMFCPropertyGrid 属性的*varValue*参数指定[：：CMFC属性网格构造函数](#cmfcpropertygridproperty)）必须是受支持的变体类型。 否则，此方法在调试模式下断言。 支持的类型包括VT_INT、VT_UINT、VT_I2、VT_I4、VT_UI2和VT_UI4。

## <a name="cmfcpropertygridpropertyexpand"></a><a name="expand"></a>CMFC财产网格属性：：展开

展开或折叠包含子属性的属性。

```
void Expand(BOOL bExpand=TRUE);
```

### <a name="parameters"></a>参数

*b 扩展*<br/>
[在]TRUE 以扩展属性;FALSE 以折叠属性。 默认值为 TRUE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyformatproperty"></a><a name="formatproperty"></a>CMFC财产网格属性：格式属性

设置属性值的文本表示形式的格式。

```
virtual CString FormatProperty();
```

### <a name="return-value"></a>返回值

属性值的文本表示形式。

### <a name="remarks"></a>备注

在显示属性值之前，框架将调用此方法。

## <a name="cmfcpropertygridpropertygetdata"></a><a name="getdata"></a>CMFC财产网格属性：获取数据

检索与属性关联的 DWORD 值。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>返回值

DWORD 值。

### <a name="remarks"></a>备注

返回的数据是特定于应用程序的值，例如数字或指向其他数据的指针。 在构造属性或调用[CMFCPropertyGrid 属性：：：setData](#setdata)方法时指定数据值。

## <a name="cmfcpropertygridpropertygetdescription"></a><a name="getdescription"></a>CMFC财产网格属性：获取描述

检索属性描述。

```
const CString& GetDescription() const;
```

### <a name="return-value"></a>返回值

包含属性描述的文本字符串。

### <a name="remarks"></a>备注

属性列表控件还使用此方法来显示属性的说明。

## <a name="cmfcpropertygridpropertygetexpandedsubitems"></a><a name="getexpandedsubitems"></a>CMFC 属性网格属性：获取扩展子项目

检索展开的子项的数量。

```
int GetExpandedSubItems(BOOL bIncludeHidden=TRUE) const;
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*b 包括隐藏*|[在]TRUE 以包括在计数中隐藏的子项;否则，FALSE。 默认值为 TRUE。|

### <a name="return-value"></a>返回值

展开的子项的数量。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygethierarchylevel"></a><a name="gethierarchylevel"></a>CMFC属性网格属性：获取层次结构级别

检索属性层次结构级别的零基索引。

```
int GetHierarchyLevel() const;
```

### <a name="return-value"></a>返回值

属性的层次结构级别。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetname"></a><a name="getname"></a>CMFC财产网格属性：获取名称

检索属性的名称。

```
LPCTSTR GetName() const;
```

### <a name="return-value"></a>返回值

指向包含属性名称的字符串的指针。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetnametooltip"></a><a name="getnametooltip"></a>CMFC财产网格属性：：获取名称工具提示

由框架调用以在工具提示中显示属性的名称。

```
virtual CString GetNameTooltip();
```

### <a name="return-value"></a>返回值

一个包含属性名称的字符串。 默认情况下，返回值为空字符串。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetoption"></a><a name="getoption"></a>CMFC财产网格属性：获取选项

检索由索引指定的选项的文本。

```
LPCTSTR GetOption(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
要检索的属性列表项（选项）的零基索引。

### <a name="return-value"></a>返回值

指向包含选项文本的字符串的指针。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetoptioncount"></a><a name="getoptioncount"></a>CMFC财产网格属性：获取期权计数

检索属于属性的选项数。

```
int GetOptionCount() const;
```

### <a name="return-value"></a>返回值

属性控件中包含的属性列表项（选项）的数量。

### <a name="remarks"></a>备注

调用[CMFC 属性网格属性：：AddOption](#addoption)方法以将项添加到属性列表中。 调用[CMFC 属性网格属性：：删除所有选项](#removealloptions)方法以删除所有项目。

## <a name="cmfcpropertygridpropertygetoriginalvalue"></a><a name="getoriginalvalue"></a>CMFC财产网格属性：获取原始价值

检索当前属性的初始值。

```
const COleVariant& GetOriginalValue() const;
```

### <a name="return-value"></a>返回值

当前属性的原始值。

### <a name="remarks"></a>备注

使用此方法可以撤消更改当前属性值的编辑操作的效果。

当前属性的原始值由[CMFC 属性网格属性设置：：CMFC财产网格属性构造函数](#cmfcpropertygridproperty)，由[CMFC 属性网格属性修改：：设置原始值](#setoriginalvalue)方法，并由[CMFC 属性网格属性：：重置原始值](#resetoriginalvalue)方法重置。

## <a name="cmfcpropertygridpropertygetparent"></a><a name="getparent"></a>CMFC财产网格属性：获取父项

检索指向父属性的指针。

```
CMFCPropertyGridProperty* GetParent() const;
```

### <a name="return-value"></a>返回值

指向父属性对象的指针，或顶级属性的 NULL。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetrect"></a><a name="getrect"></a>CMFC财产网格属性：获取 Rect

检索属性的边界矩形。

```
CRect GetRect() const;
```

### <a name="return-value"></a>返回值

描述边界矩形的[CRect](../../atl-mfc-shared/reference/crect-class.md)对象。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetsubitem"></a><a name="getsubitem"></a>CMFC财产网格属性：获取子项目

检索由零基索引标识的子属性。

```
CMFCPropertyGridProperty* GetSubItem(int nIndex) const;
```

### <a name="parameters"></a>参数

*nIndex*<br/>
[在]要检索的属性的零基索引。 如果此参数小于零或大于或等于子属性数，则此参数无效。

### <a name="return-value"></a>返回值

指向作为此属性子项的属性对象的指针。

-或-

在零售模式下，如果*nIndex*参数无效，则 NULL。 在调试模式下，此方法断言。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetsubitemscount"></a><a name="getsubitemscount"></a>CMFC属性网格属性：获取子项目计数

检索子项的数量。

```
int GetSubItemsCount() const;
```

### <a name="return-value"></a>返回值

子项数。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetvalue"></a><a name="getvalue"></a>CMFC财产网格属性：获取价值

检索属性值。

```
virtual const _variant_t& GetValue() const;
```

### <a name="return-value"></a>返回值

包含属性值的变体。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertygetvaluetooltip"></a><a name="getvaluetooltip"></a>CMFC财产网格属性：获取价值工具提示

由框架调用以检索属性值的文本表示形式，然后显示在工具提示中。

```
virtual CString GetValueTooltip();
```

### <a name="return-value"></a>返回值

包含`CString`属性值的文本表示形式的对象。 默认情况下，此值为空字符串。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyhasbutton"></a><a name="hasbutton"></a>CMFC财产网格属性：：哈斯按钮

指示属性是否包含按钮。

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>返回值

如果属性包含按钮（或属性列表），则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyhittest"></a><a name="hittest"></a>CMFC财产网格属性：hitTest

指向对应于点的属性列表项的属性对象。

```
CMFCPropertyGridProperty* HitTest(
    CPoint point,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL);

CMFCPropertyGridProperty* HitTest(
    CPoint pt,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL,
    BOOL bPropsOnly=FALSE) const;
```

### <a name="parameters"></a>参数

*点*<br/>
[在]要测试的点，在客户端坐标中。 此参数通常是当前鼠标指针位置。

*pt*<br/>
[在]要测试的点，在客户端坐标中。

*pnArea*<br/>
[出]当此方法返回时，指示包含指定点的区域。 有关详细信息，请参阅“备注”。 默认值为 NULL。

*bProps*<br/>
[在]TRUE 以测试属性控制中的任何区域;FALSE 仅测试描述区域。 默认值是 FALSE。

### <a name="return-value"></a>返回值

指向属性对象或 NULL 的指针。

### <a name="remarks"></a>备注

默认情况下，如果在任何属性项中找不到指定的点，则此方法将测试属性子项。

下表列出了可返回到*pnArea*参数的值。

|区域|说明|
|----------|-----------------|
|`ClickArea::ClickExpandBox`|展开框控件，由加号 （*） 指定。|
|`ClickArea::ClickName`|属性名称。|
|`ClickArea::ClickValue`|属性值。|

## <a name="cmfcpropertygridpropertyinit"></a><a name="init"></a>CMFC财产网格属性：：Init

由框架调用以初始化属性对象。

```
void Init();
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyisallowedit"></a><a name="isallowedit"></a>CMFC财产网格属性：：允许编辑

指示属性是否可编辑。

```
BOOL IsAllowEdit() const;
```

### <a name="return-value"></a>返回值

如果属性是可编辑的，则为 TRUE;否则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyisenabled"></a><a name="isenabled"></a>CMFC 属性网格属性：已启用

指示属性是启用还是禁用。

```
BOOL IsEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用了该属性，则为 TRUE;如果启用了该属性，则为 TRUE。如果属性已禁用，则 FALSE。

### <a name="remarks"></a>备注

告诉属性是启用还是禁用。

## <a name="cmfcpropertygridpropertyisexpanded"></a><a name="isexpanded"></a>CMFC财产网格属性：：已扩展

指示属性是展开还是折叠。

```
BOOL IsExpanded() const;
```

### <a name="return-value"></a>返回值

如果属性已展开，则为 TRUE;如果属性已折叠，则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyisgroup"></a><a name="isgroup"></a>CMFC财产网格属性：：IsGroup

指示当前属性是否表示组。

```
BOOL IsGroup() const;
```

### <a name="return-value"></a>返回值

如果当前属性对象表示组，则为 TRUE;如果当前属性对象表示组。"如果属性表示值，则 FALSE。

### <a name="remarks"></a>备注

*组*是属性网格控件中相关属性的集合。 如果控件以分层方式显示，*则组名称*将显示为组上方的行中的类别标题。

## <a name="cmfcpropertygridpropertyisinplaceediting"></a><a name="isinplaceediting"></a>CMFC财产网格属性：：位置编辑

指示当前属性是否可编辑。

```
BOOL IsInPlaceEditing() const;
```

### <a name="return-value"></a>返回值

如果当前属性可编辑，则为 TRUE;如果当前属性可编辑，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyismodified"></a><a name="ismodified"></a>CMFC财产网格属性：已修改

指示是否修改当前属性。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>返回值

如果属性被修改，则为 TRUE;如果属性已修改，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyisparentexpanded"></a><a name="isparentexpanded"></a>CMFC财产网格属性：：父级扩展

指示是否展开当前属性的父项。

```
BOOL IsParentExpanded() const;
```

### <a name="return-value"></a>返回值

如果当前属性的所有父项都展开，则为 TRUE;如果父属性折叠，则 FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyisselected"></a><a name="isselected"></a>CMFC财产网格属性：已选定

指示是否选择了当前属性。

```
virtual BOOL IsSelected() const;
```

### <a name="return-value"></a>返回值

如果选择了当前属性，则为 TRUE;如果选择了当前属性，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyissubitem"></a><a name="issubitem"></a>CMFC财产网格属性：：是子项目

指示指定的属性是否是当前属性的子项。

```
BOOL IsSubItem(CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>参数

*pProp*<br/>
[在]指向属性的指针。

### <a name="return-value"></a>返回值

如果指定的属性是当前属性的子项，则为 TRUE;如果指定属性是当前属性的子项，则为 TRUE。否则，FALSE。

## <a name="cmfcpropertygridpropertyisvaluechanged"></a><a name="isvaluechanged"></a>CMFC财产网格属性：：已更改价值

指示当前属性的值是否已更改。

```
virtual BOOL IsValueChanged() const;
```

### <a name="return-value"></a>返回值

如果当前属性的值已更改，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyisvisible"></a><a name="isvisible"></a>CMFC财产网格属性：可见

指示当前属性是否可见。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>返回值

如果当前属性可见，则为 TRUE;如果当前属性为 TRUE，否则;假。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertym_strformatdouble"></a><a name="m_strformatdouble"></a>CMFC财产网格属性：：m_strFormatDouble

为双精度类型值保留格式字符串。

```
static CString m_strFormatDouble;
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertym_strformatfloat"></a><a name="m_strformatfloat"></a>CMFC财产网格属性：：m_strFormatFloat

为类型浮点的值保留格式字符串。

```
static CString m_strFormatFloat;
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertym_strformatlong"></a><a name="m_strformatlong"></a>CMFC财产网格属性：：m_strFormatLong

为长类型的值保留格式字符串。

```
static CString m_strFormatLong;
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertym_strformatshort"></a><a name="m_strformatshort"></a>CMFC财产网格属性：：m_strFormatShort

为短类型值保留格式字符串。

```
static CString m_strFormatShort;
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyonclickbutton"></a><a name="onclickbutton"></a>CMFC财产网格属性：：点击按钮

当用户单击属性中包含的按钮时，由框架调用。

```
virtual void OnClickButton(CPoint point);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]客户端坐标中的点。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。

## <a name="cmfcpropertygridpropertyonclickname"></a><a name="onclickname"></a>CMFC财产网格属性：：点击名称

当用户单击属性的名称字段时，由父属性列表控件调用。

```
virtual void OnClickName(CPoint C);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*C*|[在]客户端坐标中的点。|

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。

## <a name="cmfcpropertygridpropertyonclickvalue"></a><a name="onclickvalue"></a>CMFC财产网格属性：：点击值

当用户单击属性的值字段时，由父属性列表控件调用。

```
virtual BOOL OnClickValue(
    UINT uiMsg,
    CPoint point);
```

### <a name="parameters"></a>参数

*乌伊姆斯格*<br/>
[在]鼠标消息。

*点*<br/>
[在]客户端坐标中的点。

### <a name="return-value"></a>返回值

如果此方法处理了指定的鼠标消息，则为 TRUE;如果此方法处理了指定的鼠标消息。"否则，FALSE。

### <a name="remarks"></a>备注

默认情况下，如果当前属性不可编辑，此方法将返回 FALSE。 否则，与此属性关联的编辑或旋转控件将处理指定的鼠标消息，然后此方法返回 TRUE。

## <a name="cmfcpropertygridpropertyonclosecombo"></a><a name="onclosecombo"></a>CMFC财产网格属性：：在关闭Combo

当属性中包含的组合框关闭时，由框架调用。

```
virtual void OnCloseCombo();
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyonctlcolor"></a><a name="onctlcolor"></a>CMFC财产网格属性：：在CtlColor上

当必须检索画笔以填充属性的背景颜色时，由框架调用。

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*nCtlColor*<br/>
[在]（不使用此参数。

### <a name="return-value"></a>返回值

如果此方法成功，则对画笔的句柄;否则，NULL。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyondblclk"></a><a name="ondblclk"></a>CMFC财产网格属性：：OnDblClk

当用户双击属性时，由框架调用。

```
virtual BOOL OnDblClk(CPoint point);
```

### <a name="parameters"></a>参数

*点*<br/>
[在]客户端坐标中的点。

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

默认情况下，此方法选择属性列表控件中的下一个属性项。

## <a name="cmfcpropertygridpropertyondestroywindow"></a><a name="ondestroywindow"></a>CMFC财产网格属性：：在销毁窗口上

当属性被销毁或编辑完成时，由框架调用。

```
virtual void OnDestroyWindow();
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyondrawbutton"></a><a name="ondrawbutton"></a>CMFC财产网格属性：：在绘制按钮

由框架调用以绘制包含在属性中的按钮。

```
virtual void OnDrawButton(
    CDC* pDC,
    CRect rectButton);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*rectButton*<br/>
[在]指定绘制按钮的位置的边界矩形。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyondrawdescription"></a><a name="ondrawdescription"></a>CMFC财产网格属性：：画中的描述

由框架调用以绘制属性描述。

```
virtual void OnDrawDescription(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*矩形*<br/>
[在]指定绘制属性说明的位置的边界矩形。

### <a name="remarks"></a>备注

默认情况下，此方法在父属性列表控件使用的字体中绘制属性名称和说明。 属性描述以常规样式绘制，属性名称以粗体样式绘制。

## <a name="cmfcpropertygridpropertyondrawexpandbox"></a><a name="ondrawexpandbox"></a>CMFC财产网格属性：：OnDraw 扩展框

由框架调用，以在包含子属性的属性附近绘制展开框控件。

```
virtual void OnDrawExpandBox(
    CDC* pDC,
    CRect rectExpand);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*重新扩展*<br/>
[在]指定绘制展开框控件的位置的边界矩形。

### <a name="remarks"></a>备注

单击展开框控件以展开或折叠子属性列表。 展开框控件由包含加 （+） 或减 （-） 符号的正方形指定。 加号表示可以展开该属性以显示子属性的列表。 减号表示列表可以折叠以仅显示属性。

## <a name="cmfcpropertygridpropertyondrawname"></a><a name="ondrawname"></a>CMFC财产网格属性：：画名

由框架调用以显示属性名称。

```
virtual void OnDrawName(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*矩形*<br/>
[在]指定在何处绘制属性名称的边界矩形。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyondrawvalue"></a><a name="ondrawvalue"></a>CMFC财产网格属性：：拉平价值

由框架调用以显示属性值。

```
virtual void OnDrawValue(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>参数

*pDC*<br/>
[在]指向设备上下文的指针。

*矩形*<br/>
[在]指定绘制属性值的位置的边界矩形。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyonedit"></a><a name="onedit"></a>CMFC财产网格属性：：编辑

当用户要修改属性值时由框架调用。

```
virtual BOOL OnEdit(LPPOINT lptClick);
```

### <a name="parameters"></a>参数

*lptClick*<br/>
[在]（不使用此参数。指向点（在客户端坐标中的指针）。

### <a name="return-value"></a>返回值

如果编辑操作成功启动，则为 TRUE;如果编辑操作成功启动，则为 TRUE。否则，FALSE。

### <a name="remarks"></a>备注

当用户要修改属性值时，框架将调用此功能。 默认情况下，此方法启动组合框控件或旋转控件的相应编辑器。

## <a name="cmfcpropertygridpropertyonendedit"></a><a name="onendedit"></a>CMFC财产网格属性：：结束编辑

当用户完成修改属性值时，由框架调用。

```
virtual BOOL OnEndEdit();
```

### <a name="return-value"></a>返回值

此方法始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法会破坏当前编辑控件，然后返回 TRUE。

## <a name="cmfcpropertygridpropertyonkillfocus"></a><a name="onkillfocus"></a>CMFC财产网格属性：：在基尔焦点

当属性失去输入焦点时，由框架调用。

```
virtual BOOL OnKillFocus(CWnd*);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*CWnd*|[在]（未使用。指向窗口的指针。|

### <a name="return-value"></a>返回值

此方法始终返回 TRUE。

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作，然后返回 TRUE。 如果重写此方法，如果框架可以在属性丢失输入焦点时结束编辑操作，则返回 TRUE。

## <a name="cmfcpropertygridpropertyonkillselection"></a><a name="onkillselection"></a>CMFC财产网格属性：：在基尔选择

```
virtual void OnKillSelection(CMFCPropertyGridProperty*);
```

### <a name="parameters"></a>参数

[在]*CMFC财产&#42;*<br/>

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。

## <a name="cmfcpropertygridpropertyonpossizechanged"></a><a name="onpossizechanged"></a>CMFC财产网格属性：：在Possize上更改

```
virtual void OnPosSizeChanged(CRect);
```

### <a name="parameters"></a>参数

[在]*CRect*<br/>

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。

## <a name="cmfcpropertygridpropertyonrclickname"></a><a name="onrclickname"></a>CMFC财产网格属性：：点击名称

当用户单击属性名称区域中的鼠标右键时，由框架调用。

```
virtual void OnRClickName(CPoint C);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*C*|[在]客户端坐标中的点。|

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。

## <a name="cmfcpropertygridpropertyonrclickvalue"></a><a name="onrclickvalue"></a>CMFC财产网格属性：：点击价值

当用户单击属性值区域中的鼠标右键时，由框架调用。

```
virtual void OnRClickValue(
    CPoint C,
    BOOL B);
```

### <a name="parameters"></a>参数

|参数|说明|
|---------------|-----------------|
|*C*|[在]客户端坐标中的点。|
|*B*|[在]一个布尔。|

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作，*并且 B*参数没有预定义用途。

## <a name="cmfcpropertygridpropertyonselectcombo"></a><a name="onselectcombo"></a>CMFC财产网格属性：：在选择Combo

当用户从可编辑组合框中选择项目时，由框架调用。

```
virtual void OnSelectCombo();
```

### <a name="remarks"></a>备注

默认情况下，此方法使用所选项的文本来更新属性值。

## <a name="cmfcpropertygridpropertyonsetcursor"></a><a name="onsetcursor"></a>CMFC财产网格属性：：打开游标

当鼠标指针移动到属性项时，由框架调用。

```
virtual BOOL OnSetCursor() const;
```

### <a name="return-value"></a>返回值

如果当前属性是变体类型或值列表，并且此方法成功加载插入点（I-beam）鼠标光标，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

此方法支持以下变体类型：VT_INT、VT_I2、VT_I4、VT_UINT、VT_UI1、VT_UI2、VT_UI4、VT_R4、VT_R8和VT_BSTR。

## <a name="cmfcpropertygridpropertyonsetselection"></a><a name="onsetselection"></a>CMFC财产网格属性：：打开选择

```
virtual void OnSetSelection CMFCPropertyGridProperty*);
```

### <a name="parameters"></a>参数

[在]*CMFC财产&#42;*<br/>

### <a name="remarks"></a>备注

默认情况下，此方法不执行任何操作。

## <a name="cmfcpropertygridpropertyonupdatevalue"></a><a name="onupdatevalue"></a>CMFC财产网格属性：更新值

当可编辑属性值已更改时由框架调用。

```
virtual BOOL OnUpdateValue();
```

### <a name="return-value"></a>返回值

如果此方法成功，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertypushchar"></a><a name="pushchar"></a>CMFC财产网格属性：:P

选择属性并且用户输入新字符时从属性列表控件调用。

```
virtual BOOL PushChar(UINT nChar);
```

### <a name="parameters"></a>参数

*n查尔*<br/>
[在]字符。

### <a name="return-value"></a>返回值

如果编辑操作继续，则为 TRUE;否则，FALSE。

### <a name="remarks"></a>备注

此方法支持一个属性，该属性是值列表或以下变体类型之一：VT_INT、VT_I2、VT_I4、VT_UINT、VT_UI1、VT_UI2、VT_UI4、VT_R4、VT_R8和VT_BSTR。

## <a name="cmfcpropertygridpropertyredraw"></a><a name="redraw"></a>CMFC财产网格属性：重绘

重绘属性。

```
void Redraw();
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyremovealloptions"></a><a name="removealloptions"></a>CMFC属性网格属性：：删除所有选项

从属性中删除所有选项（项目）。

```
void RemoveAllOptions();
```

### <a name="remarks"></a>备注

选项也称为属性列表控件的列表项。

## <a name="cmfcpropertygridpropertyremovesubitem"></a><a name="removesubitem"></a>CMFC 属性网格属性：：删除子项目

删除指定的子项。

```
BOOL RemoveSubItem(
    CMFCPropertyGridProperty*& pProp,
    BOOL bDelete=TRUE);
```

### <a name="parameters"></a>参数

*pProp*<br/>
[在]指向属性子项的指针。

*b 删除*<br/>
[在]TRUE 删除*pProp*参数指定的属性对象;否则，FALSE。 默认值为 TRUE。

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

如果要移动指定的子项，请为*bDelete*参数指定 FALSE;即删除子项，然后将其添加到其他位置。

## <a name="cmfcpropertygridpropertyresetoriginalvalue"></a><a name="resetoriginalvalue"></a>CMFC财产网格属性：重置原始值

还原编辑属性的原始值。

```
virtual void ResetOriginalValue();
```

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertysetdata"></a><a name="setdata"></a>CMFC财产网格属性：：数据集

将 DWORD 值与属性关联。

```
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>参数

*dwData*<br/>
[在]特定于应用程序的 32 位值，如整数或指向其他数据的指针。

### <a name="remarks"></a>备注

使用[CMFC 属性网格属性：getData](#getdata)方法检索 DWORD 值。 使用[CMFC 属性网格Ctrl：查找ItemByData](../../mfc/reference/cmfcpropertygridctrl-class.md#finditembydata)方法查找与指定 DWORD 值关联的属性列表项。

## <a name="cmfcpropertygridpropertysetdescription"></a><a name="setdescription"></a>CMFC属性网格属性：：设置描述

指定描述当前属性的文本。

```
void SetDescription(const CString& strDescr);
```

### <a name="parameters"></a>参数

*斯特德施克*<br/>
[在]描述当前属性的文本。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertysetname"></a><a name="setname"></a>CMFC 属性网格属性：：设置名称

设置属性的名称。

```
void SetName(
    LPCTSTR lpszName,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>参数

*lpsz名称*<br/>
[在]属性名称。

*bredraw*<br/>
[在]TRUE 立即重绘属性;否则，FALSE。 默认值为 TRUE。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertysetoriginalvalue"></a><a name="setoriginalvalue"></a>CMFC财产网格属性：：设置原始价值

设置可编辑属性的原始值。

```
virtual void SetOriginalValue(const COleVariant& varValue);
```

### <a name="parameters"></a>参数

*varValue*<br/>
[在]值。

### <a name="remarks"></a>备注

使用[CMFC 属性网格属性：重置原始值](#resetoriginalvalue)方法重置已编辑属性的原始值。

## <a name="cmfcpropertygridpropertysetvalue"></a><a name="setvalue"></a>CMFC财产网格属性：：设置价值

设置属性网格属性的值。

```
virtual void SetValue(const _variant_t& varValue);
```

### <a name="parameters"></a>参数

*varValue*<br/>
[在]对值的引用。

### <a name="remarks"></a>备注

## <a name="cmfcpropertygridpropertyshow"></a><a name="show"></a>CMFC财产网格属性：显示

显示或隐藏属性。

```
void Show(
    BOOL bShow=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>参数

*b显示*<br/>
[在]TRUE 以显示当前属性及其子项;FALSE 以隐藏当前属性及其子项。 默认值为 TRUE。

*b 调整布局*<br/>
[在]TRUE 以重新计算如何绘制属性的标签和值，然后绘制属性;FALSE 用于使用现有计算绘制属性。 默认值为 TRUE。

## <a name="see-also"></a>另请参阅

[层次结构图表](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFC财产网格Ctrl类](../../mfc/reference/cmfcpropertygridctrl-class.md)
