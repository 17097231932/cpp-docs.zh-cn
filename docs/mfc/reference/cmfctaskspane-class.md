---
title: CMFCTasksPane 类
ms.date: 07/02/2019
f1_keywords:
- CMFCTasksPane
- AFXTASKSPANE/CMFCTasksPane
- AFXTASKSPANE/CMFCTasksPane::CMFCTasksPane
- AFXTASKSPANE/CMFCTasksPane::AddGroup
- AFXTASKSPANE/CMFCTasksPane::AddLabel
- AFXTASKSPANE/CMFCTasksPane::AddMRUFilesList
- AFXTASKSPANE/CMFCTasksPane::AddPage
- AFXTASKSPANE/CMFCTasksPane::AddSeparator
- AFXTASKSPANE/CMFCTasksPane::AddTask
- AFXTASKSPANE/CMFCTasksPane::AddWindow
- AFXTASKSPANE/CMFCTasksPane::CollapseAllGroups
- AFXTASKSPANE/CMFCTasksPane::CollapseGroup
- AFXTASKSPANE/CMFCTasksPane::CreateDefaultMiniframe
- AFXTASKSPANE/CMFCTasksPane::CreateMenu
- AFXTASKSPANE/CMFCTasksPane::EnableAnimation
- AFXTASKSPANE/CMFCTasksPane::EnableGroupCollapse
- AFXTASKSPANE/CMFCTasksPane::EnableHistoryMenuButtons
- AFXTASKSPANE/CMFCTasksPane::EnableNavigationToolbar
- AFXTASKSPANE/CMFCTasksPane::EnableOffsetCustomControls
- AFXTASKSPANE/CMFCTasksPane::EnableScrollButtons
- AFXTASKSPANE/CMFCTasksPane::EnableWrapLabels
- AFXTASKSPANE/CMFCTasksPane::EnableWrapTasks
- AFXTASKSPANE/CMFCTasksPane::GetActivePage
- AFXTASKSPANE/CMFCTasksPane::GetGroupCaptionHeight
- AFXTASKSPANE/CMFCTasksPane::GetGroupCaptionHorzOffset
- AFXTASKSPANE/CMFCTasksPane::GetGroupCaptionVertOffset
- AFXTASKSPANE/CMFCTasksPane::GetGroupCount
- AFXTASKSPANE/CMFCTasksPane::GetGroupLocation
- AFXTASKSPANE/CMFCTasksPane::GetGroupVertOffset
- AFXTASKSPANE/CMFCTasksPane::GetHorzMargin
- AFXTASKSPANE/CMFCTasksPane::GetNextPages
- AFXTASKSPANE/CMFCTasksPane::GetPageByGroup
- AFXTASKSPANE/CMFCTasksPane::GetPagesCount
- AFXTASKSPANE/CMFCTasksPane::GetPreviousPages
- AFXTASKSPANE/CMFCTasksPane::GetScrollBarCtrl
- AFXTASKSPANE/CMFCTasksPane::GetTask
- AFXTASKSPANE/CMFCTasksPane::GetTaskCount
- AFXTASKSPANE/CMFCTasksPane::GetTaskGroup
- AFXTASKSPANE/CMFCTasksPane::GetTaskLocation
- AFXTASKSPANE/CMFCTasksPane::GetTasksHorzOffset
- AFXTASKSPANE/CMFCTasksPane::GetTasksIconHorzOffset
- AFXTASKSPANE/CMFCTasksPane::GetTasksIconVertOffset
- AFXTASKSPANE/CMFCTasksPane::GetVertMargin
- AFXTASKSPANE/CMFCTasksPane::IsAccessibilityCompatible
- AFXTASKSPANE/CMFCTasksPane::IsAnimationEnabled
- AFXTASKSPANE/CMFCTasksPane::IsBackButtonEnabled
- AFXTASKSPANE/CMFCTasksPane::IsForwardButtonEnabled
- AFXTASKSPANE/CMFCTasksPane::IsGroupCollapseEnabled
- AFXTASKSPANE/CMFCTasksPane::IsHistoryMenuButtonsEnabled
- AFXTASKSPANE/CMFCTasksPane::IsNavigationToolbarEnabled
- AFXTASKSPANE/CMFCTasksPane::IsToolBox
- AFXTASKSPANE/CMFCTasksPane::IsWrapLabelsEnabled
- AFXTASKSPANE/CMFCTasksPane::IsWrapTasksEnabled
- AFXTASKSPANE/CMFCTasksPane::LoadState
- AFXTASKSPANE/CMFCTasksPane::OnCancel
- AFXTASKSPANE/CMFCTasksPane::OnClickTask
- AFXTASKSPANE/CMFCTasksPane::OnOK
- AFXTASKSPANE/CMFCTasksPane::OnPressBackButton
- AFXTASKSPANE/CMFCTasksPane::OnPressForwardButton
- AFXTASKSPANE/CMFCTasksPane::OnPressHomeButton
- AFXTASKSPANE/CMFCTasksPane::OnPressOtherButton
- AFXTASKSPANE/CMFCTasksPane::OnSetAccData
- AFXTASKSPANE/CMFCTasksPane::OnUpdateCmdUI
- AFXTASKSPANE/CMFCTasksPane::PreTranslateMessage
- AFXTASKSPANE/CMFCTasksPane::RecalcLayout
- AFXTASKSPANE/CMFCTasksPane::RemoveAllGroups
- AFXTASKSPANE/CMFCTasksPane::RemoveAllPages
- AFXTASKSPANE/CMFCTasksPane::RemoveAllTasks
- AFXTASKSPANE/CMFCTasksPane::RemoveGroup
- AFXTASKSPANE/CMFCTasksPane::RemovePage
- AFXTASKSPANE/CMFCTasksPane::RemoveTask
- AFXTASKSPANE/CMFCTasksPane::SaveState
- AFXTASKSPANE/CMFCTasksPane::Serialize
- AFXTASKSPANE/CMFCTasksPane::SetActivePage
- AFXTASKSPANE/CMFCTasksPane::SetCaption
- AFXTASKSPANE/CMFCTasksPane::SetGroupCaptionHeight
- AFXTASKSPANE/CMFCTasksPane::SetGroupCaptionHorzOffset
- AFXTASKSPANE/CMFCTasksPane::SetGroupCaptionVertOffset
- AFXTASKSPANE/CMFCTasksPane::SetGroupName
- AFXTASKSPANE/CMFCTasksPane::SetGroupTextColor
- AFXTASKSPANE/CMFCTasksPane::SetGroupVertOffset
- AFXTASKSPANE/CMFCTasksPane::SetHorzMargin
- AFXTASKSPANE/CMFCTasksPane::SetIconsList
- AFXTASKSPANE/CMFCTasksPane::SetPageCaption
- AFXTASKSPANE/CMFCTasksPane::SetTaskName
- AFXTASKSPANE/CMFCTasksPane::SetTasksIconHorzOffset
- AFXTASKSPANE/CMFCTasksPane::SetTasksIconVertOffset
- AFXTASKSPANE/CMFCTasksPane::SetTaskTextColor
- AFXTASKSPANE/CMFCTasksPane::SetTasksHorzOffset
- AFXTASKSPANE/CMFCTasksPane::SetVertMargin
- AFXTASKSPANE/CMFCTasksPane::SetWindowHeight
- AFXTASKSPANE/CMFCTasksPane::ShowCommandMessageString
- AFXTASKSPANE/CMFCTasksPane::ShowTask
- AFXTASKSPANE/CMFCTasksPane::ShowTaskByCmdId
- AFXTASKSPANE/CMFCTasksPane::Update
- AFXTASKSPANE/CMFCTasksPane::OnActivateTasksPanePage
helpviewer_keywords:
- CMFCTasksPane [MFC], CMFCTasksPane
- CMFCTasksPane [MFC], AddGroup
- CMFCTasksPane [MFC], AddLabel
- CMFCTasksPane [MFC], AddMRUFilesList
- CMFCTasksPane [MFC], AddPage
- CMFCTasksPane [MFC], AddSeparator
- CMFCTasksPane [MFC], AddTask
- CMFCTasksPane [MFC], AddWindow
- CMFCTasksPane [MFC], CollapseAllGroups
- CMFCTasksPane [MFC], CollapseGroup
- CMFCTasksPane [MFC], CreateDefaultMiniframe
- CMFCTasksPane [MFC], CreateMenu
- CMFCTasksPane [MFC], EnableAnimation
- CMFCTasksPane [MFC], EnableGroupCollapse
- CMFCTasksPane [MFC], EnableHistoryMenuButtons
- CMFCTasksPane [MFC], EnableNavigationToolbar
- CMFCTasksPane [MFC], EnableOffsetCustomControls
- CMFCTasksPane [MFC], EnableScrollButtons
- CMFCTasksPane [MFC], EnableWrapLabels
- CMFCTasksPane [MFC], EnableWrapTasks
- CMFCTasksPane [MFC], GetActivePage
- CMFCTasksPane [MFC], GetGroupCaptionHeight
- CMFCTasksPane [MFC], GetGroupCaptionHorzOffset
- CMFCTasksPane [MFC], GetGroupCaptionVertOffset
- CMFCTasksPane [MFC], GetGroupCount
- CMFCTasksPane [MFC], GetGroupLocation
- CMFCTasksPane [MFC], GetGroupVertOffset
- CMFCTasksPane [MFC], GetHorzMargin
- CMFCTasksPane [MFC], GetNextPages
- CMFCTasksPane [MFC], GetPageByGroup
- CMFCTasksPane [MFC], GetPagesCount
- CMFCTasksPane [MFC], GetPreviousPages
- CMFCTasksPane [MFC], GetScrollBarCtrl
- CMFCTasksPane [MFC], GetTask
- CMFCTasksPane [MFC], GetTaskCount
- CMFCTasksPane [MFC], GetTaskGroup
- CMFCTasksPane [MFC], GetTaskLocation
- CMFCTasksPane [MFC], GetTasksHorzOffset
- CMFCTasksPane [MFC], GetTasksIconHorzOffset
- CMFCTasksPane [MFC], GetTasksIconVertOffset
- CMFCTasksPane [MFC], GetVertMargin
- CMFCTasksPane [MFC], IsAccessibilityCompatible
- CMFCTasksPane [MFC], IsAnimationEnabled
- CMFCTasksPane [MFC], IsBackButtonEnabled
- CMFCTasksPane [MFC], IsForwardButtonEnabled
- CMFCTasksPane [MFC], IsGroupCollapseEnabled
- CMFCTasksPane [MFC], IsHistoryMenuButtonsEnabled
- CMFCTasksPane [MFC], IsNavigationToolbarEnabled
- CMFCTasksPane [MFC], IsToolBox
- CMFCTasksPane [MFC], IsWrapLabelsEnabled
- CMFCTasksPane [MFC], IsWrapTasksEnabled
- CMFCTasksPane [MFC], LoadState
- CMFCTasksPane [MFC], OnCancel
- CMFCTasksPane [MFC], OnClickTask
- CMFCTasksPane [MFC], OnOK
- CMFCTasksPane [MFC], OnPressBackButton
- CMFCTasksPane [MFC], OnPressForwardButton
- CMFCTasksPane [MFC], OnPressHomeButton
- CMFCTasksPane [MFC], OnPressOtherButton
- CMFCTasksPane [MFC], OnSetAccData
- CMFCTasksPane [MFC], OnUpdateCmdUI
- CMFCTasksPane [MFC], PreTranslateMessage
- CMFCTasksPane [MFC], RecalcLayout
- CMFCTasksPane [MFC], RemoveAllGroups
- CMFCTasksPane [MFC], RemoveAllPages
- CMFCTasksPane [MFC], RemoveAllTasks
- CMFCTasksPane [MFC], RemoveGroup
- CMFCTasksPane [MFC], RemovePage
- CMFCTasksPane [MFC], RemoveTask
- CMFCTasksPane [MFC], SaveState
- CMFCTasksPane [MFC], Serialize
- CMFCTasksPane [MFC], SetActivePage
- CMFCTasksPane [MFC], SetCaption
- CMFCTasksPane [MFC], SetGroupCaptionHeight
- CMFCTasksPane [MFC], SetGroupCaptionHorzOffset
- CMFCTasksPane [MFC], SetGroupCaptionVertOffset
- CMFCTasksPane [MFC], SetGroupName
- CMFCTasksPane [MFC], SetGroupTextColor
- CMFCTasksPane [MFC], SetGroupVertOffset
- CMFCTasksPane [MFC], SetHorzMargin
- CMFCTasksPane [MFC], SetIconsList
- CMFCTasksPane [MFC], SetPageCaption
- CMFCTasksPane [MFC], SetTaskName
- CMFCTasksPane [MFC], SetTasksIconHorzOffset
- CMFCTasksPane [MFC], SetTasksIconVertOffset
- CMFCTasksPane [MFC], SetTaskTextColor
- CMFCTasksPane [MFC], SetTasksHorzOffset
- CMFCTasksPane [MFC], SetVertMargin
- CMFCTasksPane [MFC], SetWindowHeight
- CMFCTasksPane [MFC], ShowCommandMessageString
- CMFCTasksPane [MFC], ShowTask
- CMFCTasksPane [MFC], ShowTaskByCmdId
- CMFCTasksPane [MFC], Update
- CMFCTasksPane [MFC], OnActivateTasksPanePage
ms.assetid: b456328e-2525-4642-b78b-9edd1a1a7d3f
ms.openlocfilehash: c9e6dbde696f8c66d7abcf222c861de1c83165c5
ms.sourcegitcommit: bd7ddc044f9083246614b602ef6a758775313214
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/09/2019
ms.locfileid: "68866230"
---
# <a name="cmfctaskspane-class"></a>CMFCTasksPane 类

有关更多详细信息, 请参阅位于 Visual Studio 安装的**VC\\atlmfc\\src\\mfc**文件夹中的源代码。

`CMFCTasksPane` 类实现可点击项（任务）的列表。

## <a name="syntax"></a>语法

```
class CMFCTasksPane : public CDockablePane
```

## <a name="members"></a>成员

### <a name="public-constructors"></a>公共构造函数

|名称|描述|
|----------|-----------------|
|[CMFCTasksPane:: CMFCTasksPane](#cmfctaskspane)|构造 `CMFCTasksPane` 对象。|

### <a name="public-methods"></a>公共方法

|名称|描述|
|----------|-----------------|
|[CMFCTasksPane::AddGroup](#addgroup)|将新任务组添加到任务窗格控件。|
|[CMFCTasksPane::AddLabel](#addlabel)|将新的静态标签添加到指定任务组中。|
|[CMFCTasksPane:: AddMRUFilesList](#addmrufileslist)|将由最近使用的 (MRU) 文件列表指定的任务添加到一个组中。|
|[CMFCTasksPane:: AddPage](#addpage)|将新页面添加到任务窗格。|
|[CMFCTasksPane::AddSeparator](#addseparator)||
|[CMFCTasksPane:: AddTask](#addtask)|将新任务添加到指定的任务组。|
|[CMFCTasksPane:: AddWindow](#addwindow)|将子窗口添加到任务窗格。|
|[CMFCTasksPane::CollapseAllGroups](#collapseallgroups)||
|[CMFCTasksPane::CollapseGroup](#collapsegroup)|以编程方式折叠组。|
|[CMFCTasksPane::CreateDefaultMiniframe](#createdefaultminiframe)|(重写[CPane:: CreateDefaultMiniframe](../../mfc/reference/cpane-class.md#createdefaultminiframe)。)|
|[CMFCTasksPane:: CreateMenu](#createmenu)|由框架调用, 用于为**其他任务窗格**菜单按钮创建菜单。|
|[CMFCTasksPane::EnableAnimation](#enableanimation)|启用或禁用折叠或展开任务组时的动画。|
|[CMFCTasksPane::EnableGroupCollapse](#enablegroupcollapse)|指定是否可以折叠任务组。|
|[CMFCTasksPane:: EnableHistoryMenuButtons](#enablehistorymenubuttons)|启用或禁用 "**下一步**" 和 "**上**一步" 导航按钮中的下拉菜单。|
|[CMFCTasksPane::EnableNavigationToolbar](#enablenavigationtoolbar)|启用或禁用导航工具栏。|
|[CMFCTasksPane::EnableOffsetCustomControls](#enableoffsetcustomcontrols)||
|[CMFCTasksPane::EnableScrollButtons](#enablescrollbuttons)|启用滚动按钮，而不是滚动条。|
|[CMFCTasksPane::EnableWrapLabels](#enablewraplabels)|启用或禁用标签的自动换行。|
|[CMFCTasksPane::EnableWrapTasks](#enablewraptasks)|启用或禁用任务的自动换行。|
|[CMFCTasksPane::GetActivePage](#getactivepage)|返回活动页的从零开始的索引。|
|[CMFCTasksPane::GetGroupCaptionHeight](#getgroupcaptionheight)|返回的组标题的高度。|
|[CMFCTasksPane::GetGroupCaptionHorzOffset](#getgroupcaptionhorzoffset)|返回组标题相对于任务窗格的左边缘和右边缘的当前偏移量。|
|[CMFCTasksPane::GetGroupCaptionVertOffset](#getgroupcaptionvertoffset)|返回组标题相对于任务窗格的上边缘和下边缘的当前偏移量。|
|[CMFCTasksPane::GetGroupCount](#getgroupcount)|返回组的总数。|
|[CMFCTasksPane::GetGroupLocation](#getgrouplocation)|返回给定组的内部组索引。|
|[CMFCTasksPane::GetGroupVertOffset](#getgroupvertoffset)|返回组的垂直偏移量。|
|[CMFCTasksPane::GetHorzMargin](#gethorzmargin)|返回任务窗格和工作区边缘之间的水平间距。|
|[CMFCTasksPane::GetNextPages](#getnextpages)||
|[CMFCTasksPane::GetPageByGroup](#getpagebygroup)|检索指定组的页索引。|
|[CMFCTasksPane::GetPagesCount](#getpagescount)|返回页数。|
|[CMFCTasksPane:: GetPreviousPages](#getpreviouspages)||
|[CMFCTasksPane::GetScrollBarCtrl](#getscrollbarctrl)|(重写[CWnd:: GetScrollBarCtrl](../../mfc/reference/cwnd-class.md#getscrollbarctrl)。)|
|[CMFCTasksPane::GetTask](#gettask)|检索任务。|
|[CMFCTasksPane::GetTaskCount](#gettaskcount)|返回指定组中任务项的数量。|
|[CMFCTasksPane::GetTaskGroup](#gettaskgroup)|返回给定组索引的任务组。|
|[CMFCTasksPane::GetTaskLocation](#gettasklocation)|返回给定任务的组和索引。|
|[CMFCTasksPane::GetTasksHorzOffset](#gettaskshorzoffset)|返回任务相对于其父组的左边缘和右边缘的水平偏移量。|
|[CMFCTasksPane::GetTasksIconHorzOffset](#gettasksiconhorzoffset)||
|[CMFCTasksPane::GetTasksIconVertOffset](#gettasksiconvertoffset)||
|[CMFCTasksPane::GetVertMargin](#getvertmargin)|返回任务窗格和工作区边缘之间的垂直间距。|
|[CMFCTasksPane::IsAccessibilityCompatible](#isaccessibilitycompatible)|（重写 `CDockablePane::IsAccessibilityCompatible`。）|
|[CMFCTasksPane::IsAnimationEnabled](#isanimationenabled)|指示动画是否已启用。|
|[CMFCTasksPane::IsBackButtonEnabled](#isbackbuttonenabled)|指示“返回”按钮是否已启用。|
|[CMFCTasksPane:: IsForwardButtonEnabled](#isforwardbuttonenabled)|指示“前进”按钮是否已启用。|
|[CMFCTasksPane::IsGroupCollapseEnabled](#isgroupcollapseenabled)||
|[CMFCTasksPane:: IsHistoryMenuButtonsEnabled](#ishistorymenubuttonsenabled)|指示 "**下一步**" 和 "**上**一步" 导航按钮是否包含下拉菜单。|
|[CMFCTasksPane::IsNavigationToolbarEnabled](#isnavigationtoolbarenabled)|指示导航工具栏是否已启用。|
|[CMFCTasksPane:: IsToolBox](#istoolbox)||
|[CMFCTasksPane::IsWrapLabelsEnabled](#iswraplabelsenabled)|指示任务窗格是否在标签中换行。|
|[CMFCTasksPane::IsWrapTasksEnabled](#iswraptasksenabled)|指示任务窗格是否在任务中换行。|
|[CMFCTasksPane::LoadState](#loadstate)|(重写[CDockablePane:: LoadState](cdockablepane-class.md#loadstate)。)|
|[CMFCTasksPane::OnCancel](#oncancel)||
|[CMFCTasksPane::OnClickTask](#onclicktask)|当用户单击任务窗格中的项时，由框架调用。|
|[CMFCTasksPane:: OnOK](#onok)||
|[CMFCTasksPane::OnPressBackButton](#onpressbackbutton)|当用户单击“后退”按钮时，由框架调用。|
|[CMFCTasksPane::OnPressForwardButton](#onpressforwardbutton)|当用户单击“前进”导航按钮时，由框架调用。|
|[CMFCTasksPane::OnPressHomeButton](#onpresshomebutton)|当用户单击“主页”导航按钮时，由框架调用|
|[CMFCTasksPane:: OnPressOtherButton](#onpressotherbutton)||
|[CMFCTasksPane::OnSetAccData](#onsetaccdata)|(重写[CBasePane:: OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata)。)|
|[CMFCTasksPane::OnUpdateCmdUI](#onupdatecmdui)|(重写[CDockablePane:: OnUpdateCmdUI](cdockablepane-class.md)。)|
|[CMFCTasksPane::PreTranslateMessage](#pretranslatemessage)|(重写[CDockablePane::P retranslatemessage](cdockablepane-class.md)。)|
|[CMFCTasksPane::RecalcLayout](#recalclayout)|(重写[CPane:: RecalcLayout](../../mfc/reference/cpane-class.md#recalclayout)。)|
|[CMFCTasksPane::RemoveAllGroups](#removeallgroups)|删除指定页上的所有组。|
|[CMFCTasksPane::RemoveAllPages](#removeallpages)|从任务窗格中删除所有页，除默认（第一）页除外。|
|[CMFCTasksPane::RemoveAllTasks](#removealltasks)|从组中删除所有任务。|
|[CMFCTasksPane::RemoveGroup](#removegroup)|删除组。|
|[CMFCTasksPane::RemovePage](#removepage)|从任务窗格删除指定页。|
|[CMFCTasksPane::RemoveTask](#removetask)|从任务组删除任务。|
|[CMFCTasksPane::SaveState](#savestate)|(重写[CDockablePane:: SaveState](cdockablepane-class.md)。)|
|[CMFCTasksPane::Serialize](#serialize)|(重写[CDockablePane:: 串行化](cdockablepane-class.md)。)|
|[CMFCTasksPane::SetActivePage](#setactivepage)|在任务窗格中激活指定页。|
|[CMFCTasksPane::SetCaption](#setcaption)|设置任务窗格的标题名称。|
|[CMFCTasksPane::SetGroupCaptionHeight](#setgroupcaptionheight)|设置组标题的高度。|
|[CMFCTasksPane::SetGroupCaptionHorzOffset](#setgroupcaptionhorzoffset)|设置组标题的水平偏移量。|
|[CMFCTasksPane::SetGroupCaptionVertOffset](#setgroupcaptionvertoffset)|设置组标题的垂直偏移量。|
|[CMFCTasksPane::SetGroupName](#setgroupname)|设置组名称。|
|[CMFCTasksPane::SetGroupTextColor](#setgrouptextcolor)|设置组标题的文本颜色。|
|[CMFCTasksPane::SetGroupVertOffset](#setgroupvertoffset)|设置组的垂直偏移量。|
|[CMFCTasksPane::SetHorzMargin](#sethorzmargin)|设置任务窗格和工作区边缘之间的水平间距。|
|[CMFCTasksPane::SetIconsList](#seticonslist)|设置与任务关联的图像列表。|
|[CMFCTasksPane::SetPageCaption](#setpagecaption)|设置任务窗格页的标题文本。|
|[CMFCTasksPane::SetTaskName](#settaskname)|设置任务的名称。|
|[CMFCTasksPane::SetTasksIconHorzOffset](#settasksiconhorzoffset)||
|[CMFCTasksPane::SetTasksIconVertOffset](#settasksiconvertoffset)||
|[CMFCTasksPane::SetTaskTextColor](#settasktextcolor)|设置任务的文本颜色。|
|[CMFCTasksPane::SetTasksHorzOffset](#settaskshorzoffset)|设置任务相对于其父组的左边缘和右边缘的水平偏移量。|
|[CMFCTasksPane::SetVertMargin](#setvertmargin)|设置任务窗格和工作区边缘之间的垂直间距。|
|[CMFCTasksPane:: SetWindowHeight](#setwindowheight)|设置窗口的高度。|
|[CMFCTasksPane::ShowCommandMessageString](#showcommandmessagestring)||
|[CMFCTasksPane::ShowTask](#showtask)|显示或隐藏任务。|
|[CMFCTasksPane::ShowTaskByCmdId](#showtaskbycmdid)|基于任务的命令 ID 显示或隐藏任务。|
|[CMFCTasksPane:: Update](#update)|更新属于任务窗格的 GUI 元素。|

### <a name="protected-methods"></a>受保护的方法

|名称|描述|
|----------|-----------------|
|[CMFCTasksPane::OnActivateTasksPanePage](#onactivatetaskspanepage)|激活新的任务窗格页时，由框架调用。|

## <a name="remarks"></a>备注

`CMFCTasksPane` 类实现下列功能：

- 可以对项进行分组，并且每个项分组均可具有关联的标题。

- 可以折叠或展开项分组。

- 可以向任务窗格中的每个项分配一个图标。

- 可将单个项与在用户单击该项时执行的任务 ID 关联。 单击时, 会将 WM_COMMAND 消息发送到任务窗格控件的所有者。

若要在应用程序中使用 `CMFCTasksPane` 控件，请执行以下步骤：

1. 将 `CMFCTasksPane` 对象嵌入主框架窗口类。

1. 处理 WM_CREATE 消息时, 请调用`Create`方法。 可以使用常规[CControlBar](../../mfc/reference/ccontrolbar-class.md)样式。 有关详细信息，请参阅 `CControlBar::Create` 。

1. 调用[CMFCTasksPane:: AddGroup](#addgroup)方法以添加不同的组。

1. 调用[CMFCTasksPane:: AddTask](#addtask)、 [CMFCTasksPane:: AddLabel](#addlabel)或[CMFCTasksPane:: AddMRUFilesList](#addmrufileslist)成员函数以便将新项 (任务) 添加到每个组。

1. 调用[CMFCTasksPane:: EnableGroupCollapse](#enablegroupcollapse)以指定项组是否可以折叠。

下图显示了一个典型的任务窗格控件。 第一组是*特殊*组, 其标题为较暗的颜色。 第三组处于折叠状态。 最后一组与任务窗格的底部对齐且没有标题，而且组中的最后一个任务是一个简单的标签：

![任务窗格示例](../../mfc/reference/media/nexttaskpane.png "任务窗格示例")

可以通过调整各种边距和偏移量来自定义任务窗格的外观。 下图阐明这些变量的含义：

![自定义任务组](../../mfc/reference/media/nexttaskgrpcustom.png "自定义任务组")

## <a name="example"></a>示例

下面的示例演示如何构造 `CMFCTasksPane` 对象和在 `CMFCTasksPane` 类中使用各种方法。 该示例演示如何启用任务组的折叠, 启用**下一个**和**上**一个导航按钮上的下拉菜单, 启用滚动按钮而不是滚动条, 为标签中的文本启用自动换行, 将任务窗格的标题名称, 设置组标题的文本颜色, 并设置水平和垂直边距。

[!code-cpp[NVC_MFC_RibbonApp#28](../../mfc/reference/codesnippet/cpp/cmfctaskspane-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>继承层次结构

[CObject](../../mfc/reference/cobject-class.md)\
└&nbsp;[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;[CWnd](../../mfc/reference/cwnd-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;[CBasePane](../../mfc/reference/cbasepane-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;[CPane](../../mfc/reference/cpane-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;[CDockablePane](../../mfc/reference/cdockablepane-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp;`CMFCTasksPane`

## <a name="requirements"></a>要求

**标头:** afxtaskspane。h

##  <a name="addgroup"></a>CMFCTasksPane:: AddGroup

将新任务组添加到任务窗格控件。

```
int AddGroup(
    int nPageIdx,
    LPCTSTR lpszGroupName,
    BOOL bBottomLocation = FALSE,
    BOOL bSpecial = FALSE,
    HICON hIcon = NULL);

int AddGroup(
    LPCTSTR lpszGroupName,
    BOOL bBottomLocation = FALSE,
    BOOL bSpecial = FALSE,
    HICON hIcon = NULL);
```

### <a name="parameters"></a>参数

*nPageIdx*<br/>
中指定从零开始的页索引。

*lpszGroupName*<br/>
中指定组名称。

*bBottomLocation*<br/>
中若要在任务窗格控件底部创建组, 则为 TRUE;否则为 FALSE。

*bSpecial*<br/>
中若要将此组标记为*特殊*组, 则为 TRUE;否则为 FALSE。 有关特殊组的详细信息, 请参阅的 "备注`CMFCTasksPane`" 部分。

*hIcon*<br/>
中指定要在组标题中显示的图标。

### <a name="return-value"></a>返回值

类所维护的组内部列表中组的从零开始的索引。

### <a name="remarks"></a>备注

调用此方法可创建一组任务并将该组添加到任务窗格控件。

框架在任务窗格控件的顶部或底部显示任务组。 框架只能在底部显示一个组;必须最后添加此组。

##  <a name="addlabel"></a>CMFCTasksPane:: AddLabel

将标签添加到指定的任务组。

```
int AddLabel(
    int nGroup,
    LPCTSTR lpszLabelName,
    int nTaskIcon = -1,
    BOOL bIsBold = FALSE);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定添加标签的组的索引。

*lpszLabelName*<br/>
中指定标签的名称。

*nTaskIcon*<br/>
中指定要在标签旁边显示的图标。 框架将图标存储在图像列表中。 此参数是该列表中的索引。

*bIsBold*<br/>
中若要以粗体文本显示标签, 则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

添加标签的组的从零开始的索引; 如果*取消*指定的组不存在, 则为-1。

### <a name="remarks"></a>备注

框架以不同方式处理任务和标签。 用户单击任务时, 框架会执行命令。 当用户单击标签时, 不执行命令。 有关详细信息, 请参阅[CMFCTasksPane:: AddTask](#addtask)。

##  <a name="addmrufileslist"></a>CMFCTasksPane:: AddMRUFilesList

将最近使用的 (MRU) 文件列表中存储的每个文件的任务添加到组中。

```
int AddMRUFilesList(
    int nGroup,
    int nMaxFiles = 4);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定组的索引。 此方法将 MRU 文件列表添加到由此参数指定的组。

*nMaxFiles*<br/>
中指定要在 MRU 文件列表中显示的文件数。

### <a name="return-value"></a>返回值

添加了 MRU 文件列表的组的从零开始的索引; 如果*取消*指定的组不存在, 则为-1。

##  <a name="addpage"></a>CMFCTasksPane:: AddPage

将页面添加到任务窗格。

```
int AddPage(LPCTSTR lpszPageLabel);
```

### <a name="parameters"></a>参数

*lpszPageLabel*<br/>
中指定页面的标签。

### <a name="return-value"></a>返回值

新页的从零开始的索引。

##  <a name="addseparator"></a>CMFCTasksPane:: AddSeparator

```
int AddSeparator(int nGroup);
```

### <a name="parameters"></a>参数

[in] *nGroup*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="addtask"></a>CMFCTasksPane:: AddTask

将任务添加到指定的任务组。

```
int AddTask(
    int nGroup,
    LPCTSTR lpszTaskName,
    int nTaskIcon = -1,
    UINT uiCommandID = 0,
    DWORD dwUserData = 0);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定添加任务的组索引。

*lpszTaskName*<br/>
中指定任务的名称。

*nTaskIcon*<br/>
中指定要在任务旁显示的图标。 框架将图标存储在图像列表中。 此参数是该列表中的索引。

*uiCommandID*<br/>
中指定用户单击任务时要执行的命令的命令 ID。 如果*uiCommandID*为 0, 则将该任务视为标签。

*dwUserData*<br/>
中指定要与任务关联的用户定义数据。

### <a name="return-value"></a>返回值

添加任务的组的从零开始的索引; 如果*取消*指定的组不存在, 则为-1。

##  <a name="addwindow"></a>CMFCTasksPane:: AddWindow

将子窗口添加到任务窗格。

```
int AddWindow(
    int nGroup,
    HWND hwndTask,
    int nWndHeight,
    BOOL bAutoDestroyWindow = FALSE,
    DWORD dwUserData = 0);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定在其中添加窗口的组索引。

*hwndTask*<br/>
中指定要添加的窗口的句柄。

*nWndHeight*<br/>
中指定窗口的高度。

*bAutoDestroyWindow*<br/>
中若要在删除任务时销毁窗口, 则为 TRUE;否则为 FALSE。

*dwUserData*<br/>
中指定与任务关联的用户定义数据。

### <a name="return-value"></a>返回值

添加窗口的组的从零开始的索引; 如果*取消*指定的组不存在, 则为-1。

### <a name="remarks"></a>备注

调用此方法可将控件添加到任务窗格。 例如, 可以添加像搜索栏这样工作的编辑控件。

##  <a name="cmfctaskspane"></a>CMFCTasksPane:: CMFCTasksPane

构造[CMFCTasksPane](../../mfc/reference/cmfctaskspane-class.md)对象。

```
CMFCTasksPane();
```

##  <a name="collapseallgroups"></a>CMFCTasksPane:: CollapseAllGroups

```
void CollapseAllGroups(BOOL bCollapse = TRUE);

void CollapseAllGroups(
    int nPageIdx,
    BOOL bCollapse);
```

### <a name="parameters"></a>参数

中*bCollapse*<br/>
[in] *nPageIdx*<br/>

### <a name="remarks"></a>备注

##  <a name="collapsegroup"></a>CMFCTasksPane:: CollapseGroup

折叠或展开组。

```
BOOL CollapseGroup(
    CMFCTasksPaneTaskGroup* pGroup,
    BOOL bCollapse = TRUE);

BOOL CollapseGroup(
    int nGroup,
    BOOL bCollapse = TRUE);
```

### <a name="parameters"></a>参数

*pGroup*<br/>
中指定要折叠的组。

*bCollapse*<br/>
中若要折叠组, 则为 TRUE;若要展开组, 则为 FALSE。

*nGroup*<br/>
中指定组的从零开始的索引, 在组的内部列表中折叠。

### <a name="return-value"></a>返回值

如果组折叠或展开成功, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

折叠的组只显示组标题;任务列表处于隐藏状态。

##  <a name="createdefaultminiframe"></a>CMFCTasksPane:: CreateDefaultMiniframe

```
virtual CPaneFrameWnd* CreateDefaultMiniframe(CRect rectInitial);
```

### <a name="parameters"></a>参数

[in] *rectInitial*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="createmenu"></a>CMFCTasksPane:: CreateMenu

创建当用户单击 "**其他任务" 窗格**菜单按钮时显示的菜单。

```
HMENU CreateMenu() const;
```

### <a name="return-value"></a>返回值

新菜单的句柄。

### <a name="remarks"></a>备注

在派生类中重写此方法以自定义任务窗格的菜单。

此方法创建的弹出菜单包含任务窗格中的页的列表。 该菜单在活动页旁显示复选标记。

##  <a name="enableanimation"></a>CMFCTasksPane:: EnableAnimation

启用或禁用在任务组展开或折叠时发生的动画。

```
void EnableAnimation(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要启用当任务组展开或折叠时发生的动画, 为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, 启用任务组展开或折叠时发生的动画。

##  <a name="enablegroupcollapse"></a>CMFCTasksPane:: EnableGroupCollapse

指定用户是否可以折叠任务组。

```
void EnableGroupCollapse(BOOL bEnable);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中如果用户可以折叠任务组, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

折叠的任务组只显示组标题;任务列表处于隐藏状态。

##  <a name="enablehistorymenubuttons"></a>CMFCTasksPane:: EnableHistoryMenuButtons

启用 "**下一步**" 和 "**上**一步" 导航按钮上的下拉菜单。

```
void EnableHistoryMenuButtons(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要在**下一个**和**上**一个导航按钮上启用下拉菜单, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, "**下一步**" 和 "**上**一步" 按钮上的下拉菜单处于禁用状态。

菜单包含用户使用的任务页的历史记录。

##  <a name="enablenavigationtoolbar"></a>CMFCTasksPane:: EnableNavigationToolbar

启用或禁用导航工具栏。

```
void EnableNavigationToolbar(
    BOOL bEnable = TRUE,
    UINT uiToolbarBmpRes = 0,
    CSize sizeToolbarImage = CSize(0,
    0),
    CSize sizeToolbarButton = CSize(0,
    0));
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要启用导航工具栏, 则为 TRUE;否则为 FALSE。

*uiToolbarBmpRes*<br/>
中指定包含要在工具栏上显示的图像的位图的资源 ID。

*sizeToolbarImage*<br/>
中指定工具栏图像的大小。

*sizeToolbarButton*<br/>
中指定工具栏按钮的大小。

### <a name="remarks"></a>备注

导航工具栏是框架显示在任务窗格顶部的工具栏。 导航工具栏包含 "**后退**"、"**前进**" 和 "**主页**" 导航按钮, 以及一个包含可用页面列表的菜单按钮。

默认情况下, 框架不显示导航工具栏。 如果未显示导航工具栏, 则导航按钮位于停靠栏的标题上。

##  <a name="enableoffsetcustomcontrols"></a>CMFCTasksPane:: EnableOffsetCustomControls

```
void EnableOffsetCustomControls(BOOL bEnable);
```

### <a name="parameters"></a>参数

中*bEnable*<br/>

### <a name="remarks"></a>备注

##  <a name="enablescrollbuttons"></a>CMFCTasksPane:: EnableScrollButtons

启用滚动按钮而不是滚动条。

```
void EnableScrollButtons(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要在任务窗格中显示滚动按钮而不是滚动条, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, 该框架在任务窗格中显示滚动按钮。

##  <a name="enablewraplabels"></a>CMFCTasksPane:: EnableWrapLabels

为标签中的文本启用或禁用自动换行。

```
void EnableWrapLabels(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中如果为 TRUE, 则在任务窗格中显示的标签中环绕文本;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, 框架不会将文本括在标签中。 启用 "自动换行" 时, 标签中的文本可以出现在多行中。 标签可以包含换行符标记`\n` , 如和下划线标记。 `&`

##  <a name="enablewraptasks"></a>CMFCTasksPane:: EnableWrapTasks

为任务中的文本启用或禁用自动换行。

```
void EnableWrapTasks(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>参数

*bEnable*<br/>
中若要在任务窗格中包装任务, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

默认情况下, 禁用任务的自动换行功能。

##  <a name="getactivepage"></a>CMFCTasksPane:: GetActivePage

返回活动页的从零开始的索引。

```
int GetActivePage() const;
```

### <a name="return-value"></a>返回值

活动页的从零开始的索引。

##  <a name="getgroupcaptionheight"></a>CMFCTasksPane:: GetGroupCaptionHeight

返回组标题的高度。

```
int GetGroupCaptionHeight() const;
```

### <a name="return-value"></a>返回值

组标题的高度 (以像素为单位)。

##  <a name="getgroupcaptionhorzoffset"></a>CMFCTasksPane:: GetGroupCaptionHorzOffset

返回组标题的水平偏移量。

```
int GetGroupCaptionHorzOffset() const;
```

### <a name="return-value"></a>返回值

组标题的水平偏移量。 水平偏移量是任务窗格的左边缘或右边缘的距离 (以像素为单位)。

##  <a name="getgroupcaptionvertoffset"></a>CMFCTasksPane:: GetGroupCaptionVertOffset

返回组标题的垂直偏移量。

```
int GetGroupCaptionVertOffset() const;
```

### <a name="return-value"></a>返回值

组标题相对于任务窗格的上边缘和下边缘的垂直偏移量。

### <a name="remarks"></a>备注

垂直偏移的默认值为7像素。

##  <a name="getgroupcount"></a>CMFCTasksPane:: GetGroupCount

返回组的总数。

```
int GetGroupCount() const;
```

### <a name="return-value"></a>返回值

任务窗格中的组总数。

##  <a name="getgrouplocation"></a>CMFCTasksPane:: GetGroupLocation

返回指定组的内部组索引。

```
BOOL GetGroupLocation(
    CMFCTasksPaneTaskGroup* pGroup,
    int& nGroup) const;
```

### <a name="parameters"></a>参数

*pGroup*<br/>
中指定要检索其位置的任务组。

*nGroup*<br/>
弄包含任务组的从零开始的索引。

### <a name="return-value"></a>返回值

如果找到任务组, 则为 TRUE;否则为 FALSE。

##  <a name="getgroupvertoffset"></a>CMFCTasksPane:: GetGroupVertOffset

返回组的垂直偏移量。

```
int GetGroupVertOffset() const;
```

### <a name="return-value"></a>返回值

组的垂直偏移量 (以像素为单位)。

##  <a name="gethorzmargin"></a>CMFCTasksPane:: GetHorzMargin

返回任务窗格和工作区边缘之间的水平间距。

```
int GetHorzMargin() const;
```

### <a name="return-value"></a>返回值

任务窗格和工作区边缘之间的水平间距。

### <a name="remarks"></a>备注

任务窗格和工作区边缘之间的默认间距为12像素。

##  <a name="getnextpages"></a>CMFCTasksPane:: GetNextPages

```
void GetNextPages(CStringList& lstNextPages) const;
```

### <a name="parameters"></a>参数

[in] *lstNextPages*<br/>

### <a name="remarks"></a>备注

##  <a name="getpagebygroup"></a>CMFCTasksPane:: GetPageByGroup

检索指定组的页索引。

```
BOOL GetPageByGroup(
    int nGroup,
    int& nPage) const;
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定任务组的从零开始的索引。

*nPage*<br/>
弄包含指定组的页索引。 如果任务组只包含一个默认页面, 则返回值为0。

### <a name="return-value"></a>返回值

如果组*取消*存在, 则为 TRUE;否则为 FALSE。

##  <a name="getpagescount"></a>CMFCTasksPane:: GetPagesCount

返回页数。

```
int GetPagesCount() const;
```

### <a name="return-value"></a>返回值

任务窗格中的页数。

##  <a name="getpreviouspages"></a>CMFCTasksPane:: GetPreviousPages

```
void GetPreviousPages(CStringList& lstPrevPages) const;
```

### <a name="parameters"></a>参数

[in] *lstPrevPages*<br/>

### <a name="remarks"></a>备注

##  <a name="getscrollbarctrl"></a>CMFCTasksPane:: GetScrollBarCtrl

```
virtual CScrollBar* GetScrollBarCtrl(int nBar) const;
```

### <a name="parameters"></a>参数

中*nBar*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="gettask"></a>CMFCTasksPane:: GetTask

检索任务。

```
CMFCTasksPaneTask* GetTask(
    int nGroup,
    int nTask) const;
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定包含任务的组的从零开始的索引。

*nTask*<br/>
中指定*取消*指定的列表中任务的从零开始的索引。

### <a name="return-value"></a>返回值

指定索引处的任务。

##  <a name="gettaskcount"></a>CMFCTasksPane:: GetTaskCount

返回指定组中的任务数。

```
int GetTaskCount(int nGroup) const;
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定任务组的索引。

### <a name="return-value"></a>返回值

指定组中的任务数, 或者, 如果*取消*无效, 则为0。

##  <a name="gettaskgroup"></a>CMFCTasksPane:: GetTaskGroup

返回指定组索引的任务组。

```
CMFCTasksPaneTaskGroup* GetTaskGroup(int nGroup) const;
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定要检索的组的从零开始的索引。

### <a name="return-value"></a>返回值

指定索引处的任务组。

##  <a name="gettasklocation"></a>CMFCTasksPane:: GetTaskLocation

返回指定任务的组和索引。

```
BOOL GetTaskLocation(
    UINT uiCommandID,
    int& nGroup,
    int& nTask) const;

BOOL GetTaskLocation(
    HWND hwndTask,
    int& nGroup,
    int& nTask) const;

BOOL GetTaskLocation(
    CMFCTasksPaneTask* pTask,
    int& nGroup,
    int& nTask) const;
```

### <a name="parameters"></a>参数

*uiCommandID*<br/>
中指定要查找的任务的命令 ID。

*nGroup*<br/>
弄包含任务的组索引。

*nTask*<br/>
弄包含任务组中任务的索引。

*hwndTask*<br/>
中指定与任务关联的窗口。

*pTask*<br/>
中指定要查找的任务。

### <a name="return-value"></a>返回值

如果找到任务位置, 则为 TRUE;如果指定的任务不存在, 则为 FALSE。

### <a name="remarks"></a>备注

此方法检索指定任务的组索引和任务索引。 如果该方法返回 FALSE, 则*取消*和*n*将设置为-1。

##  <a name="gettaskshorzoffset"></a>CMFCTasksPane:: GetTasksHorzOffset

返回任务的水平偏移量。

```
int GetTasksHorzOffset() const;
```

### <a name="return-value"></a>返回值

任务相对于其父组的左边缘和右边缘的水平偏移量。

### <a name="remarks"></a>备注

任务的默认水平偏移量为12像素。

##  <a name="gettasksiconhorzoffset"></a>CMFCTasksPane:: GetTasksIconHorzOffset

```
int GetTasksIconHorzOffset() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="gettasksiconvertoffset"></a>CMFCTasksPane:: GetTasksIconVertOffset

```
int GetTasksIconVertOffset() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="getvertmargin"></a>CMFCTasksPane:: GetVertMargin

返回任务窗格和工作区边缘之间的垂直边距。

```
int GetVertMargin() const;
```

### <a name="return-value"></a>返回值

任务窗格和工作区边缘之间的垂直边距。

### <a name="remarks"></a>备注

垂直边距是任务窗格和工作区边缘之间的空间。 垂直边距的默认值为12像素。

##  <a name="isaccessibilitycompatible"></a>CMFCTasksPane:: IsAccessibilityCompatible

```
virtual BOOL IsAccessibilityCompatible();
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="isanimationenabled"></a>CMFCTasksPane:: IsAnimationEnabled

指示动画是否已启用。

```
BOOL IsAnimationEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用了用户展开或折叠组时发生的动画, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

调用[CMFCTasksPane:: EnableAnimation](#enableanimation)可以启用或禁用动画。

##  <a name="isbackbuttonenabled"></a>CMFCTasksPane:: IsBackButtonEnabled

指示“返回”按钮是否已启用。

```
BOOL IsBackButtonEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用 "后退" 按钮, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

当用户单击 "后退" 按钮时, 框架会显示 "上一任务" 页。

##  <a name="isforwardbuttonenabled"></a>CMFCTasksPane:: IsForwardButtonEnabled

指示“前进”按钮是否已启用。

```
BOOL IsForwardButtonEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用 "前进" 按钮, 则为 TRUE;否则为 FALSE。

### <a name="remarks"></a>备注

"前进" 按钮允许在任务页的历史记录中向前导航。

##  <a name="isgroupcollapseenabled"></a>CMFCTasksPane:: IsGroupCollapseEnabled

```
BOOL IsGroupCollapseEnabled() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="ishistorymenubuttonsenabled"></a>CMFCTasksPane:: IsHistoryMenuButtonsEnabled

指示 "**下一步**" 和 "**上**一步" 导航按钮是否包含下拉菜单。

```
BOOL IsHistoryMenuButtonsEnabled() const;
```

### <a name="return-value"></a>返回值

如果 "**下一步**" 和 "**上**一步" 导航按钮具有下拉菜单, 则为 TRUE;否则为 FALSE。

##  <a name="isnavigationtoolbarenabled"></a>CMFCTasksPane:: IsNavigationToolbarEnabled

指示导航工具栏是否已启用。

```
BOOL IsNavigationToolbarEnabled() const;
```

### <a name="return-value"></a>返回值

如果启用导航工具栏, 则为 TRUE;否则为 FALSE。

##  <a name="istoolbox"></a>CMFCTasksPane:: IsToolBox

```
virtual BOOL IsToolBox() const;
```

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="iswraplabelsenabled"></a>CMFCTasksPane:: IsWrapLabelsEnabled

指示任务窗格是否在标签中换行。

```
BOOL IsWrapLabelsEnabled() const;
```

### <a name="return-value"></a>返回值

如果标记中的单词, 则为 TRUE;否则为 FALSE。

##  <a name="iswraptasksenabled"></a>CMFCTasksPane:: IsWrapTasksEnabled

指定框架是否包装任务字符串。

```
BOOL IsWrapTasksEnabled() const;
```

### <a name="return-value"></a>返回值

如果包装任务字符串, 则为 TRUE;否则为 FALSE。

##  <a name="loadstate"></a>CMFCTasksPane:: LoadState

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName = NULL,
    int nIndex = -1,
    UINT uiID = (UINT) -1);
```

### <a name="parameters"></a>参数

[in] *lpszProfileName*<br/>
中*nIndex*<br/>
中*uiID*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onactivatetaskspanepage"></a>CMFCTasksPane:: OnActivateTasksPanePage

在使任务窗格页处于活动状态时由框架调用。

```
virtual void OnActivateTasksPanePage();
```

### <a name="remarks"></a>备注

在派生类中重写此方法以自定义任务窗格页的外观。

##  <a name="oncancel"></a>CMFCTasksPane:: OnCancel

```
virtual void OnCancel();
```

### <a name="remarks"></a>备注

##  <a name="onclicktask"></a>CMFCTasksPane:: OnClickTask

当用户单击任务窗格中的项时，由框架调用。

```
virtual void OnClickTask(
    int nGroupNumber,
    int nTaskNumber,
    UINT uiCommandID,
    DWORD dwUserData);
```

### <a name="parameters"></a>参数

*nGroupNumber*<br/>
中指定包含所单击任务的组的从零开始的索引。

*nTaskNumber*<br/>
中指定所单击任务的从零开始的索引。

*uiCommandID*<br/>
中指定与任务关联的命令 ID。

*dwUserData*<br/>
中包含与单击的任务关联的用户定义数据。

### <a name="remarks"></a>备注

用户单击任务时, 框架会调用此方法。 默认情况下, 框架将检查与单击的任务相关联的命令 ID, 如果不为零, 则将 WM_COMMAND 消息发送到任务窗格控件的所有者。

在派生类中重写此方法, 以在单击任务时执行自定义代码。

##  <a name="onok"></a>CMFCTasksPane:: OnOK

```
virtual void OnOK();
```

### <a name="remarks"></a>备注

##  <a name="onpressbackbutton"></a>CMFCTasksPane:: OnPressBackButton

当用户单击“后退”按钮时，由框架调用。

```
virtual void OnPressBackButton();
```

### <a name="remarks"></a>备注

默认情况下, 该框架将显示以前查看过的页面。

在派生类中重写此方法, 以便在用户单击 "后退" 按钮时执行自定义代码。

##  <a name="onpressforwardbutton"></a>CMFCTasksPane:: OnPressForwardButton

当用户单击“前进”导航按钮时，由框架调用。

```
virtual void OnPressForwardButton();
```

### <a name="remarks"></a>备注

默认情况下, 框架显示用户在单击 "**后退**" 按钮之前查看的页。

在派生类中重写此方法, 以便在用户单击 "前进" 按钮时执行自定义代码。

##  <a name="onpresshomebutton"></a>CMFCTasksPane:: OnPressHomeButton

当用户单击主页导航按钮时由框架调用。

```
virtual void OnPressHomeButton();
```

### <a name="remarks"></a>备注

默认情况下, 框架显示任务组的默认页。

在派生类中重写此方法, 以便在用户单击主页导航按钮时执行自定义代码。

##  <a name="onpressotherbutton"></a>CMFCTasksPane:: OnPressOtherButton

```
virtual void OnPressOtherButton(
    CMFCCaptionMenuButton* pbtn,
    CWnd* pWndOwner);
```

### <a name="parameters"></a>参数

[in] *pbtn*<br/>
[in] *pWndOwner*<br/>

### <a name="remarks"></a>备注

##  <a name="onsetaccdata"></a>CMFCTasksPane:: OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>参数

[in] *lVal*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="onupdatecmdui"></a>CMFCTasksPane:: OnUpdateCmdUI

```
virtual void OnUpdateCmdUI(
    CFrameWnd* pTarget,
    BOOL bDisableIfNoHndler);
```

### <a name="parameters"></a>参数

[in] *pTarget*<br/>
[in] *bDisableIfNoHndler*<br/>

### <a name="remarks"></a>备注

##  <a name="pretranslatemessage"></a>CMFCTasksPane::P reTranslateMessage

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>参数

中*pMsg*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="recalclayout"></a>CMFCTasksPane:: RecalcLayout

```
void RecalcLayout(BOOL bRedraw = TRUE);
```

### <a name="parameters"></a>参数

[in] *bRedraw*<br/>

### <a name="remarks"></a>备注

##  <a name="removeallgroups"></a>CMFCTasksPane:: RemoveAllGroups

删除指定页上的所有组。

```
void RemoveAllGroups(int nPageIdx = 0);
```

### <a name="parameters"></a>参数

*nPageIdx*<br/>
中指定页的从零开始的索引。

### <a name="remarks"></a>备注

删除由*nPageIdx*指定的页面上的所有组, 如果只有默认页面, 则删除所有组。

##  <a name="removeallpages"></a>CMFCTasksPane:: RemoveAllPages

从任务窗格中删除所有页，除默认（第一）页除外。

```
void RemoveAllPages();
```

##  <a name="removealltasks"></a>CMFCTasksPane:: RemoveAllTasks

从指定的组中删除所有任务。

```
void RemoveAllTasks(int nGroup);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定组的从零开始的索引。

##  <a name="removegroup"></a>CMFCTasksPane:: RemoveGroup

删除组。

```
void RemoveGroup(int nGroup);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定要删除的组的从零开始的索引。

### <a name="remarks"></a>备注

此方法删除单个组。 若要删除所有组, 请改为调用[CMFCTasksPane:: RemoveAllGroups](#removeallgroups) 。

当框架删除某个组时, 与之关联的所有任务和用户窗口均被销毁。

##  <a name="removepage"></a>CMFCTasksPane:: RemovePage

从任务窗格删除指定页。

```
void RemovePage(int nPageIdx);
```

### <a name="parameters"></a>参数

*nPageIdx*<br/>
中指定要删除的页的从零开始的索引。

##  <a name="removetask"></a>CMFCTasksPane:: RemoveTask

从任务组删除任务。

```
BOOL RemoveTask(
    int nGroup,
    int nTask,
    BOOL bRedraw = TRUE);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定包含要删除的任务的任务组的从零开始的索引。

*nTask*<br/>
中指定要删除的任务的从零开始的索引。

*bRedraw*<br/>
中若要重绘任务窗格, 则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果函数成功, 则为 TRUE;如果*取消*或*n*无效, 则为 FALSE。

##  <a name="savestate"></a>CMFCTasksPane:: SaveState

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName = NULL,
    int nIndex = -1,
    UINT uiID = (UINT) -1);
```

### <a name="parameters"></a>参数

[in] *lpszProfileName*<br/>
中*nIndex*<br/>
中*uiID*<br/>

### <a name="return-value"></a>返回值

### <a name="remarks"></a>备注

##  <a name="serialize"></a>CMFCTasksPane:: 串行化

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>参数

[in] *ar*<br/>

### <a name="remarks"></a>备注

##  <a name="setactivepage"></a>CMFCTasksPane:: SetActivePage

使任务窗格中的指定页面处于活动状态。

```
void SetActivePage(int nPageIdx);
```

### <a name="parameters"></a>参数

*nPageIdx*<br/>
中指定要显示的页的从零开始的索引。

### <a name="remarks"></a>备注

此方法断言*nPageIdx*是否无效。

##  <a name="setcaption"></a>CMFCTasksPane:: SetCaption

设置任务窗格的标题名称。

```
void SetCaption(LPCTSTR lpszName);
```

### <a name="parameters"></a>参数

*lpszName*<br/>
中指定标题名称。

### <a name="remarks"></a>备注

如果任务窗格具有多个页面, 则默认页面具有使用此功能设置的标题。

##  <a name="setgroupcaptionheight"></a>CMFCTasksPane:: SetGroupCaptionHeight

设置组标题的高度。

```
void SetGroupCaptionHeight(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中指定标题高度。

### <a name="remarks"></a>备注

调用此方法以自定义任务窗格元素的边距。

如果*n*为-1, 则框架通过使用可视管理器 ( `CMFCVisualManager::GetTasksPaneGroupCaptionHeight`) 来确定边距值。 默认标题高度为25像素。

##  <a name="setgroupcaptionhorzoffset"></a>CMFCTasksPane:: SetGroupCaptionHorzOffset

设置组标题的水平偏移量。

```
void SetGroupCaptionHorzOffset(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中指定组标题的水平偏移量。

##  <a name="setgroupcaptionvertoffset"></a>CMFCTasksPane:: SetGroupCaptionVertOffset

设置组标题的垂直偏移量。

```
void SetGroupCaptionVertOffset(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中指定组标题的垂直偏移量 (以像素为单位)。

##  <a name="setgroupname"></a>CMFCTasksPane:: SetGroupName

设置组名称。

```
BOOL SetGroupName(
    int nGroup,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定组的从零开始的索引。

*lpszGroupName*<br/>
中指定组的名称。

### <a name="return-value"></a>返回值

如果已成功设置组名称, 则为 TRUE;否则为 FALSE。

##  <a name="setgrouptextcolor"></a>CMFCTasksPane:: SetGroupTextColor

设置组标题的文本颜色。

```
BOOL SetGroupTextColor(
    int nGroup,
    COLORREF color,
    COLORREF colorHot = (COLORREF)-1);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定组的从零开始的索引。

*color*<br/>
中指定文本颜色。

*colorHot*<br/>
中指定突出显示的组的文本颜色。 如果为-1, 则使用默认的突出显示颜色。

### <a name="return-value"></a>返回值

如果已成功更改组文本颜色, 则为 TRUE;否则为 FALSE。

##  <a name="setgroupvertoffset"></a>CMFCTasksPane:: SetGroupVertOffset

设置组的垂直偏移量。

```
void SetGroupVertOffset(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中指定垂直偏移量。

### <a name="remarks"></a>备注

垂直偏移量是任务组与任务窗格边框之间的距离。

调用此方法以自定义任务窗格元素的边距。 如果*n*为-1, 则框架通过使用可视管理器 (`CMFCVisualManager::GetTasksPaneGroupVertOffset`) 来确定边距值。 默认偏移量为15像素。

##  <a name="sethorzmargin"></a>CMFCTasksPane:: SetHorzMargin

设置水平边距。

```
void SetHorzMargin(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中以像素为单位指定边距。

### <a name="remarks"></a>备注

水平边距是任务窗格与工作区上边缘或下边缘之间的距离。

如果 n 为-1, 并且框架使用可视管理器 (`CMFCVisualManager::GetTasksPaneHorzMargin`) 确定边距值, 则为。 默认水平边距为12像素。

##  <a name="seticonslist"></a>CMFCTasksPane:: SetIconsList

设置图像列表。

```
BOOL SetIconsList(
    UINT uiImageListResID,
    int cx,
    COLORREF clrTransparent = RGB(255, 0, 255));

void SetIconsList(HIMAGELIST hIcons);
```

### <a name="parameters"></a>参数

*uiImageListResID*<br/>
中指定图像列表的资源 ID。

*cx*<br/>
中指定图像列表中图标的大小。

*clrTransparent*<br/>
中指定透明颜色。

*hIcons*<br/>
中指定包含任务窗格图标的图像列表。

### <a name="remarks"></a>备注

框架将图标存储在图像列表中。 任务与存储在该列表中的图标相关联。

此方法将图像列表与任务窗格控件相关联。 若要在调用[CMFCTasksPane:: AddTask](#addtask)时设置任务的图标, 请在`nTaskIcon`此图像列表中将设置为适当的从零开始的索引。

##  <a name="setpagecaption"></a>CMFCTasksPane:: SetPageCaption

设置任务窗格页的标题文本。

```
void SetPageCaption(
    int nPageIdx,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>参数

*nPageIdx*<br/>
中指定页的从零开始的索引。

*lpszName*<br/>
中指定要在页面上显示的标题文本。

### <a name="remarks"></a>备注

如果任务窗格具有多个页面, 则默认页面具有使用此方法设置的标题。

##  <a name="settaskname"></a>CMFCTasksPane:: SetTaskName

设置任务的名称。

```
BOOL SetTaskName(
    int nGroup,
    int nTask,
    LPCTSTR lpszTaskName);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定任务组的从零开始的索引。

*nTask*<br/>
中指定任务的从零开始的索引。

*lpszTaskName*<br/>
中指定任务名称。

### <a name="return-value"></a>返回值

如果已成功设置任务名称, 则为 TRUE;否则为 FALSE。

##  <a name="settaskshorzoffset"></a>CMFCTasksPane:: SetTasksHorzOffset

设置任务的水平偏移量。

```
void SetTasksHorzOffset(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中指定水平偏移量。

### <a name="remarks"></a>备注

水平偏移量是组的左边缘和右边缘之间的距离 (以像素为单位)。

如果*n*为-1, 则此方法设置由`CMFCVisualManager::GetTasksPaneTaskHorzOffset`方法返回的值的水平偏移量。

默认的水平偏移量为12像素。

##  <a name="settasksiconhorzoffset"></a>CMFCTasksPane:: SetTasksIconHorzOffset

```
void SetTasksIconHorzOffset(int n = -1);
```

### <a name="parameters"></a>参数

[in] *n*<br/>

### <a name="remarks"></a>备注

##  <a name="settasksiconvertoffset"></a>CMFCTasksPane:: SetTasksIconVertOffset

```
void SetTasksIconVertOffset(int n = -1);
```

### <a name="parameters"></a>参数

[in] *n*<br/>

### <a name="remarks"></a>备注

##  <a name="settasktextcolor"></a>CMFCTasksPane:: SetTaskTextColor

设置任务的文本颜色。

```
BOOL SetTaskTextColor(
    int nGroup,
    int nTask,
    COLORREF color,
    COLORREF colorHot = (COLORREF)-1);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定包含任务的任务组的从零开始的索引。

*nTask*<br/>
中指定任务的从零开始的索引。

*color*<br/>
中指定任务的文本颜色。

*colorHot*<br/>
中指定突出显示的组的文本颜色。 如果为-1, 则此方法使用默认的突出显示颜色。

### <a name="return-value"></a>返回值

如果已成功设置任务的文本颜色, 则为 TRUE;否则为 FALSE。

##  <a name="setvertmargin"></a>CMFCTasksPane:: SetVertMargin

设置垂直边距。

```
void SetVertMargin(int n = -1);
```

### <a name="parameters"></a>参数

*n*<br/>
中指定要设置的垂直边距。

### <a name="remarks"></a>备注

垂直边距是任务窗格和工作区的垂直边缘之间的距离。

如果*n*为-1, 则框架通过使用可视管理器 (`CMFCVisualManager::GetTasksPaneVertMargin`) 来确定边距值。 默认边距为12像素。

##  <a name="setwindowheight"></a>CMFCTasksPane:: SetWindowHeight

设置窗口控件的高度。

```
BOOL SetWindowHeight(
    int nGroup,
    HWND hwndTask,
    int nWndHeight);

BOOL SetWindowHeight(
    HWND hwndTask,
    int nWndHeight);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定包含窗口控件的组的从零开始的索引。

*hwndTask*<br/>
中指定窗口控件的句柄。

*nWndHeight*<br/>
中指定要设置的高度。

### <a name="return-value"></a>返回值

如果已成功设置窗口控件的高度, 则为 TRUE;如果*取消*无效或*hwndTask*不存在, 则为 FALSE。

### <a name="remarks"></a>备注

调用[CMFCTasksPane:: AddWindow](#addwindow)以添加具有窗口控件的任务。

##  <a name="showcommandmessagestring"></a>CMFCTasksPane:: ShowCommandMessageString

```
virtual void ShowCommandMessageString(UINT uiCmdId);
```

### <a name="parameters"></a>参数

[in] *uiCmdId*<br/>

### <a name="remarks"></a>备注

##  <a name="showtask"></a>CMFCTasksPane:: ShowTask

显示或隐藏任务。

```
BOOL ShowTask(
    int nGroup,
    int nTask,
    BOOL bShow = TRUE,
    BOOL bRedraw = TRUE);
```

### <a name="parameters"></a>参数

*nGroup*<br/>
中指定组的从零开始的索引。

*nTask*<br/>
中指定要显示或隐藏的任务的从零开始的索引。

*bShow*<br/>
中若要显示任务, 则为 TRUE;若为 FALSE, 则隐藏任务。

*bRedraw*<br/>
中若要重绘任务窗格, 则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果任务已成功显示或隐藏, 则为 TRUE;如果指定的组或任务不存在, 则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCTasksPane:: ShowTaskByCmdId](#showtaskbycmdid)可以基于任务的命令 ID 显示或隐藏任务。

##  <a name="showtaskbycmdid"></a>CMFCTasksPane:: ShowTaskByCmdId

基于任务的命令 ID 显示或隐藏任务。

```
BOOL ShowTaskByCmdId(
    UINT uiCommandID,
    BOOL bShow = TRUE,
    BOOL bRedraw = TRUE);
```

### <a name="parameters"></a>参数

*uiCommandID*<br/>
中指定要显示或隐藏的任务的命令 ID。

*bShow*<br/>
中若要显示任务, 则为 TRUE;若为 FALSE, 则隐藏任务。

*bRedraw*<br/>
中若要重绘任务窗格, 则为 TRUE;否则为 FALSE。

### <a name="return-value"></a>返回值

如果任务已成功显示或隐藏, 则为 TRUE;如果具有指定命令 ID 的任务不存在, 则为 FALSE。

### <a name="remarks"></a>备注

使用[CMFCTasksPane:: ShowTask](#showtask)可以基于任务的命令 ID 显示或隐藏任务。

##  <a name="update"></a>CMFCTasksPane:: Update

刷新任务窗格中的所有控件。

```
virtual void Update();
```

### <a name="remarks"></a>备注

此方法更新任务窗格标题、调整滚动条、重新定位所有任务并重绘所有任务窗格控件。

在派生类中重写此方法, 以便在框架刷新任务窗格时执行自定义代码。

## <a name="see-also"></a>请参阅

[层次结构图](../../mfc/hierarchy-chart.md)<br/>
[类](../../mfc/reference/mfc-classes.md)<br/>
[CMFCTasksPaneTaskGroup 类](../../mfc/reference/cmfctaskspanetaskgroup-class.md)<br/>
[CMFCTasksPaneTask 类](../../mfc/reference/cmfctaskspanetask-class.md)<br/>
[CMFCOutlookBar 类](../../mfc/reference/cmfcoutlookbar-class.md)<br/>
[CMFCVisualManager 类](../../mfc/reference/cmfcvisualmanager-class.md)
