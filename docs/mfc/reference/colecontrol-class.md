---
title: COleControl ç±»
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753936"
---
# <a name="colecontrol-class"></a>COleControl ç±»

ç¨äºå¼å OLE æ§ä»¶çéè¦åºç±»ã

## <a name="syntax"></a>è¯­æ³

```
class COleControl : public CWnd
```

## <a name="members"></a>æå

### <a name="public-constructors"></a>å¬å±æé å½æ°

|åç§°|è¯´æ|
|----------|-----------------|
|[COle æ§å¶ï¼COle æ§å¶](#colecontrol)|åå»ºä¸ä¸ª `COleControl` å¯¹è±¡ã|

### <a name="public-methods"></a>å¬å±æ¹æ³

|åç§°|è¯´æ|
|----------|-----------------|
|[COleControlï¼ç¯å¢å¤è§](#ambientappearance)|æ£ç´¢æ§ä»¶çå½åå¤è§ã|
|[COle æ§å¶ï¼ç¯å¢èé¢é¢è²](#ambientbackcolor)|è¿åç¯å¢ BackColor å±æ§çå¼ã|
|[COleControlï¼ç¯å¢æ¾ç¤ºåç§°](#ambientdisplayname)|è¿åå®¹å¨æå®çæ§ä»¶çåç§°ã|
|[COleControlï¼ç¯å¢å­ä½](#ambientfont)|è¿åç¯å¢å­ä½å±æ§çå¼ã|
|[COleControlï¼ç¯å¢ç¦å½©](#ambientforecolor)|è¿åç¯å¢ ForeColor å±æ§çå¼ã|
|[COleControlï¼ç¯å¢åºåID](#ambientlocaleid)|è¿åå®¹å¨çåºåè®¾ç½® IDã|
|[COle æ§å¶ï¼ï¼ç¯å¢å°ºåº¦åä½](#ambientscaleunits)|è¿åå®¹å¨ä½¿ç¨çåä½ç±»åã|
|[COle æ§å¶ï¼ï¼ç¯å¢æ¾ç¤ºææ](#ambientshowgrabhandles)|ç¡®å®æ¯å¦åºæ¾ç¤ºæåæ§ç¹ã|
|[COle æ§å¶ï¼ç¯å¢æ¾ç¤ºå¡«å](#ambientshowhatching)|ç¡®å®æ¯å¦åºæ¾ç¤ºåé¢çº¿ã|
|[COle æ§å¶ï¼ç¯å¢ææ¬å¯¹é½](#ambienttextalign)|è¿åå®¹å¨æå®çææ¬å¯¹é½ç±»åã|
|[COleControlï¼ç¯å¢UIDead](#ambientuidead)|ç¡®å®æ§ä»¶æ¯å¦åºååºç¨æ·çé¢æä½ã|
|[COle æ§å¶ï¼ç¯å¢ç¨æ·æ¨¡å¼](#ambientusermode)|ç¡®å®å®¹å¨çæ¨¡å¼ã|
|[COle æ§å¶ï¼ç»å®å±æ§å·²æ´æ¹](#boundpropertychanged)|éç¥å®¹å¨ç»å®å±æ§å·²æ´æ¹ã|
|[COle æ§å¶ï¼ï¼ç»å®å±æ§è¯·æ±ç¼è¾](#boundpropertyrequestedit)|è¯·æ±ç¼è¾å±æ§å¼çæéã|
|[COle æ§å¶ï¼ï¼å®¢æ·ç«¯å°ç¶çº§](#clienttoparent)|å°ç¸å¯¹äºæ§ä»¶åç¹çç¹è½¬æ¢ä¸ºç¸å¯¹äºå¶å®¹å¨æºçç¹ã|
|[COle æ§å¶ï¼ï¼ClipCaretrect](#clipcaretrect)|å¦æå¾æç©å½¢ä¸æ§ä»¶éå ï¼åè°æ´å¶ç©å½¢ã|
|[COle æ§å¶ï¼ï¼æ§å¶ä¿¡æ¯å·²æ´æ¹](#controlinfochanged)|å¨æ§ä»¶å¤ççå©è®°ç¬¦éå·²æ´æ¹åè°ç¨æ­¤å½æ°ã|
|[COleControlï¼:Dæ­æ¾éè¯¯](#displayerror)|åæ§ä»¶çç¨æ·æ¾ç¤ºåºå­éè¯¯äºä»¶ã|
|[COleControlï¼:DoClick](#doclick)|å®ç°åºå­`DoClick`æ¹æ³ã|
|[COleControlï¼:DoPropExchange](#dopropexchange)|åºåå`COleControl`å¯¹è±¡çå±æ§ã|
|[COleControlï¼:Dè¶ç±»ç»ç»](#dosuperclasspaint)|éç»ä» Windows æ§ä»¶ä¸­å­åç±»ç OLE æ§ä»¶ã|
|[COle æ§å¶ï¼å¯ç¨ç®åå¸§](#enablesimpleframe)|æ¯ææ§ä»¶çç®åå¸§æ¯æã|
|[COleControlï¼ï¼äº¤æ¢èå´](#exchangeextent)|åºååæ§ä»¶çå®½åº¦åé«åº¦ã|
|[COleControlï¼ï¼äº¤ææè¡ç¥¨ä¾åºå](#exchangestockprops)|åºååæ§ä»¶çåºå­å±æ§ã|
|[COleControlï¼äº¤æ¢çæ¬](#exchangeversion)|åºååæ§ä»¶ççæ¬å·ã|
|[COle æ§å¶ï¼ç«å»](#fireclick)|è§¦ååºå­`Click`äºä»¶ã|
|[COleControlï¼ï¼ç«ç¹ç¹å»](#firedblclick)|è§¦ååºå­`DblClick`äºä»¶ã|
|[COleæ§å¶ï¼ç«éè¯¯](#fireerror)|è§¦ååºå­`Error`äºä»¶ã|
|[COle æ§å¶ï¼ç«äºä»¶](#fireevent)|è§¦åèªå®ä¹äºä»¶ã|
|[COle æ§å¶ï¼ï¼ç«é®åä¸](#firekeydown)|è§¦ååºå­`KeyDown`äºä»¶ã|
|[COleControlï¼ï¼FireKeyPress](#firekeypress)|è§¦ååºå­`KeyPress`äºä»¶ã|
|[COle æ§å¶ï¼ç«é®åä¸](#firekeyup)|è§¦ååºå­`KeyUp`äºä»¶ã|
|[COleControlï¼ç«é¼ åä¸](#firemousedown)|è§¦ååºå­`MouseDown`äºä»¶ã|
|[COleControlï¼ç«é¼ ç§»å¨](#firemousemove)|è§¦ååºå­`MouseMove`äºä»¶ã|
|[COleControlï¼ç«é¼ ](#firemouseup)|è§¦ååºå­`MouseUp`äºä»¶ã|
|[COle æ§å¶ï¼ï¼ç«å°±ç»ªç¶ææ´æ¹](#firereadystatechange)|å½æ§ä»¶çå°±ç»ªç¶æåçæ´æ¹æ¶ï¼è§¦åäºä»¶ã|
|[COleControlï¼è·åæ¿æ´»ç­ç¥](#getactivationpolicy)|æ´æ¹æ¯ææ¥å£çæ§ä»¶ç`IPointerInactive`é»è®¤æ¿æ´»è¡ä¸ºã|
|[COleControlï¼è·åç¯å¢å±æ§](#getambientproperty)|è¿åæå®ç¯å¢å±æ§çå¼ã|
|[COleControlï¼è·åå¤è§](#getappearance)|è¿åè¡ç¥¨å¤è§å±æ§çå¼ã|
|[COleControlï¼è·ååå½é¢è²](#getbackcolor)|è¿åè¡ç¥¨ BackColor å±æ§çå¼ã|
|[COle æ§å¶ï¼è·åè¾¹æ¡æ ·å¼](#getborderstyle)|è¿åè¡ç¥¨ BorderStyle å±æ§çå¼ã|
|[COle æ§å¶ï¼è·åæè·](#getcapture)|ç¡®å®æ çªå£ãæ¿æ´»çæ§ä»¶å¯¹è±¡æ¯å¦å·æé¼ æ æè·ã|
|[COle æ§å¶ï¼è·åç±» ID](#getclassid)|æ£ç´¢æ§ä»¶ç OLE ç±» IDã|
|[COle æ§å¶ï¼è·åå®¢æ·ç«¯åç§»](#getclientoffset)|æ£ç´¢æ§ä»¶ç©å½¢åºåçå·¦ä¸è§ä¸å¶å·¥ä½åºçå·¦ä¸è§ä¹é´çå·®å¼ã|
|[COleControlï¼è·åå®¢æ·ç«¯](#getclientrect)|æ£ç´¢æ§ä»¶å·¥ä½åºçå¤§å°ã|
|[COleControlï¼è·åå®¢æ·ç½ç«](#getclientsite)|æ¥è¯¢æåå¶å®¹å¨ä¸­å½åå®¢æ·ç«¯ç«ç¹çæéçå¯¹è±¡ã|
|[COle æ§å¶ï¼è·åæ§å¶æ å¿](#getcontrolflags)|æ£ç´¢æ§ä»¶æ å¿è®¾ç½®ã|
|[COle æ§å¶ï¼è·åæ§å¶å¤§å°](#getcontrolsize)|è¿å OLE æ§ä»¶çä½ç½®åå¤§å°ã|
|[COle æ§å¶ï¼GetDC](#getdc)|æä¾ä¸ç§æ çªå£æ§ä»¶ä»å¶å®¹å¨è·åè®¾å¤ä¸ä¸æçæ¹æ³ã|
|[COle æ§å¶ï¼å¯ç¨](#getenabled)|è¿åè¡ç¥¨å¯ç¨å±æ§çå¼ã|
|[COle æ§å¶ï¼è·åæ©å±æ§å¶](#getextendedcontrol)|æ£ç´¢æåå±äºå®¹å¨çæ©å±æ§ä»¶å¯¹è±¡çæéã|
|[COleControlï¼è·åç¦ç¹](#getfocus)|ç¡®å®æ§ä»¶æ¯å¦å·æç¦ç¹ã|
|[COleControlï¼è·åå­ä½](#getfont)|è¿åè¡ç¥¨å­ä½å±æ§çå¼ã|
|[COleControlï¼è·åå­ä½ææ¬ææ ](#getfonttextmetrics)|è¿å`CFontHolder`å¯¹è±¡çææ ã|
|[COleControlï¼è·åç¦å½©](#getforecolor)|è¿åè¡ç¥¨ ForeColor å±æ§çå¼ã|
|[COleControlï¼GetHwnd](#gethwnd)|è¿åè¡ç¥¨ hWnd å±æ§çå¼ã|
|[COle æ§å¶ï¼è·åæ¶æ¯å­ç¬¦ä¸²](#getmessagestring)|æä¾èåé¡¹çç¶ææ ææ¬ã|
|[COle æ§å¶ï¼ä¸åæ¯æ](#getnotsupported)|é²æ­¢ç¨æ·è®¿é®æ§ä»¶çå±æ§å¼ã|
|[COleControlï¼åå¤ç¶æ](#getreadystate)|è¿åæ§ä»¶çå°±ç»ªç¶æã|
|[COle æ§å¶ï¼è·å rectin å®¹å¨](#getrectincontainer)|è¿åæ§ä»¶ç¸å¯¹äºå¶å®¹å¨çç©å½¢ã|
|[COleControlï¼è·åè¡ç¥¨ææ¬ææ ](#getstocktextmetrics)|è¿åè¡ç¥¨å­ä½å±æ§çææ ã|
|[COleControlï¼è·åææ¬](#gettext)|è¿åè¡ç¥¨ææ¬ææ é¢å±æ§çå¼ã|
|[COle æ§å¶ï¼è·åæ çªå£ä¸¢å¼ç®æ ](#getwindowlessdroptarget)|è¦çä»¥åè®¸æ çªå£æ§ä»¶æä¸ºææ¾æä½çç®æ ã|
|[COle æ§å¶ï¼åå§å IID](#initializeiids)|éç¥æ§ä»¶å°ä½¿ç¨ç IID çåºç±»ã|
|[COleControlï¼åé¨è·åå­ä½](#internalgetfont)|è¿åè¡ç¥¨`CFontHolder`å­ä½å±æ§çå¯¹è±¡ã|
|[COleControlï¼åé¨è·åææ¬](#internalgettext)|æ£ç´¢åºå­æ é¢æææ¬å±æ§ã|
|[COleControlï¼ï¼åé¨å°±ç»ªç¶æ](#internalsetreadystate)|è®¾ç½®æ§ä»¶çå°±ç»ªç¶æå¹¶è§¦åå°±ç»ªç¶ææ´æ¹äºä»¶ã|
|[COle æ§å¶ï¼æ ææ§å¶](#invalidatecontrol)|ä½¿æ¾ç¤ºçæ§ä»¶çåºåæ æï¼ä»èå¯¼è´éæ°ç»å¶è¯¥æ§ä»¶ã|
|[COleControlï¼æ æ](#invalidatergn)|ä½¿ç»å®åºååçå®¹å¨çªå£çå·¥ä½åºæ æã å¯ç¨äºéç»åºåä¸­çæ çªå£æ§ä»¶ã|
|[COleControlï¼æ­£å¨è½¬æ¢VBX](#isconvertingvbx)|åè®¸ä¸é¨å è½½ OLE æ§ä»¶ã|
|[COle æ§å¶ï¼å·²ä¿®æ¹](#ismodified)|ç¡®å®æ§ä»¶ç¶ææ¯å¦å·²æ´æ¹ã|
|[COleControlï¼ä¼åç»å¶](#isoptimizeddraw)|æç¤ºå®¹å¨æ¯å¦æ¯æå½åç»å¾æä½çä¼åç»å¾ã|
|[COle æ§å¶ï¼æ¯å­ç±»æ§å¶](#issubclassedcontrol)|è°ç¨ ä»¥ç¡®å®æ§ä»¶æ¯å¦å¯¹ Windows æ§ä»¶è¿è¡å­ç±»ã|
|[COle æ§å¶ï¼å è½½](#load)|éç½®ä»»ä½ä»¥åçå¼æ­¥æ°æ®ï¼å¹¶å¯å¨æ§ä»¶çå¼æ­¥å±æ§çæ°è´è½½ã|
|[COle æ§å¶ï¼éå®ä½ç½®æ´»å¨](#lockinplaceactive)|ç¡®å®æ§ä»¶æ¯å¦å¯ä»¥ç±å®¹å¨åç¨ã|
|[COleControlï¼å³äºç¯å¢å±æ§æ´æ¹](#onambientpropertychange)|æ´æ¹ç¯å¢å±æ§æ¶è°ç¨ã|
|[COle æ§å¶ï¼å¨å¤è§ä¸å·²æ´æ¹](#onappearancechanged)|æ´æ¹è¡ç¥¨å¤è§å±æ§æ¶è°ç¨ã|
|[COle æ§å¶ï¼onbackColor å·²æ´æ¹](#onbackcolorchanged)|æ´æ¹è¡ç¥¨ BackColor å±æ§æ¶è°ç¨ã|
|[COle æ§å¶ï¼å¨è¾¹æ¡æ ·å¼ä¸å·²æ´æ¹](#onborderstylechanged)|æ´æ¹è¡ç¥¨è¾¹æ¡æ ·å¼å±æ§æ¶è°ç¨ã|
|[COleControlï¼ç¹å»](#onclick)|å·²è°ç¨ä»¥è§¦ååºå­åå»äºä»¶ã|
|[COle æ§å¶ï¼å³é­](#onclose)|éç¥å·²è°ç¨ç`IOleControl::Close`æ§ä»¶ã|
|[COleControlï¼OnDoVerb](#ondoverb)|æ§è¡æ§å¶è°è¯åè°ç¨ã|
|[COleControlï¼å¨ç»ä¸](#ondraw)|å½è¯·æ±æ§ä»¶éæ°ç»å¶èªèº«æ¶è°ç¨ã|
|[COleControlï¼å¨ç»åæä»¶](#ondrawmetafile)|å½è¯·æ±æ§ä»¶ä½¿ç¨åæä»¶è®¾å¤ä¸ä¸æéç»èªèº«æ¶ï¼å®¹å¨è°ç¨è¯¥å®¹å¨ã|
|[COleControlï¼ï¼ç¼è¾](#onedit)|å®¹å¨è°ç¨ UI æ¿æ´» OLE æ§ä»¶ã|
|[COle æ§å¶ï¼å¯ç¨](#onenabledchanged)|æ´æ¹è¡ç¥¨å¯ç¨å±æ§æ¶è°ç¨ã|
|[COleControlï¼onEnumVerbs](#onenumverbs)|å®¹å¨è°ç¨ä»¥æä¸¾æ§ä»¶çè°è¯ã|
|[COleControlï¼å¨äºä»¶å»ºè®®](#oneventadvise)|å½äºä»¶å¤çç¨åºè¿æ¥æä¸æ§ä»¶æ­å¼è¿æ¥æ¶è°ç¨ã|
|[COleControlï¼ï¼æ¾å¤§ç¼©å°å­ä½åè½ æ¾å¤§ç¼©å°å­ä½åè½](#onfontchanged)|æ´æ¹è¡ç¥¨å­ä½å±æ§æ¶è°ç¨ã|
|[COleControlï¼OnforeColor å·²æ´æ¹](#onforecolorchanged)|æ´æ¹è¡ç¥¨åé¢è²å±æ§æ¶è°ç¨ã|
|[COleControlï¼å¨å»ç»äºä»¶](#onfreezeevents)|å½æ§ä»¶çäºä»¶è¢«å»ç»æè§£å»æ¶è°ç¨ã|
|[COleControlï¼onGetColorSet](#ongetcolorset)|éç¥å·²è°ç¨ç`IOleObject::GetColorSet`æ§ä»¶ã|
|[COleControlï¼OnGetControlInfo](#ongetcontrolinfo)|åå®¹å¨æä¾å©è®°ç¬¦ä¿¡æ¯ã|
|[COle æ§å¶ï¼ï¼å¨GetDisplayStringä¸](#ongetdisplaystring)|è°ç¨ä»¥è·åè¡¨ç¤ºå±æ§å¼çå­ç¬¦ä¸²ã|
|[COleControlï¼ongetinplacemenu](#ongetinplacemenu)|è¯·æ±å°ä¸å®¹å¨èååå¹¶çæ§ä»¶èåçå¥æã|
|[COleControlï¼OnGetèªç¶èå´](#ongetnaturalextent)|è¦çä»¥æ£ç´¢æ§ä»¶çæ¾ç¤ºå¤§å°ï¼ææ¥è¿å»ºè®®çå¤§å°åèå´æ¨¡å¼ã|
|[COle æ§å¶ï¼ï¼æå¼é¢å®ä¹å­ç¬¦ä¸²](#ongetpredefinedstrings)|è¿åè¡¨ç¤ºå±æ§çå¯è½å¼çå­ç¬¦ä¸²ã|
|[COle æ§å¶ï¼ï¼è·åé¢å®ä¹å¼](#ongetpredefinedvalue)|è¿åä¸é¢å®ä¹å­ç¬¦ä¸²å¯¹åºçå¼ã|
|[COleControlï¼OngetView èå´](#ongetviewextent)|è¦çä»¥æ£ç´¢æ§ä»¶çæ¾ç¤ºåºåçå¤§å°ï¼å¯ç¨äºå¯ç¨åééç»å¾ï¼ã|
|[COleControlï¼OngetViewrect](#ongetviewrect)|è¦çä»¥å°æ§ä»¶çå¤§å°è½¬æ¢ä¸ºä»ç¹å®ä½ç½®å¼å§çç©å½¢ã|
|[COleControlï¼Ongetæ¥çç¶æ](#ongetviewstatus)|è¦çä»¥æ£ç´¢æ§ä»¶çè§å¾ç¶æã|
|[COle æ§å¶ï¼å¨éèå·¥å·æ ä¸](#onhidetoolbars)|å½æ§ä»¶è¢« UI åç¨æ¶ï¼å®¹å¨è°ç¨ã|
|[COle æ§å¶ï¼å¨æ´»å¨é¼ æ ç§»å¨](#oninactivemousemove)|è¦çä»¥å°é¼ æ æéä¸çéæ´»å¨æ§ä»¶çå®¹å¨è°åº¦WM_MOUSEMOVEæ¶æ¯åéå°è¯¥æ§ä»¶ã|
|[COle æ§å¶ï¼oninactiveSetCursor](#oninactivesetcursor)|è¦çä»¥å°é¼ æ æéä¸çéæ´»å¨æ§ä»¶çå®¹å¨è°åº¦WM_SETCURSORæ¶æ¯åéå°è¯¥æ§ä»¶ã|
|[COleControlï¼å¨é®ä¸äºä»¶](#onkeydownevent)|å¨è¡ç¥¨å¯é¥å³é­äºä»¶å·²è§¦ååè°ç¨ã|
|[COleControlï¼ï¼å¨KeyPressäºä»¶](#onkeypressevent)|è¡ç¥¨ KeyPress äºä»¶å·²è§¦ååè°ç¨ã|
|[COleControlï¼å¨KeyUpeventä¸](#onkeyupevent)|å¨è¡ç¥¨ KeyUp äºä»¶å·²è§¦ååè°ç¨ã|
|[COleControlï¼å¨å°å¾å±æ§é¡µ](#onmappropertytopage)|æç¤ºç¨äºç¼è¾å±æ§çå±æ§é¡µã|
|[COleControlï¼onMnemonic](#onmnemonic)|æä¸æ§ä»¶çå©è®°ç¬¦é®æ¶è°ç¨ã|
|[COle æ§å¶ï¼ï¼å±æ§](#onproperties)|è°ç¨æ§ä»¶ç"å±æ§"è°è¯æ¶è°ç¨ã|
|[COle æ§å¶ï¼å¨æ¥è¯¢å½ä¸­ç¹](#onqueryhitpoint)|è¦çä»¥æ¥è¯¢æ§ä»¶çæ¾ç¤ºæ¯å¦ä¸ç»å®ç¹éå ã|
|[COleControlï¼å¨æ¥è¯¢ä¸­](#onqueryhitrect)|è¦çä»¥æ¥è¯¢æ§ä»¶çæ¾ç¤ºæ¯å¦ä¸ç»å®ç©å½¢ä¸­çä»»ä½ç¹éå ã|
|[COle æ§å¶ï¼å¨æ¸²ææ°æ®ä¸](#onrenderdata)|æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã|
|[COle æ§å¶ï¼å¨æ¸²ææä»¶æ°æ®ä¸](#onrenderfiledata)|æ¡æ¶è°ç¨ä»¥ä»¥æå®æ ¼å¼ä»æä»¶æ£ç´¢æ°æ®ã|
|[COle æ§å¶ï¼å¨æ¸²æå¨å±æ°æ®](#onrenderglobaldata)|æ¡æ¶è°ç¨ä»¥ä»¥æå®æ ¼å¼ä»å¨å±åå­æ£ç´¢æ°æ®ã|
|[COle æ§å¶ï¼å¨éç½®ç¶æ](#onresetstate)|å°æ§ä»¶çå±æ§éç½®ä¸ºé»è®¤å¼ã|
|[COleControlï¼å¨è®¾ç½®å®¢æ·ç«¯ç«ç¹](#onsetclientsite)|éç¥å·²è°ç¨ç`IOleControl::SetClientSite`æ§ä»¶ã|
|[COleControlï¼OnSetData](#onsetdata)|å°æ§ä»¶çæ°æ®æ¿æ¢ä¸ºå¦ä¸ä¸ªå¼ã|
|[COle æ§å¶ï¼å¨è®¾ç½®èå´](#onsetextent)|å¨æ§ä»¶çèå´å·²æ´æ¹åè°ç¨ã|
|[COle æ§å¶ï¼OnSetObjectrects](#onsetobjectrects)|æ´æ¹æ§ä»¶çå°ºå¯¸åè°ç¨ã|
|[COleControlï¼ï¼å¨æ¾ç¤ºå·¥å·æ ä¸](#onshowtoolbars)|å¨æ¿æ´»æ§ä»¶æ¶è°ç¨ã|
|[COle æ§å¶ï¼å¨ææ¬ä¸æ´æ¹](#ontextchanged)|æ´æ¹è¡ç¥¨ææ¬ææ é¢å±æ§æ¶è°ç¨ã|
|[COleControlï¼æ çªå£æ¶æ¯](#onwindowlessmessage)|å¤çæ çªå£æ§ä»¶ççªå£æ¶æ¯ï¼é¼ æ åé®çæ¶æ¯ä»¥å¤çï¼ã|
|[COleControlï¼:På®¢æ·](#parenttoclient)|å°ç¸å¯¹äºå®¹å¨åç¹çç¹è½¬æ¢ä¸ºç¸å¯¹äºæ§ä»¶åç¹çç¹ã|
|[COleControlï¼:Pæ¨¡å¼å¯¹è¯](#postmodaldialog)|éç¥å®¹å¨æ¨¡å¼å¯¹è¯æ¡å·²å³é­ã|
|[COleControlï¼:Péæ°æ¨¡å¼å¯¹è¯](#premodaldialog)|éç¥å®¹å¨å³å°æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡ã|
|[COle æ§å¶ï¼ï¼éæ°åå»ºæ§å¶çªå£](#recreatecontrolwindow)|éæ¯å¹¶éæ°åå»ºæ§ä»¶ççªå£ã|
|[COle æ§å¶ï¼å·æ°](#refresh)|å¼ºå¶éæ°ç»å¶æ§ä»¶çå¤è§ã|
|[COle æ§å¶ï¼ï¼åå¸æè·](#releasecapture)|éæ¾é¼ æ æè·ã|
|[COle æ§å¶ï¼éæ¾DC](#releasedc)|éæ¾æ çªå£æ§ä»¶å®¹å¨çæ¾ç¤ºè®¾å¤ä¸ä¸æã|
|[COle æ§å¶ï¼ï¼éç¶æ§å¶çªå£](#reparentcontrolwindow)|éç½®æ§ä»¶çªå£çç¶çº§ã|
|[COle æ§å¶ï¼ï¼éç½®åºå­](#resetstockprops)|å°`COleControl`è¡ç¥¨å±æ§åå§åå°å¶é»è®¤å¼ã|
|[COle æ§å¶ï¼éç½®çæ¬](#resetversion)|å°çæ¬å·åå§åä¸ºç»å®å¼ã|
|[COle æ§å¶ï¼æ»å¨çªå£](#scrollwindow)|åè®¸æ çªå£æ§ä»¶æ»å¨å¶å°±å°æ´»å¨å¾åä¸­çåºåã|
|[COle æ§å¶ï¼éæ©å­ä½å¯¹è±¡](#selectfontobject)|å¨è®¾å¤ä¸ä¸æä¸­éæ©èªå®ä¹å­ä½å±æ§ã|
|[COleControlï¼éæ©åºå­å­ä½](#selectstockfont)|å¨è®¾å¤ä¸ä¸æä¸­éæ©"åºå­å­ä½"å±æ§ã|
|[COle æ§å¶ï¼åºååèå´](#serializeextent)|åºååæåå§åæ§ä»¶çæ¾ç¤ºç©ºé´ã|
|[COle æ§å¶ï¼ï¼åºåååºå­](#serializestockprops)|åºååæåå§å`COleControl`è¡ç¥¨å±æ§ã|
|[COle æ§å¶ï¼åºååçæ¬](#serializeversion)|åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯ã|
|[COle æ§å¶ï¼ï¼è®¾ç½®å¤è§](#setappearance)|è®¾ç½®è¡ç¥¨å¤è§å±æ§çå¼ã|
|[COle æ§å¶ï¼ï¼è®¾ç½®åé¢è²](#setbackcolor)|è®¾ç½®è¡ç¥¨ BackColor å±æ§çå¼ã|
|[COle æ§å¶ï¼è®¾ç½®è¾¹æ¡æ ·å¼](#setborderstyle)|è®¾ç½®è¡ç¥¨è¾¹çæ ·å¼å±æ§çå¼ã|
|[COle æ§å¶ï¼è®¾ç½®æè·](#setcapture)|ä½¿æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶è·åé¼ æ æè·ã|
|[COle æ§å¶ï¼è®¾ç½®æ§å¶å¤§å°](#setcontrolsize)|è®¾ç½® OLE æ§ä»¶çä½ç½®åå¤§å°ã|
|[COle æ§å¶ï¼å·²å¯ç¨](#setenabled)|è®¾ç½®è¡ç¥¨å¯ç¨å±æ§çå¼ã|
|[COle æ§å¶ï¼è®¾ç½®ç¦ç¹](#setfocus)|ä½¿æ§ä»¶çå®¹å¨çªå£ä»¥æ§ä»¶çåä¹å ç¨è¾å¥ç¦ç¹ã|
|[COle æ§å¶ï¼ï¼è®¾ç½®å­ä½](#setfont)|è®¾ç½®è¡ç¥¨å­ä½å±æ§çå¼ã|
|[COleControlï¼è®¾ç½®ç¦å½©](#setforecolor)|è®¾ç½®è¡ç¥¨ ForeColor å±æ§çå¼ã|
|[COle æ§å¶ï¼è®¾ç½®åå§å¤§å°](#setinitialsize)|è®¾ç½®é¦æ¬¡æ¾ç¤ºå¨å®¹å¨ä¸­ç OLE æ§ä»¶çå¤§å°ã|
|[COle æ§å¶ï¼è®¾ç½®å·²ä¿®æ¹çæ è®°](#setmodifiedflag)|æ´æ¹æ§ä»¶çå·²ä¿®æ¹ç¶æã|
|[COle æ§å¶ï¼è®¾ç½®ä¸åè®¸](#setnotpermitted)|æç¤ºç¼è¾è¯·æ±å¤±è´¥ã|
|[COle æ§å¶ï¼è®¾ç½®ä¸æ¯æ](#setnotsupported)|é²æ­¢ç¨æ·ä¿®æ¹æ§ä»¶çå±æ§å¼ã|
|[COle æ§å¶ï¼setrectin å®¹å¨](#setrectincontainer)|è®¾ç½®æ§ä»¶ç¸å¯¹äºå¶å®¹å¨çç©å½¢ã|
|[COle æ§å¶ï¼è®¾ç½®ææ¬](#settext)|è®¾ç½®è¡ç¥¨ææ¬ææ é¢å±æ§çå¼ã|
|[COle æ§å¶ï¼ï¼ææ·éè¯¯](#throwerror)|æç¤º OLE æ§ä»¶ä¸­åçéè¯¯ã|
|[COle æ§å¶ï¼è½¬æ¢åºå¾·](#transformcoords)|è½¬æ¢å®¹å¨åæ§ä»¶ä¹é´çåæ å¼ã|
|[COleControlï¼ç¿»è¯é¢è²](#translatecolor)|å°OLE_COLORå¼è½¬æ¢ä¸º COLORREF å¼ã|
|[COle æ§å¶ï¼å¨å è½½æé´ï¼ç¯å¢å°ææ](#willambientsbevalidduringload)|ç¡®å®ä¸æ¬¡å è½½æ§ä»¶æ¶ç¯å¢å±æ§æ¯å¦å¯ç¨ã|
|[COle æ§å¶ï¼ï¼çªå£ Proc](#windowproc)|ä¸º`COleControl`å¯¹è±¡æä¾ Windows è¿ç¨ã|

### <a name="protected-methods"></a>åä¿æ¤çæ¹æ³

|åç§°|è¯´æ|
|----------|-----------------|
|[COleControlï¼:Dåå§åå®¹](#drawcontent)|å½éè¦æ´æ°æ§ä»¶çå¤è§æ¶ï¼ç±æ¡æ¶è°ç¨ã|
|[COleControlï¼:Dåå§åæä»¶](#drawmetafile)|ä½¿ç¨åæä»¶è®¾å¤ä¸ä¸ææ¶ç±æ¡æ¶è°ç¨ã|
|[COle æ§å¶ï¼è¢«è°ç¨åè®¸](#isinvokeallowed)|å¯ç¨èªå¨åæ¹æ³è°ç¨ã|
|[COleControlï¼è®¾ç½®åå§æ°æ®æ ¼å¼](#setinitialdataformats)|ç±æ¡æ¶è°ç¨ä»¥åå§åæ§ä»¶æ¯æçæ°æ®æ ¼å¼åè¡¨ã|

## <a name="remarks"></a>å¤æ³¨

æ´¾çèª`CWnd`çç±»ç»§æ¿ Windows çªå£å¯¹è±¡çææåè½ä»¥åç¹å®äº OLE çå¶ä»åè½ï¼å¦äºä»¶è§¦ååæ¯ææ¹æ³åå±æ§çåè½ã

OLE æ§ä»¶å¯ä»¥æå¥å° OLE å®¹å¨åºç¨ç¨åºä¸­ï¼å¹¶ä½¿ç¨äºä»¶è§¦åçååç³»ç»ä¸å®¹å¨éä¿¡ï¼å¹¶å°æ¹æ³åå±æ§å¬å¼å°å®¹å¨ä¸­ã è¯·æ³¨æï¼æ å OLE å®¹å¨ä»æ¯æ OLE æ§ä»¶çåºæ¬åè½ã å®ä»¬æ æ³æ¯æ OLE æ§ä»¶çæ©å±åè½ã å½ç±äºæ§ä»¶ä¸­åççæäºæä½èå°äºä»¶åéå°å®¹å¨æ¶ï¼å°åçäºä»¶è§¦åã åè¿æ¥ï¼å®¹å¨éè¿ä½¿ç¨ä¸C++ç±»çæåå½æ°åæ°æ®æåç±»ä¼¼çä¸ç»å¬å¼æ¹æ³åå±æ§ä¸æ§ä»¶éä¿¡ã æ­¤æ¹æ³åè®¸å¼åäººåæ§å¶æ§ä»¶çå¤è§ï¼å¹¶å¨åçæäºæä½æ¶éç¥å®¹å¨ã

## <a name="windowless-controls"></a>æ çªå£æ§ä»¶

OLE æ§ä»¶å¯ä»¥å¨æ²¡æçªå£çæåµä¸å°±å°æ´»å¨ä½¿ç¨ã æ çªå£æ§ä»¶å·ææ¾èä¼å¿ï¼

- æ çªå£æ§ä»¶å¯ä»¥æ¯éæçåéç©å½¢ç

- æ çªå£æ§ä»¶å¯åå°å¯¹è±¡çå®ä¾å¤§å°ååå»ºæ¶é´

æ§ä»¶ä¸éè¦çªå£ã çªå£æä¾çæå¡å¯éè¿åä¸ªå±äº«çªå£ï¼éå¸¸æ¯å®¹å¨ççªå£ï¼åä¸äºè°åº¦ä»£ç è½»æ¾æä¾ã æ¥æçªå£å¨å¯¹è±¡ä¸å¤§å¤æ¯ä¸å¿è¦çå¤æå ç´ ã

ä½¿ç¨æ çªå£æ¿æ´»æ¶ï¼å®¹å¨ï¼å¶ä¸­ç¡®å®æä¸ä¸ªçªå£ï¼è´è´£æä¾å¦åç±æ§ä»¶èªå·±ççªå£æä¾çæå¡ã ä¾å¦ï¼å¦ææ§ä»¶éè¦æ¥è¯¢é®çç¦ç¹ãæ¥è¯¢é¼ æ æè·æè·åè®¾å¤ä¸ä¸æï¼åè¿äºæä½ç±å®¹å¨ç®¡çã æ `COleControl`çªå£æä½æåå½æ°å¨å®¹å¨ä¸è°ç¨è¿äºæä½ã

å¯ç¨æ çªå£æ¿æ´»åï¼å®¹å¨ä¼å°è¾å¥æ¶æ¯å§æç»æ§ä»¶ç`IOleInPlaceObjectWindowless`æ¥å£ï¼ç¨äºæ çªå£æ¯æç[IOleInPlace å¯¹è±¡ç](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)æ©å±ï¼ã `COleControl`æ­¤æ¥å£çå®ç°å°å¨éå½è°æ´é¼ æ åæ åéè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦è¿äºæ¶æ¯ã éè¿å°ç¸åºçæ¡ç®æ·»å å°æ¶æ¯æ å°ï¼å¯ä»¥åæ®éçªå£æ¶æ¯ä¸æ ·å¤çè¿äºæ¶æ¯ã

å¨æ çªå£æ§ä»¶ä¸­`COleControl`ï¼åºå§ç»ä½¿ç¨æåå½æ°ï¼èä¸æ¯ç¸åºç`CWnd`æåå½æ°æå¶ç¸å³ç Windows API å½æ°ã

OLE æ§å¶å¯¹è±¡ä¹å¯ä»¥åå»ºçªå£ï¼åªæå½å®ä»¬åä¸ºæ´»å¨ç¶ææ¶ï¼ä½éæ´»å¨-ä¸»å¨è¿æ¸¡æéçå·¥ä½éä¼ä¸åï¼è½¬æ¢çéåº¦ä¹ä¼éä½ã å¨æäºæåµä¸ï¼è¿æ¯ä¸ä¸ªé®é¢ï¼ä¾å¦ï¼èèææ¬æ¡çç½æ ¼ã å¨åä¸ä¸æ¸¸æ æ¶ï¼æ¯ä¸ªæ§ä»¶é½å¿é¡»å°±å°æ¿æ´»ï¼ç¶ååç¨ã éæ´»å¨/ä¸»å¨è¿æ¸¡çéåº¦å°ç´æ¥å½±åæ»å¨éåº¦ã

æå³å¼å OLE æ§å¶æ¡æ¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[æç«  MFC ActiveX](../../mfc/mfc-activex-controls.md)æ§å¶å[æ¦è¿°ï¼åå»º MFC ActiveX æ§å¶ç¨åº](../../mfc/reference/mfc-activex-control-wizard.md)ã æå³ä¼å OLE æ§ä»¶ï¼åæ¬æ çªå£åæ éªçæ§ä»¶ï¼çä¿¡æ¯ï¼è¯·åé[MFC ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="inheritance-hierarchy"></a>ç»§æ¿å±æ¬¡ç»æ

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>è¦æ±

**æ é¢ï¼** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COle æ§å¶ï¼ç¯å¢èé¢é¢è²

è¿åç¯å¢ BackColor å±æ§çå¼ã

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢ BackColor å±æ§ï¼å¦ææï¼çå½åå¼ã å¦æä¸æ¯æè¯¥å±æ§ï¼åæ­¤å½æ°å°è¿åç³»ç»å®ä¹ç Windows èæ¯é¢è²ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢ BackColor å±æ§å¯ç¨äºæææ§ä»¶ï¼ç±å®¹å¨å®ä¹ã è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControlï¼ç¯å¢æ¾ç¤ºåç§°

å®¹å¨åéç»æ§ä»¶çåç§°å¯ç¨äºåç¨æ·æ¾ç¤ºçéè¯¯æ¶æ¯ã

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>è¿åå¼

OLE æ§ä»¶çåç§°ã é»è®¤å¼ä¸ºé¶é¿åº¦å­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControlï¼ç¯å¢å­ä½

è¿åç¯å¢å­ä½å±æ§çå¼ã

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>è¿åå¼

æåå®¹å¨çç¯å¢å­ä½è°åº¦çé¢çæéã é»è®¤å¼ä¸º NULLã å¦æè¿åä¸ç­äº NULLï¼åè´è´£éè¿è°ç¨å¶[INotnotï¼ï¼ï¼éæ¾](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)æååè½æ¥éæ¾å­ä½ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢å­ä½å±æ§ç±å®¹å¨å®ä¹ï¼å¯ä¾æææ§ä»¶ä½¿ç¨ãè¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControlï¼ç¯å¢ç¦å½©

è¿åç¯å¢ ForeColor å±æ§çå¼ã

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢ ForeColor å±æ§ï¼å¦ææï¼çå½åå¼ã å¦æä¸æ¯æï¼æ­¤å½æ°å°è¿åç³»ç»å®ä¹ç Windows ææ¬é¢è²ã

### <a name="remarks"></a>å¤æ³¨

ç¯å¢ ForeColor å±æ§å¯ç¨äºæææ§ä»¶ï¼ç±å®¹å¨å®ä¹ã è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControlï¼ç¯å¢åºåID

è¿åå®¹å¨çåºåè®¾ç½® IDã

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨ç LocaleID å±æ§çå¼ï¼å¦ææï¼ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿å 0ã

### <a name="remarks"></a>å¤æ³¨

æ§ä»¶å¯ä»¥ä½¿ç¨åºåè®¾ç½®IDè°æ´å¶ç¨æ·çé¢ä»¥è¿è¡ç¹å®åºåè®¾ç½®ã è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControlï¼ç¯å¢å¤è§

æ£ç´¢æ§ä»¶å¯¹è±¡çå½åå¤è§è®¾ç½®ã

```
short AmbientAppearance();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çå¤è§ï¼

- **0**å¹³é¢å¤è§

- **1** 3D å¤è§

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»¥æ£ç´¢æ§ä»¶çDISPID_AMBIENT_APPEARANCEå±æ§çå½åå¼ã

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COle æ§å¶ï¼ï¼ç¯å¢å°ºåº¦åä½

è¿åå®¹å¨ä½¿ç¨çåä½ç±»åã

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>è¿åå¼

åå«å®¹å¨çç¯å¢ç¼©æ¾åä½çå­ç¬¦ä¸²ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿åä¸ä¸ªé¶é¿åº¦å­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

å®¹å¨çç¯å¢ ScaleUnits å±æ§å¯ç¨äºæ¾ç¤ºä½ç½®æå°ºå¯¸ï¼è¿äºä½ç½®æå°ºå¯¸æ ææéåä½ï¼å¦ twips æåç±³ã è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COle æ§å¶ï¼ï¼ç¯å¢æ¾ç¤ºææ

ç¡®å®å®¹å¨æ¯å¦åè®¸æ§ä»¶å¨æ¿æ´»æ¶æ¾ç¤ºèªèº«çæåæ§ç¹ã

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>è¿åå¼

å¦æåºæ¾ç¤ºæåææï¼åéé¶;å¦å 0ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿åéé¶ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COle æ§å¶ï¼ç¯å¢æ¾ç¤ºå¡«å

ç¡®å®å®¹å¨æ¯å¦åè®¸æ§ä»¶å¨ UI å¤äºæ´»å¨ç¶ææ¶ä½¿ç¨é´å½±æ¨¡å¼æ¾ç¤ºèªèº«ã

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>è¿åå¼

å¦æåºæ¾ç¤ºé´å½±å¾æ¡ï¼åéé¶;å¦å 0ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿åéé¶ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COle æ§å¶ï¼ç¯å¢ææ¬å¯¹é½

ç¡®å®æ§ä»¶å®¹å¨é¦éçç¯å¢ææ¬å¯¹é½æ¹å¼ã

```
short AmbientTextAlign();
```

### <a name="return-value"></a>è¿åå¼

å®¹å¨çç¯å¢ææ¬å¯¹é½å±æ§çç¶æã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿å 0ã

ä»¥ä¸æ¯ææè¿åå¼çåè¡¨ï¼

|è¿åå¼|å«ä¹|
|------------------|-------------|
|0|ä¸è¬å¯¹é½ï¼å³ä¾§çæ°å­ï¼å·¦ä¾§çææ¬ï¼ã|
|1|å·¦å¯¹é½|
|2|ä¸­å¿|
|3|æ­£ç¡®è¯æ|

### <a name="remarks"></a>å¤æ³¨

æ­¤å±æ§å¯ç¨äºææåµå¥çæ§ä»¶ï¼å¹¶ç±å®¹å¨å®ä¹ã è¯·æ³¨æï¼ä¸æ¯ææ­¤å±æ§ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControlï¼ç¯å¢UIDead

ç¡®å®å®¹å¨æ¯å¦å¸ææ§ä»¶ååºç¨æ·çé¢æä½ã

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶åºååºç¨æ·çé¢æä½ï¼åéé¶;å¦å 0ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°è¿å 0ã

### <a name="remarks"></a>å¤æ³¨

ä¾å¦ï¼å®¹å¨å¯è½å¨è®¾è®¡æ¨¡å¼ä¸å° TRUE è®¾ç½®ä¸º TRUEã

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COle æ§å¶ï¼ç¯å¢ç¨æ·æ¨¡å¼

ç¡®å®å®¹å¨æ¯å¤äºè®¾è®¡æ¨¡å¼è¿æ¯ç¨æ·æ¨¡å¼ã

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>è¿åå¼

å¦æå®¹å¨å¤äºç¨æ·æ¨¡å¼ï¼åéé¶;å¦å 0ï¼å¨è®¾è®¡æ¨¡å¼ä¸ï¼ã å¦æä¸æ¯ææ­¤å±æ§ï¼åæ­¤å½æ°å°è¿å TRUEã

### <a name="remarks"></a>å¤æ³¨

ä¾å¦ï¼å®¹å¨å¯è½ä¼å¨è®¾è®¡æ¨¡å¼ä¸å°æ­¤è®¾ç½®ä¸º FALSEã

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COle æ§å¶ï¼ç»å®å±æ§å·²æ´æ¹

è¡¨ç¤ºç»å®å±æ§å¼å·²æ´æ¹ã

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
æ§ä»¶çç»å®å±æ§çè°åº¦ IDã

### <a name="remarks"></a>å¤æ³¨

æ¯æ¬¡å±æ§çå¼åçæ´æ¹æ¶ï¼é½å¿é¡»è°ç¨æ­¤å¼ï¼å³ä½¿å¨æªéè¿å±æ§ Set æ¹æ³è¿è¡æ´æ¹çæåµä¸ä¹æ¯å¦æ­¤ã ç¹å«è¦æ³¨ææ å°å°æååéçç»å®å±æ§ã ä»»ä½æ¶åï¼å¿é¡»è°ç¨æ­¤ç±»æååé`BoundPropertyChanged`ã

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COle æ§å¶ï¼ï¼ç»å®å±æ§è¯·æ±ç¼è¾

è¯·æ±`IPropertyNotifySink`æ¥å£çæéä»¥æ´æ¹æ§ä»¶æä¾çç»å®å±æ§å¼ã

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
æ§ä»¶çç»å®å±æ§çè°åº¦ IDã

### <a name="return-value"></a>è¿åå¼

å¦æåè®¸æ´æ¹ï¼åéé¶;å¦å 0ã é»è®¤å¼ä¸ºéé¶ã

### <a name="remarks"></a>å¤æ³¨

å¦ææéè¢«æç»ï¼æ§ä»¶ä¸å¾è®©å±æ§çå¼æ´æ¹ã è¿å¯ä»¥éè¿å¿½ç¥æå¤±è´¥è¯å¾æ´æ¹å±æ§å¼çæä½æ¥å®ç°ã

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COle æ§å¶ï¼ï¼å®¢æ·ç«¯å°ç¶çº§

å°*pPoint*çåæ è½¬æ¢ä¸ºç¶åæ ã

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
æåå®¹å¨å OLE æ§ä»¶çè¾¹çã ä¸æ¯å·¥ä½åºï¼èæ¯æ´ä¸ªæ§ä»¶çåºåï¼åæ¬è¾¹æ¡åæ»å¨æ¡ã

*pPoint*<br/>
æå OLE å·¥ä½åºç¹çæéè¦è½¬æ¢ä¸ºç¶ï¼å®¹å¨ï¼çåæ ã

### <a name="remarks"></a>å¤æ³¨

å¨è¾å¥*pPoint*ä¸ä¸ OLE æ§ä»¶çå·¥ä½åºçåç¹ï¼æ§ä»¶çå·¥ä½åºçå·¦ä¸è§ï¼ç¸å³ã å¨è¾åº*pPoint*ä¸ç¸å¯¹äºç¶çº§ï¼å®¹å¨çå·¦ä¸è§ï¼çåç¹ã

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COle æ§å¶ï¼ï¼ClipCaretrect

å¦æå¾æç©å½¢å®å¨æé¨åè¢«éå çä¸éæå¯¹è±¡è¦çï¼åè°æ´å¶ç©å½¢ã

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
å¨è¾å¥æ¶ï¼æå[RECT](/windows/win32/api/windef/ns-windef-rect)ç»æçæéï¼å¶ä¸­åå«è¦è°æ´çæå¥åºåã å¨è¾åºæ¶ï¼å¦æå·²å®å¨è¦ççå¾æç©å½¢ï¼åè°æ´çæ¤çåºåæ NULLã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå¥å¨æ¯éªçççº¿ãåæä½å¾ï¼éå¸¸æç¤ºææ¬æå¾å½¢çæå¥ä½ç½®ã

å¦æä¸é¦åæ£æ¥éå¨æ¯å¦é¨åéèæå®å¨è¢«éå å¯¹è±¡éèï¼åæ çªå£å¯¹è±¡æ æ³å®å¨å°æ¾ç¤ºéå¿ã ä¸ºäºä½¿è¿ä¸ç¹æä¸ºå¯è½ï¼å¯¹è±¡å¯ä»¥ä½¿ç¨`ClipCaretRect`æ¥è°æ´ï¼åå°ï¼è´´å¾ï¼ä»¥ç¡®ä¿å¶éååªååºåã

åå»º care å¨çå¯¹è±¡åºå°å æ¯ç¹ç©å½¢æäº¤`ClipCaretRect`å° caret å¹¶ä½¿ç¨è°æ´çç©å½¢è¿è¡ caretã å¦æ care å®å¨éèï¼åæ­¤æ¹æ³å°è¿å FALSEï¼å¨è¿ç§æåµä¸æ ¹æ¬ä¸åºæ¾ç¤ºè¯¥ careã

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COle æ§å¶ï¼COle æ§å¶

æé  `COleControl` å¯¹è±¡ã

```
COleControl();
```

### <a name="remarks"></a>å¤æ³¨

éå¸¸ä¸ç´æ¥è°ç¨æ­¤åè½ã ç¸åï¼OLE æ§ä»¶éå¸¸ç±å¶ç±»å·¥ååå»ºã

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COle æ§å¶ï¼ï¼æ§å¶ä¿¡æ¯å·²æ´æ¹

å½æ§ä»¶æ¯æçå©è®°ç¬¦éå·²æ´æ¹æ¶ï¼è°ç¨æ­¤åè½ã

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>å¤æ³¨

æ¶å°æ­¤éç¥åï¼æ§ä»¶çå®¹å¨éè¿è°ç¨ IOleControl è·å¾ä¸ç»æ°çå©è®°ç¬¦[ï¼ï¼getControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)ã è¯·æ³¨æï¼ä¸éè¦å®¹å¨ååºæ­¤éç¥ã

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControlï¼:Dæ­æ¾éè¯¯

å¤çè¡ç¥¨éè¯¯äºä»¶åç±æ¡æ¶è°ç¨ï¼é¤éäºä»¶å¤çç¨åºå·²ç¦æ­¢æ¾ç¤ºéè¯¯ï¼ã

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>åæ°

*scode*<br/>
è¦æ¥åçç¶æä»£ç å¼ã æå³å¯è½ä»£ç çå®æ´åè¡¨ï¼è¯·åé["ActiveX æ§ä»¶ï¼é«çº§ä¸»é¢"ä¸](../../mfc/mfc-activex-controls-advanced-topics.md)æã

*lpszæè¿°*<br/>
æ¥åçéè¯¯çè¯´æã

*lpszæ¥æº*<br/>
çæéè¯¯çæ¨¡åçåç§°ï¼éå¸¸ä¸º OLE æ§å¶æ¨¡åçåç§°ï¼ã

*lpszHelpæä»¶*<br/>
åå«éè¯¯è¯´æçå¸®å©æä»¶çåç§°ã

*nHelpID*<br/>
æ¥åéè¯¯çå¸®å©ä¸ä¸æ IDã

### <a name="remarks"></a>å¤æ³¨

é»è®¤è¡ä¸ºæ¾ç¤ºä¸ä¸ªæ¶æ¯æ¡ï¼å¶ä¸­åå«éè¯¯æè¿°ï¼åå«å¨*lpszæè¿° ä¸­*ã

éåæ­¤å½æ°ä»¥èªå®ä¹éè¯¯æ¾ç¤ºæ¹å¼ã

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControlï¼:DoClick

æ¨¡ææ§ä»¶ä¸çé¼ æ åå»æä½ã

```cpp
void DoClick();
```

### <a name="remarks"></a>å¤æ³¨

å°è°ç¨å¯`COleControl::OnClick`éåçæåå½æ°ï¼å¦ææ§ä»¶æ¯æï¼å°è§¦ååºå­åå»äºä»¶ã

`COleControl`åºç±»æ¯ææ­¤åè½ä½ä¸ºè¡ç¥¨æ¹æ³ï¼ç§°ä¸º DoClickï¼ã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼æ¹æ³](../../mfc/mfc-activex-controls-methods.md)ã

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControlï¼:DoPropExchange

ä»æä¹å­å¨è¡¨ç¤ºï¼å¦æµæå±æ§éï¼å è½½æå­å¨æ§ä»¶æ¶ç±æ¡æ¶è°ç¨ã

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
ä¸ä¸ªæå `CPropExchange` å¯¹è±¡çæéã æ¡æ¶æä¾æ­¤å¯¹è±¡ä»¥å»ºç«å±æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸è°ç¨**PX_** å½æ°ç³»åä»¥å è½½æå­å¨ OLE æ§ä»¶çç¹å®ç¨æ·å®ä¹å±æ§ã

å¦ææ§ä»¶åå¯¼å·²ç¨äºåå»º OLE æ§å¶é¡¹ç®ï¼åæ­¤å½æ°çéåçæ¬å°åºåååºç±»å½æ° è°ç¨ æ¯æ`COleControl`çè¡ç¥¨å±æ§`COleControl::DoPropExchange`ã å°ç¨æ·å®ä¹çå±æ§æ·»å å° OLE æ§ä»¶æ¶ï¼éè¦ä¿®æ¹æ­¤å½æ°ä»¥åºååæ°å±æ§ã æå³åºååçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼åºåå](../../mfc/mfc-activex-controls-serializing.md)ã

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControlï¼:Dè¶ç±»ç»ç»

éç»ä» Windows æ§ä»¶ä¸­å­åç±»ç OLE æ§ä»¶ã

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æåæ§ä»¶å®¹å¨çè®¾å¤ä¸ä¸æçæéã

*rcBunds*<br/>
è¦ç»å¶æ§ä»¶çåºåã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»¥æ­£ç¡®å¤çéæ´»å¨ OLE æ§ä»¶çç»å¶ã ä»å½ OLE æ§ä»¶å­ç±» Windows æ§ä»¶æ¶æåºä½¿ç¨æ­¤å½æ°ï¼`OnDraw`å¹¶ä¸åºå¨æ§ä»¶çå½æ°ä¸­è°ç¨ã

æå³æ­¤åè½åå­ç±» Windows æ§ä»¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åé["ActiveX æ§ä»¶ï¼å¯¹ Windows æ§ä»¶è¿è¡å­ç±»å](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)"ä¸æã

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControlï¼:Dåå§åå®¹

å½éè¦æ´æ°æ§ä»¶çå¤è§æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æåè®¾å¤ä¸ä¸æçæéã

*é¢ç­æ··åå*<br/>
è¦ç»å¶çç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°ç´æ¥è°ç¨å¯`OnDraw`éåå½æ°ã

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControlï¼:Dåå§åæä»¶

ä½¿ç¨åæä»¶è®¾å¤ä¸ä¸ææ¶ç±æ¡æ¶è°ç¨ã

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æååæä»¶è®¾å¤ä¸ä¸æçæéã

*é¢ç­æ··åå*<br/>
è¦ç»å¶çç©å½¢åºåã

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COle æ§å¶ï¼å¯ç¨ç®åå¸§

å¯ç¨ OLE æ§ä»¶çç®åå¸§ç¹æ§ã

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>å¤æ³¨

æ­¤ç¹æ§åè®¸æ§ä»¶æ¯æå¶ä»æ§ä»¶çå¯è§åå«ï¼ä½ä¸æ¯æçæ­£ç OLE éå¶ã ä¾å¦ï¼ä¸ä¸ªç»æ¡ï¼å¶ä¸­æå¤ä¸ªæ§ä»¶ã è¿äºæ§ä»¶ä¸æ¯ OLE åå«çï¼ä½å®ä»¬ä½äºåä¸ç»æ¡ä¸­ã

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControlï¼ï¼äº¤æ¢èå´

åºååæåå§åæ§ä»¶èå´çç¶æï¼å¶å°ºå¯¸ä»¥ HIMETRIC åä½ä¸ºåä½ï¼ã

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
æå[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡çæéã æ¡æ¶æä¾æ­¤å¯¹è±¡ä»¥å»ºç«å±æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

### <a name="return-value"></a>è¿åå¼

å¦æå½æ°æåï¼åéé¶;0 å¦åã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸ç±`COleControl::DoPropExchange`çé»è®¤å®ç°è°ç¨ã

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControlï¼ï¼äº¤ææè¡ç¥¨ä¾åºå

åºååæåå§åæ§ä»¶çåºå­å±æ§çç¶æã

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
æå[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡çæéã æ¡æ¶æä¾æ­¤å¯¹è±¡ä»¥å»ºç«å±æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°éå¸¸ç±`COleControl::DoPropExchange`çé»è®¤å®ç°è°ç¨ã

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControlï¼äº¤æ¢çæ¬

åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯çç¶æã

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>åæ°

*pPX*<br/>
ä¸ä¸ªæå `CPropExchange` å¯¹è±¡çæéã æ¡æ¶æä¾æ­¤å¯¹è±¡ä»¥å»ºç«å±æ¢çä¸ä¸æï¼åæ¬å¶æ¹åã

*dwVersionDefault*<br/>
æ§ä»¶çå½åçæ¬å·ã

*bè½¬æ¢*<br/>
æç¤ºå¨ä¿å­æ¶æ¯å¦åºå°æä¹æ§æ°æ®è½¬æ¢ä¸ºææ°æ ¼å¼ï¼è¿æ¯ä»¥å è½½çç¸åæ ¼å¼è¿è¡ç»´æ¤ã

### <a name="return-value"></a>è¿åå¼

å½æ°çéé¶æå;0 å¦åã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ï¼è¿å°æ¯æ§ä»¶å¯¹ è°ç¨ çç¬¬ä¸ä¸ªå½æ°`COleControl::DoPropExchange`ã å è½½æ¶ï¼æ­¤å½æ°è¯»åæä¹æ°æ®ççæ¬å·ï¼å¹¶ç¸åºå°è®¾ç½®[CPropExchange](../../mfc/reference/cpropexchange-class.md)å¯¹è±¡ççæ¬å±æ§ã ä¿å­æ¶ï¼æ­¤å½æ°åå¥æä¹æ°æ®ççæ¬å·ã

æå³æä¹æ§åçæ¬æ§å¶çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼åºåå](../../mfc/mfc-activex-controls-serializing.md)ã

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COle æ§å¶ï¼ç«å»

å½é¼ æ åå»æ´»å¨æ§ä»¶æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦å"åå»"äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­åå»äºä»¶ã

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControlï¼ï¼ç«ç¹ç¹å»

å½é¼ æ å¨æ´»å¨æ§ä»¶ä¸åå»æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireDblClick();
```

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦å DblClick äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­ DblClick äºä»¶ã

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COleæ§å¶ï¼ç«éè¯¯

è§¦ååºå­éè¯¯äºä»¶ã

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>åæ°

*scode*<br/>
è¦æ¥åçç¶æä»£ç å¼ã æå³å¯è½ä»£ç çå®æ´åè¡¨ï¼è¯·åé["ActiveX æ§ä»¶ï¼é«çº§ä¸»é¢"ä¸](../../mfc/mfc-activex-controls-advanced-topics.md)æã

*lpszæè¿°*<br/>
æ¥åçéè¯¯çè¯´æã

*nHelpID*<br/>
æ¥åéè¯¯çå¸®å© IDã

### <a name="remarks"></a>å¤æ³¨

æ­¤äºä»¶æä¾äºä¸ç§å¨ä»£ç ä¸­éå½ä½ç½®ååºéè¯¯ä¿¡å·çæ¹å¼ã ä¸å¶ä»è¡ç¥¨äºä»¶ï¼å¦åå»æé¼ æ ç§»å¨ï¼ä¸åï¼æ¡æ¶æ°¸è¿ä¸ä¼è§¦åéè¯¯ã

è¦æ¥åå¨å±æ§è·åå½æ°ãå±æ§éå½æ°æèªå¨åæ¹æ³æé´åççéè¯¯ï¼è¯·è°ç¨[COleControlï¼ï¼ï¼throwError](#throwerror)ã

OLE æ§ä»¶ç"åºå­éè¯¯"äºä»¶çå®ç°ä½¿ç¨ SCODE å¼ã å¦ææ¨çæ§ä»¶ä½¿ç¨æ­¤äºä»¶ï¼å¹¶ä¸æç®å¨ Visual Basic 4.0 ä¸­ä½¿ç¨ï¼æ¨å°æ¶å°éè¯¯ï¼å ä¸º Visual Basic ä¸­ä¸æ¯æ SCODE å¼ã

è¦è§£å³æ­¤é®é¢ï¼è¯·æå¨æ´æ¹æ§ä»¶ ä¸­ç SCODE åæ°ãODL æä»¶é¿ **ã** æ­¤å¤ï¼ä½¿ç¨ SCODE åæ°çä»»ä½èªå®ä¹äºä»¶ãæ¹æ³æå±æ§ä¹ä¼å¯¼è´åæ ·çé®é¢ã

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COle æ§å¶ï¼ç«äºä»¶

ä½¿ç¨ä»»ææ°éçå¯éåæ°ä»æ§ä»¶è§¦åç¨æ·å®ä¹çäºä»¶ã

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
è¦è§¦åçäºä»¶çè°åº¦ IDã

*pbParams*<br/>
äºä»¶åæ°ç±»åçæè¿°ç¬¦ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ä¸åºç´æ¥è°ç¨æ­¤å½æ°ã ç¸åï¼æ¨å°å¨æ§ä»¶ç±»å£°æçäºä»¶æ å°é¨åè°ç¨äºä»¶è§¦åå½æ°ã

*pbParams*åæ°æ¯**ç©ºé´**åéVTS_åè¡¨ã å¶ä¸­ä¸ä¸ªæå¤ä¸ªå¼ï¼ç±ç©ºæ ¼ï¼èä¸æ¯éå·ï¼åéï¼æå®å½æ°çåæ°åè¡¨ã å¯è½çå¼å¦ä¸æç¤ºï¼

|ç¬¦å·|åæ°ç±»å|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> å·²ä¸ºææåä½ç±»åå®ä¹äºå¶ä»åä½å¸¸éï¼ä½æä¾æååä½æ°æ®å¸¸éçVTS_FONTåVTS_PICTUREé¤å¤ã è¿äºå¸¸éä½¿ç¨**VTS_P**`constantname`çº¦å®å½åã ä¾å¦ï¼VTS_PCOLORæ¯æåVTS_COLORå¸¸éçæéã

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COle æ§å¶ï¼ï¼ç«é®åä¸

å½æ§ä»¶å¤äºæ´»å¨ç¶ææ¶æä¸é®æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>åæ°

*pnChar*<br/>
æåæä¸å¯é¥çèæå¯é¥ä»£ç å¼ã æå³æ åèæå¯é¥ä»£ç çåè¡¨ï¼è¯·åé Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦å KeyDown äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­ KeyDown äºä»¶ã

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControlï¼ï¼FireKeyPress

å½èªå®ä¹æ§ä»¶å¨å®¹å¨ä¸­ä¸º UI æ´»å¨æ¶ï¼æ¡æ¶è°ç¨è¯¥é®å¹¶éæ¾è¯¥é®ã

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>åæ°

*pnChar*<br/>
æåæä¸çé®çå­ç¬¦å¼çæéã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

äºä»¶çæ¥æ¶èå¯ä»¥ä¿®æ¹*pnCharï¼* ä¾å¦ï¼å°ææå°åå­ç¬¦è½¬æ¢ä¸ºå¤§åã å¦æè¦æ£æ¥ä¿®æ¹åçå­ç¬¦ï¼å°éå`OnKeyPressEvent`ã

è¦èªå¨è§¦å KeyPress äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­ KeyPress äºä»¶ã

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COle æ§å¶ï¼ç«é®åä¸

å½èªå®ä¹æ§ä»¶å¨å®¹å¨ä¸­ä¸º UI æ´»å¨æ¶éæ¾å¯é¥æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>åæ°

*pnChar*<br/>
æåå·²éæ¾å¯é¥çèæå¯é¥ä»£ç å¼ã æå³æ åèæå¯é¥ä»£ç çåè¡¨ï¼è¯·åé Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦å KeyUp äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­ KeyUp äºä»¶ã

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControlï¼ç«é¼ åä¸

å½é¼ æ æé®æå¨æ´»å¨èªå®ä¹æ§ä»¶ä¸æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>åæ°

*nButton*<br/>
æä¸é¼ æ æé®çæ°å¼ã å®å¯ä»¥åå«ä»¥ä¸å¼ä¹ä¸ï¼

- LEFT_BUTTONé¼ æ å·¦é®æä¸ã

- MIDDLE_BUTTONæä¸é¼ æ ä¸­é´é®ã

- RIGHT_BUTTONæä¸é¼ æ å³é®ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

*x*<br/>
æä¸é¼ æ æé®æ¶åæ ç x åæ ã åæ ç¸å¯¹äºæ§å¶çªå£çå·¦ä¸è§ã

*Y*<br/>
æä¸é¼ æ æé®æ¶åæ ç y åæ ã åæ ç¸å¯¹äºæ§å¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦åé¼ æ ä¸é¨äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­é¼ æ åä¸äºä»¶ã

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControlï¼ç«é¼ ç§»å¨

å½æ¸¸æ ç§»å¨å°æ´»å¨èªå®ä¹æ§ä»¶æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>åæ°

*nButton*<br/>
æä¸çé¼ æ æé®çæ°å¼ã åå«ä»¥ä¸å¼çç»åï¼

- LEFT_BUTTONæä½æé´æä¸é¼ æ å·¦é®ã

- MIDDLE_BUTTONæä½æé´æä¸é¼ æ ä¸­é´æé®ã

- RIGHT_BUTTONæä½æé´æä¸äºé¼ æ å³é®ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

*x*<br/>
åæ ç x åæ ã åæ ç¸å¯¹äºæ§å¶çªå£çå·¦ä¸è§ã

*Y*<br/>
åæ ç y åæ ã åæ ç¸å¯¹äºæ§å¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦å MouseMove äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­ MouseMove äºä»¶ã

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControlï¼ç«é¼ 

å½é¼ æ æé®éæ¾å°æ´»å¨èªå®ä¹æ§ä»¶ä¸æ¶ï¼ç±æ¡æ¶è°ç¨ã

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>åæ°

*nButton*<br/>
éæ¾çé¼ æ æé®çæ°å¼ã å¯ä»¥å·æä»¥ä¸ä¸ä¸ªå¼ï¼

- LEFT_BUTTONé¼ æ å·¦é®å·²éæ¾ã

- MIDDLE_BUTTONé¼ æ ä¸­é´é®å·²éæ¾ã

- RIGHT_BUTTONé¼ æ å³é®å·²éæ¾ã

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

*x*<br/>
éæ¾é¼ æ æé®æ¶åæ ç x åæ ã åæ ç¸å¯¹äºæ§å¶çªå£çå·¦ä¸è§ã

*Y*<br/>
éæ¾é¼ æ æé®æ¶åæ ç y åæ ã åæ ç¸å¯¹äºæ§å¶çªå£çå·¦ä¸è§ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ­¤äºä»¶å®ä¹ä¸ºèªå®ä¹äºä»¶ï¼åç¡®å®ä½æ¶è§¦åè¯¥äºä»¶ã

è¦èªå¨è§¦å MouseUp äºä»¶ï¼æ§ä»¶çäºä»¶æ å°å¿é¡»å®ä¹åºå­ MouseUp äºä»¶ã

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COle æ§å¶ï¼ï¼ç«å°±ç»ªç¶ææ´æ¹

ä½¿ç¨å°±ç»ªæ§å¶ç¶æçå½åå¼è§¦åäºä»¶ã

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>å¤æ³¨

å°±ç»ªç¶æå¯ä»¥æ¯ä»¥ä¸å¼ä¹ä¸ï¼

|||
|-|-|
|READYSTATE_UNINITIALIZED|é»è®¤åå§åç¶æ|
|READYSTATE_LOADING|æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§|
|READYSTATE_LOADED|æ§ä»¶å·²åå§å|
|READYSTATE_INTERACTIVE|æ§ä»¶æè¶³å¤çæ°æ®æ¯äº¤äºå¼çï¼ä½å¹¶éææå¼æ­¥æ°æ®é½å·²å è½½|
|READYSTATE_COMPLETE|æ§ä»¶å·ææææ°æ®|

ä½¿ç¨[GetReadyState](#getreadystate)ç¡®å®æ§ä»¶çå½åå°±ç»ªç¶æã

[åé¨éå°±ç»ªç¶æ](#internalsetreadystate)å°å°±ç»ªç¶ææ´æ¹ä¸ºæä¾çå¼ï¼ç¶åè°ç¨`FireReadyStateChange`ã

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControlï¼è·åæ¿æ´»ç­ç¥

æ´æ¹æ¯ææ¥å£çæ§ä»¶ç`IPointerInactive`é»è®¤æ¿æ´»è¡ä¸ºã

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>è¿åå¼

POINTERINACTIVE æä¸¾ä¸­çæ å¿çç»åã å¯è½çæ å¿åæ¬ï¼

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|å½é¼ æ å¨é¼ æ ç§»å¨æä½æé´è¿å¥å¯¹è±¡æ¶ï¼å¯¹è±¡åºå°±å°æ¿æ´»ã|
|POINTERINACTIVE_DEACTIVATEONLEAVE|å½é¼ æ å¨é¼ æ ç§»å¨æä½æé´ç¦»å¼å¯¹è±¡æ¶ï¼åºåç¨è¯¥å¯¹è±¡ã|
|POINTERINACTIVE_ACTIVATEONDRAG|å¨ææ¾æä½æé´ï¼å½é¼ æ æå¨å°å¯¹è±¡ä¸æ¶ï¼è¯¥å¯¹è±¡åºå°±å°æ¿æ´»ã|

### <a name="remarks"></a>å¤æ³¨

å¯ç¨`IPointerInactive`æ¥å£åï¼å®¹å¨å°å§æWM_SETCURSORå¹¶å°æ¶æ¯WM_MOUSEMOVEã `COleControl`æ­¤æ¥å£çå®ç°å°å¨éå½è°æ´é¼ æ åæ åéè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦è¿äºæ¶æ¯ã

æ¯å½å®¹å¨æ¶å°å¸¦æé¼ æ æéçWM_SETCURSORæWM_MOUSEMOVEæ¶æ¯ï¼è¯¥æ¶æ¯ä½äºæ¯æ`IPointerInactive`éæ´»å¨å¯¹è±¡ä¸æ¶ï¼å®åº`GetActivationPolicy`è°ç¨æ¥å£å¹¶ä» POINTERINACTIVE æä¸¾è¿åæ å¿ã

éè¿å°ç¸åºçæ¡ç®æ·»å å°æ¶æ¯æ å°ï¼å¯ä»¥åæ®éçªå£æ¶æ¯ä¸æ ·å¤çè¿äºæ¶æ¯ã å¨å¤çç¨åºä¸­ï¼é¿åä½¿ç¨`m_hWnd`æååéï¼æä½¿ç¨å®çä»»ä½æåå½æ°ï¼ï¼èä¸é¦åæ£æ¥å¶å¼æ¯å¦ä¸ºé NULLã

ä»»ä½æ¨å¨æ§è¡æ¯è®¾ç½®é¼ æ åæ å/æè§¦åé¼ æ ç§»å¨äºä»¶ï¼å¦æä¾ç¹æ®è§è§åé¦ï¼çç®æ é½åºè¿åPOINTERINACTIVE_ACTIVATEONENTRYæ å¿ï¼å¹¶ä¸ä»å¨æ¿æ´»æ¶ç»å¶åé¦ã å¦æå¯¹è±¡è¿åæ­¤æ å¿ï¼å®¹å¨åºç«å³å°±å°æ¿æ´»å®ï¼ç¶åè½¬åå®è§¦åè°ç¨`GetActivationPolicy`çç¸åæ¶æ¯ã

å¦æåæ¶è¿åPOINTERINACTIVE_ACTIVATEONENTRYæ å¿åPOINTERINACTIVE_DEACTIVATEONLEAVEæ å¿ï¼åä»å½é¼ æ ä½äºå¯¹è±¡ä¸æ¶æä¼æ¿æ´»è¯¥å¯¹è±¡ã å¦æåªè¿åPOINTERINACTIVE_ACTIVATEONENTRYæ å¿ï¼åä»å¨é¼ æ é¦æ¬¡è¿å¥å¯¹è±¡æ¶æ¿æ´»å¯¹è±¡ä¸æ¬¡ã

æ¨å¯è½è¿å¸æéæ´»å¨æ§ä»¶æä¸º OLE ææ¾æä½çç®æ ã è¿éè¦å¨ç¨æ·å°å¯¹è±¡æå¨å°æ§ä»¶æ¶æ¿æ´»æ§ä»¶ï¼ä»¥ä¾¿å¯ä»¥å°æ§ä»¶ççªå£æ³¨åä¸ºæ¾ç½®ç®æ ã è¦å¨æå¨è¿ç¨ä¸­å¯¼è´æ¿æ´»ï¼è¯·è¿åPOINTERINACTIVE_ACTIVATEONDRAGæ å¿ï¼

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

ç± æ¥`GetActivationPolicy`ä¼ éçä¿¡æ¯ä¸åºç±å®¹å¨ç¼å­ã ç¸åï¼æ¯æ¬¡é¼ æ è¿å¥éæ´»å¨å¯¹è±¡æ¶ï¼é½åºè°ç¨æ­¤æ¹æ³ã

å¦æéæ´»å¨å¯¹è±¡å¨é¼ æ è¿å¥æ¶æªè¯·æ±å°±å°æ¿æ´»ï¼ååªè¦é¼ æ æéåçå¨è¯¥å¯¹è±¡ä¸ï¼å¶å®¹å¨åºéè¿è°ç¨[OnInactiveSetCursor](#oninactivesetcursor)åæ­¤å¯¹è±¡åéåç»­WM_SETCURSORæ¶æ¯ã

å¯ç¨æ¥å£`IPointerInactive`éå¸¸æå³çæ¨å¸ææ§ä»¶è½å¤éæ¶å¤çé¼ æ æ¶æ¯ã è¦å¨ä¸æ¯æ`IPointerInactive`æ¥å£çå®¹å¨ä¸­è·åæ­¤è¡ä¸ºï¼éè¦å¨å¯è§æ¶å§ç»æ¿æ´»æ§ä»¶ï¼è¿æå³çæ§ä»¶å¨å¶æé¡¹æ å¿ä¸­åºå·æOLEMISC_ACTIVATEWHENVISIBLEæ å¿ã ä½æ¯ï¼ä¸ºäºé²æ­¢æ­¤æ å¿å¨æ¯æ`IPointerInactive`çå®¹å¨ä¸­çæï¼è¿å¯ä»¥æå®OLEMISC_IGNOREACTIVATEWHENVISIBLEæ å¿ï¼

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControlï¼è·åç¯å¢å±æ§

è·åå®¹å¨çç¯å¢å±æ§çå¼ã

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>åæ°

*å¾·è¿ªç®å¾·*<br/>
æéç¯å¢å±æ§çè°åº¦ IDã

*vtProp*<br/>
ä¸ç§åä½ç±»åæ è®°ï¼ç¨äºæå®è¦å¨*pvProp*ä¸­è¿åçå¼çç±»åã

*pvProp*<br/>
æåå°æ¥æ¶å±æ§å¼æè¿åå¼çåéå°åçæéã æ­¤æéçå®éç±»åå¿é¡»ä¸*vtProp*æå®çç±»åå¹éã

|vtProp|pvProp çç±»å|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>è¿åå¼

å¦æç¯å¢å±æ§åæ¯æï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å¦æç¨äº`GetAmbientProperty`æ£ç´¢ç¯å¢æ¾ç¤ºåç§°åç¼©æ¾åä½å±æ§ï¼åå°*vtProp*è®¾ç½®ä¸ºVT_BSTRï¼å¹¶å°*pvProp*è®¾ç½®ä¸º`CString*`ã å¦æè¦æ£ç´¢ç¯å¢å­ä½å±æ§ï¼åå°*vtProp*è®¾ç½®ä¸ºVT_FONTï¼å°*pvProp*è®¾ç½®ä¸º LPFONTDISP*ã

è¯·æ³¨æï¼å·²ç»ä¸ºå¸¸è§çç¯å¢å±æ§ï¼å¦[ç¯å¢è¿åé¢è²](#ambientbackcolor)åç¯å¢[å­ä½](#ambientfont)ï¼æä¾äºå½æ°ã

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControlï¼è·åå¤è§

å®ç°æ§ä»¶çåºå­å¤è§å±æ§ç Get å½æ°ã

```
short GetAppearance ();
```

### <a name="return-value"></a>è¿åå¼

è¿åå¼å°å½åå¤è§è®¾ç½®æå®ä¸º**ç­**ï¼VT_I2ï¼å¼ï¼å¦ææåï¼ã å¦ææ§ä»¶çå¤è§ä¸ºå¹³é¢ï¼åæ­¤å¼ä¸ºé¶;å¦ææ§ä»¶çå¤è§ä¸º 3Dï¼åæ­¤å¼ä¸º 1ã

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControlï¼è·ååå½é¢è²

å®ç°æ§ä»¶çåºå­ BackColor å±æ§çè·ååè½ã

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>è¿åå¼

è¿åå¼å°å½åèæ¯é¢è²æå®ä¸ºOLE_COLORå¼ï¼å¦ææåï¼ã æ­¤å¼å¯ä»¥è½¬æ¢ä¸ºä¸ è°ç¨`TranslateColor`ç COLORREF å¼ã

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COle æ§å¶ï¼è·åè¾¹æ¡æ ·å¼

å®ç°æ§ä»¶çåºå­ BorderStyle å±æ§çè·åå½æ°ã

```
short GetBorderStyle();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·ææ­£å¸¸è¾¹æ¡ï¼åä¸º 1;å¦ææ§ä»¶æ²¡æè¾¹æ¡ï¼åä¸º 0ã

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COle æ§å¶ï¼è·åæè·

ç¡®å®`COleControl`å¯¹è±¡æ¯å¦å·æé¼ æ æè·ã

```
CWnd* GetCapture();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·²æ¿æ´»ä¸æ çªå£ï¼åå¦ææ§ä»¶å½åå·æé¼ æ æè·ï¼ç±æ§ä»¶çå®¹å¨ç¡®å®ï¼ï¼åè¿å**è¯¥**æ§ä»¶;å¦ææ§ä»¶æ²¡ææè·ï¼åè¿å NULLã

å¦åï¼è¿åå·æ`CWnd`é¼ æ æè·çå¯¹è±¡ï¼ä¸`CWnd::GetCapture`ç¸åï¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨[SetCapture](#setcapture)æ¶ï¼æ¿æ´»çæ çªå£æ§ä»¶å°æ¥æ¶é¼ æ æè·ã

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COle æ§å¶ï¼è·åç±» ID

ç±æ¡æ¶è°ç¨ä»¥æ£ç´¢æ§ä»¶ç OLE ç±» IDã

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>åæ°

*pclsid*<br/>
æåç±» ID çä½ç½®ã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨ä¸æåï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

éå¸¸ç±[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)å®ç°ã

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COle æ§å¶ï¼è·åå®¢æ·ç«¯åç§»

æ£ç´¢æ§ä»¶ç©å½¢åºåçå·¦ä¸è§ä¸å¶å·¥ä½åºçå·¦ä¸è§ä¹é´çå·®å¼ã

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>åæ°

*pdxåç§»*<br/>
æå OLE æ§ä»¶å·¥ä½åºçæ°´å¹³åç§»ã

*pdyåç§»*<br/>
æå OLE æ§ä»¶å·¥ä½åºçåç´åç§»ã

### <a name="remarks"></a>å¤æ³¨

OLE æ§ä»¶çå®¹å¨åæä¸ä¸ªç©å½¢åºåã æ§ä»¶çå·¥ä½åºæ¯æ§å¶åºåï¼ä¸åæ¬è¾¹æ¡åæ»å¨æ¡ã æ£ç´¢çåç§»`GetClientOffset`éæ¯æ§ä»¶ç©å½¢åºåçå·¦ä¸è§ä¸å¶å·¥ä½åºçå·¦ä¸è§ä¹é´çå·®å¼ã å¦ææ§ä»¶å·ææ åè¾¹æ¡åæ»å¨æ¡ä»¥å¤çéå®¢æ·ç«¯åç´ ï¼è¯·è¦çæ­¤æåå½æ°ä»¥æå®åç§»éã

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControlï¼è·åå®¢æ·ç«¯

æ£ç´¢æ§ä»¶å·¥ä½åºçå¤§å°ã

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æååå«æ `RECT`çªå£æ§ä»¶å·¥ä½åºçç»´åº¦çç»æçæé;å³æ§ä»¶çå¤§å°åå»çªå£è¾¹æ¡ãæ¡æ¶ãæ»å¨æ¡ç­ã *lpRect*åæ°æç¤ºæ§ä»¶çå®¢æ·ç«¯ç©å½¢çå¤§å°ï¼èä¸æ¯å¶ä½ç½®ã

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControlï¼è·åå®¢æ·ç½ç«

æ¥è¯¢æåå¶å®¹å¨ä¸­å½åå®¢æ·ç«¯ç«ç¹çæéçå¯¹è±¡ã

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>è¿åå¼

æåæ§ä»¶çå½åå®¢æ·ç«¯ç«ç¹çå®¹å¨ä¸­çæéã

### <a name="remarks"></a>å¤æ³¨

è¿åçæéæå ç`IOleClientSite`å®ä¾ã ç±`IOleClientSite`å®¹å¨å®ç°çæ¥å£æ¯å¯¹è±¡å¯¹å¶ä¸ä¸æçè§å¾ï¼å®éå®å¨ææ¡£ä¸­çä½ç½®ï¼å¨ææ¡£ä¸­è·åå¶å­å¨ãç¨æ·çé¢åå¶ä»èµæºã

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COle æ§å¶ï¼è·åæ§å¶æ å¿

æ£ç´¢æ§ä»¶æ å¿è®¾ç½®ã

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶æ å¿æä¸¾ä¸­æ å¿ç ORed ç»åï¼

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸ï¼`GetControlFlags` è¿å `fastBeginPaint | clipPaintDC`ã

|||
|-|-|
|`fastBeginPaint`|å¦æè®¾ç½®ï¼åä½¿ç¨ä¸º OLE æ§ä»¶å®å¶çå¼å§ç»å¶å½æ°ï¼èä¸æ¯[BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) APIï¼é»è®¤æåµä¸è®¾ç½®ï¼ã|
|`clipPaintDC`|å¦ææªè®¾ç½®ï¼åç¦ç¨å¯¹`IntersectClipRect`ç`COleControl`è°ç¨ï¼å¹¶è·å¾è¾å°çéåº¦ä¼å¿ã å¦æä½¿ç¨æ çªå£æ¿æ´»ï¼åæ å¿ä¸èµ·ä½ç¨ã|
|`pointerInactive`|å¦æè®¾ç½®ï¼åéè¿å¯ç¨`COleControl`æ¥å£çå®ç°ï¼é»è®¤æåµä¸ç¦ç¨è¯¥`IPointerInactive`æ¥å£ï¼å¨æ§ä»¶å¤äºéæ´»å¨ç¶ææ¶æä¾é¼ æ äº¤äºã|
|`noFlickerActivate`|å¦æè®¾ç½®ï¼åæ¶é¤é¢å¤çç»å¾æä½åééçè§è§éªçã å½æ§ä»¶å¨éæ´»å¨ç¶æåæ´»å¨ç¶æä¸ç»å¶èªèº«æ¶ï¼è¯·ä½¿ç¨ã å¦æä½¿ç¨æ çªå£æ¿æ´»ï¼åæ å¿ä¸èµ·ä½ç¨ã|
|`windowlessActivate`|å¦æè®¾ç½®ï¼æç¤ºæ§ä»¶ä½¿ç¨æ çªå£æ¿æ´»ã|
|`canOptimizeDraw`|å¦æè®¾ç½®ï¼åæç¤ºå¦æå®¹å¨æ¯æè¯¥æ§ä»¶ï¼åæ§ä»¶å°æ§è¡ä¼åçç»å¾ã|

æå³ OLE`GetControlFlags`æ§ä»¶åå¶ä»ä¼åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COle æ§å¶ï¼è·åæ§å¶å¤§å°

æ£ç´¢ OLE æ§å¶çªå£çå¤§å°ã

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>åæ°

*pcx*<br/>
æå®æ§ä»¶çå®½åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

*æ®è¥¿*<br/>
æå®æ§ä»¶çé«åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ§ä»¶çªå£çææåæ é½ç¸å¯¹äºæ§ä»¶çå·¦ä¸è§ã

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COle æ§å¶ï¼GetDC

æä¾æ çªå£å¯¹è±¡ï¼ä»¥ä¾¿ä»å®¹å¨è·åå±å¹ï¼æå¼å®¹ï¼è®¾å¤ä¸ä¸æã

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>åæ°

*lprcRect*<br/>
æåæ çªå£æ§ä»¶è¦éç»çç©å½¢çæéï¼ä½äºæ§ä»¶çå®¢æ·ç«¯åæ ä¸­ã NULL è¡¨ç¤ºå®æ´å¯¹è±¡çèå´ã

dwFlags**<br/>
ç»å¶è®¾å¤ä¸ä¸æçå±æ§ã éé¡¹åæ¬ï¼

- OLEDC_NODRAW æç¤ºå¯¹è±¡ä¸ä¼ä½¿ç¨è®¾å¤ä¸ä¸ææ§è¡ä»»ä½å¾å½¢ï¼èåªæ¯è·åæå³æ¾ç¤ºè®¾å¤çä¿¡æ¯ã å®¹å¨åºç®åå°éè¿çªå£çDCï¼èæ éè¿ä¸æ­¥å¤çã

- OLEDC_PAINTBKGND è¯·æ±å®¹å¨å¨è¿å DC ä¹åç»å¶èæ¯ã å¦æå¯¹è±¡è¯·æ± DC éæ°ç»å¶å·æéæèæ¯çåºåï¼ååºä½¿ç¨æ­¤æ å¿ã

- OLEDC_OFFSCREEN éç¥å®¹å¨å¯¹è±¡å¸æåç°å°å±å¹å¤ä½å¾ä¸­ï¼ç¶ååºå¤å¶å°å±å¹ã å½è¦æ§è¡çç»å¾æä½çæå¤§ééªçæ¶ï¼å¯¹è±¡åºä½¿ç¨æ­¤æ å¿ã å®¹å¨å¯ä»¥èªç±å°éµå®æ­¤è¯·æ±ã ä½æ¯ï¼å¦ææªè®¾ç½®æ­¤æ å¿ï¼å®¹å¨å¿é¡»å°å±å¹ä¸ç DC äº¤åã è¿åè®¸å¯¹è±¡æ§è¡ç´æ¥å±å¹æä½ï¼ä¾å¦æ¾ç¤ºéæ©ï¼éè¿**XOR**æä½ï¼ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼æåå®¹å¨`CWnd`å·¥ä½åºçæ¾ç¤ºè®¾å¤ä¸ä¸æ;å¦åï¼è¿åå¼ä¸º NULLã æ¾ç¤ºè®¾å¤ä¸ä¸æå¯ç¨äºåç»­ GDI å½æ°ï¼ä»¥å¨å®¹å¨çªå£çå·¥ä½åºä¸­ç»å¶ã

### <a name="remarks"></a>å¤æ³¨

å¿é¡»è°ç¨[ReleaseDC](#releasedc)æåå½æ°æè½å¨ç»å¶åéæ¾ä¸ä¸æã è°ç¨`GetDC`æ¶ï¼å¯¹è±¡ä¼ éä»ä»¬å¸æå¨èªå·±çå®¢æ·ç«¯åæ ä¸­ç»å¶çç©å½¢ã `GetDC`å°è¿äºè½¬æ¢ä¸ºå®¹å¨å·¥ä½åºçåæ ã å¯¹è±¡ä¸åºè¯·æ±å¤§äºå¶èªèº«å·¥ä½åºç©å½¢çæéç»å¾ç©å½¢ï¼å¶å¤§å°å¯ä»¥ä½¿ç¨[GetClientRect](#getclientrect)æ£ç´¢ã è¿æ ·å¯ä»¥é²æ­¢å¯¹è±¡æ æä¸­ç»å¶ä¸åºç»å¶çä½ç½®ã

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COle æ§å¶ï¼å¯ç¨

å®ç°æ§ä»¶ç"å·²å¯ç¨"å±æ§çè·åå½æ°ã

```
BOOL GetEnabled();
```

### <a name="return-value"></a>è¿åå¼

å¦æå¯ç¨äºæ§ä»¶ï¼åéé¶;å¦å 0ã

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COle æ§å¶ï¼è·åæ©å±æ§å¶

è·åæåç±å®¹å¨ç»´æ¤çå¯¹è±¡çæéï¼è¯¥å¯¹è±¡è¡¨ç¤ºå·æä¸ç»æ©å±å±æ§çæ§ä»¶ã

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>è¿åå¼

æåå®¹å¨æ©å±æ§ä»¶å¯¹è±¡çæéã å¦ææ²¡æå¯ç¨çå¯¹è±¡ï¼åå¼ä¸º NULLã

æ­¤å¯¹è±¡å¯ä»¥éè¿å¶`IDispatch`æ¥å£è¿è¡æä½ã æ¨è¿å¯ä»¥ä½¿ç¨`QueryInterface`æ¥è·åå¯¹è±¡æä¾çå¶ä»å¯ç¨æ¥å£ã ä½æ¯ï¼ä¸æ¯æä¸ç»ç¹å®çæ¥å£ä¸éè¦è¯¥å¯¹è±¡ã è¯·æ³¨æï¼ä¾èµå®¹å¨æ©å±æ§å¶å¯¹è±¡çç¹å®åè½ä¼å°æ§ä»¶çå¯ç§»æ¤æ§éå¶ä¸ºå¶ä»ä»»æå®¹å¨ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°çå½æ°è´è´£å¨å®æå¯¹è±¡åéæ¾æéã è¯·æ³¨æï¼ä¸æ¯ææ­¤å¯¹è±¡ä¸éè¦è¯¥å®¹å¨ã

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControlï¼è·åç¦ç¹

ç¡®å®`COleControl`å¯¹è±¡æ¯å¦å·æç¦ç¹ã

```
CWnd* GetFocus();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·²æ¿æ´»ä¸æ çªå£ï¼åå¦ææ§ä»¶å½åå·æé®çç¦ç¹ï¼ç±æ§ä»¶çå®¹å¨ç¡®å®ï¼ï¼åè¿å**è¯¥**æ§ä»¶;å¦ææ§ä»¶æ²¡æç¦ç¹ï¼åè¿å NULLã

å¦åï¼è¿å`CWnd`å·æç¦ç¹çå¯¹è±¡ï¼ä¸`CWnd::GetFocus`ç¸åï¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨[SetFocus](#setfocus)æ¶ï¼æ¿æ´»çæ çªå£æ§ä»¶æ¥æ¶ç¦ç¹ã

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControlï¼è·åå­ä½

å®ç°è¡ç¥¨å­ä½å±æ§çè·åå½æ°ã

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>è¿åå¼

æåæ§ä»¶çåºå­å­ä½å±æ§çå­ä½è°åº¦çé¢çæéã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼è°ç¨æ¹å¨å®ææ¶å¿é¡»éæ¾å¯¹è±¡ã å¨æ§ä»¶çå®ç°ä¸­ï¼ä½¿ç¨`InternalGetFont`è®¿é®æ§ä»¶çåºå­å­ä½å¯¹è±¡ã æå³å¨æ§ä»¶ä¸­ä½¿ç¨å­ä½çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼å¨ ActiveX æ§ä»¶ä¸­ä½¿ç¨å­ä½](../../mfc/mfc-activex-controls-using-fonts.md)çæç« ã

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControlï¼è·åå­ä½ææ¬ææ 

æµéæ§ä»¶æ¥æçä»»ä½`CFontHolder`å¯¹è±¡çææ¬ææ ã

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>åæ°

*lptm*<br/>
æå[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)ç»æçæéã

*å­ä½ææäºº*<br/>
å¯¹[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡çå¼ç¨ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥ä½¿ç¨[COleControlï¼ï¼éæ©å­ä½å¯¹è±¡](#selectfontobject)åè½éæ©æ­¤ç±»å­ä½ã `GetFontTextMetrics`å°åå§å`TEXTMETRIC`*lptm*æåçç»æï¼å¹¶åå«æå³`fontHolder`"å­ä½"çææææ ä¿¡æ¯ï¼å¦ææåï¼;å¦ææåï¼åç¨é¶å¡«åç»æã å¨ç»å¶æ§ä»¶æ¶ï¼åºä½¿ç¨æ­¤å½æ°èä¸æ¯[GetTextMetricsï¼](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)å ä¸ºæ§ä»¶ï¼ä¸ä»»ä½åµå¥ç OLE å¯¹è±¡ï¼ä¸æ ·ï¼å¯è½éè¦å°èªå·±åç°ä¸ºåæä»¶ã

è°ç¨`TEXTMETRIC` [SelectFontObject](#selectfontobject)å½æ°æ¶ï¼å°å·æ°é»è®¤å­ä½çç»æã åªæå¨éæ©è¡ç¥¨`GetFontTextMetrics`å­ä½å±æ§åæè½è°ç¨ï¼ä»¥ç¡®ä¿å¶æä¾çä¿¡æ¯ææã

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControlï¼è·åç¦å½©

å®ç°è¡ç¥¨åé¢è²å±æ§çè·åå½æ°ã

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>è¿åå¼

è¿åå¼å°å½ååæ¯é¢è²æå®ä¸ºOLE_COLORå¼ï¼å¦ææåï¼ã æ­¤å¼å¯ä»¥è½¬æ¢ä¸ºä¸ è°ç¨`TranslateColor`ç[COLORREF](/windows/win32/gdi/colorref)å¼ã

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControlï¼GetHwnd

å®ç°è¡ç¥¨ hWnd å±æ§çè·åå½æ°ã

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>è¿åå¼

OLE æ§ä»¶ççªå£å¥æï¼å¦ææï¼;å¦å NULLã

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COle æ§å¶ï¼è·åæ¶æ¯å­ç¬¦ä¸²

ç±æ¡æ¶è°ç¨ä»¥è·åæè¿°*nID*æ è¯çèåé¡¹çç¨éçç­å­ç¬¦ä¸²ã

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>åæ°

*nID*<br/>
èåé¡¹ IDã

*rMessage*<br/>
å¯¹[CString](../../atl-mfc-shared/reference/cstringt-class.md)å¯¹è±¡çå¼ç¨ï¼éè¿è¯¥å¯¹è±¡å°è¿åå­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

è¿å¯ç¨äºè·åå¨çªåºæ¾ç¤ºèåé¡¹æ¶å¨ç¶ææ ä¸­æ¾ç¤ºçæ¶æ¯ã é»è®¤å®ç°å°è¯å è½½*ç± nID*æ è¯çå­ç¬¦ä¸²èµæºã

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COle æ§å¶ï¼ä¸åæ¯æ

é²æ­¢ç¨æ·è®¿é®æ§ä»¶çå±æ§å¼ã

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»¥ä»£æ¿ä¸æ¯ææ§ä»¶ç¨æ·æ£ç´¢è¯¥å±æ§çä»»ä½å±æ§ç Get å½æ°ã ä¾å¦ï¼ä»åå¥çå±æ§ã

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControlï¼åå¤ç¶æ

è¿åæ§ä»¶çå°±ç»ªç¶æã

```
long GetReadyState();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶çå°±ç»ªç¶æï¼ä»¥ä¸å¼ä¹ä¸ï¼

|||
|-|-|
|READYSTATE_UNINITIALIZED|é»è®¤åå§åç¶æ|
|READYSTATE_LOADING|æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§|
|READYSTATE_LOADED|æ§ä»¶å·²åå§å|
|READYSTATE_INTERACTIVE|æ§ä»¶æè¶³å¤çæ°æ®æ¯äº¤äºå¼çï¼ä½å¹¶éææå¼æ­¥æ°æ®é½å·²å è½½|
|READYSTATE_COMPLETE|æ§ä»¶å·ææææ°æ®|

### <a name="remarks"></a>å¤æ³¨

æç®åçæ§ä»¶ä¸éè¦åºå LOADED åäº¤äºå¼ã ä½æ¯ï¼å¨è³å°ä»¥å¼æ­¥æ¹å¼æ¥æ¶æäºæ°æ®ä¹åï¼æ¯ææ°æ®è·¯å¾å±æ§çæ§ä»¶å¯è½è¿æ²¡æåå¤å¥½è¿è¡äº¤äºå¼è®¿é®ã æ§ä»¶åºå°è¯å°½å¿«æä¸ºäº¤äºå¼æ§ä»¶ã

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COle æ§å¶ï¼è·å rectin å®¹å¨

è·åæ§ä»¶ç©å½¢ç¸å¯¹äºå®¹å¨çåæ ï¼ä»¥è®¾å¤åä½è¡¨ç¤ºã

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æåå°æ§ä»¶çåæ å¤å¶å°çç©å½¢ç»æçæéã

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å¤äºæ´»å¨ä½ç½®ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

ä»å½æ§ä»¶å¤äºæ´»å¨ä½ç½®æ¶ï¼ç©å½¢æææã

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControlï¼è·åè¡ç¥¨ææ¬ææ 

æµéæ§ä»¶çè¡ç¥¨å­ä½å±æ§çææ¬ææ ï¼å¯ä»¥ä½¿ç¨[SelectStockFont](#selectstockfont)å½æ°éæ©è¯¥åæ°ã

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>åæ°

*lptm*<br/>
æå[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)ç»æçæéã

### <a name="remarks"></a>å¤æ³¨

å¦æ`GetStockTextMetrics`æåï¼`TEXTMETRIC`è¯¥å½æ°å°åå§å*lptm*æåçç»æï¼å¹¶åå«ææçææ ä¿¡æ¯ï¼å¦ææåï¼åç¨é¶å¡«åç»æã å¨ç»å¶æ§ä»¶æ¶ï¼è¯·ä½¿ç¨æ­¤å½æ°èä¸æ¯[GetTextMetricsï¼](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)å ä¸ºæ§ä»¶ï¼ä¸ä»»ä½åµå¥ç OLE å¯¹è±¡ï¼ä¸æ ·ï¼å¯è½éè¦å°èªå·±åç°ä¸ºåæä»¶ã

è°ç¨`TEXTMETRIC``SelectStockFont`å½æ°æ¶å·æ°é»è®¤å­ä½çç»æã åªæå¨éæ©è¡ç¥¨å­ä½ä»¥ç¡®ä¿å®æä¾çä¿¡æ¯ææåï¼æè½è°ç¨æ­¤åè½ã

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControlï¼è·åææ¬

å®ç°åºå­ææ¬ææ é¢å±æ§çè·åå½æ°ã

```
BSTR GetText();
```

### <a name="return-value"></a>è¿åå¼

å¦æä¸å­å¨å­ç¬¦ä¸²ï¼åæ§ä»¶ææ¬å­ç¬¦ä¸²æé¶é¿åº¦å­ç¬¦ä¸²çå½åå¼ã

> [!NOTE]
> æå³ BSTR æ°æ®ç±»åçè¯¦ç»ä¿¡æ¯ï¼è¯·åéå®åå¨å±é¨åä¸­ç[æ°æ®ç±»å](../../mfc/reference/data-types-mfc.md)ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ­¤å½æ°çè°ç¨æ¹å¿é¡»è°ç¨`SysFreeString`è¿åçå­ç¬¦ä¸²æè½éæ¾èµæºã å¨æ§ä»¶çå®ç°ä¸­ï¼ç¨äº`InternalGetText`è®¿é®æ§ä»¶çåºå­ææ¬ææ é¢å±æ§ã

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COle æ§å¶ï¼è·åæ çªå£ä¸¢å¼ç®æ 

å½`GetWindowlessDropTarget`å¸ææ çªå£æ§ä»¶æä¸º OLE ææ¾æä½çç®æ æ¶ï¼è¯·è¿è¡è¦çã

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>è¿åå¼

æåå¯¹è±¡çæ¥å£ç`IDropTarget`æéã ç±äºå®æ²¡æçªå£ï¼æ çªå£å¯¹è±¡æ æ³æ³¨å`IDropTarget`æ¥å£ã ä½æ¯ï¼è¦åä¸ææ¾ï¼æ çªå£å¯¹è±¡ä»ç¶å¯ä»¥å®ç°æ¥å£å¹¶å°å¶è¿åã `GetWindowlessDropTarget`

### <a name="remarks"></a>å¤æ³¨

éå¸¸ï¼è¿éè¦å°è¯¥æ§ä»¶ççªå£æ³¨åä¸ºæ¾ç½®ç®æ ã ä½æ¯ï¼ç±äºæ§ä»¶æ²¡æèªå·±ççªå£ï¼å®¹å¨å°ä½¿ç¨èªå·±ççªå£ä½ä¸ºæ¾ç½®ç®æ ã è¯¥æ§ä»¶åªéè¦æä¾æ¥å£çå®ç°ï¼`IDropTarget`å®¹å¨å¯ä»¥å¨éå½çæ¶é´å§æ´¾è°ç¨ã ä¾å¦ï¼

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COle æ§å¶ï¼åå§å IID

éç¥æ§ä»¶å°ä½¿ç¨ç IID çåºç±»ã

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>åæ°

*ç®è¿ªå°å­¦*<br/>
æåæ§ä»¶ä¸»è°åº¦æ¥å£çæ¥å£ ID çæéã

*ç®è¿ªæ´»å¨*<br/>
æåæ§ä»¶äºä»¶æ¥å£çæ¥å£ ID çæéã

### <a name="remarks"></a>å¤æ³¨

å¨æ§ä»¶çæé å½æ°ä¸­è°ç¨æ­¤å½æ°ï¼ä»¥éç¥æ§ä»¶å°ä½¿ç¨çæ¥å£ I çåºç±»ã

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControlï¼åé¨è·åå­ä½

è®¿é®æ§ä»¶çåºå­å­ä½å±æ§

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>è¿åå¼

å¯¹åå«åºå­å­ä½å¯¹è±¡ç[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡çå¼ç¨ã

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControlï¼åé¨è·åææ¬

è®¿é®æ§ä»¶çåºå­ææ¬ææ é¢å±æ§ã

```
const CString& InternalGetText();
```

### <a name="return-value"></a>è¿åå¼

å¯¹æ§ä»¶ææ¬å­ç¬¦ä¸²çå¼ç¨ã

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControlï¼ï¼åé¨å°±ç»ªç¶æ

è®¾ç½®æ§ä»¶çå°±ç»ªç¶æã

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>åæ°

*l NewReadyState*<br/>
è¦ä¸ºæ§ä»¶è®¾ç½®çåå¤ç¶æï¼ä»¥ä¸å¼ä¹ä¸ï¼

|||
|-|-|
|READYSTATE_UNINITIALIZED|é»è®¤åå§åç¶æ|
|READYSTATE_LOADING|æ§ä»¶å½åæ­£å¨å è½½å¶å±æ§|
|READYSTATE_LOADED|æ§ä»¶å·²åå§å|
|READYSTATE_INTERACTIVE|æ§ä»¶æè¶³å¤çæ°æ®æ¯äº¤äºå¼çï¼ä½å¹¶éææå¼æ­¥æ°æ®é½å·²å è½½|
|READYSTATE_COMPLETE|æ§ä»¶å·ææææ°æ®|

### <a name="remarks"></a>å¤æ³¨

æç®åçæ§ä»¶ä¸éè¦åºå LOADED åäº¤äºå¼ã ä½æ¯ï¼å¨è³å°ä»¥å¼æ­¥æ¹å¼æ¥æ¶æäºæ°æ®ä¹åï¼æ¯ææ°æ®è·¯å¾å±æ§çæ§ä»¶å¯è½è¿æ²¡æåå¤å¥½è¿è¡äº¤äºå¼è®¿é®ã æ§ä»¶åºå°è¯å°½å¿«æä¸ºäº¤äºå¼æ§ä»¶ã

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COle æ§å¶ï¼æ ææ§å¶

å¼ºå¶æ§ä»¶éæ°ç»å¶èªèº«ã

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æåè¦å¤±æçæ§ä»¶åºåçæéã

*bErase*<br/>
æå®å¨å¤çæ´æ°åºåæ¶æ¯å¦æ¦é¤æ´æ°åºåä¸­çèæ¯ã

### <a name="remarks"></a>å¤æ³¨

å¦æ*lpRect*å·æ NULL å¼ï¼åå°éç»æ´ä¸ªæ§ä»¶ã å¦æ*lpRect*ä¸æ¯ NULLï¼åè¡¨ç¤ºæ§ä»¶ç©å½¢ä¸­è¦å¤±æçé¨åã å¦ææ§ä»¶æ²¡æçªå£æå½åæªå¤äºæ´»å¨ç¶æï¼åå¿½ç¥ç©å½¢ï¼å¹¶è°ç¨å®¢æ·ç«¯ç«ç¹ç[IAdviseSinkï¼ï¼OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)æåå½æ°ã ä½¿ç¨æ­¤å½æ°èä¸æ¯`CWnd::InvalidateRect`æ`InvalidateRect`ã

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControlï¼æ æ

ä½¿ç»å®åºååçå®¹å¨çªå£çå·¥ä½åºæ æã

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>åæ°

*pRgn*<br/>
æå[CRgn](../../mfc/reference/crgn-class.md)å¯¹è±¡çæéï¼ç¨äºæ è¯ OLE å¯¹è±¡çæ¾ç¤ºåºåä»¥å¨åå«çªå£çå®¢æ·ç«¯åæ ä¸­å¤±æã å¦ææ­¤åæ°ä¸º NULLï¼åèå´ä¸ºæ´ä¸ªå¯¹è±¡ã

*bErase*<br/>
æå®æ¯å¦è¦æ¦é¤æ æåºåä¸­çèæ¯ã å¦æä¸º TRUEï¼åèæ¯å°è¢«å é¤ã å¦æ FALSEï¼åèæ¯ä¿æä¸åã

### <a name="remarks"></a>å¤æ³¨

è¿å¯ç¨äºéç»å®¹å¨ä¸­çæ çªå£æ§ä»¶ã å¨åéä¸ä¸[WM_PAINT](/windows/win32/gdi/wm-paint)æ¶æ¯æ¶ï¼å°æ è®°æ æåºåä»¥åæ´æ°åºåä¸­çææå¶ä»åºåè¿è¡ç»å¶ã

å¦æ*bErase*å¯¹äºæ´æ°åºåçä»»ä½é¨åé½ä¸º TRUEï¼åæ´ä¸ªåºåï¼èä¸ä»ä»æ¯ç»å®é¨åï¼çèæ¯å°è¢«å é¤ã

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControlï¼æ­£å¨è½¬æ¢VBX

åè®¸ä¸é¨å è½½ OLE æ§ä»¶ã

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>è¿åå¼

å¦æè¦è½¬æ¢æ§ä»¶ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å°ä½¿ç¨ VBX æ§ä»¶ççªä½è½¬æ¢ä¸ºä½¿ç¨ OLE æ§ä»¶ççªä½æ¶ï¼å¯è½éè¦ OLE æ§ä»¶çç¹æ®å è½½ä»£ç ã ä¾å¦ï¼å¦æè¦å è½½ OLE æ§ä»¶çå®ä¾ï¼åå¯è½ä¼è°ç¨ ä¸­ç`DoPropExchange`[PX_Fontï¼](persistence-of-ole-controls.md#px_font)

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

ä½æ¯ï¼VBX æ§ä»¶æ²¡æ Font å¯¹è±¡ï¼å æ­¤ï¼è¯¥æ§ä»¶æ²¡æ"å­ä½"å¯¹è±¡ãæ¯ä¸ªå­ä½å±æ§é½åç¬ä¿å­ã å¨è¿ç§æåµä¸ï¼æ¨å°ä½¿ç¨`IsConvertingVBX`æ¥åºåè¿ä¸¤ç§æåµï¼

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

å¦ä¸ç§æåµæ¯ï¼å¦ææ¨ç VBX æ§ä»¶ä¿å­äºä¸æäºè¿å¶æ°æ®ï¼å¨å¶VBM_SAVEPROPERTYæ¶æ¯å¤çç¨åºä¸­ï¼ï¼å¹¶ä¸ OLE æ§ä»¶ä»¥ä¸åçæ ¼å¼ä¿å­å¶äºè¿å¶æ°æ®ã å¦æå¸æ OLE æ§ä»¶ä¸ VBX æ§ä»¶ååå¼å®¹ï¼åå¯ä»¥éè¿åºåæ¯å¦å è½½ VBX æ§ä»¶æ OLE`IsConvertingVBX`æ§ä»¶æ¥è¯»åä½¿ç¨å½æ°è¯»åæ°æ§æ ¼å¼ã

å¨æ§ä»¶çå½æ°ä¸­`DoPropExchange`ï¼å¯ä»¥æ£æ¥æ­¤æ¡ä»¶ï¼å¦æä¸º trueï¼åæ§è¡ç¹å®äºæ­¤è½¬æ¢çè´è½½ä»£ç ï¼å¦åé¢çç¤ºä¾ï¼ã å¦ææªè½¬æ¢æ§ä»¶ï¼åå¯ä»¥æ§è¡æ­£å¸¸çå è½½ä»£ç ã æ­¤åè½ä»éç¨äºä» VBX å¯¹åºæ§ä»¶è½¬æ¢çæ§ä»¶ã

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COle æ§å¶ï¼è¢«è°ç¨åè®¸

å¯ç¨èªå¨åæ¹æ³è°ç¨ã

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶å·²åå§åï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

æ¡æ¶çè°ç¨`IDispatch::Invoke``IsInvokeAllowed`çå®ç°ï¼ä»¥ç¡®å®æ¯å¦å¯ä»¥è°ç¨ç»å®å½æ°ï¼ç±`dispid`æ è¯ï¼ã OLE æ§ä»¶çé»è®¤è¡ä¸ºæ¯ä»å¨å·²åå§åè¯¥æ§ä»¶æ¶æåè®¸è°ç¨èªå¨åæ¹æ³;ä½æ¯ï¼`IsInvokeAllowed`å®æ¯ä¸ä¸ªèæå½æ°ï¼å¦æå¿è¦å¯è½ä¼éåï¼ä¾å¦ï¼å½æ§ä»¶ç¨ä½èªå¨åæå¡å¨æ¶ï¼ã

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COle æ§å¶ï¼å·²ä¿®æ¹

ç¡®å®æ§ä»¶çç¶ææ¯å¦å·²è¢«ä¿®æ¹ã

```
BOOL IsModified();
```

### <a name="return-value"></a>è¿åå¼

èªä¸æ¬¡ä¿å­æ§ä»¶ç¶æä»¥æ¥å·²ä¿®æ¹ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å½å±æ§æ´æ¹å¼æ¶ï¼å°ä¿®æ¹æ§ä»¶çç¶æã

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControlï¼ä¼åç»å¶

ç¡®å®å®¹å¨æ¯å¦æ¯æå½åç»å¾æä½çä¼åç»å¾ã

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>è¿åå¼

å¦æå®¹å¨æ¯æéå¯¹å½åç»å¾æä½ä¼åç»å¾ï¼åä¸º TRUE;å¦å FALSEã

### <a name="remarks"></a>å¤æ³¨

å¦ææ¯æä¼åçç»å¾ï¼åæ§ä»¶å¨ç»å¶å®æåä¸å¿å¨è®¾å¤ä¸ä¸æä¸­éæ©æ§å¯¹è±¡ï¼ç¬ãç»ç¬ãå­ä½ç­ï¼ã

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COle æ§å¶ï¼æ¯å­ç±»æ§å¶

ç±æ¡æ¶è°ç¨ä»¥ç¡®å®æ§ä»¶æ¯å¦å¯¹ Windows æ§ä»¶è¿è¡å­ç±»ã

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>è¿åå¼

å¦ææ§ä»¶è¢«å­ç±»åï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å¦æ OLE æ§ä»¶å­ç±»ä¸º Windows æ§ä»¶ï¼åå¿é¡»éåæ­¤å½æ°å¹¶è¿å TRUEã

## <a name="colecontrolload"></a><a name="load"></a>COle æ§å¶ï¼å è½½

ä»¥å¼æ­¥æ¹å¼éç½®ä»¥åå è½½çä»»ä½æ°æ®ï¼å¹¶å¯å¨æ§ä»¶çå¼æ­¥å±æ§çæ°å è½½ã

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>åæ°

*æ¯ç¹çº½è·¯å¾*<br/>
æåå¼ç¨å¼æ­¥æ§ä»¶å±æ§çç»å¯¹ä½ç½®çè·¯å¾çå­ç¬¦ä¸²çæéã

*æ¯æ±*<br/>
å®ç°å¼æ­¥æ§ä»¶å±æ§ç[CDataPath å±æ§](../../mfc/reference/cdatapathproperty-class.md)å¯¹è±¡ã

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COle æ§å¶ï¼éå®ä½ç½®æ´»å¨

é²æ­¢å®¹å¨åç¨æ§ä»¶ã

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>åæ°

*å*<br/>
å¦æè¦éå®æ§ä»¶çå°±å°æ´»å¨ç¶æï¼åä¸º TRUE;å¦æè¦è§£éï¼å FALSEã

### <a name="return-value"></a>è¿åå¼

å¦æéæåï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼æ¯æ¬¡æ§å¶éå®é½å¿é¡»ä¸å®ææ§ä»¶çè§£ééå¯¹ã åºä»å¨ç­æ¶é´åéå®æ§ä»¶ï¼ä¾å¦è§¦åäºä»¶æ¶ã

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControlï¼å³äºç¯å¢å±æ§æ´æ¹

å½å®¹å¨çç¯å¢å±æ§å·²æ´æ¹å¼æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>åæ°

*è±ä»ID*<br/>
å·²æ´æ¹çç¯å¢å±æ§çè°åº¦ IDï¼æèå¦æå¤ä¸ªå±æ§å·²æ´æ¹ï¼åDISPID_UNKNOWNã

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COle æ§å¶ï¼å¨å¤è§ä¸å·²æ´æ¹

å½è¡ç¥¨å¤è§å±æ§å¼å·²æ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>å¤æ³¨

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã é»è®¤å®ç°è°ç¨`InvalidateControl`ã

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COle æ§å¶ï¼onbackColor å·²æ´æ¹

å½è¡ç¥¨ BackColor å±æ§å¼å·²æ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>å¤æ³¨

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã é»è®¤å®ç°è°ç¨`InvalidateControl`ã

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COle æ§å¶ï¼å¨è¾¹æ¡æ ·å¼ä¸å·²æ´æ¹

å½è¡ç¥¨ BorderStyle å±æ§å¼å·²æ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨`InvalidateControl`ã

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControlï¼ç¹å»

å½åå»é¼ æ æé®æè°ç¨ DoClick åºå­æ¹æ³æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>åæ°

*iButton*<br/>
é¼ æ æé®çç´¢å¼ã å¯ä»¥æ¯ä¸åå¼ä¹ä¸ï¼

- LEFT_BUTTONåå»é¼ æ å·¦é®ã

- MIDDLE_BUTTONåå»é¼ æ ä¸­é´é®ã

- RIGHT_BUTTONåå»äºé¼ æ å³é®ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨`COleControl::FireClick`ã

éåæ­¤æåå½æ°ä»¥ä¿®æ¹ææ©å±é»è®¤å¤çã

## <a name="colecontrolonclose"></a><a name="onclose"></a>COle æ§å¶ï¼å³é­

å½å®¹å¨è°ç¨æ§ä»¶ç`IOleControl::Close`å½æ°æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>åæ°

*dwSaveOption*<br/>
æç¤ºæ¯å¦åºå¨å è½½ä¹åä¿å­å¯¹è±¡çæ å¿ã ææå¼æ¯ï¼

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸ï¼`OnClose`å¦ææ§ä»¶å¯¹è±¡å·²è¢«ä¿®æ¹ï¼*å¹¶ä¸ dwSaveOption* OLECLOSE_SAVEIFDIRTYæOLECLOSE_PROMPTSAVEï¼åä¿å­è¯¥æ§ä»¶å¯¹è±¡ã

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControlï¼OnDoVerb

å½å®¹å¨è°ç¨`IOleObject::DoVerb`æåå½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*iVerb*<br/>
è¦è°ç¨çæ§ä»¶è°è¯çç´¢å¼ã

*lpMsg*<br/>
æåå¯¼è´è°ç¨è°è¯ç Windows æ¶æ¯çæéã

*hWnd ç¶æ¯*<br/>
æ§ä»¶ç¶çªå£çå¥æã å¦æå¨è¯çæ§è¡åå»ºäºä¸ä¸ªçªå£ï¼æçªå£ï¼ï¼ååºå°*hWndParent*ç¨ä½ç¶é¡¹ã

*lpRect*<br/>
æå RECT ç»æçæéï¼å°æ§ä»¶çåæ ï¼ç¸å¯¹äºå®¹å¨ï¼å¤å¶å°è¯¥ç»æä¸­ã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åä¸ºéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä½¿ç¨ON_OLEVERBåON_STDOLEVERBæ¶æ¯æ å°æ¡ç®æ¥ç¡®å®è¦è°ç¨çæ­£ç¡®å½æ°ã

éåæ­¤å½æ°ä»¥æ´æ¹å¨è¯çé»è®¤å¤çã

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControlï¼å¨ç»ä¸

ç±æ¡æ¶è°ç¨ï¼ä½¿ç¨æå®çè®¾å¤ä¸ä¸æå¨æå®çè¾¹çç©å½¢ä¸­ç»å¶ OLE æ§ä»¶ã

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
åçç»å¾çè®¾å¤ä¸ä¸æã

*rcBunds*<br/>
æ§ä»¶çç©å½¢åºåï¼åæ¬è¾¹æ¡ã

*rc æ æ*<br/>
æ§ä»¶æ æçç©å½¢åºåã

### <a name="remarks"></a>å¤æ³¨

`OnDraw`éå¸¸è¦æ±å±å¹æ¾ç¤ºï¼ä¼ éå±å¹è®¾å¤ä¸ä¸æä¸º*pDCã* *rcBounds*åæ°æ è¯ç®æ è®¾å¤ä¸ä¸æä¸­çç©å½¢ï¼ç¸å¯¹äºå¶å½åæ å°æ¨¡å¼ï¼ã *rcInvalid*åæ°æ¯æ æçå®éç©å½¢ã å¨æäºæåµä¸ï¼è¿å°æ¯ä¸ä¸ªæ¯*rcBounds*æ´å°çåºåã

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControlï¼å¨ç»åæä»¶

ç±æ¡æ¶è°ç¨ï¼ä½¿ç¨æå®çåæä»¶è®¾å¤ä¸ä¸æå¨æå®çè¾¹çç©å½¢ä¸­ç»å¶ OLE æ§ä»¶ã

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
åçç»å¾çè®¾å¤ä¸ä¸æã

*rcBunds*<br/>
æ§ä»¶çç©å½¢åºåï¼åæ¬è¾¹æ¡ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨[OnDraw](#ondraw)å½æ°ã

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControlï¼ï¼ç¼è¾

ä½¿æ§ä»¶è¢«æ¿æ´»ã

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpMsg*<br/>
æåè°ç¨è°è¯ç Windows æ¶æ¯çæéã

*hWnd ç¶æ¯*<br/>
æ§ä»¶çç¶çªå£çå¥æã

*lpRect*<br/>
æåå®¹å¨ä¸­æ§ä»¶ä½¿ç¨çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

è¿ä¸è°ç¨æ§ä»¶çOLEIVERB_UIACTIVATEè°è¯çææç¸åã

æ­¤å½æ°éå¸¸ç¨ä½ON_OLEVERBæ¶æ¯æ å°æ¡ç®çå¤çç¨åºå½æ°ã è¿ä½¿æ§ä»¶ç"å¯¹è±¡"èåä¸æ"ç¼è¾"è°è¯å¯ç¨ã ä¾å¦ï¼

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COle æ§å¶ï¼å¯ç¨

å½è¡ç¥¨å¯ç¨å±æ§å¼å·²æ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>å¤æ³¨

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã é»è®¤å®ç°è°ç¨[æ ææ§å¶](#invalidatecontrol)ã

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControlï¼onEnumVerbs

å½å®¹å¨è°ç¨`IOleObject::EnumVerbs`æåå½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>åæ°

*ä½©çº³å§å¥¥åVerb*<br/>
æåæä¸¾æ§ä»¶`IEnumOLEVERB`è°è¯çå¯¹è±¡çæéã

### <a name="return-value"></a>è¿åå¼

å¦æå¨è¯å¯ç¨ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æä¸¾æ¶æ¯æ å°ä¸­ON_OLEVERBé¡¹ã

éåæ­¤å½æ°ä»¥æ´æ¹æä¸¾è°è¯çé»è®¤æ¹å¼ã

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControlï¼å¨äºä»¶å»ºè®®

å½äºä»¶å¤çç¨åºè¿æ¥å° OLE æ§ä»¶æä¸ OLE æ§ä»¶æ­å¼è¿æ¥æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>åæ°

*b å»ºè®®*<br/>
TRUE è¡¨ç¤ºäºä»¶å¤çç¨åºå·²è¿æ¥å°æ§ä»¶ã FALSE è¡¨ç¤ºäºä»¶å¤çç¨åºå·²æ­å¼ä¸æ§ä»¶çè¿æ¥ã

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControlï¼ï¼æ¾å¤§ç¼©å°å­ä½åè½ æ¾å¤§ç¼©å°å­ä½åè½

å½è¡ç¥¨å­ä½å±æ§å¼å·²æ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨`COleControl::InvalidateControl`ã å¦ææ§ä»¶æ­£å¨å¯¹ Windows æ§ä»¶è¿è¡å­ç±»åï¼åé»è®¤å®ç°è¿ä¼åæ§ä»¶ççªå£åéWM_SETFONTæ¶æ¯ã

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControlï¼OnforeColor å·²æ´æ¹

å½è¡ç¥¨ ForeColor å±æ§å¼å·²æ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨`InvalidateControl`ã

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControlï¼å¨å»ç»äºä»¶

å¨å®¹å¨è°ç¨ åç±æ¡æ¶è°ç¨`IOleControl::FreezeEvents`ã

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>åæ°

*bFreeze*<br/>
å¦ææ§ä»¶çäºä»¶å¤çè¢«å»ç»ï¼åä¸º TRUE;å¦å FALSEã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã

å¦æè¦å¨å»ç»æè§£å»äºä»¶å¤çæ¶æ§è¡å¶ä»è¡ä¸ºï¼åéåæ­¤å½æ°ã

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControlï¼onGetColorSet

å½å®¹å¨è°ç¨`IViewObject::GetColorSet`æåå½æ°æ¶ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>åæ°

*ptd*<br/>
æååºä¸ºå¶åç°å¾ççç®æ è®¾å¤ã å¦ææ­¤å¼ä¸º NULLï¼ååºä¸ºé»è®¤ç®æ è®¾å¤ï¼éå¸¸æ¯æ¾ç¤ºè®¾å¤ï¼åç°å¾çã

*å¸å¡åç¹å¾·å¤«*<br/>
æå®*ptd*æç¤ºçç®æ è®¾å¤ä¸çä¿¡æ¯ä¸ä¸æã æ­¤åæ°å¯ä»¥æ¯è®¾å¤ä¸ä¸æï¼ä½ä¸ä¸å®æ¯è®¾å¤ä¸ä¸æã å¦æ*ptd*ä¸º NULLï¼*å hicTargetDev*ä¹åºä¸º NULLã

*ppColorSet*<br/>
æååºä½¿ç¨é¢è²éçä½ç½®çæéã å¦æå½æ°ä¸è¿åé¢è²éï¼åè¿å NULLã

### <a name="return-value"></a>è¿åå¼

å¦æè¿åææé¢è²éï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å®¹å¨è°ç¨æ­¤å½æ°ä»¥è·åç»å¶ OLE æ§ä»¶æéçææé¢è²ã å®¹å¨å¯ä»¥ä½¿ç¨ä¸è®¾ç½®æ´ä½è°è²æ¿æéçé¢è²ä¸èµ·è·åçé¢è²éã é»è®¤å®ç°è¿å FALSEã

éåæ­¤å½æ°ä»¥æ§è¡æ­¤è¯·æ±çä»»ä½ç¹æ®å¤çã

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControlï¼OnGetControlInfo

å½æ§ä»¶çå®¹å¨è¯·æ±æå³æ§ä»¶çä¿¡æ¯æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>åæ°

*pControlInfo*<br/>
æåè¦å¡«å[ç CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo)ç»æçæéã

### <a name="remarks"></a>å¤æ³¨

æ­¤ä¿¡æ¯ä¸»è¦åæ¬æ§ä»¶çå©è®°ç¬¦é®çè¯´æã é»è®¤å®ç°ä½¿ç¨é»è®¤ä¿¡æ¯å¡«å*pControlInfoã*

å¦ææ§ä»¶éè¦å¤çå©è®°ç¬¦é®ï¼è¯·è¦çæ­¤å½æ°ã

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COle æ§å¶ï¼ï¼å¨GetDisplayStringä¸

ç±æ¡æ¶è°ç¨ä»¥è·åè¡¨ç¤ºç±*dispid*æ è¯çå±æ§çå½åå¼çå­ç¬¦ä¸²ã

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*strValue*<br/>
å¯¹[CString](../../atl-mfc-shared/reference/cstringt-class.md)å¯¹è±¡çå¼ç¨ï¼éè¿è¯¥å¯¹è±¡å°è¿åå­ç¬¦ä¸²ã

### <a name="return-value"></a>è¿åå¼

å¦æå­ç¬¦ä¸²å¨*strValue*ä¸­è¿åï¼åéé¶;å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å·æå¶å¼ä¸è½ç´æ¥è½¬æ¢ä¸ºå­ç¬¦ä¸²çå±æ§ï¼å¹¶ä¸å¸æè¯¥å±æ§çå¼æ¾ç¤ºå¨å®¹å¨æä¾çå±æ§æµè§å¨ä¸­ï¼è¯·è¦çæ­¤å½æ°ã

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControlï¼ongetinplacemenu

å½æ§ä»¶è¢« UI æ¿æ´»ä»¥è·åè¦åå¹¶å°å®¹å¨çç°æèåä¸­çèåæ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>è¿åå¼

æ§ä»¶èåçå¥æï¼å¦ææ§ä»¶æ²¡æï¼åä¸º NULLã é»è®¤å®ç°è¿å NULLã

### <a name="remarks"></a>å¤æ³¨

æå³åå¹¶ OLE èµæºçè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« ["èååèµæº "ï¼OLEï¼](../../mfc/menus-and-resources-ole.md)"ã

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControlï¼OnGetèªç¶èå´

æ¡æ¶ååºå®¹å¨`IViewObjectEx::GetNaturalExtent`è¯·æ±è°ç¨ã

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æå®è¦å¦ä½è¡¨ç¤ºè¯¥å¯¹è±¡ã è¡¨ç¤ºå½¢å¼åæ¬åå®¹ãå¾æ ãç¼©ç¥å¾ææå°ææ¡£ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*å©ç´¢å¼*<br/>
æå´è¶£çå¯¹è±¡çé¨åã ç®ååªæ -1 ææã

*ptd*<br/>
æåå®ä¹åºä¸ºå¶è¿åå¯¹è±¡å¤§å°çç®æ è®¾å¤ç[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)ç»æã

*å¸å¡åç¹å¾·å¤«*<br/>
æå®*ç± ptd*åæ°æç¤ºçç®æ è®¾å¤çä¿¡æ¯ä¸ä¸æï¼å¯¹è±¡å¯ä»¥ä»ä¸­æåè®¾å¤ææ å¹¶æµè¯è®¾å¤çåè½ã å¦æ*ptd*ä¸º NULLï¼åå¯¹è±¡åºå¿½ç¥*hicTargetDev*åæ°ä¸­çå¼ã

*p èå´ä¿¡æ¯*<br/>
æå`DVEXTENTINFO`æå®å¤§å°è°æ´çæ°æ®çç»æã ç»æ`DVEXTENTINFO`ä¸ºï¼

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

ç»ææå`dwExtentMode`å¯ä»¥éç¨ä¸¤ä¸ªå¼ä¹ä¸ï¼

- DVEXTENT_CONTENTæ¥è¯¢æ§ä»¶åºæå¤å¤§ä»¥å®å¨éååå®¹ï¼å¯¹é½å¤§å°ï¼

- DVEXTENT_INTEGRALè°æ´å¤§å°æ¶ï¼å°å»ºè®®çå¤§å°ä¼ éç»æ§ä»¶

*æ®è¥¿æ¯å°*<br/>
ç¹ä»¥è°æ´æ§ä»¶è¿åçæ°æ®å¤§å°ã å¯¹äºä»»ä½æªè°æ´çç»´åº¦ï¼è¿åçå°ºå¯¸è°æ´æ°æ®è®¾ç½®ä¸º -1ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åæè°æ´å¤§å°ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

éåæ­¤å½æ°ä»¥è¿åå¯¹è±¡çæ¾ç¤ºå¤§å°ï¼ææ¥è¿`DVEXTENTINFO`ç»æä¸­å»ºè®®çå¤§å°åèå´æ¨¡å¼ã é»è®¤å®ç°è¿å FALSEï¼ä¸è°æ´å¤§å°ã

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COle æ§å¶ï¼ï¼æå¼é¢å®ä¹å­ç¬¦ä¸²

ç±æ¡æ¶è°ç¨ä»¥è·åä¸ç»é¢å®ä¹å­ç¬¦ä¸²ï¼è¡¨ç¤ºå±æ§çå¯è½å¼ã

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*pStringarray*<br/>
è¦ç¨è¿åå¼å¡«åçå­ç¬¦ä¸²æ°ç»ã

*pCookiearray*<br/>
è¦ç¨è¿åå¼å¡«åç DWORD æ°ç»ã

### <a name="return-value"></a>è¿åå¼

å¦æåç´ å·²æ·»å å°*pStringarray*å*pCookiearray*ï¼åéé¶ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å·æä¸ç»å¯ä»¥ç±å­ç¬¦ä¸²è¡¨ç¤ºçå¯è½å¼çå±æ§ï¼è¯·è¦çæ­¤å½æ°ã å¯¹äºæ·»å å°*pStringArray*çæ¯ä¸ªåç´ ï¼åºå*pCookiearray*æ·»å ç¸åºç"cookie"åç´ ã è¿äº"cookie"å¼ç¨åå¯è½ä¼ç±æ¡æ¶ä¼ éç»å½æ°`COleControl::OnGetPredefinedValue`ã

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COle æ§å¶ï¼ï¼è·åé¢å®ä¹å¼

ç± æ¡æ¶è°ç¨ä»¥è·åä¸ä»¥åç± éåè¿åçé¢å®ä¹å­ç¬¦ä¸²ä¹ä¸å¯¹åºçå¼`COleControl::OnGetPredefinedStrings`ã

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*dwCookie*<br/>
ä»¥åç± éåè¿åç`COleControl::OnGetPredefinedStrings`Cookie å¼ã

*lpvarOut*<br/>
æåå°è¿å`VARIANT`å±æ§å¼çç»æçæéã

### <a name="return-value"></a>è¿åå¼

å¦æä»¥*lpvarOut*ä¸­è¿åå¼ï¼åéé¶ãå¦å 0ã

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControlï¼OngetView èå´

ç±æ¡æ¶è°ç¨ä»¥ååºå®¹å¨ç[IViewObject2ï¼ï¼ï¼get èå´](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)è¯·æ±ã

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>åæ°

*dwDrawAspect*<br/>
DWORD æè¿°è¦æ¾ç¤ºå¯¹è±¡ççªä½ææ¹é¢ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*å©ç´¢å¼*<br/>
æå´è¶£çå¯¹è±¡çé¨åã ç®ååªæ -1 ææã

*ptd*<br/>
æåå®ä¹åºä¸ºå¶è¿åå¯¹è±¡å¤§å°çç®æ è®¾å¤ç[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)ç»æã

*lpsizel*<br/>
æåè¿åå¯¹è±¡å¤§å°çä½ç½®ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åèå´ä¿¡æ¯ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶ä½¿ç¨åééç»å¾ï¼å¹¶ä¸å¶ä¸éæåéæé¶ä»¶å·æä¸åçå°ºå¯¸ï¼åè¦çæ­¤å½æ°ã

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControlï¼OngetViewrect

æ¡æ¶ååºå®¹å¨`IViewObjectEx::GetRect`è¯·æ±è°ç¨ã

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
DWORD æè¿°è¦æ¾ç¤ºå¯¹è±¡ççªä½ææ¹é¢ã ææå¼åèªæä¸¾[DVASPECT æ](/windows/win32/api/wtypes/ne-wtypes-dvaspect)DVASPECT2ï¼

- DVASPECT_CONTENTæ´ä¸ªå¯¹è±¡çè¾¹çç©å½¢ã å¯¹è±¡åç¹åå¤§å°å¤çå·¦ä¸è§ç­äº è¿åçèå´`GetViewExtent`*ã*

- DVASPECT_OPAQUEå·æç©å½¢ä¸éæåºåçå¯¹è±¡è¿åè¯¥ç©å½¢ã å¶ä»äººå¤±è´¥äºã

- DVASPECT_TRANSPARENTç©å½¢ï¼è¦çææéææä¸è§åé¶ä»¶ã

*æ®é·å*<br/>
æåæå®å¨å¶ä¸­ç»å¶å¯¹è±¡çç©å½¢ç[RECTL](/windows/win32/api/windef/ns-windef-rectl)ç»æã æ­¤åæ°æ§å¶å¯¹è±¡çå®ä½åæä¼¸ã

### <a name="return-value"></a>è¿åå¼

å¦ææåè¿åå°å¯¹è±¡çç©å½¢å¤§å°ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å¯¹è±¡çå¤§å°ç±`OnGetViewRect`ä»ç¹å®ä½ç½®å¼å§çç©å½¢è½¬æ¢ä¸ºç©å½¢ï¼é»è®¤å¼ä¸ºæ¾ç¤ºçå·¦ä¸è§ï¼ã å¦ææ§ä»¶ä½¿ç¨åééç»å¾ï¼å¹¶ä¸å¶ä¸éæåéæé¶ä»¶å·æä¸åçå°ºå¯¸ï¼åè¦çæ­¤å½æ°ã

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControlï¼Ongetæ¥çç¶æ

æ¡æ¶ååºå®¹å¨`IViewObjectEx::GetViewStatus`è¯·æ±è°ç¨ã

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åè§å¾ç¶ææä¸¾çå¼ä¹ä¸;å¦å 0ã å¯è½çå¼æ¯ä»¥ä¸ä»»æç»åï¼

|||
|-|-|
|VIEWSTATUS_OPAQUE|å¯¹è±¡æ¯å®å¨ä¸éæçã å¦ææªè®¾ç½®æ­¤ä½ï¼åå¯¹è±¡åå«éæé¨åã æ­¤ä½ä»éç¨äºä¸åå®¹ç¸å³çæ¹é¢ï¼ä¸éç¨äºDVASPECT_ICONæDVASPECT_DOCPRINTã|
|VIEWSTATUS_SOLIDBKGND|å¯¹è±¡å·æçº¯èæ¯ï¼ä»¥çº¯è²èä¸æ¯ç»ç¬å¾æ¡ç»æï¼ã ä»å½è®¾ç½®VIEWSTATUS_OPAQUEä¸ä»éç¨äºåå®¹ç¸å³æ¹é¢ï¼èä¸æ¯åºç¨äºDVASPECT_ICONæDVASPECT_DOCPRINTæ¶ï¼æ­¤ä½æææä¹ã|
|VIEWSTATUS_DVASPECTOPAQUE|å¯¹è±¡æ¯æDVASPECT_OPAQUEã ä½¿ç¨æ­¤æ¹é¢å¯ä»¥è°ç¨ææä»¥ç»å¾æ¹é¢ä½ä¸ºåæ°ç IViewObjectEx æ¹æ³ã|
|VIEWSTATUS_DVASPECTTRANSPARENT|å¯¹è±¡æ¯æDVASPECT_TRANSPARENTã å¯ä»¥`IViewObjectEx`ä½¿ç¨æ­¤æ¹é¢è°ç¨ææä»¥ç»å¾æ¹é¢ä¸ºåæ°çæ¹æ³ã|

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶ä½¿ç¨åééç»å¾ï¼è¯·è¦çæ­¤å½æ°ã é»è®¤å®ç°è¿åVIEWSTATUS_OPAQUEã

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COle æ§å¶ï¼å¨éèå·¥å·æ ä¸

å½æ§ä»¶è¢« UI åç¨æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>å¤æ³¨

å®ç°åºéè æ¾ç¤º`OnShowToolbars`çææå·¥å·æ ã

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COle æ§å¶ï¼å¨æ´»å¨é¼ æ ç§»å¨

æ¶å°WM_MOUSEMOVEæ¶æ¯æ¶ï¼å®¹å¨ä¸ºé¼ æ æéä¸çéæ´»å¨å¯¹è±¡è°ç¨ã

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
åå«çªå£çå®¢æ·ç«¯åæ ä¸­çå¯¹è±¡è¾¹çç©å½¢ã æ¶å°WM_MOUSEMOVEæ¶æ¯æ¶ï¼åè¯å¯¹è±¡å¶å¨å±å¹ä¸çç¡®åä½ç½®åå¤§å°ã

*x*<br/>
åå«çªå£çå®¢æ·ç«¯åæ ä¸­çé¼ æ ä½ç½®ç x åæ ã

*Y*<br/>
åå«çªå£çå®¢æ·ç«¯åæ ä¸­çé¼ æ ä½ç½®ç y åæ ã

*å¾·åºå·*<br/>
æ è¯é®çä¸é®çä¿®æ¹å¨é®çå½åç¶æã ææå¼å¯ä»¥æ¯ä»»ä½æ å¿MK_CONTROLãMK_SHIFTãMK_ALTãMK_BUTTONãMK_LBUTTONãMK_MBUTTONåMK_RBUTTONçç»åã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼çªå£å®¢æ·ç«¯åæ ï¼åç´ ï¼ç¨äºä¼ éé¼ æ åæ ä½ç½®ã è¿å¯ä»¥éè¿å¨åä¸åæ ç³»ä¸­ä¼ éå¯¹è±¡çè¾¹çç©å½¢æ¥å®ç°ã

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COle æ§å¶ï¼oninactiveSetCursor

æ¶å°WM_SETCURSORæ¶æ¯æ¶ï¼å®¹å¨å¨é¼ æ æéä¸ä¸ºéæ´»å¨å¯¹è±¡è°ç¨ã

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
åå«çªå£çå®¢æ·ç«¯åæ ä¸­çå¯¹è±¡è¾¹çç©å½¢ã æ¶å°WM_SETCURSORæ¶æ¯æ¶ï¼åè¯å¯¹è±¡å¶å¨å±å¹ä¸çç¡®åä½ç½®åå¤§å°ã

*x*<br/>
åå«çªå£çå®¢æ·ç«¯åæ ä¸­çé¼ æ ä½ç½®ç x åæ ã

*Y*<br/>
åå«çªå£çå®¢æ·ç«¯åæ ä¸­çé¼ æ ä½ç½®ç y åæ ã

*dwMouseMsg*<br/>
åçWM_SETCURSORçé¼ æ æ¶æ¯çæ è¯ç¬¦ã

*bSetAlways*<br/>
æå®å¯¹è±¡æ¯å¦å¿é¡»è®¾ç½®æ¸¸æ ã å¦æä¸º TRUEï¼åå¯¹è±¡å¿é¡»è®¾ç½®æ¸¸æ ;å¦æä¸º TRUEï¼åå¯¹è±¡å¿é¡»è®¾ç½®åæ ãå¦æ FALSEï¼æ¸¸æ æ²¡æä¹å¡è®¾ç½®æ¸¸æ ï¼å¨è¿ç§æåµä¸åºè¿åS_FALSEã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼çªå£å®¢æ·ç«¯åæ ï¼åç´ ï¼ç¨äºä¼ éé¼ æ åæ ä½ç½®ã è¿å¯ä»¥éè¿å¨åä¸åæ ç³»ä¸­ä¼ éå¯¹è±¡çè¾¹çç©å½¢æ¥å®ç°ã

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControlï¼å¨é®ä¸äºä»¶

å¤çè¡ç¥¨å¯é¥ä¸äºä»¶åç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>åæ°

*næ¥å°*<br/>
æä¸å¯é¥çèæå¯é¥ä»£ç å¼ã æå³æ åèæå¯é¥ä»£ç çåè¡¨ï¼è¯·åé Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶éè¦å¨è§¦åäºä»¶åè®¿é®å¯é¥ä¿¡æ¯ï¼è¯·è¦çæ­¤å½æ°ã

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControlï¼ï¼å¨KeyPressäºä»¶

å¨è¡ç¥¨ KeyPress äºä»¶å·²è§¦ååï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>åæ°

*næ¥å°*<br/>
åå«æä¸çå¯é¥çèæå¯é¥ä»£ç å¼ã æå³æ åèæå¯é¥ä»£ç çåè¡¨ï¼è¯·åé Winuser.h

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼å®¹å¨å¯è½å·²ä¿®æ¹*nChar*å¼ã

å¦æè¦å¨æ­¤äºä»¶åçåååºéç¥ï¼è¯·è¦çæ­¤å½æ°ã

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControlï¼å¨KeyUpeventä¸

å¤çè¡ç¥¨å¯é¥ä¸äºä»¶åç±æ¡æ¶è°ç¨ã

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>åæ°

*næ¥å°*<br/>
æä¸å¯é¥çèæå¯é¥ä»£ç å¼ã æå³æ åèæå¯é¥ä»£ç çåè¡¨ï¼è¯·åé Winuser.h

*nShiftState*<br/>
åå«ä»¥ä¸æ å¿çç»åï¼

- SHIFT_MASKå¨æä½è¿ç¨ä¸­æä¸ SHIFT é®ã

- CTRL_MASKå¨æä½æé´æä¸äº CTRL é®ã

- ALT_MASKå¨æä½è¿ç¨ä¸­æä¸ ALT é®ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶éè¦å¨è§¦åäºä»¶åè®¿é®å¯é¥ä¿¡æ¯ï¼è¯·è¦çæ­¤å½æ°ã

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControlï¼å¨å°å¾å±æ§é¡µ

ç±æ¡æ¶è°ç¨ä»¥è·åå®ç°ç¼è¾æå®å±æ§çå±æ§é¡µçç±» IDã

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>åæ°

*ä¸ä¸é¨å*<br/>
è¯¥æ§ä»¶çå±æ§çè°åº¦ IDã

*lpclsid*<br/>
æåå°è¿å`CLSID`ç±» ID çç»æçæéã

*pbPage å¯é*<br/>
è¿åæå®å±æ§é¡µçä½¿ç¨æ¯å¦å¯éçæç¤ºå¨ã

### <a name="return-value"></a>è¿åå¼

å¦æä»¥*lpclsid*ä¸­è¿åç±» IDï¼åéé¶ãå¦å 0ã

### <a name="remarks"></a>å¤æ³¨

éåæ­¤å½æ°ï¼æä¾ä»å®¹å¨çå±æ§æµè§å¨è°ç¨æ§ä»¶çå±æ§é¡µçæ¹æ³ã

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControlï¼onMnemonic

å½å®¹å¨æ£æµå°å·²æä¸ OLE æ§ä»¶çå©è®°ç¬¦é®æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>åæ°

*pMsg*<br/>
ä¸ä¸ªæéï¼æåç±å©è®°é®æé®æä½çæç Windows æ¶æ¯ã

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COle æ§å¶ï¼ï¼å±æ§

å½å®¹å¨è°ç¨æ§ä»¶çå±æ§è°è¯æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpMsg*<br/>
æåè°ç¨è°è¯ç Windows æ¶æ¯çæéã

*hWnd ç¶æ¯*<br/>
æ§ä»¶çç¶çªå£çå¥æã

*lpRect*<br/>
æåå®¹å¨ä¸­æ§ä»¶ä½¿ç¨çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æ¾ç¤ºä¸ä¸ªæ¨¡æå±æ§å¯¹è¯æ¡ã

æ¨è¿å¯ä»¥ä½¿ç¨æ­¤åè½æ¥æ¾ç¤ºæ§ä»¶çå±æ§é¡µã è°ç¨å½æ°ï¼`OnProperties`å¨*hWndParent*åæ°ä¸­ä¼ éæ§ä»¶ç¶é¡¹çå¥æã å¨è¿ç§æåµä¸ *ï¼lpMsg*å*lpRect*åæ°çå¼å°è¢«å¿½ç¥ã

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COle æ§å¶ï¼å¨æ¥è¯¢å½ä¸­ç¹

æ¡æ¶ååºå®¹å¨`IViewObjectEx::QueryHitPoint`è¯·æ±è°ç¨ã

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æå®å¯¹è±¡çè¡¨ç¤ºæ¹å¼ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*pRectBounds*<br/>
æåæå®`RECT`OLE æ§å¶å·¥ä½åºè¾¹çç©å½¢çç»æçæéã

*æ®ç¹æ´å*<br/>
æåç»æç`POINT`æéï¼æå®è¦æ£æ¥çç¹è¿è¡å½ä¸­ã è¯¥ç¹å¨ OLE å·¥ä½åºåæ ä¸­æå®ã

*l å³é­æç¤º*<br/>
å®ä¹"æ¥è¿"å°å·²æ£æ¥å½ä¸­ç¹çè·ç¦»ã

*pHitResult*<br/>
æåå½ä¸­æ¥è¯¢ç»æçæéã ä»¥ä¸å¼ä¹ä¸ï¼

- HITRESULT_OUTSIDE *ptlLoc*ä½äº OLE å¯¹è±¡å¤é¨ï¼ä¸å³é­ã

- HITRESULT_TRANSPARENT *ptlLoc*å¨ OLE å¯¹è±¡çè¾¹çåï¼ä½ä¸é è¿å¾åã ä¾å¦ï¼å¯ä»¥HITRESULT_TRANSPARENTéæåä¸­é´çç¹ã

- HITRESULT_CLOSE *ptlLoc*ä½äº OLE å¯¹è±¡åé¨æå¤é¨ï¼ä½è¶³å¤é è¿å¯¹è±¡ï¼å¯èèåé¨ã å°å¯¹è±¡ãç»å¯¹è±¡æè¯¦ç»å¯¹è±¡å¯è½ä¼ä½¿ç¨æ­¤å¼ã å³ä½¿æä¸ªç¹ä½äºå¯¹è±¡çè¾¹çç©å½¢ä¹å¤ï¼å®ä¹å¯è½ä»ç¶æ¥è¿ï¼è¿æ¯å½ä¸­å°å¯¹è±¡æå¿éçï¼ã

- HITRESULT_HIT *ptlLoc*ä½äºå¯¹è±¡çå¾åä¸­ã

### <a name="return-value"></a>è¿åå¼

æåè¿åå½ä¸­ç»ææ¶éé¶;å¦å 0ã å½ä¸­ä¸ OLE æ§å¶æ¾ç¤ºåºåéå ã

### <a name="remarks"></a>å¤æ³¨

æ¥è¯¢å¯¹è±¡çæ¾ç¤ºç©å½¢æ¯å¦ä¸ç»å®ç¹éå ï¼ç¹å»ç¹ï¼ã `QueryHitPoint`å¯ä»¥éåä»¥æµè¯éç©å½¢å¯¹è±¡çå½ä¸­ã

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControlï¼å¨æ¥è¯¢ä¸­

æ¡æ¶ååºå®¹å¨`IViewObjectEx::QueryHitRect`è¯·æ±è°ç¨ã

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>åæ°

*dwAspect*<br/>
æå®è¦å¦ä½è¡¨ç¤ºè¯¥å¯¹è±¡ã ææå¼åèªæä¸¾[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)æ DVASPECT2ã

*pRectBounds*<br/>
æåæå®`RECT`OLE æ§å¶å·¥ä½åºè¾¹çç©å½¢çç»æçæéã

*prcLoc*<br/>
æå`RECT`æå®è¦æ£æ¥çç©å½¢ä»¥è¿è¡å½ä¸­ï¼ä¸å¯¹è±¡ç©å½¢éå ï¼ç¸å¯¹äºå¯¹è±¡çå·¦ä¸è§çæéã

*l å³é­æç¤º*<br/>
æªä½¿ç¨ã

*pHitResult*<br/>
æåå½ä¸­æ¥è¯¢ç»æçæéã ä»¥ä¸å¼ä¹ä¸ï¼

- HITRESULT_OUTSIDE OLE å¯¹è±¡ä¸ä¼å½ä¸­ç©å½¢ä¸­çç¹ã

- HITRESULT_HITç©å½¢ä¸­è³å°æä¸ä¸ªç¹æ¯å¯¹è±¡çå½ä¸­ã

### <a name="return-value"></a>è¿åå¼

æåè¿åå½ä¸­ç»ææ¶éé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

æ¥è¯¢å¯¹è±¡çæ¾ç¤ºç©å½¢æ¯å¦ä¸ç»å®ç©å½¢ä¸­çä»»ä½ç¹éå ï¼ç¹å»ç©å½¢ï¼ã `QueryHitRect`å¯ä»¥éåä»¥æµè¯éç©å½¢å¯¹è±¡çå½ä¸­ã

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COle æ§å¶ï¼å¨æ¸²ææ°æ®ä¸

æ¡æ¶è°ç¨ä»¥æ£ç´¢æå®æ ¼å¼çæ°æ®ã

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æï¼æå®è¯·æ±ä¿¡æ¯çæ ¼å¼ã

*lpStg ä¸­*<br/>
æåè¦è¿åæ°æ®ç[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)ç»æã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨[å»¶è¿æ¸²ææ°æ®](../../mfc/reference/coledatasource-class.md#delayrenderdata)æ[å»¶è¿æ¸²ææä»¶](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)æåå½æ°æ¾ç½®å¨æ§ä»¶å¯¹è±¡ä¸­çæ ¼å¼ï¼ç¨äºå»¶è¿æ¸²æã å¦ææä¾çå­å¨ä»è´¨æ¯æä»¶æ`OnRenderFileData`åå­`OnRenderGlobalData`ï¼åæ­¤å½æ°çé»è®¤å®ç°å°è°ç¨ æ ãã" å¦æè¯·æ±çæ ¼å¼CF_METAFILEPICTææä¹å±æ§éæ ¼å¼ï¼åé»è®¤å®ç°åç°éå½çæ°æ®å¹¶è¿åéé¶ã å¦åï¼å®å°è¿å 0ï¼å¹¶ä¸ä¸æ§è¡ä»»ä½æä½ã

å¦æ*lpStgä¸­>tymedTYMED_NULLï¼* åSTGMEDIUMåºæ*lpFormatEtc->tymed*æå®åéåå¡«åã å¦æä¸TYMED_NULLï¼å STGMEDIUM åºéæ°æ®ä¸èµ·å¡«åã

éåæ­¤å½æ°ä»¥è¯·æ±çæ ¼å¼åä»è´¨æä¾æ°æ®ã æ ¹æ®æ°æ®çä¸åï¼æ¨å¯è½å¸æéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦ææ°æ®è¾å°ä¸å¤§å°åºå®ï¼è¯·éå`OnRenderGlobalData`ã å¦ææ°æ®ä½äºæä»¶ä¸­ï¼æèå¤§å°å¯åï¼è¯·éå`OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows `FORMATETC` SDK`STGMEDIUM`ä¸­ç å ç»æã

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COle æ§å¶ï¼å¨æ¸²ææä»¶æ°æ®ä¸

å½å­å¨ä»è´¨æ¯æä»¶æ¶ï¼æ¡æ¶è°ç¨ä»¥æå®æ ¼å¼æ£ç´¢æ°æ®ã

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æï¼æå®è¯·æ±ä¿¡æ¯çæ ¼å¼ã

*pFile*<br/>
æåè¦åç°æ°æ®ç[CFile](../../mfc/reference/cfile-class.md)å¯¹è±¡ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)æåå½æ°æ¾ç½®å¨æ§ä»¶å¯¹è±¡ä¸­çæ ¼å¼ï¼ç¨äºå»¶è¿æ¸²æã æ­¤å½æ°çé»è®¤å®ç°ä»è¿å FALSEã

éåæ­¤å½æ°ä»¥è¯·æ±çæ ¼å¼åä»è´¨æä¾æ°æ®ã æ ¹æ®æ°æ®çä¸åï¼æ¨å¯è½å¸æéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æè¦å¤çå¤ä¸ªå­å¨ä»è´¨ï¼åéå`OnRenderData`ã å¦ææ°æ®ä½äºæä»¶ä¸­ï¼æèå¤§å°å¯åï¼è¯·éå`OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows `FORMATETC` SDK ä¸­çç»æã

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COle æ§å¶ï¼å¨æ¸²æå¨å±æ°æ®

å½æå®çå­å¨ä»è´¨æ¯å¨å±åå­æ¶ï¼æ¡æ¶è°ç¨ä»¥æå®æ ¼å¼æ£ç´¢æ°æ®ã

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æå[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æï¼æå®è¯·æ±ä¿¡æ¯çæ ¼å¼ã

*phGlobal*<br/>
æåè¦è¿åæ°æ®çå¨å±åå­çå¥æã å¦ææªåéåå­ï¼åæ­¤åæ°å¯ä»¥æ¯ NULLã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

æå®çæ ¼å¼æ¯ä»¥åä½¿ç¨[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)æåå½æ°æ¾ç½®å¨æ§ä»¶å¯¹è±¡ä¸­çæ ¼å¼ï¼ç¨äºå»¶è¿æ¸²æã æ­¤å½æ°çé»è®¤å®ç°ä»è¿å FALSEã

å¦æ*phGlobal*ä¸º NULLï¼ååºå¨ phGLOBAL ä¸­åéå¹¶è¿åæ°ç*HGLOBALã* å¦å *ï¼phGLOBAL*æå®ç HGLOBAL åºå¡«åæ°æ®ã æ¾ç½®å¨ HGLOBAL ä¸­çæ°æ®éä¸å¾è¶è¿åå­åçå½åå¤§å°ã æ­¤å¤ï¼åæ æ³éæ°åéå°æ´å¤§çå¤§å°ã

éåæ­¤å½æ°ä»¥è¯·æ±çæ ¼å¼åä»è´¨æä¾æ°æ®ã æ ¹æ®æ°æ®çä¸åï¼æ¨å¯è½å¸æéåæ­¤å½æ°çå¶ä»çæ¬ä¹ä¸ã å¦æè¦å¤çå¤ä¸ªå­å¨ä»è´¨ï¼åéå`OnRenderData`ã å¦ææ°æ®ä½äºæä»¶ä¸­ï¼æèå¤§å°å¯åï¼è¯·éå`OnRenderFileData`ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows `FORMATETC` SDK ä¸­çç»æã

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COle æ§å¶ï¼å¨éç½®ç¶æ

å½æ§ä»¶çå±æ§åºè®¾ç½®ä¸ºå¶é»è®¤å¼æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnResetState();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ç§°ä¸º[DoPropExchangeï¼](#dopropexchange)ä¼ éå¯¼è´`CPropExchange`å±æ§è®¾ç½®ä¸ºå¶é»è®¤å¼çå¯¹è±¡ã

æ§ä»¶ç¼åå¨å¯ä»¥å¨æ­¤å¯éåä¸­æå¥ OLE æ§ä»¶çåå§åä»£ç ã å½[IPersistStreamï¼ï¼å è½½](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)æ[Iæä¹å­å¨ï¼å è½½](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)å¤±è´¥ï¼æ[IPersistStreaminitï¼ï¼Ininnew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)æ[IpersistStorageï¼ï¼InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew)è°ç¨æ¶ï¼è°ç¨æ­¤å½æ°`IPersistStream::Load`ï¼`IPersistStorage::Load`æ éé¦åè°ç¨æ è°ç¨ ã

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControlï¼å¨è®¾ç½®å®¢æ·ç«¯ç«ç¹

å½å®¹å¨è°ç¨æ§ä»¶ç`IOleControl::SetClientSite`å½æ°æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤æåµä¸ï¼`OnSetClientSite`æ£æ¥æ¯å¦å è½½æ°æ®è·¯å¾å±æ§ï¼å¦ææ¯å¦å è½½ï¼åè°ç¨`DoDataPathPropExchange`ã

éåæ­¤å½æ°ä»¥æ§è¡æ­¤éç¥çä»»ä½ç¹æ®å¤çã ç¹å«æ¯ï¼æ­¤å½æ°çéååºè°ç¨åºç±»ã

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControlï¼OnSetData

ç±æ¡æ¶è°ç¨ä»¥å°æ§ä»¶çæ°æ®æ¿æ¢ä¸ºæå®æ°æ®ã

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>åæ°

*lpFormatEtc*<br/>
æåæå®æ°æ®æ ¼å¼ç[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)ç»æçæéã

*lpStg ä¸­*<br/>
æåæ°æ®æå¨ç[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)ç»æçæéã

*béæ¾*<br/>
å¦ææ§ä»¶åºéæ¾å­å¨ä»è´¨ï¼åä¸º TRUE;å¦ææ§ä»¶ä¸åºéæ¾å­å¨ä»è´¨ï¼å FALSEã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ°æ®éç¨æä¹å±æ§éæ ¼å¼ï¼åé»è®¤å®ç°å°ç¸åºå°ä¿®æ¹æ§ä»¶çç¶æã å¦åï¼é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã å¦æ*bRelease*ä¸º TRUEï¼å`ReleaseStgMedium`è°ç¨ ;å¦åï¼ä¸ã

éåæ­¤å½æ°ä»¥å°æ§ä»¶çæ°æ®æ¿æ¢ä¸ºæå®çæ°æ®ã

æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows `FORMATETC` SDK`STGMEDIUM`ä¸­ç å ç»æã

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COle æ§å¶ï¼å¨è®¾ç½®èå´

å½éè¦æ´æ¹æ§ä»¶çèå´æ¶ï¼ç±äºè°ç¨[IOleObjectï¼ï¼ï¼set èå´](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent)ï¼åç±æ¡æ¶è°ç¨ã

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>åæ°

*lpSizeL*<br/>
æåä½¿ç¨é¿æ´`SIZEL`æ°è¡¨ç¤ºæ§ä»¶çå®½åº¦åé«åº¦çç»æçæéï¼ä»¥ HIMETRIC åä½è¡¨ç¤ºã

### <a name="return-value"></a>è¿åå¼

å¦ææ¥åå¤§å°æ´æ¹ï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°å¤çæ§ä»¶èå´çè°æ´å¤§å°ã å¦ææ§ä»¶å¤äºå°±å°æ´»å¨ç¶æï¼åå¯¹å®¹å¨ç`OnPosRectChanged`è°ç¨ã

éåæ­¤å½æ°ä»¥æ´æ¹æ§ä»¶çé»è®¤å¤§å°è°æ´ã

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COle æ§å¶ï¼OnSetObjectrects

ç±æ¡æ¶è°ç¨ä»¥å®ç°å¯¹[IOleInPlace å¯¹è±¡çè°ç¨ï¼ï¼è®¾ç½®å¯¹è±¡éæ°å¯¹è±¡](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)ã

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>åæ°

*lpRectPos*<br/>
æåæç¤ºæ§ä»¶ç¸å¯¹äº`RECT`å®¹å¨çæ°ä½ç½®åå¤§å°çç»æçæéã

*lprectClip*<br/>
æåæç¤ºè¦åªå`RECT`æ§ä»¶çç©å½¢åºåçç»æçæéã

### <a name="return-value"></a>è¿åå¼

æ¥åéæ°å®ä½æ¶éé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°èªå¨å¤çæ§ä»¶çªå£çéæ°å®ä½åè°æ´å¤§å°ï¼å¹¶è¿å TRUEã

éåæ­¤å½æ°ä»¥æ´æ¹æ­¤å½æ°çé»è®¤è¡ä¸ºã

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControlï¼ï¼å¨æ¾ç¤ºå·¥å·æ ä¸

å½æ§ä»¶å·²æ¿æ´» UI æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°ä¸æ§è¡ä»»ä½æä½ã

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COle æ§å¶ï¼å¨ææ¬ä¸æ´æ¹

å½è¡ç¥¨æ é¢æææ¬å±æ§å¼åçæ´æ¹æ¶ï¼ç±æ¡æ¶è°ç¨ã

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°è°ç¨`InvalidateControl`ã

å¦æè¦å¨æ­¤å±æ§æ´æ¹åéç¥ï¼åéåæ­¤å½æ°ã

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControlï¼æ çªå£æ¶æ¯

æ¡æ¶ååºå®¹å¨`IOleInPlaceObjectWindowless::OnWindowMessage`è¯·æ±è°ç¨ã

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>åæ°

*å³ç²¾*<br/>
ç± Windows ä¼ éçæ¶æ¯æ è¯ç¬¦ã

*wParam*<br/>
éè¿ Windowsã æå®å¶ä»ç¹å®äºæ¶æ¯çä¿¡æ¯ã æ­¤åæ°çåå®¹åå³äº*msg*åæ°çå¼ã

*lParam*<br/>
éè¿ Windowsã æå®å¶ä»ç¹å®äºæ¶æ¯çä¿¡æ¯ã æ­¤åæ°çåå®¹åå³äº*msg*åæ°çå¼ã

*plResult*<br/>
çªå£ç»æä»£ç ã æå®æ¶æ¯å¤ççç»æï¼å¹¶åå³äºåéçæ¶æ¯ã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¤çæ çªå£æ§ä»¶ççªå£æ¶æ¯ã `COleControl`åº`OnWindowlessMessage`ç¨äºé¼ æ æ¶æ¯åé®çæ¶æ¯ä»¥å¤ççªå£æ¶æ¯ã `COleControl`æä¾[SetCapture](#setcapture)å[SetFocusï¼](#setfocus)ä¸é¨ç¨äºè·åæ çªå£ OLE å¯¹è±¡çé¼ æ æè·åé®çç¦ç¹ã

ç±äºæ çªå£å¯¹è±¡æ²¡æçªå£ï¼å æ­¤å®ä»¬éè¦ä¸ç§æºå¶æ¥è®©å®¹å¨åå®ä»¬åéæ¶æ¯ã æ çªå£ OLE å¯¹è±¡éè¿`OnWindowMessage``IOleInPlaceObjectWindowless`æ¥å£ä¸çæ¹æ³ï¼ç¨äºæ çªå£æ¯æç[IOleInPlace å¯¹è±¡ç](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)æ©å±ï¼ï¼ä»å¶å®¹å¨è·åæ¶æ¯ã `OnWindowMessage`ä¸éç¨åæ°`HWND`ã

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControlï¼:På®¢æ·

å°*pPoint*çåæ è½¬æ¢ä¸ºå®¢æ·ç«¯åæ ã

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>åæ°

*lprcBounds*<br/>
æåå®¹å¨å OLE æ§ä»¶çè¾¹çã ä¸æ¯å·¥ä½åºï¼èæ¯æ´ä¸ªæ§ä»¶çåºåï¼åæ¬è¾¹æ¡åæ»å¨æ¡ã

*pPoint*<br/>
æåç¶ï¼å®¹å¨ï¼ç¹çæéè¦è½¬æ¢ä¸ºæ§ä»¶çå·¥ä½åºçåæ ã

*bHitTest*<br/>
æå®æ¯å¦å¨ç¹ä¸æ§è¡å½ä¸­æµè¯ã

### <a name="return-value"></a>è¿åå¼

å¦æ*bHitTest*æ¯ FALSEï¼åè¿å HTNOWHEREã å¦æ*bHitTest*ä¸º TRUEï¼åè¿åç¶ï¼å®¹å¨ï¼ç¹éè½å¨ OLE æ§ä»¶çå·¥ä½åºçä½ç½®ï¼å¹¶ä¸æ¯ä»¥ä¸é¼ æ å½ä¸­æµè¯å¼ä¹ä¸ï¼

- HTBORDER å¨æ²¡æå¤§å°è°æ´è¾¹æ¡ççªå£çè¾¹æ¡ä¸­ã

- HTBOTTOM å¨çªå£çä¸æ°´å¹³è¾¹æ¡ä¸­ã

- å¨çªå£è¾¹æ¡çå·¦ä¸è§ã

- å¨çªå£è¾¹æ¡çå³ä¸è§ã

- å¨æ é¢æ åºåä¸­ã

- å¨å®¢æ·ç«¯åºåä¸­ã

- HTERROR å¨å±å¹èæ¯æçªå£ä¹é´çåççº¿ä¸ï¼ä¸ HTNOWHERE ç¸åï¼åªä¸è¿`DefWndProc`Windows åè½ååºç³»ç»èé¸£é³ä»¥æç¤ºéè¯¯ï¼ã

- å¨å¤§å°æ¡ä¸­ã

- HTHSCROLL å¨æ°´å¹³æ»å¨æ¡ä¸­ã

- å¨çªå£çå·¦ä¾§è¾¹æ¡ä¸­ã

- HTMAXBUTTON å¨æå¤§åæé®ä¸­ã

- å¨èååºåä¸­ã

- å¨æå°åæé®ä¸­ã

- å¨å±å¹èæ¯æçªå£ä¹é´çåççº¿ä¸ã

- å¨æå°åæé®ä¸­ã

- å¨çªå£çå³ä¾§è¾¹æ¡ä¸­ã

- å¨å¤§å°æ¡ä¸­ï¼ä¸ HTGROWBOX ç¸åï¼ã

- å¨"æ§å¶"èåä¸­æå¨å­çªå£ä¸­ç"å³é­"æé®ä¸­ã

- HTTOP å¨çªå£çä¸æ°´å¹³è¾¹æ¡ä¸­ã

- å¨çªå£è¾¹æ¡çå·¦ä¸è§ã

- å¨çªå£è¾¹æ¡çå³ä¸è§ã

- HTOPAQUE å½åç±å¦ä¸ä¸ªçªå£è¦çççªå£ã

- åç´æ»å¨æ ä¸­ç HTVSCROLLã

- å¨æå¤§åæé®ä¸­ä½¿ç¨ HTZOOMã

### <a name="remarks"></a>å¤æ³¨

å¨è¾å¥*pPoint*ä¸ç¸å¯¹äºç¶ç«¯çåç¹ï¼å®¹å¨çå·¦ä¸è§ï¼ã å¨è¾åº*pPoint*ä¸ç¸å¯¹äº OLE æ§ä»¶çå·¥ä½åºçåç¹ï¼æ§ä»¶çå·¥ä½åºçå·¦ä¸è§ï¼ã

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControlï¼:Pæ¨¡å¼å¯¹è¯

éç¥å®¹å¨æ¨¡å¼å¯¹è¯æ¡å·²å³é­ã

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>åæ°

*hWnd ç¶æ¯*<br/>
å¤çæ¨¡å¼å¯¹è¯æ¡çç¶çªå£ã

### <a name="remarks"></a>å¤æ³¨

æ¾ç¤ºä»»ä½æ¨¡å¼å¯¹è¯æ¡åè°ç¨æ­¤å½æ°ã å¿é¡»è°ç¨æ­¤å½æ°ï¼ä»¥ä¾¿å®¹å¨å¯ä»¥å¯ç¨ ç±`PreModalDialog`ç¦ç¨çä»»ä½é¡¶çº§çªå£ã æ­¤å½æ°åºä¸ è°ç¨`PreModalDialog`éå¯¹ã

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControlï¼:Péæ°æ¨¡å¼å¯¹è¯

éç¥å®¹å¨å³å°æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡ã

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>åæ°

*hWnd ç¶æ¯*<br/>
å¤çæ¨¡å¼å¯¹è¯æ¡çç¶çªå£ã

### <a name="remarks"></a>å¤æ³¨

å¨æ¾ç¤ºä»»ä½æ¨¡å¼å¯¹è¯æ¡ä¹åè°ç¨æ­¤å½æ°ã æ¨å¿é¡»è°ç¨æ­¤å½æ°ï¼ä»¥ä¾¿å®¹å¨å¯ä»¥ç¦ç¨å¶ææé¡¶çº§çªå£ã æ¾ç¤ºæ¨¡å¼å¯¹è¯æ¡åï¼å¿é¡»è°ç¨`PostModalDialog`ã

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COle æ§å¶ï¼ï¼éæ°åå»ºæ§å¶çªå£

éæ¯å¹¶éæ°åå»ºæ§ä»¶ççªå£ã

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>å¤æ³¨

å¦æéè¦æ´æ¹çªå£çæ ·å¼ä½ï¼åå¯è½éè¦è¿æ ·åã

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COle æ§å¶ï¼å·æ°

å¼ºå¶éæ°ç»å¶ OLE æ§ä»¶ã

```cpp
void Refresh();
```

### <a name="remarks"></a>å¤æ³¨

`COleControl`åºç±»æ¯ææ­¤åè½ä½ä¸ºè¡ç¥¨æ¹æ³ï¼ç§°ä¸ºå·æ°ï¼ã è¿åè®¸ OLE æ§ä»¶çç¨æ·å¨ç¹å®æ¶é´éæ°ç»å¶æ§ä»¶ã æå³æ­¤æ¹æ³çè¯¦ç»ä¿¡æ¯ï¼è¯·åéæç« [ActiveX æ§ä»¶ï¼æ¹æ³](../../mfc/mfc-activex-controls-methods.md)ã

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COle æ§å¶ï¼ï¼åå¸æè·

éæ¾é¼ æ æè·ã

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å½åå·æé¼ æ æè·ï¼åéæ¾æè·ã å¦åï¼æ­¤å½æ°ä¸èµ·ä½ç¨ã

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COle æ§å¶ï¼éæ¾DC

éæ¾æ çªå£æ§ä»¶å®¹å¨çæ¾ç¤ºè®¾å¤ä¸ä¸æï¼éæ¾è®¾å¤ä¸ä¸æä¾å¶ä»åºç¨ç¨åºä½¿ç¨ã

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æ è¯è¦åå¸çå®¹å¨è®¾å¤ä¸ä¸æã

### <a name="return-value"></a>è¿åå¼

å¦ææåï¼åä¸ä¸º 0ï¼å¦åä¸º 0ã

### <a name="remarks"></a>å¤æ³¨

åºç¨ç¨åºå¿é¡»è°ç¨`ReleaseDC` [GetDC](#getdc)çæ¯ä¸ªè°ç¨ã

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COle æ§å¶ï¼ï¼éç¶æ§å¶çªå£

è®¾ç½®æ§ä»¶çç¶çº§ã

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>åæ°

*hWndouter*<br/>
æ§å¶çªå£çå¥æã

*hWnd ç¶æ¯*<br/>
æ°ç¶çªå£çå¥æã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»¥éç½®æ§ä»¶çªå£çç¶çº§ã

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COle æ§å¶ï¼ï¼éç½®åºå­

å°`COleControl`è¡ç¥¨å±æ§çç¶æåå§åå°å¶é»è®¤å¼ã

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>å¤æ³¨

å±æ§åæ¬ï¼å¤è§ãèé¢é¢è²ãè¾¹æ¡æ ·å¼ãæ é¢ãå¯ç¨ãå­ä½ãåé¢è²ãhwnd åææ¬ã æå³è¡ç¥¨å±æ§çè¯´æï¼è¯·åé[ActiveX æ§ä»¶ï¼æ·»å è¡ç¥¨å±æ§](../../mfc/mfc-activex-controls-adding-stock-properties.md)ã

å¯ä»¥ä½¿ç¨`ResetStockProps`å`ResetVersion`å¯ä»¥æé«æ§ä»¶çäºè¿å¶åå§åæ§è½ã `COleControl::OnResetState` è¯·åéä»¥ä¸ç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COle æ§å¶ï¼éç½®çæ¬

å°çæ¬å·åå§åä¸ºæå®å¼ã

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>åæ°

*dwVersionDefault*<br/>
è¦åéç»æ§ä»¶ççæ¬å·ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥ä½¿ç¨`ResetVersion`å`ResetStockProps`å¯ä»¥æé«æ§ä»¶çäºè¿å¶åå§åæ§è½ã `COleControl::OnResetState` è¯·åé[ResetStockProps](#resetstockprops)ä¸çç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COle æ§å¶ï¼æ»å¨çªå£

åè®¸æ çªå£ OLE å¯¹è±¡å¨å±å¹ä¸æ»å¨å¶å°±å°æ´»å¨å¾åä¸­çåºåã

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>åæ°

*xæ°é*<br/>
æå®æ°´å¹³æ»å¨çæ°éï¼ä»¥è®¾å¤åä½ä¸ºåä½ï¼ã æ­¤åæ°å¿é¡»æ¯åå·¦æ»å¨çè´å¼ã

*y æ°é*<br/>
æå®åç´æ»å¨çæ°éï¼ä»¥è®¾å¤åä½ä¸ºåä½ï¼ã æ­¤åæ°å¿é¡»æ¯è´å¼æè½åä¸æ»å¨ã

*lpRect*<br/>
æå[CRect](../../atl-mfc-shared/reference/crect-class.md)å¯¹è±¡æ RECT ç»æï¼è¯¥ç»ææå® OLE å¯¹è±¡è¦æ»å¨çå·¥ä½åºé¨åï¼ä½äºåå«çªå£çå®¢æ·ç«¯åæ ä¸­ã å¦æ*lpRect*ä¸º NULLï¼åæ»å¨æ´ä¸ª OLE å¯¹è±¡çå·¥ä½åºã

*lpClipRect*<br/>
æåæå®`CRect`è¦åªè¾å°`RECT`çç©å½¢çå¯¹è±¡æç»æã ä»æ»å¨ç©å½¢åçåç´ ã ç©å½¢å¤é¨çä½ä¸åå½±åï¼å³ä½¿å®ä»¬ä½äº*lpRect*ç©å½¢ä¸­ä¹æ¯å¦æ­¤ã å¦æ*lpClipRect*ä¸º NULLï¼åæ»å¨ç©å½¢ä¸ä¸æ§è¡ä»»ä½åªè¾ã

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COle æ§å¶ï¼éæ©å­ä½å¯¹è±¡

å¨è®¾å¤ä¸ä¸æä¸­éæ©å­ä½ã

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
æåè®¾å¤ä¸ä¸æå¯¹è±¡çæéã

*å­ä½ææäºº*<br/>
å¼ç¨è¡¨ç¤ºè¦éæ©çå­ä½ç[CFontHolder](../../mfc/reference/cfontholder-class.md)å¯¹è±¡ã

### <a name="return-value"></a>è¿åå¼

æåä»¥åéå®çå­ä½çæéã å½è°ç¨æ¹å®æä½¿ç¨*fontHolder*çææç»å¾æä½åï¼åºéæ°éæ©ä»¥åéæ©çå­ä½ï¼å°å¶ä½ä¸ºåæ°ä¼ éç»[CDCï¼ï¼éæ©å¯¹è±¡](../../mfc/reference/cdc-class.md#selectobject)ã

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControlï¼éæ©åºå­å­ä½

å¨è®¾å¤ä¸ä¸æä¸­éæ©"åºå­å­ä½"å±æ§ã

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>åæ°

*pDC*<br/>
å°å¨å¶ä¸­éæ©å­ä½çè®¾å¤ä¸ä¸æã

### <a name="return-value"></a>è¿åå¼

æåä»¥åéå®ç`CFont`å¯¹è±¡çæéã æ¨åºè¯¥ä½¿ç¨[CDCï¼ï¼éæ©Objectï¼](../../mfc/reference/cdc-class.md#selectobject)å¨å®æåéæ©æ­¤å­ä½åè®¾å¤ä¸ä¸æä¸­ã

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COle æ§å¶ï¼åºååèå´

åºååæåå§ååéç»æ§ä»¶çæ¾ç¤ºç©ºé´çç¶æã

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>åæ°

*ar*<br/>
è¦`CArchive`åºååå°æä»ä¸­åºååçå¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥ä½¿ç¨`SerializeExtent`å`SerializeStockProps``SerializeVersion`å¯ä»¥æé«æ§ä»¶çäºè¿å¶æä¹æ§æ§è½`COleControl::Serialize`ï¼ è¯·åéä»¥ä¸ç¤ºä¾ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

### <a name="example"></a>ç¤ºä¾

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COle æ§å¶ï¼ï¼åºåååºå­

åºååæåå§å`COleControl`è¡ç¥¨å±æ§çç¶æï¼å¤è§ãèé¢é¢è²ãè¾¹æ¡æ ·å¼ãæ é¢ãå·²å¯ç¨ãå­ä½ãåé¢è²åææ¬ã

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>åæ°

*ar*<br/>
è¦`CArchive`åºååå°æä»ä¸­åºååçå¯¹è±¡ã

### <a name="remarks"></a>å¤æ³¨

æå³è¡ç¥¨å±æ§çè¯´æï¼è¯·åé[ActiveX æ§ä»¶ï¼æ·»å è¡ç¥¨å±æ§](../../mfc/mfc-activex-controls-adding-stock-properties.md)ã

å¯ä»¥ä½¿ç¨`SerializeStockProps`å`SerializeExtent``SerializeVersion`å¯ä»¥æé«æ§ä»¶çäºè¿å¶æä¹æ§æ§è½`COleControl::Serialize`ï¼ ä¾å¦ï¼è¯·åé[åºååèå´](#serializeextent)ä¸­çä»£ç ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COle æ§å¶ï¼åºååçæ¬

åºååæåå§åæ§ä»¶ççæ¬ä¿¡æ¯çç¶æã

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>åæ°

*ar*<br/>
è¦`CArchive`åºååå°æä»ä¸­åºååçå¯¹è±¡ã

*dwVersionDefault*<br/>
æ§ä»¶çå½åçæ¬å·ã

*bè½¬æ¢*<br/>
æç¤ºå¨ä¿å­æä¹æ§æ°æ®æ¶æ¯å¦åºè½¬æ¢ä¸ºææ°æ ¼å¼ï¼è¿æ¯ä»¥å è½½æ¶çç¸åæ ¼å¼è¿è¡ç»´æ¤ã

### <a name="return-value"></a>è¿åå¼

æ§ä»¶ççæ¬å·ã å¦ææ­£å¨å è½½æå®çå­æ¡£ï¼å`SerializeVersion`è¿åä»è¯¥å­æ¡£å è½½ççæ¬ã å¦åï¼å®å°è¿åå½åå è½½ççæ¬ã

### <a name="remarks"></a>å¤æ³¨

å¯ä»¥ä½¿ç¨`SerializeVersion`å`SerializeExtent``SerializeStockProps`å¯ä»¥æé«æ§ä»¶çäºè¿å¶æä¹æ§æ§è½`COleControl::Serialize`ï¼ ä¾å¦ï¼è¯·åé[åºååèå´](#serializeextent)ä¸­çä»£ç ã æå³ä¼ååå§åçè¯¦ç»ä¿¡æ¯ï¼è¯·åé[ActiveX æ§ä»¶ï¼ä¼å](../../mfc/mfc-activex-controls-optimization.md)ã

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COle æ§å¶ï¼ï¼è®¾ç½®å¤è§

è®¾ç½®æ§ä»¶çåºå­å¤è§å±æ§å¼ã

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>åæ°

*så¤è§*<br/>
ç¨äº**short**æ§ä»¶å¤è§çç®ç­ï¼VT_I2ï¼å¼ã å¼ä¸ºé¶å°æ§ä»¶çå¤è§è®¾ç½®ä¸ºå¹³é¢ï¼å¼ 1 å°æ§ä»¶çå¤è§è®¾ç½®ä¸º 3Dã

### <a name="remarks"></a>å¤æ³¨

æå³è¡ç¥¨å±æ§çæ´å¤ï¼è¯·åé[ActiveX æ§ä»¶ï¼å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COle æ§å¶ï¼ï¼è®¾ç½®åé¢è²

è®¾ç½®æ§ä»¶çåºå­åé¢è²å±æ§å¼ã

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>åæ°

*dwBackColor*<br/>
ç¨äºæ§ä»¶çèæ¯ç»å¶çOLE_COLORå¼ã

### <a name="remarks"></a>å¤æ³¨

æå³ä½¿ç¨æ­¤å±æ§åå¶ä»ç¸å³å±æ§çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[æç«  ActiveX æ§ä»¶ï¼å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COle æ§å¶ï¼è®¾ç½®è¾¹æ¡æ ·å¼

è®¾ç½®æ§ä»¶çåºå­ BorderStyle å±æ§å¼ã

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>åæ°

*sè¾¹æ¡æ ·å¼*<br/>
æ§ä»¶çæ°è¾¹æ¡æ ·å¼;0 è¡¨ç¤ºæ²¡æè¾¹æ¡ï¼1 è¡¨ç¤ºæ­£å¸¸è¾¹æ¡ã

### <a name="remarks"></a>å¤æ³¨

ç¶åï¼å°éæ°åå»ºå`OnBorderStyleChanged`è°ç¨æ§å¶çªå£ã

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COle æ§å¶ï¼è®¾ç½®æè·

ä½¿æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶è·åé¼ æ æè·ã

```
CWnd* SetCapture();
```

### <a name="return-value"></a>è¿åå¼

æåä»¥åæ¥æ¶é¼ æ `CWnd`è¾å¥ççªå£å¯¹è±¡çæéã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶è¢«æ¿æ´»ä¸æ çªå£ï¼åæ­¤å½æ°ä¼å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»£è¡¨æ§ä»¶è·åé¼ æ æè·ã å¦åï¼æ­¤å½æ°ä¼å¯¼è´æ§ä»¶æ¬èº«è·åé¼ æ æè·ï¼ä¸`CWnd::SetCapture`ç¸åï¼ã

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COle æ§å¶ï¼è®¾ç½®æ§å¶å¤§å°

è®¾ç½® OLE æ§å¶çªå£çå¤§å°ï¼å¹¶éç¥å®¹å¨æ§ä»¶ç«ç¹æ­£å¨æ´æ¹ã

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>åæ°

*æ®éª*<br/>
æå®æ§ä»¶çæ°å®½åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

*cy*<br/>
æå®æ§ä»¶çæ°é«åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°ä¸åºå¨æ§ä»¶çæé å½æ°ä¸­ä½¿ç¨ã

è¯·æ³¨æï¼æ§ä»¶çªå£çææåæ é½ç¸å¯¹äºæ§ä»¶çå·¦ä¸è§ã

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COle æ§å¶ï¼å·²å¯ç¨

è®¾ç½®æ§ä»¶ç"å·²å¯ç¨"å±æ§å¼ã

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>åæ°

*b å¯ç¨*<br/>
å¦æè¦å¯ç¨æ§ä»¶ï¼åä¸º TRUE;å¦æè¦å¯ç¨è¯¥æ§ä»¶ï¼åä¸º TRUEãå¦å FALSEã

### <a name="remarks"></a>å¤æ³¨

è®¾ç½®æ­¤å±æ§åï¼`OnEnabledChange`å°è°ç¨ã

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COle æ§å¶ï¼è®¾ç½®ç¦ç¹

ä½¿æ§ä»¶çå®¹å¨çªå£ä»¥æ§ä»¶çåä¹å ç¨è¾å¥ç¦ç¹ã

```
CWnd* SetFocus();
```

### <a name="return-value"></a>è¿åå¼

æåä»¥åå·æè¾å¥`CWnd`ç¦ç¹ççªå£å¯¹è±¡çæéï¼å¦ææ²¡æè¿æ ·ççªå£ï¼åæå NULLã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶è¢«æ¿æ´»ä¸æ çªå£ï¼åæ­¤å½æ°ä¼å¯¼è´æ§ä»¶çå®¹å¨çªå£ä»¥æ§ä»¶çåä¹è·åè¾å¥ç¦ç¹ã è¾å¥ç¦ç¹å°é®çè¾å¥å®åå°å®¹å¨ççªå£ï¼å®¹å¨å°ææåç»­çé®çæ¶æ¯è°åº¦å°è°ç¨`SetFocus`ç OLE å¯¹è±¡ã ä»¥åå·æè¾å¥ç¦ç¹çä»»ä½çªå£é½ä¸¢å¤±å®ã

å¦ææ§ä»¶ä¸æ¯æ çªå£çï¼åæ­¤å½æ°ä¼å¯¼è´æ§ä»¶æ¬èº«å ç¨è¾å¥ç¦ç¹ï¼ä¸`CWnd::SetFocus`ç¸åï¼ã

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COle æ§å¶ï¼ï¼è®¾ç½®å­ä½

è®¾ç½®æ§ä»¶çåºå­å­ä½å±æ§ã

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>åæ°

*pFontDisp*<br/>
æåå­ä½è°åº¦çé¢çæéã

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControlï¼è®¾ç½®ç¦å½©

è®¾ç½®æ§ä»¶çåºå­ ForeColor å±æ§å¼ã

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>åæ°

*dwForeColor*<br/>
ç¨äºæ§ä»¶çåæ¯ç»å¾çOLE_COLORå¼ã

### <a name="remarks"></a>å¤æ³¨

æå³ä½¿ç¨æ­¤å±æ§åå¶ä»ç¸å³å±æ§çè¯¦ç»ä¿¡æ¯ï¼è¯·åé[æç«  ActiveX æ§ä»¶ï¼å±æ§](../../mfc/mfc-activex-controls-properties.md)ã

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControlï¼è®¾ç½®åå§æ°æ®æ ¼å¼

ç±æ¡æ¶è°ç¨ä»¥åå§åæ§ä»¶æ¯æçæ°æ®æ ¼å¼åè¡¨ã

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>å¤æ³¨

é»è®¤å®ç°æå®ä¸¤ç§æ ¼å¼ï¼CF_METAFILEPICT åæä¹å±æ§éã

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COle æ§å¶ï¼è®¾ç½®åå§å¤§å°

è®¾ç½®é¦æ¬¡æ¾ç¤ºå¨å®¹å¨ä¸­ç OLE æ§ä»¶çå¤§å°ã

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>åæ°

*æ®éª*<br/>
OLE æ§ä»¶çåå§å®½åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

*cy*<br/>
OLE æ§ä»¶çåå§é«åº¦ï¼ä»¥åç´ ä¸ºåä½ï¼ã

### <a name="remarks"></a>å¤æ³¨

å¨æé å½æ°ä¸­è°ç¨æ­¤å½æ°ä»¥è®¾ç½®æ§ä»¶çåå§å¤§å°ã åå§å¤§å°ä»¥è®¾å¤åä½æåç´ ä¸ºåä½è¿è¡æµéã å»ºè®®å¨æ§ä»¶çæé å½æ°ä¸­è¿è¡æ­¤è°ç¨ã

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COle æ§å¶ï¼è®¾ç½®å·²ä¿®æ¹çæ è®°

æ´æ¹æ§ä»¶çå·²ä¿®æ¹ç¶æã

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>åæ°

*b ä¿®æ¹*<br/>
æ§ä»¶å·²ä¿®æ¹æ å¿çæ°å¼ã TRUE è¡¨ç¤ºæ§ä»¶çç¶æå·²è¢«ä¿®æ¹;FALSE è¡¨ç¤ºæ§ä»¶çç¶æååä¿å­ã

### <a name="remarks"></a>å¤æ³¨

æ¯å½åçä¼å½±åæ§ä»¶çæä¹ç¶æçæ´æ¹æ¶ï¼è¯·è°ç¨æ­¤å½æ°ã ä¾å¦ï¼å¦ææä¹å±æ§çå¼åçæ´æ¹ï¼è¯·ç¨ b ä¿®æ¹*bModified***TRUE**è°ç¨æ­¤å½æ°ã

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COle æ§å¶ï¼è®¾ç½®ä¸åè®¸

æç¤ºç¼è¾è¯·æ±å¤±è´¥ã

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>å¤æ³¨

åçæéæ¶`BoundPropertyRequestEdit`è°ç¨æ­¤å½æ°ã æ­¤å½æ°å°å¼åç±»å`COleDispScodeException`å¼å¸¸ï¼ä»¥æç¤ºä¸åè®¸è®¾ç½®æä½ã

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COle æ§å¶ï¼è®¾ç½®ä¸æ¯æ

é²æ­¢ç¨æ·ä¿®æ¹æ§ä»¶çå±æ§å¼ã

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°ä»¥ä»£æ¿ä¸æ¯ææ§ä»¶ç¨æ·ä¿®æ¹å±æ§å¼çä»»ä½å±æ§ç Set å½æ°ã ä¾å¦ï¼ä¸ä¸ªå±æ§æ¯åªè¯»çã

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COle æ§å¶ï¼setrectin å®¹å¨

è®¾ç½®æ§ä»¶ç©å½¢ç¸å¯¹äºå®¹å¨çåæ ï¼ä»¥è®¾å¤åä½è¡¨ç¤ºã

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>åæ°

*lpRect*<br/>
æååå«æ§ä»¶ç¸å¯¹äºå®¹å¨çæ°åæ çç©å½¢çæéã

### <a name="return-value"></a>è¿åå¼

å¦æè°ç¨æåï¼åéé¶;å¦å 0ã

### <a name="remarks"></a>å¤æ³¨

å¦ææ§ä»¶å¤äºæå¼ç¶æï¼åè°æ´æ§ä»¶çå¤§å°;å¦ææ§ä»¶å¤äºæå¼ç¶æï¼åè°æ´æ§ä»¶çå¤§å°ãå¦åå°è°ç¨å®¹å¨çåè½`OnPosRectChanged`ã

## <a name="colecontrolsettext"></a><a name="settext"></a>COle æ§å¶ï¼è®¾ç½®ææ¬

è®¾ç½®æ§ä»¶çåºå­æ é¢æææ¬å±æ§çå¼ã

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>åæ°

*pszText*<br/>
æåå­ç¬¦ä¸²çæéã

### <a name="remarks"></a>å¤æ³¨

è¯·æ³¨æï¼è¡ç¥¨æ é¢åææ¬å±æ§é½æ å°å°ç¸åçå¼ã è¿æå³çå¯¹ä»»ä¸å±æ§æåçä»»ä½æ´æ¹é½å°èªå¨æ´æ¹è¿ä¸¤ä¸ªå±æ§ã éå¸¸ï¼æ§ä»¶åºæ¯æè¡ç¥¨æ é¢æææ¬å±æ§ï¼ä½ä¸è½åæ¶æ¯æè¿ä¸¤èã

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COle æ§å¶ï¼ï¼ææ·éè¯¯

æç¤ºæ§ä»¶ä¸­åºç°éè¯¯ã

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>åæ°

*Sc*<br/>
è¦æ¥åçç¶æä»£ç å¼ã æå³å¯è½ä»£ç çå®æ´åè¡¨ï¼è¯·åé["ActiveX æ§ä»¶ï¼é«çº§ä¸»é¢"ä¸](../../mfc/mfc-activex-controls-advanced-topics.md)æã

*n æè¿°ID*<br/>
è¦æ¥åçå¼å¸¸çå­ç¬¦ä¸²èµæº IDã

*nHelpID*<br/>
è¦æ¥åçä¸»é¢çå¸®å© IDã

*pszæè¿°*<br/>
åå«è¦æ¥åçå¼å¸¸çè§£éçå­ç¬¦ä¸²ã

### <a name="remarks"></a>å¤æ³¨

æ­¤å½æ°åºä»ä» OLE å±æ§ç Get æ Set å½æ°ä¸­è°ç¨ï¼æå®ç° OLE èªå¨åæ¹æ³ã å¦æéè¦ååºå¶ä»æ¶é´åççéè¯¯ä¿¡å·ï¼ååºè§¦ååºå­éè¯¯äºä»¶ã

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COle æ§å¶ï¼è½¬æ¢åºå¾·

åæ¢ HIMETRIC åä½åå®¹å¨çæ¬æºåä½ä¹é´çåæ å¼ã

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>åæ°

*lpptlHimetric*<br/>
æååå«`POINTL`HIMETRIC åä½åæ çç»æçæéã

*lpptf å®¹å¨*<br/>
æå`POINTF`å®¹å¨åä½å¤§å°ä¸­åå«åæ çç»æçæéã

*flag*<br/>
ä»¥ä¸å¼çç»åï¼

- XFORMCOORDS_POSITIONå®¹å¨ä¸­çä½ç½®ã

- XFORMCOORDS_SIZE å®¹å¨ä¸­çå¤§å°ã

- XFORMCOORDS_HIMETRICTOCONTAINERå° HIMETRIC ååè½¬æ¢ä¸ºå®¹å¨çåä½ã

- XFORMCOORDS_CONTAINERTOHIMETRICå°å®¹å¨çåä½è½¬æ¢ä¸º HIMETRIC åä½ã

### <a name="remarks"></a>å¤æ³¨

åä¸¤ä¸ªæ å¿ï¼XFORMCOORDS_POSITIONåXFORMCOORDS_SIZEï¼æç¤ºåæ æ¯å¦åºè¢«è§ä¸ºä½ç½®æå¤§å°ã å¶ä½ä¸¤ä¸ªæ å¿æç¤ºè½¬æ¢æ¹åã

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControlï¼ç¿»è¯é¢è²

å°é¢è²å¼ä»OLE_COLORæ°æ®ç±»åè½¬æ¢ä¸º[COLORREF](/windows/win32/gdi/colorref)æ°æ®ç±»åã

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>åæ°

*clrColor*<br/>
OLE_COLORæ°æ®ç±»åã æå³è¯¦ç»ä¿¡æ¯ï¼è¯·åé Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)åè½ã

*èµ«å¸å°*<br/>
å¯éè°è²æ¿çå¥æ;å¯ä»¥æ¯ NULLã

### <a name="return-value"></a>è¿åå¼

RGBï¼çº¢è²ãç»¿è²ãèè²ï¼32 ä½é¢è²å¼ï¼ç¨äºå®ä¹ææ¥è¿è®¾å¤å¯ä»¥è¡¨ç¤ºç*clrColor*å¼ççº¯è²ã

### <a name="remarks"></a>å¤æ³¨

æ­¤åè½å¯ç¨äºå°åºå­ ForeColor å BackColor å±æ§è½¬æ¢ä¸º[CDC](../../mfc/reference/cdc-class.md)æåå½æ°ä½¿ç¨ç COLORREF ç±»åã

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COle æ§å¶ï¼å¨å è½½æé´ï¼ç¯å¢å°ææ

ç¡®å®æ§ä»¶æ¯å¦åºä½¿ç¨ç¯å¢å±æ§çå¼ä½ä¸ºé»è®¤å¼ï¼å½å®éåä»å¶æä¹ç¶æå è½½æ¶ã

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>è¿åå¼

éé¶è¡¨ç¤ºç¯å¢å±æ§å°ææ;å æ­¤ï¼è¡¨ç¤ºç¯å¢å±æ§å°ææãå¦åç¯å¢å±æ§å°æ æã

### <a name="remarks"></a>å¤æ³¨

å¨æäºå®¹å¨ä¸­ï¼æ§ä»¶å¨åå§è°ç¨`COleControl::DoPropExchange`éå æé´å¯è½æ æ³è®¿é®å¶ç¯å¢å±æ§ã å¦æå®¹å¨è°ç¨[IPersistStreamInitï¼ï¼å è½½](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)æ[IPersistStorageï¼ï¼å¨](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)è°ç¨[IOleObjectï¼ï¼setClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)ä¹åå è½½ï¼å³ï¼å¦æå®ä¸ç¬¦åOLEMISC_SETCLIENTSITEFIRSTç¶æä½ï¼ï¼åå±äºè¿ç§æåµã

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COle æ§å¶ï¼ï¼çªå£ Proc

ä¸º`COleControl`å¯¹è±¡æä¾ Windows è¿ç¨ã

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>åæ°

*message*<br/>
æå®è¦å¤çç Windows æ¶æ¯ã

*wParam*<br/>
æä¾ç¨äºå¤çæ¶æ¯çå¶ä»ä¿¡æ¯ã åæ°å¼åå³äºæ¶æ¯ã

*lParam*<br/>
æä¾ç¨äºå¤çæ¶æ¯çå¶ä»ä¿¡æ¯ã åæ°å¼åå³äºæ¶æ¯ã

### <a name="return-value"></a>è¿åå¼

è°åº¦æ¶æ¯çè¿åå¼ã

### <a name="remarks"></a>å¤æ³¨

è°ç¨æ­¤å½æ°éè¿æ§ä»¶çæ¶æ¯æ å°è°åº¦ç¹å®æ¶æ¯ã

## <a name="see-also"></a>è¯·åé

[MFC æ ·å CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC æ ·åæµè¯](../../overview/visual-cpp-samples.md)<br/>
[COleå±æ§é¡µç±»](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd ç±»](../../mfc/reference/cwnd-class.md)<br/>
[å±æ¬¡ç»æå¾è¡¨](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder ç±»](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder ç±»](../../mfc/reference/cpictureholder-class.md)<br/>
