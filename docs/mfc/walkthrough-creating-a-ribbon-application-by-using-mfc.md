---
title: "演练： 使用 MFC 创建功能区应用程序 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: C++
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
caps.latest.revision: "21"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: bfad78b64f72b9ee9a896832e008039aa241e2ef
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/21/2017
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>演练：使用 MFC 创建功能区应用程序
本演练演示如何使用**MFC 应用程序向导**创建默认情况下具有功能区的应用程序。 然后可以通过添加扩展功能区**自定义**具有的功能区类别**收藏夹**功能区面板中，并添加一些经常使用的命令到面板。  
  
## <a name="prerequisites"></a>系统必备  
 本演练假定您已设置了[!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)]使用**常规开发设置**。 如果您使用其他设置，则以下说明中引用的某些用户界面 (UI) 元素可能不会显示。 有关如何更改设置的信息，请参阅[如何： 重置您设置](http://msdn.microsoft.com/en-us/c95c51be-e609-4769-abba-65e6beedec76)。  
  
### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>创建带功能区的 MFC 应用程序  
  
1.  使用**MFC 应用程序向导**创建具有功能区的 MFC 应用程序。 若要运行该向导中，在**文件**菜单上，指向**新建**，然后单击**项目**。  
  
2.  在**新项目**对话框框中，展开**Visual c + +**节点下的**已安装的模板**，选择**MFC**，然后选择**MFC 应用程序**。 为项目键入名称，例如， `MFCRibbonApp`，然后单击**确定**。  
  
3.  第一页上**MFC 应用程序向导**，单击**下一步**。  
  
4.  上**应用程序类型**页上，在**视觉样式和颜色**，选择**Office 2007 （蓝色主题）**。 将其他设置保留不变。 单击 **“下一步”**。  
  
5.  上**复合文档支持**页上，请确保**无**已选择，然后单击**下一步**。  
  
6.  上**文档模板属性**页上，在**文件扩展名**框中，键入文件扩展名的文档的此应用程序创建，例如， `mfcrbnapp`。 单击 **“下一步”**。  
  
7.  上**数据库支持**页上，请确保**无**已选择，然后单击**下一步**。  
  
8.  上**用户界面功能**页上，请确保**使用功能区**选择。 单击 **“下一步”**。  
  
9. 默认情况下， **MFC 应用程序向导**增加了对多个停靠窗格支持。 由于本演练仅介绍功能区，因此您可以从应用程序中删除这些选项。 上**高级功能**页上，清除所有选项。 单击 **“下一步”**。  
  
10. 上**生成的类**页上，单击**完成**创建 MFC 应用程序。  
  
11. 若要验证应用程序是否已成功创建，请生成并运行它。 若要生成该应用程序，在**生成**菜单上，单击**生成解决方案**。 如果成功生成了应用程序，运行通过单击**启动调试**上**调试**菜单。  
  
     向导将自动创建具有名为的一个功能区类别的功能区**主页**。 此功能区包含三个功能区面板，分别名为**剪贴板**，**视图**，和**窗口**。  
  
### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>将类别和面板添加到功能区  
  
1.  若要打开该向导创建，在功能区资源**视图**菜单上，指向**其他窗口**，然后单击**资源视图**。 在**资源视图**，单击**功能区**然后双击**IDR_RIBBON**。  
  
2.  首先，向功能区添加自定义的类别，通过双击**类别**中**工具箱**。  
  
     具有标题的类别**Category1**创建。 默认情况下，该类别包含一个面板。  
  
     右键单击**Category1** ，然后单击**属性**。 在**属性**窗口中，更改**标题**到`Custom`。  
  
     **大型图像**和**小型图像**属性指定用作此类别中的功能区元素的图标的位图。 由于创建自定义位图超出了本演练的范围，请重新使用该向导创建的位图。 小型位图为 16 x 16 像素。 对于小型图像，请使用通过 IDB_FILESMALL 资源 ID 访问的位图。 大型位图为 32 x 32 像素。 对于大型图像，请使用通过 IDB_FILELARGE 资源 ID 访问的位图。  
  
    > [!NOTE]
    >  在每英寸像素数 (HDPI) 显示中，将自动使用图像的 HDPI 版本。  
  
3.  接下来，自定义面板。 面板用于对逻辑上相关的项进行分组。 例如，在**主页**选项卡的此应用程序，**剪切**，**复制**，和**粘贴**命令都位于**剪贴板**面板。 要自定义面板，请右键单击**Panel1** ，然后单击**属性**。 在**属性**窗口中，更改**标题**到`Favorites`。  
  
     你可以指定**映像索引**面板。 此数字指定如果功能区面板添加到显示的图标**快速访问工具栏**。 该图标不会显示在功能区面板上。  
  
4.  若要验证功能区类别和面板是否已成功创建，请预览此功能区控件。 上**功能区编辑器工具栏**，单击**测试功能区**按钮。 A**自定义**选项卡和**收藏夹**面板应显示在功能区。  
  
### <a name="to-add-elements-to-the-ribbon-panels"></a>将元素添加到功能区面板  
  
1.  将元素添加到你在前面的过程中创建的面板中，将控件从**功能区编辑器**部分**工具箱**到设计视图中的面板。  
  
2.  首先，添加**打印**按钮。 **打印**按钮都将具有包含子菜单**快速打印**命令通过使用默认打印机进行打印。 已为此应用程序定义所有这些命令。 它们位于应用程序菜单上。  
  
     若要创建**打印**按钮，将 Button 工具拖动到面板。  
  
     在**属性**窗口中，更改**ID**属性**ID_FILE_PRINT**，应已定义的。 更改**标题**到`Print`。 更改**图像索引**到`4`。  
  
     若要创建**快速打印**菜单上，单击属性值列旁边**菜单项**，然后单击省略号 (**...**).在**项编辑器**，单击未标记**添加**按钮创建菜单项。 在**属性**窗口中，更改**标题**到`Quick Print`， **ID**到`ID_FILE_PRINT_DIRECT`，和**映像**到`5`. 图像属性指定 IDB_FILESMALL 位图资源中的“快速打印”图标。  
  
3.  若要验证是否已将这些按钮添加到功能区面板，请生成并运行应用程序。 若要生成该应用程序，在**生成**菜单上，单击**生成解决方案**。 如果成功生成了应用程序，通过单击运行该应用程序**启动调试**上**调试**菜单。 **打印**按钮和组合框上**收藏夹**面板上**自定义**应显示在功能区上的选项卡。  
  
## <a name="next-steps"></a>后续步骤  
 [如何：自定义快速访问工具栏](../mfc/how-to-customize-the-quick-access-toolbar.md)  
  
 [如何：自定义应用程序按钮](../mfc/how-to-customize-the-application-button.md)  
  
 有关端到端示例，请参阅[示例 （MFC 功能包）](../visual-cpp-samples.md)。  
  
## <a name="see-also"></a>请参阅  
 [演练](../mfc/walkthroughs-mfc.md)   
 [示例 （MFC 功能包）](../visual-cpp-samples.md)

