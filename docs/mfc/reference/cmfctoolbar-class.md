---
title: "CMFCToolBar 类 |Microsoft 文档"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-cpp
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetIgnoreSetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBar class
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
caps.latest.revision: 48
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 0e0c08ddc57d437c51872b5186ae3fc983bb0199
ms.openlocfilehash: a34997b4b68ddcc8f42869466f17d67f32141d7c
ms.lasthandoff: 02/24/2017

---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 类
`CMFCToolBar`类类似于[CToolBar 类](../../mfc/reference/ctoolbar-class.md)，但用户界面功能为提供额外支持。 其中包括平面工具栏、有热图的工具栏、大图标、页导航按钮、锁定的工具栏、Rebar 控件、图像下的文本、背景图像和选项卡式工具栏。 `CMFCToolBar` 类还包含内置支持，用户可对工具栏和菜单、工具栏和菜单之间的拖放、组合框按钮、编辑框按钮、颜色选取器和汇总按钮进行自定义。  
  
## <a name="syntax"></a>语法  
  
```  
class CMFCToolBar : public CMFCBaseToolBar  
```  
  
## <a name="members"></a>成员  
  
### <a name="public-constructors"></a>公共构造函数  
  
|名称|说明|  
|----------|-----------------|  
|`CMFCToolBar::CMFCToolBar`|默认构造函数。|  
|`CMFCToolBar::~CMFCToolBar`|析构函数。|  
  
### <a name="public-methods"></a>公共方法  
  
|名称|说明|  
|----------|-----------------|  
|[CMFCToolBar::AddBasicCommand](#addbasiccommand)|将菜单命令添加到用户打开一个菜单时始终显示的命令的列表。|  
|[CMFCToolBar::AddCommandUsage](#addcommandusage)|一个与给定的命令相关联的计数器将增加。|  
|[CMFCToolBar::AddToolBarForImageCollection](#addtoolbarforimagecollection)|将图像从用户界面资源添加到应用程序中的图像集合。|  
|[CMFCToolBar::AdjustLayout](#adjustlayout)|重新计算的大小和工具栏的位置。 (重写[cbasepane:: Adjustlayout](../../mfc/reference/cbasepane-class.md#adjustlayout))。|  
|[CMFCToolBar::AdjustSize](#adjustsize)|重新计算工具栏的大小。|  
|[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)|指定是否可以在工具栏按钮上的图像下，显示的文本标签。|  
|[CMFCToolBar::AreTextLabels](#aretextlabels)|指定是否在工具栏按钮上当前显示在图像下的文本标签。|  
|[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)|启用或禁用的非活动状态的按钮图像的自动生成。|  
|[CMFCToolBar::ButtonToIndex](#buttontoindex)|返回指定的索引[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)此工具栏中的对象。|  
|[CMFCToolBar::CalcFixedLayout](#calcfixedlayout)|计算工具栏的水平大小。 (重写[cbasepane:: Calcfixedlayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout)。)|  
|[CMFCToolBar::CalcSize](#calcsize)|由框架作为布局计算过程的一部分调用。 (重写[CPane::CalcSize](../../mfc/reference/cpane-class.md#calcsize)。)|  
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|  
|[CMFCToolBar::CleanUpImages](#cleanupimages)|释放系统资源分配的工具栏图像。|  
|[CMFCToolBar::CleanUpLockedImages](#cleanuplockedimages)|释放锁定的工具栏图像的已分配的系统资源。|  
|[CMFCToolBar::CanBeClosed](#canbeclosed)|指定用户是否可以关闭工具栏。 (重写[CBasePane::CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed)。)|  
|[CMFCToolBar::CanBeRestored](#canberestored)|确定是否系统可以将工具栏恢复到其原始状态在自定义之后。|  
|[CMFCToolBar::CanFocus](#canfocus)|指定窗格中是否可以接收焦点。 (重写[CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)。)|  
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|确定工具栏和其同级是否定位在同一窗格上。|  
|[CMFCToolBar::CommandToIndex](#commandtoindex)|返回与指定的命令 ID 工具栏上的按钮索引|  
|[CMFCToolBar::Create](#create)|创建一个 `CMFCToolBar` 对象。|  
|[CMFCToolBar::CreateEx](#createex)|创建`CMFCToolBar`使用其他样式选项，如大图标的对象。|  
|[CMFCToolBar::Deactivate](#deactivate)|停用工具栏。|  
|[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)|启用或禁用**添加或删除按钮**显示在该工具栏末尾的按钮。|  
|[CMFCToolBar::EnableDocking](#enabledocking)|启用窗格中的停靠到主框架。 (重写[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)。)|  
|[CMFCToolBar::EnableLargeIcons](#enablelargeicons)|启用或禁用工具栏按钮上的大图标。|  
|[CMFCToolBar::EnableQuickCustomization](#enablequickcustomization)|启用或禁用工具栏的快速自定义，以便用户能够按**Alt**密钥并将按钮拖动到新位置。|  
|[CMFCToolBar::EnableReflections](#enablereflections)|启用或禁用命令反射。|  
|[CMFCToolBar::EnableTextLabels](#enabletextlabels)|启用或禁用工具栏按钮图像下的文本标签。|  
|[CMFCToolBar::FromHandlePermanent](#fromhandlepermanent)|检索一个指向`CMFCToolBar`对象，其中包含给定的窗口句柄。|  
|[CMFCToolBar::GetAllButtons](#getallbuttons)|在工具栏中返回按钮的只读的列表。|  
|[CMFCToolBar::GetAllToolbars](#getalltoolbars)|应用程序中返回所有工具栏的只读列表。|  
|[CMFCToolBar::GetBasicCommands](#getbasiccommands)|返回在应用程序中定义的基本命令的只读列表。|  
|[CMFCToolBar::GetButton](#getbutton)|返回一个指向`CMFCToolBarButton`具有指定的工具栏按钮索引对象。|  
|[CMFCToolBar::GetButtonInfo](#getbuttoninfo)|返回命令 ID、 样式和中指定索引处的按钮图像索引。|  
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|返回在工具栏上的每个按钮的尺寸。|  
|[CMFCToolBar::GetButtonStyle](#getbuttonstyle)|返回位于指定索引处的工具栏按钮的当前样式。|  
|[CMFCToolBar::GetButtonText](#getbuttontext)|返回具有指定的索引的按钮的文本标签。|  
|[CMFCToolBar::GetColdImages](#getcoldimages)|返回一个指向的应用程序中的冷工具栏按钮图像的集合。|  
|[CMFCToolBar::GetColumnWidth](#getcolumnwidth)|返回工具栏按钮的宽度。|  
|[CMFCToolBar::GetCommandButtons](#getcommandbuttons)|返回在应用程序中具有指定的命令 ID 从所有工具栏的按钮的列表。|  
|[CMFCToolBar::GetCount](#getcount)|返回在工具栏上的按钮和分隔符数。|  
|[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)|检索一个指向`CMFCCustomizeButton`与此工具栏相关联的对象。|  
|[CMFCToolBar::GetDefaultImage](#getdefaultimage)|返回与指定的命令 ID 的工具栏按钮的默认图像的索引|  
|[CMFCToolBar::GetDisabledImages](#getdisabledimages)|返回一个指向用于应用程序中的已禁用的工具栏按钮的图像集合。|  
|[CMFCToolBar::GetDisabledMenuImages](#getdisabledmenuimages)|返回一个指向用于在应用程序中的禁用的菜单按钮的图像集合。|  
|[CMFCToolBar::GetDroppedDownMenu](#getdroppeddownmenu)|检索指向当前显示它的子菜单的菜单按钮对象的指针。|  
|[CMFCToolBar::GetGrayDisabledButtons](#getgraydisabledbuttons)|指定的禁用的按钮的图像是否为灰色的常规按钮图像的版本，或者来自已禁用的按钮图像集合。|  
|[CMFCToolBar::GetHighlightedButton](#gethighlightedbutton)|返回一个指向当前突出显示的工具栏按钮。|  
|[CMFCToolBar::GetHotBorder](#gethotborder)|确定工具栏按钮是否热跟踪。|  
|[CMFCToolBar::GetHotTextColor](#gethottextcolor)|返回的突出显示的工具栏按钮的文本颜色。|  
|[CMFCToolBar::GetHwndLastFocus](#gethwndlastfocus)|返回之前工具栏上有输入的焦点的窗口的句柄。|  
|[CMFCToolBar::GetIgnoreSetText](#getignoresettext)|指定是否忽略调用以设置按钮的标签。|  
|[CMFCToolBar::GetImageSize](#getimagesize)|返回当前的工具栏按钮图像的大小。|  
|[CMFCToolBar::GetImages](#getimages)|返回一个指针，集合的默认按钮图像应用程序中。|  
|[CMFCToolBar::GetImagesOffset](#getimagesoffset)|返回用于查找此工具栏中的全局列表的工具栏按钮图像的工具栏按钮图像的索引偏移量。|  
|[CMFCToolBar::GetInvalidateItemRect](#getinvalidateitemrect)|检索为给定索引处的按钮必须重绘的客户端区域的区域。|  
|[CMFCToolBar::GetItemID](#getitemid)|返回指定索引处的工具栏按钮的命令 ID。|  
|[CMFCToolBar::GetItemRect](#getitemrect)|返回指定索引处的按钮的边框。|  
|[CMFCToolBar::GetLargeColdImages](#getlargecoldimages)|返回一个指向的应用程序中的大型冷工具栏按钮图像的集合。|  
|[CMFCToolBar::GetLargeDisabledImages](#getlargedisabledimages)|返回一个指向的应用程序中的已禁用的工具栏大按钮图像的集合。|  
|[CMFCToolBar::GetLargeImages](#getlargeimages)|返回一个指向的应用程序中的工具栏大按钮图像的集合。|  
|[CMFCToolBar::GetLockedColdImages](#getlockedcoldimages)|返回一个指向工具栏中的锁定冷图像集合。|  
|[CMFCToolBar::GetLockedDisabledImages](#getlockeddisabledimages)|返回一个指向工具栏中的锁定已禁用图像集合。|  
|[CMFCToolBar::GetLockedImages](#getlockedimages)|返回一个指向的工具栏中的锁定的按钮图像的集合。|  
|[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)|返回锁定的工具栏图像的默认的大小。|  
|[CMFCToolBar::GetLockedMenuImages](#getlockedmenuimages)|返回一个指向集合被锁定的工具栏菜单图像的工具栏中。|  
|[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)|返回在应用程序中的菜单按钮的大小。|  
|[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)|返回在应用程序中的菜单按钮图像的大小。|  
|[CMFCToolBar::GetMenuImages](#getmenuimages)|返回一个指向的应用程序中的菜单按钮图像的集合。|  
|[CMFCToolBar::GetOrigButtons](#getorigbuttons)|检索的非自定义按钮的工具栏上的集合。|  
|[CMFCToolBar::GetOrigResetButtons](#getorigresetbuttons)|检索的非自定义重置按钮的工具栏上的集合。|  
|[CMFCToolBar::GetResourceID](#getresourceid)|检索工具栏上的资源 ID。|  
|[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)|确定哪个对象的、 与父框架或所有者，将命令发送到工具栏。|  
|[CMFCToolBar::GetRowHeight](#getrowheight)|返回工具栏按钮的高度。|  
|[CMFCToolBar::GetShowTooltips](#getshowtooltips)|指定是否为工具栏按钮显示工具提示。|  
|[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)|检索工具栏的同级元素。|  
|[CMFCToolBar::GetUserImages](#getuserimages)|返回一个指向的应用程序中的用户定义的工具栏按钮图像的集合。|  
|[CMFCToolBar::HitTest](#hittest)|返回位于指定位置处的工具栏按钮的索引。|  
|[CMFCToolBar::InsertButton](#insertbutton)|插入到工具栏按钮。|  
|[CMFCToolBar::InsertSeparator](#insertseparator)|在工具栏中插入分隔符。|  
|[CMFCToolBar::InvalidateButton](#invalidatebutton)|使提供的索引处不存在的工具栏按钮的客户端区域无效。|  
|[CMFCToolBar::IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|确定用户是否可以添加或删除通过使用工具栏按钮**自定义**菜单选项。|  
|[CMFCToolBar::IsAltCustomizeMode](#isaltcustomizemode)|指定是否*快速自定义项目*用于将一个按钮。|  
|[CMFCToolBar::IsAutoGrayInactiveImages](#isautograyinactiveimages)|指定是否启用自动生成的非活动状态 （非突出显示） 按钮图像。|  
|[CMFCToolBar::IsBasicCommand](#isbasiccommand)|确定命令是否已启用的基本命令的列表。|  
|[CMFCToolBar::IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|确定工具栏上是否可以显示已扩展边框的按钮。|  
|[CMFCToolBar::IsButtonHighlighted](#isbuttonhighlighted)|确定工具栏上的按钮将突出显示。|  
|[CMFCToolBar::IsCommandPermitted](#iscommandpermitted)|确定是否允许命令。|  
|[CMFCToolBar::IsCommandRarelyUsed](#iscommandrarelyused)|确定命令是否很少使用 (请参阅[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions))。|  
|[CMFCToolBar::IsCustomizeMode](#iscustomizemode)|指定工具栏框架是否自定义模式。|  
|[CMFCToolBar::IsDragButton](#isdragbutton)|确定是否正在拖动的工具栏按钮。|  
|[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)|确定工具栏上是否包含**自定义**按钮。|  
|[CMFCToolBar::IsFloating](#isfloating)|确定是否浮动工具栏。|  
|[CMFCToolBar::IsLargeIcons](#islargeicons)|指定是否在应用程序中的工具栏当前显示大图标。|  
|[CMFCToolBar::IsLastCommandFromButton](#islastcommandfrombutton)|确定是否最近执行的命令从指定的工具栏按钮发送。|  
|[CMFCToolBar::IsLocked](#islocked)|确定工具栏上是否已锁定。|  
|[CMFCToolBar::IsOneRowWithSibling](#isonerowwithsibling)|确定是否在同一行上定位的工具栏按钮和其同级工具栏。|  
|[CMFCToolBar::IsUserDefined](#isuserdefined)|指定工具栏是用户定义。|  
|[CMFCToolBar::LoadBitmap](#loadbitmap)|从应用程序资源加载工具栏图像。|  
|[CMFCToolBar::LoadBitmapEx](#loadbitmapex)|从应用程序资源加载工具栏图像。 包括大型图像。|  
|[CMFCToolBar::LoadParameters](#loadparameters)|从 Windows 注册表加载全局工具栏选项。|  
|[CMFCToolBar::LoadState](#loadstate)|从 Windows 注册表中加载的工具栏上的状态信息。 (重写[CPane::LoadState](../../mfc/reference/cpane-class.md#loadstate)。)|  
|[CMFCToolBar::LoadToolBar](#loadtoolbar)|从应用程序资源加载工具栏。|  
|[CMFCToolBar::LoadToolBarEx](#loadtoolbarex)|通过使用从应用程序资源加载工具栏`CMFCToolBarInfo`帮助器类，以启用应用程序以使用大图像。|  
|[CMFCToolBar::OnChangeHot](#onchangehot)|在用户选择工具栏上的按钮时由框架调用。|  
|[CMFCToolBar::OnFillBackground](#onfillbackground)|由框架从调用[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)来填充工具栏背景。|  
|[CMFCToolBar::OnReset](#onreset)|将工具栏还原到其原始状态。|  
|[CMFCToolBar::OnSetAccData](#onsetaccdata)|(重写[CBasePane::OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata)。)|  
|[CMFCToolBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|还原为其默认状态的工具栏按钮的文本。|  
|`CMFCToolBar::OnUpdateCmdUI`|在内部使用。|  
|[CMFCToolBar::RemoveAllButtons](#removeallbuttons)|从工具栏中删除所有按钮。|  
|[CMFCToolBar::RemoveButton](#removebutton)|从工具栏中删除具有指定索引的按钮。|  
|[CMFCToolBar::RemoveStateFromRegistry](#removestatefromregistry)|从 Windows 注册表删除工具栏上的状态信息。|  
|[CMFCToolBar::ReplaceButton](#replacebutton)|工具栏按钮替换为另一个工具栏按钮。|  
|[CMFCToolBar::ResetAll](#resetall)|将所有工具栏都还原到其原始状态。|  
|[CMFCToolBar::ResetAllImages](#resetallimages)|清除所有应用程序中的工具栏图像集合。|  
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|还原工具栏的原始状态。|  
|[CMFCToolBar::SaveState](#savestate)|保存到 Windows 注册表中的工具栏上的状态信息。 (重写[CPane::SaveState](../../mfc/reference/cpane-class.md#savestate)。)|  
|`CMFCToolBar::Serialize`|（重写 `CBasePane::Serialize`。）|  
|[CMFCToolBar::SetBasicCommands](#setbasiccommands)|设置始终显示当用户打开一个菜单命令的列表。|  
|[CMFCToolBar::SetButtonInfo](#setbuttoninfo)|设置命令 ID、 样式和工具栏按钮的图像 ID。|  
|[CMFCToolBar::SetButtonStyle](#setbuttonstyle)|将工具栏按钮的样式设置给定索引处。|  
|[CMFCToolBar::SetButtonText](#setbuttontext)|设置工具栏按钮的文本标签。|  
|[CMFCToolBar::SetButtons](#setbuttons)|工具栏按钮设置。|  
|[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)|指定当很少使用的命令不会出现在应用程序菜单中。|  
|[CMFCToolBar::SetCustomizeMode](#setcustomizemode)|启用或禁用应用程序中的所有工具栏的自定义模式。|  
|[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)|指定是否禁用的按钮在工具栏上将变灰或已禁用的图像用于禁用的按钮。|  
|[CMFCToolBar::SetHeight](#setheight)|设置工具栏的高度。|  
|[CMFCToolBar::SetHotBorder](#sethotborder)|指定工具栏按钮是否热跟踪。|  
|[CMFCToolBar::SetHotTextColor](#sethottextcolor)|设置热键工具栏按钮的文本颜色。|  
|[CMFCToolBar::SetLargeIcons](#setlargeicons)|指定工具栏按钮是否显示大图标。|  
|[CMFCToolBar::SetLockedSizes](#setlockedsizes)|设置工具栏上的锁定的按钮和锁定的图像的大小。|  
|[CMFCToolBar::SetMenuSizes](#setmenusizes)|设置工具栏菜单按钮和其映像的大小。|  
|[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)|设置用户不能执行的命令的列表。|  
|[CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling)|工具栏和同级放置在同一行上。|  
|[CMFCToolBar::SetPermament](#setpermament)|指定用户是否可以关闭工具栏。|  
|[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)|指定是否与父框架或所有者将命令发送到工具栏。|  
|[CMFCToolBar::SetShowTooltips](#setshowtooltips)|指定框架是否显示工具提示。|  
|[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)|指定工具栏的同级元素。|  
|[CMFCToolBar::SetSizes](#setsizes)|指定所有工具栏按钮和图像的大小。|  
|[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)|在工具栏上指定的一个按钮的属性。|  
|[CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling)|工具栏和同级放置在单独的行上。|  
|[CMFCToolBar::SetUserImages](#setuserimages)|应用程序中设置的用户定义的图像的集合。|  
|[CMFCToolBar::StretchPane](#stretchpane)|垂直或水平伸缩工具栏。 (重写[CBasePane::StretchPane](../../mfc/reference/cbasepane-class.md#stretchpane)。)|  
|[CMFCToolBar::TranslateChar](#translatechar)|如果指定的键代码对应于有效的键盘快捷键，请执行按钮命令。|  
|[CMFCToolBar::UpdateButton](#updatebutton)|更新指定的按钮的状态。|  
|[CMFCToolBar::WrapToolBar](#wraptoolbar)|重新定位在给定维度中的工具栏按钮。|  
  
### <a name="protected-methods"></a>受保护的方法  
  
|名称|描述|  
|----------|-----------------|  
|[CMFCToolBar::AllowShowOnList](#allowshowonlist)|确定是否工具栏显示在列表中上**工具栏**窗格**自定义**对话框。|  
|[CMFCToolBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|计算一个按钮在工具栏中的最大高度。|  
|[CMFCToolBar::DoPaint](#dopaint)|重新绘制一个工具栏。|  
|[CMFCToolBar::DrawButton](#drawbutton)|重新绘制一个工具栏按钮。|  
|[CMFCToolBar::DrawSeparator](#drawseparator)|重新绘制工具栏上的分隔符。|  
|[CMFCToolBar::OnUserToolTip](#onusertooltip)|将会显示一个按钮的工具提示时，由框架调用。|  
  
### <a name="data-members"></a>数据成员  
  
|名称|说明|  
|----------|-----------------|  
|[CMFCToolBar::m_bDontScaleImages](#m_bdontscaleimages)|在高 DPI 模式下指定是扩展还是不的工具栏图像。|  
|[CMFCToolBar::m_dblLargeImageRatio](#m_dbllargeimageratio)|指定维度 （高度或宽度） 的图像的大小和维度的常规映像之间的比率。|  
  
## <a name="remarks"></a>备注  
 若要将合并`CMFCToolBar`对象合并到应用程序，请按照下列步骤︰  
  
1.  添加`CMFCToolBar`主框架窗口的对象。  
  
2.  当处理`WM_CREATE`主框架窗口的消息，请调用[CMFCToolBar::Create](#create)或[CMFCToolBar::CreateEx](#createex)以创建工具栏，并指定其样式。  
  
3.  调用[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)若要指定停靠样式。  
  
 若要插入的特殊按钮，如组合框或下拉工具栏中，保留在父级资源 dummy 按钮和虚拟按钮在运行时使用替换的[CMFCToolBar::ReplaceButton](#replacebutton)。 有关详细信息，请参阅[演练︰ 将控件在工具栏上](../walkthrough-putting-controls-on-toolbars.md)。  
  
 `CMFCToolBar`是的 MFC 库类的基类[CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)， [CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)，和[CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)。  
  
## <a name="example"></a>示例  
 下面的示例演示如何使用各种方法`CMFCToolBar`类。 该示例演示如何设置工具栏的窗口标签的文本、 设置边框、 将窗格中的样式设置和启用**添加或删除按钮**显示在该工具栏末尾的按钮。 此代码段属于[IE 演示示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_IEDemo #&6;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]  
[!code-cpp[NVC_MFC_IEDemo #&8;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]  
  
## <a name="requirements"></a>要求  
 **标头︰** afxtoolbar.h  
  
## <a name="inheritance-hierarchy"></a>继承层次结构  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CBasePane](../../mfc/reference/cbasepane-class.md)  
  
 [CPane](../../mfc/reference/cpane-class.md)  
  
 [CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)  
  
 `CMFCToolBar`  
  
##  <a name="addbasiccommand"></a>CMFCToolBar::AddBasicCommand  
 将菜单命令添加到用户打开一个菜单时始终显示的命令的列表。  
  
```  
static void __stdcall AddBasicCommand(UINT uiCmd);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 指定要添加的命令。  
  
### <a name="remarks"></a>备注  
 打开菜单时，始终显示基本的命令。 在用户选择要查看最近使用的命令时，此方法很有意义。  
  
 使用[CMFCToolBar::SetBasicCommands](#setbasiccommands)方法来设置当用户打开一个菜单始终显示的命令的列表。 使用[CMFCToolBar::GetBasicCommands](#getbasiccommands)方法来检索应用程序使用的基本命令列表。  
  
##  <a name="addcommandusage"></a>CMFCToolBar::AddCommandUsage  
 一个与给定的命令相关联的计数器将增加。  
  
```  
static void __stdcall AddCommandUsage(UINT uiCommand);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCommand`  
 指定命令计数器递增。  
  
### <a name="remarks"></a>备注  
 当用户选择菜单项时，框架将调用此方法。  
  
 框架将使用计数器来显示最近使用过的菜单项的命令。  
  
 此方法使命令计数器增加使用[CMFCCmdUsageCount::AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)方法。  
  
##  <a name="addtoolbarforimagecollection"></a>CMFCToolBar::AddToolBarForImageCollection  
 将图像从用户界面资源添加到应用程序中的图像集合。  
  
```  
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,  
    UINT uiBmpResID=0,  
    UINT uiColdResID=0,  
    UINT uiMenuResID=0,  
    UINT uiDisabledResID=0,  
    UINT uiMenuDisabledResID=0);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiResID`  
 资源 ID 加载一个带有图像的工具栏。  
  
 [in] `uiBmpResID`  
 资源 ID 的工具栏图像的位图。  
  
 [in] `uiColdResID`  
 使用"冷"的工具栏图像的位图的资源 ID。  
  
 [in] `uiMenuResID`  
 菜单图像的位图的资源 ID。  
  
 [in] `uiDisabledResID`  
 使用已禁用的工具栏图像的位图的资源 ID。  
  
 [in] `uiMenuDisabledResID`  
 使用禁用的菜单图像的位图的资源 ID。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果该方法成功。`FALSE`如果`uiResID`或`uiBmpResID`未指定有效的资源，或出现其他错误。  
  
### <a name="remarks"></a>备注  
 调用此方法加载的工具栏图像的位图，并将其添加到集合的工具栏图像。 此方法会创建临时工具栏对象并调用[CMFCToolBar::LoadToolBar](#loadtoolbar)。  
  
##  <a name="adjustlayout"></a>CMFCToolBar::AdjustLayout  
 重新计算的大小和工具栏的位置。  
  
```  
virtual void AdjustLayout();
```  
  
### <a name="remarks"></a>备注  
 在创建工具栏上，以便重新计算其大小和位置时调用此方法。  
  
 框架将调用此方法必须更改布局工具栏上的每次。 例如，当用户移动另一个控件条、 调整应用程序窗口中，或自定义工具栏，则必须将更改布局。  
  
 重写此方法以提供您自己在从派生类中的动态布局`CMFCToolbar`。  
  
##  <a name="adjustsize"></a>CMFCToolBar::AdjustSize  
 重新计算工具栏的大小。  
  
```  
void AdjustSize();
```  
  
### <a name="remarks"></a>备注  
 此方法可确保工具栏适合在与父框架的边界内。 如果该工具栏具有无父级框架，此方法执行任何操作。  
  
 [CMFCToolBar::AdjustLayout](#adjustlayout)方法调用此方法来重新计算该大小，如果工具栏的父级不是`CMFCReBar`对象。  
  
##  <a name="allowchangetextlabels"></a>CMFCToolBar::AllowChangeTextLabels  
 指定是否可以在工具栏按钮上的图像下，显示的文本标签。  
  
```  
virtual BOOL AllowChangeTextLabels() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果允许它显示的图像; 下的文本标签否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 这种方法称为自定义对话框中，以确定是否启用通过**显示的文本标签**上的复选框**工具栏**页上的为所选工具栏。  
  
 默认实现返回 `TRUE`。  
  
 重写此方法在一个对象派生自`CMFCToolBar`并返回`FALSE`在您不希望用户决定是否在图像下，工具栏按钮上显示的文本标签。  
  
##  <a name="allowshowonlist"></a>CMFCToolBar::AllowShowOnList  
 确定是否工具栏显示在列表中的工具栏上**工具栏**窗格**自定义**对话框。  
  
```  
virtual BOOL AllowShowOnList() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果可以在工具栏自定义页上; 列表框中显示工具栏对象否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 确定工具栏自定义页面上的列表是否应包含派生自某个特定对象的框架调用此方法`CMFCToolBar`。  
  
 默认实现始终返回`TRUE`。 如果不想要在自定义对话框中的工具栏列表中显示的工具栏，重写此方法。  
  
##  <a name="aretextlabels"></a>CMFCToolBar::AreTextLabels  
 指定是否在工具栏按钮上当前显示在图像下的文本标签。  
  
```  
BOOL AreTextLabels() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果工具栏按钮显示的图像; 下的文本标签否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 使用[CMFCToolBar::EnableTextLabels](#enabletextlabels)以指定是否显示文本。 默认值为 `FALSE`。 调用[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)来指定用户是否可以更改此设置在自定义对话框中。  
  
##  <a name="autograyinactiveimages"></a>CMFCToolBar::AutoGrayInactiveImages  
 启用或禁用的非活动状态的按钮图像的自动生成。  
  
```  
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,  
    int nGrayImagePercentage=0,  
    BOOL bRedrawAllToolbars=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 一个布尔值，该值指定是否 dim 处于非活动状态的图像。 如果此参数为`TRUE`，非活动状态的图像为灰显。 否则，非活动状态的图像未变暗。  
  
 [in] `nGrayImagePercentage`  
 指定处于非活动状态的图像的亮度百分比。 如果`bEnable`是`FALSE`，将忽略此值。  
  
 [in] `bRedrawAllToolbars`  
 一个布尔值，该值指定是否重绘应用程序中的所有工具栏。 如果此参数为`TRUE`，此方法将重新绘制所有工具栏。  
  
### <a name="remarks"></a>备注  
 如果`bEnable`是`TRUE`，框架将使用`nGrayImagePercentage`与常规映像生成非活动状态的图像。 否则，必须通过使用提供的非活动状态的图像集[CMFCToolBar::GetColdImages](#getcoldimages)方法。 默认情况下，禁用此选项。  
  
 有关详细信息`nGrayImagePercentage`参数，请参阅[CMFCToolBarImages::GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。  
  
##  <a name="buttontoindex"></a>CMFCToolBar::ButtonToIndex  
 返回指定的索引[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)此工具栏中的对象。  
  
```  
int ButtonToIndex(const CMFCToolBarButton* pButton) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 指向工具栏按钮对象的指针。  
  
### <a name="return-value"></a>返回值  
 索引的`pButton`工具栏按钮; 否则为-1 指定按钮不在此工具栏上的内部列表中。  
  
##  <a name="calcfixedlayout"></a>CMFCToolBar::CalcFixedLayout  
 计算工具栏的水平大小。  
  
```  
virtual CSize CalcFixedLayout(
    BOOL bStretch,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>参数  
 [in] `bStretch`  
 `TRUE`若要将拉伸为与父框架的大小的工具栏。  
  
 [in] `bHorz`  
 `TRUE`要方向工具栏的水平空间。`FALSE`要垂直方向的工具栏。  
  
### <a name="return-value"></a>返回值  
 一个`CSize`对象，它指定工具栏的大小。  
  
### <a name="remarks"></a>备注  
 此方法计算工具栏的大小，方法是使用`CMFCToolBar::CalcLayout`方法。 它将传递`LM_STRETCH`标记为可`dwMode`参数如果`bStretch`是`TRUE`。 它将传递`LM_HORZ`标志如果`bHorz`是`TRUE`。  
  
 请参阅 VisualStudioDemo 示例有关的示例，使用此方法。  
  
##  <a name="calcmaxbuttonheight"></a>CMFCToolBar::CalcMaxButtonHeight  
 计算按钮在工具栏中的最大高度。  
  
```  
virtual int CalcMaxButtonHeight();
```  
  
### <a name="return-value"></a>返回值  
 最大按钮的高度。  
  
### <a name="remarks"></a>备注  
 此方法计算在工具栏上的所有工具栏按钮之间的最大高度。 根据当前的工具栏停靠状态等因素，高度可能会有所不同。  
  
 重写此方法在派生类中的`CMFCToolBar`提供高度计算。  
  
##  <a name="calcsize"></a>CMFCToolBar::CalcSize  
 由框架作为布局计算过程的一部分调用。  
  
```  
virtual CSize CalcSize(BOOL bVertDock);
```  
  
### <a name="parameters"></a>参数  
 [in] `bVertDock`  
 `TRUE`若要指定垂直; 停靠工具栏`FALSE`指定水平停靠工具栏。  
  
### <a name="return-value"></a>返回值  
 一个`CSize`对象，它指定在工具栏上的按钮的总大小。  
  
### <a name="remarks"></a>备注  
 此方法将会影响每个按钮，如文本标签和边框大小的区域的大小的属性。  
  
 如果工具栏包含没有按钮，则此方法返回一个按钮的保留的大小使用[CMFCToolBar::GetButtonSize](#getbuttonsize)方法。  
  
##  <a name="canbeclosed"></a>CMFCToolBar::CanBeClosed  
 指定用户是否可以关闭工具栏。  
  
```  
virtual BOOL CanBeClosed() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果用户，则可以关闭工具栏否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 框架调用此方法以确定用户是否可以关闭一个工具栏。 如果该方法返回`TRUE`、 可以使用此框架中工具栏上的系统菜单上的 SC_CLOSE 命令和用户可以通过使用自定义对话框中的工具栏的列表中的复选框关闭工具栏。  
  
 默认实现返回 `TRUE`。 重写此方法在派生类中的`CMFCToolBar`以使用户不能关闭工具栏对象。  
  
##  <a name="canberestored"></a>CMFCToolBar::CanBeRestored  
 确定是否系统可以将工具栏恢复到其原始状态在自定义之后。  
  
```  
virtual BOOL CanBeRestored() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果可以从应用程序资源; 还原的工具栏否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 框架调用此方法以确定是否可以在自定义之后到其原始状态返回一个工具栏。 从应用程序资源加载的原始状态。  
  
 如果`CanBeRestored`返回`TRUE`、**工具栏**页面的自定义对话框中使**重置**为所选工具栏按钮。  
  
 默认实现返回`TRUE`如果已加载的工具栏的原始资源 ID 为非零值。 通常情况下，无法还原仅用户定义的工具栏。  
  
 您可以重写`CanBeRestored`方法以自定义该问题在派生类。  
  
##  <a name="canfocus"></a>CMFCToolBar::CanFocus  
 指定窗格中是否可以接收焦点。  
  
```  
virtual BOOL CanFocus() const;  
```  
  
### <a name="return-value"></a>返回值  
 此方法返回 `FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法重写基类实现[CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)，这是因为工具栏对象不能接收焦点。  
  
##  <a name="canhandlesiblings"></a>CMFCToolBar::CanHandleSiblings  
 确定工具栏和其同级是否定位在同一窗格上。  
  
```  
BOOL CanHandleSiblings();
```  
  
### <a name="return-value"></a>返回值  
 如果该工具栏具有同级，并且该工具栏及其同级位于同一窗格上，则为 `TRUE`；否则为 `FALSE`。  
  
### <a name="remarks"></a>备注  
 内部 CMFCCustomizeButton::CreatePopupMenu 方法会调用此方法以确定如何显示**自定义**弹出菜单。 如果此方法返回`TRUE`，框架显示**在一行上显示的按钮**或**分两个行显示按钮**按钮。  
  
 通常不需要使用此方法。 若要启用**自定义**按钮显示在工具栏上，调用[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)方法。 若要启用**在一行上显示的按钮**或**分两个行显示按钮**按钮，调用[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)。  
  
##  <a name="cleanupimages"></a>CMFCToolBar::CleanUpImages  
 释放系统资源分配的工具栏图像。  
  
```  
static void CMFCToolBar::CleanUpImages();
```  
  
### <a name="remarks"></a>备注  
 当应用程序关闭时，框架将调用此方法。  
  
##  <a name="cleanuplockedimages"></a>CMFCToolBar::CleanUpLockedImages  
 释放锁定的工具栏图像的已分配的系统资源。  
  
```  
void CleanUpLockedImages();
```  
  
### <a name="remarks"></a>备注  
 当您的应用程序的视觉样式更改时调用此方法。 请参阅 VisualStudioDemo 示例有关的示例，使用此方法。  
  
##  <a name="commandtoindex"></a>CMFCToolBar::CommandToIndex  
 返回与指定的命令 ID 工具栏上的按钮索引  
  
```  
int CommandToIndex(
    UINT nIDFind,  
    int iIndexFirst=0) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIDFind`  
 指定命令 id。  
  
 [in] `iIndexFirst`  
 指定初始从其开始的索引。  
  
### <a name="return-value"></a>返回值  
 如果此方法已成功，则工具栏按钮的从零开始的索引如果没有具有指定 ID 的按钮  
  
### <a name="remarks"></a>备注  
 一个`CMFCToolBar`对象维护的按钮在工具栏上的内部列表。 调用此函数可检索给定按钮的命令 ID 列表中的按钮的索引。  
  
 如果`iIndex`大于 0，此方法将忽略任何按钮在工具栏上的索引小于`iIndex`。  
  
##  <a name="create"></a>CMFCToolBar::Create  
 创建一个 `CMFCToolBar` 对象。  
  
```  
virtual BOOL Create(
    CWnd* pParentWnd,  
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,  
    UINT nID=AFX_IDW_TOOLBAR);
```  
  
### <a name="parameters"></a>参数  
 [in] `pParentWnd`  
 指向父窗口的工具栏上的指针。  
  
 [in] `dwStyle`  
 工具栏上的样式。 请参阅[工具栏控件和按钮样式](http://msdn.microsoft.com/library/windows/desktop/bb760439)中[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]样式的列表。  
  
 [in] `nID`  
 工具栏上的子窗口的 ID。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果此方法成功，则否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法创建的控件条，并将其附加到工具栏。 创建具有控件条`TBSTYLE_FLAT`样式。 调用[CMFCToolBar::CreateEx](#createex)如果您希望不同的控件栏样式。  
  
##  <a name="createex"></a>CMFCToolBar::CreateEx  
 创建`CMFCToolBar`使用其他样式选项，如大图标的对象。  
  
```  
virtual BOOL CreateEx(
    CWnd* pParentWnd,  
    DWORD dwCtrlStyle=TBSTYLE_FLAT,  
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,  
    CRect rcBorders=CRect(1,
    1,
    1,
    1),  
    UINT nID=AFX_IDW_TOOLBAR);
```  
  
### <a name="parameters"></a>参数  
 [in] `pParentWnd`  
 指向父窗口的工具栏上的指针。  
  
 [in] `dwCtrlStyle`  
 用于创建嵌入的控件条对象的其他样式。  
  
 [in] `dwStyle`  
 工具栏上的样式。 请参阅[工具栏控件和按钮样式](http://msdn.microsoft.com/library/windows/desktop/bb760439)有关相应的样式的列表。  
  
 [in] `rcBorders`  
 一个`CRect`对象，它指定工具栏窗口边框的宽度。  
  
 [in] `nID`  
 工具栏上的子窗口的 ID。  
  
### <a name="return-value"></a>返回值  
 如果此方法成功，则非零值否则为 0。  
  
### <a name="remarks"></a>备注  
 此方法创建的控件条，并将其附加到工具栏。  
  
 调用此方法，而不是[CMFCToolBar::Create](#create)时您想要提供特定样式。 例如，设置`dwCtrlStyle`到`TBSTYLE_FLAT | TBSTYLE_TRANSPARENT`以创建工具栏类似于使用的 Internet Explorer 4 的工具栏。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`CreateEx`方法`CMFCToolBar`类。 此代码段属于[IE 演示示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_IEDemo #&6;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]  
[!code-cpp[NVC_MFC_IEDemo #&7;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]  
  
##  <a name="deactivate"></a>CMFCToolBar::Deactivate  
 停用工具栏。  
  
```  
virtual void Deactivate();
```  
  
### <a name="remarks"></a>备注  
 此方法删除焦点从突出显示的工具栏按钮，将停用工具栏。 工具栏失去焦点或销毁时，框架将调用此方法。  
  
##  <a name="dopaint"></a>CMFCToolBar::DoPaint  
 重新绘制一个工具栏。  
  
```  
virtual void DoPaint(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 [in] `pDC`  
 一个指向设备上下文的指针。  
  
### <a name="remarks"></a>备注  
 在必须绘制工具栏的一部分时，将由框架调用此方法。  
  
 重写此方法以自定义一个对象派生自的外观`CMFCToolBar`。  
  
##  <a name="drawbutton"></a>CMFCToolBar::DrawButton  
 重新绘制一个工具栏按钮。  
  
```  
virtual BOOL DrawButton(
    CDC* pDC,  
    CMFCToolBarButton* pButton,  
    CMFCToolBarImages* pImages,  
    BOOL bHighlighted,  
    BOOL bDrawDisabledImages);
```  
  
### <a name="parameters"></a>参数  
 [in] `pDC`  
 一个指向设备上下文的指针。  
  
 [in] `pButton`  
 指向要绘制一个按钮的指针。  
  
 [in] `pImages`  
 指向工具栏图像的指针。  
  
 [in] `bHighlighted`  
 `TRUE`如果该按钮将突出显示;，否则为`FALSE`。  
  
 [in] `bDrawDisabledImages`  
 `TRUE`如果禁用的按钮将灰显;，否则为`FALSE`。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果已绘制按钮;`FALSE`如果按钮处于隐藏状态。  
  
### <a name="remarks"></a>备注  
 [CMFCToolBar::DrawButton](#drawbutton)方法时必须进行重新绘制一个工具栏按钮调用此方法。  
  
 如果您想要自定义工具栏上的按钮的外观，重写此方法。  
  
##  <a name="drawseparator"></a>CMFCToolBar::DrawSeparator  
 重新绘制工具栏上的分隔符。  
  
```  
virtual void DrawSeparator(
    CDC* pDC,  
    const CRect& rect,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>参数  
 [in] `pDC`  
 一个指向设备上下文的指针。  
  
 [in] `rect`  
 该分隔符在绘制，以像素为单位的位置的边框。  
  
 [in] `bHorz`  
 `TRUE`如果该分隔符是水平，`FALSE`如果是垂直的分隔符。  
  
### <a name="remarks"></a>备注  
 [CMFCToolBar::DoPaint](#dopaint)调用此方法为每个[CMFCToolBar::DrawSeparator](#drawseparator)对象，它具有`TBBS_SEPARATOR`样式，而不是调用[CMFCToolBar::DrawButton](#drawbutton)这些按钮。  
  
 重写此方法在派生类中的[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)自定义工具栏上的分隔符的外观。 默认实现调用[CMFCVisualManager::OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)来绘制其外观由当前的可视管理器的分隔符。  
  
##  <a name="enablecustomizebutton"></a>CMFCToolBar::EnableCustomizeButton  
 启用或禁用在工具栏显示的自定义按钮。  
  
```  
void EnableCustomizeButton(
    BOOL bEnable,  
    int iCustomizeCmd,  
    const CString& strCustomizeText,  
    BOOL bQuickCustomize=TRUE);

 
void EnableCustomizeButton(
    BOOL bEnable,  
    int iCustomizeCmd,  
    UINT uiCustomizeTextResId,  
    BOOL bQuickCustomize=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 启用或禁用自定义按钮。  
  
 [in] `iCustomizeCmd`  
 自定义按钮的命令 ID。  
  
 [in] `strCustomizeText`  
 自定义按钮的文本标签。  
  
 [in] `uiCustomizeTextResId`  
 资源字符串的 ID 的自定义按钮标签。  
  
 [in] `bQuickCustomize`  
 启用或禁用**添加或删除按钮**下拉从按钮的菜单上的选项。  
  
### <a name="remarks"></a>备注  
 如果`iCustomizeCmd`为-1，则此框架会显示自定义按钮的工具栏方面不适合多个工具栏按钮。 按钮显示 double 左向箭头或指示更多按钮的 v 形。  
  
 如果`iCustomizeCmd`指定一个有效的命令 ID，并`bEnable`是`TRUE`，始终显示自定义按钮。 按钮有一个较小，向下箭头，并打开一个包含命令菜单。 此命令使用指定的文本标签`strCustomizeText`。 如果`bQuickCustomize`也是`TRUE`，该菜单显示**添加或删除按钮**选项。  
  
 框架动态地添加到菜单在由指定的项之前的工具栏方面不适合任何按钮`iCustomizeCmd`。 旁边的向下箭头将显示 v 形图标。  
  
##  <a name="enabledocking"></a>CMFCToolBar::EnableDocking  
 启用窗格中的停靠到主框架。  
  
```  
virtual void EnableDocking(DWORD dwAlignment);
```  
  
### <a name="parameters"></a>参数  
 [in] `dwAlignment`  
 指定要启用的停靠对齐方式。  
  
### <a name="remarks"></a>备注  
 此方法会扩展的基类实现， [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)，通过设置`CBasePane::m_dwControlBarStyle`数据成员与`AFX_CBRS_FLOAT`。 然后，此方法将传递`dwAlignment`基类实现。  
  
##  <a name="enablelargeicons"></a>CMFCToolBar::EnableLargeIcons  
 启用或禁用工具栏按钮上的大图标。  
  
```  
void EnableLargeIcons(BOOL bEnable);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要启用大图标、`FALSE`禁用大图标。  
  
### <a name="remarks"></a>备注  
 默认情况下，启用了大图标。  
  
##  <a name="enablequickcustomization"></a>CMFCToolBar::EnableQuickCustomization  
 启用或禁用工具栏的快速自定义，以便用户能够按**Alt**密钥并将按钮拖动到新位置。  
  
```  
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要实现快速自定义、`FALSE`禁用快速自定义。  
  
##  <a name="enablereflections"></a>CMFCToolBar::EnableReflections  
 启用或禁用命令反射。  
  
```  
void EnableReflections(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bEnable`  
 `TRUE`若要启用命令反射;`FALSE`禁用命令反射。  
  
### <a name="remarks"></a>备注  
 调用此方法以允许对包含嵌入的控件，如组合框的工具栏按钮的命令反射。  
  
 有关命令反射的详细信息，请参阅[TN062: Windows 控件的消息反射](../../mfc/tn062-message-reflection-for-windows-controls.md)。  
  
##  <a name="enabletextlabels"></a>CMFCToolBar::EnableTextLabels  
 启用或禁用工具栏按钮图像下的文本标签。  
  
```  
void EnableTextLabels(BOOL bEnable=TRUE);
```  
  
### <a name="parameters"></a>参数  
 `bEnable`  
 `TRUE`如果文本标签会显示在工具栏按钮图像;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 如果启用了文本标签，在工具栏上的所有按钮都扩大以提供要在图像下，显示的标签的空间。 自定义对话框中有**显示文本标签**上的复选框**工具栏**页。 当用户选择一个工具栏，并检查此选项时，框架将调用`EnableTextLabels`为所选工具栏。 您可以禁用复选框，为一个对象派生自[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)通过返回`FALSE`从[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) 。  
  
##  <a name="fromhandlepermanent"></a>CMFCToolBar::FromHandlePermanent  
 检索一个指向`CMFCToolBar`对象，其中包含给定的窗口句柄。  
  
```  
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```  
  
### <a name="parameters"></a>参数  
 [in] `hwnd`  
 要查找的窗口句柄。  
  
### <a name="return-value"></a>返回值  
 一个指向`CMFCToolBar`对象，其中包含给定的窗口句柄，或`NULL`如果没有对应的`CMFCToolBar`对象存在。  
  
### <a name="remarks"></a>备注  
 此共享的方法检查每个应用程序中的工具栏`CMFCToolBar`对象，其中包含给定的窗口句柄。  
  
##  <a name="getallbuttons"></a>CMFCToolBar::GetAllButtons  
 在工具栏中返回按钮的只读的列表。  
  
```  
const CObList& GetAllButtons() const;  
```  
  
### <a name="return-value"></a>返回值  
 常量引用[CObList 类](../../mfc/reference/coblist-class.md)对象，其中包含一套[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)对象。  
  
##  <a name="getalltoolbars"></a>CMFCToolBar::GetAllToolbars  
 应用程序中返回所有工具栏的只读列表。  
  
```  
static const CObList& GetAllToolbars();
```  
  
### <a name="return-value"></a>返回值  
 常量引用[CObList 类](../../mfc/reference/coblist-class.md)对象，其中包含一套`CMFCToolBar`对象。  
  
##  <a name="getbasiccommands"></a>CMFCToolBar::GetBasicCommands  
 返回在应用程序中定义的基本命令的只读列表。  
  
```  
static const CList<UINT,UINT>& GetBasicCommands();
```  
  
### <a name="return-value"></a>返回值  
 常量引用[CList 类](../../mfc/reference/clist-class.md)对象，其中包含一组的基本命令。  
  
### <a name="remarks"></a>备注  
 通过调用将添加基本命令[CMFCToolBar::AddBasicCommand](#addbasiccommand)或[CMFCToolBar::SetBasicCommands](#setbasiccommands)。  
  
##  <a name="getbutton"></a>CMFCToolBar::GetButton  
 返回一个指向[CMFCToolBarButton 类](../../mfc/reference/cmfctoolbarbutton-class.md)中指定索引处的对象。  
  
```  
CMFCToolBarButton* GetButton(int iIndex) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `iIndex`  
 指定的索引返回按钮。  
  
### <a name="return-value"></a>返回值  
 指向如果存在，则工具栏按钮或`NULL`如果没有此类按钮。  
  
##  <a name="getbuttoninfo"></a>CMFCToolBar::GetButtonInfo  
 返回命令 ID、 样式和中指定索引处的按钮图像索引。  
  
```  
void GetButtonInfo(
    int nIndex,  
    UINT& nID,  
    UINT& nStyle,  
    int& iImage) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 在工具栏上的按钮列表中指定按钮的索引。  
  
 [out] `nID`  
 按钮的命令 ID。  
  
 [out] `nStyle`  
 按钮样式。  
  
 [out] `iImage`  
 按钮图像的索引。  
  
### <a name="remarks"></a>备注  
 `GetButtonInfo`方法查找指定索引处的工具栏按钮并检索按钮的命令 ID、 样式和图像索引。  
  
 如果不存在的指定索引处的按钮，框架会将设置`nID`和`nStyle`为 0，和`iImage`为当该方法返回-1。  
  
##  <a name="getbuttonsize"></a>CMFCToolBar::GetButtonSize  
 返回在工具栏上的每个按钮的尺寸。  
  
```  
CSize GetButtonSize() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个[CSize 类](../../atl-mfc-shared/reference/csize-class.md)对象，它指定在工具栏上的每个按钮的尺寸。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::SetSizes](#setsizes)或[CMFCToolBar::SetLockedSizes](#setlockedsizes)设置工具栏上的每个按钮的尺寸。  
  
##  <a name="getbuttonstyle"></a>CMFCToolBar::GetButtonStyle  
 返回位于指定索引处的工具栏按钮的当前样式。  
  
```  
UINT GetButtonStyle(int nIndex) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 指定工具栏按钮的索引。  
  
### <a name="return-value"></a>返回值  
 一个值，指定工具栏按钮的样式。 。 请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)有关可能的样式的列表。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::SetButtonStyle](#setbuttonstyle)若要将工具栏按钮样式设置  
  
##  <a name="getbuttontext"></a>CMFCToolBar::GetButtonText  
 返回具有指定的索引的按钮的文本标签。  
  
```  
CString GetButtonText(int nIndex) const;  
  
void GetButtonText(
    int nIndex,  
    CString& rString) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 工具栏按钮的索引。  
  
 [out] `rString`  
 工具栏按钮的标签文本。  
  
### <a name="return-value"></a>返回值  
 工具栏按钮的标签文本。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::SetButtonText](#setbuttontext)或[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)设置文本标签。  
  
##  <a name="getcoldimages"></a>CMFCToolBar::GetColdImages  
 返回一个指向的应用程序中的冷工具栏按钮图像的集合。  
  
```  
static CMFCToolBarImages* GetColdImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向冷工具栏按钮图像的集合。  
  
### <a name="remarks"></a>备注  
 冷映像是在用户未与工具栏按钮进行交互时使用的映像。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或[CMFCToolBar::LoadBitmap](#loadbitmap)加载冷的图像。  
  
##  <a name="getcolumnwidth"></a>CMFCToolBar::GetColumnWidth  
 返回工具栏按钮的宽度。  
  
```  
virtual int GetColumnWidth() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个值，指定工具栏按钮的宽度。  
  
### <a name="remarks"></a>备注  
 框架调用此方法以计算工具栏布局。 重写此方法在派生类，以指定您的工具栏上的不同的列宽度。  
  
##  <a name="getcommandbuttons"></a>CMFCToolBar::GetCommandButtons  
 返回在应用程序中具有指定的命令 ID 从所有工具栏的按钮的列表。  
  
```  
static int GetCommandButtons(
    UINT uiCmd,  
    CObList& listButtons);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 按钮的命令 ID。  
  
 [out] `listButtons`  
 对引用[CObList 类](../../mfc/reference/coblist-class.md)对象，它接收的工具栏按钮的列表。  
  
### <a name="return-value"></a>返回值  
 具有指定的命令 ID 的按钮数  
  
##  <a name="getcount"></a>CMFCToolBar::GetCount  
 返回在工具栏上的按钮和分隔符数。  
  
```  
int GetCount() const;  
```  
  
### <a name="return-value"></a>返回值  
 按钮和工具栏上的分隔符的数。  
  
##  <a name="getcustomizebutton"></a>CMFCToolBar::GetCustomizeButton  
 检索一个指向`CMFCCustomizeButton`与此工具栏相关联的对象。  
  
```  
CMFCCustomizeButton* GetCustomizeButton();
```  
  
### <a name="return-value"></a>返回值  
 一个指向`CMFCCustomizeButton`与此工具栏相关联的对象。  
  
### <a name="remarks"></a>备注  
 此方法检索**自定义**工具栏的结尾处将出现的按钮。 使用[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)方法将添加**自定义**在工具栏上的按钮。  
  
 您可以调用[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)方法，以确定工具栏上是否包含有效`CMFCCustomizeButton`对象。  
  
##  <a name="getdefaultimage"></a>CMFCToolBar::GetDefaultImage  
 返回与指定的命令 ID 的工具栏按钮的默认图像的索引  
  
```  
static int GetDefaultImage(UINT uiID);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiID`  
 指定按钮的命令 ID。  
  
### <a name="return-value"></a>返回值  
 在共享列表中的图像的工具栏图像的索引。  
  
### <a name="remarks"></a>备注  
 使用此共享的方法来检索与指定的命令 ID 的工具栏按钮的默认图像的索引 返回值是到共享集合的应用程序中的所有工具栏的工具栏按钮图像的索引。 调用[CMFCToolBar::GetImages](#getimages)方法来获取指向此集合的指针。  
  
##  <a name="getdisabledimages"></a>CMFCToolBar::GetDisabledImages  
 返回一个指向用于应用程序中的已禁用的工具栏按钮的图像集合。  
  
```  
static CMFCToolBarImages* __stdcall GetDisabledImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向已禁用的工具栏按钮图像的集合。  
  
### <a name="remarks"></a>备注  
 通过使用负载已禁用的工具栏按钮图像[CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md)和[CMFCToolBar::LoadBitmap](#loadbitmap)方法。  
  
##  <a name="getdisabledmenuimages"></a>CMFCToolBar::GetDisabledMenuImages  
 返回一个指向用于在应用程序中的禁用的菜单按钮的图像集合。  
  
```  
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向的禁用的菜单图像的集合。  
  
### <a name="remarks"></a>备注  
 通过使用负载已禁用的图像[CMFCToolBarEditBoxButton 类](../../mfc/reference/cmfctoolbareditboxbutton-class.md)方法。  
  
##  <a name="getdroppeddownmenu"></a>CMFCToolBar::GetDroppedDownMenu  
 检索指向当前显示它的子菜单的菜单按钮对象的指针。  
  
```  
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;  
```  
  
### <a name="parameters"></a>参数  
 [out] `pIndex`  
 在工具栏按钮的集合中得到的按钮索引。  
  
### <a name="return-value"></a>返回值  
 指向显示它的子菜单的菜单按钮对象的指针或`NULL`如果没有菜单显示它的子菜单。  
  
### <a name="remarks"></a>备注  
 如果此方法返回一个非`NULL`值和`pIndex`不是`NULL`，指向的值`pIndex`设置为菜单按钮在工具栏按钮的集合中的索引。  
  
##  <a name="getgraydisabledbuttons"></a>CMFCToolBar::GetGrayDisabledButtons  
 指定的禁用的按钮的图像是否为灰色的常规按钮图像的版本，或者来自已禁用的按钮图像集合。  
  
```  
BOOL GetGrayDisabledButtons() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`若要使变暗的禁用的按钮; 的映像`FALSE`从已禁用的图像集合中获取图像。  
  
### <a name="remarks"></a>备注  
 使用[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)灰显的图像和从集合中已禁用的图像的图像之间进行切换。  
  
##  <a name="gethighlightedbutton"></a>CMFCToolBar::GetHighlightedButton  
 返回一个指向当前突出显示的工具栏按钮。  
  
```  
CMFCToolBarButton* GetHighlightedButton() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个指向工具栏按钮对象;或`NULL`如果没有按钮将突出显示。  
  
### <a name="remarks"></a>备注  
 如果具有键盘焦点，则将突出显示的工具栏按钮。 工具栏按钮热跟踪此应用程序中的工具栏按钮是否也会突出显示 (有关详细信息，请参阅[CMFCToolBar::GetHotBorder](#gethotborder)和[CMFCToolBar::SetHotBorder](#sethotborder)) 和鼠标指向它时无工具栏按钮或菜单项具有键盘焦点。  
  
##  <a name="gethotborder"></a>CMFCToolBar::GetHotBorder  
 确定工具栏按钮是否*热跟踪*。 如果按钮是热跟踪，它将突出显示当鼠标移过它。  
  
```  
BOOL GetHotBorder() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果工具栏按钮是热跟踪;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 默认情况下，工具栏按钮是热跟踪。  
  
##  <a name="gethottextcolor"></a>CMFCToolBar::GetHotTextColor  
 返回的突出显示的工具栏按钮的文本颜色。  
  
```  
static COLORREF GetHotTextColor();
```  
  
### <a name="return-value"></a>返回值  
 一个[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)值，该值表示当前突出显示的文本颜色。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::SetHotTextColor](#sethottextcolor)若要设置新的文本颜色突出显示的工具栏按钮。  
  
##  <a name="gethwndlastfocus"></a>CMFCToolBar::GetHwndLastFocus  
 返回之前工具栏上有输入的焦点的窗口的句柄。  
  
```  
HWND GetHwndLastFocus() const;  
```  
  
### <a name="return-value"></a>返回值  
 不从派生的窗口的句柄[CMFCBaseToolBar 类](../../mfc/reference/cmfcbasetoolbar-class.md)，其中以前具有输入的焦点，则或`NULL`如果没有此类窗口。  
  
### <a name="remarks"></a>备注  
 当`CMFCToolBar`控件接收到输入的焦点，则将其存储以便稍后可以恢复失去焦点的窗口的句柄。  
  
##  <a name="getignoresettext"></a>CMFCToolBar::GetIgnoreSetText  
 指定是否忽略调用以设置按钮的标签。  
  
```  
BOOL GetIgnoreSetText() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果调用以设置按钮的标签将被忽略;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="getimages"></a>CMFCToolBar::GetImages  
 返回一个指针，集合的默认按钮图像应用程序中。  
  
```  
static CMFCToolBarImages* GetImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向[CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md)对象，其中包含适用于应用程序中的所有工具栏的默认图像的集合。  
  
### <a name="remarks"></a>备注  
 此共享的方法为应用程序提供对所有默认集合的访问的工具栏图像。 调用[CMFCToolBar::LoadBitmap](#loadbitmap)方法将图像添加到集合。  
  
##  <a name="getimagesize"></a>CMFCToolBar::GetImageSize  
 返回当前的工具栏按钮图像的大小。  
  
```  
CSize GetImageSize() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个[CSize 类](../../atl-mfc-shared/reference/csize-class.md)对象，表示当前的工具栏按钮图像的大小。  
  
##  <a name="getimagesoffset"></a>CMFCToolBar::GetImagesOffset  
 返回用于查找此工具栏中的全局列表的工具栏按钮图像的工具栏按钮图像的索引偏移量。  
  
```  
int GetImagesOffset() const;  
```  
  
### <a name="return-value"></a>返回值  
 工具栏图像索引偏移量。  
  
### <a name="remarks"></a>备注  
 工具栏上的所有默认映像都存储在全局[CMFCToolBarImages 类](../../mfc/reference/cmfctoolbarimages-class.md)列表。 为每个按钮在工具栏中的映像连续存储在该列表中。 若要计算的图像的索引，请与该工具栏按钮的图像列表的开头的偏移量工具栏中添加按钮的索引。  
  
 调用[CMFCToolBar::ButtonToIndex](#buttontoindex)若要获取按钮提供一个指向一个工具栏按钮的索引。  
  
 调用[CMFCToolBar::GetImages](#getimages)以获取指向的工具栏图像的集合。  
  
##  <a name="getinvalidateitemrect"></a>CMFCToolBar::GetInvalidateItemRect  
 检索为给定索引处的按钮必须重绘的客户端区域的区域。  
  
```  
virtual void GetInvalidateItemRect(
    int nIndex,  
    LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 若要检索的工作区的按钮的索引。  
  
 [out] `lpRect`  
 一个指向`RECT`对象，它接收客户端区域的区域。  
  
### <a name="remarks"></a>备注  
 `lpRect`参数不能`NULL`。 如果没有按钮处提供的索引不存在`lpRect`接收`RECT`将初始化为零的对象。  
  
##  <a name="getitemid"></a>CMFCToolBar::GetItemID  
 返回指定索引处的工具栏按钮的命令 ID。  
  
```  
UINT GetItemID(int nIndex) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 指定工具栏按钮的索引。  
  
### <a name="return-value"></a>返回值  
 命令 ID 的工具栏上的按钮;或者，如果不存在具有指定索引的按钮为零。  
  
##  <a name="getitemrect"></a>CMFCToolBar::GetItemRect  
 返回指定索引处的按钮的边框。  
  
```  
virtual void GetItemRect(
    int nIndex,  
    LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 指定工具栏按钮的索引。  
  
 [out] `lpRect`  
 一个指向`CRect`接收图像边界的矩形的坐标的对象。  
  
### <a name="remarks"></a>备注  
 `CRect`对象传递给该`lpRect`磅为单位设置为 0，如果不存在的指定索引处的按钮。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`GetItemRect`方法`CMFCToolBar`类。 此代码段属于[IE 演示示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_IEDemo #&6;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]  
[!code-cpp[NVC_MFC_IEDemo #&9;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]  
  
##  <a name="getlargecoldimages"></a>CMFCToolBar::GetLargeColdImages  
 返回一个指向的应用程序中的大型冷工具栏按钮图像的集合。  
  
```  
static CMFCToolBarImages* GetLargeColdImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向冷图像的大小的集合。  
  
### <a name="remarks"></a>备注  
 冷映像是在用户未与工具栏按钮进行交互时使用的映像。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)加载大型冷图像。  
  
##  <a name="getlargedisabledimages"></a>CMFCToolBar::GetLargeDisabledImages  
 返回一个指向的应用程序中的已禁用的工具栏大按钮图像的集合。  
  
```  
static CMFCToolBarImages* GetLargeDisabledImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向的大型禁用的工具栏按钮图像的集合。  
  
### <a name="remarks"></a>备注  
 图像的大小是正则工具栏按钮图像的大版本。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或[CMFCToolBar::LoadBitmap](#loadbitmap)加载大型图像。  
  
##  <a name="getlargeimages"></a>CMFCToolBar::GetLargeImages  
 返回一个指向的应用程序中的工具栏大按钮图像的集合。  
  
```  
static CMFCToolBarImages* GetLargeImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向的工具栏大按钮图像的集合。  
  
### <a name="remarks"></a>备注  
 图像的大小是正则工具栏按钮图像的大版本。 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)加载大型图像。  
  
##  <a name="getlockedcoldimages"></a>CMFCToolBar::GetLockedColdImages  
 返回一个指向工具栏中的锁定冷图像集合。  
  
```  
CMFCToolBarImages* GetLockedColdImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向锁定冷图像集合或`NULL`如果工具栏未被锁定。  
  
### <a name="remarks"></a>备注  
 锁定的映像是框架在用户不能自定义工具栏时使用正则工具栏按钮图像的版本。 冷映像是在用户未与工具栏按钮进行交互时使用的映像。  
  
 此方法返回`NULL`如果工具栏未被锁定。 如果此方法还生成断言失败在调试版本中未锁定的工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。  
  
 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法来加载这些锁定冷图像。  
  
##  <a name="getlockeddisabledimages"></a>CMFCToolBar::GetLockedDisabledImages  
 返回一个指向工具栏中的锁定已禁用图像集合。  
  
```  
CMFCToolBarImages* GetLockedDisabledImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向锁定已禁用图像集合或`NULL`如果工具栏未被锁定。  
  
### <a name="remarks"></a>备注  
 锁定的映像是框架在用户不能自定义工具栏时使用正则工具栏按钮图像的版本。 禁用的映像是在该框架时，所使用的按钮具有`TBBS_DISABLED`样式。  
  
 此方法返回`NULL`如果工具栏未被锁定。 如果此方法还生成断言失败在调试版本中未锁定的工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。  
  
 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以加载锁定禁用图像。  
  
##  <a name="getlockedimages"></a>CMFCToolBar::GetLockedImages  
 返回一个指向的工具栏中的锁定的按钮图像的集合。  
  
```  
CMFCToolBarImages* GetLockedImages();
```  
  
### <a name="return-value"></a>返回值  
 指向的锁定的工具栏按钮图像的集合的指针或`NULL`如果工具栏未被锁定。  
  
### <a name="remarks"></a>备注  
 锁定的映像是框架在用户不能自定义工具栏时使用正则工具栏按钮图像的版本。  
  
 此方法返回`NULL`如果工具栏未被锁定。 如果此方法还生成断言失败在调试版本中未锁定的工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。  
  
##  <a name="getlockedimagesize"></a>CMFCToolBar::GetLockedImageSize  
 返回锁定的工具栏图像的默认的大小。  
  
```  
CSize GetLockedImageSize() const;  
```  
  
### <a name="return-value"></a>返回值  
 一个`CSize`结构，它指定锁定的工具栏图像或一个空的大小`CSize`结构，如果未锁定的工具栏。  
  
### <a name="remarks"></a>备注  
 锁定的映像是框架在用户不能自定义工具栏时使用正则工具栏按钮图像的版本。  
  
 此方法返回`CSize`结构与零宽度和高度，如果未锁定的工具栏。 如果此方法还生成断言失败在调试版本中未锁定的工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。  
  
 调用[CMFCToolBar::SetLockedSizes](#setlockedsizes)方法，以指定的锁定的图像的大小。  
  
##  <a name="getlockedmenuimages"></a>CMFCToolBar::GetLockedMenuImages  
 返回一个指向集合被锁定的工具栏菜单图像的工具栏中。  
  
```  
CMFCToolBarImages* GetLockedMenuImages();
```  
  
### <a name="return-value"></a>返回值  
 指向已锁定的工具栏菜单图像的集合的指针或`NULL`如果工具栏未被锁定。  
  
### <a name="remarks"></a>备注  
 锁定的映像是框架在用户不能自定义工具栏时使用的正则工具栏菜单图像的版本。  
  
 此方法返回`NULL`如果工具栏未被锁定。 如果此方法还生成断言失败在调试版本中未锁定的工具栏。 有关锁定的工具栏的详细信息，请参阅[CMFCToolBar::IsLocked](#islocked)。  
  
 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法来加载这些锁定的菜单的图像。  
  
##  <a name="getmenubuttonsize"></a>CMFCToolBar::GetMenuButtonSize  
 返回在应用程序中的菜单按钮的大小。  
  
```  
static CSize GetMenuButtonSize();
```  
  
### <a name="return-value"></a>返回值  
 一个`CSize`对象，表示菜单按钮，以像素为单位的大小。  
  
### <a name="remarks"></a>备注  
 在工具栏上的菜单按钮的大小为全局变量维护，并可以通过此静态方法来检索。  
  
 调用[CMFCToolBar::SetMenuSizes](#setmenusizes)设置此全局变量。  
  
##  <a name="getmenuimages"></a>CMFCToolBar::GetMenuImages  
 返回一个指向的应用程序中的菜单按钮图像的集合。  
  
```  
static CMFCToolBarImages* GetMenuImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向的菜单图像的集合。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)加载菜单图像的方法。  
  
 调用[CMFCToolBar::SetMenuSizes](#setmenusizes)方法来设置按钮和其映像的大小。  
  
##  <a name="getmenuimagesize"></a>CMFCToolBar::GetMenuImageSize  
 返回在应用程序中的菜单按钮图像的大小。  
  
```  
static CSize GetMenuImageSize();
```  
  
### <a name="return-value"></a>返回值  
 一个`CSize`对象，表示的菜单图像大小。  
  
### <a name="remarks"></a>备注  
 此方法返回的全局变量作为维护的工具栏菜单按钮上的图像的大小。 调用[CMFCToolBar::SetMenuSizes](#setmenusizes)设置此全局变量。  
  
##  <a name="getorigbuttons"></a>CMFCToolBar::GetOrigButtons  
 检索的非自定义按钮的工具栏上的集合。  
  
```  
const CObList& GetOrigButtons() const;  
```  
  
### <a name="return-value"></a>返回值  
 对非自定义按钮的工具栏的列表中的引用。  
  
### <a name="remarks"></a>备注  
 由用户对其进行自定义之前，框架将创建一份工具栏按钮。 [CMFCToolBar::SetButtons](#setbuttons)方法将提供的数组中的每个按钮副本添加到原始的按钮的列表。 [CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)方法通过从资源文件加载还原工具栏的原始状态。  
  
 若要设置的原始按钮的工具栏上的列表，请调用[CMFCToolBar::SetOrigButtons](#setorigbuttons)方法。  
  
##  <a name="getorigresetbuttons"></a>CMFCToolBar::GetOrigResetButtons  
 检索的非自定义重置按钮的工具栏上的集合。  
  
```  
const CObList& GetOrigResetButtons() const;  
```  
  
### <a name="return-value"></a>返回值  
 对非自定义重置按钮工具栏的列表中的引用。  
  
### <a name="remarks"></a>备注  
 当用户单击**重置**按钮在自定义模式，该框架使用此方法来还原已删除从工具栏的按钮。  
  
 [CMFCToolBar::SetButtons](#setbuttons)方法将每个工具栏按钮的副本添加到原始重置按钮列表后，它调用[CMFCToolBar::OnReset](#onreset)方法。 您可以重写[CMFCToolBar::OnReset](#onreset)方法以自定义之后用户按下按钮的外观**重置**按钮。  
  
##  <a name="getresourceid"></a>CMFCToolBar::GetResourceID  
 检索工具栏上的资源 ID。  
  
```  
UINT GetResourceID() const;  
```  
  
### <a name="return-value"></a>返回值  
 工具栏上的资源 ID。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::LoadToolBarEx](#loadtoolbarex)方法来设置工具栏上的资源 ID。  
  
##  <a name="getroutecommandsviaframe"></a>CMFCToolBar::GetRouteCommandsViaFrame  
 确定哪个对象的、 与父框架或所有者，将命令发送到工具栏。  
  
```  
BOOL GetRouteCommandsViaFrame();
```  
  
### <a name="return-value"></a>返回值  
 非零，如果与父框架将命令发送到工具栏;如果所有者将命令发送到工具栏，则为 0。  
  
### <a name="remarks"></a>备注  
 默认情况下，父框架将命令发送到工具栏。 调用[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)来更改此行为。  
  
 如果此方法返回一个非零值，您可以使用检索到父框架对象的指针`CMFCToolBar::GetCommandTarget`方法。 请参阅 VisualStudioDemo 示例有关的示例，使用此方法。  
  
##  <a name="getrowheight"></a>CMFCToolBar::GetRowHeight  
 返回工具栏按钮的高度。  
  
```  
virtual int GetRowHeight() const;  
```  
  
### <a name="return-value"></a>返回值  
 工具栏按钮，以像素为单位的高度。  
  
### <a name="remarks"></a>备注  
 框架调用此方法以计算工具栏布局。 重写此方法在派生类来指定您的工具栏上的不同高度。  
  
##  <a name="getshowtooltips"></a>CMFCToolBar::GetShowTooltips  
 指定是否为工具栏按钮显示工具提示。  
  
```  
static BOOL GetShowTooltips();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果工具提示显示的工具栏按钮;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 默认情况下会显示工具提示。 您可以通过调用来更改此静态标志[CMFCToolBar::SetShowTooltips](#setshowtooltips)。  
  
##  <a name="getsiblingtoolbar"></a>CMFCToolBar::GetSiblingToolBar  
 检索工具栏的同级元素。  
  
```  
CMFCToolBar* GetSiblingToolBar();
```  
  
### <a name="return-value"></a>返回值  
 指向同级工具栏上的指针。  
  
### <a name="remarks"></a>备注  
 有关如何启用**在一行上显示的按钮**和**分两个行显示按钮**按钮，请参阅[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)。  
  
##  <a name="getuserimages"></a>CMFCToolBar::GetUserImages  
 返回一个指向的应用程序中的用户定义的工具栏按钮图像的集合。  
  
```  
static CMFCToolBarImages* GetUserImages();
```  
  
### <a name="return-value"></a>返回值  
 一个指向的应用程序中的所有工具栏的用户定义的工具栏按钮图像的集合。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::SetUserImages](#setuserimages)方法在应用程序中设置用户定义的图像集合。  
  
##  <a name="hittest"></a>CMFCToolBar::HitTest  
 返回位于指定位置处的工具栏按钮的索引。  
  
```  
virtual int HitTest(CPoint point);
```  
  
### <a name="parameters"></a>参数  
 [in] `point`  
 要在工作区坐标中测试的点。  
  
### <a name="return-value"></a>返回值  
 位于指定的位置，则为-1 如果没有此类按钮或按钮的索引是按钮的一个分隔符。  
  
##  <a name="insertbutton"></a>CMFCToolBar::InsertButton  
 插入到工具栏按钮。  
  
```  
virtual int InsertButton(
    const CMFCToolBarButton& button,  
    INT_PTR iInsertAt=-1);

 
virtual int InsertButton(
    CMFCToolBarButton* pButton,  
    int iInsertAt=-1);
```  
  
### <a name="parameters"></a>参数  
 [in] `button`  
 指定要插入的按钮。  
  
 [in] `iInsertAt`  
 指定要插入的按钮上的从零开始的位置。  
  
### <a name="return-value"></a>返回值  
 插入按钮或-1 如果检测到错误发生时的位置。  
  
### <a name="remarks"></a>备注  
 如果`iInsertAt`为-1，此方法将按钮添加到工具栏按钮的列表的末尾。  
  
 调用[CMFCToolBar::InsertSeparator](#insertseparator)方法来插入到工具栏的分隔符。  
  
##  <a name="insertseparator"></a>CMFCToolBar::InsertSeparator  
 在工具栏中插入分隔符。  
  
```  
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```  
  
### <a name="parameters"></a>参数  
 [in] `iInsertAt`  
 指定要插入的分隔符处的从零开始的位置。 此参数必须大于 0。  
  
### <a name="return-value"></a>返回值  
 插入分隔符或-1 如果检测到错误发生时的位置。  
  
### <a name="remarks"></a>备注  
 调用此方法以两个现有按钮之间插入分隔符。 如果`iInsertAt`为-1，此方法添加到工具栏按钮列表末尾的分隔符。  
  
 此方法不能用于添加到空的工具栏上的分隔。  
  
 调用[CMFCToolBar::InsertButton](#insertbutton)方法来插入到工具栏按钮。  
  
##  <a name="invalidatebutton"></a>CMFCToolBar::InvalidateButton  
 使提供的索引处不存在的工具栏按钮的客户端区域无效。  
  
```  
CMFCToolBarButton* InvalidateButton(int nIndex);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 在工具栏按钮的从零开始索引。  
  
### <a name="return-value"></a>返回值  
 一个指向`CMFCToolBarButton`提供的索引处不存在的对象或`NULL`如果不存在任何此类对象。  
  
### <a name="remarks"></a>备注  
 更新与工具栏按钮关联的工作区时，框架将调用此方法。 它将调用[CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect)方法的客户端矩形`CMFCToolBarButton`提供的索引处不存在的对象。  
  
##  <a name="isaddremovequickcustomize"></a>CMFCToolBar::IsAddRemoveQuickCustomize  
 确定用户是否可以添加或删除通过使用工具栏按钮**自定义**菜单选项。  
  
```  
BOOL IsAddRemoveQuickCustomize();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果用户可以使用**自定义**菜单选项来修改工具栏; 否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="isaltcustomizemode"></a>CMFCToolBar::IsAltCustomizeMode  
 指定是否*快速自定义项目*用于将一个按钮。 启用快速自定义项目后，用户可以按下并按住 Alt 键，将按钮拖动到新位置。  
  
```  
static BOOL __stdcall IsAltCustomizeMode();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果快速自定义用于将一个按钮;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="isautograyinactiveimages"></a>CMFCToolBar::IsAutoGrayInactiveImages  
 指定是否启用自动生成的非活动状态 （非突出显示） 按钮图像。  
  
```  
static BOOL IsAutoGrayInactiveImages();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果启用该选项自动变暗处于非活动状态的图像;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 您可以启用或禁用自动变暗的非活动状态的图像通过调用[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)。  
  
##  <a name="isbasiccommand"></a>CMFCToolBar::IsBasicCommand  
 确定命令是否已启用的基本命令的列表。  
  
```  
static BOOL IsBasicCommand(UINT uiCmd);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 指定要检查的命令。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果指定的命令所属的基本命令; 列表否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此静态方法确定该命令通过指定`uiCmd`属于基本命令的全局列表。 可以通过调用更改的基本命令列表[CMFCToolBar::AddBasicCommand](#addbasiccommand)或[CMFCToolBar::SetBasicCommands](#setbasiccommands)。  
  
##  <a name="isbuttonextrasizeavailable"></a>CMFCToolBar::IsButtonExtraSizeAvailable  
 确定工具栏上是否可以显示已扩展边框的按钮。  
  
```  
virtual BOOL IsButtonExtraSizeAvailable() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果在栏可以显示具有额外的边框大小; 的按钮否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 工具栏对象返回`TRUE`如果它可以显示已扩展边框的按钮。 工具栏按钮调用此方法在处理时[CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知会相应地设置其内部的额外边框大小标志。 通过调用可能以后检索此内部标志[CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)。  
  
 重写此方法在派生类中的`CMFCToolBar`并返回`TRUE`如果您的栏可以显示具有额外的边框大小的工具栏按钮，并返回`FALSE`否则为。 默认实现返回 `TRUE`。  
  
##  <a name="isbuttonhighlighted"></a>CMFCToolBar::IsButtonHighlighted  
 确定指定的按钮将突出显示。  
  
```  
BOOL IsButtonHighlighted(int iButton) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `iButton`  
 指定工具栏按钮的索引。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果指定的按钮将突出显示;，否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="iscommandpermitted"></a>CMFCToolBar::IsCommandPermitted  
 确定是否允许命令。  
  
```  
static BOOL IsCommandPermitted(UINT uiCmd);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 指定要检查的命令。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果允许指定的命令;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此静态方法确定该命令通过指定`uiCmd`属于不允许命令的全局列表。  
  
 您可以通过调用来更改不允许命令的列表[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)。  
  
##  <a name="iscommandrarelyused"></a>CMFCToolBar::IsCommandRarelyUsed  
 确定是否很少使用的命令。  
  
```  
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 指定要检查的命令。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果很少使用指定的命令;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 `IsCommandRarelyUsed`方法将返回`FALSE`时出现一个或多个以下条件︰  
  
-   指定的命令都属于基本命令的列表  
  
-   指定的命令是一个标准命令  
  
-   在框架手中自定义模式  
  
-   基本命令的列表为空  
  
-   超过 20%的命令调用是对指定命令的调用。  
  
##  <a name="iscustomizemode"></a>CMFCToolBar::IsCustomizeMode  
 指定工具栏框架是否自定义模式。  
  
```  
static BOOL IsCustomizeMode();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果框架是在自定义模式;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 您可以通过调用切换自定义模式[CMFCToolBar::SetCustomizeMode](#setcustomizemode)。  
  
 该框架会将模式进行了更改，当用户调用自定义对话框中 ( [CMFCToolBarsCustomizeDialog 类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md))。  
  
##  <a name="isdragbutton"></a>CMFCToolBar::IsDragButton  
 确定是否正在拖动的工具栏按钮。  
  
```  
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 为工具栏按钮的指针。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果指定的按钮进行拖动。否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
  
##  <a name="isexistcustomizebutton"></a>CMFCToolBar::IsExistCustomizeButton  
 确定工具栏上是否包含**自定义**按钮。  
  
```  
BOOL IsExistCustomizeButton();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果工具栏包含**自定义**按钮; 否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 如果此方法返回`TRUE`、 [CMFCToolBar::GetCustomizeButton](#getcustomizebutton)方法返回一个指向**自定义**工具栏的结尾处将出现的按钮。  
  
 使用[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)方法将添加**自定义**在工具栏上的按钮。  
  
##  <a name="isfloating"></a>CMFCToolBar::IsFloating  
 确定是否浮动工具栏。  
  
```  
virtual BOOL IsFloating() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果浮动工具栏。，否则为`FALSE`。  
  
##  <a name="islargeicons"></a>CMFCToolBar::IsLargeIcons  
 指定是否在应用程序中的工具栏当前显示大图标。  
  
```  
static BOOL IsLargeIcons();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果应用程序正在使用大图标;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 调用[CMFCToolBar::SetLargeIcons](#setlargeicons)大图标和常规图标之间进行切换。  
  
 当用户切换后，框架将自动更改模式**大图标**上的复选框**选项**页**自定义**对话框。  
  
##  <a name="islastcommandfrombutton"></a>CMFCToolBar::IsLastCommandFromButton  
 确定是否最近执行的命令从指定的工具栏按钮发送。  
  
```  
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 为按钮的指针。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果最后一个命令从按钮发送的`pButton`指定; 否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法获取指向的指针[MSG 结构](../../mfc/reference/msg-structure1.md)通过调用`CWnd::GetCurrentMessage`。 然后，它比较`HWND`与按钮的`MSG::lParam`和`MSG::hwnd`成员，若要确定按钮是否该命令的源。  
  
##  <a name="islocked"></a>CMFCToolBar::IsLocked  
 确定工具栏上是否已锁定。  
  
```  
BOOL IsLocked() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果工具栏处于锁定状态;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法返回`TRUE`时，用户无法执行自定义任务，例如重新定位工具栏按钮。  
  
 锁定的工具栏使用单独的图像列表。 有关这些图像列表的详细信息，请参阅[CMFCToolBar::LoadBitmapEx](#loadbitmapex)。  
  
##  <a name="isonerowwithsibling"></a>CMFCToolBar::IsOneRowWithSibling  
 确定是否在同一行上定位的工具栏按钮和其同级工具栏。  
  
```  
BOOL IsOneRowWithSibling();
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果工具栏及其同级定位在同一行;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 [CMFCCustomizeButton::CreatePopupMenu](http://msdn.microsoft.com/en-us/e501083e-f78e-4d8d-900c-40bd6e2bb7f8)方法调用此方法以确定如何显示**自定义**弹出菜单。 如果此方法返回`TRUE`，框架显示**在一行上显示的按钮**按钮。 否则，框架显示**分两个行显示按钮**按钮。  
  
 通常不需要使用此方法。 若要启用**在一行上显示的按钮**或**分两个行显示按钮**按钮，调用[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)。  
  
##  <a name="isresourcechanged"></a>CMFCToolBar::IsResourceChanged  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual BOOL IsResourceChanged() const;  
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="issibling"></a>CMFCToolBar::IsSibling  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
BOOL IsSibling();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="isuserdefined"></a>CMFCToolBar::IsUserDefined  
 指定工具栏是用户定义。  
  
```  
BOOL IsUserDefined() const;  
```  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果由用户; 创建工具栏否则为`FALSE`。  
  
##  <a name="loadbitmap"></a>CMFCToolBar::LoadBitmap  
 从应用程序资源加载工具栏图像。  
  
```  
virtual BOOL LoadBitmap(
    UINT uiResID,  
    UINT uiColdResID=0,  
    UINT uiMenuResID=0,  
    BOOL bLocked=FALSE,  
    UINT uiDisabledResID=0,  
    UINT uiMenuDisabledResID=0);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiResID`  
 用于引用热工具栏图像的位图的资源 ID。  
  
 [in] `uiColdResID`  
 用于引用冷工具栏图像的位图的资源 ID。  
  
 [in] `uiMenuResID`  
 用于引用常规菜单图像的位图的资源 ID。  
  
 [in] `bLocked`  
 `TRUE`若要锁定工具栏;否则为`FALSE`。  
  
 [in] `uiDisabledResID`  
 用于引用禁用工具栏图像的位图的资源 ID。  
  
 [in] `uiMenuDisabledResID`  
 用于引用禁用菜单图像的位图的资源 ID。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 [CMFCToolBar::LoadToolBarEx](#loadtoolbarex)方法调用此方法来加载与此工具栏相关联的图像。 重写此方法以执行图像资源的自定义加载。  
  
 调用 `LoadBitmapEx` 方法以在创建工具栏后加载其他图像。  
  
##  <a name="loadbitmapex"></a>CMFCToolBar::LoadBitmapEx  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,  
    BOOL bLocked = FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `params`  
 [in] `bLocked`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="loadlargeiconsstate"></a>CMFCToolBar::LoadLargeIconsState  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszProfileName`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="loadparameters"></a>CMFCToolBar::LoadParameters  
 从 Windows 注册表加载全局工具栏选项。  
  
```  
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszProfileName`  
 指定的 Windows 注册表项的相对路径。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 此方法加载全局参数，如菜单动画类型、 菜单阴影样式，以及是否显示为大图标从 Windows 注册表。  
  
 [CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)方法调用此方法作为应用程序的初始化过程的一部分。  
  
##  <a name="loadstate"></a>CMFCToolBar::LoadState  
 从 Windows 注册表中加载的工具栏上的状态信息。  
  
```  
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,  
    int nIndex=-1,  
    UINT uiID=(UINT)-1);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszProfileName`  
 指定的 Windows 注册表项的相对路径。  
  
 [in] `nIndex`  
 指定工具栏上的控件 ID。  
  
 [in] `uiID`  
 指定工具栏上的资源 ID。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 框架将调用此方法作为应用程序的初始化过程的一部分。 有关详细信息，请参阅[CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)。  
  
##  <a name="loadtoolbar"></a>CMFCToolBar::LoadToolBar  
 从应用程序资源加载工具栏。  
  
```  
virtual BOOL LoadToolBar(
    UINT uiResID,  
    UINT uiColdResID=0,  
    UINT uiMenuResID=0,  
    BOOL bLocked=FALSE,  
    UINT uiDisabledResID=0,  
    UINT uiMenuDisabledResID=0,  
    UINT uiHotResID=0);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiResID`  
 工具栏上的资源 ID。  
  
 [in] `uiColdResID`  
 用于引用冷工具栏图像的位图的资源 ID。  
  
 [in] `uiMenuResID`  
 用于引用常规菜单图像的位图的资源 ID。  
  
 [in] `bLocked`  
 一个布尔值，指定工具栏上是否处于锁定状态。 如果此参数为`TRUE`，工具栏处于锁定状态。 否则，未锁定的工具栏。  
  
 [in] `uiDisabledResID`  
 用于引用禁用工具栏图像的位图的资源 ID。  
  
 [in] `uiMenuDisabledResID`  
 用于引用禁用菜单图像的位图的资源 ID。  
  
 [in] `uiHotResID`  
 用于引用热工具栏图像的位图的资源 ID。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 在初始化加载与此工具栏相关联的映像过程，框架调用此方法。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`LoadToolBar`中的方法`CMFCToolBar`类。 此代码段属于[IE 演示示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_IEDemo #&6;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]  
[!code-cpp[NVC_MFC_IEDemo #&7;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]  
  
##  <a name="loadtoolbarex"></a>CMFCToolBar::LoadToolBarEx  
 通过使用从应用程序资源加载工具栏`CMFCToolBarInfo`帮助器类，以启用应用程序以使用大图像。  
  
```  
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,  
    CMFCToolBarInfo& params,  
    BOOL bLocked=FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiToolbarResID`  
 工具栏上的资源 ID。  
  
 [in] `params`  
 对引用`CMFCToolBarInfo`对象，包含工具栏图像的资源 Id。  
  
 [in] `bLocked`  
 一个布尔值，指定工具栏上是否处于锁定状态。 如果此参数为`TRUE`，工具栏处于锁定状态。 否则，未锁定的工具栏。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 调用此方法以从应用程序资源中加载的工具栏图像。  
  
##  <a name="m_dbllargeimageratio"></a>CMFCToolBar::m_dblLargeImageRatio  
 指定维度 （高度或宽度） 的图像的大小和维度的常规映像之间的比率。  
  
```  
AFX_IMPORT_DATA static double m_dblLargeImageRatio;  
```  
  
### <a name="remarks"></a>备注  
 默认比例为 2。 您可以更改此值可使大型的工具栏图像放大或缩小。  
  
 不指定一组大型图像时，框架将使用此数据成员。 例如，如果您只有较小的图像的集提供大小为 16 x 16 并想要具有大小 24 x 24 大型图像，则可设置为 1.5 此数据成员。  
  
##  <a name="nextmenu"></a>CMFCToolBar::NextMenu  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual BOOL NextMenu();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="onbeforeremovebutton"></a>CMFCToolBar::OnBeforeRemoveButton  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,  
    DROPEFFECT dropEffect);
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 未使用。  
  
 [in] `dropEffect`  
 未使用。  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="onchangehot"></a>CMFCToolBar::OnChangeHot  
 在用户选择工具栏上的按钮时由框架调用。  
  
```  
virtual void OnChangeHot(int iHot);
```  
  
### <a name="parameters"></a>参数  
 [in] `iHot`  
 指定处于选中状态，工具栏按钮的索引否则为-1 没有工具栏按钮处于选中状态。  
  
### <a name="remarks"></a>备注  
 重写此方法来处理通知用户选择工具栏上的按钮。  
  
##  <a name="onchangevisualmanager"></a>CMFCToolBar::OnChangeVisualManager  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual void OnChangeVisualManager();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="onfillbackground"></a>CMFCToolBar::OnFillBackground  
 由框架从调用[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)来填充工具栏背景。  
  
```  
virtual void OnFillBackground(CDC* pDC);
```  
  
### <a name="parameters"></a>参数  
 [in] `pDC`  
 一个指向设备上下文的指针。  
  
### <a name="remarks"></a>备注  
 [CMFCToolBar::DoPaint](#dopaint)已填充的工具栏背景时调用此方法。 默认实现不执行任何操作。  
  
 重写此方法在派生类中绘制自定义背景。  
  
##  <a name="onglobalfontschanged"></a>CMFCToolBar::OnGlobalFontsChanged  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual void OnGlobalFontsChanged();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="onreset"></a>CMFCToolBar::OnReset  
 将工具栏还原到其原始状态。  
  
```  
virtual void OnReset();
```  
  
### <a name="remarks"></a>备注  
 重写此方法以处理有关工具栏重置的通知。  
  
 默认实现不执行任何操作。 重写`OnReset`在派生类中`CMFCToolBar`时工具栏上的虚拟按钮，工具栏返回到其原始状态时，必须将其替换。  
  
##  <a name="onsetaccdata"></a>CMFCToolBar::OnSetAccData  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual BOOL OnSetAccData(long lVal);
```  
  
### <a name="parameters"></a>参数  
 [in] `lVal`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="onsetdefaultbuttontext"></a>CMFCToolBar::OnSetDefaultButtonText  
 还原为其默认状态的工具栏按钮的文本。  
  
```  
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 指向要设置其文本的按钮。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果文本已成功还原。否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 重写此方法来处理通知的工具栏按钮的文本被正在更改为其默认值。  
  
 默认实现将从应用程序资源加载一个按钮的文本。  
  
##  <a name="onusertooltip"></a>CMFCToolBar::OnUserToolTip  
 将会显示一个按钮的工具提示时，由框架调用。  
  
```  
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,  
    CString& strTTText) const;  
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 指向为其工具提示将用来显示一个工具栏按钮。  
  
 [out] `strTTText`  
 对引用`CString`接收工具提示文本的对象。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果`strTTText`填充了工具提示文本; 否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 要显示的工具栏按钮的工具提示时，框架将调用此方法。 如果`OnUserToolTip`返回`TRUE`，框架显示工具提示，其中包含返回的文本`OnUserToolTip`中`strTTText`。 否则，工具提示将包含按钮文本。  
  
 重写`OnUserToolTip`以自定义工具栏按钮的工具提示。 默认实现调用[CMFCToolBar::OnUserToolTip](#onusertooltip)若要获取的工具提示文本。  
  
##  <a name="prevmenu"></a>CMFCToolBar::PrevMenu  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual BOOL PrevMenu();
```  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="processcommand"></a>CMFCToolBar::ProcessCommand  
 文章`WM_COMMAND`拥有工具栏窗口的消息。  
  
```  
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```  
  
### <a name="parameters"></a>参数  
 [in] `pButton`  
 至一个按钮在工具栏上的指针。  
  
### <a name="return-value"></a>返回值  
 此方法应始终返回`TRUE`。 MFC 使用`FALSE`内部值。  
  
### <a name="remarks"></a>备注  
 此方法发布`WM_COMMAND`消息发送到通过调用拥有工具栏窗口[CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage)并传递为指定的按钮的命令 ID`wParam`参数。  
  
 使用[ON_COMMAND](http://msdn.microsoft.com/library/f24f8bda-2cf4-49d5-aa3d-6f2e6bb003f2)宏映射`WM_COMMAND`指向成员函数的消息。  
  
##  <a name="removeallbuttons"></a>CMFCToolBar::RemoveAllButtons  
 从工具栏中删除所有按钮和分隔符。  
  
```  
virtual void RemoveAllButtons();
```  
  
### <a name="remarks"></a>备注  
 在重新创建或销毁工具栏时，框架将调用此方法。  
  
##  <a name="removebutton"></a>CMFCToolBar::RemoveButton  
 从工具栏中删除具有指定的索引的按钮。  
  
```  
virtual BOOL RemoveButton(int iIndex);
```  
  
### <a name="parameters"></a>参数  
 [in] `iIndex`  
 指定删除按钮的从零开始索引。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果该方法成功，或`FALSE`如果指定的索引无效或索引引用**自定义**按钮。  
  
### <a name="remarks"></a>备注  
 此方法更新受按钮删除的其他工具栏属性。 例如，此方法从工具栏中删除不必要的分隔符，并重新生成的快捷键表。  
  
 有关详细信息**自定义**按钮，请参阅[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)。  
  
##  <a name="removestatefromregistry"></a>CMFCToolBar::RemoveStateFromRegistry  
 从 Windows 注册表删除工具栏上的状态信息。  
  
```  
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,  
    int nIndex=-1,  
    UINT uiID=(UINT)-1);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszProfileName`  
 指定的状态信息所在的位置的注册表项。  
  
 [in] `nIndex`  
 工具栏控件 ID。  
  
 [in] `uiID`  
 工具栏上的资源 ID。 如果此参数为-1，则此方法使用[CWnd::GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)方法来检索资源 id。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 当删除用户定义的工具栏时，框架将调用此方法。  
  
 如果将其他状态信息存储在 Windows 注册表，重写此方法。  
  
##  <a name="replacebutton"></a>CMFCToolBar::ReplaceButton  
 工具栏按钮替换为另一个工具栏按钮。  
  
```  
int ReplaceButton(
    UINT uiCmd,  
    const CMFCToolBarButton& button,  
    BOOL bAll=FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `uiCmd`  
 要替换按钮的命令 ID。  
  
 [in] `button`  
 对引用`CMFCToolBarButton`插入。  
  
 [in] `bAll`  
 一个布尔值，指定是否替换具有指定的命令 ID 的所有按钮`uiCmd`。 如果此参数为`TRUE`，替换具有指定的命令 ID 的所有按钮。 否则，将替换为第一个按钮。  
  
### <a name="return-value"></a>返回值  
 被替换的按钮数。 如果不存在一个具有指定的命令 ID 的按钮在工具栏上，此方法将返回 0。  
  
### <a name="remarks"></a>备注  
 如果想要添加无法从资源加载的工具栏按钮，调用此方法。 您可以在设计时创建占位符按钮并将该按钮替换为自定义按钮，当初始化工具栏时。 请参阅 VisualStudioDemo 示例有关的示例，使用此方法。  
  
### <a name="example"></a>示例  
 下面的示例演示如何使用`ReplaceButton`中的方法`CMFCToolBar`类。 此代码段属于[IE 演示示例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_IEDemo #&6;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]  
[!code-cpp[NVC_MFC_IEDemo #&10;](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]  
  
##  <a name="resetall"></a>CMFCToolBar::ResetAll  
 将所有工具栏都还原到其原始状态。  
  
```  
static void __stdcall ResetAll();
```  
  
### <a name="remarks"></a>备注  
 此方法调用[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)可以还原应用程序中的每个工具栏上的方法。 它使用[CMFCToolBar::CanBeRestored](#canberestored)方法，以确定是否可以还原一个工具栏。  
  
##  <a name="resetallimages"></a>CMFCToolBar::ResetAllImages  
 清除所有应用程序中的工具栏图像集合。  
  
```  
static void __stdcall ResetAllImages();
```  
  
### <a name="remarks"></a>备注  
 此方法清除由初始化的图像集合[CMFCToolBar::LoadToolBar](#loadtoolbar)和[CMFCToolBar::LoadBitmap](#loadbitmap)方法。  
  
##  <a name="resetimages"></a>CMFCToolBar::ResetImages  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual void ResetImages();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="restorefocus"></a>CMFCToolBar::RestoreFocus  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
virtual void RestoreFocus();
```  
  
### <a name="remarks"></a>备注  
  
##  <a name="restoreoriginalstate"></a>CMFCToolBar::RestoreOriginalState  
 还原工具栏的原始状态。  
  
```  
virtual BOOL RestoreOriginalState();
```  
  
### <a name="return-value"></a>返回值  
 如果方法成功，则为 `TRUE`；如果方法失败或工具栏是用户定义的，则为 `FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法使用从资源文件加载工具栏[CMFCToolBar::LoadToolBar](#loadtoolbar)方法。  
  
 框架将调用此方法，当用户选择**全部重置**按钮**工具栏**自定义对话框中的页。  
  
##  <a name="saveparameters"></a>CMFCToolBar::SaveParameters  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszProfileName`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="savestate"></a>CMFCToolBar::SaveState  
 保存到 Windows 注册表中的工具栏上的状态信息。  
  
```  
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,  
    int nIndex=-1,  
    UINT uiID=(UINT)-1);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpszProfileName`  
 指定的 Windows 注册表项的相对路径。  
  
 [in] `nIndex`  
 工具栏控件 ID。  
  
 [in] `uiID`  
 工具栏上的资源 ID。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 它将应用程序状态保存到注册表时，框架将调用此方法。 有关详细信息，请参阅[CWinAppEx::SaveState](../../mfc/reference/cwinappex-class.md#savestate)。  
  
##  <a name="setbasiccommands"></a>CMFCToolBar::SetBasicCommands  
 设置始终显示当用户打开一个菜单命令的列表。  
  
```  
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```  
  
### <a name="parameters"></a>参数  
 [in] `lstCommands`  
 对引用`CList`对象，其中包含一组的命令。  
  
### <a name="remarks"></a>备注  
 打开菜单时，始终显示基本的命令。 在用户选择要查看最近使用的命令时，此方法很有意义。  
  
 使用[CMFCToolBar::AddBasicCommand](#addbasiccommand)方法，以将命令添加到基本命令的列表。 使用[CMFCToolBar::GetBasicCommands](#getbasiccommands)方法来检索应用程序使用的基本命令列表。  
  
 请参阅使用此方法的示例，资源管理器示例。  
  
##  <a name="setbuttoninfo"></a>CMFCToolBar::SetButtonInfo  
 设置命令 ID、 样式和工具栏按钮的图像 ID。  
  
```  
void SetButtonInfo(
    int nIndex,  
    UINT nID,  
    UINT nStyle,  
    int iImage);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 其属性设置按钮的从零开始索引。  
  
 [in] `nID`  
 按钮的命令 ID。  
  
 [in] `nStyle`  
 按钮样式。 请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)有关可用工具栏按钮样式的列表。  
  
 [in] `iImage`  
 按钮 （也就是说，集合中的工具栏图像的索引） 的从零开始的图像索引。  
  
### <a name="remarks"></a>备注  
 调用此方法以设置工具栏按钮的属性。  
  
 在调试版本中，如果此方法生成断言失败由指定的索引`nIndex`无效。  
  
 调用[CMFCToolBar::SetButtonStyle](#setbuttonstyle)方法来设置按钮的样式。  
  
##  <a name="setbuttons"></a>CMFCToolBar::SetButtons  
 工具栏按钮设置。  
  
```  
virtual BOOL SetButtons(
    const UINT* lpIDArray,  
    int nIDCount,  
    BOOL bRemapImages=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `lpIDArray`  
 指向的按钮的命令 Id，要插入数组的指针。  
  
 [in] `nIDCount`  
 中的项数`lpIDArray`。  
  
 [in] `bRemapImages`  
 一个布尔值，该值指定是否将现有的按钮图像与插入按钮相关联。 如果此参数为`TRUE`，图像将重新映射。  
  
### <a name="return-value"></a>返回值  
 如果该方法成功，则为非零；否则为零。  
  
### <a name="remarks"></a>备注  
 调用此方法以从工具栏中删除现有的按钮和插入新按钮的集合。  
  
 此方法将添加**自定义**按钮的工具栏和发送`AFX_WM_RESETTOOLBAR`向父窗口的工具栏上的消息。 有关详细信息**自定义**按钮，请参阅[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)。  
  
##  <a name="setbuttonstyle"></a>CMFCToolBar::SetButtonStyle  
 将工具栏按钮的样式设置给定索引处。  
  
```  
virtual void SetButtonStyle(
    int nIndex,  
    UINT nStyle);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 设置其样式是工具栏按钮的从零开始的索引。  
  
 [in] `nStyle`  
 按钮样式。 请参阅[工具栏控件样式](../../mfc/reference/toolbar-control-styles.md)有关可用工具栏按钮样式的列表。  
  
### <a name="remarks"></a>备注  
 此方法移除`TBBS_PRESSED`，如样式`nStyle`是`TBBS_DISABLED`因为用户不能单击已禁用的按钮。  
  
##  <a name="setbuttontext"></a>CMFCToolBar::SetButtonText  
 设置工具栏按钮的文本标签。  
  
```  
BOOL SetButtonText(
    int nIndex,  
    LPCTSTR lpszText);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 工具栏按钮的索引。  
  
 [in] `lpszText`  
 工具栏按钮的文本标签。 必须为非`NULL`。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果该方法成功。否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法返回`FALSE`如果提供的索引不是指一个有效的工具栏按钮。  
  
##  <a name="setcommandusageoptions"></a>CMFCToolBar::SetCommandUsageOptions  
 指定当很少使用的命令不会出现在应用程序菜单中。  
  
```  
static BOOL SetCommandUsageOptions(
    UINT nStartCount,  
    UINT nMinUsagePercentage=5);
```  
  
### <a name="parameters"></a>参数  
 [in] `nStartCount`  
 指定框架显示只有基本和最近使用过的命令之前，必须执行的命令的次数。  
  
 [in] `nMinUsagePercentage`  
 必须执行命令视为最近使用过的命令的时间的百分比。  
  
### <a name="return-value"></a>返回值  
 `FALSE`如果`nMinUsagePercentage`等于或大于 100; 否则为`TRUE`。  
  
### <a name="remarks"></a>备注  
 调用此方法以自定义框架使用它们来确定如何基本和最近使用的菜单项显示的算法。 有关基本命令的详细信息，请参阅[CMFCToolBar::AddBasicCommand](#addbasiccommand)。  
  
 此类使用`CMFCCmdUsageCount`类用于跟踪命令的使用计数。 有关此类的详细信息，请参阅[CMFCCmdUsageCount 类](../../mfc/reference/cmfccmdusagecount-class.md)。  
  
##  <a name="setcustomizemode"></a>CMFCToolBar::SetCustomizeMode  
 启用或禁用应用程序中的所有工具栏的自定义模式。  
  
```  
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bSet`  
 一个布尔值，该值指定是否要启用或禁用自定义模式。 此参数设置为`TRUE`若要启用自定义模式或`FALSE`以将其禁用。  
  
### <a name="return-value"></a>返回值  
 `TRUE`如果调用此方法将更改自定义模式;否则为`FALSE`。  
  
### <a name="remarks"></a>备注  
 此方法调整的布局，并在应用程序将重新绘制每一个工具栏。 调用[CMFCToolBar::IsCustomizeMode](#iscustomizemode)方法，以确定应用程序是否在自定义模式下，  
  
##  <a name="setgraydisabledbuttons"></a>CMFCToolBar::SetGrayDisabledButtons  
 指定是否不可用按钮在工具栏上显示为灰色，或是否使用按钮不可用的映像。  
  
```  
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```  
  
### <a name="parameters"></a>参数  
 [in] `bGrayDisabledButtons`  
 一个布尔值，指定如何显示无法使用的按钮。 如果此参数为`TRUE`，框架会使这些按钮变暗。 否则，框架将使用按钮不可用的图像的集合。  
  
### <a name="remarks"></a>备注  
 默认情况下，无法使用的按钮将灰显。  
  
##  <a name="setheight"></a>CMFCToolBar::SetHeight  
 设置工具栏的高度。  
  
```  
void SetHeight(int cyHeight);
```  
  
### <a name="parameters"></a>参数  
 [in] `cyHeight`  
 工具栏上，以像素为单位的高度。  
  
### <a name="remarks"></a>备注  
 此方法重绘工具栏上之后设置的高度。  
  
##  <a name="sethelpmode"></a>CMFCToolBar::SetHelpMode  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bOn`  
  
### <a name="remarks"></a>备注  
  
##  <a name="sethot"></a>CMFCToolBar::SetHot  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```  
  
### <a name="parameters"></a>参数  
 [in] `pMenuButton`  
  
### <a name="return-value"></a>返回值  
  
### <a name="remarks"></a>备注  
  
##  <a name="sethotborder"></a>CMFCToolBar::SetHotBorder  
 指定工具栏按钮是否热跟踪。  
  
```  
void SetHotBorder(BOOL bShowHotBorder);
```  
  
### <a name="parameters"></a>参数  
 [in] `bShowHotBorder`  
 一个布尔值，该值指定是否热跟踪工具栏按钮。 如果此参数为`TRUE`，工具栏热跟踪其按钮。 否则为工具栏不会不热跟踪其按钮。  
  
### <a name="remarks"></a>备注  
 如果按钮是热跟踪，该框架突出显示该按钮，当鼠标移过它。 默认情况下，每个工具栏热跟踪其按钮。  
  
 调用[CMFCToolBar::GetHotBorder](#gethotborder)方法，以确定是否工具栏热跟踪其按钮。  
  
##  <a name="sethottextcolor"></a>CMFCToolBar::SetHotTextColor  
 设置热键工具栏按钮的文本颜色。  
  
```  
static void SetHotTextColor(COLORREF clrText);
```  
  
### <a name="parameters"></a>参数  
 [in] `clrText`  
 指定工具栏按钮的热跟踪的文本颜色。  
  
### <a name="remarks"></a>备注  
 热跟踪工具栏按钮的详细信息，请参阅[CMFCToolBar::GetHotBorder](#gethotborder)和[CMFCToolBar::SetHotBorder](#sethotborder)。  
  
##  <a name="setignoresettext"></a>CMFCToolBar::SetIgnoreSetText  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
void SetIgnoreSetText(BOOL bValue);
```  
  
### <a name="parameters"></a>参数  
 [in] `bValue`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setlargeicons"></a>CMFCToolBar::SetLargeIcons  
 指定工具栏按钮是否显示大图标。  
  
```  
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bLargeIcons`  
 一个布尔值，指定要使用的图标。 如果此参数为`TRUE`，框架显示大图标。 否则，框架显示普通图标。  
  
### <a name="remarks"></a>备注  
 当用户更改的状态时，框架将调用此方法**大图标**中的复选框**选项**的选项卡上**自定义**对话框。 此方法调整应用程序中的所有工具栏的都大小。  
  
 默认情况下，框架显示普通图标。  
  
 有关详细信息**自定义**对话框中，请参阅[CMFCToolBarsCustomizeDialog 类](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。  
  
##  <a name="setlockedsizes"></a>CMFCToolBar::SetLockedSizes  
 设置工具栏上的锁定的按钮和锁定的图像的大小。  
  
```  
void SetLockedSizes(
    SIZE sizeButton,  
    SIZE sizeImage,  
    BOOL bDontScale = FALSE);
```  
  
### <a name="parameters"></a>参数  
 [in] `sizeButton`  
 指定锁定的工具栏按钮的大小。  
  
 [in] `sizeImage`  
 指定的锁定的工具栏图像的大小。  
  
 `bDontScale`  
 指定是否要缩放或未锁定的工具栏图像在高 DPI 模式下。  
  
### <a name="remarks"></a>备注  
 锁定按钮的默认大小为 23 x 22 像素。 锁定的图像的默认大小为 16x15 像素。  
  
 调用[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)方法来检索的大小被锁定的图像。 调用[CMFCToolBar::GetButtonSize](#getbuttonsize)方法来检索的大小被锁定的工具栏按钮。  
  
##  <a name="setmaskmode"></a>CMFCToolBar::SetMaskMode  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
void SetMaskMode(BOOL bMasked);
```  
  
### <a name="parameters"></a>参数  
 [in] `bMasked`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setmenusizes"></a>CMFCToolBar::SetMenuSizes  
 设置工具栏菜单按钮和其映像的大小。  
  
```  
static void __stdcall SetMenuSizes(
    SIZE sizeButton,  
    SIZE sizeImage);
```  
  
### <a name="parameters"></a>参数  
 [in] `sizeButton`  
 以像素为单位指定工具栏按钮的大小。  
  
 [in] `sizeImage`  
 以像素为单位指定的工具栏图像的大小。  
  
### <a name="remarks"></a>备注  
 默认情况下，菜单按钮和其映像具有未定义的大小。  
  
 调用[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)方法，以确定菜单按钮的大小和[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)方法来确定的菜单按钮图像的大小。  
  
 请参阅有关示例，请使用此方法的 IEDemo 和 MSMoneyDemo 示例。  
  
##  <a name="setnonpermittedcommands"></a>CMFCToolBar::SetNonPermittedCommands  
 设置用户不能执行的命令的列表。  
  
```  
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```  
  
### <a name="parameters"></a>参数  
 [in] `lstCommands`  
 对引用`CList`对象，其中包含不能由用户执行的命令。  
  
### <a name="remarks"></a>备注  
 调用此方法将使用户无法选择某些命令。 例如，您可能想要使用户无法选择某些命令出于安全原因。 请参阅有关示例，请使用此方法的 MDITabsDemo 和 MenuSubSet 示例。  
  
 此方法清除前面不允许命令的列表。 默认情况下，不允许命令的列表为空。  
  
##  <a name="setonerowwithsibling"></a>CMFCToolBar::SetOneRowWithSibling  
 工具栏和同级放置在同一行上。  
  
```  
void SetOneRowWithSibling();
```  
  
### <a name="remarks"></a>备注  
 框架将调用此方法，当用户单击**在一行上显示的按钮**按钮。  
  
 调用[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)方法，以使**在一行上显示的按钮**或**分两个行显示按钮**按钮。 如果调用[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)此工具栏，同级工具栏移动到此工具栏中的一行。 否则，此工具栏将移到的同级的行。  
  
 框架将调用[CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling)方法，当用户单击**分两个行显示按钮**按钮。  
  
##  <a name="setorigbuttons"></a>CMFCToolBar::SetOrigButtons  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
```  
void SetOrigButtons(const CObList& lstOrigButtons);
```  
  
### <a name="parameters"></a>参数  
 [in] `lstOrigButtons`  
  
### <a name="remarks"></a>备注  
  
##  <a name="setpermament"></a>CMFCToolBar::SetPermament  
 指定用户是否可以关闭工具栏。  
  
```  
void SetPermament(BOOL bPermament=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `bPermament`  
 一个布尔值，指定用户是否可以关闭工具栏。 如果此参数为`TRUE`，用户不能关闭工具栏。 否则，用户可以关闭工具栏。  
  
### <a name="remarks"></a>备注  
 默认情况下，用户可以关闭每个工具栏。  
  
 调用[CMFCToolBar::CanBeClosed](#canbeclosed)方法，以确定用户是否可以关闭工具栏。  
  
##  <a name="setroutecommandsviaframe"></a>CMFCToolBar::SetRouteCommandsViaFrame  
 指定是否与父框架或所有者将命令发送到工具栏。  
  
```  
void SetRouteCommandsViaFrame(BOOL bValue);
```  
  
### <a name="parameters"></a>参数  
 [in] `bValue`  
 如果此参数为`TRUE`，与父框架将命令发送到工具栏。 否则，所有者将命令发送到工具栏。  
  
### <a name="remarks"></a>备注  
 默认情况下，父框架将命令发送到工具栏。 调用[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)方法，以确定是否与父框架或所有者将命令发送到工具栏。  
  
##  <a name="setshowtooltips"></a>CMFCToolBar::SetShowTooltips  
 指定框架是否显示工具提示。  
  
```  
static void SetShowTooltips(BOOL bValue);
```  
  
### <a name="parameters"></a>参数  
 [in] `bValue`  
 如果此参数为`TRUE`，框架显示工具提示。 否则，该框架将隐藏工具提示。  
  
### <a name="remarks"></a>备注  
 默认情况下，框架显示工具提示。  
  
 调用[CMFCToolBar::GetShowTooltips](#getshowtooltips)方法，以确定该框架是否显示工具提示。  
  
##  <a name="setsiblingtoolbar"></a>CMFCToolBar::SetSiblingToolBar  
 指定工具栏的同级元素。  
  
```  
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```  
  
### <a name="parameters"></a>参数  
 [in] `pBrotherToolbar`  
 指向同级工具栏上的指针。  
  
### <a name="remarks"></a>备注  
 此方法使**在一行上显示的按钮**或**分两个行显示按钮**用户显示时，将显示的按钮**自定义**弹出菜单。 当您想要使用户能够指定相关的工具栏显示在同一行上或在不同的行上时，请调用此方法。  
  
 启用后调用此方法**自定义**出现在工具栏的按钮。 若要启用**自定义**按钮，请调用[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)方法。  
  
 若要检索的同级元素的一个工具栏，请调用[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)。  
  
##  <a name="setsizes"></a>CMFCToolBar::SetSizes  
 指定所有工具栏按钮和图像的大小。  
  
```  
static void __stdcall SetSizes(
    SIZE sizeButton,  
    SIZE sizeImage);
```  
  
### <a name="parameters"></a>参数  
 [in] `sizeButton`  
 工具栏按钮，以像素为单位的大小。  
  
 [in] `sizeImage`  
 工具栏按钮图像，以像素为单位的大小。  
  
### <a name="remarks"></a>备注  
 工具栏按钮的默认大小为 23 x 22 像素。 工具栏按钮图像的默认大小为 16x15 像素。  
  
 调用[CMFCToolBar::GetImageSize](#getimagesize)方法来检索工具栏按钮图像的大小。 调用[CMFCToolBar::GetButtonSize](#getbuttonsize)方法来检索工具栏按钮的大小。  
  
##  <a name="settoolbarbtntext"></a>CMFCToolBar::SetToolBarBtnText  
 在工具栏上指定的一个按钮的属性。  
  
```  
void SetToolBarBtnText(
    UINT nBtnIndex,  
    LPCTSTR szText=NULL,  
    BOOL bShowText=TRUE,  
    BOOL bShowImage=TRUE);
```  
  
### <a name="parameters"></a>参数  
 [in] `nBtnIndex`  
 工具栏按钮的工具栏按钮列表中的从零开始的索引。  
  
 [in] `szText`  
 指定工具栏按钮的文本标签。  
  
 [in] `bShowText`  
 如果此参数为`TRUE`，框架显示的文本标签。 否则，该框架将隐藏的文本标签。  
  
 [in] `bShowImage`  
 如果此参数为`TRUE`，框架显示工具栏按钮图像。 否则，该框架会隐藏工具栏按钮图像。  
  
### <a name="remarks"></a>备注  
 默认情况下，框架显示工具栏按钮的图像，但不显示工具栏按钮的文本标签。  
  
 在调试版本中，如果此方法生成断言失败`nBtnIndex`不引用到有效的工具栏按钮或工具栏按钮是一个分隔符。  
  
##  <a name="settworowswithsibling"></a>CMFCToolBar::SetTwoRowsWithSibling  
 工具栏和同级放置在单独的行上。  
  
```  
void SetTwoRowsWithSibling();
```  
  
### <a name="remarks"></a>备注  
 框架将调用此方法，当用户单击**分两个行显示按钮**按钮。  
  
 调用[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)方法，以使**在一行上显示的按钮**或**分两个行显示按钮**按钮。 如果调用[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)此工具栏，同级工具栏移动到一个单独的行。 否则，此工具栏将移到一个单独的行。  
  
 框架将调用[CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling)方法，当用户单击**在一行上显示的按钮**按钮。  
  
##  <a name="setuserimages"></a>CMFCToolBar::SetUserImages  
 应用程序中设置的用户定义的图像的集合。  
  
```  
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```  
  
### <a name="parameters"></a>参数  
 [in] `pUserImages`  
 一个指向用户定义的图像集合。  
  
### <a name="return-value"></a>返回值  
 如果方法成功，则非零值否则为 0 if 指定`CMFCToolBarImages`对象无效或者具有不同于默认图像大小的工具栏图像大小。  
  
### <a name="remarks"></a>备注  
 框架将使用用户定义的图像绘制用户自定义的工具栏按钮。 指定的图像列表`pUserImages`在所有工具栏间共享应用程序中。  
  
 如果此方法生成断言失败在调试生成中指定`CMFCToolBarImages`对象无效或者具有不同于默认图像大小的工具栏图像大小。  
  
 OutlookDemo、 ToolTipDemo 和 VisualStudioDemo 示例使用此方法来设置用户定义的图像的全局集合。 加载名为 UserImages.bmp，它位于应用程序的工作目录中的文件。  
  
 调用[CMFCToolBar::GetUserImages](#getuserimages)方法来检索用户定义的应用程序中的图像的集合。  
  
##  <a name="stretchpane"></a>CMFCToolBar::StretchPane  
 拉伸工具栏垂直或水平，并将这些按钮重新定位，如有必要。  
  
```  
virtual CSize StretchPane(
    int nLength,  
    BOOL bVert);
```  
  
### <a name="parameters"></a>参数  
 [in] `nLength`  
 以像素为单位进行拉伸窗格中所依据的量。  
  
 [in] `bVert`  
 如果`TRUE`，垂直方向拉伸窗格。 如果`FALSE`，水平伸缩窗格。  
  
### <a name="return-value"></a>返回值  
 一个`CSize`对象，它指定工具栏上的客户端区域的大小。  
  
### <a name="remarks"></a>备注  
 此方法调用[CMFCToolBar::WrapToolBar](#wraptoolbar)若要重新定位内拉伸工具栏按钮。  
  
 返回值由调用[CMFCToolBar::CalcSize](#calcsize)。  
  
##  <a name="translatechar"></a>CMFCToolBar::TranslateChar  
 如果指定的键代码对应于有效的键盘快捷键，请执行按钮命令。  
  
```  
virtual BOOL TranslateChar(UINT nChar);
```  
  
### <a name="parameters"></a>参数  
 [in] `nChar`  
 指定以虚拟键代码。 有关标准虚拟键代码的列表，请参见 Winuser.h  
  
### <a name="return-value"></a>返回值  
 `FALSE`如果指定的键代码处于无法打印或不对应到有效的键盘快捷方式;`TRUE`如果指定的键代码对应的下拉列表菜单选项; 否则，返回值从[CMFCToolBar::ProcessCommand](#processcommand)。  
  
### <a name="remarks"></a>备注  
 当与 Alt 键一起按下某个键时，框架将调用此方法。  
  
##  <a name="updatebutton"></a>CMFCToolBar::UpdateButton  
 更新指定的按钮的状态。  
  
```  
void UpdateButton(int nIndex);
```  
  
### <a name="parameters"></a>参数  
 [in] `nIndex`  
 指定更新按钮的从零开始索引。  
  
### <a name="remarks"></a>备注  
  
##  <a name="wraptoolbar"></a>CMFCToolBar::WrapToolBar  
 重新定位在给定维度中的工具栏按钮。  
  
```  
int WrapToolBar(
    int nWidth,  
    int nHeight = 32767,  
    CDC* pDC = NULL,  
    int nColumnWidth = -1,  
    int nRowHeight = -1);
```  
  
### <a name="parameters"></a>参数  
 [in] `nWidth`  
 工具栏的最大宽度。  
  
 [in] `nHeight`  
 工具栏的最大高度。 不使用如果浮动工具栏。  
  
 [in] `pDC`  
 指向设备上下文的指针。 如果为 NULL，则使用工具栏上的设备上下文。  
  
 [in] `nColumnWidth`  
 按钮的宽度。 如果为-1，则使用的当前宽度。  
  
 [] in m`nRowHeight`  
 按钮高度。 如果为-1，则使用当前的高度。  
  
### <a name="return-value"></a>返回值  
 在工具栏上的按钮的行数。  
  
### <a name="remarks"></a>备注  
 此方法将重新定位包装到其他行，如有必要的按钮的工具栏中的按钮。  
  
##  <a name="m_bdontscaleimages"></a>CMFCToolBar::m_bDontScaleImages  
 指定在高 DPI 模式中扩展的工具栏图像。  
  
```  
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;  
```  
  
### <a name="remarks"></a>备注  
  
## <a name="see-also"></a>另请参阅  
 [层次结构图](../../mfc/hierarchy-chart.md)   
 [类](../../mfc/reference/mfc-classes.md)   
 [CMFCMenuBar 类](../../mfc/reference/cmfcmenubar-class.md)   
 [CMFCPopupMenuBar 类](../../mfc/reference/cmfcpopupmenubar-class.md)   
 [CMFCDropDownToolBar 类](../../mfc/reference/cmfcdropdowntoolbar-class.md)   
 [演练︰ 将置于工具栏上的控件](../../mfc/walkthrough-putting-controls-on-toolbars.md)




